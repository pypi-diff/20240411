# Comparing `tmp/braincore-0.0.1-py2.py3-none-any.whl.zip` & `tmp/braincore-0.0.2-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,36 +1,51 @@
-Zip file size: 132912 bytes, number of entries: 34
--rw-rw-rw-  2.0 fat      832 b- defN 24-Mar-21 13:22 braincore/__init__.py
--rw-rw-rw-  2.0 fat    49586 b- defN 24-Mar-21 13:22 braincore/_module.py
--rw-rw-rw-  2.0 fat     3758 b- defN 24-Mar-21 12:07 braincore/_state.py
--rw-rw-rw-  2.0 fat     2143 b- defN 24-Mar-21 12:07 braincore/_transform.py
--rw-rw-rw-  2.0 fat    18675 b- defN 24-Mar-21 12:07 braincore/_utils.py
--rw-rw-rw-  2.0 fat    10919 b- defN 24-Mar-21 12:07 braincore/environ.py
--rw-rw-rw-  2.0 fat    10375 b- defN 24-Mar-21 12:07 braincore/mixin.py
--rw-rw-rw-  2.0 fat   183781 b- defN 24-Mar-21 12:07 braincore/random.py
--rw-rw-rw-  2.0 fat     2044 b- defN 24-Mar-21 12:07 braincore/share.py
--rw-rw-rw-  2.0 fat    42221 b- defN 24-Mar-21 12:07 braincore/surrogate.py
--rw-rw-rw-  2.0 fat      495 b- defN 24-Mar-21 12:07 braincore/_projection/__init__.py
--rw-rw-rw-  2.0 fat      109 b- defN 24-Mar-21 12:07 braincore/_projection/_utils.py
--rw-rw-rw-  2.0 fat    19599 b- defN 24-Mar-21 12:07 braincore/_projection/align_post.py
--rw-rw-rw-  2.0 fat    23686 b- defN 24-Mar-21 12:07 braincore/_projection/align_pre.py
--rw-rw-rw-  2.0 fat     6300 b- defN 24-Mar-21 12:07 braincore/_projection/delta.py
--rw-rw-rw-  2.0 fat     2613 b- defN 24-Mar-21 12:07 braincore/_projection/vanilla.py
--rw-rw-rw-  2.0 fat        0 b- defN 24-Mar-21 12:07 braincore/integrators/__init__.py
--rw-rw-rw-  2.0 fat        0 b- defN 24-Mar-21 12:07 braincore/integrators/ode.py
--rw-rw-rw-  2.0 fat      169 b- defN 24-Mar-21 12:07 braincore/math/__init__.py
--rw-rw-rw-  2.0 fat    30829 b- defN 24-Mar-21 12:07 braincore/math/_einops.py
--rw-rw-rw-  2.0 fat     6065 b- defN 24-Mar-21 12:07 braincore/math/_einops_parsing.py
--rw-rw-rw-  2.0 fat     5097 b- defN 24-Mar-21 12:07 braincore/math/_misc.py
--rw-rw-rw-  2.0 fat    12629 b- defN 24-Mar-21 12:07 braincore/math/tests/test_einops.py
--rw-rw-rw-  2.0 fat     4183 b- defN 24-Mar-21 12:07 braincore/math/tests/test_einops_parsing.py
--rw-rw-rw-  2.0 fat     1737 b- defN 24-Mar-21 12:07 braincore/math/tests/test_misc.py
--rw-rw-rw-  2.0 fat     2208 b- defN 24-Mar-21 12:07 braincore/tests/test_mixin.py
--rw-rw-rw-  2.0 fat     3062 b- defN 24-Mar-21 12:07 braincore/tests/test_module.py
--rw-rw-rw-  2.0 fat    17154 b- defN 24-Mar-21 12:07 braincore/tests/test_random.py
--rw-rw-rw-  2.0 fat        0 b- defN 24-Mar-21 12:07 braincore/units/__init__.py
--rw-rw-rw-  2.0 fat    35773 b- defN 24-Mar-21 13:24 braincore-0.0.1.dist-info/LICENSE
--rw-rw-rw-  2.0 fat    44728 b- defN 24-Mar-21 13:24 braincore-0.0.1.dist-info/METADATA
--rw-rw-rw-  2.0 fat      110 b- defN 24-Mar-21 13:24 braincore-0.0.1.dist-info/WHEEL
--rw-rw-rw-  2.0 fat       10 b- defN 24-Mar-21 13:24 braincore-0.0.1.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat     2840 b- defN 24-Mar-21 13:24 braincore-0.0.1.dist-info/RECORD
-34 files, 543730 bytes uncompressed, 128390 bytes compressed:  76.4%
+Zip file size: 168288 bytes, number of entries: 49
+-rw-rw-rw-  2.0 fat     1465 b- defN 24-Apr-08 05:12 braincore/__init__.py
+-rw-rw-rw-  2.0 fat      833 b- defN 24-Apr-08 05:12 braincore/_common.py
+-rw-rw-rw-  2.0 fat    51984 b- defN 24-Apr-11 07:44 braincore/_module.py
+-rw-rw-rw-  2.0 fat     4333 b- defN 24-Apr-08 05:12 braincore/_module_test.py
+-rw-rw-rw-  2.0 fat    10562 b- defN 24-Apr-11 07:02 braincore/_state.py
+-rw-rw-rw-  2.0 fat     1252 b- defN 24-Apr-08 05:12 braincore/_state_test.py
+-rw-rw-rw-  2.0 fat     9371 b- defN 24-Apr-11 07:02 braincore/environ.py
+-rw-rw-rw-  2.0 fat    11064 b- defN 24-Apr-11 07:02 braincore/mixin.py
+-rw-rw-rw-  2.0 fat     2912 b- defN 24-Apr-08 05:12 braincore/mixin_test.py
+-rw-rw-rw-  2.0 fat   185311 b- defN 24-Apr-11 07:44 braincore/random.py
+-rw-rw-rw-  2.0 fat    17865 b- defN 24-Apr-08 05:12 braincore/random_test.py
+-rw-rw-rw-  2.0 fat     2828 b- defN 24-Apr-08 08:50 braincore/share.py
+-rw-rw-rw-  2.0 fat    42830 b- defN 24-Apr-11 07:44 braincore/surrogate.py
+-rw-rw-rw-  2.0 fat     2135 b- defN 24-Apr-08 05:12 braincore/typing.py
+-rw-rw-rw-  2.0 fat    19869 b- defN 24-Apr-08 05:12 braincore/util.py
+-rw-rw-rw-  2.0 fat     1207 b- defN 24-Apr-08 05:12 braincore/_projection/__init__.py
+-rw-rw-rw-  2.0 fat    20464 b- defN 24-Apr-08 05:12 braincore/_projection/_align_post.py
+-rw-rw-rw-  2.0 fat    24553 b- defN 24-Apr-08 05:12 braincore/_projection/_align_pre.py
+-rw-rw-rw-  2.0 fat     7107 b- defN 24-Apr-08 05:12 braincore/_projection/_delta.py
+-rw-rw-rw-  2.0 fat      813 b- defN 24-Apr-08 05:12 braincore/_projection/_utils.py
+-rw-rw-rw-  2.0 fat     3391 b- defN 24-Apr-08 05:12 braincore/_projection/_vanilla.py
+-rw-rw-rw-  2.0 fat      945 b- defN 24-Apr-08 05:12 braincore/integrate/__init__.py
+-rw-rw-rw-  2.0 fat     7878 b- defN 24-Apr-08 05:12 braincore/integrate/_joint_eq.py
+-rw-rw-rw-  2.0 fat     8780 b- defN 24-Apr-08 05:12 braincore/integrate/_ode.py
+-rw-rw-rw-  2.0 fat     9174 b- defN 24-Apr-08 05:12 braincore/integrate/_quadrature.py
+-rw-rw-rw-  2.0 fat      873 b- defN 24-Apr-08 05:12 braincore/math/__init__.py
+-rw-rw-rw-  2.0 fat    31756 b- defN 24-Apr-08 05:12 braincore/math/_einops.py
+-rw-rw-rw-  2.0 fat     6805 b- defN 24-Apr-08 05:12 braincore/math/_einops_parsing.py
+-rw-rw-rw-  2.0 fat     4887 b- defN 24-Apr-08 05:12 braincore/math/_einops_parsing_test.py
+-rw-rw-rw-  2.0 fat    13333 b- defN 24-Apr-08 05:12 braincore/math/_einops_test.py
+-rw-rw-rw-  2.0 fat     7889 b- defN 24-Apr-08 05:12 braincore/math/_misc.py
+-rw-rw-rw-  2.0 fat     2441 b- defN 24-Apr-08 05:12 braincore/math/_misc_test.py
+-rw-rw-rw-  2.0 fat     1460 b- defN 24-Apr-08 05:12 braincore/transform/__init__.py
+-rw-rw-rw-  2.0 fat    24086 b- defN 24-Apr-08 05:12 braincore/transform/_autograd.py
+-rw-rw-rw-  2.0 fat    38608 b- defN 24-Apr-08 05:12 braincore/transform/_autograd_test.py
+-rw-rw-rw-  2.0 fat    26565 b- defN 24-Apr-08 05:12 braincore/transform/_control.py
+-rw-rw-rw-  2.0 fat     7647 b- defN 24-Apr-08 05:12 braincore/transform/_controls_test.py
+-rw-rw-rw-  2.0 fat    10862 b- defN 24-Apr-08 05:12 braincore/transform/_jit.py
+-rw-rw-rw-  2.0 fat     4448 b- defN 24-Apr-08 05:12 braincore/transform/_jit_error.py
+-rw-rw-rw-  2.0 fat     2890 b- defN 24-Apr-08 05:12 braincore/transform/_jit_test.py
+-rw-rw-rw-  2.0 fat    22766 b- defN 24-Apr-08 05:12 braincore/transform/_make_jaxpr.py
+-rw-rw-rw-  2.0 fat     3599 b- defN 24-Apr-08 05:12 braincore/transform/_make_jaxpr_test.py
+-rw-rw-rw-  2.0 fat     3590 b- defN 24-Apr-08 05:12 braincore/transform/_progress_bar.py
+-rw-rw-rw-  2.0 fat        0 b- defN 24-Apr-01 08:12 braincore/units/__init__.py
+-rw-rw-rw-  2.0 fat    11550 b- defN 24-Apr-11 08:05 braincore-0.0.2.dist-info/LICENSE
+-rw-rw-rw-  2.0 fat     4679 b- defN 24-Apr-11 08:05 braincore-0.0.2.dist-info/METADATA
+-rw-rw-rw-  2.0 fat      110 b- defN 24-Apr-11 08:05 braincore-0.0.2.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat       10 b- defN 24-Apr-11 08:05 braincore-0.0.2.dist-info/top_level.txt
+?rw-rw-r--  2.0 fat     4147 b- defN 24-Apr-11 08:05 braincore-0.0.2.dist-info/RECORD
+49 files, 683927 bytes uncompressed, 161742 bytes compressed:  76.4%
```

## zipnote {}

```diff
@@ -1,103 +1,148 @@
 Filename: braincore/__init__.py
 Comment: 
 
+Filename: braincore/_common.py
+Comment: 
+
 Filename: braincore/_module.py
 Comment: 
 
-Filename: braincore/_state.py
+Filename: braincore/_module_test.py
 Comment: 
 
-Filename: braincore/_transform.py
+Filename: braincore/_state.py
 Comment: 
 
-Filename: braincore/_utils.py
+Filename: braincore/_state_test.py
 Comment: 
 
 Filename: braincore/environ.py
 Comment: 
 
 Filename: braincore/mixin.py
 Comment: 
 
+Filename: braincore/mixin_test.py
+Comment: 
+
 Filename: braincore/random.py
 Comment: 
 
+Filename: braincore/random_test.py
+Comment: 
+
 Filename: braincore/share.py
 Comment: 
 
 Filename: braincore/surrogate.py
 Comment: 
 
+Filename: braincore/typing.py
+Comment: 
+
+Filename: braincore/util.py
+Comment: 
+
 Filename: braincore/_projection/__init__.py
 Comment: 
 
-Filename: braincore/_projection/_utils.py
+Filename: braincore/_projection/_align_post.py
+Comment: 
+
+Filename: braincore/_projection/_align_pre.py
+Comment: 
+
+Filename: braincore/_projection/_delta.py
 Comment: 
 
-Filename: braincore/_projection/align_post.py
+Filename: braincore/_projection/_utils.py
 Comment: 
 
-Filename: braincore/_projection/align_pre.py
+Filename: braincore/_projection/_vanilla.py
 Comment: 
 
-Filename: braincore/_projection/delta.py
+Filename: braincore/integrate/__init__.py
 Comment: 
 
-Filename: braincore/_projection/vanilla.py
+Filename: braincore/integrate/_joint_eq.py
 Comment: 
 
-Filename: braincore/integrators/__init__.py
+Filename: braincore/integrate/_ode.py
 Comment: 
 
-Filename: braincore/integrators/ode.py
+Filename: braincore/integrate/_quadrature.py
 Comment: 
 
 Filename: braincore/math/__init__.py
 Comment: 
 
 Filename: braincore/math/_einops.py
 Comment: 
 
 Filename: braincore/math/_einops_parsing.py
 Comment: 
 
+Filename: braincore/math/_einops_parsing_test.py
+Comment: 
+
+Filename: braincore/math/_einops_test.py
+Comment: 
+
 Filename: braincore/math/_misc.py
 Comment: 
 
-Filename: braincore/math/tests/test_einops.py
+Filename: braincore/math/_misc_test.py
+Comment: 
+
+Filename: braincore/transform/__init__.py
+Comment: 
+
+Filename: braincore/transform/_autograd.py
+Comment: 
+
+Filename: braincore/transform/_autograd_test.py
+Comment: 
+
+Filename: braincore/transform/_control.py
+Comment: 
+
+Filename: braincore/transform/_controls_test.py
+Comment: 
+
+Filename: braincore/transform/_jit.py
 Comment: 
 
-Filename: braincore/math/tests/test_einops_parsing.py
+Filename: braincore/transform/_jit_error.py
 Comment: 
 
-Filename: braincore/math/tests/test_misc.py
+Filename: braincore/transform/_jit_test.py
 Comment: 
 
-Filename: braincore/tests/test_mixin.py
+Filename: braincore/transform/_make_jaxpr.py
 Comment: 
 
-Filename: braincore/tests/test_module.py
+Filename: braincore/transform/_make_jaxpr_test.py
 Comment: 
 
-Filename: braincore/tests/test_random.py
+Filename: braincore/transform/_progress_bar.py
 Comment: 
 
 Filename: braincore/units/__init__.py
 Comment: 
 
-Filename: braincore-0.0.1.dist-info/LICENSE
+Filename: braincore-0.0.2.dist-info/LICENSE
 Comment: 
 
-Filename: braincore-0.0.1.dist-info/METADATA
+Filename: braincore-0.0.2.dist-info/METADATA
 Comment: 
 
-Filename: braincore-0.0.1.dist-info/WHEEL
+Filename: braincore-0.0.2.dist-info/WHEEL
 Comment: 
 
-Filename: braincore-0.0.1.dist-info/top_level.txt
+Filename: braincore-0.0.2.dist-info/top_level.txt
 Comment: 
 
-Filename: braincore-0.0.1.dist-info/RECORD
+Filename: braincore-0.0.2.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## braincore/__init__.py

```diff
@@ -1,29 +1,43 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
 """
 The core system for the next-generation BrainPy framework.
 """
 
-__version__ = "0.0.1"
+__version__ = "0.0.2"
 
 from . import environ
+from . import integrate
 from . import math
 from . import mixin
 from . import random
 from . import share
 from . import surrogate
+from . import transform
+from . import typing
+from . import util
 from ._module import *
 from ._module import __all__ as _module_all
 from ._projection import *
 from ._projection import __all__ as _projection_all
 from ._state import *
 from ._state import __all__ as _state_all
-from ._transform import *
-from ._transform import __all__ as _transform_all
-from ._utils import *
-from ._utils import __all__ as _utils_all
 
 __all__ = (
-    ['environ', 'share', 'surrogate', 'random', 'mixin', 'math'] +
-    _projection_all + _module_all +
-    _state_all + _transform_all + _utils_all
+    ['environ', 'share', 'surrogate', 'random', 'mixin', 'math', 'transform', 'integrate', 'util', 'typing'] +
+    _module_all + _projection_all + _state_all
 )
-del _projection_all, _module_all, _state_all, _transform_all, _utils_all
+del _module_all, _projection_all, _state_all
```

## braincore/_module.py

```diff
@@ -1,31 +1,51 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
 # -*- coding: utf-8 -*-
 
 
 """
+
 All the basic classes for the ``braincore``.
 
 The basic classes include:
 
 - ``Module``: The base class for all the objects in the ecosystem.
-- ``module_list``: A sequence of :py:class:`~.Module`.
-- ``module_dict``: A dictionary of :py:class:`~.Module`.
 - ``Sequential``: The class for a sequential of modules, which update the modules sequentially.
 - ``ModuleGroup``: The class for a group of modules, which update ``Projection`` first,
                    then ``Dynamics``, finally others.
 
+and:
+
+- ``visible_module_list``: A list to represent a sequence of :py:class:`~.Module`
+  that can be visible by the ``.nodes()`` extractor.
+- ``visible_module_dict``: A dict to represent a dictionary of :py:class:`~.Module`
+  that can be visible by the ``.nodes()`` extractor.
+
 For handling dynamical systems:
 
 - ``Projection``: The class for the synaptic projection.
 - ``Dynamics``: The class for the dynamical system.
 
 For handling the delays:
 
-- ``StateDelay``: The class for the state delay.
-- ``DataDelay``: The class for the data delay.
+- ``Delay``: The class for all delays.
 - ``DelayAccess``: The class for the delay access.
 
 """
 
 import inspect
 import math
 import numbers
@@ -34,18 +54,20 @@
 from typing import Sequence, Any, Tuple, Union, Dict, Callable, Optional
 
 import jax
 import jax.numpy as jnp
 import numpy as np
 
 from . import environ, share
-from ._state import State, StateStack
-from ._utils import unique_name, Stack, jit_error, get_unique_name
+from ._common import set_module_as
+from ._state import State, StateDictManager, visible_state_dict
+from .util import unique_name, DictManager, get_unique_name, DotDict
 from .math import get_dtype
 from .mixin import Mixin, Mode, ParamDesc, AllOfTypes, Batching, UpdateReturn
+from .transform._jit_error import jit_error
 
 Shape = Union[int, Sequence[int]]
 PyTree = Any
 ArrayLike = jax.typing.ArrayLike
 
 delay_identifier = '_*_delay_of_'
 ROTATE_UPDATE = 'rotation'
@@ -54,15 +76,15 @@
 StateLoadResult = namedtuple('StateLoadResult', ['missing_keys', 'unexpected_keys'])
 
 # the maximum order
 _max_order = 10
 
 __all__ = [
   # basic classes
-  'Module', 'module_list', 'module_dict', 'ModuleGroup', 'Sequential',
+  'Module', 'visible_module_list', 'visible_module_dict', 'ModuleGroup', 'Sequential',
 
   # dynamical systems
   'Projection', 'Dynamics',
 
   # delay handling
   'Delay', 'DelayAccess',
 
@@ -89,18 +111,18 @@
   - ``load_state()``: Load states from the external objects.
 
   """
 
   __module__ = 'braincore'
 
   # the excluded states
-  _invisible_states = ()
+  _invisible_states: Tuple[str, ...] = ()
 
   # the excluded nodes
-  _invisible_nodes = ()
+  _invisible_nodes: Tuple[str, ...] = ()
 
   # # the supported computing modes
   # supported_modes: Optional[Sequence[Mode]] = None
 
   def __init__(self, name: str = None, mode: Mode = None):
     super().__init__()
 
@@ -108,15 +130,15 @@
     self._name = unique_name(self=self, name=name)
 
     # mode setting
     self._mode = None
     self.mode = mode if mode is not None else environ.get('mode')
 
   def __repr__(self):
-    return f'{self.__class__.__name__}({self.name}, mode={self.mode})'
+    return f'{self.__class__.__name__}'
 
   @property
   def name(self):
     """Name of the model."""
     return self._name
 
   @name.setter
@@ -131,61 +153,98 @@
   @mode.setter
   def mode(self, value):
     if not isinstance(value, Mode):
       raise ValueError(f'Must be instance of {Mode.__name__}, '
                        f'but we got {type(value)}: {value}')
     self._mode = value
 
-  def states(self, method: str = 'absolute', level: int = -1, include_self: bool = True) -> StateStack:
+  def states(
+      self,
+      cache: Optional[str] = None,
+      method: str = 'absolute',
+      level: int = -1,
+      include_self: bool = True,
+      unique: bool = True,
+  ) -> StateDictManager:
     """
     Collect all states in this node and the children nodes.
 
     Parameters
     ----------
+    cache: str
+      The cache name. If None, the cache will not be used. Default is None.
     method : str
       The method to access the variables.
     level: int
       The hierarchy level to find variables.
     include_self: bool
       Whether include the variables in the self.
+    unique: bool
+      Whether return the unique variables.
 
     Returns
     -------
-    states : StateStack
+    states : StateDictManager
       The collection contained (the path, the variable).
     """
+
+    if cache is not None:
+      cache = f'method={method}, level={level}, include_self={include_self}, unique={unique}, cache={cache}'
+      if cache in self.statecache:
+        return self.statecache[cache]
+
+    # find the nodes
     nodes = self.nodes(method=method, level=level, include_self=include_self)
 
-    # state stacks
-    states = StateStack()
+    # get the state stack
+    states = StateDictManager()
+    _state_id = set()
     for node_path, node in nodes.items():
       for k in node.__dict__.keys():
         if k in node._invisible_states:
           continue
         v = getattr(node, k)
         if isinstance(v, State):
+          if unique and id(v) in _state_id:
+            continue
+          _state_id.add(id(v))
           states[f'{node_path}.{k}' if node_path else k] = v
+        elif isinstance(v, visible_state_dict):
+          for k2, v2 in v.items():
+            if unique and id(v2) in _state_id:
+              continue
+            _state_id.add(id(v2))
+            states[f'{node_path}.{k}.{k2}'] = v2
+
+    # cache the state stack
+    if cache is not None:
+      self.statecache[cache] = states
     return states
 
-  def nodes(self, method='absolute', level=-1, include_self=True) -> Stack:
+  def nodes(
+      self,
+      method: str = 'absolute',
+      level: int = -1,
+      include_self: bool = True
+  ) -> DictManager:
     """
     Collect all children nodes.
 
     Parameters
     ----------
     method : str
       The method to access the nodes.
     level: int
       The hierarchy level to find nodes.
     include_self: bool
       Whether include the self.
 
     Returns
     -------
-    gather : Stack
+    gather : DictManager
       The collection contained (the path, the node).
     """
     return _find_nodes(self, method=method, level=level, include_self=include_self)
 
   def update(self, *args, **kwargs):
     """
     The function to specify the updating rule.
@@ -200,16 +259,17 @@
     """
     Support using right shift operator to call modules.
 
     Examples
     --------
 
     >>> import braincore as bc
+    >>> import brainscale as nn  # noqa
     >>> x = bc.random.rand((10, 10))
-    >>> l = bp.dnn.Activation(jax.numpy.tanh)
+    >>> l = nn.Activation(jax.numpy.tanh)
     >>> y = x >> l
     """
     return self.__call__(other)
 
   def init_state(self, *args, **kwargs):
     """
     State initialization function.
@@ -228,38 +288,38 @@
     for key in keys2.intersection(keys1):
       variables[key].value = jax.numpy.asarray(state_dict[key])
     unexpected_keys = list(keys1 - keys2)
     missing_keys = list(keys2 - keys1)
     return unexpected_keys, missing_keys
 
 
-def _find_nodes(self, method='absolute', level=-1, include_self=True, _lid=0, _edges=None) -> Stack:
+def _find_nodes(self, method: str = 'absolute', level=-1, include_self=True, _lid=0, _edges=None) -> DictManager:
   if _edges is None:
     _edges = set()
-  gather = Stack()
+  gather = DictManager()
   if include_self:
     if method == 'absolute':
       gather[self.name] = self
     elif method == 'relative':
       gather[''] = self
     else:
       raise ValueError(f'No support for the method of "{method}".')
   if (level > -1) and (_lid >= level):
     return gather
   if method == 'absolute':
     nodes = []
     for k, v in self.__dict__.items():
-      if k not in self._invisible_nodes:
+      if k in self._invisible_nodes:
         continue
       if isinstance(v, Module):
         _add_node_absolute(self, v, _edges, gather, nodes)
-      elif isinstance(v, module_list):
+      elif isinstance(v, visible_module_list):
         for v2 in v:
           _add_node_absolute(self, v2, _edges, gather, nodes)
-      elif isinstance(v, module_dict):
+      elif isinstance(v, visible_module_dict):
         for v2 in v.values():
           if isinstance(v2, Module):
             _add_node_absolute(self, v2, _edges, gather, nodes)
 
     # finding nodes recursively
     for v in nodes:
       gather.update(_find_nodes(v,
@@ -268,20 +328,22 @@
                                 _lid=_lid + 1,
                                 _edges=_edges,
                                 include_self=include_self))
 
   elif method == 'relative':
     nodes = []
     for k, v in self.__dict__.items():
+      if v in self._invisible_nodes:
+        continue
       if isinstance(v, Module):
         _add_node_relative(self, k, v, _edges, gather, nodes)
-      elif isinstance(v, module_list):
+      elif isinstance(v, visible_module_list):
         for i, v2 in enumerate(v):
           _add_node_relative(self, f'{k}-list:{i}', v2, _edges, gather, nodes)
-      elif isinstance(v, module_dict):
+      elif isinstance(v, visible_module_dict):
         for k2, v2 in v.items():
           if isinstance(v2, Module):
             _add_node_relative(self, f'{k}-dict:{k2}', v2, _edges, gather, nodes)
 
     # finding nodes recursively
     for k1, v1 in nodes:
       for k2, v2 in _find_nodes(v1,
@@ -326,72 +388,72 @@
     if len(nodes):
       for node in nodes:
         node(*args, **kwargs)
     else:
       raise ValueError('Do not implement the update() function.')
 
 
-class module_list(list):
+class visible_module_list(list):
   """
   A sequence of :py:class:`~.Module`, which is compatible with
   :py:func:`~.vars()` and :py:func:`~.nodes()` operations in a :py:class:`~.Module`.
 
   That is to say, any nodes that are wrapped into :py:class:`~.NodeList` will be automatically
   retieved when using :py:func:`~.nodes()` function.
 
   >>> import braincore as bc
-  >>> l = bc.module_list([bp.dnn.Dense(1, 2),
+  >>> l = bc.visible_module_list([bp.dnn.Dense(1, 2),
   >>>                     bp.dnn.LSTMCell(2, 3)])
   """
 
   __module__ = 'braincore'
 
   def __init__(self, seq=()):
     super().__init__()
     self.extend(seq)
 
-  def append(self, element) -> 'module_list':
+  def append(self, element) -> 'visible_module_list':
     if isinstance(element, State):
       raise TypeError(f'Cannot append a state into a node list. ')
     super().append(element)
     return self
 
-  def extend(self, iterable) -> 'module_list':
+  def extend(self, iterable) -> 'visible_module_list':
     for element in iterable:
       self.append(element)
     return self
 
 
-class module_dict(dict):
+class visible_module_dict(dict):
   """
   A dictionary of :py:class:`~.Module`, which is compatible with
   :py:func:`.vars()` operation in a :py:class:`~.Module`.
 
   """
 
   __module__ = 'braincore'
 
   def __init__(self, *args, check_unique: bool = False, **kwargs):
     super().__init__()
     self.check_unique = check_unique
     self.update(*args, **kwargs)
 
-  def update(self, *args, **kwargs) -> 'module_dict':
+  def update(self, *args, **kwargs) -> 'visible_module_dict':
     for arg in args:
       if isinstance(arg, dict):
         for k, v in arg.items():
           self[k] = v
       elif isinstance(arg, tuple):
         assert len(arg) == 2
         self[arg[0]] = args[1]
     for k, v in kwargs.items():
       self[k] = v
     return self
 
-  def __setitem__(self, key, value) -> 'module_dict':
+  def __setitem__(self, key, value) -> 'visible_module_dict':
     if self.check_unique:
       exist = self.get(key, None)
       if id(exist) != id(value):
         raise KeyError(f'Duplicate usage of key "{key}". "{key}" has been used for {value}.')
     super().__setitem__(key, value)
     return self
 
@@ -400,16 +462,16 @@
   """
   The :py:class:`~.Mixin` that receives the input projections.
 
   Note that the subclass should define a ``cur_inputs`` attribute. Otherwise,
   the input function utilities cannot be used.
 
   """
-  _current_inputs: Optional[module_dict]
-  _delta_inputs: Optional[module_dict]
+  _current_inputs: Optional[visible_module_dict]
+  _delta_inputs: Optional[visible_module_dict]
 
   @property
   def current_inputs(self):
     """
     The current inputs of the model. It should be a dictionary of the input data.
     """
     return self._current_inputs
@@ -434,22 +496,22 @@
     """
     if not callable(fun):
       raise TypeError('Must be a function.')
 
     key = _input_label_repr(key, label)
     if category == 'current':
       if self._current_inputs is None:
-        self._current_inputs = module_dict()
+        self._current_inputs = visible_module_dict()
       if key in self._current_inputs:
         raise ValueError(f'Key "{key}" has been defined and used.')
       self._current_inputs[key] = fun
 
     elif category == 'delta':
       if self._delta_inputs is None:
-        self._delta_inputs = module_dict()
+        self._delta_inputs = visible_module_dict()
       if key in self._delta_inputs:
         raise ValueError(f'Key "{key}" has been defined and used.')
       self._delta_inputs[key] = fun
 
     else:
       raise NotImplementedError(f'Unknown category: {category}. Only support "current" and "delta".')
 
@@ -521,15 +583,15 @@
           init = init + out(*args, **kwargs)
     return init
 
 
 class Container(Mixin):
   """Container :py:class:`~.MixIn` which wrap a group of objects.
   """
-  children: module_dict
+  children: visible_module_dict
 
   def __getitem__(self, item):
     """Overwrite the slice access (`self['']`). """
     if item in self.children:
       return self.children[item]
     else:
       raise ValueError(f'Unknown item {item}, we only found {list(self.children.keys())}')
@@ -602,16 +664,16 @@
 
 
 class ExtendedUpdateWithBA(Module):
   """
   The extended update with before and after updates.
   """
 
-  _before_updates: Optional[module_dict]
-  _after_updates: Optional[module_dict]
+  _before_updates: Optional[visible_module_dict]
+  _after_updates: Optional[visible_module_dict]
 
   def __init__(self, *args, **kwargs):
 
     # -- Attribute for "BeforeAfterMixIn" -- #
     # the before- / after-updates used for computing
     self._before_updates: Optional[Dict[str, Callable]] = None
     self._after_updates: Optional[Dict[str, Callable]] = None
@@ -633,23 +695,23 @@
     return self._after_updates
 
   def add_before_update(self, key: Any, fun: Callable):
     """
     Add the before update into this node.
     """
     if self._before_updates is None:
-      self._before_updates = module_dict()
+      self._before_updates = visible_module_dict()
     if key in self.before_updates:
       raise KeyError(f'{key} has been registered in before_updates of {self}')
     self.before_updates[key] = fun
 
   def add_after_update(self, key: Any, fun: Callable):
     """Add the after update into this node"""
     if self._after_updates is None:
-      self._after_updates = module_dict()
+      self._after_updates = visible_module_dict()
     if key in self.after_updates:
       raise KeyError(f'{key} has been registered in after_updates of {self}')
     self.after_updates[key] = fun
 
   def get_before_update(self, key: Any):
     """Get the before update of this node by the given ``key``."""
     if self._before_updates is None:
@@ -830,15 +892,15 @@
     Returns:
       The delayed data at the given delay position.
     """
     return self.get_after_update(delay_identifier).at(delay_name)
 
 
 class ModuleGroup(Module, Container):
-  """A group of :py:class:`~.Module`s in which the updating order does not matter.
+  """A group of :py:class:`~.Module` in which the updating order does not matter.
 
   Args:
     children_as_tuple: The children objects.
     children_as_dict: The children objects.
     name: The object name.
     mode: The mode which controls the model computation.
     child_type: The type of the children object. Default is :py:class:`Module`.
@@ -853,15 +915,15 @@
       mode: Optional[Mode] = None,
       child_type: type = Module,
       **children_as_dict
   ):
     super().__init__(name=name, mode=mode)
 
     # Attribute of "Container"
-    self.children = module_dict(self.format_elements(child_type, *children_as_tuple, **children_as_dict))
+    self.children = visible_module_dict(self.format_elements(child_type, *children_as_tuple, **children_as_dict))
 
   def update(self, *args, **kwargs):
     """
     Step function of a network.
 
     In this update function, the update functions in children systems are
     iteratively called.
@@ -935,15 +997,15 @@
       self,
       *modules_as_tuple,
       name: str = None,
       mode: Mode = None,
       **modules_as_dict
   ):
     # Attribute of "Container"
-    self.children = module_dict(self.format_elements(object, *modules_as_tuple, **modules_as_dict))
+    self.children = visible_module_dict(self.format_elements(object, *modules_as_tuple, **modules_as_dict))
 
     # super init
     super().__init__(name=name, mode=mode)
 
   def update(self, x):
     """Update function of a sequential model.
     """
@@ -1278,17 +1340,17 @@
       idx = jnp.asarray(i % self.max_length, dtype=environ.dutype())
       idx = jax.lax.stop_gradient(idx)
       self.history.value = jax.tree.map(lambda hist, cur: hist.at[idx].set(cur),
                                         self.history.value,
                                         current)
     # update the delay data at the first position
     elif self.method == CONCAT_UPDATE:
-      current = jax.tree_map(lambda a: jnp.expand_dims(a, 0), current)
+      current = jax.tree.map(lambda a: jnp.expand_dims(a, 0), current)
       if self.max_length > 1:
-        self.history.value = jax.tree_map(lambda hist, cur: jnp.concatenate([cur, hist[:-1]], axis=0),
+        self.history.value = jax.tree.map(lambda hist, cur: jnp.concatenate([cur, hist[:-1]], axis=0),
                                           self.history.value,
                                           current)
       else:
         self.history.value = current
 
     else:
       raise ValueError(f'Unknown updating method "{self.method}"')
@@ -1369,14 +1431,15 @@
   if not target.has_aft_update(delay_identifier):
     assert isinstance(target, AllOfTypes[ExtendedUpdateWithBA, UpdateReturn])
     target.add_after_update(delay_identifier, Delay(target.update_return_info()))
   delay_cls = target.get_after_update(delay_identifier)
   return delay_cls
 
 
+@set_module_as('braincore')
 def call_order(level: int = 0):
   """The decorator for indicating the resetting level.
 
   The function takes an optional integer argument level with a default value of 0.
 
   The lower the level, the earlier the function is called.
 
@@ -1385,23 +1448,24 @@
   >>> bc.call_order(-1)
   >>> bc.call_order(-2)
 
   """
   if level < 0:
     level = _max_order + level
   if level < 0 or level >= _max_order:
-    raise ValueError(f'"call_order" must be an integer in [0, 10). but we got {level}')
+    raise ValueError(f'"call_order" must be an integer in [0, {_max_order}). but we got {level}.')
 
   def wrap(fun: Callable):
     fun.call_order = level
     return fun
 
   return wrap
 
 
+@set_module_as('braincore')
 def init_states(target: Module, *args, **kwargs) -> Module:
   """
   Reset states of all children nodes in the given target.
 
   Args:
     target: The target Module.
 
@@ -1414,22 +1478,21 @@
   for node in list(target.nodes().values()):
     if not hasattr(node.init_state, 'call_order'):
       node.init_state(*args, **kwargs)
     else:
       nodes_with_order.append(node)
 
   # reset the node's states
-  for l in range(_max_order):
-    for node in nodes_with_order:
-      if node.init_state.call_order == l:
-        node.init_state(*args, **kwargs)
+  for node in sorted(nodes_with_order, key=lambda x: x.init_state.call_order):
+    node.init_state(*args, **kwargs)
 
   return target
 
 
+@set_module_as('braincore')
 def load_states(target: Module, state_dict: Dict, **kwargs):
   """Copy parameters and buffers from :attr:`state_dict` into
   this module and its descendants.
 
   Args:
     target: Module. The dynamical system to load its states.
     state_dict: dict. A dict containing parameters and persistent buffers.
@@ -1448,26 +1511,28 @@
     if r is not None:
       missing, unexpected = r
       missing_keys.extend([f'{name}.{key}' for key in missing])
       unexpected_keys.extend([f'{name}.{key}' for key in unexpected])
   return StateLoadResult(missing_keys, unexpected_keys)
 
 
+@set_module_as('braincore')
 def save_states(target: Module, **kwargs) -> Dict:
   """Save all states in the ``target`` as a dictionary for later disk serialization.
 
   Args:
     target: Module. The node to save its states.
 
   Returns:
     Dict. The state dict for serialization.
   """
   return {key: node.save_state(**kwargs) for key, node in target.nodes().items()}
 
 
+@set_module_as('braincore')
 def assign_state_values(target: Module, *state_by_abs_path: Dict):
   """
   Assign state values according to the given state dictionary.
 
   Parameters
   ----------
   target: Module
```

## braincore/_state.py

```diff
@@ -1,99 +1,237 @@
-from typing import Any, Tuple, Dict
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
+import contextlib
+from typing import Any, Tuple, Dict, List, Callable
+import threading
 
+import numpy as np
 import jax
+from jax.api_util import shaped_abstractify
+from jax.extend import source_info_util
+
+from .util import DictManager
+
+PyTree = Any
+max_int = np.iinfo(np.int32)
 
-from ._utils import Stack
 
 __all__ = [
-  'State', 'ParamState', 'StateStack',
+  'State', 'ShortTermState', 'LongTermState', 'ParamState',
+  'StateDictManager', 'visible_state_dict',
+  'check_state_value_tree',
 ]
 
-PyTree = Any
 _pytree_registered_objects = set()
 
 
-def register_pytree_cls(cls):
+def _register_pytree_cls(cls):
   if cls not in _pytree_registered_objects:
     jax.tree_util.register_pytree_node_class(cls)
     _pytree_registered_objects.add(cls)
 
 
+# The global state of the state stack is accessed by a thread-local object.
+# This allows concurrent tracing in separate threads; passing traced objects
+# between threads is forbidden.
+class ThreadLocalStack(threading.local):
+  def __init__(self):
+    self.stack: List[StateTrace] = []
+
+
+thread_local_stack = ThreadLocalStack()
+
+
+_global_context_to_check_state_tree = [False]
+
+
+@contextlib.contextmanager
+def check_state_value_tree() -> None:
+  """
+  The contex manager to check weather the tree structure of the state value keeps consistently.
+  """
+  try:
+    _global_context_to_check_state_tree.append(True)
+    yield
+  finally:
+    _global_context_to_check_state_tree.pop()
+
+
 class State(object):
   """
-  The pointer to specify the dynamical state.
+  The pointer to specify the dynamical data.
+
+  To implement a new subclass of :py:class:`~.State`, you only need to inherent this class:
+
+  Example::
+
+    class MyState(State):
+      pass
+
+  The typical examples of :py:class:`~.State` subclass are:
+
+  - :py:class:`~.ShortTermState`: The short-term state, which is used to store the short-term data in the program.
+  - :py:class:`~.LongTermState`: The long-term state, which is used to store the long-term data in the program.
+  - :py:class:`~.ParamState`: The parameter state, which is used to store the parameters in the program.
+  - :py:class:`~.RandomState`: The random generator state, which is used to store the random key in the program.
 
   Args:
     value: PyTree. It can be anything as a pyTree.
   """
   __module__ = 'braincore'
-  __slots__ = ('_value', '_tree')
+  __slots__ = ('_value', '_tree', '_level', '_source_info', '_check_tree')
 
   def __init__(self, value: PyTree):
     if isinstance(value, State):
       value = value.value
     self._value = value
     self._tree = jax.tree.structure(value)
-    register_pytree_cls(self.__class__)
+    self._check_tree = False
+    self._level = len(thread_local_stack.stack)
+    self._source_info = source_info_util.current()
 
   @property
-  def value(self):
+  def value(self) -> PyTree:
     """
     The data and its value.
     """
+    self._check_if_deleted()
+
+    # read the value by the stack (>= level)
+    trace: StateTrace
+    for trace in thread_local_stack.stack[self._level:]:
+      trace.read_its_value(self)
+    # return the value
     return self._value
 
   @value.setter
-  def value(self, v):
+  def value(self, v) -> None:
+    """
+    Set the value of the state.
+
+    Args:
+      v: The value.
+    """
+    # value checking
     v = v.value if isinstance(v, State) else v
     self.__check_value(v)
+    # write the value by the stack (>= level)
+    trace: StateTrace
+    for trace in thread_local_stack.stack[self._level:]:
+      trace.write_its_value(self)
+    # set the value
     self._value = v
 
   def __check_value(self, v):
-    in_tree = jax.tree_util.tree_structure(v)
-    if in_tree != self._tree:
-      raise ValueError(f'The given value {in_tree} does not match with the origin tree structure {self._tree}.')
+    if self._check_tree or _global_context_to_check_state_tree[-1]:
+      in_tree = jax.tree_util.tree_structure(v)
+      if in_tree != self._tree:
+        name_stack = source_info_util.current_name_stack() + self.source_info.name_stack
+        with source_info_util.user_context(self.source_info.traceback, name_stack=name_stack):
+          raise ValueError(f'The given value {in_tree} does not match with the origin tree structure {self._tree}.')
+
+  def _check_if_deleted(self):
+    pass
+
+  @property
+  def source_info(self) -> source_info_util.SourceInfo:
+    """
+    The source information of the state, can be useful to identify
+    the source code where the definition of the state.
+
+    Returns:
+      The source information.
+    """
+    return self._source_info
 
   def tree_flatten(self):
     """Flattens this variable.
 
     Returns:
       A pair where the first element is a list of leaf values
       and the second element is a treedef representing the
       structure of the flattened tree.
     """
-    return (self._value,), None
+    return (self._value,), (self._level,)
 
   @classmethod
   def tree_unflatten(cls, aux_data, flat_contents):
     """Reconstructs a variable from the aux_data and the leaves.
 
     Args:
       aux_data:
       flat_contents:
 
     Returns:
       The variable.
     """
-    return cls(flat_contents[0], )
+    (_level,) = aux_data
+    self = cls(flat_contents[0])
+    self._level = max_int
+    return self
+
+  def __repr__(self):
+    leaves, tree = jax.tree.flatten(self._value)
+    leaves_info = [ShapeDtype(leaf.shape, leaf.dtype) for leaf in leaves]
+    tree_info = jax.tree.unflatten(tree, leaves_info)
+    return f'{self.__class__.__name__}({tree_info})'
+
+
+class ShapeDtype:
+  def __init__(self, shape, dtype):
+    self.shape = shape
+    self.dtype = dtype
 
   def __repr__(self):
-    return f'{self.__class__.__name__}({self._value})'
+    return f'{self.dtype}{list(self.shape)}'
+
+
+class ShortTermState(State):
+  """
+  The short-term state, which is used to store the short-term data in the program.
+
+  For example, in a training process, the gradients of the model are short-term states.
+  """
+
+  __module__ = 'braincore'
+
+
+class LongTermState(State):
+  """
+  The long-term state, which is used to store the long-term data in the program.
+
+  For example, in a training process, the weights of the model are long-term states.
+
+  """
+
+  __module__ = 'braincore'
 
 
-class ParamState(State):
+class ParamState(LongTermState):
   __module__ = 'braincore'
 
 
-@jax.tree_util.register_pytree_node_class
-class StateStack(Stack):
+class StateDictManager(DictManager):
   """
   State stack, for collecting all :py:class:`~.State` used in the program.
 
-  :py:class:`~.StateStack` supports all features of python dict.
+  :py:class:`~.StateDictManager` supports all features of python dict.
   """
 
   __module__ = 'braincore'
 
   def assign_values(self, *args: Dict) -> None:
     """
     Assign the value for each element according to the given ``data``.
@@ -103,51 +241,130 @@
       for k, v in arg.items():
         self._set_elem(k, v)
 
   def split_values(self, *filters: type) -> Tuple[Dict, ...]:
     """
     Split the values into several subsets of stack by the given types.
     """
-    results = tuple(Stack() for _ in range(len(filters) + 1))
+    results = tuple(DictManager() for _ in range(len(filters) + 1))
     for k, v in self.items():
       for i, filt in enumerate(filters):
         if isinstance(v, filt):
           results[i][k] = v.value
           break
       else:
         results[-1][k] = v.value
     return results
 
   def collect_values(self) -> Dict:
     """
     Collect the values by the given types.
     """
-    results = Stack()
+    results = DictManager()
     for k, v in self.items():
       results[k] = v.value
     return results
 
-  def split(self, first: type, *others: type) -> Tuple['StateStack', ...]:
+  def split(self, first: type, *others: type) -> Tuple['StateDictManager', ...]:
     return super().split(first, *others)
 
+  def to_dict_values(self) -> Dict:
+    """
+    Convert the values into a dict.
+    """
+    return {k: v.value for k, v in self.items()}
+
   def _check_elem(self, elem):
     assert isinstance(elem, State), f'must be instance of {State}'
 
   def _set_elem(self, key: Any, value: Any) -> None:
     self[key].value = value
 
 
-def stack_compose(first: dict, *others: dict):
+class visible_state_dict(StateDictManager):
+  """
+  The state dictionary whose elements are visible to ``.states()`` collection functions.
   """
-  Compose multiple dictionaries as a ``Stack``.
+  pass
 
-  Args:
-    first: The dict.
-    others: Dicts.
 
-  Returns:
-    stack: The composed stack.
+class StateTrace(object):
+  """
+  The state trace, which is used to trace the states automatically.
   """
-  stack = StateStack(first)
-  for oth in others:
-    stack.update(oth)
-  return stack
+
+  def __init__(self, new_arg: Callable = None):
+    self.states: List[State] = []
+    self.types: List[str] = []
+    self._id2index = dict()
+    self._org_values = []
+    self._jax_trace_new_arg = new_arg
+    self._written_ids = set()
+
+  def set_new_arg(self, new_arg: Callable) -> None:
+    self._jax_trace_new_arg = new_arg
+
+  def new_arg(self, state: State) -> None:
+    if self._jax_trace_new_arg is not None:
+      # internal use
+      state._value = jax.tree.map(lambda x: self._jax_trace_new_arg(shaped_abstractify(x)), state._value)
+
+  def __enter__(self) -> 'StateTrace':
+    thread_local_stack.stack.append(self)
+    return self
+
+  def __exit__(self, exc_type: Any, exc_value: Any, traceback: Any) -> None:
+    thread_local_stack.stack.pop()
+
+  def read_its_value(self, state: State) -> None:
+    """
+    Read the value of the state.
+
+    Args:
+      state: The state.
+    """
+    id_ = id(state)
+    if id_ not in self._id2index:
+      self._id2index[id_] = len(self.states)
+      self.states.append(state)
+      self.types.append('read')
+      self._org_values.append(state._value)  # internal use
+      self.new_arg(state)
+
+  def write_its_value(self, state: State) -> None:
+    """
+    Write the value of the state.
+
+    Args:
+      state: The state.
+    """
+    id_ = id(state)
+    if id_ not in self._id2index:
+      self.read_its_value(state)
+    if id_ not in self._written_ids:
+      index = self._id2index[id_]
+      self.types[index] = 'write'
+      self._written_ids.add(id_)
+
+  def collect_values(self, *categories: str) -> Tuple:
+    """
+    Collect the values by the given categories.
+
+    Args:
+      *categories: The categories.
+
+    Returns:
+      results: The values.
+    """
+    results = []
+    for st, ty in zip(self.states, self.types):
+      if ty in categories:
+        results.append(st.value)
+    return tuple(results)
+
+  def recovery_original_values(self) -> None:
+    """
+    Recovery the original values.
+    """
+    for st, val in zip(self.states, self._org_values):
+      # internal use
+      st._value = val
```

## braincore/environ.py

```diff
@@ -8,15 +8,15 @@
 from collections import defaultdict
 from typing import Union
 
 import numpy as np
 from jax import config, devices, numpy as jnp
 from jax._src.typing import DTypeLike
 
-from ._utils import MemScaling, IdMemScaling
+from .util import MemScaling, IdMemScaling
 from .mixin import Mode
 
 __all__ = [
   'set', 'context', 'get', 'all',
   'set_host_device_count', 'set_platform', 'set_gpu_preallocation',
   'get_host_device_count', 'get_platform', 'get_dt', 'get_mode', 'get_mem_scaling', 'get_precision',
   'tolerance',
@@ -49,17 +49,14 @@
   """
   if 'platform' in kwargs:
     raise ValueError('Cannot set platform in environment context. '
                      'Please use set_platform() or set() for the global setting.')
   if 'host_device_count' in kwargs:
     raise ValueError('Cannot set host_device_count in environment context. '
                      'Please use set_host_device_count() or set() for the global setting.')
-  if 'gpu_preallocation' in kwargs:
-    raise ValueError('Cannot set gpu_preallocation in environment context. '
-                     'Please use set_gpu_preallocation() or set() for the global setting.')
   if 'precision' in kwargs:
     last_precision = get_precision()
     _set_jax_precision(kwargs['precision'])
 
   try:
     # update the current environment
     for k, v in kwargs.items():
@@ -178,29 +175,34 @@
   """
   return get('precision')
 
 
 def set(
     platform: str = None,
     host_device_count: int = None,
-    gpu_preallocation: Union[float, bool] = None,
     mem_scaling: MemScaling = None,
     precision: int = None,
     mode: Mode = None,
     **kwargs
 ):
   """
   Set the global default computation environment.
+
+  Args:
+    platform: str. The computing platform. Either 'cpu', 'gpu' or 'tpu'.
+    host_device_count: int. The number of host devices.
+    mem_scaling: MemScaling. The membrane scaling.
+    precision: int. The default precision.
+    mode: Mode. The computing mode.
+    **kwargs: dict. Other environment settings.
   """
   if platform is not None:
     set_platform(platform)
   if host_device_count is not None:
     set_host_device_count(host_device_count)
-  if gpu_preallocation is not None:
-    set_gpu_preallocation(gpu_preallocation)
   if mem_scaling is not None:
     assert isinstance(mem_scaling, MemScaling), 'mem_scaling must be a MemScaling instance.'
     kwargs['mem_scaling'] = mem_scaling
   if precision is not None:
     _set_jax_precision(precision)
     kwargs['precision'] = precision
   if mode is not None:
@@ -252,52 +254,14 @@
   assert precision in [64, 32, 16, 8], f'Precision must be in [64, 32, 16, 8]. But got {precision}.'
   if precision == 64:
     config.update("jax_enable_x64", True)
   else:
     config.update("jax_enable_x64", False)
 
 
-def _disable_gpu_memory_preallocation(release_memory: bool = True):
-  """Disable pre-allocating the GPU memory.
-
-  This disables the preallocation behavior. JAX will instead allocate GPU memory as needed,
-  potentially decreasing the overall memory usage. However, this behavior is more prone to
-  GPU memory fragmentation, meaning a JAX program that uses most of the available GPU memory
-  may OOM with preallocation disabled.
-
-  Args:
-    release_memory: bool. Whether we release memory during the computation.
-  """
-  os.environ['XLA_PYTHON_CLIENT_PREALLOCATE'] = 'false'
-  if release_memory:
-    os.environ['XLA_PYTHON_CLIENT_ALLOCATOR'] = 'platform'
-
-
-def _enable_gpu_memory_preallocation():
-  """Disable pre-allocating the GPU memory."""
-  os.environ['XLA_PYTHON_CLIENT_PREALLOCATE'] = 'true'
-  os.environ.pop('XLA_PYTHON_CLIENT_ALLOCATOR', None)
-
-
-def set_gpu_preallocation(mode: Union[float, bool]):
-  """GPU memory allocation.
-
-  If preallocation is enabled, this makes JAX preallocate ``percent`` of the total GPU memory,
-  instead of the default 75%. Lowering the amount preallocated can fix OOMs that occur when the JAX program starts.
-  """
-  if mode is False:
-    _disable_gpu_memory_preallocation()
-    return
-  if mode is True:
-    _enable_gpu_memory_preallocation()
-    return
-  assert isinstance(mode, float) and 0. <= mode < 1., f'GPU memory preallocation must be in [0., 1.]. But got {mode}.'
-  os.environ['XLA_PYTHON_CLIENT_MEM_FRACTION'] = str(mode)
-
-
 @functools.lru_cache()
 def _get_uint(precision: int):
   if precision == 64:
     return np.uint64
   elif precision == 32:
     return np.uint32
   elif precision == 16:
@@ -380,8 +344,8 @@
     return jnp.array(1e-12, dtype=np.float64)
   elif get_precision() == 32:
     return jnp.array(1e-5, dtype=np.float32)
   else:
     return jnp.array(1e-2, dtype=np.float16)
 
 
-set(dt=0.1, precision=32, mode=Mode(), mem_scaling=IdMemScaling(), platform='cpu')
+set(dt=0.1, precision=32, mode=Mode(), mem_scaling=IdMemScaling())
```

## braincore/mixin.py

```diff
@@ -1,7 +1,22 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
 # -*- coding: utf-8 -*-
 
 from typing import Sequence, Optional, TypeVar, Any
 from typing import (_SpecialForm, _type_check, _remove_dups_flatten, _UnionGenericAlias)
 
 T = TypeVar('T')
 PyTree = Any
@@ -315,15 +330,15 @@
     for m_ in modes:
       if not isinstance(m_, Mode):
         raise TypeError(f'The supported type must be a tuple/list of Mode. But we got {m_}')
     self.modes = tuple(modes)
     self.types = set([m.__class__ for m in modes])
 
   def __repr__(self):
-    return f'{self.__class__.__name__}({", ".join([m.__name__ for m in self.modes])})'
+    return f'{self.__class__.__name__}({", ".join([repr(m) for m in self.modes])})'
 
   def has(self, mode: type):
     """
     Check whether the mode is included in the desired mode.
     """
     assert isinstance(mode, type), 'Must be a type.'
     return any([issubclass(cls, mode) for cls in self.types])
@@ -352,13 +367,13 @@
   """Batching mode."""
 
   def __init__(self, batch_size: int = 1, batch_axis: int = 0):
     self.batch_size = batch_size
     self.batch_axis = batch_axis
 
   def __repr__(self):
-    return f'{self.__class__.__name__}(batch_size={self.batch_size}, batch_axis={self.batch_axis})'
+    return f'{self.__class__.__name__}(size={self.batch_size}, axis={self.batch_axis})'
 
 
 class Training(Mode):
   """Training mode."""
   pass
```

## braincore/random.py

```diff
@@ -1,11487 +1,11582 @@
-00000000: 2320 2d2a 2d20 636f 6469 6e67 3a20 7574  # -*- coding: ut
-00000010: 662d 3820 2d2a 2d0d 0a0d 0a22 2222 0d0a  f-8 -*-...."""..
-00000020: 544f 444f 3a0d 0a20 202d 205b 205d 2041  TODO:..  - [ ] A
-00000030: 6464 206d 6f72 6520 7465 7374 7320 666f  dd more tests fo
-00000040: 7220 7261 6e64 6f6d 2066 756e 6374 696f  r random functio
-00000050: 6e73 2e0d 0a20 202d 205b 205d 2077 6974  ns...  - [ ] wit
-00000060: 6820 7265 7370 6563 7420 746f 2074 6865  h respect to the
-00000070: 2064 6566 6175 6c74 2064 7479 7065 2069   default dtype i
-00000080: 6e20 2060 6065 6e76 6972 6f6e 6060 206d  n  ``environ`` m
-00000090: 6f64 756c 650d 0a0d 0a22 2222 0d0a 0d0a  odule...."""....
-000000a0: 6672 6f6d 2063 6f6c 6c65 6374 696f 6e73  from collections
-000000b0: 2069 6d70 6f72 7420 6e61 6d65 6474 7570   import namedtup
-000000c0: 6c65 0d0a 6672 6f6d 2066 756e 6374 6f6f  le..from functoo
-000000d0: 6c73 2069 6d70 6f72 7420 7061 7274 6961  ls import partia
-000000e0: 6c0d 0a66 726f 6d20 6f70 6572 6174 6f72  l..from operator
-000000f0: 2069 6d70 6f72 7420 696e 6465 780d 0a66   import index..f
-00000100: 726f 6d20 7479 7069 6e67 2069 6d70 6f72  rom typing impor
-00000110: 7420 4f70 7469 6f6e 616c 2c20 556e 696f  t Optional, Unio
-00000120: 6e2c 2053 6571 7565 6e63 650d 0a0d 0a69  n, Sequence....i
-00000130: 6d70 6f72 7420 6a61 780d 0a69 6d70 6f72  mport jax..impor
-00000140: 7420 6e75 6d70 7920 6173 206e 700d 0a66  t numpy as np..f
-00000150: 726f 6d20 6a61 7820 696d 706f 7274 206c  rom jax import l
-00000160: 6178 2c20 6a69 742c 2076 6d61 702c 206e  ax, jit, vmap, n
-00000170: 756d 7079 2061 7320 6a6e 702c 2072 616e  umpy as jnp, ran
-00000180: 646f 6d20 6173 206a 722c 2063 6f72 652c  dom as jr, core,
-00000190: 2064 7479 7065 730d 0a66 726f 6d20 6a61   dtypes..from ja
-000001a0: 782e 5f73 7263 2e61 7272 6179 2069 6d70  x._src.array imp
-000001b0: 6f72 7420 4172 7261 7949 6d70 6c0d 0a66  ort ArrayImpl..f
-000001c0: 726f 6d20 6a61 782e 5f73 7263 2e74 7970  rom jax._src.typ
-000001d0: 696e 6720 696d 706f 7274 2044 5479 7065  ing import DType
-000001e0: 4c69 6b65 0d0a 6672 6f6d 206a 6178 2e65  Like..from jax.e
-000001f0: 7870 6572 696d 656e 7461 6c2e 686f 7374  xperimental.host
-00000200: 5f63 616c 6c62 6163 6b20 696d 706f 7274  _callback import
-00000210: 2063 616c 6c0d 0a0d 0a66 726f 6d20 6272   call....from br
-00000220: 6169 6e63 6f72 6520 696d 706f 7274 2065  aincore import e
-00000230: 6e76 6972 6f6e 0d0a 6672 6f6d 202e 5f73  nviron..from ._s
-00000240: 7461 7465 2069 6d70 6f72 7420 5374 6174  tate import Stat
-00000250: 650d 0a66 726f 6d20 2e5f 7574 696c 7320  e..from ._utils 
-00000260: 696d 706f 7274 206a 6974 5f65 7272 6f72  import jit_error
-00000270: 0d0a 0d0a 5369 7a65 203d 2055 6e69 6f6e  ....Size = Union
-00000280: 5b69 6e74 2c20 5365 7175 656e 6365 5b69  [int, Sequence[i
-00000290: 6e74 5d5d 0d0a 5365 6564 4f72 4b65 7920  nt]]..SeedOrKey 
-000002a0: 3d20 556e 696f 6e5b 696e 742c 206a 6178  = Union[int, jax
-000002b0: 2e41 7272 6179 2c20 6e70 2e6e 6461 7272  .Array, np.ndarr
-000002c0: 6179 5d0d 0a0d 0a5f 5f61 6c6c 5f5f 203d  ay]....__all__ =
-000002d0: 205b 0d0a 2020 2752 616e 646f 6d53 7461   [..  'RandomSta
-000002e0: 7465 272c 2027 4445 4641 554c 5427 2c0d  te', 'DEFAULT',.
-000002f0: 0a0d 0a20 2027 7365 6564 272c 2027 6465  ...  'seed', 'de
-00000300: 6661 756c 745f 726e 6727 2c20 2773 706c  fault_rng', 'spl
-00000310: 6974 5f6b 6579 272c 2027 7370 6c69 745f  it_key', 'split_
-00000320: 6b65 7973 272c 0d0a 0d0a 2020 2320 6e75  keys',....  # nu
-00000330: 6d70 7920 636f 6d70 6174 6962 696c 6974  mpy compatibilit
-00000340: 790d 0a20 2027 7261 6e64 272c 2027 7261  y..  'rand', 'ra
-00000350: 6e64 696e 7427 2c20 2772 616e 646f 6d5f  ndint', 'random_
-00000360: 696e 7465 6765 7273 272c 2027 7261 6e64  integers', 'rand
-00000370: 6e27 2c20 2772 616e 646f 6d27 2c0d 0a20  n', 'random',.. 
-00000380: 2027 7261 6e64 6f6d 5f73 616d 706c 6527   'random_sample'
-00000390: 2c20 2772 616e 6627 2c20 2773 616d 706c  , 'ranf', 'sampl
-000003a0: 6527 2c20 2763 686f 6963 6527 2c20 2770  e', 'choice', 'p
-000003b0: 6572 6d75 7461 7469 6f6e 272c 2027 7368  ermutation', 'sh
-000003c0: 7566 666c 6527 2c20 2762 6574 6127 2c0d  uffle', 'beta',.
-000003d0: 0a20 2027 6578 706f 6e65 6e74 6961 6c27  .  'exponential'
-000003e0: 2c20 2767 616d 6d61 272c 2027 6775 6d62  , 'gamma', 'gumb
-000003f0: 656c 272c 2027 6c61 706c 6163 6527 2c20  el', 'laplace', 
-00000400: 276c 6f67 6973 7469 6327 2c20 276e 6f72  'logistic', 'nor
-00000410: 6d61 6c27 2c20 2770 6172 6574 6f27 2c0d  mal', 'pareto',.
-00000420: 0a20 2027 706f 6973 736f 6e27 2c20 2773  .  'poisson', 's
-00000430: 7461 6e64 6172 645f 6361 7563 6879 272c  tandard_cauchy',
-00000440: 2027 7374 616e 6461 7264 5f65 7870 6f6e   'standard_expon
-00000450: 656e 7469 616c 272c 2027 7374 616e 6461  ential', 'standa
-00000460: 7264 5f67 616d 6d61 272c 0d0a 2020 2773  rd_gamma',..  's
-00000470: 7461 6e64 6172 645f 6e6f 726d 616c 272c  tandard_normal',
-00000480: 2027 7374 616e 6461 7264 5f74 272c 2027   'standard_t', '
-00000490: 756e 6966 6f72 6d27 2c20 2774 7275 6e63  uniform', 'trunc
-000004a0: 6174 6564 5f6e 6f72 6d61 6c27 2c20 2762  ated_normal', 'b
-000004b0: 6572 6e6f 756c 6c69 272c 0d0a 2020 276c  ernoulli',..  'l
-000004c0: 6f67 6e6f 726d 616c 272c 2027 6269 6e6f  ognormal', 'bino
-000004d0: 6d69 616c 272c 2027 6368 6973 7175 6172  mial', 'chisquar
-000004e0: 6527 2c20 2764 6972 6963 686c 6574 272c  e', 'dirichlet',
-000004f0: 2027 6765 6f6d 6574 7269 6327 2c20 2766   'geometric', 'f
-00000500: 272c 0d0a 2020 2768 7970 6572 6765 6f6d  ',..  'hypergeom
-00000510: 6574 7269 6327 2c20 276c 6f67 7365 7269  etric', 'logseri
-00000520: 6573 272c 2027 6d75 6c74 696e 6f6d 6961  es', 'multinomia
-00000530: 6c27 2c20 276d 756c 7469 7661 7269 6174  l', 'multivariat
-00000540: 655f 6e6f 726d 616c 272c 0d0a 2020 276e  e_normal',..  'n
-00000550: 6567 6174 6976 655f 6269 6e6f 6d69 616c  egative_binomial
-00000560: 272c 2027 6e6f 6e63 656e 7472 616c 5f63  ', 'noncentral_c
-00000570: 6869 7371 7561 7265 272c 2027 6e6f 6e63  hisquare', 'nonc
-00000580: 656e 7472 616c 5f66 272c 2027 706f 7765  entral_f', 'powe
-00000590: 7227 2c0d 0a20 2027 7261 796c 6569 6768  r',..  'rayleigh
-000005a0: 272c 2027 7472 6961 6e67 756c 6172 272c  ', 'triangular',
-000005b0: 2027 766f 6e6d 6973 6573 272c 2027 7761   'vonmises', 'wa
-000005c0: 6c64 272c 2027 7765 6962 756c 6c27 2c20  ld', 'weibull', 
-000005d0: 2777 6569 6275 6c6c 5f6d 696e 272c 0d0a  'weibull_min',..
-000005e0: 2020 277a 6970 6627 2c20 276d 6178 7765    'zipf', 'maxwe
-000005f0: 6c6c 272c 2027 7427 2c20 276f 7274 686f  ll', 't', 'ortho
-00000600: 676f 6e61 6c27 2c20 276c 6f67 6761 6d6d  gonal', 'loggamm
-00000610: 6127 2c20 2763 6174 6567 6f72 6963 616c  a', 'categorical
-00000620: 272c 0d0a 0d0a 2020 2320 7079 746f 7263  ',....  # pytorc
-00000630: 6820 636f 6d70 6174 6962 696c 6974 790d  h compatibility.
-00000640: 0a20 2027 7261 6e64 5f6c 696b 6527 2c20  .  'rand_like', 
-00000650: 2772 616e 6469 6e74 5f6c 696b 6527 2c20  'randint_like', 
-00000660: 2772 616e 646e 5f6c 696b 6527 2c0d 0a5d  'randn_like',..]
-00000670: 0d0a 0d0a 0d0a 636c 6173 7320 5261 6e64  ......class Rand
-00000680: 6f6d 5374 6174 6528 5374 6174 6529 3a0d  omState(State):.
-00000690: 0a20 2022 2222 5261 6e64 6f6d 5374 6174  .  """RandomStat
-000006a0: 6520 7468 6174 2074 7261 636b 2074 6865  e that track the
-000006b0: 2072 616e 646f 6d20 6765 6e65 7261 746f   random generato
-000006c0: 7220 7374 6174 652e 2022 2222 0d0a 2020  r state. """..  
-000006d0: 5f5f 736c 6f74 735f 5f20 3d20 2829 0d0a  __slots__ = ()..
-000006e0: 0d0a 2020 6465 6620 5f5f 696e 6974 5f5f  ..  def __init__
-000006f0: 2873 656c 662c 2073 6565 645f 6f72 5f6b  (self, seed_or_k
-00000700: 6579 3a20 4f70 7469 6f6e 616c 5b53 6565  ey: Optional[See
-00000710: 644f 724b 6579 5d20 3d20 4e6f 6e65 293a  dOrKey] = None):
-00000720: 0d0a 2020 2020 2222 2252 616e 646f 6d53  ..    """RandomS
-00000730: 7461 7465 2063 6f6e 7374 7275 6374 6f72  tate constructor
-00000740: 2e0d 0a0d 0a20 2020 2050 6172 616d 6574  .....    Paramet
-00000750: 6572 730d 0a20 2020 202d 2d2d 2d2d 2d2d  ers..    -------
-00000760: 2d2d 2d0d 0a20 2020 2073 6565 645f 6f72  ---..    seed_or
-00000770: 5f6b 6579 3a20 696e 742c 2041 7272 6179  _key: int, Array
-00000780: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-00000790: 2020 4974 2063 616e 2062 6520 616e 2069    It can be an i
-000007a0: 6e74 6567 6572 2066 6f72 2069 6e69 7469  nteger for initi
-000007b0: 616c 2073 6565 6420 6f66 2074 6865 2072  al seed of the r
-000007c0: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
-000007d0: 6572 6174 6f72 2c0d 0a20 2020 2020 206f  erator,..      o
-000007e0: 7220 6974 2063 616e 2062 6520 6120 4a41  r it can be a JA
-000007f0: 5827 7320 5052 4e4b 6579 2c20 7768 6963  X's PRNKey, whic
-00000800: 6820 6973 2061 6e20 6172 7261 7920 7769  h is an array wi
-00000810: 7468 2074 776f 2065 6c65 6d65 6e74 7320  th two elements 
-00000820: 616e 6420 6075 696e 7433 3260 2064 7479  and `uint32` dty
-00000830: 7065 2e0d 0a20 2020 2022 2222 0d0a 2020  pe...    """..  
-00000840: 2020 7769 7468 206a 6178 2e65 6e73 7572    with jax.ensur
-00000850: 655f 636f 6d70 696c 655f 7469 6d65 5f65  e_compile_time_e
-00000860: 7661 6c28 293a 0d0a 2020 2020 2020 6966  val():..      if
-00000870: 2073 6565 645f 6f72 5f6b 6579 2069 7320   seed_or_key is 
-00000880: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2073  None:..        s
-00000890: 6565 645f 6f72 5f6b 6579 203d 206e 702e  eed_or_key = np.
-000008a0: 7261 6e64 6f6d 2e72 616e 6469 6e74 2830  random.randint(0
-000008b0: 2c20 3130 3030 3030 2c20 322c 2064 7479  , 100000, 2, dty
-000008c0: 7065 3d6e 702e 7569 6e74 3332 290d 0a20  pe=np.uint32).. 
-000008d0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-000008e0: 2873 6565 645f 6f72 5f6b 6579 2c20 696e  (seed_or_key, in
-000008f0: 7429 3a0d 0a20 2020 2020 206b 6579 203d  t):..      key =
-00000900: 206a 722e 5052 4e47 4b65 7928 7365 6564   jr.PRNGKey(seed
-00000910: 5f6f 725f 6b65 7929 0d0a 2020 2020 656c  _or_key)..    el
-00000920: 7365 3a0d 0a20 2020 2020 2069 6620 6c65  se:..      if le
-00000930: 6e28 7365 6564 5f6f 725f 6b65 7929 2021  n(seed_or_key) !
-00000940: 3d20 3220 616e 6420 7365 6564 5f6f 725f  = 2 and seed_or_
-00000950: 6b65 792e 6474 7970 6520 213d 206e 702e  key.dtype != np.
-00000960: 7569 6e74 3332 3a0d 0a20 2020 2020 2020  uint32:..       
-00000970: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00000980: 7228 276b 6579 206d 7573 7420 6265 2061  r('key must be a
-00000990: 6e20 6172 7261 7920 7769 7468 2064 7479  n array with dty
-000009a0: 7065 2075 696e 7433 322e 2027 0d0a 2020  pe uint32. '..  
-000009b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000009c0: 2020 2020 2020 2066 2742 7574 2077 6520         f'But we 
-000009d0: 676f 7420 7b73 6565 645f 6f72 5f6b 6579  got {seed_or_key
-000009e0: 7d27 290d 0a20 2020 2020 206b 6579 203d  }')..      key =
-000009f0: 2073 6565 645f 6f72 5f6b 6579 0d0a 2020   seed_or_key..  
-00000a00: 2020 7375 7065 7228 292e 5f5f 696e 6974    super().__init
-00000a10: 5f5f 286b 6579 290d 0a0d 0a20 2064 6566  __(key)....  def
-00000a20: 205f 5f72 6570 725f 5f28 7365 6c66 2920   __repr__(self) 
-00000a30: 2d3e 2073 7472 3a0d 0a20 2020 2070 7269  -> str:..    pri
-00000a40: 6e74 5f63 6f64 6520 3d20 7265 7072 2873  nt_code = repr(s
-00000a50: 656c 662e 7661 6c75 6529 0d0a 2020 2020  elf.value)..    
-00000a60: 6920 3d20 7072 696e 745f 636f 6465 2e69  i = print_code.i
-00000a70: 6e64 6578 2827 2827 290d 0a20 2020 2072  ndex('(')..    r
-00000a80: 6574 7572 6e20 6627 7b73 656c 662e 5f5f  eturn f'{self.__
-00000a90: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
-00000aa0: 7d28 6b65 793d 7b70 7269 6e74 5f63 6f64  }(key={print_cod
-00000ab0: 655b 693a 5d7d 2927 0d0a 0d0a 2020 4070  e[i:]})'....  @p
-00000ac0: 726f 7065 7274 790d 0a20 2064 6566 2076  roperty..  def v
-00000ad0: 616c 7565 2873 656c 6629 3a0d 0a20 2020  alue(self):..   
-00000ae0: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
-00000af0: 656c 662e 5f76 616c 7565 2c20 4172 7261  elf._value, Arra
-00000b00: 7949 6d70 6c29 3a0d 0a20 2020 2020 2069  yImpl):..      i
-00000b10: 6620 7365 6c66 2e5f 7661 6c75 652e 6973  f self._value.is
-00000b20: 5f64 656c 6574 6564 2829 3a0d 0a20 2020  _deleted():..   
-00000b30: 2020 2020 2073 656c 662e 7365 6564 2829       self.seed()
-00000b40: 0d0a 2020 2020 7265 7475 726e 2073 656c  ..    return sel
-00000b50: 662e 5f76 616c 7565 0d0a 0d0a 2020 4076  f._value....  @v
-00000b60: 616c 7565 2e73 6574 7465 720d 0a20 2064  alue.setter..  d
-00000b70: 6566 2076 616c 7565 2873 656c 662c 2076  ef value(self, v
-00000b80: 616c 7565 293a 0d0a 2020 2020 7365 6c66  alue):..    self
-00000b90: 2e5f 7661 6c75 6520 3d20 7661 6c75 650d  ._value = value.
-00000ba0: 0a0d 0a20 2023 202d 2d2d 2d2d 2d2d 2d2d  ...  # ---------
-00000bb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2023 0d0a 2020  ---------- #..  
-00000bc0: 2320 7365 6564 2061 6e64 2072 616e 646f  # seed and rando
-00000bd0: 6d20 6b65 7920 230d 0a20 2023 202d 2d2d  m key #..  # ---
-00000be0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000bf0: 2023 0d0a 0d0a 2020 6465 6620 636c 6f6e   #....  def clon
-00000c00: 6528 7365 6c66 293a 0d0a 2020 2020 7265  e(self):..    re
-00000c10: 7475 726e 2074 7970 6528 7365 6c66 2928  turn type(self)(
-00000c20: 7365 6c66 2e73 706c 6974 5f6b 6579 2829  self.split_key()
-00000c30: 290d 0a0d 0a20 2064 6566 2073 6565 6428  )....  def seed(
-00000c40: 7365 6c66 2c20 7365 6564 5f6f 725f 6b65  self, seed_or_ke
-00000c50: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
-00000c60: 4f72 4b65 795d 203d 204e 6f6e 6529 3a0d  OrKey] = None):.
-00000c70: 0a20 2020 2022 2222 5365 7473 2061 206e  .    """Sets a n
-00000c80: 6577 2072 616e 646f 6d20 7365 6564 2e0d  ew random seed..
-00000c90: 0a0d 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-00000ca0: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
-00000cb0: 2d0d 0a20 2020 2073 6565 645f 6f72 5f6b  -..    seed_or_k
-00000cc0: 6579 3a20 696e 742c 2041 7272 6179 5479  ey: int, ArrayTy
-00000cd0: 7065 2c20 6f70 7469 6f6e 616c 0d0a 2020  pe, optional..  
-00000ce0: 2020 2020 4974 2063 616e 2062 6520 616e      It can be an
-00000cf0: 2069 6e74 6567 6572 2066 6f72 2069 6e69   integer for ini
-00000d00: 7469 616c 2073 6565 6420 6f66 2074 6865  tial seed of the
-00000d10: 2072 616e 646f 6d20 6e75 6d62 6572 2067   random number g
-00000d20: 656e 6572 6174 6f72 2c0d 0a20 2020 2020  enerator,..     
-00000d30: 206f 7220 6974 2063 616e 2062 6520 6120   or it can be a 
-00000d40: 4a41 5827 7320 5052 4e4b 6579 2c20 7768  JAX's PRNKey, wh
-00000d50: 6963 6820 6973 2061 6e20 6172 7261 7920  ich is an array 
-00000d60: 7769 7468 2074 776f 2065 6c65 6d65 6e74  with two element
-00000d70: 7320 616e 6420 6075 696e 7433 3260 2064  s and `uint32` d
-00000d80: 7479 7065 2e0d 0a20 2020 2022 2222 0d0a  type...    """..
-00000d90: 2020 2020 6966 2073 6565 645f 6f72 5f6b      if seed_or_k
-00000da0: 6579 2069 7320 4e6f 6e65 3a0d 0a20 2020  ey is None:..   
-00000db0: 2020 2073 6565 645f 6f72 5f6b 6579 203d     seed_or_key =
-00000dc0: 206e 702e 7261 6e64 6f6d 2e72 616e 6469   np.random.randi
-00000dd0: 6e74 2830 2c20 3130 3030 3030 2c20 322c  nt(0, 100000, 2,
-00000de0: 2064 7479 7065 3d6e 702e 7569 6e74 3332   dtype=np.uint32
-00000df0: 290d 0a20 2020 2069 6620 6973 696e 7374  )..    if isinst
-00000e00: 616e 6365 2873 6565 645f 6f72 5f6b 6579  ance(seed_or_key
-00000e10: 2c20 696e 7429 3a0d 0a20 2020 2020 206b  , int):..      k
-00000e20: 6579 203d 206a 722e 5052 4e47 4b65 7928  ey = jr.PRNGKey(
-00000e30: 7365 6564 5f6f 725f 6b65 7929 0d0a 2020  seed_or_key)..  
-00000e40: 2020 656c 7365 3a0d 0a20 2020 2020 2069    else:..      i
-00000e50: 6620 6c65 6e28 7365 6564 5f6f 725f 6b65  f len(seed_or_ke
-00000e60: 7929 2021 3d20 3220 616e 6420 7365 6564  y) != 2 and seed
-00000e70: 5f6f 725f 6b65 792e 6474 7970 6520 213d  _or_key.dtype !=
-00000e80: 206e 702e 7569 6e74 3332 3a0d 0a20 2020   np.uint32:..   
-00000e90: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00000ea0: 4572 726f 7228 276b 6579 206d 7573 7420  Error('key must 
-00000eb0: 6265 2061 6e20 6172 7261 7920 7769 7468  be an array with
-00000ec0: 2064 7479 7065 2075 696e 7433 322e 2027   dtype uint32. '
-00000ed0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000ee0: 2020 2020 2020 2020 2020 2066 2742 7574             f'But
-00000ef0: 2077 6520 676f 7420 7b73 6565 645f 6f72   we got {seed_or
-00000f00: 5f6b 6579 7d27 290d 0a20 2020 2020 206b  _key}')..      k
-00000f10: 6579 203d 2073 6565 645f 6f72 5f6b 6579  ey = seed_or_key
-00000f20: 0d0a 2020 2020 7365 6c66 2e76 616c 7565  ..    self.value
-00000f30: 203d 206b 6579 0d0a 0d0a 2020 6465 6620   = key....  def 
-00000f40: 7370 6c69 745f 6b65 7928 7365 6c66 293a  split_key(self):
-00000f50: 0d0a 2020 2020 2222 2243 7265 6174 6520  ..    """Create 
-00000f60: 6120 6e65 7720 7365 6564 2066 726f 6d20  a new seed from 
-00000f70: 7468 6520 6375 7272 656e 7420 7365 6564  the current seed
-00000f80: 2e0d 0a20 2020 2022 2222 0d0a 2020 2020  ...    """..    
-00000f90: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00000fa0: 6528 7365 6c66 2e76 616c 7565 2c20 6a61  e(self.value, ja
-00000fb0: 782e 4172 7261 7929 3a0d 0a20 2020 2020  x.Array):..     
-00000fc0: 2073 656c 662e 5f76 616c 7565 203d 206a   self._value = j
-00000fd0: 6e70 2e61 7361 7272 6179 2873 656c 662e  np.asarray(self.
-00000fe0: 7661 6c75 652c 2064 7479 7065 3d6a 6e70  value, dtype=jnp
-00000ff0: 2e75 696e 7433 3229 0d0a 2020 2020 6b65  .uint32)..    ke
-00001000: 7973 203d 206a 722e 7370 6c69 7428 7365  ys = jr.split(se
-00001010: 6c66 2e76 616c 7565 2c20 6e75 6d3d 3229  lf.value, num=2)
-00001020: 0d0a 2020 2020 7365 6c66 2e5f 7661 6c75  ..    self._valu
-00001030: 6520 3d20 6b65 7973 5b30 5d0d 0a20 2020  e = keys[0]..   
-00001040: 2072 6574 7572 6e20 6b65 7973 5b31 5d0d   return keys[1].
-00001050: 0a0d 0a20 2064 6566 2073 706c 6974 5f6b  ...  def split_k
-00001060: 6579 7328 7365 6c66 2c20 6e3a 2069 6e74  eys(self, n: int
-00001070: 293a 0d0a 2020 2020 2222 2243 7265 6174  ):..    """Creat
-00001080: 6520 6d75 6c74 6970 6c65 2073 6565 6473  e multiple seeds
-00001090: 2066 726f 6d20 7468 6520 6375 7272 656e   from the curren
-000010a0: 7420 7365 6564 2e20 5468 6973 2069 7320  t seed. This is 
-000010b0: 7573 6564 0d0a 2020 2020 696e 7465 726e  used..    intern
-000010c0: 616c 6c79 2062 7920 6070 6d61 7060 2061  ally by `pmap` a
-000010d0: 6e64 2060 766d 6170 6020 746f 2065 6e73  nd `vmap` to ens
-000010e0: 7572 6520 7468 6174 2072 616e 646f 6d20  ure that random 
-000010f0: 6e75 6d62 6572 730d 0a20 2020 2061 7265  numbers..    are
-00001100: 2064 6966 6665 7265 6e74 2069 6e20 7061   different in pa
-00001110: 7261 6c6c 656c 2074 6872 6561 6473 2e0d  rallel threads..
-00001120: 0a0d 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-00001130: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
-00001140: 2d0d 0a20 2020 206e 203a 2069 6e74 0d0a  -..    n : int..
-00001150: 2020 2020 2020 5468 6520 6e75 6d62 6572        The number
-00001160: 206f 6620 7365 6564 7320 746f 2067 656e   of seeds to gen
-00001170: 6572 6174 652e 0d0a 2020 2020 2222 220d  erate...    """.
-00001180: 0a20 2020 206b 6579 7320 3d20 6a72 2e73  .    keys = jr.s
-00001190: 706c 6974 2873 656c 662e 7661 6c75 652c  plit(self.value,
-000011a0: 206e 202b 2031 290d 0a20 2020 2073 656c   n + 1)..    sel
-000011b0: 662e 5f76 616c 7565 203d 206b 6579 735b  f._value = keys[
-000011c0: 305d 0d0a 2020 2020 7265 7475 726e 206b  0]..    return k
-000011d0: 6579 735b 313a 5d0d 0a0d 0a20 2023 202d  eys[1:]....  # -
-000011e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d20  --------------- 
-000011f0: 230d 0a20 2023 2072 616e 646f 6d20 6675  #..  # random fu
-00001200: 6e63 7469 6f6e 7320 230d 0a20 2023 202d  nctions #..  # -
-00001210: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d20  --------------- 
-00001220: 230d 0a0d 0a20 2064 6566 2072 616e 6428  #....  def rand(
-00001230: 7365 6c66 2c20 2a64 6e2c 206b 6579 3a20  self, *dn, key: 
-00001240: 4f70 7469 6f6e 616c 5b53 6565 644f 724b  Optional[SeedOrK
-00001250: 6579 5d20 3d20 4e6f 6e65 2c20 6474 7970  ey] = None, dtyp
-00001260: 653a 2044 5479 7065 4c69 6b65 203d 204e  e: DTypeLike = N
-00001270: 6f6e 6529 3a0d 0a20 2020 206b 6579 203d  one):..    key =
-00001280: 2073 656c 662e 7370 6c69 745f 6b65 7928   self.split_key(
-00001290: 2920 6966 206b 6579 2069 7320 4e6f 6e65  ) if key is None
-000012a0: 2065 6c73 6520 5f66 6f72 6d61 6c69 7a65   else _formalize
-000012b0: 5f6b 6579 286b 6579 290d 0a20 2020 2064  _key(key)..    d
-000012c0: 7479 7065 203d 2064 7479 7065 206f 7220  type = dtype or 
-000012d0: 656e 7669 726f 6e2e 6466 7479 7065 2829  environ.dftype()
-000012e0: 0d0a 2020 2020 7220 3d20 6a72 2e75 6e69  ..    r = jr.uni
-000012f0: 666f 726d 286b 6579 2c20 7368 6170 653d  form(key, shape=
-00001300: 646e 2c20 6d69 6e76 616c 3d30 2e2c 206d  dn, minval=0., m
-00001310: 6178 7661 6c3d 312e 2c20 6474 7970 653d  axval=1., dtype=
-00001320: 6474 7970 6529 0d0a 2020 2020 7265 7475  dtype)..    retu
-00001330: 726e 2072 0d0a 0d0a 2020 6465 6620 7261  rn r....  def ra
-00001340: 6e64 696e 7428 0d0a 2020 2020 2020 7365  ndint(..      se
-00001350: 6c66 2c0d 0a20 2020 2020 206c 6f77 2c0d  lf,..      low,.
-00001360: 0a20 2020 2020 2068 6967 683d 4e6f 6e65  .      high=None
-00001370: 2c0d 0a20 2020 2020 2073 697a 653a 204f  ,..      size: O
-00001380: 7074 696f 6e61 6c5b 5369 7a65 5d20 3d20  ptional[Size] = 
-00001390: 4e6f 6e65 2c0d 0a20 2020 2020 2064 7479  None,..      dty
-000013a0: 7065 3a20 4454 7970 654c 696b 6520 3d20  pe: DTypeLike = 
-000013b0: 4e6f 6e65 2c0d 0a20 2020 2020 206b 6579  None,..      key
-000013c0: 3a20 4f70 7469 6f6e 616c 5b53 6565 644f  : Optional[SeedO
-000013d0: 724b 6579 5d20 3d20 4e6f 6e65 0d0a 2020  rKey] = None..  
-000013e0: 293a 0d0a 2020 2020 6966 2068 6967 6820  ):..    if high 
-000013f0: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-00001400: 6869 6768 203d 206c 6f77 0d0a 2020 2020  high = low..    
-00001410: 2020 6c6f 7720 3d20 300d 0a20 2020 2068    low = 0..    h
-00001420: 6967 6820 3d20 5f63 6865 636b 5f70 795f  igh = _check_py_
-00001430: 7365 7128 6869 6768 290d 0a20 2020 206c  seq(high)..    l
-00001440: 6f77 203d 205f 6368 6563 6b5f 7079 5f73  ow = _check_py_s
-00001450: 6571 286c 6f77 290d 0a20 2020 2069 6620  eq(low)..    if 
-00001460: 7369 7a65 2069 7320 4e6f 6e65 3a0d 0a20  size is None:.. 
-00001470: 2020 2020 2073 697a 6520 3d20 6c61 782e       size = lax.
-00001480: 6272 6f61 6463 6173 745f 7368 6170 6573  broadcast_shapes
-00001490: 286a 6e70 2e73 6861 7065 286c 6f77 292c  (jnp.shape(low),
-000014a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000014b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000014c0: 2020 2020 6a6e 702e 7368 6170 6528 6869      jnp.shape(hi
-000014d0: 6768 2929 0d0a 2020 2020 6b65 7920 3d20  gh))..    key = 
-000014e0: 7365 6c66 2e73 706c 6974 5f6b 6579 2829  self.split_key()
-000014f0: 2069 6620 6b65 7920 6973 204e 6f6e 6520   if key is None 
-00001500: 656c 7365 205f 666f 726d 616c 697a 655f  else _formalize_
-00001510: 6b65 7928 6b65 7929 0d0a 2020 2020 6474  key(key)..    dt
-00001520: 7970 6520 3d20 6474 7970 6520 6f72 2065  ype = dtype or e
-00001530: 6e76 6972 6f6e 2e64 6974 7970 6528 290d  nviron.ditype().
-00001540: 0a20 2020 2072 203d 206a 722e 7261 6e64  .    r = jr.rand
-00001550: 696e 7428 6b65 792c 0d0a 2020 2020 2020  int(key,..      
-00001560: 2020 2020 2020 2020 2020 2020 2073 6861               sha
-00001570: 7065 3d5f 7369 7a65 3273 6861 7065 2873  pe=_size2shape(s
-00001580: 697a 6529 2c0d 0a20 2020 2020 2020 2020  ize),..         
-00001590: 2020 2020 2020 2020 2020 6d69 6e76 616c            minval
-000015a0: 3d6c 6f77 2c20 6d61 7876 616c 3d68 6967  =low, maxval=hig
-000015b0: 682c 2064 7479 7065 3d64 7479 7065 290d  h, dtype=dtype).
-000015c0: 0a20 2020 2072 6574 7572 6e20 720d 0a0d  .    return r...
-000015d0: 0a20 2064 6566 2072 616e 646f 6d5f 696e  .  def random_in
-000015e0: 7465 6765 7273 280d 0a20 2020 2020 2073  tegers(..      s
-000015f0: 656c 662c 0d0a 2020 2020 2020 6c6f 772c  elf,..      low,
-00001600: 0d0a 2020 2020 2020 6869 6768 3d4e 6f6e  ..      high=Non
-00001610: 652c 0d0a 2020 2020 2020 7369 7a65 3a20  e,..      size: 
-00001620: 4f70 7469 6f6e 616c 5b53 697a 655d 203d  Optional[Size] =
-00001630: 204e 6f6e 652c 0d0a 2020 2020 2020 6b65   None,..      ke
-00001640: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
-00001650: 4f72 4b65 795d 203d 204e 6f6e 652c 0d0a  OrKey] = None,..
-00001660: 2020 2020 2020 6474 7970 653a 2044 5479        dtype: DTy
-00001670: 7065 4c69 6b65 203d 204e 6f6e 652c 0d0a  peLike = None,..
-00001680: 2020 293a 0d0a 2020 2020 6c6f 7720 3d20    ):..    low = 
-00001690: 5f63 6865 636b 5f70 795f 7365 7128 6c6f  _check_py_seq(lo
-000016a0: 7729 0d0a 2020 2020 6869 6768 203d 205f  w)..    high = _
-000016b0: 6368 6563 6b5f 7079 5f73 6571 2868 6967  check_py_seq(hig
-000016c0: 6829 0d0a 2020 2020 6966 2068 6967 6820  h)..    if high 
-000016d0: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-000016e0: 6869 6768 203d 206c 6f77 0d0a 2020 2020  high = low..    
-000016f0: 2020 6c6f 7720 3d20 310d 0a20 2020 2068    low = 1..    h
-00001700: 6967 6820 2b3d 2031 0d0a 2020 2020 6966  igh += 1..    if
-00001710: 2073 697a 6520 6973 204e 6f6e 653a 0d0a   size is None:..
-00001720: 2020 2020 2020 7369 7a65 203d 206c 6178        size = lax
-00001730: 2e62 726f 6164 6361 7374 5f73 6861 7065  .broadcast_shape
-00001740: 7328 6a6e 702e 7368 6170 6528 6c6f 7729  s(jnp.shape(low)
-00001750: 2c20 6a6e 702e 7368 6170 6528 6869 6768  , jnp.shape(high
-00001760: 2929 0d0a 2020 2020 6b65 7920 3d20 7365  ))..    key = se
-00001770: 6c66 2e73 706c 6974 5f6b 6579 2829 2069  lf.split_key() i
-00001780: 6620 6b65 7920 6973 204e 6f6e 6520 656c  f key is None el
-00001790: 7365 205f 666f 726d 616c 697a 655f 6b65  se _formalize_ke
-000017a0: 7928 6b65 7929 0d0a 2020 2020 6474 7970  y(key)..    dtyp
-000017b0: 6520 3d20 6474 7970 6520 6f72 2065 6e76  e = dtype or env
-000017c0: 6972 6f6e 2e64 6974 7970 6528 290d 0a20  iron.ditype().. 
-000017d0: 2020 2072 203d 206a 722e 7261 6e64 696e     r = jr.randin
-000017e0: 7428 6b65 792c 0d0a 2020 2020 2020 2020  t(key,..        
-000017f0: 2020 2020 2020 2020 2020 2073 6861 7065             shape
-00001800: 3d5f 7369 7a65 3273 6861 7065 2873 697a  =_size2shape(siz
-00001810: 6529 2c0d 0a20 2020 2020 2020 2020 2020  e),..           
-00001820: 2020 2020 2020 2020 6d69 6e76 616c 3d6c          minval=l
-00001830: 6f77 2c0d 0a20 2020 2020 2020 2020 2020  ow,..           
-00001840: 2020 2020 2020 2020 6d61 7876 616c 3d68          maxval=h
-00001850: 6967 682c 0d0a 2020 2020 2020 2020 2020  igh,..          
-00001860: 2020 2020 2020 2020 2064 7479 7065 3d64           dtype=d
-00001870: 7479 7065 290d 0a20 2020 2072 6574 7572  type)..    retur
-00001880: 6e20 720d 0a0d 0a20 2064 6566 2072 616e  n r....  def ran
-00001890: 646e 2873 656c 662c 202a 646e 2c20 6b65  dn(self, *dn, ke
-000018a0: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
-000018b0: 4f72 4b65 795d 203d 204e 6f6e 652c 2064  OrKey] = None, d
-000018c0: 7479 7065 3a20 4454 7970 654c 696b 6520  type: DTypeLike 
-000018d0: 3d20 4e6f 6e65 293a 0d0a 2020 2020 6b65  = None):..    ke
-000018e0: 7920 3d20 7365 6c66 2e73 706c 6974 5f6b  y = self.split_k
-000018f0: 6579 2829 2069 6620 6b65 7920 6973 204e  ey() if key is N
-00001900: 6f6e 6520 656c 7365 205f 666f 726d 616c  one else _formal
-00001910: 697a 655f 6b65 7928 6b65 7929 0d0a 2020  ize_key(key)..  
-00001920: 2020 6474 7970 6520 3d20 6474 7970 6520    dtype = dtype 
-00001930: 6f72 2065 6e76 6972 6f6e 2e64 6674 7970  or environ.dftyp
-00001940: 6528 290d 0a20 2020 2072 203d 206a 722e  e()..    r = jr.
-00001950: 6e6f 726d 616c 286b 6579 2c20 7368 6170  normal(key, shap
-00001960: 653d 646e 2c20 6474 7970 653d 6474 7970  e=dn, dtype=dtyp
-00001970: 6529 0d0a 2020 2020 7265 7475 726e 2072  e)..    return r
-00001980: 0d0a 0d0a 2020 6465 6620 7261 6e64 6f6d  ....  def random
-00001990: 2873 656c 662c 0d0a 2020 2020 2020 2020  (self,..        
-000019a0: 2020 2020 2073 697a 653a 204f 7074 696f       size: Optio
-000019b0: 6e61 6c5b 5369 7a65 5d20 3d20 4e6f 6e65  nal[Size] = None
-000019c0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000019d0: 6b65 793a 204f 7074 696f 6e61 6c5b 5365  key: Optional[Se
-000019e0: 6564 4f72 4b65 795d 203d 204e 6f6e 652c  edOrKey] = None,
-000019f0: 0d0a 2020 2020 2020 2020 2020 2020 2064  ..             d
-00001a00: 7479 7065 3a20 4454 7970 654c 696b 6520  type: DTypeLike 
-00001a10: 3d20 4e6f 6e65 293a 0d0a 2020 2020 6474  = None):..    dt
-00001a20: 7970 6520 3d20 6474 7970 6520 6f72 2065  ype = dtype or e
-00001a30: 6e76 6972 6f6e 2e64 6674 7970 6528 290d  nviron.dftype().
-00001a40: 0a20 2020 206b 6579 203d 2073 656c 662e  .    key = self.
-00001a50: 7370 6c69 745f 6b65 7928 2920 6966 206b  split_key() if k
-00001a60: 6579 2069 7320 4e6f 6e65 2065 6c73 6520  ey is None else 
-00001a70: 5f66 6f72 6d61 6c69 7a65 5f6b 6579 286b  _formalize_key(k
-00001a80: 6579 290d 0a20 2020 2072 203d 206a 722e  ey)..    r = jr.
-00001a90: 756e 6966 6f72 6d28 6b65 792c 2073 6861  uniform(key, sha
-00001aa0: 7065 3d5f 7369 7a65 3273 6861 7065 2873  pe=_size2shape(s
-00001ab0: 697a 6529 2c20 6d69 6e76 616c 3d30 2e2c  ize), minval=0.,
-00001ac0: 206d 6178 7661 6c3d 312e 2c20 6474 7970   maxval=1., dtyp
-00001ad0: 653d 6474 7970 6529 0d0a 2020 2020 7265  e=dtype)..    re
-00001ae0: 7475 726e 2072 0d0a 0d0a 2020 6465 6620  turn r....  def 
-00001af0: 7261 6e64 6f6d 5f73 616d 706c 6528 7365  random_sample(se
-00001b00: 6c66 2c0d 0a20 2020 2020 2020 2020 2020  lf,..           
-00001b10: 2020 2020 2020 2020 2073 697a 653a 204f           size: O
-00001b20: 7074 696f 6e61 6c5b 5369 7a65 5d20 3d20  ptional[Size] = 
-00001b30: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
-00001b40: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
-00001b50: 4f70 7469 6f6e 616c 5b53 6565 644f 724b  Optional[SeedOrK
-00001b60: 6579 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ey] = None,..   
-00001b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001b80: 2064 7479 7065 3a20 4454 7970 654c 696b   dtype: DTypeLik
-00001b90: 6520 3d20 4e6f 6e65 293a 0d0a 2020 2020  e = None):..    
-00001ba0: 7220 3d20 7365 6c66 2e72 616e 646f 6d28  r = self.random(
-00001bb0: 7369 7a65 3d73 697a 652c 206b 6579 3d6b  size=size, key=k
-00001bc0: 6579 2c20 6474 7970 653d 6474 7970 6529  ey, dtype=dtype)
-00001bd0: 0d0a 2020 2020 7265 7475 726e 2072 0d0a  ..    return r..
-00001be0: 0d0a 2020 6465 6620 7261 6e66 2873 656c  ..  def ranf(sel
-00001bf0: 662c 0d0a 2020 2020 2020 2020 2020 2073  f,..           s
-00001c00: 697a 653a 204f 7074 696f 6e61 6c5b 5369  ize: Optional[Si
-00001c10: 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ze] = None,..   
-00001c20: 2020 2020 2020 2020 6b65 793a 204f 7074          key: Opt
-00001c30: 696f 6e61 6c5b 5365 6564 4f72 4b65 795d  ional[SeedOrKey]
-00001c40: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
-00001c50: 2020 2020 2064 7479 7065 3a20 4454 7970       dtype: DTyp
-00001c60: 654c 696b 6520 3d20 4e6f 6e65 293a 0d0a  eLike = None):..
-00001c70: 2020 2020 7220 3d20 7365 6c66 2e72 616e      r = self.ran
-00001c80: 646f 6d28 7369 7a65 3d73 697a 652c 206b  dom(size=size, k
-00001c90: 6579 3d6b 6579 2c20 6474 7970 653d 6474  ey=key, dtype=dt
-00001ca0: 7970 6529 0d0a 2020 2020 7265 7475 726e  ype)..    return
-00001cb0: 2072 0d0a 0d0a 2020 6465 6620 7361 6d70   r....  def samp
-00001cc0: 6c65 2873 656c 662c 0d0a 2020 2020 2020  le(self,..      
-00001cd0: 2020 2020 2020 2073 697a 653a 204f 7074         size: Opt
-00001ce0: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
-00001cf0: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
-00001d00: 2020 6b65 793a 204f 7074 696f 6e61 6c5b    key: Optional[
-00001d10: 5365 6564 4f72 4b65 795d 203d 204e 6f6e  SeedOrKey] = Non
-00001d20: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
-00001d30: 2064 7479 7065 3a20 4454 7970 654c 696b   dtype: DTypeLik
-00001d40: 6520 3d20 4e6f 6e65 293a 0d0a 2020 2020  e = None):..    
-00001d50: 7220 3d20 7365 6c66 2e72 616e 646f 6d28  r = self.random(
-00001d60: 7369 7a65 3d73 697a 652c 206b 6579 3d6b  size=size, key=k
-00001d70: 6579 2c20 6474 7970 653d 6474 7970 6529  ey, dtype=dtype)
-00001d80: 0d0a 2020 2020 7265 7475 726e 2072 0d0a  ..    return r..
-00001d90: 0d0a 2020 6465 6620 6368 6f69 6365 2873  ..  def choice(s
-00001da0: 656c 662c 0d0a 2020 2020 2020 2020 2020  elf,..          
-00001db0: 2020 2061 2c0d 0a20 2020 2020 2020 2020     a,..         
-00001dc0: 2020 2020 7369 7a65 3a20 4f70 7469 6f6e      size: Option
-00001dd0: 616c 5b53 697a 655d 203d 204e 6f6e 652c  al[Size] = None,
-00001de0: 0d0a 2020 2020 2020 2020 2020 2020 2072  ..             r
-00001df0: 6570 6c61 6365 3d54 7275 652c 0d0a 2020  eplace=True,..  
-00001e00: 2020 2020 2020 2020 2020 2070 3d4e 6f6e             p=Non
-00001e10: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
-00001e20: 206b 6579 3a20 4f70 7469 6f6e 616c 5b53   key: Optional[S
-00001e30: 6565 644f 724b 6579 5d20 3d20 4e6f 6e65  eedOrKey] = None
-00001e40: 293a 0d0a 2020 2020 6120 3d20 5f63 6865  ):..    a = _che
-00001e50: 636b 5f70 795f 7365 7128 6129 0d0a 2020  ck_py_seq(a)..  
-00001e60: 2020 7020 3d20 5f63 6865 636b 5f70 795f    p = _check_py_
-00001e70: 7365 7128 7029 0d0a 2020 2020 6b65 7920  seq(p)..    key 
-00001e80: 3d20 7365 6c66 2e73 706c 6974 5f6b 6579  = self.split_key
-00001e90: 2829 2069 6620 6b65 7920 6973 204e 6f6e  () if key is Non
-00001ea0: 6520 656c 7365 205f 666f 726d 616c 697a  e else _formaliz
-00001eb0: 655f 6b65 7928 6b65 7929 0d0a 2020 2020  e_key(key)..    
-00001ec0: 7220 3d20 6a72 2e63 686f 6963 6528 6b65  r = jr.choice(ke
-00001ed0: 792c 2061 3d61 2c20 7368 6170 653d 5f73  y, a=a, shape=_s
-00001ee0: 697a 6532 7368 6170 6528 7369 7a65 292c  ize2shape(size),
-00001ef0: 2072 6570 6c61 6365 3d72 6570 6c61 6365   replace=replace
-00001f00: 2c20 703d 7029 0d0a 2020 2020 7265 7475  , p=p)..    retu
-00001f10: 726e 2072 0d0a 0d0a 2020 6465 6620 7065  rn r....  def pe
-00001f20: 726d 7574 6174 696f 6e28 7365 6c66 2c0d  rmutation(self,.
-00001f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001f40: 2020 2078 2c0d 0a20 2020 2020 2020 2020     x,..         
-00001f50: 2020 2020 2020 2020 2061 7869 733a 2069           axis: i
-00001f60: 6e74 203d 2030 2c0d 0a20 2020 2020 2020  nt = 0,..       
-00001f70: 2020 2020 2020 2020 2020 2069 6e64 6570             indep
-00001f80: 656e 6465 6e74 3a20 626f 6f6c 203d 2046  endent: bool = F
-00001f90: 616c 7365 2c0d 0a20 2020 2020 2020 2020  alse,..         
-00001fa0: 2020 2020 2020 2020 206b 6579 3a20 4f70           key: Op
-00001fb0: 7469 6f6e 616c 5b53 6565 644f 724b 6579  tional[SeedOrKey
-00001fc0: 5d20 3d20 4e6f 6e65 293a 0d0a 2020 2020  ] = None):..    
-00001fd0: 7820 3d20 5f63 6865 636b 5f70 795f 7365  x = _check_py_se
-00001fe0: 7128 7829 0d0a 2020 2020 6b65 7920 3d20  q(x)..    key = 
-00001ff0: 7365 6c66 2e73 706c 6974 5f6b 6579 2829  self.split_key()
-00002000: 2069 6620 6b65 7920 6973 204e 6f6e 6520   if key is None 
-00002010: 656c 7365 205f 666f 726d 616c 697a 655f  else _formalize_
-00002020: 6b65 7928 6b65 7929 0d0a 2020 2020 7220  key(key)..    r 
-00002030: 3d20 6a72 2e70 6572 6d75 7461 7469 6f6e  = jr.permutation
-00002040: 286b 6579 2c20 782c 2061 7869 733d 6178  (key, x, axis=ax
-00002050: 6973 2c20 696e 6465 7065 6e64 656e 743d  is, independent=
-00002060: 696e 6465 7065 6e64 656e 7429 0d0a 2020  independent)..  
-00002070: 2020 7265 7475 726e 2072 0d0a 0d0a 2020    return r....  
-00002080: 6465 6620 7368 7566 666c 6528 7365 6c66  def shuffle(self
-00002090: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000020a0: 2078 2c0d 0a20 2020 2020 2020 2020 2020   x,..           
-000020b0: 2020 2061 7869 733d 302c 0d0a 2020 2020     axis=0,..    
-000020c0: 2020 2020 2020 2020 2020 6b65 793a 204f            key: O
-000020d0: 7074 696f 6e61 6c5b 5365 6564 4f72 4b65  ptional[SeedOrKe
-000020e0: 795d 203d 204e 6f6e 6529 3a0d 0a20 2020  y] = None):..   
-000020f0: 206b 6579 203d 2073 656c 662e 7370 6c69   key = self.spli
-00002100: 745f 6b65 7928 2920 6966 206b 6579 2069  t_key() if key i
-00002110: 7320 4e6f 6e65 2065 6c73 6520 5f66 6f72  s None else _for
-00002120: 6d61 6c69 7a65 5f6b 6579 286b 6579 290d  malize_key(key).
-00002130: 0a20 2020 2078 203d 206a 722e 7065 726d  .    x = jr.perm
-00002140: 7574 6174 696f 6e28 6b65 792c 2078 2c20  utation(key, x, 
-00002150: 6178 6973 3d61 7869 7329 0d0a 2020 2020  axis=axis)..    
-00002160: 7265 7475 726e 2078 0d0a 0d0a 2020 6465  return x....  de
-00002170: 6620 6265 7461 2873 656c 662c 0d0a 2020  f beta(self,..  
-00002180: 2020 2020 2020 2020 2061 2c0d 0a20 2020           a,..   
-00002190: 2020 2020 2020 2020 622c 0d0a 2020 2020          b,..    
-000021a0: 2020 2020 2020 2073 697a 653a 204f 7074         size: Opt
-000021b0: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
-000021c0: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
-000021d0: 6b65 793a 204f 7074 696f 6e61 6c5b 5365  key: Optional[Se
-000021e0: 6564 4f72 4b65 795d 203d 204e 6f6e 652c  edOrKey] = None,
-000021f0: 0d0a 2020 2020 2020 2020 2020 2064 7479  ..           dty
-00002200: 7065 3a20 4454 7970 654c 696b 6520 3d20  pe: DTypeLike = 
-00002210: 4e6f 6e65 293a 0d0a 2020 2020 6120 3d20  None):..    a = 
-00002220: 5f63 6865 636b 5f70 795f 7365 7128 6129  _check_py_seq(a)
-00002230: 0d0a 2020 2020 6220 3d20 5f63 6865 636b  ..    b = _check
-00002240: 5f70 795f 7365 7128 6229 0d0a 2020 2020  _py_seq(b)..    
-00002250: 6966 2073 697a 6520 6973 204e 6f6e 653a  if size is None:
-00002260: 0d0a 2020 2020 2020 7369 7a65 203d 206c  ..      size = l
-00002270: 6178 2e62 726f 6164 6361 7374 5f73 6861  ax.broadcast_sha
-00002280: 7065 7328 6a6e 702e 7368 6170 6528 6129  pes(jnp.shape(a)
-00002290: 2c20 6a6e 702e 7368 6170 6528 6229 290d  , jnp.shape(b)).
-000022a0: 0a20 2020 206b 6579 203d 2073 656c 662e  .    key = self.
-000022b0: 7370 6c69 745f 6b65 7928 2920 6966 206b  split_key() if k
-000022c0: 6579 2069 7320 4e6f 6e65 2065 6c73 6520  ey is None else 
-000022d0: 5f66 6f72 6d61 6c69 7a65 5f6b 6579 286b  _formalize_key(k
-000022e0: 6579 290d 0a20 2020 2064 7479 7065 203d  ey)..    dtype =
-000022f0: 2064 7479 7065 206f 7220 656e 7669 726f   dtype or enviro
-00002300: 6e2e 6466 7479 7065 2829 0d0a 2020 2020  n.dftype()..    
-00002310: 7220 3d20 6a72 2e62 6574 6128 6b65 792c  r = jr.beta(key,
-00002320: 2061 3d61 2c20 623d 622c 2073 6861 7065   a=a, b=b, shape
-00002330: 3d5f 7369 7a65 3273 6861 7065 2873 697a  =_size2shape(siz
-00002340: 6529 2c20 6474 7970 653d 6474 7970 6529  e), dtype=dtype)
-00002350: 0d0a 2020 2020 7265 7475 726e 2072 0d0a  ..    return r..
-00002360: 0d0a 2020 6465 6620 6578 706f 6e65 6e74  ..  def exponent
-00002370: 6961 6c28 7365 6c66 2c0d 0a20 2020 2020  ial(self,..     
-00002380: 2020 2020 2020 2020 2020 2020 2073 6361               sca
-00002390: 6c65 3d4e 6f6e 652c 0d0a 2020 2020 2020  le=None,..      
-000023a0: 2020 2020 2020 2020 2020 2020 7369 7a65              size
-000023b0: 3a20 4f70 7469 6f6e 616c 5b53 697a 655d  : Optional[Size]
-000023c0: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
-000023d0: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
-000023e0: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
-000023f0: 4b65 795d 203d 204e 6f6e 652c 0d0a 2020  Key] = None,..  
-00002400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002410: 6474 7970 653a 2044 5479 7065 4c69 6b65  dtype: DTypeLike
-00002420: 203d 204e 6f6e 6529 3a0d 0a20 2020 2069   = None):..    i
-00002430: 6620 7369 7a65 2069 7320 4e6f 6e65 3a0d  f size is None:.
-00002440: 0a20 2020 2020 2073 697a 6520 3d20 6a6e  .      size = jn
-00002450: 702e 7368 6170 6528 7363 616c 6529 0d0a  p.shape(scale)..
-00002460: 2020 2020 6b65 7920 3d20 7365 6c66 2e73      key = self.s
-00002470: 706c 6974 5f6b 6579 2829 2069 6620 6b65  plit_key() if ke
-00002480: 7920 6973 204e 6f6e 6520 656c 7365 205f  y is None else _
-00002490: 666f 726d 616c 697a 655f 6b65 7928 6b65  formalize_key(ke
-000024a0: 7929 0d0a 2020 2020 6474 7970 6520 3d20  y)..    dtype = 
-000024b0: 6474 7970 6520 6f72 2065 6e76 6972 6f6e  dtype or environ
-000024c0: 2e64 6674 7970 6528 290d 0a20 2020 2073  .dftype()..    s
-000024d0: 6361 6c65 203d 206a 6e70 2e61 7361 7272  cale = jnp.asarr
-000024e0: 6179 2873 6361 6c65 2c20 6474 7970 653d  ay(scale, dtype=
-000024f0: 6474 7970 6529 0d0a 2020 2020 7220 3d20  dtype)..    r = 
-00002500: 6a72 2e65 7870 6f6e 656e 7469 616c 286b  jr.exponential(k
-00002510: 6579 2c20 7368 6170 653d 5f73 697a 6532  ey, shape=_size2
-00002520: 7368 6170 6528 7369 7a65 292c 2064 7479  shape(size), dty
-00002530: 7065 3d64 7479 7065 290d 0a20 2020 2069  pe=dtype)..    i
-00002540: 6620 7363 616c 6520 6973 206e 6f74 204e  f scale is not N
-00002550: 6f6e 653a 0d0a 2020 2020 2020 7220 3d20  one:..      r = 
-00002560: 7220 2f20 7363 616c 650d 0a20 2020 2072  r / scale..    r
-00002570: 6574 7572 6e20 720d 0a0d 0a20 2064 6566  eturn r....  def
-00002580: 2067 616d 6d61 2873 656c 662c 0d0a 2020   gamma(self,..  
-00002590: 2020 2020 2020 2020 2020 7368 6170 652c            shape,
-000025a0: 0d0a 2020 2020 2020 2020 2020 2020 7363  ..            sc
-000025b0: 616c 653d 4e6f 6e65 2c0d 0a20 2020 2020  ale=None,..     
-000025c0: 2020 2020 2020 2073 697a 653a 204f 7074         size: Opt
-000025d0: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
-000025e0: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
-000025f0: 206b 6579 3a20 4f70 7469 6f6e 616c 5b53   key: Optional[S
-00002600: 6565 644f 724b 6579 5d20 3d20 4e6f 6e65  eedOrKey] = None
-00002610: 2c0d 0a20 2020 2020 2020 2020 2020 2064  ,..            d
-00002620: 7479 7065 3a20 4454 7970 654c 696b 6520  type: DTypeLike 
-00002630: 3d20 4e6f 6e65 293a 0d0a 2020 2020 7368  = None):..    sh
-00002640: 6170 6520 3d20 5f63 6865 636b 5f70 795f  ape = _check_py_
-00002650: 7365 7128 7368 6170 6529 0d0a 2020 2020  seq(shape)..    
-00002660: 7363 616c 6520 3d20 5f63 6865 636b 5f70  scale = _check_p
-00002670: 795f 7365 7128 7363 616c 6529 0d0a 2020  y_seq(scale)..  
-00002680: 2020 6966 2073 697a 6520 6973 204e 6f6e    if size is Non
-00002690: 653a 0d0a 2020 2020 2020 7369 7a65 203d  e:..      size =
-000026a0: 206c 6178 2e62 726f 6164 6361 7374 5f73   lax.broadcast_s
-000026b0: 6861 7065 7328 6a6e 702e 7368 6170 6528  hapes(jnp.shape(
-000026c0: 7368 6170 6529 2c20 6a6e 702e 7368 6170  shape), jnp.shap
-000026d0: 6528 7363 616c 6529 290d 0a20 2020 206b  e(scale))..    k
-000026e0: 6579 203d 2073 656c 662e 7370 6c69 745f  ey = self.split_
-000026f0: 6b65 7928 2920 6966 206b 6579 2069 7320  key() if key is 
-00002700: 4e6f 6e65 2065 6c73 6520 5f66 6f72 6d61  None else _forma
-00002710: 6c69 7a65 5f6b 6579 286b 6579 290d 0a20  lize_key(key).. 
-00002720: 2020 2064 7479 7065 203d 2064 7479 7065     dtype = dtype
-00002730: 206f 7220 656e 7669 726f 6e2e 6466 7479   or environ.dfty
-00002740: 7065 2829 0d0a 2020 2020 7220 3d20 6a72  pe()..    r = jr
-00002750: 2e67 616d 6d61 286b 6579 2c20 613d 7368  .gamma(key, a=sh
-00002760: 6170 652c 2073 6861 7065 3d5f 7369 7a65  ape, shape=_size
-00002770: 3273 6861 7065 2873 697a 6529 2c20 6474  2shape(size), dt
-00002780: 7970 653d 6474 7970 6529 0d0a 2020 2020  ype=dtype)..    
-00002790: 6966 2073 6361 6c65 2069 7320 6e6f 7420  if scale is not 
-000027a0: 4e6f 6e65 3a0d 0a20 2020 2020 2072 203d  None:..      r =
-000027b0: 2072 202a 2073 6361 6c65 0d0a 2020 2020   r * scale..    
-000027c0: 7265 7475 726e 2072 0d0a 0d0a 2020 6465  return r....  de
-000027d0: 6620 6775 6d62 656c 2873 656c 662c 0d0a  f gumbel(self,..
-000027e0: 2020 2020 2020 2020 2020 2020 206c 6f63               loc
-000027f0: 3d4e 6f6e 652c 0d0a 2020 2020 2020 2020  =None,..        
-00002800: 2020 2020 2073 6361 6c65 3d4e 6f6e 652c       scale=None,
-00002810: 0d0a 2020 2020 2020 2020 2020 2020 2073  ..             s
-00002820: 697a 653a 204f 7074 696f 6e61 6c5b 5369  ize: Optional[Si
-00002830: 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ze] = None,..   
-00002840: 2020 2020 2020 2020 2020 6b65 793a 204f            key: O
-00002850: 7074 696f 6e61 6c5b 5365 6564 4f72 4b65  ptional[SeedOrKe
-00002860: 795d 203d 204e 6f6e 652c 0d0a 2020 2020  y] = None,..    
-00002870: 2020 2020 2020 2020 2064 7479 7065 3a20           dtype: 
-00002880: 4454 7970 654c 696b 6520 3d20 4e6f 6e65  DTypeLike = None
-00002890: 293a 0d0a 2020 2020 6c6f 6320 3d20 5f63  ):..    loc = _c
-000028a0: 6865 636b 5f70 795f 7365 7128 6c6f 6329  heck_py_seq(loc)
-000028b0: 0d0a 2020 2020 7363 616c 6520 3d20 5f63  ..    scale = _c
-000028c0: 6865 636b 5f70 795f 7365 7128 7363 616c  heck_py_seq(scal
-000028d0: 6529 0d0a 2020 2020 6966 2073 697a 6520  e)..    if size 
-000028e0: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-000028f0: 7369 7a65 203d 206c 6178 2e62 726f 6164  size = lax.broad
-00002900: 6361 7374 5f73 6861 7065 7328 6a6e 702e  cast_shapes(jnp.
-00002910: 7368 6170 6528 6c6f 6329 2c20 6a6e 702e  shape(loc), jnp.
-00002920: 7368 6170 6528 7363 616c 6529 290d 0a20  shape(scale)).. 
-00002930: 2020 206b 6579 203d 2073 656c 662e 7370     key = self.sp
-00002940: 6c69 745f 6b65 7928 2920 6966 206b 6579  lit_key() if key
-00002950: 2069 7320 4e6f 6e65 2065 6c73 6520 5f66   is None else _f
-00002960: 6f72 6d61 6c69 7a65 5f6b 6579 286b 6579  ormalize_key(key
-00002970: 290d 0a20 2020 2064 7479 7065 203d 2064  )..    dtype = d
-00002980: 7479 7065 206f 7220 656e 7669 726f 6e2e  type or environ.
-00002990: 6466 7479 7065 2829 0d0a 2020 2020 7220  dftype()..    r 
-000029a0: 3d20 5f6c 6f63 5f73 6361 6c65 286c 6f63  = _loc_scale(loc
-000029b0: 2c20 7363 616c 652c 206a 722e 6775 6d62  , scale, jr.gumb
-000029c0: 656c 286b 6579 2c20 7368 6170 653d 5f73  el(key, shape=_s
-000029d0: 697a 6532 7368 6170 6528 7369 7a65 292c  ize2shape(size),
-000029e0: 2064 7479 7065 3d64 7479 7065 2929 0d0a   dtype=dtype))..
-000029f0: 2020 2020 7265 7475 726e 2072 0d0a 0d0a      return r....
-00002a00: 2020 6465 6620 6c61 706c 6163 6528 7365    def laplace(se
-00002a10: 6c66 2c0d 0a20 2020 2020 2020 2020 2020  lf,..           
-00002a20: 2020 206c 6f63 3d4e 6f6e 652c 0d0a 2020     loc=None,..  
-00002a30: 2020 2020 2020 2020 2020 2020 7363 616c              scal
-00002a40: 653d 4e6f 6e65 2c0d 0a20 2020 2020 2020  e=None,..       
-00002a50: 2020 2020 2020 2073 697a 653a 204f 7074         size: Opt
-00002a60: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
-00002a70: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
-00002a80: 2020 206b 6579 3a20 4f70 7469 6f6e 616c     key: Optional
-00002a90: 5b53 6565 644f 724b 6579 5d20 3d20 4e6f  [SeedOrKey] = No
-00002aa0: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
-00002ab0: 2020 2064 7479 7065 3a20 4454 7970 654c     dtype: DTypeL
-00002ac0: 696b 6520 3d20 4e6f 6e65 293a 0d0a 2020  ike = None):..  
-00002ad0: 2020 6c6f 6320 3d20 5f63 6865 636b 5f70    loc = _check_p
-00002ae0: 795f 7365 7128 6c6f 6329 0d0a 2020 2020  y_seq(loc)..    
-00002af0: 7363 616c 6520 3d20 5f63 6865 636b 5f70  scale = _check_p
-00002b00: 795f 7365 7128 7363 616c 6529 0d0a 2020  y_seq(scale)..  
-00002b10: 2020 6966 2073 697a 6520 6973 204e 6f6e    if size is Non
-00002b20: 653a 0d0a 2020 2020 2020 7369 7a65 203d  e:..      size =
-00002b30: 206c 6178 2e62 726f 6164 6361 7374 5f73   lax.broadcast_s
-00002b40: 6861 7065 7328 6a6e 702e 7368 6170 6528  hapes(jnp.shape(
-00002b50: 6c6f 6329 2c20 6a6e 702e 7368 6170 6528  loc), jnp.shape(
-00002b60: 7363 616c 6529 290d 0a20 2020 206b 6579  scale))..    key
-00002b70: 203d 2073 656c 662e 7370 6c69 745f 6b65   = self.split_ke
-00002b80: 7928 2920 6966 206b 6579 2069 7320 4e6f  y() if key is No
-00002b90: 6e65 2065 6c73 6520 5f66 6f72 6d61 6c69  ne else _formali
-00002ba0: 7a65 5f6b 6579 286b 6579 290d 0a20 2020  ze_key(key)..   
-00002bb0: 2064 7479 7065 203d 2064 7479 7065 206f   dtype = dtype o
-00002bc0: 7220 656e 7669 726f 6e2e 6466 7479 7065  r environ.dftype
-00002bd0: 2829 0d0a 2020 2020 7220 3d20 5f6c 6f63  ()..    r = _loc
-00002be0: 5f73 6361 6c65 286c 6f63 2c20 7363 616c  _scale(loc, scal
-00002bf0: 652c 206a 722e 6c61 706c 6163 6528 6b65  e, jr.laplace(ke
-00002c00: 792c 2073 6861 7065 3d5f 7369 7a65 3273  y, shape=_size2s
-00002c10: 6861 7065 2873 697a 6529 2c20 6474 7970  hape(size), dtyp
-00002c20: 653d 6474 7970 6529 290d 0a20 2020 2072  e=dtype))..    r
-00002c30: 6574 7572 6e20 720d 0a0d 0a20 2064 6566  eturn r....  def
-00002c40: 206c 6f67 6973 7469 6328 7365 6c66 2c0d   logistic(self,.
-00002c50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002c60: 6c6f 633d 4e6f 6e65 2c0d 0a20 2020 2020  loc=None,..     
-00002c70: 2020 2020 2020 2020 2020 7363 616c 653d            scale=
-00002c80: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
-00002c90: 2020 2020 2020 7369 7a65 3a20 4f70 7469        size: Opti
-00002ca0: 6f6e 616c 5b53 697a 655d 203d 204e 6f6e  onal[Size] = Non
-00002cb0: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
-00002cc0: 2020 206b 6579 3a20 4f70 7469 6f6e 616c     key: Optional
-00002cd0: 5b53 6565 644f 724b 6579 5d20 3d20 4e6f  [SeedOrKey] = No
-00002ce0: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
-00002cf0: 2020 2020 6474 7970 653a 2044 5479 7065      dtype: DType
-00002d00: 4c69 6b65 203d 204e 6f6e 6529 3a0d 0a20  Like = None):.. 
-00002d10: 2020 206c 6f63 203d 205f 6368 6563 6b5f     loc = _check_
-00002d20: 7079 5f73 6571 286c 6f63 290d 0a20 2020  py_seq(loc)..   
-00002d30: 2073 6361 6c65 203d 205f 6368 6563 6b5f   scale = _check_
-00002d40: 7079 5f73 6571 2873 6361 6c65 290d 0a20  py_seq(scale).. 
-00002d50: 2020 2069 6620 7369 7a65 2069 7320 4e6f     if size is No
-00002d60: 6e65 3a0d 0a20 2020 2020 2073 697a 6520  ne:..      size 
-00002d70: 3d20 6c61 782e 6272 6f61 6463 6173 745f  = lax.broadcast_
-00002d80: 7368 6170 6573 286a 6e70 2e73 6861 7065  shapes(jnp.shape
-00002d90: 286c 6f63 292c 206a 6e70 2e73 6861 7065  (loc), jnp.shape
-00002da0: 2873 6361 6c65 2929 0d0a 2020 2020 6b65  (scale))..    ke
-00002db0: 7920 3d20 7365 6c66 2e73 706c 6974 5f6b  y = self.split_k
-00002dc0: 6579 2829 2069 6620 6b65 7920 6973 204e  ey() if key is N
-00002dd0: 6f6e 6520 656c 7365 205f 666f 726d 616c  one else _formal
-00002de0: 697a 655f 6b65 7928 6b65 7929 0d0a 2020  ize_key(key)..  
-00002df0: 2020 6474 7970 6520 3d20 6474 7970 6520    dtype = dtype 
-00002e00: 6f72 2065 6e76 6972 6f6e 2e64 6674 7970  or environ.dftyp
-00002e10: 6528 290d 0a20 2020 2072 203d 205f 6c6f  e()..    r = _lo
-00002e20: 635f 7363 616c 6528 6c6f 632c 2073 6361  c_scale(loc, sca
-00002e30: 6c65 2c20 6a72 2e6c 6f67 6973 7469 6328  le, jr.logistic(
-00002e40: 6b65 792c 2073 6861 7065 3d5f 7369 7a65  key, shape=_size
-00002e50: 3273 6861 7065 2873 697a 6529 2c20 6474  2shape(size), dt
-00002e60: 7970 653d 6474 7970 6529 290d 0a20 2020  ype=dtype))..   
-00002e70: 2072 6574 7572 6e20 720d 0a0d 0a20 2064   return r....  d
-00002e80: 6566 206e 6f72 6d61 6c28 7365 6c66 2c0d  ef normal(self,.
-00002e90: 0a20 2020 2020 2020 2020 2020 2020 6c6f  .             lo
-00002ea0: 633d 4e6f 6e65 2c0d 0a20 2020 2020 2020  c=None,..       
-00002eb0: 2020 2020 2020 7363 616c 653d 4e6f 6e65        scale=None
-00002ec0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00002ed0: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b53  size: Optional[S
-00002ee0: 697a 655d 203d 204e 6f6e 652c 0d0a 2020  ize] = None,..  
-00002ef0: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
-00002f00: 4f70 7469 6f6e 616c 5b53 6565 644f 724b  Optional[SeedOrK
-00002f10: 6579 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ey] = None,..   
-00002f20: 2020 2020 2020 2020 2020 6474 7970 653a            dtype:
-00002f30: 2044 5479 7065 4c69 6b65 203d 204e 6f6e   DTypeLike = Non
-00002f40: 6529 3a0d 0a20 2020 206c 6f63 203d 205f  e):..    loc = _
-00002f50: 6368 6563 6b5f 7079 5f73 6571 286c 6f63  check_py_seq(loc
-00002f60: 290d 0a20 2020 2073 6361 6c65 203d 205f  )..    scale = _
-00002f70: 6368 6563 6b5f 7079 5f73 6571 2873 6361  check_py_seq(sca
-00002f80: 6c65 290d 0a20 2020 2069 6620 7369 7a65  le)..    if size
-00002f90: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
-00002fa0: 2073 697a 6520 3d20 6c61 782e 6272 6f61   size = lax.broa
-00002fb0: 6463 6173 745f 7368 6170 6573 286a 6e70  dcast_shapes(jnp
-00002fc0: 2e73 6861 7065 2873 6361 6c65 292c 206a  .shape(scale), j
-00002fd0: 6e70 2e73 6861 7065 286c 6f63 2929 0d0a  np.shape(loc))..
-00002fe0: 2020 2020 6b65 7920 3d20 7365 6c66 2e73      key = self.s
-00002ff0: 706c 6974 5f6b 6579 2829 2069 6620 6b65  plit_key() if ke
-00003000: 7920 6973 204e 6f6e 6520 656c 7365 205f  y is None else _
-00003010: 666f 726d 616c 697a 655f 6b65 7928 6b65  formalize_key(ke
-00003020: 7929 0d0a 2020 2020 6474 7970 6520 3d20  y)..    dtype = 
-00003030: 6474 7970 6520 6f72 2065 6e76 6972 6f6e  dtype or environ
-00003040: 2e64 6674 7970 6528 290d 0a20 2020 2072  .dftype()..    r
-00003050: 203d 205f 6c6f 635f 7363 616c 6528 6c6f   = _loc_scale(lo
-00003060: 632c 2073 6361 6c65 2c20 6a72 2e6e 6f72  c, scale, jr.nor
-00003070: 6d61 6c28 6b65 792c 2073 6861 7065 3d5f  mal(key, shape=_
-00003080: 7369 7a65 3273 6861 7065 2873 697a 6529  size2shape(size)
-00003090: 2c20 6474 7970 653d 6474 7970 6529 290d  , dtype=dtype)).
-000030a0: 0a20 2020 2072 6574 7572 6e20 720d 0a0d  .    return r...
-000030b0: 0a20 2064 6566 2070 6172 6574 6f28 7365  .  def pareto(se
-000030c0: 6c66 2c0d 0a20 2020 2020 2020 2020 2020  lf,..           
-000030d0: 2020 612c 0d0a 2020 2020 2020 2020 2020    a,..          
-000030e0: 2020 2073 697a 653a 204f 7074 696f 6e61     size: Optiona
-000030f0: 6c5b 5369 7a65 5d20 3d20 4e6f 6e65 2c0d  l[Size] = None,.
-00003100: 0a20 2020 2020 2020 2020 2020 2020 6b65  .             ke
-00003110: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
-00003120: 4f72 4b65 795d 203d 204e 6f6e 652c 0d0a  OrKey] = None,..
-00003130: 2020 2020 2020 2020 2020 2020 2064 7479               dty
-00003140: 7065 3a20 4454 7970 654c 696b 6520 3d20  pe: DTypeLike = 
-00003150: 4e6f 6e65 293a 0d0a 2020 2020 6966 2073  None):..    if s
-00003160: 697a 6520 6973 204e 6f6e 653a 0d0a 2020  ize is None:..  
-00003170: 2020 2020 7369 7a65 203d 206a 6e70 2e73      size = jnp.s
-00003180: 6861 7065 2861 290d 0a20 2020 206b 6579  hape(a)..    key
-00003190: 203d 2073 656c 662e 7370 6c69 745f 6b65   = self.split_ke
-000031a0: 7928 2920 6966 206b 6579 2069 7320 4e6f  y() if key is No
-000031b0: 6e65 2065 6c73 6520 5f66 6f72 6d61 6c69  ne else _formali
-000031c0: 7a65 5f6b 6579 286b 6579 290d 0a20 2020  ze_key(key)..   
-000031d0: 2064 7479 7065 203d 2064 7479 7065 206f   dtype = dtype o
-000031e0: 7220 656e 7669 726f 6e2e 6466 7479 7065  r environ.dftype
-000031f0: 2829 0d0a 2020 2020 6120 3d20 6a6e 702e  ()..    a = jnp.
-00003200: 6173 6172 7261 7928 612c 2064 7479 7065  asarray(a, dtype
-00003210: 3d64 7479 7065 290d 0a20 2020 2072 203d  =dtype)..    r =
-00003220: 206a 722e 7061 7265 746f 286b 6579 2c20   jr.pareto(key, 
-00003230: 623d 612c 2073 6861 7065 3d5f 7369 7a65  b=a, shape=_size
-00003240: 3273 6861 7065 2873 697a 6529 2c20 6474  2shape(size), dt
-00003250: 7970 653d 6474 7970 6529 0d0a 2020 2020  ype=dtype)..    
-00003260: 7265 7475 726e 2072 0d0a 0d0a 2020 6465  return r....  de
-00003270: 6620 706f 6973 736f 6e28 7365 6c66 2c0d  f poisson(self,.
-00003280: 0a20 2020 2020 2020 2020 2020 2020 206c  .              l
-00003290: 616d 3d31 2e30 2c0d 0a20 2020 2020 2020  am=1.0,..       
-000032a0: 2020 2020 2020 2073 697a 653a 204f 7074         size: Opt
-000032b0: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
-000032c0: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
-000032d0: 2020 206b 6579 3a20 4f70 7469 6f6e 616c     key: Optional
-000032e0: 5b53 6565 644f 724b 6579 5d20 3d20 4e6f  [SeedOrKey] = No
-000032f0: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
-00003300: 2020 2064 7479 7065 3a20 4454 7970 654c     dtype: DTypeL
-00003310: 696b 6520 3d20 4e6f 6e65 293a 0d0a 2020  ike = None):..  
-00003320: 2020 6c61 6d20 3d20 5f63 6865 636b 5f70    lam = _check_p
-00003330: 795f 7365 7128 6c61 6d29 0d0a 2020 2020  y_seq(lam)..    
-00003340: 6966 2073 697a 6520 6973 204e 6f6e 653a  if size is None:
-00003350: 0d0a 2020 2020 2020 7369 7a65 203d 206a  ..      size = j
-00003360: 6e70 2e73 6861 7065 286c 616d 290d 0a20  np.shape(lam).. 
-00003370: 2020 206b 6579 203d 2073 656c 662e 7370     key = self.sp
-00003380: 6c69 745f 6b65 7928 2920 6966 206b 6579  lit_key() if key
-00003390: 2069 7320 4e6f 6e65 2065 6c73 6520 5f66   is None else _f
-000033a0: 6f72 6d61 6c69 7a65 5f6b 6579 286b 6579  ormalize_key(key
-000033b0: 290d 0a20 2020 2064 7479 7065 203d 2064  )..    dtype = d
-000033c0: 7479 7065 206f 7220 656e 7669 726f 6e2e  type or environ.
-000033d0: 6469 7479 7065 2829 0d0a 2020 2020 7220  ditype()..    r 
-000033e0: 3d20 6a72 2e70 6f69 7373 6f6e 286b 6579  = jr.poisson(key
-000033f0: 2c20 6c61 6d3d 6c61 6d2c 2073 6861 7065  , lam=lam, shape
-00003400: 3d5f 7369 7a65 3273 6861 7065 2873 697a  =_size2shape(siz
-00003410: 6529 2c20 6474 7970 653d 6474 7970 6529  e), dtype=dtype)
-00003420: 0d0a 2020 2020 7265 7475 726e 2072 0d0a  ..    return r..
-00003430: 0d0a 2020 6465 6620 7374 616e 6461 7264  ..  def standard
-00003440: 5f63 6175 6368 7928 7365 6c66 2c0d 0a20  _cauchy(self,.. 
-00003450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003460: 2020 2020 2073 697a 653a 204f 7074 696f       size: Optio
-00003470: 6e61 6c5b 5369 7a65 5d20 3d20 4e6f 6e65  nal[Size] = None
-00003480: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00003490: 2020 2020 2020 2020 206b 6579 3a20 4f70           key: Op
-000034a0: 7469 6f6e 616c 5b53 6565 644f 724b 6579  tional[SeedOrKey
-000034b0: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2020  ] = None,..     
-000034c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000034d0: 2064 7479 7065 3a20 4454 7970 654c 696b   dtype: DTypeLik
-000034e0: 6520 3d20 4e6f 6e65 293a 0d0a 2020 2020  e = None):..    
-000034f0: 6b65 7920 3d20 7365 6c66 2e73 706c 6974  key = self.split
-00003500: 5f6b 6579 2829 2069 6620 6b65 7920 6973  _key() if key is
-00003510: 204e 6f6e 6520 656c 7365 205f 666f 726d   None else _form
-00003520: 616c 697a 655f 6b65 7928 6b65 7929 0d0a  alize_key(key)..
-00003530: 2020 2020 6474 7970 6520 3d20 6474 7970      dtype = dtyp
-00003540: 6520 6f72 2065 6e76 6972 6f6e 2e64 6674  e or environ.dft
-00003550: 7970 6528 290d 0a20 2020 2072 203d 206a  ype()..    r = j
-00003560: 722e 6361 7563 6879 286b 6579 2c20 7368  r.cauchy(key, sh
-00003570: 6170 653d 5f73 697a 6532 7368 6170 6528  ape=_size2shape(
-00003580: 7369 7a65 292c 2064 7479 7065 3d64 7479  size), dtype=dty
-00003590: 7065 290d 0a20 2020 2072 6574 7572 6e20  pe)..    return 
-000035a0: 720d 0a0d 0a20 2064 6566 2073 7461 6e64  r....  def stand
-000035b0: 6172 645f 6578 706f 6e65 6e74 6961 6c28  ard_exponential(
-000035c0: 7365 6c66 2c0d 0a20 2020 2020 2020 2020  self,..         
-000035d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000035e0: 2020 7369 7a65 3a20 4f70 7469 6f6e 616c    size: Optional
-000035f0: 5b53 697a 655d 203d 204e 6f6e 652c 0d0a  [Size] = None,..
-00003600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003610: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
-00003620: 4f70 7469 6f6e 616c 5b53 6565 644f 724b  Optional[SeedOrK
-00003630: 6579 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ey] = None,..   
-00003640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003650: 2020 2020 2020 2020 6474 7970 653a 2044          dtype: D
-00003660: 5479 7065 4c69 6b65 203d 204e 6f6e 6529  TypeLike = None)
-00003670: 3a0d 0a20 2020 206b 6579 203d 2073 656c  :..    key = sel
-00003680: 662e 7370 6c69 745f 6b65 7928 2920 6966  f.split_key() if
-00003690: 206b 6579 2069 7320 4e6f 6e65 2065 6c73   key is None els
-000036a0: 6520 5f66 6f72 6d61 6c69 7a65 5f6b 6579  e _formalize_key
-000036b0: 286b 6579 290d 0a20 2020 2064 7479 7065  (key)..    dtype
-000036c0: 203d 2064 7479 7065 206f 7220 656e 7669   = dtype or envi
-000036d0: 726f 6e2e 6466 7479 7065 2829 0d0a 2020  ron.dftype()..  
-000036e0: 2020 7220 3d20 6a72 2e65 7870 6f6e 656e    r = jr.exponen
-000036f0: 7469 616c 286b 6579 2c20 7368 6170 653d  tial(key, shape=
-00003700: 5f73 697a 6532 7368 6170 6528 7369 7a65  _size2shape(size
-00003710: 292c 2064 7479 7065 3d64 7479 7065 290d  ), dtype=dtype).
-00003720: 0a20 2020 2072 6574 7572 6e20 720d 0a0d  .    return r...
-00003730: 0a20 2064 6566 2073 7461 6e64 6172 645f  .  def standard_
-00003740: 6761 6d6d 6128 7365 6c66 2c0d 0a20 2020  gamma(self,..   
-00003750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003760: 2020 7368 6170 652c 0d0a 2020 2020 2020    shape,..      
-00003770: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00003780: 697a 653a 204f 7074 696f 6e61 6c5b 5369  ize: Optional[Si
-00003790: 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ze] = None,..   
-000037a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000037b0: 2020 6b65 793a 204f 7074 696f 6e61 6c5b    key: Optional[
-000037c0: 5365 6564 4f72 4b65 795d 203d 204e 6f6e  SeedOrKey] = Non
-000037d0: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
-000037e0: 2020 2020 2020 2020 2064 7479 7065 3a20           dtype: 
-000037f0: 4454 7970 654c 696b 6520 3d20 4e6f 6e65  DTypeLike = None
-00003800: 293a 0d0a 2020 2020 7368 6170 6520 3d20  ):..    shape = 
-00003810: 5f63 6865 636b 5f70 795f 7365 7128 7368  _check_py_seq(sh
-00003820: 6170 6529 0d0a 2020 2020 6966 2073 697a  ape)..    if siz
-00003830: 6520 6973 204e 6f6e 653a 0d0a 2020 2020  e is None:..    
-00003840: 2020 7369 7a65 203d 206a 6e70 2e73 6861    size = jnp.sha
-00003850: 7065 2873 6861 7065 290d 0a20 2020 206b  pe(shape)..    k
-00003860: 6579 203d 2073 656c 662e 7370 6c69 745f  ey = self.split_
-00003870: 6b65 7928 2920 6966 206b 6579 2069 7320  key() if key is 
-00003880: 4e6f 6e65 2065 6c73 6520 5f66 6f72 6d61  None else _forma
-00003890: 6c69 7a65 5f6b 6579 286b 6579 290d 0a20  lize_key(key).. 
-000038a0: 2020 2064 7479 7065 203d 2064 7479 7065     dtype = dtype
-000038b0: 206f 7220 656e 7669 726f 6e2e 6466 7479   or environ.dfty
-000038c0: 7065 2829 0d0a 2020 2020 7220 3d20 6a72  pe()..    r = jr
-000038d0: 2e67 616d 6d61 286b 6579 2c20 613d 7368  .gamma(key, a=sh
-000038e0: 6170 652c 2073 6861 7065 3d5f 7369 7a65  ape, shape=_size
-000038f0: 3273 6861 7065 2873 697a 6529 2c20 6474  2shape(size), dt
-00003900: 7970 653d 6474 7970 6529 0d0a 2020 2020  ype=dtype)..    
-00003910: 7265 7475 726e 2072 0d0a 0d0a 2020 6465  return r....  de
-00003920: 6620 7374 616e 6461 7264 5f6e 6f72 6d61  f standard_norma
-00003930: 6c28 7365 6c66 2c0d 0a20 2020 2020 2020  l(self,..       
-00003940: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00003950: 697a 653a 204f 7074 696f 6e61 6c5b 5369  ize: Optional[Si
-00003960: 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ze] = None,..   
-00003970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003980: 2020 206b 6579 3a20 4f70 7469 6f6e 616c     key: Optional
-00003990: 5b53 6565 644f 724b 6579 5d20 3d20 4e6f  [SeedOrKey] = No
-000039a0: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
-000039b0: 2020 2020 2020 2020 2020 2064 7479 7065             dtype
-000039c0: 3a20 4454 7970 654c 696b 6520 3d20 4e6f  : DTypeLike = No
-000039d0: 6e65 293a 0d0a 2020 2020 6b65 7920 3d20  ne):..    key = 
-000039e0: 7365 6c66 2e73 706c 6974 5f6b 6579 2829  self.split_key()
-000039f0: 2069 6620 6b65 7920 6973 204e 6f6e 6520   if key is None 
-00003a00: 656c 7365 205f 666f 726d 616c 697a 655f  else _formalize_
-00003a10: 6b65 7928 6b65 7929 0d0a 2020 2020 6474  key(key)..    dt
-00003a20: 7970 6520 3d20 6474 7970 6520 6f72 2065  ype = dtype or e
-00003a30: 6e76 6972 6f6e 2e64 6674 7970 6528 290d  nviron.dftype().
-00003a40: 0a20 2020 2072 203d 206a 722e 6e6f 726d  .    r = jr.norm
-00003a50: 616c 286b 6579 2c20 7368 6170 653d 5f73  al(key, shape=_s
-00003a60: 697a 6532 7368 6170 6528 7369 7a65 292c  ize2shape(size),
-00003a70: 2064 7479 7065 3d64 7479 7065 290d 0a20   dtype=dtype).. 
-00003a80: 2020 2072 6574 7572 6e20 720d 0a0d 0a20     return r.... 
-00003a90: 2064 6566 2073 7461 6e64 6172 645f 7428   def standard_t(
-00003aa0: 7365 6c66 2c20 6466 2c0d 0a20 2020 2020  self, df,..     
-00003ab0: 2020 2020 2020 2020 2020 2020 7369 7a65              size
-00003ac0: 3a20 4f70 7469 6f6e 616c 5b53 697a 655d  : Optional[Size]
-00003ad0: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
-00003ae0: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
-00003af0: 4f70 7469 6f6e 616c 5b53 6565 644f 724b  Optional[SeedOrK
-00003b00: 6579 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ey] = None,..   
-00003b10: 2020 2020 2020 2020 2020 2020 2020 6474                dt
-00003b20: 7970 653a 2044 5479 7065 4c69 6b65 203d  ype: DTypeLike =
-00003b30: 204e 6f6e 6529 3a0d 0a20 2020 2064 6620   None):..    df 
-00003b40: 3d20 5f63 6865 636b 5f70 795f 7365 7128  = _check_py_seq(
-00003b50: 6466 290d 0a20 2020 2069 6620 7369 7a65  df)..    if size
-00003b60: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
-00003b70: 2073 697a 6520 3d20 6a6e 702e 7368 6170   size = jnp.shap
-00003b80: 6528 7369 7a65 290d 0a20 2020 206b 6579  e(size)..    key
-00003b90: 203d 2073 656c 662e 7370 6c69 745f 6b65   = self.split_ke
-00003ba0: 7928 2920 6966 206b 6579 2069 7320 4e6f  y() if key is No
-00003bb0: 6e65 2065 6c73 6520 5f66 6f72 6d61 6c69  ne else _formali
-00003bc0: 7a65 5f6b 6579 286b 6579 290d 0a20 2020  ze_key(key)..   
-00003bd0: 2064 7479 7065 203d 2064 7479 7065 206f   dtype = dtype o
-00003be0: 7220 656e 7669 726f 6e2e 6466 7479 7065  r environ.dftype
-00003bf0: 2829 0d0a 2020 2020 7220 3d20 6a72 2e74  ()..    r = jr.t
-00003c00: 286b 6579 2c20 6466 3d64 662c 2073 6861  (key, df=df, sha
-00003c10: 7065 3d5f 7369 7a65 3273 6861 7065 2873  pe=_size2shape(s
-00003c20: 697a 6529 2c20 6474 7970 653d 6474 7970  ize), dtype=dtyp
-00003c30: 6529 0d0a 2020 2020 7265 7475 726e 2072  e)..    return r
-00003c40: 0d0a 0d0a 2020 6465 6620 756e 6966 6f72  ....  def unifor
-00003c50: 6d28 7365 6c66 2c0d 0a20 2020 2020 2020  m(self,..       
-00003c60: 2020 2020 2020 206c 6f77 3d30 2e30 2c0d         low=0.0,.
-00003c70: 0a20 2020 2020 2020 2020 2020 2020 2068  .              h
-00003c80: 6967 683d 312e 302c 0d0a 2020 2020 2020  igh=1.0,..      
-00003c90: 2020 2020 2020 2020 7369 7a65 3a20 4f70          size: Op
-00003ca0: 7469 6f6e 616c 5b53 697a 655d 203d 204e  tional[Size] = N
-00003cb0: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
-00003cc0: 2020 2020 6b65 793a 204f 7074 696f 6e61      key: Optiona
-00003cd0: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
-00003ce0: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
-00003cf0: 2020 2020 6474 7970 653a 2044 5479 7065      dtype: DType
-00003d00: 4c69 6b65 203d 204e 6f6e 6529 3a0d 0a20  Like = None):.. 
-00003d10: 2020 206c 6f77 203d 205f 6368 6563 6b5f     low = _check_
-00003d20: 7079 5f73 6571 286c 6f77 290d 0a20 2020  py_seq(low)..   
-00003d30: 2068 6967 6820 3d20 5f63 6865 636b 5f70   high = _check_p
-00003d40: 795f 7365 7128 6869 6768 290d 0a20 2020  y_seq(high)..   
-00003d50: 2069 6620 7369 7a65 2069 7320 4e6f 6e65   if size is None
-00003d60: 3a0d 0a20 2020 2020 2073 697a 6520 3d20  :..      size = 
-00003d70: 6c61 782e 6272 6f61 6463 6173 745f 7368  lax.broadcast_sh
-00003d80: 6170 6573 286a 6e70 2e73 6861 7065 286c  apes(jnp.shape(l
-00003d90: 6f77 292c 206a 6e70 2e73 6861 7065 2868  ow), jnp.shape(h
-00003da0: 6967 6829 290d 0a20 2020 206b 6579 203d  igh))..    key =
-00003db0: 2073 656c 662e 7370 6c69 745f 6b65 7928   self.split_key(
-00003dc0: 2920 6966 206b 6579 2069 7320 4e6f 6e65  ) if key is None
-00003dd0: 2065 6c73 6520 5f66 6f72 6d61 6c69 7a65   else _formalize
-00003de0: 5f6b 6579 286b 6579 290d 0a20 2020 2064  _key(key)..    d
-00003df0: 7479 7065 203d 2064 7479 7065 206f 7220  type = dtype or 
-00003e00: 656e 7669 726f 6e2e 6466 7479 7065 2829  environ.dftype()
-00003e10: 0d0a 2020 2020 7220 3d20 6a72 2e75 6e69  ..    r = jr.uni
-00003e20: 666f 726d 286b 6579 2c20 7368 6170 653d  form(key, shape=
-00003e30: 5f73 697a 6532 7368 6170 6528 7369 7a65  _size2shape(size
-00003e40: 292c 206d 696e 7661 6c3d 6c6f 772c 206d  ), minval=low, m
-00003e50: 6178 7661 6c3d 6869 6768 2c20 6474 7970  axval=high, dtyp
-00003e60: 653d 6474 7970 6529 0d0a 2020 2020 7265  e=dtype)..    re
-00003e70: 7475 726e 2072 0d0a 0d0a 2020 6465 6620  turn r....  def 
-00003e80: 5f5f 6e6f 726d 5f63 6466 2873 656c 662c  __norm_cdf(self,
-00003e90: 2078 2c20 7371 7274 322c 2064 7479 7065   x, sqrt2, dtype
-00003ea0: 293a 0d0a 2020 2020 2320 436f 6d70 7574  ):..    # Comput
-00003eb0: 6573 2073 7461 6e64 6172 6420 6e6f 726d  es standard norm
-00003ec0: 616c 2063 756d 756c 6174 6976 6520 6469  al cumulative di
-00003ed0: 7374 7269 6275 7469 6f6e 2066 756e 6374  stribution funct
-00003ee0: 696f 6e0d 0a20 2020 2072 6574 7572 6e20  ion..    return 
-00003ef0: 286e 702e 6173 6172 7261 7928 312e 2c20  (np.asarray(1., 
-00003f00: 6474 7970 6529 202b 206c 6178 2e65 7266  dtype) + lax.erf
-00003f10: 2878 202f 2073 7172 7432 2929 202f 206e  (x / sqrt2)) / n
-00003f20: 702e 6173 6172 7261 7928 322e 2c20 6474  p.asarray(2., dt
-00003f30: 7970 6529 0d0a 0d0a 2020 6465 6620 7472  ype)....  def tr
-00003f40: 756e 6361 7465 645f 6e6f 726d 616c 280d  uncated_normal(.
-00003f50: 0a20 2020 2020 2073 656c 662c 0d0a 2020  .      self,..  
-00003f60: 2020 2020 6c6f 7765 722c 0d0a 2020 2020      lower,..    
-00003f70: 2020 7570 7065 722c 0d0a 2020 2020 2020    upper,..      
-00003f80: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b53  size: Optional[S
-00003f90: 697a 655d 203d 204e 6f6e 652c 0d0a 2020  ize] = None,..  
-00003fa0: 2020 2020 6c6f 633d 302e 2c0d 0a20 2020      loc=0.,..   
-00003fb0: 2020 2073 6361 6c65 3d31 2e2c 0d0a 2020     scale=1.,..  
-00003fc0: 2020 2020 6b65 793a 204f 7074 696f 6e61      key: Optiona
-00003fd0: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
-00003fe0: 6f6e 652c 0d0a 2020 2020 2020 6474 7970  one,..      dtyp
-00003ff0: 653a 2044 5479 7065 4c69 6b65 203d 204e  e: DTypeLike = N
-00004000: 6f6e 650d 0a20 2029 3a0d 0a20 2020 206c  one..  ):..    l
-00004010: 6f77 6572 203d 205f 6368 6563 6b5f 7079  ower = _check_py
-00004020: 5f73 6571 286c 6f77 6572 290d 0a20 2020  _seq(lower)..   
-00004030: 2075 7070 6572 203d 205f 6368 6563 6b5f   upper = _check_
-00004040: 7079 5f73 6571 2875 7070 6572 290d 0a20  py_seq(upper).. 
-00004050: 2020 206c 6f63 203d 205f 6368 6563 6b5f     loc = _check_
-00004060: 7079 5f73 6571 286c 6f63 290d 0a20 2020  py_seq(loc)..   
-00004070: 2073 6361 6c65 203d 205f 6368 6563 6b5f   scale = _check_
-00004080: 7079 5f73 6571 2873 6361 6c65 290d 0a20  py_seq(scale).. 
-00004090: 2020 2064 7479 7065 203d 2064 7479 7065     dtype = dtype
-000040a0: 206f 7220 656e 7669 726f 6e2e 6466 7479   or environ.dfty
-000040b0: 7065 2829 0d0a 0d0a 2020 2020 6c6f 7765  pe()....    lowe
-000040c0: 7220 3d20 6c61 782e 636f 6e76 6572 745f  r = lax.convert_
-000040d0: 656c 656d 656e 745f 7479 7065 286c 6f77  element_type(low
-000040e0: 6572 2c20 6474 7970 6529 0d0a 2020 2020  er, dtype)..    
-000040f0: 7570 7065 7220 3d20 6c61 782e 636f 6e76  upper = lax.conv
-00004100: 6572 745f 656c 656d 656e 745f 7479 7065  ert_element_type
-00004110: 2875 7070 6572 2c20 6474 7970 6529 0d0a  (upper, dtype)..
-00004120: 2020 2020 6c6f 6320 3d20 6c61 782e 636f      loc = lax.co
-00004130: 6e76 6572 745f 656c 656d 656e 745f 7479  nvert_element_ty
-00004140: 7065 286c 6f63 2c20 6474 7970 6529 0d0a  pe(loc, dtype)..
-00004150: 2020 2020 7363 616c 6520 3d20 6c61 782e      scale = lax.
-00004160: 636f 6e76 6572 745f 656c 656d 656e 745f  convert_element_
-00004170: 7479 7065 2873 6361 6c65 2c20 6474 7970  type(scale, dtyp
-00004180: 6529 0d0a 0d0a 2020 2020 6a69 745f 6572  e)....    jit_er
-00004190: 726f 7228 0d0a 2020 2020 2020 6a6e 702e  ror(..      jnp.
-000041a0: 616e 7928 6a6e 702e 6c6f 6769 6361 6c5f  any(jnp.logical_
-000041b0: 6f72 286c 6f63 203c 206c 6f77 6572 202d  or(loc < lower -
-000041c0: 2032 202a 2073 6361 6c65 2c20 6c6f 6320   2 * scale, loc 
-000041d0: 3e20 7570 7065 7220 2b20 3220 2a20 7363  > upper + 2 * sc
-000041e0: 616c 6529 292c 0d0a 2020 2020 2020 226d  ale)),..      "m
-000041f0: 6561 6e20 6973 206d 6f72 6520 7468 616e  ean is more than
-00004200: 2032 2073 7464 2066 726f 6d20 5b6c 6f77   2 std from [low
-00004210: 6572 2c20 7570 7065 725d 2069 6e20 7472  er, upper] in tr
-00004220: 756e 6361 7465 645f 6e6f 726d 616c 2e20  uncated_normal. 
-00004230: 220d 0a20 2020 2020 2022 5468 6520 6469  "..      "The di
-00004240: 7374 7269 6275 7469 6f6e 206f 6620 7661  stribution of va
-00004250: 6c75 6573 206d 6179 2062 6520 696e 636f  lues may be inco
-00004260: 7272 6563 742e 220d 0a20 2020 2029 0d0a  rrect."..    )..
-00004270: 0d0a 2020 2020 6966 2073 697a 6520 6973  ..    if size is
-00004280: 204e 6f6e 653a 0d0a 2020 2020 2020 7369   None:..      si
-00004290: 7a65 203d 206c 6178 2e62 726f 6164 6361  ze = lax.broadca
-000042a0: 7374 5f73 6861 7065 7328 6a6e 702e 7368  st_shapes(jnp.sh
-000042b0: 6170 6528 6c6f 7765 7229 2c0d 0a20 2020  ape(lower),..   
-000042c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000042d0: 2020 2020 2020 2020 2020 2020 2020 206a                 j
-000042e0: 6e70 2e73 6861 7065 2875 7070 6572 292c  np.shape(upper),
-000042f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00004300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004310: 2020 2020 6a6e 702e 7368 6170 6528 6c6f      jnp.shape(lo
-00004320: 6329 2c0d 0a20 2020 2020 2020 2020 2020  c),..           
-00004330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004340: 2020 2020 2020 206a 6e70 2e73 6861 7065         jnp.shape
-00004350: 2873 6361 6c65 2929 0d0a 0d0a 2020 2020  (scale))....    
-00004360: 2320 5661 6c75 6573 2061 7265 2067 656e  # Values are gen
-00004370: 6572 6174 6564 2062 7920 7573 696e 6720  erated by using 
-00004380: 6120 7472 756e 6361 7465 6420 756e 6966  a truncated unif
-00004390: 6f72 6d20 6469 7374 7269 6275 7469 6f6e  orm distribution
-000043a0: 2061 6e64 0d0a 2020 2020 2320 7468 656e   and..    # then
-000043b0: 2075 7369 6e67 2074 6865 2069 6e76 6572   using the inver
-000043c0: 7365 2043 4446 2066 6f72 2074 6865 206e  se CDF for the n
-000043d0: 6f72 6d61 6c20 6469 7374 7269 6275 7469  ormal distributi
-000043e0: 6f6e 2e0d 0a20 2020 2023 2047 6574 2075  on...    # Get u
-000043f0: 7070 6572 2061 6e64 206c 6f77 6572 2063  pper and lower c
-00004400: 6466 2076 616c 7565 730d 0a20 2020 2073  df values..    s
-00004410: 7172 7432 203d 206e 702e 6172 7261 7928  qrt2 = np.array(
-00004420: 6e70 2e73 7172 7428 3229 2c20 6474 7970  np.sqrt(2), dtyp
-00004430: 6529 0d0a 2020 2020 6c20 3d20 7365 6c66  e)..    l = self
-00004440: 2e5f 5f6e 6f72 6d5f 6364 6628 286c 6f77  .__norm_cdf((low
-00004450: 6572 202d 206c 6f63 2920 2f20 7363 616c  er - loc) / scal
-00004460: 652c 2073 7172 7432 2c20 6474 7970 6529  e, sqrt2, dtype)
-00004470: 0d0a 2020 2020 7520 3d20 7365 6c66 2e5f  ..    u = self._
-00004480: 5f6e 6f72 6d5f 6364 6628 2875 7070 6572  _norm_cdf((upper
-00004490: 202d 206c 6f63 2920 2f20 7363 616c 652c   - loc) / scale,
-000044a0: 2073 7172 7432 2c20 6474 7970 6529 0d0a   sqrt2, dtype)..
-000044b0: 0d0a 2020 2020 2320 556e 6966 6f72 6d6c  ..    # Uniforml
-000044c0: 7920 6669 6c6c 2074 656e 736f 7220 7769  y fill tensor wi
-000044d0: 7468 2076 616c 7565 7320 6672 6f6d 205b  th values from [
-000044e0: 6c2c 2075 5d2c 2074 6865 6e20 7472 616e  l, u], then tran
-000044f0: 736c 6174 6520 746f 0d0a 2020 2020 2320  slate to..    # 
-00004500: 5b32 6c2d 312c 2032 752d 315d 2e0d 0a20  [2l-1, 2u-1]... 
-00004510: 2020 206b 6579 203d 2073 656c 662e 7370     key = self.sp
-00004520: 6c69 745f 6b65 7928 2920 6966 206b 6579  lit_key() if key
-00004530: 2069 7320 4e6f 6e65 2065 6c73 6520 5f66   is None else _f
-00004540: 6f72 6d61 6c69 7a65 5f6b 6579 286b 6579  ormalize_key(key
-00004550: 290d 0a20 2020 206f 7574 203d 206a 722e  )..    out = jr.
-00004560: 756e 6966 6f72 6d28 6b65 792c 2073 697a  uniform(key, siz
-00004570: 652c 2064 7479 7065 2c0d 0a20 2020 2020  e, dtype,..     
-00004580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004590: 6d69 6e76 616c 3d6c 6178 2e6e 6578 7461  minval=lax.nexta
-000045a0: 6674 6572 2832 202a 206c 202d 2031 2c20  fter(2 * l - 1, 
-000045b0: 6e70 2e61 7272 6179 286e 702e 696e 662c  np.array(np.inf,
-000045c0: 2064 7479 7065 3d64 7479 7065 2929 2c0d   dtype=dtype)),.
-000045d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000045e0: 2020 2020 2020 6d61 7876 616c 3d6c 6178        maxval=lax
-000045f0: 2e6e 6578 7461 6674 6572 2832 202a 2075  .nextafter(2 * u
-00004600: 202d 2031 2c20 6e70 2e61 7272 6179 282d   - 1, np.array(-
-00004610: 6e70 2e69 6e66 2c20 6474 7970 653d 6474  np.inf, dtype=dt
-00004620: 7970 6529 2929 0d0a 0d0a 2020 2020 2320  ype)))....    # 
-00004630: 5573 6520 696e 7665 7273 6520 6364 6620  Use inverse cdf 
-00004640: 7472 616e 7366 6f72 6d20 666f 7220 6e6f  transform for no
-00004650: 726d 616c 2064 6973 7472 6962 7574 696f  rmal distributio
-00004660: 6e20 746f 2067 6574 2074 7275 6e63 6174  n to get truncat
-00004670: 6564 0d0a 2020 2020 2320 7374 616e 6461  ed..    # standa
-00004680: 7264 206e 6f72 6d61 6c0d 0a20 2020 206f  rd normal..    o
-00004690: 7574 203d 206c 6178 2e65 7266 5f69 6e76  ut = lax.erf_inv
-000046a0: 286f 7574 290d 0a0d 0a20 2020 2023 2054  (out)....    # T
-000046b0: 7261 6e73 666f 726d 2074 6f20 7072 6f70  ransform to prop
-000046c0: 6572 206d 6561 6e2c 2073 7464 0d0a 2020  er mean, std..  
-000046d0: 2020 6f75 7420 3d20 6f75 7420 2a20 7363    out = out * sc
-000046e0: 616c 6520 2a20 7371 7274 3220 2b20 6c6f  ale * sqrt2 + lo
-000046f0: 630d 0a0d 0a20 2020 2023 2043 6c61 6d70  c....    # Clamp
-00004700: 2074 6f20 656e 7375 7265 2069 7427 7320   to ensure it's 
-00004710: 696e 2074 6865 2070 726f 7065 7220 7261  in the proper ra
-00004720: 6e67 650d 0a20 2020 206f 7574 203d 206a  nge..    out = j
-00004730: 6e70 2e63 6c69 7028 6f75 742c 0d0a 2020  np.clip(out,..  
-00004740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004750: 206c 6178 2e6e 6578 7461 6674 6572 286c   lax.nextafter(l
-00004760: 6178 2e73 746f 705f 6772 6164 6965 6e74  ax.stop_gradient
-00004770: 286c 6f77 6572 292c 206e 702e 6172 7261  (lower), np.arra
-00004780: 7928 6e70 2e69 6e66 2c20 6474 7970 653d  y(np.inf, dtype=
-00004790: 6474 7970 6529 292c 0d0a 2020 2020 2020  dtype)),..      
-000047a0: 2020 2020 2020 2020 2020 2020 206c 6178               lax
-000047b0: 2e6e 6578 7461 6674 6572 286c 6178 2e73  .nextafter(lax.s
-000047c0: 746f 705f 6772 6164 6965 6e74 2875 7070  top_gradient(upp
-000047d0: 6572 292c 206e 702e 6172 7261 7928 2d6e  er), np.array(-n
-000047e0: 702e 696e 662c 2064 7479 7065 3d64 7479  p.inf, dtype=dty
-000047f0: 7065 2929 290d 0a20 2020 2072 6574 7572  pe)))..    retur
-00004800: 6e20 6f75 740d 0a0d 0a20 2064 6566 205f  n out....  def _
-00004810: 6368 6563 6b5f 7028 7365 6c66 2c20 7029  check_p(self, p)
-00004820: 3a0d 0a20 2020 2072 6169 7365 2056 616c  :..    raise Val
-00004830: 7565 4572 726f 7228 6627 5061 7261 6d65  ueError(f'Parame
-00004840: 7465 7220 7020 7368 6f75 6c64 2062 6520  ter p should be 
-00004850: 7769 7468 696e 205b 302c 2031 5d2c 2062  within [0, 1], b
-00004860: 7574 2077 6520 676f 7420 7b70 7d27 290d  ut we got {p}').
-00004870: 0a0d 0a20 2064 6566 2062 6572 6e6f 756c  ...  def bernoul
-00004880: 6c69 2873 656c 662c 0d0a 2020 2020 2020  li(self,..      
-00004890: 2020 2020 2020 2020 2020 702c 0d0a 2020            p,..  
-000048a0: 2020 2020 2020 2020 2020 2020 2020 7369                si
-000048b0: 7a65 3a20 4f70 7469 6f6e 616c 5b53 697a  ze: Optional[Siz
-000048c0: 655d 203d 204e 6f6e 652c 0d0a 2020 2020  e] = None,..    
-000048d0: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
-000048e0: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
-000048f0: 4b65 795d 203d 204e 6f6e 6529 3a0d 0a20  Key] = None):.. 
-00004900: 2020 2070 203d 205f 6368 6563 6b5f 7079     p = _check_py
-00004910: 5f73 6571 2870 290d 0a20 2020 206a 6974  _seq(p)..    jit
-00004920: 5f65 7272 6f72 286a 6e70 2e61 6e79 286a  _error(jnp.any(j
-00004930: 6e70 2e6c 6f67 6963 616c 5f61 6e64 2870  np.logical_and(p
-00004940: 203c 2030 2c20 7020 3e20 3129 292c 2073   < 0, p > 1)), s
-00004950: 656c 662e 5f63 6865 636b 5f70 2c20 7029  elf._check_p, p)
-00004960: 0d0a 2020 2020 6966 2073 697a 6520 6973  ..    if size is
-00004970: 204e 6f6e 653a 0d0a 2020 2020 2020 7369   None:..      si
-00004980: 7a65 203d 206a 6e70 2e73 6861 7065 2870  ze = jnp.shape(p
-00004990: 290d 0a20 2020 206b 6579 203d 2073 656c  )..    key = sel
-000049a0: 662e 7370 6c69 745f 6b65 7928 2920 6966  f.split_key() if
-000049b0: 206b 6579 2069 7320 4e6f 6e65 2065 6c73   key is None els
-000049c0: 6520 5f66 6f72 6d61 6c69 7a65 5f6b 6579  e _formalize_key
-000049d0: 286b 6579 290d 0a20 2020 2072 203d 206a  (key)..    r = j
-000049e0: 722e 6265 726e 6f75 6c6c 6928 6b65 792c  r.bernoulli(key,
-000049f0: 2070 3d70 2c20 7368 6170 653d 5f73 697a   p=p, shape=_siz
-00004a00: 6532 7368 6170 6528 7369 7a65 2929 0d0a  e2shape(size))..
-00004a10: 2020 2020 7265 7475 726e 2072 0d0a 0d0a      return r....
-00004a20: 2020 6465 6620 6c6f 676e 6f72 6d61 6c28    def lognormal(
-00004a30: 7365 6c66 2c0d 0a20 2020 2020 2020 2020  self,..         
-00004a40: 2020 2020 2020 206d 6561 6e3d 4e6f 6e65         mean=None
-00004a50: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00004a60: 2020 2073 6967 6d61 3d4e 6f6e 652c 0d0a     sigma=None,..
-00004a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004a80: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b53  size: Optional[S
-00004a90: 697a 655d 203d 204e 6f6e 652c 0d0a 2020  ize] = None,..  
-00004aa0: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
-00004ab0: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
-00004ac0: 4f72 4b65 795d 203d 204e 6f6e 652c 0d0a  OrKey] = None,..
-00004ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004ae0: 6474 7970 653a 2044 5479 7065 4c69 6b65  dtype: DTypeLike
-00004af0: 203d 204e 6f6e 6529 3a0d 0a20 2020 206d   = None):..    m
-00004b00: 6561 6e20 3d20 5f63 6865 636b 5f70 795f  ean = _check_py_
-00004b10: 7365 7128 6d65 616e 290d 0a20 2020 2073  seq(mean)..    s
-00004b20: 6967 6d61 203d 205f 6368 6563 6b5f 7079  igma = _check_py
-00004b30: 5f73 6571 2873 6967 6d61 290d 0a20 2020  _seq(sigma)..   
-00004b40: 2069 6620 7369 7a65 2069 7320 4e6f 6e65   if size is None
-00004b50: 3a0d 0a20 2020 2020 2073 697a 6520 3d20  :..      size = 
-00004b60: 6a6e 702e 6272 6f61 6463 6173 745f 7368  jnp.broadcast_sh
-00004b70: 6170 6573 286a 6e70 2e73 6861 7065 286d  apes(jnp.shape(m
-00004b80: 6561 6e29 2c0d 0a20 2020 2020 2020 2020  ean),..         
-00004b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004ba0: 2020 2020 2020 2020 206a 6e70 2e73 6861           jnp.sha
-00004bb0: 7065 2873 6967 6d61 2929 0d0a 2020 2020  pe(sigma))..    
-00004bc0: 6b65 7920 3d20 7365 6c66 2e73 706c 6974  key = self.split
-00004bd0: 5f6b 6579 2829 2069 6620 6b65 7920 6973  _key() if key is
-00004be0: 204e 6f6e 6520 656c 7365 205f 666f 726d   None else _form
-00004bf0: 616c 697a 655f 6b65 7928 6b65 7929 0d0a  alize_key(key)..
-00004c00: 2020 2020 6474 7970 6520 3d20 6474 7970      dtype = dtyp
-00004c10: 6520 6f72 2065 6e76 6972 6f6e 2e64 6674  e or environ.dft
-00004c20: 7970 6528 290d 0a20 2020 2073 616d 706c  ype()..    sampl
-00004c30: 6573 203d 206a 722e 6e6f 726d 616c 286b  es = jr.normal(k
-00004c40: 6579 2c20 7368 6170 653d 5f73 697a 6532  ey, shape=_size2
-00004c50: 7368 6170 6528 7369 7a65 292c 2064 7479  shape(size), dty
-00004c60: 7065 3d64 7479 7065 290d 0a20 2020 2073  pe=dtype)..    s
-00004c70: 616d 706c 6573 203d 205f 6c6f 635f 7363  amples = _loc_sc
-00004c80: 616c 6528 6d65 616e 2c20 7369 676d 612c  ale(mean, sigma,
-00004c90: 2073 616d 706c 6573 290d 0a20 2020 2073   samples)..    s
-00004ca0: 616d 706c 6573 203d 206a 6e70 2e65 7870  amples = jnp.exp
-00004cb0: 2873 616d 706c 6573 290d 0a20 2020 2072  (samples)..    r
-00004cc0: 6574 7572 6e20 7361 6d70 6c65 730d 0a0d  eturn samples...
-00004cd0: 0a20 2064 6566 2062 696e 6f6d 6961 6c28  .  def binomial(
-00004ce0: 7365 6c66 2c0d 0a20 2020 2020 2020 2020  self,..         
-00004cf0: 2020 2020 2020 6e2c 0d0a 2020 2020 2020        n,..      
-00004d00: 2020 2020 2020 2020 2070 2c0d 0a20 2020           p,..   
-00004d10: 2020 2020 2020 2020 2020 2020 7369 7a65              size
-00004d20: 3a20 4f70 7469 6f6e 616c 5b53 697a 655d  : Optional[Size]
-00004d30: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
-00004d40: 2020 2020 2020 2020 206b 6579 3a20 4f70           key: Op
-00004d50: 7469 6f6e 616c 5b53 6565 644f 724b 6579  tional[SeedOrKey
-00004d60: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2020  ] = None,..     
-00004d70: 2020 2020 2020 2020 2020 6474 7970 653a            dtype:
-00004d80: 2044 5479 7065 4c69 6b65 203d 204e 6f6e   DTypeLike = Non
-00004d90: 6529 3a0d 0a20 2020 206e 203d 205f 6368  e):..    n = _ch
-00004da0: 6563 6b5f 7079 5f73 6571 286e 290d 0a20  eck_py_seq(n).. 
-00004db0: 2020 2070 203d 205f 6368 6563 6b5f 7079     p = _check_py
-00004dc0: 5f73 6571 2870 290d 0a20 2020 206a 6974  _seq(p)..    jit
-00004dd0: 5f65 7272 6f72 286a 6e70 2e61 6e79 286a  _error(jnp.any(j
-00004de0: 6e70 2e6c 6f67 6963 616c 5f61 6e64 2870  np.logical_and(p
-00004df0: 203c 2030 2c20 7020 3e20 3129 292c 2073   < 0, p > 1)), s
-00004e00: 656c 662e 5f63 6865 636b 5f70 2c20 7029  elf._check_p, p)
-00004e10: 0d0a 2020 2020 6966 2073 697a 6520 6973  ..    if size is
-00004e20: 204e 6f6e 653a 0d0a 2020 2020 2020 7369   None:..      si
-00004e30: 7a65 203d 206a 6e70 2e62 726f 6164 6361  ze = jnp.broadca
-00004e40: 7374 5f73 6861 7065 7328 6a6e 702e 7368  st_shapes(jnp.sh
-00004e50: 6170 6528 6e29 2c20 6a6e 702e 7368 6170  ape(n), jnp.shap
-00004e60: 6528 7029 290d 0a20 2020 206b 6579 203d  e(p))..    key =
-00004e70: 2073 656c 662e 7370 6c69 745f 6b65 7928   self.split_key(
-00004e80: 2920 6966 206b 6579 2069 7320 4e6f 6e65  ) if key is None
-00004e90: 2065 6c73 6520 5f66 6f72 6d61 6c69 7a65   else _formalize
-00004ea0: 5f6b 6579 286b 6579 290d 0a20 2020 2072  _key(key)..    r
-00004eb0: 203d 205f 6269 6e6f 6d69 616c 286b 6579   = _binomial(key
-00004ec0: 2c20 702c 206e 2c20 7368 6170 653d 5f73  , p, n, shape=_s
-00004ed0: 697a 6532 7368 6170 6528 7369 7a65 2929  ize2shape(size))
-00004ee0: 0d0a 2020 2020 6474 7970 6520 3d20 6474  ..    dtype = dt
-00004ef0: 7970 6520 6f72 2065 6e76 6972 6f6e 2e64  ype or environ.d
-00004f00: 6974 7970 6528 290d 0a20 2020 2072 6574  itype()..    ret
-00004f10: 7572 6e20 6a6e 702e 6173 6172 7261 7928  urn jnp.asarray(
-00004f20: 722c 2064 7479 7065 3d64 7479 7065 290d  r, dtype=dtype).
-00004f30: 0a0d 0a20 2064 6566 2063 6869 7371 7561  ...  def chisqua
-00004f40: 7265 2873 656c 662c 0d0a 2020 2020 2020  re(self,..      
-00004f50: 2020 2020 2020 2020 2020 6466 2c0d 0a20            df,.. 
-00004f60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00004f70: 697a 653a 204f 7074 696f 6e61 6c5b 5369  ize: Optional[Si
-00004f80: 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ze] = None,..   
-00004f90: 2020 2020 2020 2020 2020 2020 206b 6579               key
-00004fa0: 3a20 4f70 7469 6f6e 616c 5b53 6565 644f  : Optional[SeedO
-00004fb0: 724b 6579 5d20 3d20 4e6f 6e65 2c0d 0a20  rKey] = None,.. 
-00004fc0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00004fd0: 7479 7065 3a20 4454 7970 654c 696b 6520  type: DTypeLike 
-00004fe0: 3d20 4e6f 6e65 293a 0d0a 2020 2020 6466  = None):..    df
-00004ff0: 203d 205f 6368 6563 6b5f 7079 5f73 6571   = _check_py_seq
-00005000: 2864 6629 0d0a 2020 2020 6b65 7920 3d20  (df)..    key = 
-00005010: 7365 6c66 2e73 706c 6974 5f6b 6579 2829  self.split_key()
-00005020: 2069 6620 6b65 7920 6973 204e 6f6e 6520   if key is None 
-00005030: 656c 7365 205f 666f 726d 616c 697a 655f  else _formalize_
-00005040: 6b65 7928 6b65 7929 0d0a 2020 2020 6474  key(key)..    dt
-00005050: 7970 6520 3d20 6474 7970 6520 6f72 2065  ype = dtype or e
-00005060: 6e76 6972 6f6e 2e64 6674 7970 6528 290d  nviron.dftype().
-00005070: 0a20 2020 2069 6620 7369 7a65 2069 7320  .    if size is 
-00005080: 4e6f 6e65 3a0d 0a20 2020 2020 2069 6620  None:..      if 
-00005090: 6a6e 702e 6e64 696d 2864 6629 203d 3d20  jnp.ndim(df) == 
-000050a0: 303a 0d0a 2020 2020 2020 2020 6469 7374  0:..        dist
-000050b0: 203d 206a 722e 6e6f 726d 616c 286b 6579   = jr.normal(key
-000050c0: 2c20 2864 662c 292c 2064 7479 7065 3d64  , (df,), dtype=d
-000050d0: 7479 7065 2920 2a2a 2032 0d0a 2020 2020  type) ** 2..    
-000050e0: 2020 2020 6469 7374 203d 2064 6973 742e      dist = dist.
-000050f0: 7375 6d28 290d 0a20 2020 2020 2065 6c73  sum()..      els
-00005100: 653a 0d0a 2020 2020 2020 2020 7261 6973  e:..        rais
-00005110: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-00005120: 4572 726f 7228 2744 6f20 6e6f 7420 7375  Error('Do not su
-00005130: 7070 6f72 7420 6e6f 6e2d 7363 616c 6520  pport non-scale 
-00005140: 2264 6622 2077 6865 6e20 2273 697a 6522  "df" when "size"
-00005150: 2069 7320 4e6f 6e65 2729 0d0a 2020 2020   is None')..    
-00005160: 656c 7365 3a0d 0a20 2020 2020 2064 6973  else:..      dis
-00005170: 7420 3d20 6a72 2e6e 6f72 6d61 6c28 6b65  t = jr.normal(ke
-00005180: 792c 2028 6466 2c29 202b 205f 7369 7a65  y, (df,) + _size
-00005190: 3273 6861 7065 2873 697a 6529 2c20 6474  2shape(size), dt
-000051a0: 7970 653d 6474 7970 6529 202a 2a20 320d  ype=dtype) ** 2.
-000051b0: 0a20 2020 2020 2064 6973 7420 3d20 6469  .      dist = di
-000051c0: 7374 2e73 756d 2861 7869 733d 3029 0d0a  st.sum(axis=0)..
-000051d0: 2020 2020 7265 7475 726e 2064 6973 740d      return dist.
-000051e0: 0a0d 0a20 2064 6566 2064 6972 6963 686c  ...  def dirichl
-000051f0: 6574 2873 656c 662c 0d0a 2020 2020 2020  et(self,..      
-00005200: 2020 2020 2020 2020 2020 616c 7068 612c            alpha,
-00005210: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00005220: 2020 7369 7a65 3a20 4f70 7469 6f6e 616c    size: Optional
-00005230: 5b53 697a 655d 203d 204e 6f6e 652c 0d0a  [Size] = None,..
-00005240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005250: 6b65 793a 204f 7074 696f 6e61 6c5b 5365  key: Optional[Se
-00005260: 6564 4f72 4b65 795d 203d 204e 6f6e 652c  edOrKey] = None,
-00005270: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00005280: 2020 6474 7970 653a 2044 5479 7065 4c69    dtype: DTypeLi
-00005290: 6b65 203d 204e 6f6e 6529 3a0d 0a20 2020  ke = None):..   
-000052a0: 206b 6579 203d 2073 656c 662e 7370 6c69   key = self.spli
-000052b0: 745f 6b65 7928 2920 6966 206b 6579 2069  t_key() if key i
-000052c0: 7320 4e6f 6e65 2065 6c73 6520 5f66 6f72  s None else _for
-000052d0: 6d61 6c69 7a65 5f6b 6579 286b 6579 290d  malize_key(key).
-000052e0: 0a20 2020 2061 6c70 6861 203d 205f 6368  .    alpha = _ch
-000052f0: 6563 6b5f 7079 5f73 6571 2861 6c70 6861  eck_py_seq(alpha
-00005300: 290d 0a20 2020 2064 7479 7065 203d 2064  )..    dtype = d
-00005310: 7479 7065 206f 7220 656e 7669 726f 6e2e  type or environ.
-00005320: 6466 7479 7065 2829 0d0a 2020 2020 7220  dftype()..    r 
-00005330: 3d20 6a72 2e64 6972 6963 686c 6574 286b  = jr.dirichlet(k
-00005340: 6579 2c20 616c 7068 613d 616c 7068 612c  ey, alpha=alpha,
-00005350: 2073 6861 7065 3d5f 7369 7a65 3273 6861   shape=_size2sha
-00005360: 7065 2873 697a 6529 2c20 6474 7970 653d  pe(size), dtype=
-00005370: 6474 7970 6529 0d0a 2020 2020 7265 7475  dtype)..    retu
-00005380: 726e 2072 0d0a 0d0a 2020 6465 6620 6765  rn r....  def ge
-00005390: 6f6d 6574 7269 6328 7365 6c66 2c0d 0a20  ometric(self,.. 
-000053a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000053b0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000053c0: 2020 2073 697a 653a 204f 7074 696f 6e61     size: Optiona
-000053d0: 6c5b 5369 7a65 5d20 3d20 4e6f 6e65 2c0d  l[Size] = None,.
-000053e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000053f0: 206b 6579 3a20 4f70 7469 6f6e 616c 5b53   key: Optional[S
-00005400: 6565 644f 724b 6579 5d20 3d20 4e6f 6e65  eedOrKey] = None
-00005410: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00005420: 2020 2064 7479 7065 3a20 4454 7970 654c     dtype: DTypeL
-00005430: 696b 6520 3d20 4e6f 6e65 293a 0d0a 2020  ike = None):..  
-00005440: 2020 7020 3d20 5f63 6865 636b 5f70 795f    p = _check_py_
-00005450: 7365 7128 7029 0d0a 2020 2020 6966 2073  seq(p)..    if s
-00005460: 697a 6520 6973 204e 6f6e 653a 0d0a 2020  ize is None:..  
-00005470: 2020 2020 7369 7a65 203d 206a 6e70 2e73      size = jnp.s
-00005480: 6861 7065 2870 290d 0a20 2020 206b 6579  hape(p)..    key
-00005490: 203d 2073 656c 662e 7370 6c69 745f 6b65   = self.split_ke
-000054a0: 7928 2920 6966 206b 6579 2069 7320 4e6f  y() if key is No
-000054b0: 6e65 2065 6c73 6520 5f66 6f72 6d61 6c69  ne else _formali
-000054c0: 7a65 5f6b 6579 286b 6579 290d 0a20 2020  ze_key(key)..   
-000054d0: 2064 7479 7065 203d 2064 7479 7065 206f   dtype = dtype o
-000054e0: 7220 656e 7669 726f 6e2e 6466 7479 7065  r environ.dftype
-000054f0: 2829 0d0a 2020 2020 7520 3d20 6a72 2e75  ()..    u = jr.u
-00005500: 6e69 666f 726d 286b 6579 2c20 7369 7a65  niform(key, size
-00005510: 2c20 6474 7970 653d 6474 7970 6529 0d0a  , dtype=dtype)..
-00005520: 2020 2020 7220 3d20 6a6e 702e 666c 6f6f      r = jnp.floo
-00005530: 7228 6a6e 702e 6c6f 6731 7028 2d75 2920  r(jnp.log1p(-u) 
-00005540: 2f20 6a6e 702e 6c6f 6731 7028 2d70 2929  / jnp.log1p(-p))
-00005550: 0d0a 2020 2020 7265 7475 726e 2072 0d0a  ..    return r..
-00005560: 0d0a 2020 6465 6620 5f63 6865 636b 5f70  ..  def _check_p
-00005570: 3228 7365 6c66 2c20 7029 3a0d 0a20 2020  2(self, p):..   
-00005580: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00005590: 7228 6627 5765 2072 6571 7569 7265 2060  r(f'We require `
-000055a0: 7375 6d28 7076 616c 735b 3a2d 315d 2920  sum(pvals[:-1]) 
-000055b0: 3c3d 2031 602e 2042 7574 2077 6520 676f  <= 1`. But we go
-000055c0: 7420 7b70 7d27 290d 0a0d 0a20 2064 6566  t {p}')....  def
-000055d0: 206d 756c 7469 6e6f 6d69 616c 2873 656c   multinomial(sel
-000055e0: 662c 0d0a 2020 2020 2020 2020 2020 2020  f,..            
-000055f0: 2020 2020 2020 6e2c 0d0a 2020 2020 2020        n,..      
-00005600: 2020 2020 2020 2020 2020 2020 7076 616c              pval
-00005610: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
-00005620: 2020 2020 2020 7369 7a65 3a20 4f70 7469        size: Opti
-00005630: 6f6e 616c 5b53 697a 655d 203d 204e 6f6e  onal[Size] = Non
-00005640: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
-00005650: 2020 2020 2020 6b65 793a 204f 7074 696f        key: Optio
-00005660: 6e61 6c5b 5365 6564 4f72 4b65 795d 203d  nal[SeedOrKey] =
-00005670: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
-00005680: 2020 2020 2020 2020 2020 6474 7970 653a            dtype:
-00005690: 2044 5479 7065 4c69 6b65 203d 204e 6f6e   DTypeLike = Non
-000056a0: 6529 3a0d 0a20 2020 206b 6579 203d 2073  e):..    key = s
-000056b0: 656c 662e 7370 6c69 745f 6b65 7928 2920  elf.split_key() 
-000056c0: 6966 206b 6579 2069 7320 4e6f 6e65 2065  if key is None e
-000056d0: 6c73 6520 5f66 6f72 6d61 6c69 7a65 5f6b  lse _formalize_k
-000056e0: 6579 286b 6579 290d 0a20 2020 206e 203d  ey(key)..    n =
-000056f0: 205f 6368 6563 6b5f 7079 5f73 6571 286e   _check_py_seq(n
-00005700: 290d 0a20 2020 2070 7661 6c73 203d 205f  )..    pvals = _
-00005710: 6368 6563 6b5f 7079 5f73 6571 2870 7661  check_py_seq(pva
-00005720: 6c73 290d 0a20 2020 206a 6974 5f65 7272  ls)..    jit_err
-00005730: 6f72 286a 6e70 2e73 756d 2870 7661 6c73  or(jnp.sum(pvals
-00005740: 5b3a 2d31 5d29 203e 2031 2e2c 2073 656c  [:-1]) > 1., sel
-00005750: 662e 5f63 6865 636b 5f70 322c 2070 7661  f._check_p2, pva
-00005760: 6c73 290d 0a20 2020 2069 6620 6973 696e  ls)..    if isin
-00005770: 7374 616e 6365 286e 2c20 6a61 782e 636f  stance(n, jax.co
-00005780: 7265 2e54 7261 6365 7229 3a0d 0a20 2020  re.Tracer):..   
-00005790: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000057a0: 726f 7228 2254 6865 2074 6f74 616c 2063  ror("The total c
-000057b0: 6f75 6e74 2070 6172 616d 6574 6572 2060  ount parameter `
-000057c0: 6e60 2073 686f 756c 6420 6e6f 7420 6265  n` should not be
-000057d0: 2061 206a 6178 2061 6273 7472 6163 7420   a jax abstract 
-000057e0: 6172 7261 792e 2229 0d0a 2020 2020 7369  array.")..    si
-000057f0: 7a65 203d 205f 7369 7a65 3273 6861 7065  ze = _size2shape
-00005800: 2873 697a 6529 0d0a 2020 2020 6e5f 6d61  (size)..    n_ma
-00005810: 7820 3d20 696e 7428 6e70 2e6d 6178 286a  x = int(np.max(j
-00005820: 6178 2e64 6576 6963 655f 6765 7428 6e29  ax.device_get(n)
-00005830: 2929 0d0a 2020 2020 6261 7463 685f 7368  ))..    batch_sh
-00005840: 6170 6520 3d20 6c61 782e 6272 6f61 6463  ape = lax.broadc
-00005850: 6173 745f 7368 6170 6573 286a 6e70 2e73  ast_shapes(jnp.s
-00005860: 6861 7065 2870 7661 6c73 295b 3a2d 315d  hape(pvals)[:-1]
-00005870: 2c20 6a6e 702e 7368 6170 6528 6e29 290d  , jnp.shape(n)).
-00005880: 0a20 2020 2072 203d 205f 6d75 6c74 696e  .    r = _multin
-00005890: 6f6d 6961 6c28 6b65 792c 2070 7661 6c73  omial(key, pvals
-000058a0: 2c20 6e2c 206e 5f6d 6178 2c20 6261 7463  , n, n_max, batc
-000058b0: 685f 7368 6170 6520 2b20 7369 7a65 290d  h_shape + size).
-000058c0: 0a20 2020 2064 7479 7065 203d 2064 7479  .    dtype = dty
-000058d0: 7065 206f 7220 656e 7669 726f 6e2e 6469  pe or environ.di
-000058e0: 7479 7065 2829 0d0a 2020 2020 7265 7475  type()..    retu
-000058f0: 726e 206a 6e70 2e61 7361 7272 6179 2872  rn jnp.asarray(r
-00005900: 2c20 6474 7970 653d 6474 7970 6529 0d0a  , dtype=dtype)..
-00005910: 0d0a 2020 6465 6620 6d75 6c74 6976 6172  ..  def multivar
-00005920: 6961 7465 5f6e 6f72 6d61 6c28 7365 6c66  iate_normal(self
-00005930: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00005940: 2020 2020 2020 2020 2020 2020 206d 6561               mea
-00005950: 6e2c 0d0a 2020 2020 2020 2020 2020 2020  n,..            
-00005960: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00005970: 762c 0d0a 2020 2020 2020 2020 2020 2020  v,..            
-00005980: 2020 2020 2020 2020 2020 2020 2020 7369                si
-00005990: 7a65 3a20 4f70 7469 6f6e 616c 5b53 697a  ze: Optional[Siz
-000059a0: 655d 203d 204e 6f6e 652c 0d0a 2020 2020  e] = None,..    
-000059b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000059c0: 2020 2020 2020 6d65 7468 6f64 3a20 7374        method: st
-000059d0: 7220 3d20 2763 686f 6c65 736b 7927 2c0d  r = 'cholesky',.
-000059e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000059f0: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
-00005a00: 4f70 7469 6f6e 616c 5b53 6565 644f 724b  Optional[SeedOrK
-00005a10: 6579 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ey] = None,..   
-00005a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005a30: 2020 2020 2020 2064 7479 7065 3a20 4454         dtype: DT
-00005a40: 7970 654c 696b 6520 3d20 4e6f 6e65 293a  ypeLike = None):
-00005a50: 0d0a 2020 2020 6966 206d 6574 686f 6420  ..    if method 
-00005a60: 6e6f 7420 696e 207b 2773 7664 272c 2027  not in {'svd', '
-00005a70: 6569 6768 272c 2027 6368 6f6c 6573 6b79  eigh', 'cholesky
-00005a80: 277d 3a0d 0a20 2020 2020 2072 6169 7365  '}:..      raise
-00005a90: 2056 616c 7565 4572 726f 7228 226d 6574   ValueError("met
-00005aa0: 686f 6420 6d75 7374 2062 6520 6f6e 6520  hod must be one 
-00005ab0: 6f66 207b 2773 7664 272c 2027 6569 6768  of {'svd', 'eigh
-00005ac0: 272c 2027 6368 6f6c 6573 6b79 277d 2229  ', 'cholesky'}")
-00005ad0: 0d0a 2020 2020 6474 7970 6520 3d20 6474  ..    dtype = dt
-00005ae0: 7970 6520 6f72 2065 6e76 6972 6f6e 2e64  ype or environ.d
-00005af0: 6674 7970 6528 290d 0a20 2020 206d 6561  ftype()..    mea
-00005b00: 6e20 3d20 6a6e 702e 6173 6172 7261 7928  n = jnp.asarray(
-00005b10: 5f63 6865 636b 5f70 795f 7365 7128 6d65  _check_py_seq(me
-00005b20: 616e 292c 2064 7479 7065 3d64 7479 7065  an), dtype=dtype
-00005b30: 290d 0a20 2020 2063 6f76 203d 206a 6e70  )..    cov = jnp
-00005b40: 2e61 7361 7272 6179 285f 6368 6563 6b5f  .asarray(_check_
-00005b50: 7079 5f73 6571 2863 6f76 292c 2064 7479  py_seq(cov), dty
-00005b60: 7065 3d64 7479 7065 290d 0a20 2020 206b  pe=dtype)..    k
-00005b70: 6579 203d 2073 656c 662e 7370 6c69 745f  ey = self.split_
-00005b80: 6b65 7928 2920 6966 206b 6579 2069 7320  key() if key is 
-00005b90: 4e6f 6e65 2065 6c73 6520 5f66 6f72 6d61  None else _forma
-00005ba0: 6c69 7a65 5f6b 6579 286b 6579 290d 0a0d  lize_key(key)...
-00005bb0: 0a20 2020 2069 6620 6e6f 7420 6a6e 702e  .    if not jnp.
-00005bc0: 6e64 696d 286d 6561 6e29 203e 3d20 313a  ndim(mean) >= 1:
-00005bd0: 0d0a 2020 2020 2020 7261 6973 6520 5661  ..      raise Va
-00005be0: 6c75 6545 7272 6f72 2866 226d 756c 7469  lueError(f"multi
-00005bf0: 7661 7269 6174 655f 6e6f 726d 616c 2072  variate_normal r
-00005c00: 6571 7569 7265 7320 6d65 616e 2e6e 6469  equires mean.ndi
-00005c10: 6d20 3e3d 2031 2c20 676f 7420 6d65 616e  m >= 1, got mean
-00005c20: 2e6e 6469 6d20 3d3d 207b 6a6e 702e 6e64  .ndim == {jnp.nd
-00005c30: 696d 286d 6561 6e29 7d22 290d 0a20 2020  im(mean)}")..   
-00005c40: 2069 6620 6e6f 7420 6a6e 702e 6e64 696d   if not jnp.ndim
-00005c50: 2863 6f76 2920 3e3d 2032 3a0d 0a20 2020  (cov) >= 2:..   
-00005c60: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00005c70: 726f 7228 6622 6d75 6c74 6976 6172 6961  ror(f"multivaria
-00005c80: 7465 5f6e 6f72 6d61 6c20 7265 7175 6972  te_normal requir
-00005c90: 6573 2063 6f76 2e6e 6469 6d20 3e3d 2032  es cov.ndim >= 2
-00005ca0: 2c20 676f 7420 636f 762e 6e64 696d 203d  , got cov.ndim =
-00005cb0: 3d20 7b6a 6e70 2e6e 6469 6d28 636f 7629  = {jnp.ndim(cov)
-00005cc0: 7d22 290d 0a20 2020 206e 203d 206d 6561  }")..    n = mea
-00005cd0: 6e2e 7368 6170 655b 2d31 5d0d 0a20 2020  n.shape[-1]..   
-00005ce0: 2069 6620 6a6e 702e 7368 6170 6528 636f   if jnp.shape(co
-00005cf0: 7629 5b2d 323a 5d20 213d 2028 6e2c 206e  v)[-2:] != (n, n
-00005d00: 293a 0d0a 2020 2020 2020 7261 6973 6520  ):..      raise 
-00005d10: 5661 6c75 6545 7272 6f72 2866 226d 756c  ValueError(f"mul
-00005d20: 7469 7661 7269 6174 655f 6e6f 726d 616c  tivariate_normal
-00005d30: 2072 6571 7569 7265 7320 636f 762e 7368   requires cov.sh
-00005d40: 6170 6520 3d3d 2028 2e2e 2e2c 206e 2c20  ape == (..., n, 
-00005d50: 6e29 2066 6f72 206e 3d7b 6e7d 2c20 220d  n) for n={n}, ".
-00005d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005d70: 2020 2020 2020 2020 6622 6275 7420 676f          f"but go
-00005d80: 7420 636f 762e 7368 6170 6520 3d3d 207b  t cov.shape == {
-00005d90: 6a6e 702e 7368 6170 6528 636f 7629 7d2e  jnp.shape(cov)}.
-00005da0: 2229 0d0a 2020 2020 6966 2073 697a 6520  ")..    if size 
-00005db0: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-00005dc0: 7369 7a65 203d 206c 6178 2e62 726f 6164  size = lax.broad
-00005dd0: 6361 7374 5f73 6861 7065 7328 6d65 616e  cast_shapes(mean
-00005de0: 2e73 6861 7065 5b3a 2d31 5d2c 2063 6f76  .shape[:-1], cov
-00005df0: 2e73 6861 7065 5b3a 2d32 5d29 0d0a 2020  .shape[:-2])..  
-00005e00: 2020 656c 7365 3a0d 0a20 2020 2020 2073    else:..      s
-00005e10: 697a 6520 3d20 5f73 697a 6532 7368 6170  ize = _size2shap
-00005e20: 6528 7369 7a65 290d 0a20 2020 2020 205f  e(size)..      _
-00005e30: 6368 6563 6b5f 7368 6170 6528 226e 6f72  check_shape("nor
-00005e40: 6d61 6c22 2c20 7369 7a65 2c20 6d65 616e  mal", size, mean
-00005e50: 2e73 6861 7065 5b3a 2d31 5d2c 2063 6f76  .shape[:-1], cov
-00005e60: 2e73 6861 7065 5b3a 2d32 5d29 0d0a 0d0a  .shape[:-2])....
-00005e70: 2020 2020 6966 206d 6574 686f 6420 3d3d      if method ==
-00005e80: 2027 7376 6427 3a0d 0a20 2020 2020 2028   'svd':..      (
-00005e90: 752c 2073 2c20 5f29 203d 206a 6e70 2e6c  u, s, _) = jnp.l
-00005ea0: 696e 616c 672e 7376 6428 636f 7629 0d0a  inalg.svd(cov)..
-00005eb0: 2020 2020 2020 6661 6374 6f72 203d 2075        factor = u
-00005ec0: 202a 206a 6e70 2e73 7172 7428 735b 2e2e   * jnp.sqrt(s[..
-00005ed0: 2e2c 204e 6f6e 652c 203a 5d29 0d0a 2020  ., None, :])..  
-00005ee0: 2020 656c 6966 206d 6574 686f 6420 3d3d    elif method ==
-00005ef0: 2027 6569 6768 273a 0d0a 2020 2020 2020   'eigh':..      
-00005f00: 2877 2c20 7629 203d 206a 6e70 2e6c 696e  (w, v) = jnp.lin
-00005f10: 616c 672e 6569 6768 2863 6f76 290d 0a20  alg.eigh(cov).. 
-00005f20: 2020 2020 2066 6163 746f 7220 3d20 7620       factor = v 
-00005f30: 2a20 6a6e 702e 7371 7274 2877 5b2e 2e2e  * jnp.sqrt(w[...
-00005f40: 2c20 4e6f 6e65 2c20 3a5d 290d 0a20 2020  , None, :])..   
-00005f50: 2065 6c73 653a 2020 2320 2763 686f 6c65   else:  # 'chole
-00005f60: 736b 7927 0d0a 2020 2020 2020 6661 6374  sky'..      fact
-00005f70: 6f72 203d 206a 6e70 2e6c 696e 616c 672e  or = jnp.linalg.
-00005f80: 6368 6f6c 6573 6b79 2863 6f76 290d 0a20  cholesky(cov).. 
-00005f90: 2020 206e 6f72 6d61 6c5f 7361 6d70 6c65     normal_sample
-00005fa0: 7320 3d20 6a72 2e6e 6f72 6d61 6c28 6b65  s = jr.normal(ke
-00005fb0: 792c 2073 697a 6520 2b20 6d65 616e 2e73  y, size + mean.s
-00005fc0: 6861 7065 5b2d 313a 5d2c 2064 7479 7065  hape[-1:], dtype
-00005fd0: 3d64 7479 7065 290d 0a20 2020 2072 203d  =dtype)..    r =
-00005fe0: 206d 6561 6e20 2b20 6a6e 702e 6569 6e73   mean + jnp.eins
-00005ff0: 756d 2827 2e2e 2e69 6a2c 2e2e 2e6a 2d3e  um('...ij,...j->
-00006000: 2e2e 2e69 272c 2066 6163 746f 722c 206e  ...i', factor, n
-00006010: 6f72 6d61 6c5f 7361 6d70 6c65 7329 0d0a  ormal_samples)..
-00006020: 2020 2020 7265 7475 726e 2072 0d0a 0d0a      return r....
-00006030: 2020 6465 6620 7261 796c 6569 6768 2873    def rayleigh(s
-00006040: 656c 662c 0d0a 2020 2020 2020 2020 2020  elf,..          
-00006050: 2020 2020 2073 6361 6c65 3d31 2e30 2c0d       scale=1.0,.
-00006060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006070: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b53  size: Optional[S
-00006080: 697a 655d 203d 204e 6f6e 652c 0d0a 2020  ize] = None,..  
-00006090: 2020 2020 2020 2020 2020 2020 206b 6579               key
-000060a0: 3a20 4f70 7469 6f6e 616c 5b53 6565 644f  : Optional[SeedO
-000060b0: 724b 6579 5d20 3d20 4e6f 6e65 2c0d 0a20  rKey] = None,.. 
-000060c0: 2020 2020 2020 2020 2020 2020 2020 6474                dt
-000060d0: 7970 653a 2044 5479 7065 4c69 6b65 203d  ype: DTypeLike =
-000060e0: 204e 6f6e 6529 3a0d 0a20 2020 2073 6361   None):..    sca
-000060f0: 6c65 203d 205f 6368 6563 6b5f 7079 5f73  le = _check_py_s
-00006100: 6571 2873 6361 6c65 290d 0a20 2020 2069  eq(scale)..    i
-00006110: 6620 7369 7a65 2069 7320 4e6f 6e65 3a0d  f size is None:.
-00006120: 0a20 2020 2020 2073 697a 6520 3d20 6a6e  .      size = jn
-00006130: 702e 7368 6170 6528 7363 616c 6529 0d0a  p.shape(scale)..
-00006140: 2020 2020 6b65 7920 3d20 7365 6c66 2e73      key = self.s
-00006150: 706c 6974 5f6b 6579 2829 2069 6620 6b65  plit_key() if ke
-00006160: 7920 6973 204e 6f6e 6520 656c 7365 205f  y is None else _
-00006170: 666f 726d 616c 697a 655f 6b65 7928 6b65  formalize_key(ke
-00006180: 7929 0d0a 2020 2020 6474 7970 6520 3d20  y)..    dtype = 
-00006190: 6474 7970 6520 6f72 2065 6e76 6972 6f6e  dtype or environ
-000061a0: 2e64 6674 7970 6528 290d 0a20 2020 2078  .dftype()..    x
-000061b0: 203d 206a 6e70 2e73 7172 7428 2d32 2e20   = jnp.sqrt(-2. 
-000061c0: 2a20 6a6e 702e 6c6f 6728 6a72 2e75 6e69  * jnp.log(jr.uni
-000061d0: 666f 726d 286b 6579 2c20 7368 6170 653d  form(key, shape=
-000061e0: 5f73 697a 6532 7368 6170 6528 7369 7a65  _size2shape(size
-000061f0: 292c 206d 696e 7661 6c3d 302c 206d 6178  ), minval=0, max
-00006200: 7661 6c3d 312c 2064 7479 7065 3d64 7479  val=1, dtype=dty
-00006210: 7065 2929 290d 0a20 2020 2072 203d 2078  pe)))..    r = x
-00006220: 202a 2073 6361 6c65 0d0a 2020 2020 7265   * scale..    re
-00006230: 7475 726e 2072 0d0a 0d0a 2020 6465 6620  turn r....  def 
-00006240: 7472 6961 6e67 756c 6172 2873 656c 662c  triangular(self,
-00006250: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00006260: 2020 2073 697a 653a 204f 7074 696f 6e61     size: Optiona
-00006270: 6c5b 5369 7a65 5d20 3d20 4e6f 6e65 2c0d  l[Size] = None,.
-00006280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006290: 2020 6b65 793a 204f 7074 696f 6e61 6c5b    key: Optional[
-000062a0: 5365 6564 4f72 4b65 795d 203d 204e 6f6e  SeedOrKey] = Non
-000062b0: 6529 3a0d 0a20 2020 206b 6579 203d 2073  e):..    key = s
-000062c0: 656c 662e 7370 6c69 745f 6b65 7928 2920  elf.split_key() 
-000062d0: 6966 206b 6579 2069 7320 4e6f 6e65 2065  if key is None e
-000062e0: 6c73 6520 5f66 6f72 6d61 6c69 7a65 5f6b  lse _formalize_k
-000062f0: 6579 286b 6579 290d 0a20 2020 2062 6572  ey(key)..    ber
-00006300: 6e6f 756c 6c69 5f73 616d 706c 6573 203d  noulli_samples =
-00006310: 206a 722e 6265 726e 6f75 6c6c 6928 6b65   jr.bernoulli(ke
-00006320: 792c 2070 3d30 2e35 2c20 7368 6170 653d  y, p=0.5, shape=
-00006330: 5f73 697a 6532 7368 6170 6528 7369 7a65  _size2shape(size
-00006340: 2929 0d0a 2020 2020 7220 3d20 3220 2a20  ))..    r = 2 * 
-00006350: 6265 726e 6f75 6c6c 695f 7361 6d70 6c65  bernoulli_sample
-00006360: 7320 2d20 310d 0a20 2020 2072 6574 7572  s - 1..    retur
-00006370: 6e20 720d 0a0d 0a20 2064 6566 2076 6f6e  n r....  def von
-00006380: 6d69 7365 7328 7365 6c66 2c0d 0a20 2020  mises(self,..   
-00006390: 2020 2020 2020 2020 2020 2020 6d75 2c0d              mu,.
-000063a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000063b0: 6b61 7070 612c 0d0a 2020 2020 2020 2020  kappa,..        
-000063c0: 2020 2020 2020 2073 697a 653a 204f 7074         size: Opt
-000063d0: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
-000063e0: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
-000063f0: 2020 2020 6b65 793a 204f 7074 696f 6e61      key: Optiona
-00006400: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
-00006410: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
-00006420: 2020 2020 2064 7479 7065 3a20 4454 7970       dtype: DTyp
-00006430: 654c 696b 6520 3d20 4e6f 6e65 293a 0d0a  eLike = None):..
-00006440: 2020 2020 6b65 7920 3d20 7365 6c66 2e73      key = self.s
-00006450: 706c 6974 5f6b 6579 2829 2069 6620 6b65  plit_key() if ke
-00006460: 7920 6973 204e 6f6e 6520 656c 7365 205f  y is None else _
-00006470: 666f 726d 616c 697a 655f 6b65 7928 6b65  formalize_key(ke
-00006480: 7929 0d0a 2020 2020 6474 7970 6520 3d20  y)..    dtype = 
-00006490: 6474 7970 6520 6f72 2065 6e76 6972 6f6e  dtype or environ
-000064a0: 2e64 6674 7970 6528 290d 0a20 2020 206d  .dftype()..    m
-000064b0: 7520 3d20 6a6e 702e 6173 6172 7261 7928  u = jnp.asarray(
-000064c0: 5f63 6865 636b 5f70 795f 7365 7128 6d75  _check_py_seq(mu
-000064d0: 292c 2064 7479 7065 3d64 7479 7065 290d  ), dtype=dtype).
-000064e0: 0a20 2020 206b 6170 7061 203d 206a 6e70  .    kappa = jnp
-000064f0: 2e61 7361 7272 6179 285f 6368 6563 6b5f  .asarray(_check_
-00006500: 7079 5f73 6571 286b 6170 7061 292c 2064  py_seq(kappa), d
-00006510: 7479 7065 3d64 7479 7065 290d 0a20 2020  type=dtype)..   
-00006520: 2069 6620 7369 7a65 2069 7320 4e6f 6e65   if size is None
-00006530: 3a0d 0a20 2020 2020 2073 697a 6520 3d20  :..      size = 
-00006540: 6c61 782e 6272 6f61 6463 6173 745f 7368  lax.broadcast_sh
-00006550: 6170 6573 286a 6e70 2e73 6861 7065 286d  apes(jnp.shape(m
-00006560: 7529 2c20 6a6e 702e 7368 6170 6528 6b61  u), jnp.shape(ka
-00006570: 7070 6129 290d 0a20 2020 2073 697a 6520  ppa))..    size 
-00006580: 3d20 5f73 697a 6532 7368 6170 6528 7369  = _size2shape(si
-00006590: 7a65 290d 0a20 2020 2073 616d 706c 6573  ze)..    samples
-000065a0: 203d 205f 766f 6e5f 6d69 7365 735f 6365   = _von_mises_ce
-000065b0: 6e74 6572 6564 286b 6579 2c20 6b61 7070  ntered(key, kapp
-000065c0: 612c 2073 697a 652c 2064 7479 7065 3d64  a, size, dtype=d
-000065d0: 7479 7065 290d 0a20 2020 2073 616d 706c  type)..    sampl
-000065e0: 6573 203d 2073 616d 706c 6573 202b 206d  es = samples + m
-000065f0: 750d 0a20 2020 2073 616d 706c 6573 203d  u..    samples =
-00006600: 2028 7361 6d70 6c65 7320 2b20 6a6e 702e   (samples + jnp.
-00006610: 7069 2920 2520 2832 2e30 202a 206a 6e70  pi) % (2.0 * jnp
-00006620: 2e70 6929 202d 206a 6e70 2e70 690d 0a20  .pi) - jnp.pi.. 
-00006630: 2020 2072 6574 7572 6e20 7361 6d70 6c65     return sample
-00006640: 730d 0a0d 0a20 2064 6566 2077 6569 6275  s....  def weibu
-00006650: 6c6c 2873 656c 662c 0d0a 2020 2020 2020  ll(self,..      
-00006660: 2020 2020 2020 2020 612c 0d0a 2020 2020          a,..    
-00006670: 2020 2020 2020 2020 2020 7369 7a65 3a20            size: 
-00006680: 4f70 7469 6f6e 616c 5b53 697a 655d 203d  Optional[Size] =
-00006690: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
-000066a0: 2020 2020 2020 6b65 793a 204f 7074 696f        key: Optio
-000066b0: 6e61 6c5b 5365 6564 4f72 4b65 795d 203d  nal[SeedOrKey] =
-000066c0: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
-000066d0: 2020 2020 2020 6474 7970 653a 2044 5479        dtype: DTy
-000066e0: 7065 4c69 6b65 203d 204e 6f6e 6529 3a0d  peLike = None):.
-000066f0: 0a20 2020 206b 6579 203d 2073 656c 662e  .    key = self.
-00006700: 7370 6c69 745f 6b65 7928 2920 6966 206b  split_key() if k
-00006710: 6579 2069 7320 4e6f 6e65 2065 6c73 6520  ey is None else 
-00006720: 5f66 6f72 6d61 6c69 7a65 5f6b 6579 286b  _formalize_key(k
-00006730: 6579 290d 0a20 2020 2061 203d 205f 6368  ey)..    a = _ch
-00006740: 6563 6b5f 7079 5f73 6571 2861 290d 0a20  eck_py_seq(a).. 
-00006750: 2020 2069 6620 7369 7a65 2069 7320 4e6f     if size is No
-00006760: 6e65 3a0d 0a20 2020 2020 2073 697a 6520  ne:..      size 
-00006770: 3d20 6a6e 702e 7368 6170 6528 6129 0d0a  = jnp.shape(a)..
-00006780: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00006790: 2069 6620 6a6e 702e 7369 7a65 2861 2920   if jnp.size(a) 
-000067a0: 3e20 313a 0d0a 2020 2020 2020 2020 7261  > 1:..        ra
-000067b0: 6973 6520 5661 6c75 6545 7272 6f72 2866  ise ValueError(f
-000067c0: 2722 6122 2073 686f 756c 6420 6265 2061  '"a" should be a
-000067d0: 2073 6361 6c61 7220 7768 656e 2022 7369   scalar when "si
-000067e0: 7a65 2220 6973 2070 726f 7669 6465 642e  ze" is provided.
-000067f0: 2042 7574 2077 6520 676f 7420 7b61 7d27   But we got {a}'
-00006800: 290d 0a20 2020 2073 697a 6520 3d20 5f73  )..    size = _s
-00006810: 697a 6532 7368 6170 6528 7369 7a65 290d  ize2shape(size).
-00006820: 0a20 2020 2064 7479 7065 203d 2064 7479  .    dtype = dty
-00006830: 7065 206f 7220 656e 7669 726f 6e2e 6466  pe or environ.df
-00006840: 7479 7065 2829 0d0a 2020 2020 7261 6e64  type()..    rand
-00006850: 6f6d 5f75 6e69 666f 726d 203d 206a 722e  om_uniform = jr.
-00006860: 756e 6966 6f72 6d28 6b65 793d 6b65 792c  uniform(key=key,
-00006870: 2073 6861 7065 3d73 697a 652c 206d 696e   shape=size, min
-00006880: 7661 6c3d 302c 206d 6178 7661 6c3d 312c  val=0, maxval=1,
-00006890: 2064 7479 7065 3d64 7479 7065 290d 0a20   dtype=dtype).. 
-000068a0: 2020 2072 203d 206a 6e70 2e70 6f77 6572     r = jnp.power
-000068b0: 282d 6a6e 702e 6c6f 6731 7028 2d72 616e  (-jnp.log1p(-ran
-000068c0: 646f 6d5f 756e 6966 6f72 6d29 2c20 312e  dom_uniform), 1.
-000068d0: 3020 2f20 6129 0d0a 2020 2020 7265 7475  0 / a)..    retu
-000068e0: 726e 2072 0d0a 0d0a 2020 6465 6620 7765  rn r....  def we
-000068f0: 6962 756c 6c5f 6d69 6e28 7365 6c66 2c0d  ibull_min(self,.
-00006900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006910: 2020 2061 2c0d 0a20 2020 2020 2020 2020     a,..         
-00006920: 2020 2020 2020 2020 2073 6361 6c65 3d4e           scale=N
-00006930: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
-00006940: 2020 2020 2020 2020 7369 7a65 3a20 4f70          size: Op
-00006950: 7469 6f6e 616c 5b53 697a 655d 203d 204e  tional[Size] = N
-00006960: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
-00006970: 2020 2020 2020 2020 6b65 793a 204f 7074          key: Opt
-00006980: 696f 6e61 6c5b 5365 6564 4f72 4b65 795d  ional[SeedOrKey]
-00006990: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
-000069a0: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
-000069b0: 653a 2044 5479 7065 4c69 6b65 203d 204e  e: DTypeLike = N
-000069c0: 6f6e 6529 3a0d 0a20 2020 206b 6579 203d  one):..    key =
-000069d0: 2073 656c 662e 7370 6c69 745f 6b65 7928   self.split_key(
-000069e0: 2920 6966 206b 6579 2069 7320 4e6f 6e65  ) if key is None
-000069f0: 2065 6c73 6520 5f66 6f72 6d61 6c69 7a65   else _formalize
-00006a00: 5f6b 6579 286b 6579 290d 0a20 2020 2061  _key(key)..    a
-00006a10: 203d 205f 6368 6563 6b5f 7079 5f73 6571   = _check_py_seq
-00006a20: 2861 290d 0a20 2020 2073 6361 6c65 203d  (a)..    scale =
-00006a30: 205f 6368 6563 6b5f 7079 5f73 6571 2873   _check_py_seq(s
-00006a40: 6361 6c65 290d 0a20 2020 2069 6620 7369  cale)..    if si
-00006a50: 7a65 2069 7320 4e6f 6e65 3a0d 0a20 2020  ze is None:..   
-00006a60: 2020 2073 697a 6520 3d20 6a6e 702e 6272     size = jnp.br
-00006a70: 6f61 6463 6173 745f 7368 6170 6573 286a  oadcast_shapes(j
-00006a80: 6e70 2e73 6861 7065 2861 292c 206a 6e70  np.shape(a), jnp
-00006a90: 2e73 6861 7065 2873 6361 6c65 2929 0d0a  .shape(scale))..
-00006aa0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00006ab0: 2069 6620 6a6e 702e 7369 7a65 2861 2920   if jnp.size(a) 
-00006ac0: 3e20 313a 0d0a 2020 2020 2020 2020 7261  > 1:..        ra
-00006ad0: 6973 6520 5661 6c75 6545 7272 6f72 2866  ise ValueError(f
-00006ae0: 2722 6122 2073 686f 756c 6420 6265 2061  '"a" should be a
-00006af0: 2073 6361 6c61 7220 7768 656e 2022 7369   scalar when "si
-00006b00: 7a65 2220 6973 2070 726f 7669 6465 642e  ze" is provided.
-00006b10: 2042 7574 2077 6520 676f 7420 7b61 7d27   But we got {a}'
-00006b20: 290d 0a20 2020 2073 697a 6520 3d20 5f73  )..    size = _s
-00006b30: 697a 6532 7368 6170 6528 7369 7a65 290d  ize2shape(size).
-00006b40: 0a20 2020 2064 7479 7065 203d 2064 7479  .    dtype = dty
-00006b50: 7065 206f 7220 656e 7669 726f 6e2e 6466  pe or environ.df
-00006b60: 7479 7065 2829 0d0a 2020 2020 7261 6e64  type()..    rand
-00006b70: 6f6d 5f75 6e69 666f 726d 203d 206a 722e  om_uniform = jr.
-00006b80: 756e 6966 6f72 6d28 6b65 793d 6b65 792c  uniform(key=key,
-00006b90: 2073 6861 7065 3d73 697a 652c 206d 696e   shape=size, min
-00006ba0: 7661 6c3d 302c 206d 6178 7661 6c3d 312c  val=0, maxval=1,
-00006bb0: 2064 7479 7065 3d64 7479 7065 290d 0a20   dtype=dtype).. 
-00006bc0: 2020 2072 203d 206a 6e70 2e70 6f77 6572     r = jnp.power
-00006bd0: 282d 6a6e 702e 6c6f 6731 7028 2d72 616e  (-jnp.log1p(-ran
-00006be0: 646f 6d5f 756e 6966 6f72 6d29 2c20 312e  dom_uniform), 1.
-00006bf0: 3020 2f20 6129 0d0a 2020 2020 6966 2073  0 / a)..    if s
-00006c00: 6361 6c65 2069 7320 6e6f 7420 4e6f 6e65  cale is not None
-00006c10: 3a0d 0a20 2020 2020 2072 202f 3d20 7363  :..      r /= sc
-00006c20: 616c 650d 0a20 2020 2072 6574 7572 6e20  ale..    return 
-00006c30: 720d 0a0d 0a20 2064 6566 206d 6178 7765  r....  def maxwe
-00006c40: 6c6c 2873 656c 662c 0d0a 2020 2020 2020  ll(self,..      
-00006c50: 2020 2020 2020 2020 7369 7a65 3a20 4f70          size: Op
-00006c60: 7469 6f6e 616c 5b53 697a 655d 203d 204e  tional[Size] = N
-00006c70: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
-00006c80: 2020 2020 6b65 793a 204f 7074 696f 6e61      key: Optiona
-00006c90: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
-00006ca0: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
-00006cb0: 2020 2020 6474 7970 653a 2044 5479 7065      dtype: DType
-00006cc0: 4c69 6b65 203d 204e 6f6e 6529 3a0d 0a20  Like = None):.. 
-00006cd0: 2020 206b 6579 203d 2073 656c 662e 7370     key = self.sp
-00006ce0: 6c69 745f 6b65 7928 2920 6966 206b 6579  lit_key() if key
-00006cf0: 2069 7320 4e6f 6e65 2065 6c73 6520 5f66   is None else _f
-00006d00: 6f72 6d61 6c69 7a65 5f6b 6579 286b 6579  ormalize_key(key
-00006d10: 290d 0a20 2020 2073 6861 7065 203d 2063  )..    shape = c
-00006d20: 6f72 652e 6361 6e6f 6e69 6361 6c69 7a65  ore.canonicalize
-00006d30: 5f73 6861 7065 285f 7369 7a65 3273 6861  _shape(_size2sha
-00006d40: 7065 2873 697a 6529 2920 2b20 2833 2c29  pe(size)) + (3,)
-00006d50: 0d0a 2020 2020 6474 7970 6520 3d20 6474  ..    dtype = dt
-00006d60: 7970 6520 6f72 2065 6e76 6972 6f6e 2e64  ype or environ.d
-00006d70: 6674 7970 6528 290d 0a20 2020 206e 6f72  ftype()..    nor
-00006d80: 6d5f 7276 7320 3d20 6a72 2e6e 6f72 6d61  m_rvs = jr.norma
-00006d90: 6c28 6b65 793d 6b65 792c 2073 6861 7065  l(key=key, shape
-00006da0: 3d73 6861 7065 2c20 6474 7970 653d 6474  =shape, dtype=dt
-00006db0: 7970 6529 0d0a 2020 2020 7220 3d20 6a6e  ype)..    r = jn
-00006dc0: 702e 6c69 6e61 6c67 2e6e 6f72 6d28 6e6f  p.linalg.norm(no
-00006dd0: 726d 5f72 7673 2c20 6178 6973 3d2d 3129  rm_rvs, axis=-1)
-00006de0: 0d0a 2020 2020 7265 7475 726e 2072 0d0a  ..    return r..
-00006df0: 0d0a 2020 6465 6620 6e65 6761 7469 7665  ..  def negative
-00006e00: 5f62 696e 6f6d 6961 6c28 7365 6c66 2c0d  _binomial(self,.
-00006e10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006e20: 2020 2020 2020 2020 206e 2c0d 0a20 2020           n,..   
-00006e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006e40: 2020 2020 2070 2c0d 0a20 2020 2020 2020       p,..       
-00006e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006e60: 2073 697a 653a 204f 7074 696f 6e61 6c5b   size: Optional[
-00006e70: 5369 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20  Size] = None,.. 
-00006e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006e90: 2020 2020 2020 206b 6579 3a20 4f70 7469         key: Opti
-00006ea0: 6f6e 616c 5b53 6565 644f 724b 6579 5d20  onal[SeedOrKey] 
-00006eb0: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 2020  = None,..       
-00006ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006ed0: 2064 7479 7065 3a20 4454 7970 654c 696b   dtype: DTypeLik
-00006ee0: 6520 3d20 4e6f 6e65 293a 0d0a 2020 2020  e = None):..    
-00006ef0: 6e20 3d20 5f63 6865 636b 5f70 795f 7365  n = _check_py_se
-00006f00: 7128 6e29 0d0a 2020 2020 7020 3d20 5f63  q(n)..    p = _c
-00006f10: 6865 636b 5f70 795f 7365 7128 7029 0d0a  heck_py_seq(p)..
-00006f20: 2020 2020 6966 2073 697a 6520 6973 204e      if size is N
-00006f30: 6f6e 653a 0d0a 2020 2020 2020 7369 7a65  one:..      size
-00006f40: 203d 206c 6178 2e62 726f 6164 6361 7374   = lax.broadcast
-00006f50: 5f73 6861 7065 7328 6a6e 702e 7368 6170  _shapes(jnp.shap
-00006f60: 6528 6e29 2c20 6a6e 702e 7368 6170 6528  e(n), jnp.shape(
-00006f70: 7029 290d 0a20 2020 2073 697a 6520 3d20  p))..    size = 
-00006f80: 5f73 697a 6532 7368 6170 6528 7369 7a65  _size2shape(size
-00006f90: 290d 0a20 2020 206c 6f67 6974 7320 3d20  )..    logits = 
-00006fa0: 6a6e 702e 6c6f 6728 7029 202d 206a 6e70  jnp.log(p) - jnp
-00006fb0: 2e6c 6f67 3170 282d 7029 0d0a 2020 2020  .log1p(-p)..    
-00006fc0: 6966 206b 6579 2069 7320 4e6f 6e65 3a0d  if key is None:.
-00006fd0: 0a20 2020 2020 206b 6579 7320 3d20 7365  .      keys = se
-00006fe0: 6c66 2e73 706c 6974 5f6b 6579 7328 3229  lf.split_keys(2)
-00006ff0: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
-00007000: 2020 206b 6579 7320 3d20 6a72 2e73 706c     keys = jr.spl
-00007010: 6974 285f 666f 726d 616c 697a 655f 6b65  it(_formalize_ke
-00007020: 7928 6b65 7929 2c20 3229 0d0a 2020 2020  y(key), 2)..    
-00007030: 7261 7465 203d 2073 656c 662e 6761 6d6d  rate = self.gamm
-00007040: 6128 7368 6170 653d 6e2c 2073 6361 6c65  a(shape=n, scale
-00007050: 3d6a 6e70 2e65 7870 282d 6c6f 6769 7473  =jnp.exp(-logits
-00007060: 292c 2073 697a 653d 7369 7a65 2c20 6b65  ), size=size, ke
-00007070: 793d 6b65 7973 5b30 5d2c 2064 7479 7065  y=keys[0], dtype
-00007080: 3d65 6e76 6972 6f6e 2e64 6674 7970 6528  =environ.dftype(
-00007090: 2929 0d0a 2020 2020 7220 3d20 7365 6c66  ))..    r = self
-000070a0: 2e70 6f69 7373 6f6e 286c 616d 3d72 6174  .poisson(lam=rat
-000070b0: 652c 206b 6579 3d6b 6579 735b 315d 2c20  e, key=keys[1], 
-000070c0: 6474 7970 653d 6474 7970 6520 6f72 2065  dtype=dtype or e
-000070d0: 6e76 6972 6f6e 2e64 6974 7970 6528 2929  nviron.ditype())
-000070e0: 0d0a 2020 2020 7265 7475 726e 2072 0d0a  ..    return r..
-000070f0: 0d0a 2020 6465 6620 7761 6c64 2873 656c  ..  def wald(sel
-00007100: 662c 0d0a 2020 2020 2020 2020 2020 206d  f,..           m
-00007110: 6561 6e2c 0d0a 2020 2020 2020 2020 2020  ean,..          
-00007120: 2073 6361 6c65 2c0d 0a20 2020 2020 2020   scale,..       
-00007130: 2020 2020 7369 7a65 3a20 4f70 7469 6f6e      size: Option
-00007140: 616c 5b53 697a 655d 203d 204e 6f6e 652c  al[Size] = None,
-00007150: 0d0a 2020 2020 2020 2020 2020 206b 6579  ..           key
-00007160: 3a20 4f70 7469 6f6e 616c 5b53 6565 644f  : Optional[SeedO
-00007170: 724b 6579 5d20 3d20 4e6f 6e65 2c0d 0a20  rKey] = None,.. 
-00007180: 2020 2020 2020 2020 2020 6474 7970 653a            dtype:
-00007190: 2044 5479 7065 4c69 6b65 203d 204e 6f6e   DTypeLike = Non
-000071a0: 6529 3a0d 0a20 2020 2064 7479 7065 203d  e):..    dtype =
-000071b0: 2064 7479 7065 206f 7220 656e 7669 726f   dtype or enviro
-000071c0: 6e2e 6466 7479 7065 2829 0d0a 2020 2020  n.dftype()..    
-000071d0: 6b65 7920 3d20 7365 6c66 2e73 706c 6974  key = self.split
-000071e0: 5f6b 6579 2829 2069 6620 6b65 7920 6973  _key() if key is
-000071f0: 204e 6f6e 6520 656c 7365 205f 666f 726d   None else _form
-00007200: 616c 697a 655f 6b65 7928 6b65 7929 0d0a  alize_key(key)..
-00007210: 2020 2020 6d65 616e 203d 206a 6e70 2e61      mean = jnp.a
-00007220: 7361 7272 6179 285f 6368 6563 6b5f 7079  sarray(_check_py
-00007230: 5f73 6571 286d 6561 6e29 2c20 6474 7970  _seq(mean), dtyp
-00007240: 653d 6474 7970 6529 0d0a 2020 2020 7363  e=dtype)..    sc
-00007250: 616c 6520 3d20 6a6e 702e 6173 6172 7261  ale = jnp.asarra
-00007260: 7928 5f63 6865 636b 5f70 795f 7365 7128  y(_check_py_seq(
-00007270: 7363 616c 6529 2c20 6474 7970 653d 6474  scale), dtype=dt
-00007280: 7970 6529 0d0a 2020 2020 6966 2073 697a  ype)..    if siz
-00007290: 6520 6973 204e 6f6e 653a 0d0a 2020 2020  e is None:..    
-000072a0: 2020 7369 7a65 203d 206c 6178 2e62 726f    size = lax.bro
-000072b0: 6164 6361 7374 5f73 6861 7065 7328 6a6e  adcast_shapes(jn
-000072c0: 702e 7368 6170 6528 6d65 616e 292c 206a  p.shape(mean), j
-000072d0: 6e70 2e73 6861 7065 2873 6361 6c65 2929  np.shape(scale))
-000072e0: 0d0a 2020 2020 7369 7a65 203d 205f 7369  ..    size = _si
-000072f0: 7a65 3273 6861 7065 2873 697a 6529 0d0a  ze2shape(size)..
-00007300: 2020 2020 7361 6d70 6c65 645f 6368 6932      sampled_chi2
-00007310: 203d 206a 6e70 2e73 7175 6172 6528 7365   = jnp.square(se
-00007320: 6c66 2e72 616e 646e 282a 7369 7a65 2929  lf.randn(*size))
-00007330: 0d0a 2020 2020 7361 6d70 6c65 645f 756e  ..    sampled_un
-00007340: 6966 6f72 6d20 3d20 7365 6c66 2e75 6e69  iform = self.uni
-00007350: 666f 726d 2873 697a 653d 7369 7a65 2c20  form(size=size, 
-00007360: 6b65 793d 6b65 792c 2064 7479 7065 3d64  key=key, dtype=d
-00007370: 7479 7065 290d 0a20 2020 2023 2057 696b  type)..    # Wik
-00007380: 6970 6564 6961 2064 6566 696e 6573 2061  ipedia defines a
-00007390: 6e20 696e 7465 726d 6564 6961 7465 2078  n intermediate x
-000073a0: 2077 6974 6820 7468 6520 666f 726d 756c   with the formul
-000073b0: 610d 0a20 2020 2023 2020 2078 203d 206c  a..    #   x = l
-000073c0: 6f63 202b 206c 6f63 202a 2a20 3220 2a20  oc + loc ** 2 * 
-000073d0: 7920 2f20 2832 202a 2063 6f6e 6329 202d  y / (2 * conc) -
-000073e0: 206c 6f63 202f 2028 3220 2a20 636f 6e63   loc / (2 * conc
-000073f0: 2920 2a20 7371 7274 2834 202a 206c 6f63  ) * sqrt(4 * loc
-00007400: 202a 2063 6f6e 6320 2a20 7920 2b20 6c6f   * conc * y + lo
-00007410: 6320 2a2a 2032 202a 2079 202a 2a20 3229  c ** 2 * y ** 2)
-00007420: 0d0a 2020 2020 2320 7768 6572 6520 7920  ..    # where y 
-00007430: 7e20 4e28 302c 2031 292a 2a32 2028 7361  ~ N(0, 1)**2 (sa
-00007440: 6d70 6c65 645f 6368 6932 2061 626f 7665  mpled_chi2 above
-00007450: 2920 616e 6420 636f 6e63 2069 7320 7468  ) and conc is th
-00007460: 6520 636f 6e63 656e 7472 6174 696f 6e2e  e concentration.
-00007470: 0d0a 2020 2020 2320 4c65 7420 7573 2077  ..    # Let us w
-00007480: 7269 7465 0d0a 2020 2020 2320 2020 7720  rite..    #   w 
-00007490: 3d20 6c6f 6320 2a20 7920 2f20 2832 202a  = loc * y / (2 *
-000074a0: 2063 6f6e 6329 0d0a 2020 2020 2320 5468   conc)..    # Th
-000074b0: 656e 2077 6520 6361 6e20 6578 7472 6163  en we can extrac
-000074c0: 7420 7468 6520 636f 6d6d 6f6e 2066 6163  t the common fac
-000074d0: 746f 7220 696e 2074 6865 206c 6173 7420  tor in the last 
-000074e0: 7477 6f20 7465 726d 7320 746f 206f 6274  two terms to obt
-000074f0: 6169 6e0d 0a20 2020 2023 2020 2078 203d  ain..    #   x =
-00007500: 206c 6f63 202b 206c 6f63 202a 2077 202a   loc + loc * w *
-00007510: 2028 3120 2d20 7371 7274 2832 202f 2077   (1 - sqrt(2 / w
-00007520: 202b 2031 2929 0d0a 2020 2020 2320 4e6f   + 1))..    # No
-00007530: 7720 7765 2073 6565 2074 6861 7420 7468  w we see that th
-00007540: 6520 5769 6b69 7065 6469 6120 666f 726d  e Wikipedia form
-00007550: 756c 6120 7375 6666 6572 7320 6672 6f6d  ula suffers from
-00007560: 2063 6174 6173 7472 7068 6963 0d0a 2020   catastrphic..  
-00007570: 2020 2320 6361 6e63 656c 6c61 7469 6f6e    # cancellation
-00007580: 2066 6f72 206c 6172 6765 2077 2028 652e   for large w (e.
-00007590: 672e 2c20 6966 2063 6f6e 6320 3c3c 206c  g., if conc << l
-000075a0: 6f63 292e 0d0a 2020 2020 230d 0a20 2020  oc)...    #..   
-000075b0: 2023 2046 6f72 7475 6e61 7465 6c79 2c20   # Fortunately, 
-000075c0: 7765 2063 616e 2066 6978 2074 6869 7320  we can fix this 
-000075d0: 6279 206d 756c 7469 706c 7969 6e67 2062  by multiplying b
-000075e0: 6f74 6820 7369 6465 730d 0a20 2020 2023  oth sides..    #
-000075f0: 2062 7920 3120 2b20 7371 7274 2832 202f   by 1 + sqrt(2 /
-00007600: 2077 202b 2031 292e 2020 5765 2067 6574   w + 1).  We get
-00007610: 0d0a 2020 2020 2320 2020 7820 2a20 2831  ..    #   x * (1
-00007620: 202b 2073 7172 7428 3220 2f20 7720 2b20   + sqrt(2 / w + 
-00007630: 3129 2920 3d0d 0a20 2020 2023 2020 2020  1)) =..    #    
-00007640: 203d 206c 6f63 202a 2028 3120 2b20 7371   = loc * (1 + sq
-00007650: 7274 2832 202f 2077 202b 2031 2929 202b  rt(2 / w + 1)) +
-00007660: 206c 6f63 202a 2077 202a 2028 3120 2d20   loc * w * (1 - 
-00007670: 2832 202f 2077 202b 2031 2929 0d0a 2020  (2 / w + 1))..  
-00007680: 2020 2320 2020 2020 3d20 6c6f 6320 2a20    #     = loc * 
-00007690: 2873 7172 7428 3220 2f20 7720 2b20 3129  (sqrt(2 / w + 1)
-000076a0: 202d 2031 290d 0a20 2020 2023 2054 6865   - 1)..    # The
-000076b0: 2074 6572 6d20 7371 7274 2832 202f 2077   term sqrt(2 / w
-000076c0: 202b 2031 2920 2b20 3120 6e6f 206c 6f6e   + 1) + 1 no lon
-000076d0: 6765 7220 7072 6573 656e 7473 206e 756d  ger presents num
-000076e0: 6572 6963 616c 0d0a 2020 2020 2320 6469  erical..    # di
-000076f0: 6666 6963 756c 7469 6573 2066 6f72 206c  fficulties for l
-00007700: 6172 6765 2077 2c20 616e 6420 7371 7274  arge w, and sqrt
-00007710: 2832 202f 2077 202b 2031 2920 2d20 3120  (2 / w + 1) - 1 
-00007720: 6973 206a 7573 740d 0a20 2020 2023 2073  is just..    # s
-00007730: 7172 7431 706d 3128 3220 2f20 7729 2c20  qrt1pm1(2 / w), 
-00007740: 7768 6963 6820 7765 206b 6e6f 7720 686f  which we know ho
-00007750: 7720 746f 2063 6f6d 7075 7465 2061 6363  w to compute acc
-00007760: 7572 6174 656c 792e 0d0a 2020 2020 2320  urately...    # 
-00007770: 5468 6973 206a 7573 7420 6c65 6176 6573  This just leaves
-00007780: 2074 6865 206d 6174 7465 7220 6f66 2073   the matter of s
-00007790: 6d61 6c6c 2077 2c20 7768 6572 6520 3220  mall w, where 2 
-000077a0: 2f20 7720 6d61 790d 0a20 2020 2023 206f  / w may..    # o
-000077b0: 7665 7266 6c6f 772e 2020 496e 2074 6865  verflow.  In the
-000077c0: 206c 696d 6974 2061 2077 202d 3e20 302c   limit a w -> 0,
-000077d0: 2078 202d 3e20 6c6f 632c 2073 6f20 7765   x -> loc, so we
-000077e0: 206a 7573 7420 6d61 736b 0d0a 2020 2020   just mask..    
-000077f0: 2320 7468 6174 2063 6173 652e 0d0a 2020  # that case...  
-00007800: 2020 7371 7274 3170 6d31 5f61 7267 203d    sqrt1pm1_arg =
-00007810: 2034 202a 2073 6361 6c65 202f 2028 6d65   4 * scale / (me
-00007820: 616e 202a 2073 616d 706c 6564 5f63 6869  an * sampled_chi
-00007830: 3229 2020 2320 3220 2f20 7720 6162 6f76  2)  # 2 / w abov
-00007840: 650d 0a20 2020 2073 6166 655f 7371 7274  e..    safe_sqrt
-00007850: 3170 6d31 5f61 7267 203d 206a 6e70 2e77  1pm1_arg = jnp.w
-00007860: 6865 7265 2873 7172 7431 706d 315f 6172  here(sqrt1pm1_ar
-00007870: 6720 3c20 6e70 2e69 6e66 2c20 7371 7274  g < np.inf, sqrt
-00007880: 3170 6d31 5f61 7267 2c20 312e 3029 0d0a  1pm1_arg, 1.0)..
-00007890: 2020 2020 6465 6e6f 6d69 6e61 746f 7220      denominator 
-000078a0: 3d20 312e 3020 2b20 6a6e 702e 7371 7274  = 1.0 + jnp.sqrt
-000078b0: 2873 6166 655f 7371 7274 3170 6d31 5f61  (safe_sqrt1pm1_a
-000078c0: 7267 202b 2031 2e30 290d 0a20 2020 2072  rg + 1.0)..    r
-000078d0: 6174 696f 203d 206a 6e70 2e65 7870 6d31  atio = jnp.expm1
-000078e0: 2830 2e35 202a 206a 6e70 2e6c 6f67 3170  (0.5 * jnp.log1p
-000078f0: 2873 6166 655f 7371 7274 3170 6d31 5f61  (safe_sqrt1pm1_a
-00007900: 7267 2929 202f 2064 656e 6f6d 696e 6174  rg)) / denominat
-00007910: 6f72 0d0a 2020 2020 7361 6d70 6c65 6420  or..    sampled 
-00007920: 3d20 6d65 616e 202a 206a 6e70 2e77 6865  = mean * jnp.whe
-00007930: 7265 2873 7172 7431 706d 315f 6172 6720  re(sqrt1pm1_arg 
-00007940: 3c20 6e70 2e69 6e66 2c20 7261 7469 6f2c  < np.inf, ratio,
-00007950: 2031 2e30 2920 2023 2078 2061 626f 7665   1.0)  # x above
-00007960: 0d0a 2020 2020 7265 7320 3d20 6a6e 702e  ..    res = jnp.
-00007970: 7768 6572 6528 7361 6d70 6c65 645f 756e  where(sampled_un
-00007980: 6966 6f72 6d20 3c3d 206d 6561 6e20 2f20  iform <= mean / 
-00007990: 286d 6561 6e20 2b20 7361 6d70 6c65 6429  (mean + sampled)
-000079a0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000079b0: 2020 2020 2020 2073 616d 706c 6564 2c0d         sampled,.
-000079c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000079d0: 2020 2020 206a 6e70 2e73 7175 6172 6528       jnp.square(
-000079e0: 6d65 616e 2920 2f20 7361 6d70 6c65 6429  mean) / sampled)
-000079f0: 0d0a 2020 2020 7265 7475 726e 2072 6573  ..    return res
-00007a00: 0d0a 0d0a 2020 6465 6620 7428 7365 6c66  ....  def t(self
-00007a10: 2c0d 0a20 2020 2020 2020 2064 662c 0d0a  ,..        df,..
-00007a20: 2020 2020 2020 2020 7369 7a65 3a20 4f70          size: Op
-00007a30: 7469 6f6e 616c 5b53 697a 655d 203d 204e  tional[Size] = N
-00007a40: 6f6e 652c 0d0a 2020 2020 2020 2020 6b65  one,..        ke
-00007a50: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
-00007a60: 4f72 4b65 795d 203d 204e 6f6e 652c 0d0a  OrKey] = None,..
-00007a70: 2020 2020 2020 2020 6474 7970 653a 2044          dtype: D
-00007a80: 5479 7065 4c69 6b65 203d 204e 6f6e 6529  TypeLike = None)
-00007a90: 3a0d 0a20 2020 2064 7479 7065 203d 2064  :..    dtype = d
-00007aa0: 7479 7065 206f 7220 656e 7669 726f 6e2e  type or environ.
-00007ab0: 6466 7479 7065 2829 0d0a 2020 2020 6466  dftype()..    df
-00007ac0: 203d 206a 6e70 2e61 7361 7272 6179 285f   = jnp.asarray(_
-00007ad0: 6368 6563 6b5f 7079 5f73 6571 2864 6629  check_py_seq(df)
-00007ae0: 2c20 6474 7970 653d 6474 7970 6529 0d0a  , dtype=dtype)..
-00007af0: 2020 2020 6966 2073 697a 6520 6973 204e      if size is N
-00007b00: 6f6e 653a 0d0a 2020 2020 2020 7369 7a65  one:..      size
-00007b10: 203d 206e 702e 7368 6170 6528 6466 290d   = np.shape(df).
-00007b20: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
-00007b30: 2020 7369 7a65 203d 205f 7369 7a65 3273    size = _size2s
-00007b40: 6861 7065 2873 697a 6529 0d0a 2020 2020  hape(size)..    
-00007b50: 2020 5f63 6865 636b 5f73 6861 7065 2822    _check_shape("
-00007b60: 7422 2c20 7369 7a65 2c20 6e70 2e73 6861  t", size, np.sha
-00007b70: 7065 2864 6629 290d 0a20 2020 2069 6620  pe(df))..    if 
-00007b80: 6b65 7920 6973 204e 6f6e 653a 0d0a 2020  key is None:..  
-00007b90: 2020 2020 6b65 7973 203d 2073 656c 662e      keys = self.
-00007ba0: 7370 6c69 745f 6b65 7973 2832 290d 0a20  split_keys(2).. 
-00007bb0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00007bc0: 6b65 7973 203d 206a 722e 7370 6c69 7428  keys = jr.split(
-00007bd0: 5f66 6f72 6d61 6c69 7a65 5f6b 6579 286b  _formalize_key(k
-00007be0: 6579 292c 2032 290d 0a20 2020 206e 203d  ey), 2)..    n =
-00007bf0: 206a 722e 6e6f 726d 616c 286b 6579 735b   jr.normal(keys[
-00007c00: 305d 2c20 7369 7a65 2c20 6474 7970 653d  0], size, dtype=
-00007c10: 6474 7970 6529 0d0a 2020 2020 7477 6f20  dtype)..    two 
-00007c20: 3d20 5f63 6f6e 7374 286e 2c20 3229 0d0a  = _const(n, 2)..
-00007c30: 2020 2020 6861 6c66 5f64 6620 3d20 6c61      half_df = la
-00007c40: 782e 6469 7628 6466 2c20 7477 6f29 0d0a  x.div(df, two)..
-00007c50: 2020 2020 6720 3d20 6a72 2e67 616d 6d61      g = jr.gamma
-00007c60: 286b 6579 735b 315d 2c20 6861 6c66 5f64  (keys[1], half_d
-00007c70: 662c 2073 697a 652c 2064 7479 7065 3d64  f, size, dtype=d
-00007c80: 7479 7065 290d 0a20 2020 2072 203d 206e  type)..    r = n
-00007c90: 202a 206a 6e70 2e73 7172 7428 6861 6c66   * jnp.sqrt(half
-00007ca0: 5f64 6620 2f20 6729 0d0a 2020 2020 7265  _df / g)..    re
-00007cb0: 7475 726e 2072 0d0a 0d0a 2020 6465 6620  turn r....  def 
-00007cc0: 6f72 7468 6f67 6f6e 616c 2873 656c 662c  orthogonal(self,
-00007cd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00007ce0: 2020 206e 3a20 696e 742c 0d0a 2020 2020     n: int,..    
-00007cf0: 2020 2020 2020 2020 2020 2020 2073 697a               siz
-00007d00: 653a 204f 7074 696f 6e61 6c5b 5369 7a65  e: Optional[Size
-00007d10: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2020  ] = None,..     
-00007d20: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
-00007d30: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
-00007d40: 4b65 795d 203d 204e 6f6e 652c 0d0a 2020  Key] = None,..  
-00007d50: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00007d60: 7479 7065 3a20 4454 7970 654c 696b 6520  type: DTypeLike 
-00007d70: 3d20 4e6f 6e65 293a 0d0a 2020 2020 6474  = None):..    dt
-00007d80: 7970 6520 3d20 6474 7970 6520 6f72 2065  ype = dtype or e
-00007d90: 6e76 6972 6f6e 2e64 6674 7970 6528 290d  nviron.dftype().
-00007da0: 0a20 2020 206b 6579 203d 2073 656c 662e  .    key = self.
-00007db0: 7370 6c69 745f 6b65 7928 2920 6966 206b  split_key() if k
-00007dc0: 6579 2069 7320 4e6f 6e65 2065 6c73 6520  ey is None else 
-00007dd0: 5f66 6f72 6d61 6c69 7a65 5f6b 6579 286b  _formalize_key(k
-00007de0: 6579 290d 0a20 2020 2073 697a 6520 3d20  ey)..    size = 
-00007df0: 5f73 697a 6532 7368 6170 6528 7369 7a65  _size2shape(size
-00007e00: 290d 0a20 2020 205f 6368 6563 6b5f 7368  )..    _check_sh
-00007e10: 6170 6528 226f 7274 686f 676f 6e61 6c22  ape("orthogonal"
-00007e20: 2c20 7369 7a65 290d 0a20 2020 206e 203d  , size)..    n =
-00007e30: 2063 6f72 652e 636f 6e63 7265 7465 5f6f   core.concrete_o
-00007e40: 725f 6572 726f 7228 696e 6465 782c 206e  r_error(index, n
-00007e50: 2c20 2254 6865 2065 7272 6f72 206f 6363  , "The error occ
-00007e60: 7572 7265 6420 696e 206a 6178 2e72 616e  urred in jax.ran
-00007e70: 646f 6d2e 6f72 7468 6f67 6f6e 616c 2829  dom.orthogonal()
-00007e80: 2229 0d0a 2020 2020 7a20 3d20 6a72 2e6e  ")..    z = jr.n
-00007e90: 6f72 6d61 6c28 6b65 792c 2073 697a 6520  ormal(key, size 
-00007ea0: 2b20 286e 2c20 6e29 2c20 6474 7970 653d  + (n, n), dtype=
-00007eb0: 6474 7970 6529 0d0a 2020 2020 712c 2072  dtype)..    q, r
-00007ec0: 203d 206a 6e70 2e6c 696e 616c 672e 7172   = jnp.linalg.qr
-00007ed0: 287a 290d 0a20 2020 2064 203d 206a 6e70  (z)..    d = jnp
-00007ee0: 2e64 6961 676f 6e61 6c28 722c 2030 2c20  .diagonal(r, 0, 
-00007ef0: 2d32 2c20 2d31 290d 0a20 2020 2072 203d  -2, -1)..    r =
-00007f00: 2071 202a 206a 6e70 2e65 7870 616e 645f   q * jnp.expand_
-00007f10: 6469 6d73 2864 202f 2061 6273 2864 292c  dims(d / abs(d),
-00007f20: 202d 3229 0d0a 2020 2020 7265 7475 726e   -2)..    return
-00007f30: 2072 0d0a 0d0a 2020 6465 6620 6e6f 6e63   r....  def nonc
-00007f40: 656e 7472 616c 5f63 6869 7371 7561 7265  entral_chisquare
-00007f50: 2873 656c 662c 0d0a 2020 2020 2020 2020  (self,..        
-00007f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007f70: 2020 2064 662c 0d0a 2020 2020 2020 2020     df,..        
-00007f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007f90: 2020 206e 6f6e 632c 0d0a 2020 2020 2020     nonc,..      
-00007fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007fb0: 2020 2020 2073 697a 653a 204f 7074 696f       size: Optio
-00007fc0: 6e61 6c5b 5369 7a65 5d20 3d20 4e6f 6e65  nal[Size] = None
-00007fd0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00007fe0: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
-00007ff0: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
-00008000: 4f72 4b65 795d 203d 204e 6f6e 652c 0d0a  OrKey] = None,..
-00008010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008020: 2020 2020 2020 2020 2020 2064 7479 7065             dtype
-00008030: 3a20 4454 7970 654c 696b 6520 3d20 4e6f  : DTypeLike = No
-00008040: 6e65 293a 0d0a 2020 2020 6474 7970 6520  ne):..    dtype 
-00008050: 3d20 6474 7970 6520 6f72 2065 6e76 6972  = dtype or envir
-00008060: 6f6e 2e64 6674 7970 6528 290d 0a20 2020  on.dftype()..   
-00008070: 2064 6620 3d20 6a6e 702e 6173 6172 7261   df = jnp.asarra
-00008080: 7928 5f63 6865 636b 5f70 795f 7365 7128  y(_check_py_seq(
-00008090: 6466 292c 2064 7479 7065 3d64 7479 7065  df), dtype=dtype
-000080a0: 290d 0a20 2020 206e 6f6e 6320 3d20 6a6e  )..    nonc = jn
-000080b0: 702e 6173 6172 7261 7928 5f63 6865 636b  p.asarray(_check
-000080c0: 5f70 795f 7365 7128 6e6f 6e63 292c 2064  _py_seq(nonc), d
-000080d0: 7479 7065 3d64 7479 7065 290d 0a20 2020  type=dtype)..   
-000080e0: 2069 6620 7369 7a65 2069 7320 4e6f 6e65   if size is None
-000080f0: 3a0d 0a20 2020 2020 2073 697a 6520 3d20  :..      size = 
-00008100: 6c61 782e 6272 6f61 6463 6173 745f 7368  lax.broadcast_sh
-00008110: 6170 6573 286a 6e70 2e73 6861 7065 2864  apes(jnp.shape(d
-00008120: 6629 2c20 6a6e 702e 7368 6170 6528 6e6f  f), jnp.shape(no
-00008130: 6e63 2929 0d0a 2020 2020 7369 7a65 203d  nc))..    size =
-00008140: 205f 7369 7a65 3273 6861 7065 2873 697a   _size2shape(siz
-00008150: 6529 0d0a 2020 2020 6966 206b 6579 2069  e)..    if key i
-00008160: 7320 4e6f 6e65 3a0d 0a20 2020 2020 206b  s None:..      k
-00008170: 6579 7320 3d20 7365 6c66 2e73 706c 6974  eys = self.split
-00008180: 5f6b 6579 7328 3329 0d0a 2020 2020 656c  _keys(3)..    el
-00008190: 7365 3a0d 0a20 2020 2020 206b 6579 7320  se:..      keys 
-000081a0: 3d20 6a72 2e73 706c 6974 285f 666f 726d  = jr.split(_form
-000081b0: 616c 697a 655f 6b65 7928 6b65 7929 2c20  alize_key(key), 
-000081c0: 3329 0d0a 2020 2020 6920 3d20 6a72 2e70  3)..    i = jr.p
-000081d0: 6f69 7373 6f6e 286b 6579 735b 305d 2c20  oisson(keys[0], 
-000081e0: 302e 3520 2a20 6e6f 6e63 2c20 7368 6170  0.5 * nonc, shap
-000081f0: 653d 7369 7a65 2c20 6474 7970 653d 656e  e=size, dtype=en
-00008200: 7669 726f 6e2e 6469 7479 7065 2829 290d  viron.ditype()).
-00008210: 0a20 2020 206e 203d 206a 722e 6e6f 726d  .    n = jr.norm
-00008220: 616c 286b 6579 735b 315d 2c20 7368 6170  al(keys[1], shap
-00008230: 653d 7369 7a65 2c20 6474 7970 653d 6474  e=size, dtype=dt
-00008240: 7970 6529 202b 206a 6e70 2e73 7172 7428  ype) + jnp.sqrt(
-00008250: 6e6f 6e63 290d 0a20 2020 2063 6f6e 6420  nonc)..    cond 
-00008260: 3d20 6a6e 702e 6772 6561 7465 7228 6466  = jnp.greater(df
-00008270: 2c20 312e 3029 0d0a 2020 2020 6466 3220  , 1.0)..    df2 
-00008280: 3d20 6a6e 702e 7768 6572 6528 636f 6e64  = jnp.where(cond
-00008290: 2c20 6466 202d 2031 2e30 2c20 6466 202b  , df - 1.0, df +
-000082a0: 2032 2e30 202a 2069 290d 0a20 2020 2063   2.0 * i)..    c
-000082b0: 6869 3220 3d20 322e 3020 2a20 6a72 2e67  hi2 = 2.0 * jr.g
-000082c0: 616d 6d61 286b 6579 735b 325d 2c20 302e  amma(keys[2], 0.
-000082d0: 3520 2a20 6466 322c 2073 6861 7065 3d73  5 * df2, shape=s
-000082e0: 697a 652c 2064 7479 7065 3d64 7479 7065  ize, dtype=dtype
-000082f0: 290d 0a20 2020 2072 203d 206a 6e70 2e77  )..    r = jnp.w
-00008300: 6865 7265 2863 6f6e 642c 2063 6869 3220  here(cond, chi2 
-00008310: 2b20 6e20 2a20 6e2c 2063 6869 3229 0d0a  + n * n, chi2)..
-00008320: 2020 2020 7265 7475 726e 2072 0d0a 0d0a      return r....
-00008330: 2020 6465 6620 6c6f 6767 616d 6d61 2873    def loggamma(s
-00008340: 656c 662c 0d0a 2020 2020 2020 2020 2020  elf,..          
-00008350: 2020 2020 2061 2c0d 0a20 2020 2020 2020       a,..       
-00008360: 2020 2020 2020 2020 7369 7a65 3a20 4f70          size: Op
-00008370: 7469 6f6e 616c 5b53 697a 655d 203d 204e  tional[Size] = N
-00008380: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
-00008390: 2020 2020 206b 6579 3a20 4f70 7469 6f6e       key: Option
-000083a0: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
-000083b0: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
-000083c0: 2020 2020 2020 6474 7970 653a 2044 5479        dtype: DTy
-000083d0: 7065 4c69 6b65 203d 204e 6f6e 6529 3a0d  peLike = None):.
-000083e0: 0a20 2020 2064 7479 7065 203d 2064 7479  .    dtype = dty
-000083f0: 7065 206f 7220 656e 7669 726f 6e2e 6466  pe or environ.df
-00008400: 7479 7065 2829 0d0a 2020 2020 6b65 7920  type()..    key 
-00008410: 3d20 7365 6c66 2e73 706c 6974 5f6b 6579  = self.split_key
-00008420: 2829 2069 6620 6b65 7920 6973 204e 6f6e  () if key is Non
-00008430: 6520 656c 7365 205f 666f 726d 616c 697a  e else _formaliz
-00008440: 655f 6b65 7928 6b65 7929 0d0a 2020 2020  e_key(key)..    
-00008450: 6120 3d20 5f63 6865 636b 5f70 795f 7365  a = _check_py_se
-00008460: 7128 6129 0d0a 2020 2020 6966 2073 697a  q(a)..    if siz
-00008470: 6520 6973 204e 6f6e 653a 0d0a 2020 2020  e is None:..    
-00008480: 2020 7369 7a65 203d 206a 6e70 2e73 6861    size = jnp.sha
-00008490: 7065 2861 290d 0a20 2020 2072 203d 206a  pe(a)..    r = j
-000084a0: 722e 6c6f 6767 616d 6d61 286b 6579 2c20  r.loggamma(key, 
-000084b0: 612c 2073 6861 7065 3d5f 7369 7a65 3273  a, shape=_size2s
-000084c0: 6861 7065 2873 697a 6529 2c20 6474 7970  hape(size), dtyp
-000084d0: 653d 6474 7970 6529 0d0a 2020 2020 7265  e=dtype)..    re
-000084e0: 7475 726e 2072 0d0a 0d0a 2020 6465 6620  turn r....  def 
-000084f0: 6361 7465 676f 7269 6361 6c28 7365 6c66  categorical(self
-00008500: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00008510: 2020 2020 206c 6f67 6974 732c 0d0a 2020       logits,..  
-00008520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008530: 6178 6973 3a20 696e 7420 3d20 2d31 2c0d  axis: int = -1,.
-00008540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008550: 2020 2073 697a 653a 204f 7074 696f 6e61     size: Optiona
-00008560: 6c5b 5369 7a65 5d20 3d20 4e6f 6e65 2c0d  l[Size] = None,.
-00008570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008580: 2020 206b 6579 3a20 4f70 7469 6f6e 616c     key: Optional
-00008590: 5b53 6565 644f 724b 6579 5d20 3d20 4e6f  [SeedOrKey] = No
-000085a0: 6e65 293a 0d0a 2020 2020 6b65 7920 3d20  ne):..    key = 
-000085b0: 7365 6c66 2e73 706c 6974 5f6b 6579 2829  self.split_key()
-000085c0: 2069 6620 6b65 7920 6973 204e 6f6e 6520   if key is None 
-000085d0: 656c 7365 205f 666f 726d 616c 697a 655f  else _formalize_
-000085e0: 6b65 7928 6b65 7929 0d0a 2020 2020 6c6f  key(key)..    lo
-000085f0: 6769 7473 203d 205f 6368 6563 6b5f 7079  gits = _check_py
-00008600: 5f73 6571 286c 6f67 6974 7329 0d0a 2020  _seq(logits)..  
-00008610: 2020 6966 2073 697a 6520 6973 204e 6f6e    if size is Non
-00008620: 653a 0d0a 2020 2020 2020 7369 7a65 203d  e:..      size =
-00008630: 206c 6973 7428 6a6e 702e 7368 6170 6528   list(jnp.shape(
-00008640: 6c6f 6769 7473 2929 0d0a 2020 2020 2020  logits))..      
-00008650: 7369 7a65 2e70 6f70 2861 7869 7329 0d0a  size.pop(axis)..
-00008660: 2020 2020 7220 3d20 6a72 2e63 6174 6567      r = jr.categ
-00008670: 6f72 6963 616c 286b 6579 2c20 6c6f 6769  orical(key, logi
-00008680: 7473 2c20 6178 6973 3d61 7869 732c 2073  ts, axis=axis, s
-00008690: 6861 7065 3d5f 7369 7a65 3273 6861 7065  hape=_size2shape
-000086a0: 2873 697a 6529 290d 0a20 2020 2072 6574  (size))..    ret
-000086b0: 7572 6e20 720d 0a0d 0a20 2064 6566 207a  urn r....  def z
-000086c0: 6970 6628 7365 6c66 2c0d 0a20 2020 2020  ipf(self,..     
-000086d0: 2020 2020 2020 612c 0d0a 2020 2020 2020        a,..      
-000086e0: 2020 2020 2073 697a 653a 204f 7074 696f       size: Optio
-000086f0: 6e61 6c5b 5369 7a65 5d20 3d20 4e6f 6e65  nal[Size] = None
-00008700: 2c0d 0a20 2020 2020 2020 2020 2020 6b65  ,..           ke
-00008710: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
-00008720: 4f72 4b65 795d 203d 204e 6f6e 652c 0d0a  OrKey] = None,..
-00008730: 2020 2020 2020 2020 2020 2064 7479 7065             dtype
-00008740: 3a20 4454 7970 654c 696b 6520 3d20 4e6f  : DTypeLike = No
-00008750: 6e65 293a 0d0a 2020 2020 6120 3d20 5f63  ne):..    a = _c
-00008760: 6865 636b 5f70 795f 7365 7128 6129 0d0a  heck_py_seq(a)..
-00008770: 2020 2020 6966 2073 697a 6520 6973 204e      if size is N
-00008780: 6f6e 653a 0d0a 2020 2020 2020 7369 7a65  one:..      size
-00008790: 203d 206a 6e70 2e73 6861 7065 2861 290d   = jnp.shape(a).
-000087a0: 0a20 2020 2064 7479 7065 203d 2064 7479  .    dtype = dty
-000087b0: 7065 206f 7220 656e 7669 726f 6e2e 6469  pe or environ.di
-000087c0: 7479 7065 2829 0d0a 2020 2020 7220 3d20  type()..    r = 
-000087d0: 6361 6c6c 286c 616d 6264 6120 783a 206e  call(lambda x: n
-000087e0: 702e 7261 6e64 6f6d 2e7a 6970 6628 782c  p.random.zipf(x,
-000087f0: 2073 697a 6529 2e61 7374 7970 6528 6474   size).astype(dt
-00008800: 7970 6529 2c0d 0a20 2020 2020 2020 2020  ype),..         
-00008810: 2020 2020 612c 0d0a 2020 2020 2020 2020      a,..        
-00008820: 2020 2020 2072 6573 756c 745f 7368 6170       result_shap
-00008830: 653d 6a61 782e 5368 6170 6544 7479 7065  e=jax.ShapeDtype
-00008840: 5374 7275 6374 2873 697a 652c 2064 7479  Struct(size, dty
-00008850: 7065 2929 0d0a 2020 2020 7265 7475 726e  pe))..    return
-00008860: 2072 0d0a 0d0a 2020 6465 6620 706f 7765   r....  def powe
-00008870: 7228 7365 6c66 2c0d 0a20 2020 2020 2020  r(self,..       
-00008880: 2020 2020 2061 2c0d 0a20 2020 2020 2020       a,..       
-00008890: 2020 2020 2073 697a 653a 204f 7074 696f       size: Optio
-000088a0: 6e61 6c5b 5369 7a65 5d20 3d20 4e6f 6e65  nal[Size] = None
-000088b0: 2c0d 0a20 2020 2020 2020 2020 2020 206b  ,..            k
-000088c0: 6579 3a20 4f70 7469 6f6e 616c 5b53 6565  ey: Optional[See
-000088d0: 644f 724b 6579 5d20 3d20 4e6f 6e65 2c0d  dOrKey] = None,.
-000088e0: 0a20 2020 2020 2020 2020 2020 2064 7479  .            dty
-000088f0: 7065 3a20 4454 7970 654c 696b 6520 3d20  pe: DTypeLike = 
-00008900: 4e6f 6e65 293a 0d0a 2020 2020 6120 3d20  None):..    a = 
-00008910: 5f63 6865 636b 5f70 795f 7365 7128 6129  _check_py_seq(a)
-00008920: 0d0a 2020 2020 6966 2073 697a 6520 6973  ..    if size is
-00008930: 204e 6f6e 653a 0d0a 2020 2020 2020 7369   None:..      si
-00008940: 7a65 203d 206a 6e70 2e73 6861 7065 2861  ze = jnp.shape(a
-00008950: 290d 0a20 2020 2073 697a 6520 3d20 5f73  )..    size = _s
-00008960: 697a 6532 7368 6170 6528 7369 7a65 290d  ize2shape(size).
-00008970: 0a20 2020 2064 7479 7065 203d 2064 7479  .    dtype = dty
-00008980: 7065 206f 7220 656e 7669 726f 6e2e 6466  pe or environ.df
-00008990: 7479 7065 2829 0d0a 2020 2020 7220 3d20  type()..    r = 
-000089a0: 6361 6c6c 286c 616d 6264 6120 613a 206e  call(lambda a: n
-000089b0: 702e 7261 6e64 6f6d 2e70 6f77 6572 2861  p.random.power(a
-000089c0: 3d61 2c20 7369 7a65 3d73 697a 6529 2e61  =a, size=size).a
-000089d0: 7374 7970 6528 6474 7970 6529 2c0d 0a20  stype(dtype),.. 
-000089e0: 2020 2020 2020 2020 2020 2020 612c 0d0a              a,..
-000089f0: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00008a00: 756c 745f 7368 6170 653d 6a61 782e 5368  ult_shape=jax.Sh
-00008a10: 6170 6544 7479 7065 5374 7275 6374 2873  apeDtypeStruct(s
-00008a20: 697a 652c 2064 7479 7065 2929 0d0a 2020  ize, dtype))..  
-00008a30: 2020 7265 7475 726e 2072 0d0a 0d0a 2020    return r....  
-00008a40: 6465 6620 6628 7365 6c66 2c0d 0a20 2020  def f(self,..   
-00008a50: 2020 2020 2064 666e 756d 2c0d 0a20 2020       dfnum,..   
-00008a60: 2020 2020 2064 6664 656e 2c0d 0a20 2020       dfden,..   
-00008a70: 2020 2020 2073 697a 653a 204f 7074 696f       size: Optio
-00008a80: 6e61 6c5b 5369 7a65 5d20 3d20 4e6f 6e65  nal[Size] = None
-00008a90: 2c0d 0a20 2020 2020 2020 206b 6579 3a20  ,..        key: 
-00008aa0: 4f70 7469 6f6e 616c 5b53 6565 644f 724b  Optional[SeedOrK
-00008ab0: 6579 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ey] = None,..   
-00008ac0: 2020 2020 2064 7479 7065 3a20 4454 7970       dtype: DTyp
-00008ad0: 654c 696b 6520 3d20 4e6f 6e65 293a 0d0a  eLike = None):..
-00008ae0: 2020 2020 6466 6e75 6d20 3d20 5f63 6865      dfnum = _che
-00008af0: 636b 5f70 795f 7365 7128 6466 6e75 6d29  ck_py_seq(dfnum)
-00008b00: 0d0a 2020 2020 6466 6465 6e20 3d20 5f63  ..    dfden = _c
-00008b10: 6865 636b 5f70 795f 7365 7128 6466 6465  heck_py_seq(dfde
-00008b20: 6e29 0d0a 2020 2020 6966 2073 697a 6520  n)..    if size 
-00008b30: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-00008b40: 7369 7a65 203d 206a 6e70 2e62 726f 6164  size = jnp.broad
-00008b50: 6361 7374 5f73 6861 7065 7328 6a6e 702e  cast_shapes(jnp.
-00008b60: 7368 6170 6528 6466 6e75 6d29 2c20 6a6e  shape(dfnum), jn
-00008b70: 702e 7368 6170 6528 6466 6465 6e29 290d  p.shape(dfden)).
-00008b80: 0a20 2020 2073 697a 6520 3d20 5f73 697a  .    size = _siz
-00008b90: 6532 7368 6170 6528 7369 7a65 290d 0a20  e2shape(size).. 
-00008ba0: 2020 2064 203d 207b 2764 666e 756d 273a     d = {'dfnum':
-00008bb0: 2064 666e 756d 2c20 2764 6664 656e 273a   dfnum, 'dfden':
-00008bc0: 2064 6664 656e 7d0d 0a20 2020 2064 7479   dfden}..    dty
-00008bd0: 7065 203d 2064 7479 7065 206f 7220 656e  pe = dtype or en
-00008be0: 7669 726f 6e2e 6466 7479 7065 2829 0d0a  viron.dftype()..
-00008bf0: 2020 2020 7220 3d20 6361 6c6c 286c 616d      r = call(lam
-00008c00: 6264 6120 783a 206e 702e 7261 6e64 6f6d  bda x: np.random
-00008c10: 2e66 2864 666e 756d 3d78 5b27 6466 6e75  .f(dfnum=x['dfnu
-00008c20: 6d27 5d2c 0d0a 2020 2020 2020 2020 2020  m'],..          
-00008c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008c40: 2020 2020 2020 2020 2064 6664 656e 3d78           dfden=x
-00008c50: 5b27 6466 6465 6e27 5d2c 0d0a 2020 2020  ['dfden'],..    
-00008c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008c70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00008c80: 697a 653d 7369 7a65 292e 6173 7479 7065  ize=size).astype
-00008c90: 2864 7479 7065 292c 0d0a 2020 2020 2020  (dtype),..      
-00008ca0: 2020 2020 2020 2064 2c0d 0a20 2020 2020         d,..     
-00008cb0: 2020 2020 2020 2020 7265 7375 6c74 5f73          result_s
-00008cc0: 6861 7065 3d6a 6178 2e53 6861 7065 4474  hape=jax.ShapeDt
-00008cd0: 7970 6553 7472 7563 7428 7369 7a65 2c20  ypeStruct(size, 
-00008ce0: 6474 7970 6529 290d 0a20 2020 2072 6574  dtype))..    ret
-00008cf0: 7572 6e20 720d 0a0d 0a20 2064 6566 2068  urn r....  def h
-00008d00: 7970 6572 6765 6f6d 6574 7269 6328 0d0a  ypergeometric(..
-00008d10: 2020 2020 2020 7365 6c66 2c0d 0a20 2020        self,..   
-00008d20: 2020 206e 676f 6f64 2c0d 0a20 2020 2020     ngood,..     
-00008d30: 206e 6261 642c 0d0a 2020 2020 2020 6e73   nbad,..      ns
-00008d40: 616d 706c 652c 0d0a 2020 2020 2020 7369  ample,..      si
-00008d50: 7a65 3a20 4f70 7469 6f6e 616c 5b53 697a  ze: Optional[Siz
-00008d60: 655d 203d 204e 6f6e 652c 0d0a 2020 2020  e] = None,..    
-00008d70: 2020 6b65 793a 204f 7074 696f 6e61 6c5b    key: Optional[
-00008d80: 5365 6564 4f72 4b65 795d 203d 204e 6f6e  SeedOrKey] = Non
-00008d90: 652c 0d0a 2020 2020 2020 6474 7970 653a  e,..      dtype:
-00008da0: 2044 5479 7065 4c69 6b65 203d 204e 6f6e   DTypeLike = Non
-00008db0: 650d 0a20 2029 3a0d 0a20 2020 206e 676f  e..  ):..    ngo
-00008dc0: 6f64 203d 205f 6368 6563 6b5f 7079 5f73  od = _check_py_s
-00008dd0: 6571 286e 676f 6f64 290d 0a20 2020 206e  eq(ngood)..    n
-00008de0: 6261 6420 3d20 5f63 6865 636b 5f70 795f  bad = _check_py_
-00008df0: 7365 7128 6e62 6164 290d 0a20 2020 206e  seq(nbad)..    n
-00008e00: 7361 6d70 6c65 203d 205f 6368 6563 6b5f  sample = _check_
-00008e10: 7079 5f73 6571 286e 7361 6d70 6c65 290d  py_seq(nsample).
-00008e20: 0a0d 0a20 2020 2069 6620 7369 7a65 2069  ...    if size i
-00008e30: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2073  s None:..      s
-00008e40: 697a 6520 3d20 6c61 782e 6272 6f61 6463  ize = lax.broadc
-00008e50: 6173 745f 7368 6170 6573 286a 6e70 2e73  ast_shapes(jnp.s
-00008e60: 6861 7065 286e 676f 6f64 292c 0d0a 2020  hape(ngood),..  
+00000000: 2320 436f 7079 7269 6768 7420 3230 3234  # Copyright 2024
+00000010: 2042 4450 2045 636f 7379 7374 656d 204c   BDP Ecosystem L
+00000020: 696d 6974 6564 2e20 416c 6c20 5269 6768  imited. All Righ
+00000030: 7473 2052 6573 6572 7665 642e 0d0a 230d  ts Reserved...#.
+00000040: 0a23 204c 6963 656e 7365 6420 756e 6465  .# Licensed unde
+00000050: 7220 7468 6520 4170 6163 6865 204c 6963  r the Apache Lic
+00000060: 656e 7365 2c20 5665 7273 696f 6e20 322e  ense, Version 2.
+00000070: 3020 2874 6865 2022 4c69 6365 6e73 6522  0 (the "License"
+00000080: 293b 0d0a 2320 796f 7520 6d61 7920 6e6f  );..# you may no
+00000090: 7420 7573 6520 7468 6973 2066 696c 6520  t use this file 
+000000a0: 6578 6365 7074 2069 6e20 636f 6d70 6c69  except in compli
+000000b0: 616e 6365 2077 6974 6820 7468 6520 4c69  ance with the Li
+000000c0: 6365 6e73 652e 0d0a 2320 596f 7520 6d61  cense...# You ma
+000000d0: 7920 6f62 7461 696e 2061 2063 6f70 7920  y obtain a copy 
+000000e0: 6f66 2074 6865 204c 6963 656e 7365 2061  of the License a
+000000f0: 740d 0a23 0d0a 2320 2020 2020 6874 7470  t..#..#     http
+00000100: 3a2f 2f77 7777 2e61 7061 6368 652e 6f72  ://www.apache.or
+00000110: 672f 6c69 6365 6e73 6573 2f4c 4943 454e  g/licenses/LICEN
+00000120: 5345 2d32 2e30 0d0a 230d 0a23 2055 6e6c  SE-2.0..#..# Unl
+00000130: 6573 7320 7265 7175 6972 6564 2062 7920  ess required by 
+00000140: 6170 706c 6963 6162 6c65 206c 6177 206f  applicable law o
+00000150: 7220 6167 7265 6564 2074 6f20 696e 2077  r agreed to in w
+00000160: 7269 7469 6e67 2c20 736f 6674 7761 7265  riting, software
+00000170: 0d0a 2320 6469 7374 7269 6275 7465 6420  ..# distributed 
+00000180: 756e 6465 7220 7468 6520 4c69 6365 6e73  under the Licens
+00000190: 6520 6973 2064 6973 7472 6962 7574 6564  e is distributed
+000001a0: 206f 6e20 616e 2022 4153 2049 5322 2042   on an "AS IS" B
+000001b0: 4153 4953 2c0d 0a23 2057 4954 484f 5554  ASIS,..# WITHOUT
+000001c0: 2057 4152 5241 4e54 4945 5320 4f52 2043   WARRANTIES OR C
+000001d0: 4f4e 4449 5449 4f4e 5320 4f46 2041 4e59  ONDITIONS OF ANY
+000001e0: 204b 494e 442c 2065 6974 6865 7220 6578   KIND, either ex
+000001f0: 7072 6573 7320 6f72 2069 6d70 6c69 6564  press or implied
+00000200: 2e0d 0a23 2053 6565 2074 6865 204c 6963  ...# See the Lic
+00000210: 656e 7365 2066 6f72 2074 6865 2073 7065  ense for the spe
+00000220: 6369 6669 6320 6c61 6e67 7561 6765 2067  cific language g
+00000230: 6f76 6572 6e69 6e67 2070 6572 6d69 7373  overning permiss
+00000240: 696f 6e73 2061 6e64 0d0a 2320 6c69 6d69  ions and..# limi
+00000250: 7461 7469 6f6e 7320 756e 6465 7220 7468  tations under th
+00000260: 6520 4c69 6365 6e73 652e 0d0a 2320 3d3d  e License...# ==
+00000270: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00000280: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00000290: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000002a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000002b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 0d0a  ============....
+000002c0: 0d0a 2320 2d2a 2d20 636f 6469 6e67 3a20  ..# -*- coding: 
+000002d0: 7574 662d 3820 2d2a 2d0d 0a0d 0a66 726f  utf-8 -*-....fro
+000002e0: 6d20 636f 6c6c 6563 7469 6f6e 7320 696d  m collections im
+000002f0: 706f 7274 206e 616d 6564 7475 706c 650d  port namedtuple.
+00000300: 0a66 726f 6d20 6675 6e63 746f 6f6c 7320  .from functools 
+00000310: 696d 706f 7274 2070 6172 7469 616c 0d0a  import partial..
+00000320: 6672 6f6d 206f 7065 7261 746f 7220 696d  from operator im
+00000330: 706f 7274 2069 6e64 6578 0d0a 6672 6f6d  port index..from
+00000340: 2074 7970 696e 6720 696d 706f 7274 204f   typing import O
+00000350: 7074 696f 6e61 6c2c 2055 6e69 6f6e 2c20  ptional, Union, 
+00000360: 5365 7175 656e 6365 0d0a 0d0a 696d 706f  Sequence....impo
+00000370: 7274 206a 6178 0d0a 696d 706f 7274 206e  rt jax..import n
+00000380: 756d 7079 2061 7320 6e70 0d0a 6672 6f6d  umpy as np..from
+00000390: 206a 6178 2069 6d70 6f72 7420 6c61 782c   jax import lax,
+000003a0: 206a 6974 2c20 766d 6170 2c20 6e75 6d70   jit, vmap, nump
+000003b0: 7920 6173 206a 6e70 2c20 7261 6e64 6f6d  y as jnp, random
+000003c0: 2061 7320 6a72 2c20 636f 7265 2c20 6474   as jr, core, dt
+000003d0: 7970 6573 0d0a 6672 6f6d 202e 7479 7069  ypes..from .typi
+000003e0: 6e67 2069 6d70 6f72 7420 4454 7970 654c  ng import DTypeL
+000003f0: 696b 652c 2053 697a 652c 2053 6565 644f  ike, Size, SeedO
+00000400: 724b 6579 0d0a 0d0a 6672 6f6d 2062 7261  rKey....from bra
+00000410: 696e 636f 7265 2069 6d70 6f72 7420 656e  incore import en
+00000420: 7669 726f 6e0d 0a66 726f 6d20 2e5f 7374  viron..from ._st
+00000430: 6174 6520 696d 706f 7274 2053 7461 7465  ate import State
+00000440: 0d0a 6672 6f6d 202e 7472 616e 7366 6f72  ..from .transfor
+00000450: 6d2e 5f6a 6974 5f65 7272 6f72 2069 6d70  m._jit_error imp
+00000460: 6f72 7420 6a69 745f 6572 726f 720d 0a0d  ort jit_error...
+00000470: 0a0d 0a5f 5f61 6c6c 5f5f 203d 205b 0d0a  ...__all__ = [..
+00000480: 2020 2752 616e 646f 6d53 7461 7465 272c    'RandomState',
+00000490: 2027 4445 4641 554c 5427 2c0d 0a0d 0a20   'DEFAULT',.... 
+000004a0: 2027 7365 6564 272c 2027 6465 6661 756c   'seed', 'defaul
+000004b0: 745f 726e 6727 2c20 2773 706c 6974 5f6b  t_rng', 'split_k
+000004c0: 6579 272c 2027 7370 6c69 745f 6b65 7973  ey', 'split_keys
+000004d0: 272c 0d0a 0d0a 2020 2320 6e75 6d70 7920  ',....  # numpy 
+000004e0: 636f 6d70 6174 6962 696c 6974 790d 0a20  compatibility.. 
+000004f0: 2027 7261 6e64 272c 2027 7261 6e64 696e   'rand', 'randin
+00000500: 7427 2c20 2772 616e 646f 6d5f 696e 7465  t', 'random_inte
+00000510: 6765 7273 272c 2027 7261 6e64 6e27 2c20  gers', 'randn', 
+00000520: 2772 616e 646f 6d27 2c0d 0a20 2027 7261  'random',..  'ra
+00000530: 6e64 6f6d 5f73 616d 706c 6527 2c20 2772  ndom_sample', 'r
+00000540: 616e 6627 2c20 2773 616d 706c 6527 2c20  anf', 'sample', 
+00000550: 2763 686f 6963 6527 2c20 2770 6572 6d75  'choice', 'permu
+00000560: 7461 7469 6f6e 272c 2027 7368 7566 666c  tation', 'shuffl
+00000570: 6527 2c20 2762 6574 6127 2c0d 0a20 2027  e', 'beta',..  '
+00000580: 6578 706f 6e65 6e74 6961 6c27 2c20 2767  exponential', 'g
+00000590: 616d 6d61 272c 2027 6775 6d62 656c 272c  amma', 'gumbel',
+000005a0: 2027 6c61 706c 6163 6527 2c20 276c 6f67   'laplace', 'log
+000005b0: 6973 7469 6327 2c20 276e 6f72 6d61 6c27  istic', 'normal'
+000005c0: 2c20 2770 6172 6574 6f27 2c0d 0a20 2027  , 'pareto',..  '
+000005d0: 706f 6973 736f 6e27 2c20 2773 7461 6e64  poisson', 'stand
+000005e0: 6172 645f 6361 7563 6879 272c 2027 7374  ard_cauchy', 'st
+000005f0: 616e 6461 7264 5f65 7870 6f6e 656e 7469  andard_exponenti
+00000600: 616c 272c 2027 7374 616e 6461 7264 5f67  al', 'standard_g
+00000610: 616d 6d61 272c 0d0a 2020 2773 7461 6e64  amma',..  'stand
+00000620: 6172 645f 6e6f 726d 616c 272c 2027 7374  ard_normal', 'st
+00000630: 616e 6461 7264 5f74 272c 2027 756e 6966  andard_t', 'unif
+00000640: 6f72 6d27 2c20 2774 7275 6e63 6174 6564  orm', 'truncated
+00000650: 5f6e 6f72 6d61 6c27 2c20 2762 6572 6e6f  _normal', 'berno
+00000660: 756c 6c69 272c 0d0a 2020 276c 6f67 6e6f  ulli',..  'logno
+00000670: 726d 616c 272c 2027 6269 6e6f 6d69 616c  rmal', 'binomial
+00000680: 272c 2027 6368 6973 7175 6172 6527 2c20  ', 'chisquare', 
+00000690: 2764 6972 6963 686c 6574 272c 2027 6765  'dirichlet', 'ge
+000006a0: 6f6d 6574 7269 6327 2c20 2766 272c 0d0a  ometric', 'f',..
+000006b0: 2020 2768 7970 6572 6765 6f6d 6574 7269    'hypergeometri
+000006c0: 6327 2c20 276c 6f67 7365 7269 6573 272c  c', 'logseries',
+000006d0: 2027 6d75 6c74 696e 6f6d 6961 6c27 2c20   'multinomial', 
+000006e0: 276d 756c 7469 7661 7269 6174 655f 6e6f  'multivariate_no
+000006f0: 726d 616c 272c 0d0a 2020 276e 6567 6174  rmal',..  'negat
+00000700: 6976 655f 6269 6e6f 6d69 616c 272c 2027  ive_binomial', '
+00000710: 6e6f 6e63 656e 7472 616c 5f63 6869 7371  noncentral_chisq
+00000720: 7561 7265 272c 2027 6e6f 6e63 656e 7472  uare', 'noncentr
+00000730: 616c 5f66 272c 2027 706f 7765 7227 2c0d  al_f', 'power',.
+00000740: 0a20 2027 7261 796c 6569 6768 272c 2027  .  'rayleigh', '
+00000750: 7472 6961 6e67 756c 6172 272c 2027 766f  triangular', 'vo
+00000760: 6e6d 6973 6573 272c 2027 7761 6c64 272c  nmises', 'wald',
+00000770: 2027 7765 6962 756c 6c27 2c20 2777 6569   'weibull', 'wei
+00000780: 6275 6c6c 5f6d 696e 272c 0d0a 2020 277a  bull_min',..  'z
+00000790: 6970 6627 2c20 276d 6178 7765 6c6c 272c  ipf', 'maxwell',
+000007a0: 2027 7427 2c20 276f 7274 686f 676f 6e61   't', 'orthogona
+000007b0: 6c27 2c20 276c 6f67 6761 6d6d 6127 2c20  l', 'loggamma', 
+000007c0: 2763 6174 6567 6f72 6963 616c 272c 0d0a  'categorical',..
+000007d0: 0d0a 2020 2320 7079 746f 7263 6820 636f  ..  # pytorch co
+000007e0: 6d70 6174 6962 696c 6974 790d 0a20 2027  mpatibility..  '
+000007f0: 7261 6e64 5f6c 696b 6527 2c20 2772 616e  rand_like', 'ran
+00000800: 6469 6e74 5f6c 696b 6527 2c20 2772 616e  dint_like', 'ran
+00000810: 646e 5f6c 696b 6527 2c0d 0a5d 0d0a 0d0a  dn_like',..]....
+00000820: 0d0a 636c 6173 7320 5261 6e64 6f6d 5374  ..class RandomSt
+00000830: 6174 6528 5374 6174 6529 3a0d 0a20 2022  ate(State):..  "
+00000840: 2222 5261 6e64 6f6d 5374 6174 6520 7468  ""RandomState th
+00000850: 6174 2074 7261 636b 2074 6865 2072 616e  at track the ran
+00000860: 646f 6d20 6765 6e65 7261 746f 7220 7374  dom generator st
+00000870: 6174 652e 2022 2222 0d0a 2020 5f5f 736c  ate. """..  __sl
+00000880: 6f74 735f 5f20 3d20 2829 0d0a 0d0a 2020  ots__ = ()....  
+00000890: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+000008a0: 662c 2073 6565 645f 6f72 5f6b 6579 3a20  f, seed_or_key: 
+000008b0: 4f70 7469 6f6e 616c 5b53 6565 644f 724b  Optional[SeedOrK
+000008c0: 6579 5d20 3d20 4e6f 6e65 293a 0d0a 2020  ey] = None):..  
+000008d0: 2020 2222 2252 616e 646f 6d53 7461 7465    """RandomState
+000008e0: 2063 6f6e 7374 7275 6374 6f72 2e0d 0a0d   constructor....
+000008f0: 0a20 2020 2050 6172 616d 6574 6572 730d  .    Parameters.
+00000900: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d  .    ----------.
+00000910: 0a20 2020 2073 6565 645f 6f72 5f6b 6579  .    seed_or_key
+00000920: 3a20 696e 742c 2041 7272 6179 2c20 6f70  : int, Array, op
+00000930: 7469 6f6e 616c 0d0a 2020 2020 2020 4974  tional..      It
+00000940: 2063 616e 2062 6520 616e 2069 6e74 6567   can be an integ
+00000950: 6572 2066 6f72 2069 6e69 7469 616c 2073  er for initial s
+00000960: 6565 6420 6f66 2074 6865 2072 616e 646f  eed of the rando
+00000970: 6d20 6e75 6d62 6572 2067 656e 6572 6174  m number generat
+00000980: 6f72 2c0d 0a20 2020 2020 206f 7220 6974  or,..      or it
+00000990: 2063 616e 2062 6520 6120 4a41 5827 7320   can be a JAX's 
+000009a0: 5052 4e4b 6579 2c20 7768 6963 6820 6973  PRNKey, which is
+000009b0: 2061 6e20 6172 7261 7920 7769 7468 2074   an array with t
+000009c0: 776f 2065 6c65 6d65 6e74 7320 616e 6420  wo elements and 
+000009d0: 6075 696e 7433 3260 2064 7479 7065 2e0d  `uint32` dtype..
+000009e0: 0a20 2020 2022 2222 0d0a 2020 2020 7769  .    """..    wi
+000009f0: 7468 206a 6178 2e65 6e73 7572 655f 636f  th jax.ensure_co
+00000a00: 6d70 696c 655f 7469 6d65 5f65 7661 6c28  mpile_time_eval(
+00000a10: 293a 0d0a 2020 2020 2020 6966 2073 6565  ):..      if see
+00000a20: 645f 6f72 5f6b 6579 2069 7320 4e6f 6e65  d_or_key is None
+00000a30: 3a0d 0a20 2020 2020 2020 2073 6565 645f  :..        seed_
+00000a40: 6f72 5f6b 6579 203d 206e 702e 7261 6e64  or_key = np.rand
+00000a50: 6f6d 2e72 616e 6469 6e74 2830 2c20 3130  om.randint(0, 10
+00000a60: 3030 3030 2c20 322c 2064 7479 7065 3d6e  0000, 2, dtype=n
+00000a70: 702e 7569 6e74 3332 290d 0a20 2020 2069  p.uint32)..    i
+00000a80: 6620 6973 696e 7374 616e 6365 2873 6565  f isinstance(see
+00000a90: 645f 6f72 5f6b 6579 2c20 696e 7429 3a0d  d_or_key, int):.
+00000aa0: 0a20 2020 2020 206b 6579 203d 206a 722e  .      key = jr.
+00000ab0: 5052 4e47 4b65 7928 7365 6564 5f6f 725f  PRNGKey(seed_or_
+00000ac0: 6b65 7929 0d0a 2020 2020 656c 7365 3a0d  key)..    else:.
+00000ad0: 0a20 2020 2020 2069 6620 6c65 6e28 7365  .      if len(se
+00000ae0: 6564 5f6f 725f 6b65 7929 2021 3d20 3220  ed_or_key) != 2 
+00000af0: 616e 6420 7365 6564 5f6f 725f 6b65 792e  and seed_or_key.
+00000b00: 6474 7970 6520 213d 206e 702e 7569 6e74  dtype != np.uint
+00000b10: 3332 3a0d 0a20 2020 2020 2020 2072 6169  32:..        rai
+00000b20: 7365 2056 616c 7565 4572 726f 7228 276b  se ValueError('k
+00000b30: 6579 206d 7573 7420 6265 2061 6e20 6172  ey must be an ar
+00000b40: 7261 7920 7769 7468 2064 7479 7065 2075  ray with dtype u
+00000b50: 696e 7433 322e 2027 0d0a 2020 2020 2020  int32. '..      
+00000b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000b70: 2020 2066 2742 7574 2077 6520 676f 7420     f'But we got 
+00000b80: 7b73 6565 645f 6f72 5f6b 6579 7d27 290d  {seed_or_key}').
+00000b90: 0a20 2020 2020 206b 6579 203d 2073 6565  .      key = see
+00000ba0: 645f 6f72 5f6b 6579 0d0a 2020 2020 7375  d_or_key..    su
+00000bb0: 7065 7228 292e 5f5f 696e 6974 5f5f 286b  per().__init__(k
+00000bc0: 6579 290d 0a0d 0a20 2064 6566 205f 5f72  ey)....  def __r
+00000bd0: 6570 725f 5f28 7365 6c66 2920 2d3e 2073  epr__(self) -> s
+00000be0: 7472 3a0d 0a20 2020 2070 7269 6e74 5f63  tr:..    print_c
+00000bf0: 6f64 6520 3d20 7265 7072 2873 656c 662e  ode = repr(self.
+00000c00: 7661 6c75 6529 0d0a 2020 2020 6920 3d20  value)..    i = 
+00000c10: 7072 696e 745f 636f 6465 2e69 6e64 6578  print_code.index
+00000c20: 2827 2827 290d 0a20 2020 2072 6574 7572  ('(')..    retur
+00000c30: 6e20 6627 7b73 656c 662e 5f5f 636c 6173  n f'{self.__clas
+00000c40: 735f 5f2e 5f5f 6e61 6d65 5f5f 7d28 6b65  s__.__name__}(ke
+00000c50: 793d 7b70 7269 6e74 5f63 6f64 655b 693a  y={print_code[i:
+00000c60: 5d7d 2927 0d0a 0d0a 2020 6465 6620 5f63  ]})'....  def _c
+00000c70: 6865 636b 5f69 665f 6465 6c65 7465 6428  heck_if_deleted(
+00000c80: 7365 6c66 293a 0d0a 2020 2020 6966 2069  self):..    if i
+00000c90: 7369 6e73 7461 6e63 6528 7365 6c66 2e5f  sinstance(self._
+00000ca0: 7661 6c75 652c 206a 6178 2e41 7272 6179  value, jax.Array
+00000cb0: 2920 616e 6420 6e6f 7420 6973 696e 7374  ) and not isinst
+00000cc0: 616e 6365 2873 656c 662e 5f76 616c 7565  ance(self._value
+00000cd0: 2c20 6a61 782e 636f 7265 2e54 7261 6365  , jax.core.Trace
+00000ce0: 7229 2061 6e64 2073 656c 662e 5f76 616c  r) and self._val
+00000cf0: 7565 2e69 735f 6465 6c65 7465 6428 293a  ue.is_deleted():
+00000d00: 0d0a 2020 2020 2020 7365 6c66 2e73 6565  ..      self.see
+00000d10: 6428 290d 0a0d 0a20 2023 202d 2d2d 2d2d  d()....  # -----
+00000d20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2023  -------------- #
+00000d30: 0d0a 2020 2320 7365 6564 2061 6e64 2072  ..  # seed and r
+00000d40: 616e 646f 6d20 6b65 7920 230d 0a20 2023  andom key #..  #
+00000d50: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00000d60: 2d2d 2d2d 2023 0d0a 0d0a 2020 6465 6620  ---- #....  def 
+00000d70: 636c 6f6e 6528 7365 6c66 293a 0d0a 2020  clone(self):..  
+00000d80: 2020 7265 7475 726e 2074 7970 6528 7365    return type(se
+00000d90: 6c66 2928 7365 6c66 2e73 706c 6974 5f6b  lf)(self.split_k
+00000da0: 6579 2829 290d 0a0d 0a20 2064 6566 2073  ey())....  def s
+00000db0: 6565 6428 7365 6c66 2c20 7365 6564 5f6f  eed(self, seed_o
+00000dc0: 725f 6b65 793a 204f 7074 696f 6e61 6c5b  r_key: Optional[
+00000dd0: 5365 6564 4f72 4b65 795d 203d 204e 6f6e  SeedOrKey] = Non
+00000de0: 6529 3a0d 0a20 2020 2022 2222 5365 7473  e):..    """Sets
+00000df0: 2061 206e 6577 2072 616e 646f 6d20 7365   a new random se
+00000e00: 6564 2e0d 0a0d 0a20 2020 2050 6172 616d  ed.....    Param
+00000e10: 6574 6572 730d 0a20 2020 202d 2d2d 2d2d  eters..    -----
+00000e20: 2d2d 2d2d 2d0d 0a20 2020 2073 6565 645f  -----..    seed_
+00000e30: 6f72 5f6b 6579 3a20 696e 742c 2041 7272  or_key: int, Arr
+00000e40: 6179 4c69 6b65 2c20 6f70 7469 6f6e 616c  ayLike, optional
+00000e50: 0d0a 2020 2020 2020 4974 2063 616e 2062  ..      It can b
+00000e60: 6520 616e 2069 6e74 6567 6572 2066 6f72  e an integer for
+00000e70: 2069 6e69 7469 616c 2073 6565 6420 6f66   initial seed of
+00000e80: 2074 6865 2072 616e 646f 6d20 6e75 6d62   the random numb
+00000e90: 6572 2067 656e 6572 6174 6f72 2c0d 0a20  er generator,.. 
+00000ea0: 2020 2020 206f 7220 6974 2063 616e 2062       or it can b
+00000eb0: 6520 6120 4a41 5827 7320 5052 4e4b 6579  e a JAX's PRNKey
+00000ec0: 2c20 7768 6963 6820 6973 2061 6e20 6172  , which is an ar
+00000ed0: 7261 7920 7769 7468 2074 776f 2065 6c65  ray with two ele
+00000ee0: 6d65 6e74 7320 616e 6420 6075 696e 7433  ments and `uint3
+00000ef0: 3260 2064 7479 7065 2e0d 0a20 2020 2022  2` dtype...    "
+00000f00: 2222 0d0a 2020 2020 6966 2073 6565 645f  ""..    if seed_
+00000f10: 6f72 5f6b 6579 2069 7320 4e6f 6e65 3a0d  or_key is None:.
+00000f20: 0a20 2020 2020 2073 6565 645f 6f72 5f6b  .      seed_or_k
+00000f30: 6579 203d 206e 702e 7261 6e64 6f6d 2e72  ey = np.random.r
+00000f40: 616e 6469 6e74 2830 2c20 3130 3030 3030  andint(0, 100000
+00000f50: 2c20 322c 2064 7479 7065 3d6e 702e 7569  , 2, dtype=np.ui
+00000f60: 6e74 3332 290d 0a20 2020 2069 6620 6973  nt32)..    if is
+00000f70: 696e 7374 616e 6365 2873 6565 645f 6f72  instance(seed_or
+00000f80: 5f6b 6579 2c20 696e 7429 3a0d 0a20 2020  _key, int):..   
+00000f90: 2020 206b 6579 203d 206a 722e 5052 4e47     key = jr.PRNG
+00000fa0: 4b65 7928 7365 6564 5f6f 725f 6b65 7929  Key(seed_or_key)
+00000fb0: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
+00000fc0: 2020 2069 6620 6c65 6e28 7365 6564 5f6f     if len(seed_o
+00000fd0: 725f 6b65 7929 2021 3d20 3220 616e 6420  r_key) != 2 and 
+00000fe0: 7365 6564 5f6f 725f 6b65 792e 6474 7970  seed_or_key.dtyp
+00000ff0: 6520 213d 206e 702e 7569 6e74 3332 3a0d  e != np.uint32:.
+00001000: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
+00001010: 616c 7565 4572 726f 7228 276b 6579 206d  alueError('key m
+00001020: 7573 7420 6265 2061 6e20 6172 7261 7920  ust be an array 
+00001030: 7769 7468 2064 7479 7065 2075 696e 7433  with dtype uint3
+00001040: 322e 2027 0d0a 2020 2020 2020 2020 2020  2. '..          
+00001050: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00001060: 2742 7574 2077 6520 676f 7420 7b73 6565  'But we got {see
+00001070: 645f 6f72 5f6b 6579 7d27 290d 0a20 2020  d_or_key}')..   
+00001080: 2020 206b 6579 203d 2073 6565 645f 6f72     key = seed_or
+00001090: 5f6b 6579 0d0a 2020 2020 7365 6c66 2e76  _key..    self.v
+000010a0: 616c 7565 203d 206b 6579 0d0a 0d0a 2020  alue = key....  
+000010b0: 6465 6620 7370 6c69 745f 6b65 7928 7365  def split_key(se
+000010c0: 6c66 293a 0d0a 2020 2020 2222 2243 7265  lf):..    """Cre
+000010d0: 6174 6520 6120 6e65 7720 7365 6564 2066  ate a new seed f
+000010e0: 726f 6d20 7468 6520 6375 7272 656e 7420  rom the current 
+000010f0: 7365 6564 2e0d 0a20 2020 2022 2222 0d0a  seed...    """..
+00001100: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+00001110: 7461 6e63 6528 7365 6c66 2e76 616c 7565  tance(self.value
+00001120: 2c20 6a61 782e 4172 7261 7929 3a0d 0a20  , jax.Array):.. 
+00001130: 2020 2020 2073 656c 662e 7661 6c75 6520       self.value 
+00001140: 3d20 6a6e 702e 6173 6172 7261 7928 7365  = jnp.asarray(se
+00001150: 6c66 2e76 616c 7565 2c20 6474 7970 653d  lf.value, dtype=
+00001160: 6a6e 702e 7569 6e74 3332 290d 0a20 2020  jnp.uint32)..   
+00001170: 206b 6579 7320 3d20 6a72 2e73 706c 6974   keys = jr.split
+00001180: 2873 656c 662e 7661 6c75 652c 206e 756d  (self.value, num
+00001190: 3d32 290d 0a20 2020 2073 656c 662e 7661  =2)..    self.va
+000011a0: 6c75 6520 3d20 6b65 7973 5b30 5d0d 0a20  lue = keys[0].. 
+000011b0: 2020 2072 6574 7572 6e20 6b65 7973 5b31     return keys[1
+000011c0: 5d0d 0a0d 0a20 2064 6566 2073 706c 6974  ]....  def split
+000011d0: 5f6b 6579 7328 7365 6c66 2c20 6e3a 2069  _keys(self, n: i
+000011e0: 6e74 293a 0d0a 2020 2020 2222 2243 7265  nt):..    """Cre
+000011f0: 6174 6520 6d75 6c74 6970 6c65 2073 6565  ate multiple see
+00001200: 6473 2066 726f 6d20 7468 6520 6375 7272  ds from the curr
+00001210: 656e 7420 7365 6564 2e20 5468 6973 2069  ent seed. This i
+00001220: 7320 7573 6564 0d0a 2020 2020 696e 7465  s used..    inte
+00001230: 726e 616c 6c79 2062 7920 6070 6d61 7060  rnally by `pmap`
+00001240: 2061 6e64 2060 766d 6170 6020 746f 2065   and `vmap` to e
+00001250: 6e73 7572 6520 7468 6174 2072 616e 646f  nsure that rando
+00001260: 6d20 6e75 6d62 6572 730d 0a20 2020 2061  m numbers..    a
+00001270: 7265 2064 6966 6665 7265 6e74 2069 6e20  re different in 
+00001280: 7061 7261 6c6c 656c 2074 6872 6561 6473  parallel threads
+00001290: 2e0d 0a0d 0a20 2020 2050 6172 616d 6574  .....    Paramet
+000012a0: 6572 730d 0a20 2020 202d 2d2d 2d2d 2d2d  ers..    -------
+000012b0: 2d2d 2d0d 0a20 2020 206e 203a 2069 6e74  ---..    n : int
+000012c0: 0d0a 2020 2020 2020 5468 6520 6e75 6d62  ..      The numb
+000012d0: 6572 206f 6620 7365 6564 7320 746f 2067  er of seeds to g
+000012e0: 656e 6572 6174 652e 0d0a 2020 2020 2222  enerate...    ""
+000012f0: 220d 0a20 2020 206b 6579 7320 3d20 6a72  "..    keys = jr
+00001300: 2e73 706c 6974 2873 656c 662e 7661 6c75  .split(self.valu
+00001310: 652c 206e 202b 2031 290d 0a20 2020 2073  e, n + 1)..    s
+00001320: 656c 662e 7661 6c75 6520 3d20 6b65 7973  elf.value = keys
+00001330: 5b30 5d0d 0a20 2020 2072 6574 7572 6e20  [0]..    return 
+00001340: 6b65 7973 5b31 3a5d 0d0a 0d0a 2020 2320  keys[1:]....  # 
+00001350: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001360: 2023 0d0a 2020 2320 7261 6e64 6f6d 2066   #..  # random f
+00001370: 756e 6374 696f 6e73 2023 0d0a 2020 2320  unctions #..  # 
+00001380: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001390: 2023 0d0a 0d0a 2020 6465 6620 7261 6e64   #....  def rand
+000013a0: 2873 656c 662c 202a 646e 2c20 6b65 793a  (self, *dn, key:
+000013b0: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
+000013c0: 4b65 795d 203d 204e 6f6e 652c 2064 7479  Key] = None, dty
+000013d0: 7065 3a20 4454 7970 654c 696b 6520 3d20  pe: DTypeLike = 
+000013e0: 4e6f 6e65 293a 0d0a 2020 2020 6b65 7920  None):..    key 
+000013f0: 3d20 7365 6c66 2e73 706c 6974 5f6b 6579  = self.split_key
+00001400: 2829 2069 6620 6b65 7920 6973 204e 6f6e  () if key is Non
+00001410: 6520 656c 7365 205f 666f 726d 616c 697a  e else _formaliz
+00001420: 655f 6b65 7928 6b65 7929 0d0a 2020 2020  e_key(key)..    
+00001430: 6474 7970 6520 3d20 6474 7970 6520 6f72  dtype = dtype or
+00001440: 2065 6e76 6972 6f6e 2e64 6674 7970 6528   environ.dftype(
+00001450: 290d 0a20 2020 2072 203d 206a 722e 756e  )..    r = jr.un
+00001460: 6966 6f72 6d28 6b65 792c 2073 6861 7065  iform(key, shape
+00001470: 3d64 6e2c 206d 696e 7661 6c3d 302e 2c20  =dn, minval=0., 
+00001480: 6d61 7876 616c 3d31 2e2c 2064 7479 7065  maxval=1., dtype
+00001490: 3d64 7479 7065 290d 0a20 2020 2072 6574  =dtype)..    ret
+000014a0: 7572 6e20 720d 0a0d 0a20 2064 6566 2072  urn r....  def r
+000014b0: 616e 6469 6e74 280d 0a20 2020 2020 2073  andint(..      s
+000014c0: 656c 662c 0d0a 2020 2020 2020 6c6f 772c  elf,..      low,
+000014d0: 0d0a 2020 2020 2020 6869 6768 3d4e 6f6e  ..      high=Non
+000014e0: 652c 0d0a 2020 2020 2020 7369 7a65 3a20  e,..      size: 
+000014f0: 4f70 7469 6f6e 616c 5b53 697a 655d 203d  Optional[Size] =
+00001500: 204e 6f6e 652c 0d0a 2020 2020 2020 6474   None,..      dt
+00001510: 7970 653a 2044 5479 7065 4c69 6b65 203d  ype: DTypeLike =
+00001520: 204e 6f6e 652c 0d0a 2020 2020 2020 6b65   None,..      ke
+00001530: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
+00001540: 4f72 4b65 795d 203d 204e 6f6e 650d 0a20  OrKey] = None.. 
+00001550: 2029 3a0d 0a20 2020 2069 6620 6869 6768   ):..    if high
+00001560: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
+00001570: 2068 6967 6820 3d20 6c6f 770d 0a20 2020   high = low..   
+00001580: 2020 206c 6f77 203d 2030 0d0a 2020 2020     low = 0..    
+00001590: 6869 6768 203d 205f 6368 6563 6b5f 7079  high = _check_py
+000015a0: 5f73 6571 2868 6967 6829 0d0a 2020 2020  _seq(high)..    
+000015b0: 6c6f 7720 3d20 5f63 6865 636b 5f70 795f  low = _check_py_
+000015c0: 7365 7128 6c6f 7729 0d0a 2020 2020 6966  seq(low)..    if
+000015d0: 2073 697a 6520 6973 204e 6f6e 653a 0d0a   size is None:..
+000015e0: 2020 2020 2020 7369 7a65 203d 206c 6178        size = lax
+000015f0: 2e62 726f 6164 6361 7374 5f73 6861 7065  .broadcast_shape
+00001600: 7328 6a6e 702e 7368 6170 6528 6c6f 7729  s(jnp.shape(low)
+00001610: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00001620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001630: 2020 2020 206a 6e70 2e73 6861 7065 2868       jnp.shape(h
+00001640: 6967 6829 290d 0a20 2020 206b 6579 203d  igh))..    key =
+00001650: 2073 656c 662e 7370 6c69 745f 6b65 7928   self.split_key(
+00001660: 2920 6966 206b 6579 2069 7320 4e6f 6e65  ) if key is None
+00001670: 2065 6c73 6520 5f66 6f72 6d61 6c69 7a65   else _formalize
+00001680: 5f6b 6579 286b 6579 290d 0a20 2020 2064  _key(key)..    d
+00001690: 7479 7065 203d 2064 7479 7065 206f 7220  type = dtype or 
+000016a0: 656e 7669 726f 6e2e 6469 7479 7065 2829  environ.ditype()
+000016b0: 0d0a 2020 2020 7220 3d20 6a72 2e72 616e  ..    r = jr.ran
+000016c0: 6469 6e74 286b 6579 2c0d 0a20 2020 2020  dint(key,..     
+000016d0: 2020 2020 2020 2020 2020 2020 2020 7368                sh
+000016e0: 6170 653d 5f73 697a 6532 7368 6170 6528  ape=_size2shape(
+000016f0: 7369 7a65 292c 0d0a 2020 2020 2020 2020  size),..        
+00001700: 2020 2020 2020 2020 2020 206d 696e 7661             minva
+00001710: 6c3d 6c6f 772c 206d 6178 7661 6c3d 6869  l=low, maxval=hi
+00001720: 6768 2c20 6474 7970 653d 6474 7970 6529  gh, dtype=dtype)
+00001730: 0d0a 2020 2020 7265 7475 726e 2072 0d0a  ..    return r..
+00001740: 0d0a 2020 6465 6620 7261 6e64 6f6d 5f69  ..  def random_i
+00001750: 6e74 6567 6572 7328 0d0a 2020 2020 2020  ntegers(..      
+00001760: 7365 6c66 2c0d 0a20 2020 2020 206c 6f77  self,..      low
+00001770: 2c0d 0a20 2020 2020 2068 6967 683d 4e6f  ,..      high=No
+00001780: 6e65 2c0d 0a20 2020 2020 2073 697a 653a  ne,..      size:
+00001790: 204f 7074 696f 6e61 6c5b 5369 7a65 5d20   Optional[Size] 
+000017a0: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 206b  = None,..      k
+000017b0: 6579 3a20 4f70 7469 6f6e 616c 5b53 6565  ey: Optional[See
+000017c0: 644f 724b 6579 5d20 3d20 4e6f 6e65 2c0d  dOrKey] = None,.
+000017d0: 0a20 2020 2020 2064 7479 7065 3a20 4454  .      dtype: DT
+000017e0: 7970 654c 696b 6520 3d20 4e6f 6e65 2c0d  ypeLike = None,.
+000017f0: 0a20 2029 3a0d 0a20 2020 206c 6f77 203d  .  ):..    low =
+00001800: 205f 6368 6563 6b5f 7079 5f73 6571 286c   _check_py_seq(l
+00001810: 6f77 290d 0a20 2020 2068 6967 6820 3d20  ow)..    high = 
+00001820: 5f63 6865 636b 5f70 795f 7365 7128 6869  _check_py_seq(hi
+00001830: 6768 290d 0a20 2020 2069 6620 6869 6768  gh)..    if high
+00001840: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
+00001850: 2068 6967 6820 3d20 6c6f 770d 0a20 2020   high = low..   
+00001860: 2020 206c 6f77 203d 2031 0d0a 2020 2020     low = 1..    
+00001870: 6869 6768 202b 3d20 310d 0a20 2020 2069  high += 1..    i
+00001880: 6620 7369 7a65 2069 7320 4e6f 6e65 3a0d  f size is None:.
+00001890: 0a20 2020 2020 2073 697a 6520 3d20 6c61  .      size = la
+000018a0: 782e 6272 6f61 6463 6173 745f 7368 6170  x.broadcast_shap
+000018b0: 6573 286a 6e70 2e73 6861 7065 286c 6f77  es(jnp.shape(low
+000018c0: 292c 206a 6e70 2e73 6861 7065 2868 6967  ), jnp.shape(hig
+000018d0: 6829 290d 0a20 2020 206b 6579 203d 2073  h))..    key = s
+000018e0: 656c 662e 7370 6c69 745f 6b65 7928 2920  elf.split_key() 
+000018f0: 6966 206b 6579 2069 7320 4e6f 6e65 2065  if key is None e
+00001900: 6c73 6520 5f66 6f72 6d61 6c69 7a65 5f6b  lse _formalize_k
+00001910: 6579 286b 6579 290d 0a20 2020 2064 7479  ey(key)..    dty
+00001920: 7065 203d 2064 7479 7065 206f 7220 656e  pe = dtype or en
+00001930: 7669 726f 6e2e 6469 7479 7065 2829 0d0a  viron.ditype()..
+00001940: 2020 2020 7220 3d20 6a72 2e72 616e 6469      r = jr.randi
+00001950: 6e74 286b 6579 2c0d 0a20 2020 2020 2020  nt(key,..       
+00001960: 2020 2020 2020 2020 2020 2020 7368 6170              shap
+00001970: 653d 5f73 697a 6532 7368 6170 6528 7369  e=_size2shape(si
+00001980: 7a65 292c 0d0a 2020 2020 2020 2020 2020  ze),..          
+00001990: 2020 2020 2020 2020 206d 696e 7661 6c3d           minval=
+000019a0: 6c6f 772c 0d0a 2020 2020 2020 2020 2020  low,..          
+000019b0: 2020 2020 2020 2020 206d 6178 7661 6c3d           maxval=
+000019c0: 6869 6768 2c0d 0a20 2020 2020 2020 2020  high,..         
+000019d0: 2020 2020 2020 2020 2020 6474 7970 653d            dtype=
+000019e0: 6474 7970 6529 0d0a 2020 2020 7265 7475  dtype)..    retu
+000019f0: 726e 2072 0d0a 0d0a 2020 6465 6620 7261  rn r....  def ra
+00001a00: 6e64 6e28 7365 6c66 2c20 2a64 6e2c 206b  ndn(self, *dn, k
+00001a10: 6579 3a20 4f70 7469 6f6e 616c 5b53 6565  ey: Optional[See
+00001a20: 644f 724b 6579 5d20 3d20 4e6f 6e65 2c20  dOrKey] = None, 
+00001a30: 6474 7970 653a 2044 5479 7065 4c69 6b65  dtype: DTypeLike
+00001a40: 203d 204e 6f6e 6529 3a0d 0a20 2020 206b   = None):..    k
+00001a50: 6579 203d 2073 656c 662e 7370 6c69 745f  ey = self.split_
+00001a60: 6b65 7928 2920 6966 206b 6579 2069 7320  key() if key is 
+00001a70: 4e6f 6e65 2065 6c73 6520 5f66 6f72 6d61  None else _forma
+00001a80: 6c69 7a65 5f6b 6579 286b 6579 290d 0a20  lize_key(key).. 
+00001a90: 2020 2064 7479 7065 203d 2064 7479 7065     dtype = dtype
+00001aa0: 206f 7220 656e 7669 726f 6e2e 6466 7479   or environ.dfty
+00001ab0: 7065 2829 0d0a 2020 2020 7220 3d20 6a72  pe()..    r = jr
+00001ac0: 2e6e 6f72 6d61 6c28 6b65 792c 2073 6861  .normal(key, sha
+00001ad0: 7065 3d64 6e2c 2064 7479 7065 3d64 7479  pe=dn, dtype=dty
+00001ae0: 7065 290d 0a20 2020 2072 6574 7572 6e20  pe)..    return 
+00001af0: 720d 0a0d 0a20 2064 6566 2072 616e 646f  r....  def rando
+00001b00: 6d28 7365 6c66 2c0d 0a20 2020 2020 2020  m(self,..       
+00001b10: 2020 2020 2020 7369 7a65 3a20 4f70 7469        size: Opti
+00001b20: 6f6e 616c 5b53 697a 655d 203d 204e 6f6e  onal[Size] = Non
+00001b30: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+00001b40: 206b 6579 3a20 4f70 7469 6f6e 616c 5b53   key: Optional[S
+00001b50: 6565 644f 724b 6579 5d20 3d20 4e6f 6e65  eedOrKey] = None
+00001b60: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00001b70: 6474 7970 653a 2044 5479 7065 4c69 6b65  dtype: DTypeLike
+00001b80: 203d 204e 6f6e 6529 3a0d 0a20 2020 2064   = None):..    d
+00001b90: 7479 7065 203d 2064 7479 7065 206f 7220  type = dtype or 
+00001ba0: 656e 7669 726f 6e2e 6466 7479 7065 2829  environ.dftype()
+00001bb0: 0d0a 2020 2020 6b65 7920 3d20 7365 6c66  ..    key = self
+00001bc0: 2e73 706c 6974 5f6b 6579 2829 2069 6620  .split_key() if 
+00001bd0: 6b65 7920 6973 204e 6f6e 6520 656c 7365  key is None else
+00001be0: 205f 666f 726d 616c 697a 655f 6b65 7928   _formalize_key(
+00001bf0: 6b65 7929 0d0a 2020 2020 7220 3d20 6a72  key)..    r = jr
+00001c00: 2e75 6e69 666f 726d 286b 6579 2c20 7368  .uniform(key, sh
+00001c10: 6170 653d 5f73 697a 6532 7368 6170 6528  ape=_size2shape(
+00001c20: 7369 7a65 292c 206d 696e 7661 6c3d 302e  size), minval=0.
+00001c30: 2c20 6d61 7876 616c 3d31 2e2c 2064 7479  , maxval=1., dty
+00001c40: 7065 3d64 7479 7065 290d 0a20 2020 2072  pe=dtype)..    r
+00001c50: 6574 7572 6e20 720d 0a0d 0a20 2064 6566  eturn r....  def
+00001c60: 2072 616e 646f 6d5f 7361 6d70 6c65 2873   random_sample(s
+00001c70: 656c 662c 0d0a 2020 2020 2020 2020 2020  elf,..          
+00001c80: 2020 2020 2020 2020 2020 7369 7a65 3a20            size: 
+00001c90: 4f70 7469 6f6e 616c 5b53 697a 655d 203d  Optional[Size] =
+00001ca0: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
+00001cb0: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
+00001cc0: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
+00001cd0: 4b65 795d 203d 204e 6f6e 652c 0d0a 2020  Key] = None,..  
+00001ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001cf0: 2020 6474 7970 653a 2044 5479 7065 4c69    dtype: DTypeLi
+00001d00: 6b65 203d 204e 6f6e 6529 3a0d 0a20 2020  ke = None):..   
+00001d10: 2072 203d 2073 656c 662e 7261 6e64 6f6d   r = self.random
+00001d20: 2873 697a 653d 7369 7a65 2c20 6b65 793d  (size=size, key=
+00001d30: 6b65 792c 2064 7479 7065 3d64 7479 7065  key, dtype=dtype
+00001d40: 290d 0a20 2020 2072 6574 7572 6e20 720d  )..    return r.
+00001d50: 0a0d 0a20 2064 6566 2072 616e 6628 7365  ...  def ranf(se
+00001d60: 6c66 2c0d 0a20 2020 2020 2020 2020 2020  lf,..           
+00001d70: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b53  size: Optional[S
+00001d80: 697a 655d 203d 204e 6f6e 652c 0d0a 2020  ize] = None,..  
+00001d90: 2020 2020 2020 2020 206b 6579 3a20 4f70           key: Op
+00001da0: 7469 6f6e 616c 5b53 6565 644f 724b 6579  tional[SeedOrKey
+00001db0: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2020  ] = None,..     
+00001dc0: 2020 2020 2020 6474 7970 653a 2044 5479        dtype: DTy
+00001dd0: 7065 4c69 6b65 203d 204e 6f6e 6529 3a0d  peLike = None):.
+00001de0: 0a20 2020 2072 203d 2073 656c 662e 7261  .    r = self.ra
+00001df0: 6e64 6f6d 2873 697a 653d 7369 7a65 2c20  ndom(size=size, 
+00001e00: 6b65 793d 6b65 792c 2064 7479 7065 3d64  key=key, dtype=d
+00001e10: 7479 7065 290d 0a20 2020 2072 6574 7572  type)..    retur
+00001e20: 6e20 720d 0a0d 0a20 2064 6566 2073 616d  n r....  def sam
+00001e30: 706c 6528 7365 6c66 2c0d 0a20 2020 2020  ple(self,..     
+00001e40: 2020 2020 2020 2020 7369 7a65 3a20 4f70          size: Op
+00001e50: 7469 6f6e 616c 5b53 697a 655d 203d 204e  tional[Size] = N
+00001e60: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+00001e70: 2020 206b 6579 3a20 4f70 7469 6f6e 616c     key: Optional
+00001e80: 5b53 6565 644f 724b 6579 5d20 3d20 4e6f  [SeedOrKey] = No
+00001e90: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
+00001ea0: 2020 6474 7970 653a 2044 5479 7065 4c69    dtype: DTypeLi
+00001eb0: 6b65 203d 204e 6f6e 6529 3a0d 0a20 2020  ke = None):..   
+00001ec0: 2072 203d 2073 656c 662e 7261 6e64 6f6d   r = self.random
+00001ed0: 2873 697a 653d 7369 7a65 2c20 6b65 793d  (size=size, key=
+00001ee0: 6b65 792c 2064 7479 7065 3d64 7479 7065  key, dtype=dtype
+00001ef0: 290d 0a20 2020 2072 6574 7572 6e20 720d  )..    return r.
+00001f00: 0a0d 0a20 2064 6566 2063 686f 6963 6528  ...  def choice(
+00001f10: 7365 6c66 2c0d 0a20 2020 2020 2020 2020  self,..         
+00001f20: 2020 2020 612c 0d0a 2020 2020 2020 2020      a,..        
+00001f30: 2020 2020 2073 697a 653a 204f 7074 696f       size: Optio
+00001f40: 6e61 6c5b 5369 7a65 5d20 3d20 4e6f 6e65  nal[Size] = None
+00001f50: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00001f60: 7265 706c 6163 653d 5472 7565 2c0d 0a20  replace=True,.. 
+00001f70: 2020 2020 2020 2020 2020 2020 703d 4e6f              p=No
+00001f80: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
+00001f90: 2020 6b65 793a 204f 7074 696f 6e61 6c5b    key: Optional[
+00001fa0: 5365 6564 4f72 4b65 795d 203d 204e 6f6e  SeedOrKey] = Non
+00001fb0: 6529 3a0d 0a20 2020 2061 203d 205f 6368  e):..    a = _ch
+00001fc0: 6563 6b5f 7079 5f73 6571 2861 290d 0a20  eck_py_seq(a).. 
+00001fd0: 2020 2070 203d 205f 6368 6563 6b5f 7079     p = _check_py
+00001fe0: 5f73 6571 2870 290d 0a20 2020 206b 6579  _seq(p)..    key
+00001ff0: 203d 2073 656c 662e 7370 6c69 745f 6b65   = self.split_ke
+00002000: 7928 2920 6966 206b 6579 2069 7320 4e6f  y() if key is No
+00002010: 6e65 2065 6c73 6520 5f66 6f72 6d61 6c69  ne else _formali
+00002020: 7a65 5f6b 6579 286b 6579 290d 0a20 2020  ze_key(key)..   
+00002030: 2072 203d 206a 722e 6368 6f69 6365 286b   r = jr.choice(k
+00002040: 6579 2c20 613d 612c 2073 6861 7065 3d5f  ey, a=a, shape=_
+00002050: 7369 7a65 3273 6861 7065 2873 697a 6529  size2shape(size)
+00002060: 2c20 7265 706c 6163 653d 7265 706c 6163  , replace=replac
+00002070: 652c 2070 3d70 290d 0a20 2020 2072 6574  e, p=p)..    ret
+00002080: 7572 6e20 720d 0a0d 0a20 2064 6566 2070  urn r....  def p
+00002090: 6572 6d75 7461 7469 6f6e 2873 656c 662c  ermutation(self,
+000020a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000020b0: 2020 2020 782c 0d0a 2020 2020 2020 2020      x,..        
+000020c0: 2020 2020 2020 2020 2020 6178 6973 3a20            axis: 
+000020d0: 696e 7420 3d20 302c 0d0a 2020 2020 2020  int = 0,..      
+000020e0: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+000020f0: 7065 6e64 656e 743a 2062 6f6f 6c20 3d20  pendent: bool = 
+00002100: 4661 6c73 652c 0d0a 2020 2020 2020 2020  False,..        
+00002110: 2020 2020 2020 2020 2020 6b65 793a 204f            key: O
+00002120: 7074 696f 6e61 6c5b 5365 6564 4f72 4b65  ptional[SeedOrKe
+00002130: 795d 203d 204e 6f6e 6529 3a0d 0a20 2020  y] = None):..   
+00002140: 2078 203d 205f 6368 6563 6b5f 7079 5f73   x = _check_py_s
+00002150: 6571 2878 290d 0a20 2020 206b 6579 203d  eq(x)..    key =
+00002160: 2073 656c 662e 7370 6c69 745f 6b65 7928   self.split_key(
+00002170: 2920 6966 206b 6579 2069 7320 4e6f 6e65  ) if key is None
+00002180: 2065 6c73 6520 5f66 6f72 6d61 6c69 7a65   else _formalize
+00002190: 5f6b 6579 286b 6579 290d 0a20 2020 2072  _key(key)..    r
+000021a0: 203d 206a 722e 7065 726d 7574 6174 696f   = jr.permutatio
+000021b0: 6e28 6b65 792c 2078 2c20 6178 6973 3d61  n(key, x, axis=a
+000021c0: 7869 732c 2069 6e64 6570 656e 6465 6e74  xis, independent
+000021d0: 3d69 6e64 6570 656e 6465 6e74 290d 0a20  =independent).. 
+000021e0: 2020 2072 6574 7572 6e20 720d 0a0d 0a20     return r.... 
+000021f0: 2064 6566 2073 6875 6666 6c65 2873 656c   def shuffle(sel
+00002200: 662c 0d0a 2020 2020 2020 2020 2020 2020  f,..            
+00002210: 2020 782c 0d0a 2020 2020 2020 2020 2020    x,..          
+00002220: 2020 2020 6178 6973 3d30 2c0d 0a20 2020      axis=0,..   
+00002230: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
+00002240: 4f70 7469 6f6e 616c 5b53 6565 644f 724b  Optional[SeedOrK
+00002250: 6579 5d20 3d20 4e6f 6e65 293a 0d0a 2020  ey] = None):..  
+00002260: 2020 6b65 7920 3d20 7365 6c66 2e73 706c    key = self.spl
+00002270: 6974 5f6b 6579 2829 2069 6620 6b65 7920  it_key() if key 
+00002280: 6973 204e 6f6e 6520 656c 7365 205f 666f  is None else _fo
+00002290: 726d 616c 697a 655f 6b65 7928 6b65 7929  rmalize_key(key)
+000022a0: 0d0a 2020 2020 7820 3d20 6a72 2e70 6572  ..    x = jr.per
+000022b0: 6d75 7461 7469 6f6e 286b 6579 2c20 782c  mutation(key, x,
+000022c0: 2061 7869 733d 6178 6973 290d 0a20 2020   axis=axis)..   
+000022d0: 2072 6574 7572 6e20 780d 0a0d 0a20 2064   return x....  d
+000022e0: 6566 2062 6574 6128 7365 6c66 2c0d 0a20  ef beta(self,.. 
+000022f0: 2020 2020 2020 2020 2020 612c 0d0a 2020            a,..  
+00002300: 2020 2020 2020 2020 2062 2c0d 0a20 2020           b,..   
+00002310: 2020 2020 2020 2020 7369 7a65 3a20 4f70          size: Op
+00002320: 7469 6f6e 616c 5b53 697a 655d 203d 204e  tional[Size] = N
+00002330: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+00002340: 206b 6579 3a20 4f70 7469 6f6e 616c 5b53   key: Optional[S
+00002350: 6565 644f 724b 6579 5d20 3d20 4e6f 6e65  eedOrKey] = None
+00002360: 2c0d 0a20 2020 2020 2020 2020 2020 6474  ,..           dt
+00002370: 7970 653a 2044 5479 7065 4c69 6b65 203d  ype: DTypeLike =
+00002380: 204e 6f6e 6529 3a0d 0a20 2020 2061 203d   None):..    a =
+00002390: 205f 6368 6563 6b5f 7079 5f73 6571 2861   _check_py_seq(a
+000023a0: 290d 0a20 2020 2062 203d 205f 6368 6563  )..    b = _chec
+000023b0: 6b5f 7079 5f73 6571 2862 290d 0a20 2020  k_py_seq(b)..   
+000023c0: 2069 6620 7369 7a65 2069 7320 4e6f 6e65   if size is None
+000023d0: 3a0d 0a20 2020 2020 2073 697a 6520 3d20  :..      size = 
+000023e0: 6c61 782e 6272 6f61 6463 6173 745f 7368  lax.broadcast_sh
+000023f0: 6170 6573 286a 6e70 2e73 6861 7065 2861  apes(jnp.shape(a
+00002400: 292c 206a 6e70 2e73 6861 7065 2862 2929  ), jnp.shape(b))
+00002410: 0d0a 2020 2020 6b65 7920 3d20 7365 6c66  ..    key = self
+00002420: 2e73 706c 6974 5f6b 6579 2829 2069 6620  .split_key() if 
+00002430: 6b65 7920 6973 204e 6f6e 6520 656c 7365  key is None else
+00002440: 205f 666f 726d 616c 697a 655f 6b65 7928   _formalize_key(
+00002450: 6b65 7929 0d0a 2020 2020 6474 7970 6520  key)..    dtype 
+00002460: 3d20 6474 7970 6520 6f72 2065 6e76 6972  = dtype or envir
+00002470: 6f6e 2e64 6674 7970 6528 290d 0a20 2020  on.dftype()..   
+00002480: 2072 203d 206a 722e 6265 7461 286b 6579   r = jr.beta(key
+00002490: 2c20 613d 612c 2062 3d62 2c20 7368 6170  , a=a, b=b, shap
+000024a0: 653d 5f73 697a 6532 7368 6170 6528 7369  e=_size2shape(si
+000024b0: 7a65 292c 2064 7479 7065 3d64 7479 7065  ze), dtype=dtype
+000024c0: 290d 0a20 2020 2072 6574 7572 6e20 720d  )..    return r.
+000024d0: 0a0d 0a20 2064 6566 2065 7870 6f6e 656e  ...  def exponen
+000024e0: 7469 616c 2873 656c 662c 0d0a 2020 2020  tial(self,..    
+000024f0: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+00002500: 616c 653d 4e6f 6e65 2c0d 0a20 2020 2020  ale=None,..     
+00002510: 2020 2020 2020 2020 2020 2020 2073 697a               siz
+00002520: 653a 204f 7074 696f 6e61 6c5b 5369 7a65  e: Optional[Size
+00002530: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2020  ] = None,..     
+00002540: 2020 2020 2020 2020 2020 2020 206b 6579               key
+00002550: 3a20 4f70 7469 6f6e 616c 5b53 6565 644f  : Optional[SeedO
+00002560: 724b 6579 5d20 3d20 4e6f 6e65 2c0d 0a20  rKey] = None,.. 
+00002570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002580: 2064 7479 7065 3a20 4454 7970 654c 696b   dtype: DTypeLik
+00002590: 6520 3d20 4e6f 6e65 293a 0d0a 2020 2020  e = None):..    
+000025a0: 6966 2073 697a 6520 6973 204e 6f6e 653a  if size is None:
+000025b0: 0d0a 2020 2020 2020 7369 7a65 203d 206a  ..      size = j
+000025c0: 6e70 2e73 6861 7065 2873 6361 6c65 290d  np.shape(scale).
+000025d0: 0a20 2020 206b 6579 203d 2073 656c 662e  .    key = self.
+000025e0: 7370 6c69 745f 6b65 7928 2920 6966 206b  split_key() if k
+000025f0: 6579 2069 7320 4e6f 6e65 2065 6c73 6520  ey is None else 
+00002600: 5f66 6f72 6d61 6c69 7a65 5f6b 6579 286b  _formalize_key(k
+00002610: 6579 290d 0a20 2020 2064 7479 7065 203d  ey)..    dtype =
+00002620: 2064 7479 7065 206f 7220 656e 7669 726f   dtype or enviro
+00002630: 6e2e 6466 7479 7065 2829 0d0a 2020 2020  n.dftype()..    
+00002640: 7363 616c 6520 3d20 6a6e 702e 6173 6172  scale = jnp.asar
+00002650: 7261 7928 7363 616c 652c 2064 7479 7065  ray(scale, dtype
+00002660: 3d64 7479 7065 290d 0a20 2020 2072 203d  =dtype)..    r =
+00002670: 206a 722e 6578 706f 6e65 6e74 6961 6c28   jr.exponential(
+00002680: 6b65 792c 2073 6861 7065 3d5f 7369 7a65  key, shape=_size
+00002690: 3273 6861 7065 2873 697a 6529 2c20 6474  2shape(size), dt
+000026a0: 7970 653d 6474 7970 6529 0d0a 2020 2020  ype=dtype)..    
+000026b0: 6966 2073 6361 6c65 2069 7320 6e6f 7420  if scale is not 
+000026c0: 4e6f 6e65 3a0d 0a20 2020 2020 2072 203d  None:..      r =
+000026d0: 2072 202f 2073 6361 6c65 0d0a 2020 2020   r / scale..    
+000026e0: 7265 7475 726e 2072 0d0a 0d0a 2020 6465  return r....  de
+000026f0: 6620 6761 6d6d 6128 7365 6c66 2c0d 0a20  f gamma(self,.. 
+00002700: 2020 2020 2020 2020 2020 2073 6861 7065             shape
+00002710: 2c0d 0a20 2020 2020 2020 2020 2020 2073  ,..            s
+00002720: 6361 6c65 3d4e 6f6e 652c 0d0a 2020 2020  cale=None,..    
+00002730: 2020 2020 2020 2020 7369 7a65 3a20 4f70          size: Op
+00002740: 7469 6f6e 616c 5b53 697a 655d 203d 204e  tional[Size] = N
+00002750: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+00002760: 2020 6b65 793a 204f 7074 696f 6e61 6c5b    key: Optional[
+00002770: 5365 6564 4f72 4b65 795d 203d 204e 6f6e  SeedOrKey] = Non
+00002780: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+00002790: 6474 7970 653a 2044 5479 7065 4c69 6b65  dtype: DTypeLike
+000027a0: 203d 204e 6f6e 6529 3a0d 0a20 2020 2073   = None):..    s
+000027b0: 6861 7065 203d 205f 6368 6563 6b5f 7079  hape = _check_py
+000027c0: 5f73 6571 2873 6861 7065 290d 0a20 2020  _seq(shape)..   
+000027d0: 2073 6361 6c65 203d 205f 6368 6563 6b5f   scale = _check_
+000027e0: 7079 5f73 6571 2873 6361 6c65 290d 0a20  py_seq(scale).. 
+000027f0: 2020 2069 6620 7369 7a65 2069 7320 4e6f     if size is No
+00002800: 6e65 3a0d 0a20 2020 2020 2073 697a 6520  ne:..      size 
+00002810: 3d20 6c61 782e 6272 6f61 6463 6173 745f  = lax.broadcast_
+00002820: 7368 6170 6573 286a 6e70 2e73 6861 7065  shapes(jnp.shape
+00002830: 2873 6861 7065 292c 206a 6e70 2e73 6861  (shape), jnp.sha
+00002840: 7065 2873 6361 6c65 2929 0d0a 2020 2020  pe(scale))..    
+00002850: 6b65 7920 3d20 7365 6c66 2e73 706c 6974  key = self.split
+00002860: 5f6b 6579 2829 2069 6620 6b65 7920 6973  _key() if key is
+00002870: 204e 6f6e 6520 656c 7365 205f 666f 726d   None else _form
+00002880: 616c 697a 655f 6b65 7928 6b65 7929 0d0a  alize_key(key)..
+00002890: 2020 2020 6474 7970 6520 3d20 6474 7970      dtype = dtyp
+000028a0: 6520 6f72 2065 6e76 6972 6f6e 2e64 6674  e or environ.dft
+000028b0: 7970 6528 290d 0a20 2020 2072 203d 206a  ype()..    r = j
+000028c0: 722e 6761 6d6d 6128 6b65 792c 2061 3d73  r.gamma(key, a=s
+000028d0: 6861 7065 2c20 7368 6170 653d 5f73 697a  hape, shape=_siz
+000028e0: 6532 7368 6170 6528 7369 7a65 292c 2064  e2shape(size), d
+000028f0: 7479 7065 3d64 7479 7065 290d 0a20 2020  type=dtype)..   
+00002900: 2069 6620 7363 616c 6520 6973 206e 6f74   if scale is not
+00002910: 204e 6f6e 653a 0d0a 2020 2020 2020 7220   None:..      r 
+00002920: 3d20 7220 2a20 7363 616c 650d 0a20 2020  = r * scale..   
+00002930: 2072 6574 7572 6e20 720d 0a0d 0a20 2064   return r....  d
+00002940: 6566 2067 756d 6265 6c28 7365 6c66 2c0d  ef gumbel(self,.
+00002950: 0a20 2020 2020 2020 2020 2020 2020 6c6f  .             lo
+00002960: 633d 4e6f 6e65 2c0d 0a20 2020 2020 2020  c=None,..       
+00002970: 2020 2020 2020 7363 616c 653d 4e6f 6e65        scale=None
+00002980: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00002990: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b53  size: Optional[S
+000029a0: 697a 655d 203d 204e 6f6e 652c 0d0a 2020  ize] = None,..  
+000029b0: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
+000029c0: 4f70 7469 6f6e 616c 5b53 6565 644f 724b  Optional[SeedOrK
+000029d0: 6579 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ey] = None,..   
+000029e0: 2020 2020 2020 2020 2020 6474 7970 653a            dtype:
+000029f0: 2044 5479 7065 4c69 6b65 203d 204e 6f6e   DTypeLike = Non
+00002a00: 6529 3a0d 0a20 2020 206c 6f63 203d 205f  e):..    loc = _
+00002a10: 6368 6563 6b5f 7079 5f73 6571 286c 6f63  check_py_seq(loc
+00002a20: 290d 0a20 2020 2073 6361 6c65 203d 205f  )..    scale = _
+00002a30: 6368 6563 6b5f 7079 5f73 6571 2873 6361  check_py_seq(sca
+00002a40: 6c65 290d 0a20 2020 2069 6620 7369 7a65  le)..    if size
+00002a50: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
+00002a60: 2073 697a 6520 3d20 6c61 782e 6272 6f61   size = lax.broa
+00002a70: 6463 6173 745f 7368 6170 6573 286a 6e70  dcast_shapes(jnp
+00002a80: 2e73 6861 7065 286c 6f63 292c 206a 6e70  .shape(loc), jnp
+00002a90: 2e73 6861 7065 2873 6361 6c65 2929 0d0a  .shape(scale))..
+00002aa0: 2020 2020 6b65 7920 3d20 7365 6c66 2e73      key = self.s
+00002ab0: 706c 6974 5f6b 6579 2829 2069 6620 6b65  plit_key() if ke
+00002ac0: 7920 6973 204e 6f6e 6520 656c 7365 205f  y is None else _
+00002ad0: 666f 726d 616c 697a 655f 6b65 7928 6b65  formalize_key(ke
+00002ae0: 7929 0d0a 2020 2020 6474 7970 6520 3d20  y)..    dtype = 
+00002af0: 6474 7970 6520 6f72 2065 6e76 6972 6f6e  dtype or environ
+00002b00: 2e64 6674 7970 6528 290d 0a20 2020 2072  .dftype()..    r
+00002b10: 203d 205f 6c6f 635f 7363 616c 6528 6c6f   = _loc_scale(lo
+00002b20: 632c 2073 6361 6c65 2c20 6a72 2e67 756d  c, scale, jr.gum
+00002b30: 6265 6c28 6b65 792c 2073 6861 7065 3d5f  bel(key, shape=_
+00002b40: 7369 7a65 3273 6861 7065 2873 697a 6529  size2shape(size)
+00002b50: 2c20 6474 7970 653d 6474 7970 6529 290d  , dtype=dtype)).
+00002b60: 0a20 2020 2072 6574 7572 6e20 720d 0a0d  .    return r...
+00002b70: 0a20 2064 6566 206c 6170 6c61 6365 2873  .  def laplace(s
+00002b80: 656c 662c 0d0a 2020 2020 2020 2020 2020  elf,..          
+00002b90: 2020 2020 6c6f 633d 4e6f 6e65 2c0d 0a20      loc=None,.. 
+00002ba0: 2020 2020 2020 2020 2020 2020 2073 6361               sca
+00002bb0: 6c65 3d4e 6f6e 652c 0d0a 2020 2020 2020  le=None,..      
+00002bc0: 2020 2020 2020 2020 7369 7a65 3a20 4f70          size: Op
+00002bd0: 7469 6f6e 616c 5b53 697a 655d 203d 204e  tional[Size] = N
+00002be0: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+00002bf0: 2020 2020 6b65 793a 204f 7074 696f 6e61      key: Optiona
+00002c00: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
+00002c10: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+00002c20: 2020 2020 6474 7970 653a 2044 5479 7065      dtype: DType
+00002c30: 4c69 6b65 203d 204e 6f6e 6529 3a0d 0a20  Like = None):.. 
+00002c40: 2020 206c 6f63 203d 205f 6368 6563 6b5f     loc = _check_
+00002c50: 7079 5f73 6571 286c 6f63 290d 0a20 2020  py_seq(loc)..   
+00002c60: 2073 6361 6c65 203d 205f 6368 6563 6b5f   scale = _check_
+00002c70: 7079 5f73 6571 2873 6361 6c65 290d 0a20  py_seq(scale).. 
+00002c80: 2020 2069 6620 7369 7a65 2069 7320 4e6f     if size is No
+00002c90: 6e65 3a0d 0a20 2020 2020 2073 697a 6520  ne:..      size 
+00002ca0: 3d20 6c61 782e 6272 6f61 6463 6173 745f  = lax.broadcast_
+00002cb0: 7368 6170 6573 286a 6e70 2e73 6861 7065  shapes(jnp.shape
+00002cc0: 286c 6f63 292c 206a 6e70 2e73 6861 7065  (loc), jnp.shape
+00002cd0: 2873 6361 6c65 2929 0d0a 2020 2020 6b65  (scale))..    ke
+00002ce0: 7920 3d20 7365 6c66 2e73 706c 6974 5f6b  y = self.split_k
+00002cf0: 6579 2829 2069 6620 6b65 7920 6973 204e  ey() if key is N
+00002d00: 6f6e 6520 656c 7365 205f 666f 726d 616c  one else _formal
+00002d10: 697a 655f 6b65 7928 6b65 7929 0d0a 2020  ize_key(key)..  
+00002d20: 2020 6474 7970 6520 3d20 6474 7970 6520    dtype = dtype 
+00002d30: 6f72 2065 6e76 6972 6f6e 2e64 6674 7970  or environ.dftyp
+00002d40: 6528 290d 0a20 2020 2072 203d 205f 6c6f  e()..    r = _lo
+00002d50: 635f 7363 616c 6528 6c6f 632c 2073 6361  c_scale(loc, sca
+00002d60: 6c65 2c20 6a72 2e6c 6170 6c61 6365 286b  le, jr.laplace(k
+00002d70: 6579 2c20 7368 6170 653d 5f73 697a 6532  ey, shape=_size2
+00002d80: 7368 6170 6528 7369 7a65 292c 2064 7479  shape(size), dty
+00002d90: 7065 3d64 7479 7065 2929 0d0a 2020 2020  pe=dtype))..    
+00002da0: 7265 7475 726e 2072 0d0a 0d0a 2020 6465  return r....  de
+00002db0: 6620 6c6f 6769 7374 6963 2873 656c 662c  f logistic(self,
+00002dc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00002dd0: 206c 6f63 3d4e 6f6e 652c 0d0a 2020 2020   loc=None,..    
+00002de0: 2020 2020 2020 2020 2020 2073 6361 6c65             scale
+00002df0: 3d4e 6f6e 652c 0d0a 2020 2020 2020 2020  =None,..        
+00002e00: 2020 2020 2020 2073 697a 653a 204f 7074         size: Opt
+00002e10: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
+00002e20: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
+00002e30: 2020 2020 6b65 793a 204f 7074 696f 6e61      key: Optiona
+00002e40: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
+00002e50: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+00002e60: 2020 2020 2064 7479 7065 3a20 4454 7970       dtype: DTyp
+00002e70: 654c 696b 6520 3d20 4e6f 6e65 293a 0d0a  eLike = None):..
+00002e80: 2020 2020 6c6f 6320 3d20 5f63 6865 636b      loc = _check
+00002e90: 5f70 795f 7365 7128 6c6f 6329 0d0a 2020  _py_seq(loc)..  
+00002ea0: 2020 7363 616c 6520 3d20 5f63 6865 636b    scale = _check
+00002eb0: 5f70 795f 7365 7128 7363 616c 6529 0d0a  _py_seq(scale)..
+00002ec0: 2020 2020 6966 2073 697a 6520 6973 204e      if size is N
+00002ed0: 6f6e 653a 0d0a 2020 2020 2020 7369 7a65  one:..      size
+00002ee0: 203d 206c 6178 2e62 726f 6164 6361 7374   = lax.broadcast
+00002ef0: 5f73 6861 7065 7328 6a6e 702e 7368 6170  _shapes(jnp.shap
+00002f00: 6528 6c6f 6329 2c20 6a6e 702e 7368 6170  e(loc), jnp.shap
+00002f10: 6528 7363 616c 6529 290d 0a20 2020 206b  e(scale))..    k
+00002f20: 6579 203d 2073 656c 662e 7370 6c69 745f  ey = self.split_
+00002f30: 6b65 7928 2920 6966 206b 6579 2069 7320  key() if key is 
+00002f40: 4e6f 6e65 2065 6c73 6520 5f66 6f72 6d61  None else _forma
+00002f50: 6c69 7a65 5f6b 6579 286b 6579 290d 0a20  lize_key(key).. 
+00002f60: 2020 2064 7479 7065 203d 2064 7479 7065     dtype = dtype
+00002f70: 206f 7220 656e 7669 726f 6e2e 6466 7479   or environ.dfty
+00002f80: 7065 2829 0d0a 2020 2020 7220 3d20 5f6c  pe()..    r = _l
+00002f90: 6f63 5f73 6361 6c65 286c 6f63 2c20 7363  oc_scale(loc, sc
+00002fa0: 616c 652c 206a 722e 6c6f 6769 7374 6963  ale, jr.logistic
+00002fb0: 286b 6579 2c20 7368 6170 653d 5f73 697a  (key, shape=_siz
+00002fc0: 6532 7368 6170 6528 7369 7a65 292c 2064  e2shape(size), d
+00002fd0: 7479 7065 3d64 7479 7065 2929 0d0a 2020  type=dtype))..  
+00002fe0: 2020 7265 7475 726e 2072 0d0a 0d0a 2020    return r....  
+00002ff0: 6465 6620 6e6f 726d 616c 2873 656c 662c  def normal(self,
+00003000: 0d0a 2020 2020 2020 2020 2020 2020 206c  ..             l
+00003010: 6f63 3d4e 6f6e 652c 0d0a 2020 2020 2020  oc=None,..      
+00003020: 2020 2020 2020 2073 6361 6c65 3d4e 6f6e         scale=Non
+00003030: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+00003040: 2073 697a 653a 204f 7074 696f 6e61 6c5b   size: Optional[
+00003050: 5369 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20  Size] = None,.. 
+00003060: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
+00003070: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
+00003080: 4b65 795d 203d 204e 6f6e 652c 0d0a 2020  Key] = None,..  
+00003090: 2020 2020 2020 2020 2020 2064 7479 7065             dtype
+000030a0: 3a20 4454 7970 654c 696b 6520 3d20 4e6f  : DTypeLike = No
+000030b0: 6e65 293a 0d0a 2020 2020 6c6f 6320 3d20  ne):..    loc = 
+000030c0: 5f63 6865 636b 5f70 795f 7365 7128 6c6f  _check_py_seq(lo
+000030d0: 6329 0d0a 2020 2020 7363 616c 6520 3d20  c)..    scale = 
+000030e0: 5f63 6865 636b 5f70 795f 7365 7128 7363  _check_py_seq(sc
+000030f0: 616c 6529 0d0a 2020 2020 6966 2073 697a  ale)..    if siz
+00003100: 6520 6973 204e 6f6e 653a 0d0a 2020 2020  e is None:..    
+00003110: 2020 7369 7a65 203d 206c 6178 2e62 726f    size = lax.bro
+00003120: 6164 6361 7374 5f73 6861 7065 7328 6a6e  adcast_shapes(jn
+00003130: 702e 7368 6170 6528 7363 616c 6529 2c20  p.shape(scale), 
+00003140: 6a6e 702e 7368 6170 6528 6c6f 6329 290d  jnp.shape(loc)).
+00003150: 0a20 2020 206b 6579 203d 2073 656c 662e  .    key = self.
+00003160: 7370 6c69 745f 6b65 7928 2920 6966 206b  split_key() if k
+00003170: 6579 2069 7320 4e6f 6e65 2065 6c73 6520  ey is None else 
+00003180: 5f66 6f72 6d61 6c69 7a65 5f6b 6579 286b  _formalize_key(k
+00003190: 6579 290d 0a20 2020 2064 7479 7065 203d  ey)..    dtype =
+000031a0: 2064 7479 7065 206f 7220 656e 7669 726f   dtype or enviro
+000031b0: 6e2e 6466 7479 7065 2829 0d0a 2020 2020  n.dftype()..    
+000031c0: 7220 3d20 5f6c 6f63 5f73 6361 6c65 286c  r = _loc_scale(l
+000031d0: 6f63 2c20 7363 616c 652c 206a 722e 6e6f  oc, scale, jr.no
+000031e0: 726d 616c 286b 6579 2c20 7368 6170 653d  rmal(key, shape=
+000031f0: 5f73 697a 6532 7368 6170 6528 7369 7a65  _size2shape(size
+00003200: 292c 2064 7479 7065 3d64 7479 7065 2929  ), dtype=dtype))
+00003210: 0d0a 2020 2020 7265 7475 726e 2072 0d0a  ..    return r..
+00003220: 0d0a 2020 6465 6620 7061 7265 746f 2873  ..  def pareto(s
+00003230: 656c 662c 0d0a 2020 2020 2020 2020 2020  elf,..          
+00003240: 2020 2061 2c0d 0a20 2020 2020 2020 2020     a,..         
+00003250: 2020 2020 7369 7a65 3a20 4f70 7469 6f6e      size: Option
+00003260: 616c 5b53 697a 655d 203d 204e 6f6e 652c  al[Size] = None,
+00003270: 0d0a 2020 2020 2020 2020 2020 2020 206b  ..             k
+00003280: 6579 3a20 4f70 7469 6f6e 616c 5b53 6565  ey: Optional[See
+00003290: 644f 724b 6579 5d20 3d20 4e6f 6e65 2c0d  dOrKey] = None,.
+000032a0: 0a20 2020 2020 2020 2020 2020 2020 6474  .             dt
+000032b0: 7970 653a 2044 5479 7065 4c69 6b65 203d  ype: DTypeLike =
+000032c0: 204e 6f6e 6529 3a0d 0a20 2020 2069 6620   None):..    if 
+000032d0: 7369 7a65 2069 7320 4e6f 6e65 3a0d 0a20  size is None:.. 
+000032e0: 2020 2020 2073 697a 6520 3d20 6a6e 702e       size = jnp.
+000032f0: 7368 6170 6528 6129 0d0a 2020 2020 6b65  shape(a)..    ke
+00003300: 7920 3d20 7365 6c66 2e73 706c 6974 5f6b  y = self.split_k
+00003310: 6579 2829 2069 6620 6b65 7920 6973 204e  ey() if key is N
+00003320: 6f6e 6520 656c 7365 205f 666f 726d 616c  one else _formal
+00003330: 697a 655f 6b65 7928 6b65 7929 0d0a 2020  ize_key(key)..  
+00003340: 2020 6474 7970 6520 3d20 6474 7970 6520    dtype = dtype 
+00003350: 6f72 2065 6e76 6972 6f6e 2e64 6674 7970  or environ.dftyp
+00003360: 6528 290d 0a20 2020 2061 203d 206a 6e70  e()..    a = jnp
+00003370: 2e61 7361 7272 6179 2861 2c20 6474 7970  .asarray(a, dtyp
+00003380: 653d 6474 7970 6529 0d0a 2020 2020 7220  e=dtype)..    r 
+00003390: 3d20 6a72 2e70 6172 6574 6f28 6b65 792c  = jr.pareto(key,
+000033a0: 2062 3d61 2c20 7368 6170 653d 5f73 697a   b=a, shape=_siz
+000033b0: 6532 7368 6170 6528 7369 7a65 292c 2064  e2shape(size), d
+000033c0: 7479 7065 3d64 7479 7065 290d 0a20 2020  type=dtype)..   
+000033d0: 2072 6574 7572 6e20 720d 0a0d 0a20 2064   return r....  d
+000033e0: 6566 2070 6f69 7373 6f6e 2873 656c 662c  ef poisson(self,
+000033f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003400: 6c61 6d3d 312e 302c 0d0a 2020 2020 2020  lam=1.0,..      
+00003410: 2020 2020 2020 2020 7369 7a65 3a20 4f70          size: Op
+00003420: 7469 6f6e 616c 5b53 697a 655d 203d 204e  tional[Size] = N
+00003430: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+00003440: 2020 2020 6b65 793a 204f 7074 696f 6e61      key: Optiona
+00003450: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
+00003460: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+00003470: 2020 2020 6474 7970 653a 2044 5479 7065      dtype: DType
+00003480: 4c69 6b65 203d 204e 6f6e 6529 3a0d 0a20  Like = None):.. 
+00003490: 2020 206c 616d 203d 205f 6368 6563 6b5f     lam = _check_
+000034a0: 7079 5f73 6571 286c 616d 290d 0a20 2020  py_seq(lam)..   
+000034b0: 2069 6620 7369 7a65 2069 7320 4e6f 6e65   if size is None
+000034c0: 3a0d 0a20 2020 2020 2073 697a 6520 3d20  :..      size = 
+000034d0: 6a6e 702e 7368 6170 6528 6c61 6d29 0d0a  jnp.shape(lam)..
+000034e0: 2020 2020 6b65 7920 3d20 7365 6c66 2e73      key = self.s
+000034f0: 706c 6974 5f6b 6579 2829 2069 6620 6b65  plit_key() if ke
+00003500: 7920 6973 204e 6f6e 6520 656c 7365 205f  y is None else _
+00003510: 666f 726d 616c 697a 655f 6b65 7928 6b65  formalize_key(ke
+00003520: 7929 0d0a 2020 2020 6474 7970 6520 3d20  y)..    dtype = 
+00003530: 6474 7970 6520 6f72 2065 6e76 6972 6f6e  dtype or environ
+00003540: 2e64 6974 7970 6528 290d 0a20 2020 2072  .ditype()..    r
+00003550: 203d 206a 722e 706f 6973 736f 6e28 6b65   = jr.poisson(ke
+00003560: 792c 206c 616d 3d6c 616d 2c20 7368 6170  y, lam=lam, shap
+00003570: 653d 5f73 697a 6532 7368 6170 6528 7369  e=_size2shape(si
+00003580: 7a65 292c 2064 7479 7065 3d64 7479 7065  ze), dtype=dtype
+00003590: 290d 0a20 2020 2072 6574 7572 6e20 720d  )..    return r.
+000035a0: 0a0d 0a20 2064 6566 2073 7461 6e64 6172  ...  def standar
+000035b0: 645f 6361 7563 6879 2873 656c 662c 0d0a  d_cauchy(self,..
+000035c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000035d0: 2020 2020 2020 7369 7a65 3a20 4f70 7469        size: Opti
+000035e0: 6f6e 616c 5b53 697a 655d 203d 204e 6f6e  onal[Size] = Non
+000035f0: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+00003600: 2020 2020 2020 2020 2020 6b65 793a 204f            key: O
+00003610: 7074 696f 6e61 6c5b 5365 6564 4f72 4b65  ptional[SeedOrKe
+00003620: 795d 203d 204e 6f6e 652c 0d0a 2020 2020  y] = None,..    
+00003630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003640: 2020 6474 7970 653a 2044 5479 7065 4c69    dtype: DTypeLi
+00003650: 6b65 203d 204e 6f6e 6529 3a0d 0a20 2020  ke = None):..   
+00003660: 206b 6579 203d 2073 656c 662e 7370 6c69   key = self.spli
+00003670: 745f 6b65 7928 2920 6966 206b 6579 2069  t_key() if key i
+00003680: 7320 4e6f 6e65 2065 6c73 6520 5f66 6f72  s None else _for
+00003690: 6d61 6c69 7a65 5f6b 6579 286b 6579 290d  malize_key(key).
+000036a0: 0a20 2020 2064 7479 7065 203d 2064 7479  .    dtype = dty
+000036b0: 7065 206f 7220 656e 7669 726f 6e2e 6466  pe or environ.df
+000036c0: 7479 7065 2829 0d0a 2020 2020 7220 3d20  type()..    r = 
+000036d0: 6a72 2e63 6175 6368 7928 6b65 792c 2073  jr.cauchy(key, s
+000036e0: 6861 7065 3d5f 7369 7a65 3273 6861 7065  hape=_size2shape
+000036f0: 2873 697a 6529 2c20 6474 7970 653d 6474  (size), dtype=dt
+00003700: 7970 6529 0d0a 2020 2020 7265 7475 726e  ype)..    return
+00003710: 2072 0d0a 0d0a 2020 6465 6620 7374 616e   r....  def stan
+00003720: 6461 7264 5f65 7870 6f6e 656e 7469 616c  dard_exponential
+00003730: 2873 656c 662c 0d0a 2020 2020 2020 2020  (self,..        
+00003740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003750: 2020 2073 697a 653a 204f 7074 696f 6e61     size: Optiona
+00003760: 6c5b 5369 7a65 5d20 3d20 4e6f 6e65 2c0d  l[Size] = None,.
+00003770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003780: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
+00003790: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
+000037a0: 4b65 795d 203d 204e 6f6e 652c 0d0a 2020  Key] = None,..  
+000037b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000037c0: 2020 2020 2020 2020 2064 7479 7065 3a20           dtype: 
+000037d0: 4454 7970 654c 696b 6520 3d20 4e6f 6e65  DTypeLike = None
+000037e0: 293a 0d0a 2020 2020 6b65 7920 3d20 7365  ):..    key = se
+000037f0: 6c66 2e73 706c 6974 5f6b 6579 2829 2069  lf.split_key() i
+00003800: 6620 6b65 7920 6973 204e 6f6e 6520 656c  f key is None el
+00003810: 7365 205f 666f 726d 616c 697a 655f 6b65  se _formalize_ke
+00003820: 7928 6b65 7929 0d0a 2020 2020 6474 7970  y(key)..    dtyp
+00003830: 6520 3d20 6474 7970 6520 6f72 2065 6e76  e = dtype or env
+00003840: 6972 6f6e 2e64 6674 7970 6528 290d 0a20  iron.dftype().. 
+00003850: 2020 2072 203d 206a 722e 6578 706f 6e65     r = jr.expone
+00003860: 6e74 6961 6c28 6b65 792c 2073 6861 7065  ntial(key, shape
+00003870: 3d5f 7369 7a65 3273 6861 7065 2873 697a  =_size2shape(siz
+00003880: 6529 2c20 6474 7970 653d 6474 7970 6529  e), dtype=dtype)
+00003890: 0d0a 2020 2020 7265 7475 726e 2072 0d0a  ..    return r..
+000038a0: 0d0a 2020 6465 6620 7374 616e 6461 7264  ..  def standard
+000038b0: 5f67 616d 6d61 2873 656c 662c 0d0a 2020  _gamma(self,..  
+000038c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000038d0: 2020 2073 6861 7065 2c0d 0a20 2020 2020     shape,..     
+000038e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000038f0: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b53  size: Optional[S
+00003900: 697a 655d 203d 204e 6f6e 652c 0d0a 2020  ize] = None,..  
+00003910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003920: 2020 206b 6579 3a20 4f70 7469 6f6e 616c     key: Optional
+00003930: 5b53 6565 644f 724b 6579 5d20 3d20 4e6f  [SeedOrKey] = No
+00003940: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
+00003950: 2020 2020 2020 2020 2020 6474 7970 653a            dtype:
+00003960: 2044 5479 7065 4c69 6b65 203d 204e 6f6e   DTypeLike = Non
+00003970: 6529 3a0d 0a20 2020 2073 6861 7065 203d  e):..    shape =
+00003980: 205f 6368 6563 6b5f 7079 5f73 6571 2873   _check_py_seq(s
+00003990: 6861 7065 290d 0a20 2020 2069 6620 7369  hape)..    if si
+000039a0: 7a65 2069 7320 4e6f 6e65 3a0d 0a20 2020  ze is None:..   
+000039b0: 2020 2073 697a 6520 3d20 6a6e 702e 7368     size = jnp.sh
+000039c0: 6170 6528 7368 6170 6529 0d0a 2020 2020  ape(shape)..    
+000039d0: 6b65 7920 3d20 7365 6c66 2e73 706c 6974  key = self.split
+000039e0: 5f6b 6579 2829 2069 6620 6b65 7920 6973  _key() if key is
+000039f0: 204e 6f6e 6520 656c 7365 205f 666f 726d   None else _form
+00003a00: 616c 697a 655f 6b65 7928 6b65 7929 0d0a  alize_key(key)..
+00003a10: 2020 2020 6474 7970 6520 3d20 6474 7970      dtype = dtyp
+00003a20: 6520 6f72 2065 6e76 6972 6f6e 2e64 6674  e or environ.dft
+00003a30: 7970 6528 290d 0a20 2020 2072 203d 206a  ype()..    r = j
+00003a40: 722e 6761 6d6d 6128 6b65 792c 2061 3d73  r.gamma(key, a=s
+00003a50: 6861 7065 2c20 7368 6170 653d 5f73 697a  hape, shape=_siz
+00003a60: 6532 7368 6170 6528 7369 7a65 292c 2064  e2shape(size), d
+00003a70: 7479 7065 3d64 7479 7065 290d 0a20 2020  type=dtype)..   
+00003a80: 2072 6574 7572 6e20 720d 0a0d 0a20 2064   return r....  d
+00003a90: 6566 2073 7461 6e64 6172 645f 6e6f 726d  ef standard_norm
+00003aa0: 616c 2873 656c 662c 0d0a 2020 2020 2020  al(self,..      
+00003ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003ac0: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b53  size: Optional[S
+00003ad0: 697a 655d 203d 204e 6f6e 652c 0d0a 2020  ize] = None,..  
+00003ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003af0: 2020 2020 6b65 793a 204f 7074 696f 6e61      key: Optiona
+00003b00: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
+00003b10: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+00003b20: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
+00003b30: 653a 2044 5479 7065 4c69 6b65 203d 204e  e: DTypeLike = N
+00003b40: 6f6e 6529 3a0d 0a20 2020 206b 6579 203d  one):..    key =
+00003b50: 2073 656c 662e 7370 6c69 745f 6b65 7928   self.split_key(
+00003b60: 2920 6966 206b 6579 2069 7320 4e6f 6e65  ) if key is None
+00003b70: 2065 6c73 6520 5f66 6f72 6d61 6c69 7a65   else _formalize
+00003b80: 5f6b 6579 286b 6579 290d 0a20 2020 2064  _key(key)..    d
+00003b90: 7479 7065 203d 2064 7479 7065 206f 7220  type = dtype or 
+00003ba0: 656e 7669 726f 6e2e 6466 7479 7065 2829  environ.dftype()
+00003bb0: 0d0a 2020 2020 7220 3d20 6a72 2e6e 6f72  ..    r = jr.nor
+00003bc0: 6d61 6c28 6b65 792c 2073 6861 7065 3d5f  mal(key, shape=_
+00003bd0: 7369 7a65 3273 6861 7065 2873 697a 6529  size2shape(size)
+00003be0: 2c20 6474 7970 653d 6474 7970 6529 0d0a  , dtype=dtype)..
+00003bf0: 2020 2020 7265 7475 726e 2072 0d0a 0d0a      return r....
+00003c00: 2020 6465 6620 7374 616e 6461 7264 5f74    def standard_t
+00003c10: 2873 656c 662c 2064 662c 0d0a 2020 2020  (self, df,..    
+00003c20: 2020 2020 2020 2020 2020 2020 2073 697a               siz
+00003c30: 653a 204f 7074 696f 6e61 6c5b 5369 7a65  e: Optional[Size
+00003c40: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2020  ] = None,..     
+00003c50: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
+00003c60: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
+00003c70: 4b65 795d 203d 204e 6f6e 652c 0d0a 2020  Key] = None,..  
+00003c80: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00003c90: 7479 7065 3a20 4454 7970 654c 696b 6520  type: DTypeLike 
+00003ca0: 3d20 4e6f 6e65 293a 0d0a 2020 2020 6466  = None):..    df
+00003cb0: 203d 205f 6368 6563 6b5f 7079 5f73 6571   = _check_py_seq
+00003cc0: 2864 6629 0d0a 2020 2020 6966 2073 697a  (df)..    if siz
+00003cd0: 6520 6973 204e 6f6e 653a 0d0a 2020 2020  e is None:..    
+00003ce0: 2020 7369 7a65 203d 206a 6e70 2e73 6861    size = jnp.sha
+00003cf0: 7065 2873 697a 6529 0d0a 2020 2020 6b65  pe(size)..    ke
+00003d00: 7920 3d20 7365 6c66 2e73 706c 6974 5f6b  y = self.split_k
+00003d10: 6579 2829 2069 6620 6b65 7920 6973 204e  ey() if key is N
+00003d20: 6f6e 6520 656c 7365 205f 666f 726d 616c  one else _formal
+00003d30: 697a 655f 6b65 7928 6b65 7929 0d0a 2020  ize_key(key)..  
+00003d40: 2020 6474 7970 6520 3d20 6474 7970 6520    dtype = dtype 
+00003d50: 6f72 2065 6e76 6972 6f6e 2e64 6674 7970  or environ.dftyp
+00003d60: 6528 290d 0a20 2020 2072 203d 206a 722e  e()..    r = jr.
+00003d70: 7428 6b65 792c 2064 663d 6466 2c20 7368  t(key, df=df, sh
+00003d80: 6170 653d 5f73 697a 6532 7368 6170 6528  ape=_size2shape(
+00003d90: 7369 7a65 292c 2064 7479 7065 3d64 7479  size), dtype=dty
+00003da0: 7065 290d 0a20 2020 2072 6574 7572 6e20  pe)..    return 
+00003db0: 720d 0a0d 0a20 2064 6566 2075 6e69 666f  r....  def unifo
+00003dc0: 726d 2873 656c 662c 0d0a 2020 2020 2020  rm(self,..      
+00003dd0: 2020 2020 2020 2020 6c6f 773d 302e 302c          low=0.0,
+00003de0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003df0: 6869 6768 3d31 2e30 2c0d 0a20 2020 2020  high=1.0,..     
+00003e00: 2020 2020 2020 2020 2073 697a 653a 204f           size: O
+00003e10: 7074 696f 6e61 6c5b 5369 7a65 5d20 3d20  ptional[Size] = 
+00003e20: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+00003e30: 2020 2020 206b 6579 3a20 4f70 7469 6f6e       key: Option
+00003e40: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
+00003e50: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+00003e60: 2020 2020 2064 7479 7065 3a20 4454 7970       dtype: DTyp
+00003e70: 654c 696b 6520 3d20 4e6f 6e65 293a 0d0a  eLike = None):..
+00003e80: 2020 2020 6c6f 7720 3d20 5f63 6865 636b      low = _check
+00003e90: 5f70 795f 7365 7128 6c6f 7729 0d0a 2020  _py_seq(low)..  
+00003ea0: 2020 6869 6768 203d 205f 6368 6563 6b5f    high = _check_
+00003eb0: 7079 5f73 6571 2868 6967 6829 0d0a 2020  py_seq(high)..  
+00003ec0: 2020 6966 2073 697a 6520 6973 204e 6f6e    if size is Non
+00003ed0: 653a 0d0a 2020 2020 2020 7369 7a65 203d  e:..      size =
+00003ee0: 206c 6178 2e62 726f 6164 6361 7374 5f73   lax.broadcast_s
+00003ef0: 6861 7065 7328 6a6e 702e 7368 6170 6528  hapes(jnp.shape(
+00003f00: 6c6f 7729 2c20 6a6e 702e 7368 6170 6528  low), jnp.shape(
+00003f10: 6869 6768 2929 0d0a 2020 2020 6b65 7920  high))..    key 
+00003f20: 3d20 7365 6c66 2e73 706c 6974 5f6b 6579  = self.split_key
+00003f30: 2829 2069 6620 6b65 7920 6973 204e 6f6e  () if key is Non
+00003f40: 6520 656c 7365 205f 666f 726d 616c 697a  e else _formaliz
+00003f50: 655f 6b65 7928 6b65 7929 0d0a 2020 2020  e_key(key)..    
+00003f60: 6474 7970 6520 3d20 6474 7970 6520 6f72  dtype = dtype or
+00003f70: 2065 6e76 6972 6f6e 2e64 6674 7970 6528   environ.dftype(
+00003f80: 290d 0a20 2020 2072 203d 206a 722e 756e  )..    r = jr.un
+00003f90: 6966 6f72 6d28 6b65 792c 2073 6861 7065  iform(key, shape
+00003fa0: 3d5f 7369 7a65 3273 6861 7065 2873 697a  =_size2shape(siz
+00003fb0: 6529 2c20 6d69 6e76 616c 3d6c 6f77 2c20  e), minval=low, 
+00003fc0: 6d61 7876 616c 3d68 6967 682c 2064 7479  maxval=high, dty
+00003fd0: 7065 3d64 7479 7065 290d 0a20 2020 2072  pe=dtype)..    r
+00003fe0: 6574 7572 6e20 720d 0a0d 0a20 2064 6566  eturn r....  def
+00003ff0: 205f 5f6e 6f72 6d5f 6364 6628 7365 6c66   __norm_cdf(self
+00004000: 2c20 782c 2073 7172 7432 2c20 6474 7970  , x, sqrt2, dtyp
+00004010: 6529 3a0d 0a20 2020 2023 2043 6f6d 7075  e):..    # Compu
+00004020: 7465 7320 7374 616e 6461 7264 206e 6f72  tes standard nor
+00004030: 6d61 6c20 6375 6d75 6c61 7469 7665 2064  mal cumulative d
+00004040: 6973 7472 6962 7574 696f 6e20 6675 6e63  istribution func
+00004050: 7469 6f6e 0d0a 2020 2020 7265 7475 726e  tion..    return
+00004060: 2028 6e70 2e61 7361 7272 6179 2831 2e2c   (np.asarray(1.,
+00004070: 2064 7479 7065 2920 2b20 6c61 782e 6572   dtype) + lax.er
+00004080: 6628 7820 2f20 7371 7274 3229 2920 2f20  f(x / sqrt2)) / 
+00004090: 6e70 2e61 7361 7272 6179 2832 2e2c 2064  np.asarray(2., d
+000040a0: 7479 7065 290d 0a0d 0a20 2064 6566 2074  type)....  def t
+000040b0: 7275 6e63 6174 6564 5f6e 6f72 6d61 6c28  runcated_normal(
+000040c0: 0d0a 2020 2020 2020 7365 6c66 2c0d 0a20  ..      self,.. 
+000040d0: 2020 2020 206c 6f77 6572 2c0d 0a20 2020       lower,..   
+000040e0: 2020 2075 7070 6572 2c0d 0a20 2020 2020     upper,..     
+000040f0: 2073 697a 653a 204f 7074 696f 6e61 6c5b   size: Optional[
+00004100: 5369 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20  Size] = None,.. 
+00004110: 2020 2020 206c 6f63 3d30 2e2c 0d0a 2020       loc=0.,..  
+00004120: 2020 2020 7363 616c 653d 312e 2c0d 0a20      scale=1.,.. 
+00004130: 2020 2020 206b 6579 3a20 4f70 7469 6f6e       key: Option
+00004140: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
+00004150: 4e6f 6e65 2c0d 0a20 2020 2020 2064 7479  None,..      dty
+00004160: 7065 3a20 4454 7970 654c 696b 6520 3d20  pe: DTypeLike = 
+00004170: 4e6f 6e65 0d0a 2020 293a 0d0a 2020 2020  None..  ):..    
+00004180: 6c6f 7765 7220 3d20 5f63 6865 636b 5f70  lower = _check_p
+00004190: 795f 7365 7128 6c6f 7765 7229 0d0a 2020  y_seq(lower)..  
+000041a0: 2020 7570 7065 7220 3d20 5f63 6865 636b    upper = _check
+000041b0: 5f70 795f 7365 7128 7570 7065 7229 0d0a  _py_seq(upper)..
+000041c0: 2020 2020 6c6f 6320 3d20 5f63 6865 636b      loc = _check
+000041d0: 5f70 795f 7365 7128 6c6f 6329 0d0a 2020  _py_seq(loc)..  
+000041e0: 2020 7363 616c 6520 3d20 5f63 6865 636b    scale = _check
+000041f0: 5f70 795f 7365 7128 7363 616c 6529 0d0a  _py_seq(scale)..
+00004200: 2020 2020 6474 7970 6520 3d20 6474 7970      dtype = dtyp
+00004210: 6520 6f72 2065 6e76 6972 6f6e 2e64 6674  e or environ.dft
+00004220: 7970 6528 290d 0a0d 0a20 2020 206c 6f77  ype()....    low
+00004230: 6572 203d 206c 6178 2e63 6f6e 7665 7274  er = lax.convert
+00004240: 5f65 6c65 6d65 6e74 5f74 7970 6528 6c6f  _element_type(lo
+00004250: 7765 722c 2064 7479 7065 290d 0a20 2020  wer, dtype)..   
+00004260: 2075 7070 6572 203d 206c 6178 2e63 6f6e   upper = lax.con
+00004270: 7665 7274 5f65 6c65 6d65 6e74 5f74 7970  vert_element_typ
+00004280: 6528 7570 7065 722c 2064 7479 7065 290d  e(upper, dtype).
+00004290: 0a20 2020 206c 6f63 203d 206c 6178 2e63  .    loc = lax.c
+000042a0: 6f6e 7665 7274 5f65 6c65 6d65 6e74 5f74  onvert_element_t
+000042b0: 7970 6528 6c6f 632c 2064 7479 7065 290d  ype(loc, dtype).
+000042c0: 0a20 2020 2073 6361 6c65 203d 206c 6178  .    scale = lax
+000042d0: 2e63 6f6e 7665 7274 5f65 6c65 6d65 6e74  .convert_element
+000042e0: 5f74 7970 6528 7363 616c 652c 2064 7479  _type(scale, dty
+000042f0: 7065 290d 0a0d 0a20 2020 206a 6974 5f65  pe)....    jit_e
+00004300: 7272 6f72 280d 0a20 2020 2020 206a 6e70  rror(..      jnp
+00004310: 2e61 6e79 286a 6e70 2e6c 6f67 6963 616c  .any(jnp.logical
+00004320: 5f6f 7228 6c6f 6320 3c20 6c6f 7765 7220  _or(loc < lower 
+00004330: 2d20 3220 2a20 7363 616c 652c 206c 6f63  - 2 * scale, loc
+00004340: 203e 2075 7070 6572 202b 2032 202a 2073   > upper + 2 * s
+00004350: 6361 6c65 2929 2c0d 0a20 2020 2020 2022  cale)),..      "
+00004360: 6d65 616e 2069 7320 6d6f 7265 2074 6861  mean is more tha
+00004370: 6e20 3220 7374 6420 6672 6f6d 205b 6c6f  n 2 std from [lo
+00004380: 7765 722c 2075 7070 6572 5d20 696e 2074  wer, upper] in t
+00004390: 7275 6e63 6174 6564 5f6e 6f72 6d61 6c2e  runcated_normal.
+000043a0: 2022 0d0a 2020 2020 2020 2254 6865 2064   "..      "The d
+000043b0: 6973 7472 6962 7574 696f 6e20 6f66 2076  istribution of v
+000043c0: 616c 7565 7320 6d61 7920 6265 2069 6e63  alues may be inc
+000043d0: 6f72 7265 6374 2e22 0d0a 2020 2020 290d  orrect."..    ).
+000043e0: 0a0d 0a20 2020 2069 6620 7369 7a65 2069  ...    if size i
+000043f0: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2073  s None:..      s
+00004400: 697a 6520 3d20 6c61 782e 6272 6f61 6463  ize = lax.broadc
+00004410: 6173 745f 7368 6170 6573 286a 6e70 2e73  ast_shapes(jnp.s
+00004420: 6861 7065 286c 6f77 6572 292c 0d0a 2020  hape(lower),..  
+00004430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004450: 6a6e 702e 7368 6170 6528 7570 7065 7229  jnp.shape(upper)
+00004460: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00004470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004480: 2020 2020 206a 6e70 2e73 6861 7065 286c       jnp.shape(l
+00004490: 6f63 292c 0d0a 2020 2020 2020 2020 2020  oc),..          
+000044a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000044b0: 2020 2020 2020 2020 6a6e 702e 7368 6170          jnp.shap
+000044c0: 6528 7363 616c 6529 290d 0a0d 0a20 2020  e(scale))....   
+000044d0: 2023 2056 616c 7565 7320 6172 6520 6765   # Values are ge
+000044e0: 6e65 7261 7465 6420 6279 2075 7369 6e67  nerated by using
+000044f0: 2061 2074 7275 6e63 6174 6564 2075 6e69   a truncated uni
+00004500: 666f 726d 2064 6973 7472 6962 7574 696f  form distributio
+00004510: 6e20 616e 640d 0a20 2020 2023 2074 6865  n and..    # the
+00004520: 6e20 7573 696e 6720 7468 6520 696e 7665  n using the inve
+00004530: 7273 6520 4344 4620 666f 7220 7468 6520  rse CDF for the 
+00004540: 6e6f 726d 616c 2064 6973 7472 6962 7574  normal distribut
+00004550: 696f 6e2e 0d0a 2020 2020 2320 4765 7420  ion...    # Get 
+00004560: 7570 7065 7220 616e 6420 6c6f 7765 7220  upper and lower 
+00004570: 6364 6620 7661 6c75 6573 0d0a 2020 2020  cdf values..    
+00004580: 7371 7274 3220 3d20 6e70 2e61 7272 6179  sqrt2 = np.array
+00004590: 286e 702e 7371 7274 2832 292c 2064 7479  (np.sqrt(2), dty
+000045a0: 7065 290d 0a20 2020 206c 203d 2073 656c  pe)..    l = sel
+000045b0: 662e 5f5f 6e6f 726d 5f63 6466 2828 6c6f  f.__norm_cdf((lo
+000045c0: 7765 7220 2d20 6c6f 6329 202f 2073 6361  wer - loc) / sca
+000045d0: 6c65 2c20 7371 7274 322c 2064 7479 7065  le, sqrt2, dtype
+000045e0: 290d 0a20 2020 2075 203d 2073 656c 662e  )..    u = self.
+000045f0: 5f5f 6e6f 726d 5f63 6466 2828 7570 7065  __norm_cdf((uppe
+00004600: 7220 2d20 6c6f 6329 202f 2073 6361 6c65  r - loc) / scale
+00004610: 2c20 7371 7274 322c 2064 7479 7065 290d  , sqrt2, dtype).
+00004620: 0a0d 0a20 2020 2023 2055 6e69 666f 726d  ...    # Uniform
+00004630: 6c79 2066 696c 6c20 7465 6e73 6f72 2077  ly fill tensor w
+00004640: 6974 6820 7661 6c75 6573 2066 726f 6d20  ith values from 
+00004650: 5b6c 2c20 755d 2c20 7468 656e 2074 7261  [l, u], then tra
+00004660: 6e73 6c61 7465 2074 6f0d 0a20 2020 2023  nslate to..    #
+00004670: 205b 326c 2d31 2c20 3275 2d31 5d2e 0d0a   [2l-1, 2u-1]...
+00004680: 2020 2020 6b65 7920 3d20 7365 6c66 2e73      key = self.s
+00004690: 706c 6974 5f6b 6579 2829 2069 6620 6b65  plit_key() if ke
+000046a0: 7920 6973 204e 6f6e 6520 656c 7365 205f  y is None else _
+000046b0: 666f 726d 616c 697a 655f 6b65 7928 6b65  formalize_key(ke
+000046c0: 7929 0d0a 2020 2020 6f75 7420 3d20 6a72  y)..    out = jr
+000046d0: 2e75 6e69 666f 726d 286b 6579 2c20 7369  .uniform(key, si
+000046e0: 7a65 2c20 6474 7970 652c 0d0a 2020 2020  ze, dtype,..    
+000046f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004700: 206d 696e 7661 6c3d 6c61 782e 6e65 7874   minval=lax.next
+00004710: 6166 7465 7228 3220 2a20 6c20 2d20 312c  after(2 * l - 1,
+00004720: 206e 702e 6172 7261 7928 6e70 2e69 6e66   np.array(np.inf
+00004730: 2c20 6474 7970 653d 6474 7970 6529 292c  , dtype=dtype)),
+00004740: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00004750: 2020 2020 2020 206d 6178 7661 6c3d 6c61         maxval=la
+00004760: 782e 6e65 7874 6166 7465 7228 3220 2a20  x.nextafter(2 * 
+00004770: 7520 2d20 312c 206e 702e 6172 7261 7928  u - 1, np.array(
+00004780: 2d6e 702e 696e 662c 2064 7479 7065 3d64  -np.inf, dtype=d
+00004790: 7479 7065 2929 290d 0a0d 0a20 2020 2023  type)))....    #
+000047a0: 2055 7365 2069 6e76 6572 7365 2063 6466   Use inverse cdf
+000047b0: 2074 7261 6e73 666f 726d 2066 6f72 206e   transform for n
+000047c0: 6f72 6d61 6c20 6469 7374 7269 6275 7469  ormal distributi
+000047d0: 6f6e 2074 6f20 6765 7420 7472 756e 6361  on to get trunca
+000047e0: 7465 640d 0a20 2020 2023 2073 7461 6e64  ted..    # stand
+000047f0: 6172 6420 6e6f 726d 616c 0d0a 2020 2020  ard normal..    
+00004800: 6f75 7420 3d20 6c61 782e 6572 665f 696e  out = lax.erf_in
+00004810: 7628 6f75 7429 0d0a 0d0a 2020 2020 2320  v(out)....    # 
+00004820: 5472 616e 7366 6f72 6d20 746f 2070 726f  Transform to pro
+00004830: 7065 7220 6d65 616e 2c20 7374 640d 0a20  per mean, std.. 
+00004840: 2020 206f 7574 203d 206f 7574 202a 2073     out = out * s
+00004850: 6361 6c65 202a 2073 7172 7432 202b 206c  cale * sqrt2 + l
+00004860: 6f63 0d0a 0d0a 2020 2020 2320 436c 616d  oc....    # Clam
+00004870: 7020 746f 2065 6e73 7572 6520 6974 2773  p to ensure it's
+00004880: 2069 6e20 7468 6520 7072 6f70 6572 2072   in the proper r
+00004890: 616e 6765 0d0a 2020 2020 6f75 7420 3d20  ange..    out = 
+000048a0: 6a6e 702e 636c 6970 286f 7574 2c0d 0a20  jnp.clip(out,.. 
+000048b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000048c0: 2020 6c61 782e 6e65 7874 6166 7465 7228    lax.nextafter(
+000048d0: 6c61 782e 7374 6f70 5f67 7261 6469 656e  lax.stop_gradien
+000048e0: 7428 6c6f 7765 7229 2c20 6e70 2e61 7272  t(lower), np.arr
+000048f0: 6179 286e 702e 696e 662c 2064 7479 7065  ay(np.inf, dtype
+00004900: 3d64 7479 7065 2929 2c0d 0a20 2020 2020  =dtype)),..     
+00004910: 2020 2020 2020 2020 2020 2020 2020 6c61                la
+00004920: 782e 6e65 7874 6166 7465 7228 6c61 782e  x.nextafter(lax.
+00004930: 7374 6f70 5f67 7261 6469 656e 7428 7570  stop_gradient(up
+00004940: 7065 7229 2c20 6e70 2e61 7272 6179 282d  per), np.array(-
+00004950: 6e70 2e69 6e66 2c20 6474 7970 653d 6474  np.inf, dtype=dt
+00004960: 7970 6529 2929 0d0a 2020 2020 7265 7475  ype)))..    retu
+00004970: 726e 206f 7574 0d0a 0d0a 2020 6465 6620  rn out....  def 
+00004980: 5f63 6865 636b 5f70 2873 656c 662c 2070  _check_p(self, p
+00004990: 293a 0d0a 2020 2020 7261 6973 6520 5661  ):..    raise Va
+000049a0: 6c75 6545 7272 6f72 2866 2750 6172 616d  lueError(f'Param
+000049b0: 6574 6572 2070 2073 686f 756c 6420 6265  eter p should be
+000049c0: 2077 6974 6869 6e20 5b30 2c20 315d 2c20   within [0, 1], 
+000049d0: 6275 7420 7765 2067 6f74 207b 707d 2729  but we got {p}')
+000049e0: 0d0a 0d0a 2020 6465 6620 6265 726e 6f75  ....  def bernou
+000049f0: 6c6c 6928 7365 6c66 2c0d 0a20 2020 2020  lli(self,..     
+00004a00: 2020 2020 2020 2020 2020 2070 2c0d 0a20             p,.. 
+00004a10: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00004a20: 697a 653a 204f 7074 696f 6e61 6c5b 5369  ize: Optional[Si
+00004a30: 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ze] = None,..   
+00004a40: 2020 2020 2020 2020 2020 2020 206b 6579               key
+00004a50: 3a20 4f70 7469 6f6e 616c 5b53 6565 644f  : Optional[SeedO
+00004a60: 724b 6579 5d20 3d20 4e6f 6e65 293a 0d0a  rKey] = None):..
+00004a70: 2020 2020 7020 3d20 5f63 6865 636b 5f70      p = _check_p
+00004a80: 795f 7365 7128 7029 0d0a 2020 2020 6a69  y_seq(p)..    ji
+00004a90: 745f 6572 726f 7228 6a6e 702e 616e 7928  t_error(jnp.any(
+00004aa0: 6a6e 702e 6c6f 6769 6361 6c5f 616e 6428  jnp.logical_and(
+00004ab0: 7020 3c20 302c 2070 203e 2031 2929 2c20  p < 0, p > 1)), 
+00004ac0: 7365 6c66 2e5f 6368 6563 6b5f 702c 2070  self._check_p, p
+00004ad0: 290d 0a20 2020 2069 6620 7369 7a65 2069  )..    if size i
+00004ae0: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2073  s None:..      s
+00004af0: 697a 6520 3d20 6a6e 702e 7368 6170 6528  ize = jnp.shape(
+00004b00: 7029 0d0a 2020 2020 6b65 7920 3d20 7365  p)..    key = se
+00004b10: 6c66 2e73 706c 6974 5f6b 6579 2829 2069  lf.split_key() i
+00004b20: 6620 6b65 7920 6973 204e 6f6e 6520 656c  f key is None el
+00004b30: 7365 205f 666f 726d 616c 697a 655f 6b65  se _formalize_ke
+00004b40: 7928 6b65 7929 0d0a 2020 2020 7220 3d20  y(key)..    r = 
+00004b50: 6a72 2e62 6572 6e6f 756c 6c69 286b 6579  jr.bernoulli(key
+00004b60: 2c20 703d 702c 2073 6861 7065 3d5f 7369  , p=p, shape=_si
+00004b70: 7a65 3273 6861 7065 2873 697a 6529 290d  ze2shape(size)).
+00004b80: 0a20 2020 2072 6574 7572 6e20 720d 0a0d  .    return r...
+00004b90: 0a20 2064 6566 206c 6f67 6e6f 726d 616c  .  def lognormal
+00004ba0: 2873 656c 662c 0d0a 2020 2020 2020 2020  (self,..        
+00004bb0: 2020 2020 2020 2020 6d65 616e 3d4e 6f6e          mean=Non
+00004bc0: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+00004bd0: 2020 2020 7369 676d 613d 4e6f 6e65 2c0d      sigma=None,.
+00004be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004bf0: 2073 697a 653a 204f 7074 696f 6e61 6c5b   size: Optional[
+00004c00: 5369 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20  Size] = None,.. 
+00004c10: 2020 2020 2020 2020 2020 2020 2020 206b                 k
+00004c20: 6579 3a20 4f70 7469 6f6e 616c 5b53 6565  ey: Optional[See
+00004c30: 644f 724b 6579 5d20 3d20 4e6f 6e65 2c0d  dOrKey] = None,.
+00004c40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004c50: 2064 7479 7065 3a20 4454 7970 654c 696b   dtype: DTypeLik
+00004c60: 6520 3d20 4e6f 6e65 293a 0d0a 2020 2020  e = None):..    
+00004c70: 6d65 616e 203d 205f 6368 6563 6b5f 7079  mean = _check_py
+00004c80: 5f73 6571 286d 6561 6e29 0d0a 2020 2020  _seq(mean)..    
+00004c90: 7369 676d 6120 3d20 5f63 6865 636b 5f70  sigma = _check_p
+00004ca0: 795f 7365 7128 7369 676d 6129 0d0a 2020  y_seq(sigma)..  
+00004cb0: 2020 6966 2073 697a 6520 6973 204e 6f6e    if size is Non
+00004cc0: 653a 0d0a 2020 2020 2020 7369 7a65 203d  e:..      size =
+00004cd0: 206a 6e70 2e62 726f 6164 6361 7374 5f73   jnp.broadcast_s
+00004ce0: 6861 7065 7328 6a6e 702e 7368 6170 6528  hapes(jnp.shape(
+00004cf0: 6d65 616e 292c 0d0a 2020 2020 2020 2020  mean),..        
+00004d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004d10: 2020 2020 2020 2020 2020 6a6e 702e 7368            jnp.sh
+00004d20: 6170 6528 7369 676d 6129 290d 0a20 2020  ape(sigma))..   
+00004d30: 206b 6579 203d 2073 656c 662e 7370 6c69   key = self.spli
+00004d40: 745f 6b65 7928 2920 6966 206b 6579 2069  t_key() if key i
+00004d50: 7320 4e6f 6e65 2065 6c73 6520 5f66 6f72  s None else _for
+00004d60: 6d61 6c69 7a65 5f6b 6579 286b 6579 290d  malize_key(key).
+00004d70: 0a20 2020 2064 7479 7065 203d 2064 7479  .    dtype = dty
+00004d80: 7065 206f 7220 656e 7669 726f 6e2e 6466  pe or environ.df
+00004d90: 7479 7065 2829 0d0a 2020 2020 7361 6d70  type()..    samp
+00004da0: 6c65 7320 3d20 6a72 2e6e 6f72 6d61 6c28  les = jr.normal(
+00004db0: 6b65 792c 2073 6861 7065 3d5f 7369 7a65  key, shape=_size
+00004dc0: 3273 6861 7065 2873 697a 6529 2c20 6474  2shape(size), dt
+00004dd0: 7970 653d 6474 7970 6529 0d0a 2020 2020  ype=dtype)..    
+00004de0: 7361 6d70 6c65 7320 3d20 5f6c 6f63 5f73  samples = _loc_s
+00004df0: 6361 6c65 286d 6561 6e2c 2073 6967 6d61  cale(mean, sigma
+00004e00: 2c20 7361 6d70 6c65 7329 0d0a 2020 2020  , samples)..    
+00004e10: 7361 6d70 6c65 7320 3d20 6a6e 702e 6578  samples = jnp.ex
+00004e20: 7028 7361 6d70 6c65 7329 0d0a 2020 2020  p(samples)..    
+00004e30: 7265 7475 726e 2073 616d 706c 6573 0d0a  return samples..
+00004e40: 0d0a 2020 6465 6620 6269 6e6f 6d69 616c  ..  def binomial
+00004e50: 2873 656c 662c 0d0a 2020 2020 2020 2020  (self,..        
+00004e60: 2020 2020 2020 206e 2c0d 0a20 2020 2020         n,..     
+00004e70: 2020 2020 2020 2020 2020 702c 0d0a 2020            p,..  
+00004e80: 2020 2020 2020 2020 2020 2020 2073 697a               siz
+00004e90: 653a 204f 7074 696f 6e61 6c5b 5369 7a65  e: Optional[Size
+00004ea0: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2020  ] = None,..     
+00004eb0: 2020 2020 2020 2020 2020 6b65 793a 204f            key: O
+00004ec0: 7074 696f 6e61 6c5b 5365 6564 4f72 4b65  ptional[SeedOrKe
+00004ed0: 795d 203d 204e 6f6e 652c 0d0a 2020 2020  y] = None,..    
+00004ee0: 2020 2020 2020 2020 2020 2064 7479 7065             dtype
+00004ef0: 3a20 4454 7970 654c 696b 6520 3d20 4e6f  : DTypeLike = No
+00004f00: 6e65 293a 0d0a 2020 2020 6e20 3d20 5f63  ne):..    n = _c
+00004f10: 6865 636b 5f70 795f 7365 7128 6e29 0d0a  heck_py_seq(n)..
+00004f20: 2020 2020 7020 3d20 5f63 6865 636b 5f70      p = _check_p
+00004f30: 795f 7365 7128 7029 0d0a 2020 2020 6a69  y_seq(p)..    ji
+00004f40: 745f 6572 726f 7228 6a6e 702e 616e 7928  t_error(jnp.any(
+00004f50: 6a6e 702e 6c6f 6769 6361 6c5f 616e 6428  jnp.logical_and(
+00004f60: 7020 3c20 302c 2070 203e 2031 2929 2c20  p < 0, p > 1)), 
+00004f70: 7365 6c66 2e5f 6368 6563 6b5f 702c 2070  self._check_p, p
+00004f80: 290d 0a20 2020 2069 6620 7369 7a65 2069  )..    if size i
+00004f90: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2073  s None:..      s
+00004fa0: 697a 6520 3d20 6a6e 702e 6272 6f61 6463  ize = jnp.broadc
+00004fb0: 6173 745f 7368 6170 6573 286a 6e70 2e73  ast_shapes(jnp.s
+00004fc0: 6861 7065 286e 292c 206a 6e70 2e73 6861  hape(n), jnp.sha
+00004fd0: 7065 2870 2929 0d0a 2020 2020 6b65 7920  pe(p))..    key 
+00004fe0: 3d20 7365 6c66 2e73 706c 6974 5f6b 6579  = self.split_key
+00004ff0: 2829 2069 6620 6b65 7920 6973 204e 6f6e  () if key is Non
+00005000: 6520 656c 7365 205f 666f 726d 616c 697a  e else _formaliz
+00005010: 655f 6b65 7928 6b65 7929 0d0a 2020 2020  e_key(key)..    
+00005020: 7220 3d20 5f62 696e 6f6d 6961 6c28 6b65  r = _binomial(ke
+00005030: 792c 2070 2c20 6e2c 2073 6861 7065 3d5f  y, p, n, shape=_
+00005040: 7369 7a65 3273 6861 7065 2873 697a 6529  size2shape(size)
+00005050: 290d 0a20 2020 2064 7479 7065 203d 2064  )..    dtype = d
+00005060: 7479 7065 206f 7220 656e 7669 726f 6e2e  type or environ.
+00005070: 6469 7479 7065 2829 0d0a 2020 2020 7265  ditype()..    re
+00005080: 7475 726e 206a 6e70 2e61 7361 7272 6179  turn jnp.asarray
+00005090: 2872 2c20 6474 7970 653d 6474 7970 6529  (r, dtype=dtype)
+000050a0: 0d0a 0d0a 2020 6465 6620 6368 6973 7175  ....  def chisqu
+000050b0: 6172 6528 7365 6c66 2c0d 0a20 2020 2020  are(self,..     
+000050c0: 2020 2020 2020 2020 2020 2064 662c 0d0a             df,..
+000050d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000050e0: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b53  size: Optional[S
+000050f0: 697a 655d 203d 204e 6f6e 652c 0d0a 2020  ize] = None,..  
+00005100: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
+00005110: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
+00005120: 4f72 4b65 795d 203d 204e 6f6e 652c 0d0a  OrKey] = None,..
+00005130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005140: 6474 7970 653a 2044 5479 7065 4c69 6b65  dtype: DTypeLike
+00005150: 203d 204e 6f6e 6529 3a0d 0a20 2020 2064   = None):..    d
+00005160: 6620 3d20 5f63 6865 636b 5f70 795f 7365  f = _check_py_se
+00005170: 7128 6466 290d 0a20 2020 206b 6579 203d  q(df)..    key =
+00005180: 2073 656c 662e 7370 6c69 745f 6b65 7928   self.split_key(
+00005190: 2920 6966 206b 6579 2069 7320 4e6f 6e65  ) if key is None
+000051a0: 2065 6c73 6520 5f66 6f72 6d61 6c69 7a65   else _formalize
+000051b0: 5f6b 6579 286b 6579 290d 0a20 2020 2064  _key(key)..    d
+000051c0: 7479 7065 203d 2064 7479 7065 206f 7220  type = dtype or 
+000051d0: 656e 7669 726f 6e2e 6466 7479 7065 2829  environ.dftype()
+000051e0: 0d0a 2020 2020 6966 2073 697a 6520 6973  ..    if size is
+000051f0: 204e 6f6e 653a 0d0a 2020 2020 2020 6966   None:..      if
+00005200: 206a 6e70 2e6e 6469 6d28 6466 2920 3d3d   jnp.ndim(df) ==
+00005210: 2030 3a0d 0a20 2020 2020 2020 2064 6973   0:..        dis
+00005220: 7420 3d20 6a72 2e6e 6f72 6d61 6c28 6b65  t = jr.normal(ke
+00005230: 792c 2028 6466 2c29 2c20 6474 7970 653d  y, (df,), dtype=
+00005240: 6474 7970 6529 202a 2a20 320d 0a20 2020  dtype) ** 2..   
+00005250: 2020 2020 2064 6973 7420 3d20 6469 7374       dist = dist
+00005260: 2e73 756d 2829 0d0a 2020 2020 2020 656c  .sum()..      el
+00005270: 7365 3a0d 0a20 2020 2020 2020 2072 6169  se:..        rai
+00005280: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+00005290: 6445 7272 6f72 2827 446f 206e 6f74 2073  dError('Do not s
+000052a0: 7570 706f 7274 206e 6f6e 2d73 6361 6c65  upport non-scale
+000052b0: 2022 6466 2220 7768 656e 2022 7369 7a65   "df" when "size
+000052c0: 2220 6973 204e 6f6e 6527 290d 0a20 2020  " is None')..   
+000052d0: 2065 6c73 653a 0d0a 2020 2020 2020 6469   else:..      di
+000052e0: 7374 203d 206a 722e 6e6f 726d 616c 286b  st = jr.normal(k
+000052f0: 6579 2c20 2864 662c 2920 2b20 5f73 697a  ey, (df,) + _siz
+00005300: 6532 7368 6170 6528 7369 7a65 292c 2064  e2shape(size), d
+00005310: 7479 7065 3d64 7479 7065 2920 2a2a 2032  type=dtype) ** 2
+00005320: 0d0a 2020 2020 2020 6469 7374 203d 2064  ..      dist = d
+00005330: 6973 742e 7375 6d28 6178 6973 3d30 290d  ist.sum(axis=0).
+00005340: 0a20 2020 2072 6574 7572 6e20 6469 7374  .    return dist
+00005350: 0d0a 0d0a 2020 6465 6620 6469 7269 6368  ....  def dirich
+00005360: 6c65 7428 7365 6c66 2c0d 0a20 2020 2020  let(self,..     
+00005370: 2020 2020 2020 2020 2020 2061 6c70 6861             alpha
+00005380: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00005390: 2020 2073 697a 653a 204f 7074 696f 6e61     size: Optiona
+000053a0: 6c5b 5369 7a65 5d20 3d20 4e6f 6e65 2c0d  l[Size] = None,.
+000053b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000053c0: 206b 6579 3a20 4f70 7469 6f6e 616c 5b53   key: Optional[S
+000053d0: 6565 644f 724b 6579 5d20 3d20 4e6f 6e65  eedOrKey] = None
+000053e0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000053f0: 2020 2064 7479 7065 3a20 4454 7970 654c     dtype: DTypeL
+00005400: 696b 6520 3d20 4e6f 6e65 293a 0d0a 2020  ike = None):..  
+00005410: 2020 6b65 7920 3d20 7365 6c66 2e73 706c    key = self.spl
+00005420: 6974 5f6b 6579 2829 2069 6620 6b65 7920  it_key() if key 
+00005430: 6973 204e 6f6e 6520 656c 7365 205f 666f  is None else _fo
+00005440: 726d 616c 697a 655f 6b65 7928 6b65 7929  rmalize_key(key)
+00005450: 0d0a 2020 2020 616c 7068 6120 3d20 5f63  ..    alpha = _c
+00005460: 6865 636b 5f70 795f 7365 7128 616c 7068  heck_py_seq(alph
+00005470: 6129 0d0a 2020 2020 6474 7970 6520 3d20  a)..    dtype = 
+00005480: 6474 7970 6520 6f72 2065 6e76 6972 6f6e  dtype or environ
+00005490: 2e64 6674 7970 6528 290d 0a20 2020 2072  .dftype()..    r
+000054a0: 203d 206a 722e 6469 7269 6368 6c65 7428   = jr.dirichlet(
+000054b0: 6b65 792c 2061 6c70 6861 3d61 6c70 6861  key, alpha=alpha
+000054c0: 2c20 7368 6170 653d 5f73 697a 6532 7368  , shape=_size2sh
+000054d0: 6170 6528 7369 7a65 292c 2064 7479 7065  ape(size), dtype
+000054e0: 3d64 7479 7065 290d 0a20 2020 2072 6574  =dtype)..    ret
+000054f0: 7572 6e20 720d 0a0d 0a20 2064 6566 2067  urn r....  def g
+00005500: 656f 6d65 7472 6963 2873 656c 662c 0d0a  eometric(self,..
+00005510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005520: 702c 0d0a 2020 2020 2020 2020 2020 2020  p,..            
+00005530: 2020 2020 7369 7a65 3a20 4f70 7469 6f6e      size: Option
+00005540: 616c 5b53 697a 655d 203d 204e 6f6e 652c  al[Size] = None,
+00005550: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00005560: 2020 6b65 793a 204f 7074 696f 6e61 6c5b    key: Optional[
+00005570: 5365 6564 4f72 4b65 795d 203d 204e 6f6e  SeedOrKey] = Non
+00005580: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+00005590: 2020 2020 6474 7970 653a 2044 5479 7065      dtype: DType
+000055a0: 4c69 6b65 203d 204e 6f6e 6529 3a0d 0a20  Like = None):.. 
+000055b0: 2020 2070 203d 205f 6368 6563 6b5f 7079     p = _check_py
+000055c0: 5f73 6571 2870 290d 0a20 2020 2069 6620  _seq(p)..    if 
+000055d0: 7369 7a65 2069 7320 4e6f 6e65 3a0d 0a20  size is None:.. 
+000055e0: 2020 2020 2073 697a 6520 3d20 6a6e 702e       size = jnp.
+000055f0: 7368 6170 6528 7029 0d0a 2020 2020 6b65  shape(p)..    ke
+00005600: 7920 3d20 7365 6c66 2e73 706c 6974 5f6b  y = self.split_k
+00005610: 6579 2829 2069 6620 6b65 7920 6973 204e  ey() if key is N
+00005620: 6f6e 6520 656c 7365 205f 666f 726d 616c  one else _formal
+00005630: 697a 655f 6b65 7928 6b65 7929 0d0a 2020  ize_key(key)..  
+00005640: 2020 6474 7970 6520 3d20 6474 7970 6520    dtype = dtype 
+00005650: 6f72 2065 6e76 6972 6f6e 2e64 6674 7970  or environ.dftyp
+00005660: 6528 290d 0a20 2020 2075 203d 206a 722e  e()..    u = jr.
+00005670: 756e 6966 6f72 6d28 6b65 792c 2073 697a  uniform(key, siz
+00005680: 652c 2064 7479 7065 3d64 7479 7065 290d  e, dtype=dtype).
+00005690: 0a20 2020 2072 203d 206a 6e70 2e66 6c6f  .    r = jnp.flo
+000056a0: 6f72 286a 6e70 2e6c 6f67 3170 282d 7529  or(jnp.log1p(-u)
+000056b0: 202f 206a 6e70 2e6c 6f67 3170 282d 7029   / jnp.log1p(-p)
+000056c0: 290d 0a20 2020 2072 6574 7572 6e20 720d  )..    return r.
+000056d0: 0a0d 0a20 2064 6566 205f 6368 6563 6b5f  ...  def _check_
+000056e0: 7032 2873 656c 662c 2070 293a 0d0a 2020  p2(self, p):..  
+000056f0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00005700: 6f72 2866 2757 6520 7265 7175 6972 6520  or(f'We require 
+00005710: 6073 756d 2870 7661 6c73 5b3a 2d31 5d29  `sum(pvals[:-1])
+00005720: 203c 3d20 3160 2e20 4275 7420 7765 2067   <= 1`. But we g
+00005730: 6f74 207b 707d 2729 0d0a 0d0a 2020 6465  ot {p}')....  de
+00005740: 6620 6d75 6c74 696e 6f6d 6961 6c28 7365  f multinomial(se
+00005750: 6c66 2c0d 0a20 2020 2020 2020 2020 2020  lf,..           
+00005760: 2020 2020 2020 206e 2c0d 0a20 2020 2020         n,..     
+00005770: 2020 2020 2020 2020 2020 2020 2070 7661               pva
+00005780: 6c73 2c0d 0a20 2020 2020 2020 2020 2020  ls,..           
+00005790: 2020 2020 2020 2073 697a 653a 204f 7074         size: Opt
+000057a0: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
+000057b0: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
+000057c0: 2020 2020 2020 206b 6579 3a20 4f70 7469         key: Opti
+000057d0: 6f6e 616c 5b53 6565 644f 724b 6579 5d20  onal[SeedOrKey] 
+000057e0: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 2020  = None,..       
+000057f0: 2020 2020 2020 2020 2020 2064 7479 7065             dtype
+00005800: 3a20 4454 7970 654c 696b 6520 3d20 4e6f  : DTypeLike = No
+00005810: 6e65 293a 0d0a 2020 2020 6b65 7920 3d20  ne):..    key = 
+00005820: 7365 6c66 2e73 706c 6974 5f6b 6579 2829  self.split_key()
+00005830: 2069 6620 6b65 7920 6973 204e 6f6e 6520   if key is None 
+00005840: 656c 7365 205f 666f 726d 616c 697a 655f  else _formalize_
+00005850: 6b65 7928 6b65 7929 0d0a 2020 2020 6e20  key(key)..    n 
+00005860: 3d20 5f63 6865 636b 5f70 795f 7365 7128  = _check_py_seq(
+00005870: 6e29 0d0a 2020 2020 7076 616c 7320 3d20  n)..    pvals = 
+00005880: 5f63 6865 636b 5f70 795f 7365 7128 7076  _check_py_seq(pv
+00005890: 616c 7329 0d0a 2020 2020 6a69 745f 6572  als)..    jit_er
+000058a0: 726f 7228 6a6e 702e 7375 6d28 7076 616c  ror(jnp.sum(pval
+000058b0: 735b 3a2d 315d 2920 3e20 312e 2c20 7365  s[:-1]) > 1., se
+000058c0: 6c66 2e5f 6368 6563 6b5f 7032 2c20 7076  lf._check_p2, pv
+000058d0: 616c 7329 0d0a 2020 2020 6966 2069 7369  als)..    if isi
+000058e0: 6e73 7461 6e63 6528 6e2c 206a 6178 2e63  nstance(n, jax.c
+000058f0: 6f72 652e 5472 6163 6572 293a 0d0a 2020  ore.Tracer):..  
+00005900: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00005910: 7272 6f72 2822 5468 6520 746f 7461 6c20  rror("The total 
+00005920: 636f 756e 7420 7061 7261 6d65 7465 7220  count parameter 
+00005930: 606e 6020 7368 6f75 6c64 206e 6f74 2062  `n` should not b
+00005940: 6520 6120 6a61 7820 6162 7374 7261 6374  e a jax abstract
+00005950: 2061 7272 6179 2e22 290d 0a20 2020 2073   array.")..    s
+00005960: 697a 6520 3d20 5f73 697a 6532 7368 6170  ize = _size2shap
+00005970: 6528 7369 7a65 290d 0a20 2020 206e 5f6d  e(size)..    n_m
+00005980: 6178 203d 2069 6e74 286e 702e 6d61 7828  ax = int(np.max(
+00005990: 6a61 782e 6465 7669 6365 5f67 6574 286e  jax.device_get(n
+000059a0: 2929 290d 0a20 2020 2062 6174 6368 5f73  )))..    batch_s
+000059b0: 6861 7065 203d 206c 6178 2e62 726f 6164  hape = lax.broad
+000059c0: 6361 7374 5f73 6861 7065 7328 6a6e 702e  cast_shapes(jnp.
+000059d0: 7368 6170 6528 7076 616c 7329 5b3a 2d31  shape(pvals)[:-1
+000059e0: 5d2c 206a 6e70 2e73 6861 7065 286e 2929  ], jnp.shape(n))
+000059f0: 0d0a 2020 2020 7220 3d20 5f6d 756c 7469  ..    r = _multi
+00005a00: 6e6f 6d69 616c 286b 6579 2c20 7076 616c  nomial(key, pval
+00005a10: 732c 206e 2c20 6e5f 6d61 782c 2062 6174  s, n, n_max, bat
+00005a20: 6368 5f73 6861 7065 202b 2073 697a 6529  ch_shape + size)
+00005a30: 0d0a 2020 2020 6474 7970 6520 3d20 6474  ..    dtype = dt
+00005a40: 7970 6520 6f72 2065 6e76 6972 6f6e 2e64  ype or environ.d
+00005a50: 6974 7970 6528 290d 0a20 2020 2072 6574  itype()..    ret
+00005a60: 7572 6e20 6a6e 702e 6173 6172 7261 7928  urn jnp.asarray(
+00005a70: 722c 2064 7479 7065 3d64 7479 7065 290d  r, dtype=dtype).
+00005a80: 0a0d 0a20 2064 6566 206d 756c 7469 7661  ...  def multiva
+00005a90: 7269 6174 655f 6e6f 726d 616c 2873 656c  riate_normal(sel
+00005aa0: 662c 0d0a 2020 2020 2020 2020 2020 2020  f,..            
+00005ab0: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+00005ac0: 616e 2c0d 0a20 2020 2020 2020 2020 2020  an,..           
+00005ad0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00005ae0: 6f76 2c0d 0a20 2020 2020 2020 2020 2020  ov,..           
+00005af0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00005b00: 697a 653a 204f 7074 696f 6e61 6c5b 5369  ize: Optional[Si
+00005b10: 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ze] = None,..   
+00005b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005b30: 2020 2020 2020 206d 6574 686f 643a 2073         method: s
+00005b40: 7472 203d 2027 6368 6f6c 6573 6b79 272c  tr = 'cholesky',
+00005b50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00005b60: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
+00005b70: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
+00005b80: 4b65 795d 203d 204e 6f6e 652c 0d0a 2020  Key] = None,..  
+00005b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ba0: 2020 2020 2020 2020 6474 7970 653a 2044          dtype: D
+00005bb0: 5479 7065 4c69 6b65 203d 204e 6f6e 6529  TypeLike = None)
+00005bc0: 3a0d 0a20 2020 2069 6620 6d65 7468 6f64  :..    if method
+00005bd0: 206e 6f74 2069 6e20 7b27 7376 6427 2c20   not in {'svd', 
+00005be0: 2765 6967 6827 2c20 2763 686f 6c65 736b  'eigh', 'cholesk
+00005bf0: 7927 7d3a 0d0a 2020 2020 2020 7261 6973  y'}:..      rais
+00005c00: 6520 5661 6c75 6545 7272 6f72 2822 6d65  e ValueError("me
+00005c10: 7468 6f64 206d 7573 7420 6265 206f 6e65  thod must be one
+00005c20: 206f 6620 7b27 7376 6427 2c20 2765 6967   of {'svd', 'eig
+00005c30: 6827 2c20 2763 686f 6c65 736b 7927 7d22  h', 'cholesky'}"
+00005c40: 290d 0a20 2020 2064 7479 7065 203d 2064  )..    dtype = d
+00005c50: 7479 7065 206f 7220 656e 7669 726f 6e2e  type or environ.
+00005c60: 6466 7479 7065 2829 0d0a 2020 2020 6d65  dftype()..    me
+00005c70: 616e 203d 206a 6e70 2e61 7361 7272 6179  an = jnp.asarray
+00005c80: 285f 6368 6563 6b5f 7079 5f73 6571 286d  (_check_py_seq(m
+00005c90: 6561 6e29 2c20 6474 7970 653d 6474 7970  ean), dtype=dtyp
+00005ca0: 6529 0d0a 2020 2020 636f 7620 3d20 6a6e  e)..    cov = jn
+00005cb0: 702e 6173 6172 7261 7928 5f63 6865 636b  p.asarray(_check
+00005cc0: 5f70 795f 7365 7128 636f 7629 2c20 6474  _py_seq(cov), dt
+00005cd0: 7970 653d 6474 7970 6529 0d0a 2020 2020  ype=dtype)..    
+00005ce0: 6b65 7920 3d20 7365 6c66 2e73 706c 6974  key = self.split
+00005cf0: 5f6b 6579 2829 2069 6620 6b65 7920 6973  _key() if key is
+00005d00: 204e 6f6e 6520 656c 7365 205f 666f 726d   None else _form
+00005d10: 616c 697a 655f 6b65 7928 6b65 7929 0d0a  alize_key(key)..
+00005d20: 0d0a 2020 2020 6966 206e 6f74 206a 6e70  ..    if not jnp
+00005d30: 2e6e 6469 6d28 6d65 616e 2920 3e3d 2031  .ndim(mean) >= 1
+00005d40: 3a0d 0a20 2020 2020 2072 6169 7365 2056  :..      raise V
+00005d50: 616c 7565 4572 726f 7228 6622 6d75 6c74  alueError(f"mult
+00005d60: 6976 6172 6961 7465 5f6e 6f72 6d61 6c20  ivariate_normal 
+00005d70: 7265 7175 6972 6573 206d 6561 6e2e 6e64  requires mean.nd
+00005d80: 696d 203e 3d20 312c 2067 6f74 206d 6561  im >= 1, got mea
+00005d90: 6e2e 6e64 696d 203d 3d20 7b6a 6e70 2e6e  n.ndim == {jnp.n
+00005da0: 6469 6d28 6d65 616e 297d 2229 0d0a 2020  dim(mean)}")..  
+00005db0: 2020 6966 206e 6f74 206a 6e70 2e6e 6469    if not jnp.ndi
+00005dc0: 6d28 636f 7629 203e 3d20 323a 0d0a 2020  m(cov) >= 2:..  
+00005dd0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00005de0: 7272 6f72 2866 226d 756c 7469 7661 7269  rror(f"multivari
+00005df0: 6174 655f 6e6f 726d 616c 2072 6571 7569  ate_normal requi
+00005e00: 7265 7320 636f 762e 6e64 696d 203e 3d20  res cov.ndim >= 
+00005e10: 322c 2067 6f74 2063 6f76 2e6e 6469 6d20  2, got cov.ndim 
+00005e20: 3d3d 207b 6a6e 702e 6e64 696d 2863 6f76  == {jnp.ndim(cov
+00005e30: 297d 2229 0d0a 2020 2020 6e20 3d20 6d65  )}")..    n = me
+00005e40: 616e 2e73 6861 7065 5b2d 315d 0d0a 2020  an.shape[-1]..  
+00005e50: 2020 6966 206a 6e70 2e73 6861 7065 2863    if jnp.shape(c
+00005e60: 6f76 295b 2d32 3a5d 2021 3d20 286e 2c20  ov)[-2:] != (n, 
+00005e70: 6e29 3a0d 0a20 2020 2020 2072 6169 7365  n):..      raise
+00005e80: 2056 616c 7565 4572 726f 7228 6622 6d75   ValueError(f"mu
+00005e90: 6c74 6976 6172 6961 7465 5f6e 6f72 6d61  ltivariate_norma
+00005ea0: 6c20 7265 7175 6972 6573 2063 6f76 2e73  l requires cov.s
+00005eb0: 6861 7065 203d 3d20 282e 2e2e 2c20 6e2c  hape == (..., n,
+00005ec0: 206e 2920 666f 7220 6e3d 7b6e 7d2c 2022   n) for n={n}, "
+00005ed0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00005ee0: 2020 2020 2020 2020 2066 2262 7574 2067           f"but g
+00005ef0: 6f74 2063 6f76 2e73 6861 7065 203d 3d20  ot cov.shape == 
+00005f00: 7b6a 6e70 2e73 6861 7065 2863 6f76 297d  {jnp.shape(cov)}
+00005f10: 2e22 290d 0a20 2020 2069 6620 7369 7a65  .")..    if size
+00005f20: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
+00005f30: 2073 697a 6520 3d20 6c61 782e 6272 6f61   size = lax.broa
+00005f40: 6463 6173 745f 7368 6170 6573 286d 6561  dcast_shapes(mea
+00005f50: 6e2e 7368 6170 655b 3a2d 315d 2c20 636f  n.shape[:-1], co
+00005f60: 762e 7368 6170 655b 3a2d 325d 290d 0a20  v.shape[:-2]).. 
+00005f70: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00005f80: 7369 7a65 203d 205f 7369 7a65 3273 6861  size = _size2sha
+00005f90: 7065 2873 697a 6529 0d0a 2020 2020 2020  pe(size)..      
+00005fa0: 5f63 6865 636b 5f73 6861 7065 2822 6e6f  _check_shape("no
+00005fb0: 726d 616c 222c 2073 697a 652c 206d 6561  rmal", size, mea
+00005fc0: 6e2e 7368 6170 655b 3a2d 315d 2c20 636f  n.shape[:-1], co
+00005fd0: 762e 7368 6170 655b 3a2d 325d 290d 0a0d  v.shape[:-2])...
+00005fe0: 0a20 2020 2069 6620 6d65 7468 6f64 203d  .    if method =
+00005ff0: 3d20 2773 7664 273a 0d0a 2020 2020 2020  = 'svd':..      
+00006000: 2875 2c20 732c 205f 2920 3d20 6a6e 702e  (u, s, _) = jnp.
+00006010: 6c69 6e61 6c67 2e73 7664 2863 6f76 290d  linalg.svd(cov).
+00006020: 0a20 2020 2020 2066 6163 746f 7220 3d20  .      factor = 
+00006030: 7520 2a20 6a6e 702e 7371 7274 2873 5b2e  u * jnp.sqrt(s[.
+00006040: 2e2e 2c20 4e6f 6e65 2c20 3a5d 290d 0a20  .., None, :]).. 
+00006050: 2020 2065 6c69 6620 6d65 7468 6f64 203d     elif method =
+00006060: 3d20 2765 6967 6827 3a0d 0a20 2020 2020  = 'eigh':..     
+00006070: 2028 772c 2076 2920 3d20 6a6e 702e 6c69   (w, v) = jnp.li
+00006080: 6e61 6c67 2e65 6967 6828 636f 7629 0d0a  nalg.eigh(cov)..
+00006090: 2020 2020 2020 6661 6374 6f72 203d 2076        factor = v
+000060a0: 202a 206a 6e70 2e73 7172 7428 775b 2e2e   * jnp.sqrt(w[..
+000060b0: 2e2c 204e 6f6e 652c 203a 5d29 0d0a 2020  ., None, :])..  
+000060c0: 2020 656c 7365 3a20 2023 2027 6368 6f6c    else:  # 'chol
+000060d0: 6573 6b79 270d 0a20 2020 2020 2066 6163  esky'..      fac
+000060e0: 746f 7220 3d20 6a6e 702e 6c69 6e61 6c67  tor = jnp.linalg
+000060f0: 2e63 686f 6c65 736b 7928 636f 7629 0d0a  .cholesky(cov)..
+00006100: 2020 2020 6e6f 726d 616c 5f73 616d 706c      normal_sampl
+00006110: 6573 203d 206a 722e 6e6f 726d 616c 286b  es = jr.normal(k
+00006120: 6579 2c20 7369 7a65 202b 206d 6561 6e2e  ey, size + mean.
+00006130: 7368 6170 655b 2d31 3a5d 2c20 6474 7970  shape[-1:], dtyp
+00006140: 653d 6474 7970 6529 0d0a 2020 2020 7220  e=dtype)..    r 
+00006150: 3d20 6d65 616e 202b 206a 6e70 2e65 696e  = mean + jnp.ein
+00006160: 7375 6d28 272e 2e2e 696a 2c2e 2e2e 6a2d  sum('...ij,...j-
+00006170: 3e2e 2e2e 6927 2c20 6661 6374 6f72 2c20  >...i', factor, 
+00006180: 6e6f 726d 616c 5f73 616d 706c 6573 290d  normal_samples).
+00006190: 0a20 2020 2072 6574 7572 6e20 720d 0a0d  .    return r...
+000061a0: 0a20 2064 6566 2072 6179 6c65 6967 6828  .  def rayleigh(
+000061b0: 7365 6c66 2c0d 0a20 2020 2020 2020 2020  self,..         
+000061c0: 2020 2020 2020 7363 616c 653d 312e 302c        scale=1.0,
+000061d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000061e0: 2073 697a 653a 204f 7074 696f 6e61 6c5b   size: Optional[
+000061f0: 5369 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20  Size] = None,.. 
+00006200: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
+00006210: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
+00006220: 4f72 4b65 795d 203d 204e 6f6e 652c 0d0a  OrKey] = None,..
+00006230: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00006240: 7479 7065 3a20 4454 7970 654c 696b 6520  type: DTypeLike 
+00006250: 3d20 4e6f 6e65 293a 0d0a 2020 2020 7363  = None):..    sc
+00006260: 616c 6520 3d20 5f63 6865 636b 5f70 795f  ale = _check_py_
+00006270: 7365 7128 7363 616c 6529 0d0a 2020 2020  seq(scale)..    
+00006280: 6966 2073 697a 6520 6973 204e 6f6e 653a  if size is None:
+00006290: 0d0a 2020 2020 2020 7369 7a65 203d 206a  ..      size = j
+000062a0: 6e70 2e73 6861 7065 2873 6361 6c65 290d  np.shape(scale).
+000062b0: 0a20 2020 206b 6579 203d 2073 656c 662e  .    key = self.
+000062c0: 7370 6c69 745f 6b65 7928 2920 6966 206b  split_key() if k
+000062d0: 6579 2069 7320 4e6f 6e65 2065 6c73 6520  ey is None else 
+000062e0: 5f66 6f72 6d61 6c69 7a65 5f6b 6579 286b  _formalize_key(k
+000062f0: 6579 290d 0a20 2020 2064 7479 7065 203d  ey)..    dtype =
+00006300: 2064 7479 7065 206f 7220 656e 7669 726f   dtype or enviro
+00006310: 6e2e 6466 7479 7065 2829 0d0a 2020 2020  n.dftype()..    
+00006320: 7820 3d20 6a6e 702e 7371 7274 282d 322e  x = jnp.sqrt(-2.
+00006330: 202a 206a 6e70 2e6c 6f67 286a 722e 756e   * jnp.log(jr.un
+00006340: 6966 6f72 6d28 6b65 792c 2073 6861 7065  iform(key, shape
+00006350: 3d5f 7369 7a65 3273 6861 7065 2873 697a  =_size2shape(siz
+00006360: 6529 2c20 6d69 6e76 616c 3d30 2c20 6d61  e), minval=0, ma
+00006370: 7876 616c 3d31 2c20 6474 7970 653d 6474  xval=1, dtype=dt
+00006380: 7970 6529 2929 0d0a 2020 2020 7220 3d20  ype)))..    r = 
+00006390: 7820 2a20 7363 616c 650d 0a20 2020 2072  x * scale..    r
+000063a0: 6574 7572 6e20 720d 0a0d 0a20 2064 6566  eturn r....  def
+000063b0: 2074 7269 616e 6775 6c61 7228 7365 6c66   triangular(self
+000063c0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000063d0: 2020 2020 7369 7a65 3a20 4f70 7469 6f6e      size: Option
+000063e0: 616c 5b53 697a 655d 203d 204e 6f6e 652c  al[Size] = None,
+000063f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00006400: 2020 206b 6579 3a20 4f70 7469 6f6e 616c     key: Optional
+00006410: 5b53 6565 644f 724b 6579 5d20 3d20 4e6f  [SeedOrKey] = No
+00006420: 6e65 293a 0d0a 2020 2020 6b65 7920 3d20  ne):..    key = 
+00006430: 7365 6c66 2e73 706c 6974 5f6b 6579 2829  self.split_key()
+00006440: 2069 6620 6b65 7920 6973 204e 6f6e 6520   if key is None 
+00006450: 656c 7365 205f 666f 726d 616c 697a 655f  else _formalize_
+00006460: 6b65 7928 6b65 7929 0d0a 2020 2020 6265  key(key)..    be
+00006470: 726e 6f75 6c6c 695f 7361 6d70 6c65 7320  rnoulli_samples 
+00006480: 3d20 6a72 2e62 6572 6e6f 756c 6c69 286b  = jr.bernoulli(k
+00006490: 6579 2c20 703d 302e 352c 2073 6861 7065  ey, p=0.5, shape
+000064a0: 3d5f 7369 7a65 3273 6861 7065 2873 697a  =_size2shape(siz
+000064b0: 6529 290d 0a20 2020 2072 203d 2032 202a  e))..    r = 2 *
+000064c0: 2062 6572 6e6f 756c 6c69 5f73 616d 706c   bernoulli_sampl
+000064d0: 6573 202d 2031 0d0a 2020 2020 7265 7475  es - 1..    retu
+000064e0: 726e 2072 0d0a 0d0a 2020 6465 6620 766f  rn r....  def vo
+000064f0: 6e6d 6973 6573 2873 656c 662c 0d0a 2020  nmises(self,..  
+00006500: 2020 2020 2020 2020 2020 2020 206d 752c               mu,
+00006510: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00006520: 206b 6170 7061 2c0d 0a20 2020 2020 2020   kappa,..       
+00006530: 2020 2020 2020 2020 7369 7a65 3a20 4f70          size: Op
+00006540: 7469 6f6e 616c 5b53 697a 655d 203d 204e  tional[Size] = N
+00006550: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+00006560: 2020 2020 206b 6579 3a20 4f70 7469 6f6e       key: Option
+00006570: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
+00006580: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+00006590: 2020 2020 2020 6474 7970 653a 2044 5479        dtype: DTy
+000065a0: 7065 4c69 6b65 203d 204e 6f6e 6529 3a0d  peLike = None):.
+000065b0: 0a20 2020 206b 6579 203d 2073 656c 662e  .    key = self.
+000065c0: 7370 6c69 745f 6b65 7928 2920 6966 206b  split_key() if k
+000065d0: 6579 2069 7320 4e6f 6e65 2065 6c73 6520  ey is None else 
+000065e0: 5f66 6f72 6d61 6c69 7a65 5f6b 6579 286b  _formalize_key(k
+000065f0: 6579 290d 0a20 2020 2064 7479 7065 203d  ey)..    dtype =
+00006600: 2064 7479 7065 206f 7220 656e 7669 726f   dtype or enviro
+00006610: 6e2e 6466 7479 7065 2829 0d0a 2020 2020  n.dftype()..    
+00006620: 6d75 203d 206a 6e70 2e61 7361 7272 6179  mu = jnp.asarray
+00006630: 285f 6368 6563 6b5f 7079 5f73 6571 286d  (_check_py_seq(m
+00006640: 7529 2c20 6474 7970 653d 6474 7970 6529  u), dtype=dtype)
+00006650: 0d0a 2020 2020 6b61 7070 6120 3d20 6a6e  ..    kappa = jn
+00006660: 702e 6173 6172 7261 7928 5f63 6865 636b  p.asarray(_check
+00006670: 5f70 795f 7365 7128 6b61 7070 6129 2c20  _py_seq(kappa), 
+00006680: 6474 7970 653d 6474 7970 6529 0d0a 2020  dtype=dtype)..  
+00006690: 2020 6966 2073 697a 6520 6973 204e 6f6e    if size is Non
+000066a0: 653a 0d0a 2020 2020 2020 7369 7a65 203d  e:..      size =
+000066b0: 206c 6178 2e62 726f 6164 6361 7374 5f73   lax.broadcast_s
+000066c0: 6861 7065 7328 6a6e 702e 7368 6170 6528  hapes(jnp.shape(
+000066d0: 6d75 292c 206a 6e70 2e73 6861 7065 286b  mu), jnp.shape(k
+000066e0: 6170 7061 2929 0d0a 2020 2020 7369 7a65  appa))..    size
+000066f0: 203d 205f 7369 7a65 3273 6861 7065 2873   = _size2shape(s
+00006700: 697a 6529 0d0a 2020 2020 7361 6d70 6c65  ize)..    sample
+00006710: 7320 3d20 5f76 6f6e 5f6d 6973 6573 5f63  s = _von_mises_c
+00006720: 656e 7465 7265 6428 6b65 792c 206b 6170  entered(key, kap
+00006730: 7061 2c20 7369 7a65 2c20 6474 7970 653d  pa, size, dtype=
+00006740: 6474 7970 6529 0d0a 2020 2020 7361 6d70  dtype)..    samp
+00006750: 6c65 7320 3d20 7361 6d70 6c65 7320 2b20  les = samples + 
+00006760: 6d75 0d0a 2020 2020 7361 6d70 6c65 7320  mu..    samples 
+00006770: 3d20 2873 616d 706c 6573 202b 206a 6e70  = (samples + jnp
+00006780: 2e70 6929 2025 2028 322e 3020 2a20 6a6e  .pi) % (2.0 * jn
+00006790: 702e 7069 2920 2d20 6a6e 702e 7069 0d0a  p.pi) - jnp.pi..
+000067a0: 2020 2020 7265 7475 726e 2073 616d 706c      return sampl
+000067b0: 6573 0d0a 0d0a 2020 6465 6620 7765 6962  es....  def weib
+000067c0: 756c 6c28 7365 6c66 2c0d 0a20 2020 2020  ull(self,..     
+000067d0: 2020 2020 2020 2020 2061 2c0d 0a20 2020           a,..   
+000067e0: 2020 2020 2020 2020 2020 2073 697a 653a             size:
+000067f0: 204f 7074 696f 6e61 6c5b 5369 7a65 5d20   Optional[Size] 
+00006800: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 2020  = None,..       
+00006810: 2020 2020 2020 206b 6579 3a20 4f70 7469         key: Opti
+00006820: 6f6e 616c 5b53 6565 644f 724b 6579 5d20  onal[SeedOrKey] 
+00006830: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 2020  = None,..       
+00006840: 2020 2020 2020 2064 7479 7065 3a20 4454         dtype: DT
+00006850: 7970 654c 696b 6520 3d20 4e6f 6e65 293a  ypeLike = None):
+00006860: 0d0a 2020 2020 6b65 7920 3d20 7365 6c66  ..    key = self
+00006870: 2e73 706c 6974 5f6b 6579 2829 2069 6620  .split_key() if 
+00006880: 6b65 7920 6973 204e 6f6e 6520 656c 7365  key is None else
+00006890: 205f 666f 726d 616c 697a 655f 6b65 7928   _formalize_key(
+000068a0: 6b65 7929 0d0a 2020 2020 6120 3d20 5f63  key)..    a = _c
+000068b0: 6865 636b 5f70 795f 7365 7128 6129 0d0a  heck_py_seq(a)..
+000068c0: 2020 2020 6966 2073 697a 6520 6973 204e      if size is N
+000068d0: 6f6e 653a 0d0a 2020 2020 2020 7369 7a65  one:..      size
+000068e0: 203d 206a 6e70 2e73 6861 7065 2861 290d   = jnp.shape(a).
+000068f0: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
+00006900: 2020 6966 206a 6e70 2e73 697a 6528 6129    if jnp.size(a)
+00006910: 203e 2031 3a0d 0a20 2020 2020 2020 2072   > 1:..        r
+00006920: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00006930: 6627 2261 2220 7368 6f75 6c64 2062 6520  f'"a" should be 
+00006940: 6120 7363 616c 6172 2077 6865 6e20 2273  a scalar when "s
+00006950: 697a 6522 2069 7320 7072 6f76 6964 6564  ize" is provided
+00006960: 2e20 4275 7420 7765 2067 6f74 207b 617d  . But we got {a}
+00006970: 2729 0d0a 2020 2020 7369 7a65 203d 205f  ')..    size = _
+00006980: 7369 7a65 3273 6861 7065 2873 697a 6529  size2shape(size)
+00006990: 0d0a 2020 2020 6474 7970 6520 3d20 6474  ..    dtype = dt
+000069a0: 7970 6520 6f72 2065 6e76 6972 6f6e 2e64  ype or environ.d
+000069b0: 6674 7970 6528 290d 0a20 2020 2072 616e  ftype()..    ran
+000069c0: 646f 6d5f 756e 6966 6f72 6d20 3d20 6a72  dom_uniform = jr
+000069d0: 2e75 6e69 666f 726d 286b 6579 3d6b 6579  .uniform(key=key
+000069e0: 2c20 7368 6170 653d 7369 7a65 2c20 6d69  , shape=size, mi
+000069f0: 6e76 616c 3d30 2c20 6d61 7876 616c 3d31  nval=0, maxval=1
+00006a00: 2c20 6474 7970 653d 6474 7970 6529 0d0a  , dtype=dtype)..
+00006a10: 2020 2020 7220 3d20 6a6e 702e 706f 7765      r = jnp.powe
+00006a20: 7228 2d6a 6e70 2e6c 6f67 3170 282d 7261  r(-jnp.log1p(-ra
+00006a30: 6e64 6f6d 5f75 6e69 666f 726d 292c 2031  ndom_uniform), 1
+00006a40: 2e30 202f 2061 290d 0a20 2020 2072 6574  .0 / a)..    ret
+00006a50: 7572 6e20 720d 0a0d 0a20 2064 6566 2077  urn r....  def w
+00006a60: 6569 6275 6c6c 5f6d 696e 2873 656c 662c  eibull_min(self,
+00006a70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00006a80: 2020 2020 612c 0d0a 2020 2020 2020 2020      a,..        
+00006a90: 2020 2020 2020 2020 2020 7363 616c 653d            scale=
+00006aa0: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+00006ab0: 2020 2020 2020 2020 2073 697a 653a 204f           size: O
+00006ac0: 7074 696f 6e61 6c5b 5369 7a65 5d20 3d20  ptional[Size] = 
+00006ad0: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+00006ae0: 2020 2020 2020 2020 206b 6579 3a20 4f70           key: Op
+00006af0: 7469 6f6e 616c 5b53 6565 644f 724b 6579  tional[SeedOrKey
+00006b00: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2020  ] = None,..     
+00006b10: 2020 2020 2020 2020 2020 2020 2064 7479               dty
+00006b20: 7065 3a20 4454 7970 654c 696b 6520 3d20  pe: DTypeLike = 
+00006b30: 4e6f 6e65 293a 0d0a 2020 2020 6b65 7920  None):..    key 
+00006b40: 3d20 7365 6c66 2e73 706c 6974 5f6b 6579  = self.split_key
+00006b50: 2829 2069 6620 6b65 7920 6973 204e 6f6e  () if key is Non
+00006b60: 6520 656c 7365 205f 666f 726d 616c 697a  e else _formaliz
+00006b70: 655f 6b65 7928 6b65 7929 0d0a 2020 2020  e_key(key)..    
+00006b80: 6120 3d20 5f63 6865 636b 5f70 795f 7365  a = _check_py_se
+00006b90: 7128 6129 0d0a 2020 2020 7363 616c 6520  q(a)..    scale 
+00006ba0: 3d20 5f63 6865 636b 5f70 795f 7365 7128  = _check_py_seq(
+00006bb0: 7363 616c 6529 0d0a 2020 2020 6966 2073  scale)..    if s
+00006bc0: 697a 6520 6973 204e 6f6e 653a 0d0a 2020  ize is None:..  
+00006bd0: 2020 2020 7369 7a65 203d 206a 6e70 2e62      size = jnp.b
+00006be0: 726f 6164 6361 7374 5f73 6861 7065 7328  roadcast_shapes(
+00006bf0: 6a6e 702e 7368 6170 6528 6129 2c20 6a6e  jnp.shape(a), jn
+00006c00: 702e 7368 6170 6528 7363 616c 6529 290d  p.shape(scale)).
+00006c10: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
+00006c20: 2020 6966 206a 6e70 2e73 697a 6528 6129    if jnp.size(a)
+00006c30: 203e 2031 3a0d 0a20 2020 2020 2020 2072   > 1:..        r
+00006c40: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00006c50: 6627 2261 2220 7368 6f75 6c64 2062 6520  f'"a" should be 
+00006c60: 6120 7363 616c 6172 2077 6865 6e20 2273  a scalar when "s
+00006c70: 697a 6522 2069 7320 7072 6f76 6964 6564  ize" is provided
+00006c80: 2e20 4275 7420 7765 2067 6f74 207b 617d  . But we got {a}
+00006c90: 2729 0d0a 2020 2020 7369 7a65 203d 205f  ')..    size = _
+00006ca0: 7369 7a65 3273 6861 7065 2873 697a 6529  size2shape(size)
+00006cb0: 0d0a 2020 2020 6474 7970 6520 3d20 6474  ..    dtype = dt
+00006cc0: 7970 6520 6f72 2065 6e76 6972 6f6e 2e64  ype or environ.d
+00006cd0: 6674 7970 6528 290d 0a20 2020 2072 616e  ftype()..    ran
+00006ce0: 646f 6d5f 756e 6966 6f72 6d20 3d20 6a72  dom_uniform = jr
+00006cf0: 2e75 6e69 666f 726d 286b 6579 3d6b 6579  .uniform(key=key
+00006d00: 2c20 7368 6170 653d 7369 7a65 2c20 6d69  , shape=size, mi
+00006d10: 6e76 616c 3d30 2c20 6d61 7876 616c 3d31  nval=0, maxval=1
+00006d20: 2c20 6474 7970 653d 6474 7970 6529 0d0a  , dtype=dtype)..
+00006d30: 2020 2020 7220 3d20 6a6e 702e 706f 7765      r = jnp.powe
+00006d40: 7228 2d6a 6e70 2e6c 6f67 3170 282d 7261  r(-jnp.log1p(-ra
+00006d50: 6e64 6f6d 5f75 6e69 666f 726d 292c 2031  ndom_uniform), 1
+00006d60: 2e30 202f 2061 290d 0a20 2020 2069 6620  .0 / a)..    if 
+00006d70: 7363 616c 6520 6973 206e 6f74 204e 6f6e  scale is not Non
+00006d80: 653a 0d0a 2020 2020 2020 7220 2f3d 2073  e:..      r /= s
+00006d90: 6361 6c65 0d0a 2020 2020 7265 7475 726e  cale..    return
+00006da0: 2072 0d0a 0d0a 2020 6465 6620 6d61 7877   r....  def maxw
+00006db0: 656c 6c28 7365 6c66 2c0d 0a20 2020 2020  ell(self,..     
+00006dc0: 2020 2020 2020 2020 2073 697a 653a 204f           size: O
+00006dd0: 7074 696f 6e61 6c5b 5369 7a65 5d20 3d20  ptional[Size] = 
+00006de0: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+00006df0: 2020 2020 206b 6579 3a20 4f70 7469 6f6e       key: Option
+00006e00: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
+00006e10: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+00006e20: 2020 2020 2064 7479 7065 3a20 4454 7970       dtype: DTyp
+00006e30: 654c 696b 6520 3d20 4e6f 6e65 293a 0d0a  eLike = None):..
+00006e40: 2020 2020 6b65 7920 3d20 7365 6c66 2e73      key = self.s
+00006e50: 706c 6974 5f6b 6579 2829 2069 6620 6b65  plit_key() if ke
+00006e60: 7920 6973 204e 6f6e 6520 656c 7365 205f  y is None else _
+00006e70: 666f 726d 616c 697a 655f 6b65 7928 6b65  formalize_key(ke
+00006e80: 7929 0d0a 2020 2020 7368 6170 6520 3d20  y)..    shape = 
+00006e90: 5f73 697a 6532 7368 6170 6528 7369 7a65  _size2shape(size
+00006ea0: 2920 2b20 2833 2c29 0d0a 2020 2020 6474  ) + (3,)..    dt
+00006eb0: 7970 6520 3d20 6474 7970 6520 6f72 2065  ype = dtype or e
+00006ec0: 6e76 6972 6f6e 2e64 6674 7970 6528 290d  nviron.dftype().
+00006ed0: 0a20 2020 206e 6f72 6d5f 7276 7320 3d20  .    norm_rvs = 
+00006ee0: 6a72 2e6e 6f72 6d61 6c28 6b65 793d 6b65  jr.normal(key=ke
+00006ef0: 792c 2073 6861 7065 3d73 6861 7065 2c20  y, shape=shape, 
+00006f00: 6474 7970 653d 6474 7970 6529 0d0a 2020  dtype=dtype)..  
+00006f10: 2020 7220 3d20 6a6e 702e 6c69 6e61 6c67    r = jnp.linalg
+00006f20: 2e6e 6f72 6d28 6e6f 726d 5f72 7673 2c20  .norm(norm_rvs, 
+00006f30: 6178 6973 3d2d 3129 0d0a 2020 2020 7265  axis=-1)..    re
+00006f40: 7475 726e 2072 0d0a 0d0a 2020 6465 6620  turn r....  def 
+00006f50: 6e65 6761 7469 7665 5f62 696e 6f6d 6961  negative_binomia
+00006f60: 6c28 7365 6c66 2c0d 0a20 2020 2020 2020  l(self,..       
+00006f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006f80: 206e 2c0d 0a20 2020 2020 2020 2020 2020   n,..           
+00006f90: 2020 2020 2020 2020 2020 2020 2070 2c0d               p,.
+00006fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006fb0: 2020 2020 2020 2020 2073 697a 653a 204f           size: O
+00006fc0: 7074 696f 6e61 6c5b 5369 7a65 5d20 3d20  ptional[Size] = 
+00006fd0: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+00006fe0: 2020 2020 2020 2020 2020 2020 2020 206b                 k
+00006ff0: 6579 3a20 4f70 7469 6f6e 616c 5b53 6565  ey: Optional[See
+00007000: 644f 724b 6579 5d20 3d20 4e6f 6e65 2c0d  dOrKey] = None,.
+00007010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007020: 2020 2020 2020 2020 2064 7479 7065 3a20           dtype: 
+00007030: 4454 7970 654c 696b 6520 3d20 4e6f 6e65  DTypeLike = None
+00007040: 293a 0d0a 2020 2020 6e20 3d20 5f63 6865  ):..    n = _che
+00007050: 636b 5f70 795f 7365 7128 6e29 0d0a 2020  ck_py_seq(n)..  
+00007060: 2020 7020 3d20 5f63 6865 636b 5f70 795f    p = _check_py_
+00007070: 7365 7128 7029 0d0a 2020 2020 6966 2073  seq(p)..    if s
+00007080: 697a 6520 6973 204e 6f6e 653a 0d0a 2020  ize is None:..  
+00007090: 2020 2020 7369 7a65 203d 206c 6178 2e62      size = lax.b
+000070a0: 726f 6164 6361 7374 5f73 6861 7065 7328  roadcast_shapes(
+000070b0: 6a6e 702e 7368 6170 6528 6e29 2c20 6a6e  jnp.shape(n), jn
+000070c0: 702e 7368 6170 6528 7029 290d 0a20 2020  p.shape(p))..   
+000070d0: 2073 697a 6520 3d20 5f73 697a 6532 7368   size = _size2sh
+000070e0: 6170 6528 7369 7a65 290d 0a20 2020 206c  ape(size)..    l
+000070f0: 6f67 6974 7320 3d20 6a6e 702e 6c6f 6728  ogits = jnp.log(
+00007100: 7029 202d 206a 6e70 2e6c 6f67 3170 282d  p) - jnp.log1p(-
+00007110: 7029 0d0a 2020 2020 6966 206b 6579 2069  p)..    if key i
+00007120: 7320 4e6f 6e65 3a0d 0a20 2020 2020 206b  s None:..      k
+00007130: 6579 7320 3d20 7365 6c66 2e73 706c 6974  eys = self.split
+00007140: 5f6b 6579 7328 3229 0d0a 2020 2020 656c  _keys(2)..    el
+00007150: 7365 3a0d 0a20 2020 2020 206b 6579 7320  se:..      keys 
+00007160: 3d20 6a72 2e73 706c 6974 285f 666f 726d  = jr.split(_form
+00007170: 616c 697a 655f 6b65 7928 6b65 7929 2c20  alize_key(key), 
+00007180: 3229 0d0a 2020 2020 7261 7465 203d 2073  2)..    rate = s
+00007190: 656c 662e 6761 6d6d 6128 7368 6170 653d  elf.gamma(shape=
+000071a0: 6e2c 2073 6361 6c65 3d6a 6e70 2e65 7870  n, scale=jnp.exp
+000071b0: 282d 6c6f 6769 7473 292c 2073 697a 653d  (-logits), size=
+000071c0: 7369 7a65 2c20 6b65 793d 6b65 7973 5b30  size, key=keys[0
+000071d0: 5d2c 2064 7479 7065 3d65 6e76 6972 6f6e  ], dtype=environ
+000071e0: 2e64 6674 7970 6528 2929 0d0a 2020 2020  .dftype())..    
+000071f0: 7220 3d20 7365 6c66 2e70 6f69 7373 6f6e  r = self.poisson
+00007200: 286c 616d 3d72 6174 652c 206b 6579 3d6b  (lam=rate, key=k
+00007210: 6579 735b 315d 2c20 6474 7970 653d 6474  eys[1], dtype=dt
+00007220: 7970 6520 6f72 2065 6e76 6972 6f6e 2e64  ype or environ.d
+00007230: 6974 7970 6528 2929 0d0a 2020 2020 7265  itype())..    re
+00007240: 7475 726e 2072 0d0a 0d0a 2020 6465 6620  turn r....  def 
+00007250: 7761 6c64 2873 656c 662c 0d0a 2020 2020  wald(self,..    
+00007260: 2020 2020 2020 206d 6561 6e2c 0d0a 2020         mean,..  
+00007270: 2020 2020 2020 2020 2073 6361 6c65 2c0d           scale,.
+00007280: 0a20 2020 2020 2020 2020 2020 7369 7a65  .           size
+00007290: 3a20 4f70 7469 6f6e 616c 5b53 697a 655d  : Optional[Size]
+000072a0: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
+000072b0: 2020 2020 206b 6579 3a20 4f70 7469 6f6e       key: Option
+000072c0: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
+000072d0: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+000072e0: 2020 6474 7970 653a 2044 5479 7065 4c69    dtype: DTypeLi
+000072f0: 6b65 203d 204e 6f6e 6529 3a0d 0a20 2020  ke = None):..   
+00007300: 2064 7479 7065 203d 2064 7479 7065 206f   dtype = dtype o
+00007310: 7220 656e 7669 726f 6e2e 6466 7479 7065  r environ.dftype
+00007320: 2829 0d0a 2020 2020 6b65 7920 3d20 7365  ()..    key = se
+00007330: 6c66 2e73 706c 6974 5f6b 6579 2829 2069  lf.split_key() i
+00007340: 6620 6b65 7920 6973 204e 6f6e 6520 656c  f key is None el
+00007350: 7365 205f 666f 726d 616c 697a 655f 6b65  se _formalize_ke
+00007360: 7928 6b65 7929 0d0a 2020 2020 6d65 616e  y(key)..    mean
+00007370: 203d 206a 6e70 2e61 7361 7272 6179 285f   = jnp.asarray(_
+00007380: 6368 6563 6b5f 7079 5f73 6571 286d 6561  check_py_seq(mea
+00007390: 6e29 2c20 6474 7970 653d 6474 7970 6529  n), dtype=dtype)
+000073a0: 0d0a 2020 2020 7363 616c 6520 3d20 6a6e  ..    scale = jn
+000073b0: 702e 6173 6172 7261 7928 5f63 6865 636b  p.asarray(_check
+000073c0: 5f70 795f 7365 7128 7363 616c 6529 2c20  _py_seq(scale), 
+000073d0: 6474 7970 653d 6474 7970 6529 0d0a 2020  dtype=dtype)..  
+000073e0: 2020 6966 2073 697a 6520 6973 204e 6f6e    if size is Non
+000073f0: 653a 0d0a 2020 2020 2020 7369 7a65 203d  e:..      size =
+00007400: 206c 6178 2e62 726f 6164 6361 7374 5f73   lax.broadcast_s
+00007410: 6861 7065 7328 6a6e 702e 7368 6170 6528  hapes(jnp.shape(
+00007420: 6d65 616e 292c 206a 6e70 2e73 6861 7065  mean), jnp.shape
+00007430: 2873 6361 6c65 2929 0d0a 2020 2020 7369  (scale))..    si
+00007440: 7a65 203d 205f 7369 7a65 3273 6861 7065  ze = _size2shape
+00007450: 2873 697a 6529 0d0a 2020 2020 7361 6d70  (size)..    samp
+00007460: 6c65 645f 6368 6932 203d 206a 6e70 2e73  led_chi2 = jnp.s
+00007470: 7175 6172 6528 7365 6c66 2e72 616e 646e  quare(self.randn
+00007480: 282a 7369 7a65 2929 0d0a 2020 2020 7361  (*size))..    sa
+00007490: 6d70 6c65 645f 756e 6966 6f72 6d20 3d20  mpled_uniform = 
+000074a0: 7365 6c66 2e75 6e69 666f 726d 2873 697a  self.uniform(siz
+000074b0: 653d 7369 7a65 2c20 6b65 793d 6b65 792c  e=size, key=key,
+000074c0: 2064 7479 7065 3d64 7479 7065 290d 0a20   dtype=dtype).. 
+000074d0: 2020 2023 2057 696b 6970 6564 6961 2064     # Wikipedia d
+000074e0: 6566 696e 6573 2061 6e20 696e 7465 726d  efines an interm
+000074f0: 6564 6961 7465 2078 2077 6974 6820 7468  ediate x with th
+00007500: 6520 666f 726d 756c 610d 0a20 2020 2023  e formula..    #
+00007510: 2020 2078 203d 206c 6f63 202b 206c 6f63     x = loc + loc
+00007520: 202a 2a20 3220 2a20 7920 2f20 2832 202a   ** 2 * y / (2 *
+00007530: 2063 6f6e 6329 202d 206c 6f63 202f 2028   conc) - loc / (
+00007540: 3220 2a20 636f 6e63 2920 2a20 7371 7274  2 * conc) * sqrt
+00007550: 2834 202a 206c 6f63 202a 2063 6f6e 6320  (4 * loc * conc 
+00007560: 2a20 7920 2b20 6c6f 6320 2a2a 2032 202a  * y + loc ** 2 *
+00007570: 2079 202a 2a20 3229 0d0a 2020 2020 2320   y ** 2)..    # 
+00007580: 7768 6572 6520 7920 7e20 4e28 302c 2031  where y ~ N(0, 1
+00007590: 292a 2a32 2028 7361 6d70 6c65 645f 6368  )**2 (sampled_ch
+000075a0: 6932 2061 626f 7665 2920 616e 6420 636f  i2 above) and co
+000075b0: 6e63 2069 7320 7468 6520 636f 6e63 656e  nc is the concen
+000075c0: 7472 6174 696f 6e2e 0d0a 2020 2020 2320  tration...    # 
+000075d0: 4c65 7420 7573 2077 7269 7465 0d0a 2020  Let us write..  
+000075e0: 2020 2320 2020 7720 3d20 6c6f 6320 2a20    #   w = loc * 
+000075f0: 7920 2f20 2832 202a 2063 6f6e 6329 0d0a  y / (2 * conc)..
+00007600: 2020 2020 2320 5468 656e 2077 6520 6361      # Then we ca
+00007610: 6e20 6578 7472 6163 7420 7468 6520 636f  n extract the co
+00007620: 6d6d 6f6e 2066 6163 746f 7220 696e 2074  mmon factor in t
+00007630: 6865 206c 6173 7420 7477 6f20 7465 726d  he last two term
+00007640: 7320 746f 206f 6274 6169 6e0d 0a20 2020  s to obtain..   
+00007650: 2023 2020 2078 203d 206c 6f63 202b 206c   #   x = loc + l
+00007660: 6f63 202a 2077 202a 2028 3120 2d20 7371  oc * w * (1 - sq
+00007670: 7274 2832 202f 2077 202b 2031 2929 0d0a  rt(2 / w + 1))..
+00007680: 2020 2020 2320 4e6f 7720 7765 2073 6565      # Now we see
+00007690: 2074 6861 7420 7468 6520 5769 6b69 7065   that the Wikipe
+000076a0: 6469 6120 666f 726d 756c 6120 7375 6666  dia formula suff
+000076b0: 6572 7320 6672 6f6d 2063 6174 6173 7472  ers from catastr
+000076c0: 7068 6963 0d0a 2020 2020 2320 6361 6e63  phic..    # canc
+000076d0: 656c 6c61 7469 6f6e 2066 6f72 206c 6172  ellation for lar
+000076e0: 6765 2077 2028 652e 672e 2c20 6966 2063  ge w (e.g., if c
+000076f0: 6f6e 6320 3c3c 206c 6f63 292e 0d0a 2020  onc << loc)...  
+00007700: 2020 230d 0a20 2020 2023 2046 6f72 7475    #..    # Fortu
+00007710: 6e61 7465 6c79 2c20 7765 2063 616e 2066  nately, we can f
+00007720: 6978 2074 6869 7320 6279 206d 756c 7469  ix this by multi
+00007730: 706c 7969 6e67 2062 6f74 6820 7369 6465  plying both side
+00007740: 730d 0a20 2020 2023 2062 7920 3120 2b20  s..    # by 1 + 
+00007750: 7371 7274 2832 202f 2077 202b 2031 292e  sqrt(2 / w + 1).
+00007760: 2020 5765 2067 6574 0d0a 2020 2020 2320    We get..    # 
+00007770: 2020 7820 2a20 2831 202b 2073 7172 7428    x * (1 + sqrt(
+00007780: 3220 2f20 7720 2b20 3129 2920 3d0d 0a20  2 / w + 1)) =.. 
+00007790: 2020 2023 2020 2020 203d 206c 6f63 202a     #     = loc *
+000077a0: 2028 3120 2b20 7371 7274 2832 202f 2077   (1 + sqrt(2 / w
+000077b0: 202b 2031 2929 202b 206c 6f63 202a 2077   + 1)) + loc * w
+000077c0: 202a 2028 3120 2d20 2832 202f 2077 202b   * (1 - (2 / w +
+000077d0: 2031 2929 0d0a 2020 2020 2320 2020 2020   1))..    #     
+000077e0: 3d20 6c6f 6320 2a20 2873 7172 7428 3220  = loc * (sqrt(2 
+000077f0: 2f20 7720 2b20 3129 202d 2031 290d 0a20  / w + 1) - 1).. 
+00007800: 2020 2023 2054 6865 2074 6572 6d20 7371     # The term sq
+00007810: 7274 2832 202f 2077 202b 2031 2920 2b20  rt(2 / w + 1) + 
+00007820: 3120 6e6f 206c 6f6e 6765 7220 7072 6573  1 no longer pres
+00007830: 656e 7473 206e 756d 6572 6963 616c 0d0a  ents numerical..
+00007840: 2020 2020 2320 6469 6666 6963 756c 7469      # difficulti
+00007850: 6573 2066 6f72 206c 6172 6765 2077 2c20  es for large w, 
+00007860: 616e 6420 7371 7274 2832 202f 2077 202b  and sqrt(2 / w +
+00007870: 2031 2920 2d20 3120 6973 206a 7573 740d   1) - 1 is just.
+00007880: 0a20 2020 2023 2073 7172 7431 706d 3128  .    # sqrt1pm1(
+00007890: 3220 2f20 7729 2c20 7768 6963 6820 7765  2 / w), which we
+000078a0: 206b 6e6f 7720 686f 7720 746f 2063 6f6d   know how to com
+000078b0: 7075 7465 2061 6363 7572 6174 656c 792e  pute accurately.
+000078c0: 0d0a 2020 2020 2320 5468 6973 206a 7573  ..    # This jus
+000078d0: 7420 6c65 6176 6573 2074 6865 206d 6174  t leaves the mat
+000078e0: 7465 7220 6f66 2073 6d61 6c6c 2077 2c20  ter of small w, 
+000078f0: 7768 6572 6520 3220 2f20 7720 6d61 790d  where 2 / w may.
+00007900: 0a20 2020 2023 206f 7665 7266 6c6f 772e  .    # overflow.
+00007910: 2020 496e 2074 6865 206c 696d 6974 2061    In the limit a
+00007920: 2077 202d 3e20 302c 2078 202d 3e20 6c6f   w -> 0, x -> lo
+00007930: 632c 2073 6f20 7765 206a 7573 7420 6d61  c, so we just ma
+00007940: 736b 0d0a 2020 2020 2320 7468 6174 2063  sk..    # that c
+00007950: 6173 652e 0d0a 2020 2020 7371 7274 3170  ase...    sqrt1p
+00007960: 6d31 5f61 7267 203d 2034 202a 2073 6361  m1_arg = 4 * sca
+00007970: 6c65 202f 2028 6d65 616e 202a 2073 616d  le / (mean * sam
+00007980: 706c 6564 5f63 6869 3229 2020 2320 3220  pled_chi2)  # 2 
+00007990: 2f20 7720 6162 6f76 650d 0a20 2020 2073  / w above..    s
+000079a0: 6166 655f 7371 7274 3170 6d31 5f61 7267  afe_sqrt1pm1_arg
+000079b0: 203d 206a 6e70 2e77 6865 7265 2873 7172   = jnp.where(sqr
+000079c0: 7431 706d 315f 6172 6720 3c20 6e70 2e69  t1pm1_arg < np.i
+000079d0: 6e66 2c20 7371 7274 3170 6d31 5f61 7267  nf, sqrt1pm1_arg
+000079e0: 2c20 312e 3029 0d0a 2020 2020 6465 6e6f  , 1.0)..    deno
+000079f0: 6d69 6e61 746f 7220 3d20 312e 3020 2b20  minator = 1.0 + 
+00007a00: 6a6e 702e 7371 7274 2873 6166 655f 7371  jnp.sqrt(safe_sq
+00007a10: 7274 3170 6d31 5f61 7267 202b 2031 2e30  rt1pm1_arg + 1.0
+00007a20: 290d 0a20 2020 2072 6174 696f 203d 206a  )..    ratio = j
+00007a30: 6e70 2e65 7870 6d31 2830 2e35 202a 206a  np.expm1(0.5 * j
+00007a40: 6e70 2e6c 6f67 3170 2873 6166 655f 7371  np.log1p(safe_sq
+00007a50: 7274 3170 6d31 5f61 7267 2929 202f 2064  rt1pm1_arg)) / d
+00007a60: 656e 6f6d 696e 6174 6f72 0d0a 2020 2020  enominator..    
+00007a70: 7361 6d70 6c65 6420 3d20 6d65 616e 202a  sampled = mean *
+00007a80: 206a 6e70 2e77 6865 7265 2873 7172 7431   jnp.where(sqrt1
+00007a90: 706d 315f 6172 6720 3c20 6e70 2e69 6e66  pm1_arg < np.inf
+00007aa0: 2c20 7261 7469 6f2c 2031 2e30 2920 2023  , ratio, 1.0)  #
+00007ab0: 2078 2061 626f 7665 0d0a 2020 2020 7265   x above..    re
+00007ac0: 7320 3d20 6a6e 702e 7768 6572 6528 7361  s = jnp.where(sa
+00007ad0: 6d70 6c65 645f 756e 6966 6f72 6d20 3c3d  mpled_uniform <=
+00007ae0: 206d 6561 6e20 2f20 286d 6561 6e20 2b20   mean / (mean + 
+00007af0: 7361 6d70 6c65 6429 2c0d 0a20 2020 2020  sampled),..     
+00007b00: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00007b10: 616d 706c 6564 2c0d 0a20 2020 2020 2020  ampled,..       
+00007b20: 2020 2020 2020 2020 2020 2020 206a 6e70               jnp
+00007b30: 2e73 7175 6172 6528 6d65 616e 2920 2f20  .square(mean) / 
+00007b40: 7361 6d70 6c65 6429 0d0a 2020 2020 7265  sampled)..    re
+00007b50: 7475 726e 2072 6573 0d0a 0d0a 2020 6465  turn res....  de
+00007b60: 6620 7428 7365 6c66 2c0d 0a20 2020 2020  f t(self,..     
+00007b70: 2020 2064 662c 0d0a 2020 2020 2020 2020     df,..        
+00007b80: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b53  size: Optional[S
+00007b90: 697a 655d 203d 204e 6f6e 652c 0d0a 2020  ize] = None,..  
+00007ba0: 2020 2020 2020 6b65 793a 204f 7074 696f        key: Optio
+00007bb0: 6e61 6c5b 5365 6564 4f72 4b65 795d 203d  nal[SeedOrKey] =
+00007bc0: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
+00007bd0: 6474 7970 653a 2044 5479 7065 4c69 6b65  dtype: DTypeLike
+00007be0: 203d 204e 6f6e 6529 3a0d 0a20 2020 2064   = None):..    d
+00007bf0: 7479 7065 203d 2064 7479 7065 206f 7220  type = dtype or 
+00007c00: 656e 7669 726f 6e2e 6466 7479 7065 2829  environ.dftype()
+00007c10: 0d0a 2020 2020 6466 203d 206a 6e70 2e61  ..    df = jnp.a
+00007c20: 7361 7272 6179 285f 6368 6563 6b5f 7079  sarray(_check_py
+00007c30: 5f73 6571 2864 6629 2c20 6474 7970 653d  _seq(df), dtype=
+00007c40: 6474 7970 6529 0d0a 2020 2020 6966 2073  dtype)..    if s
+00007c50: 697a 6520 6973 204e 6f6e 653a 0d0a 2020  ize is None:..  
+00007c60: 2020 2020 7369 7a65 203d 206e 702e 7368      size = np.sh
+00007c70: 6170 6528 6466 290d 0a20 2020 2065 6c73  ape(df)..    els
+00007c80: 653a 0d0a 2020 2020 2020 7369 7a65 203d  e:..      size =
+00007c90: 205f 7369 7a65 3273 6861 7065 2873 697a   _size2shape(siz
+00007ca0: 6529 0d0a 2020 2020 2020 5f63 6865 636b  e)..      _check
+00007cb0: 5f73 6861 7065 2822 7422 2c20 7369 7a65  _shape("t", size
+00007cc0: 2c20 6e70 2e73 6861 7065 2864 6629 290d  , np.shape(df)).
+00007cd0: 0a20 2020 2069 6620 6b65 7920 6973 204e  .    if key is N
+00007ce0: 6f6e 653a 0d0a 2020 2020 2020 6b65 7973  one:..      keys
+00007cf0: 203d 2073 656c 662e 7370 6c69 745f 6b65   = self.split_ke
+00007d00: 7973 2832 290d 0a20 2020 2065 6c73 653a  ys(2)..    else:
+00007d10: 0d0a 2020 2020 2020 6b65 7973 203d 206a  ..      keys = j
+00007d20: 722e 7370 6c69 7428 5f66 6f72 6d61 6c69  r.split(_formali
+00007d30: 7a65 5f6b 6579 286b 6579 292c 2032 290d  ze_key(key), 2).
+00007d40: 0a20 2020 206e 203d 206a 722e 6e6f 726d  .    n = jr.norm
+00007d50: 616c 286b 6579 735b 305d 2c20 7369 7a65  al(keys[0], size
+00007d60: 2c20 6474 7970 653d 6474 7970 6529 0d0a  , dtype=dtype)..
+00007d70: 2020 2020 7477 6f20 3d20 5f63 6f6e 7374      two = _const
+00007d80: 286e 2c20 3229 0d0a 2020 2020 6861 6c66  (n, 2)..    half
+00007d90: 5f64 6620 3d20 6c61 782e 6469 7628 6466  _df = lax.div(df
+00007da0: 2c20 7477 6f29 0d0a 2020 2020 6720 3d20  , two)..    g = 
+00007db0: 6a72 2e67 616d 6d61 286b 6579 735b 315d  jr.gamma(keys[1]
+00007dc0: 2c20 6861 6c66 5f64 662c 2073 697a 652c  , half_df, size,
+00007dd0: 2064 7479 7065 3d64 7479 7065 290d 0a20   dtype=dtype).. 
+00007de0: 2020 2072 203d 206e 202a 206a 6e70 2e73     r = n * jnp.s
+00007df0: 7172 7428 6861 6c66 5f64 6620 2f20 6729  qrt(half_df / g)
+00007e00: 0d0a 2020 2020 7265 7475 726e 2072 0d0a  ..    return r..
+00007e10: 0d0a 2020 6465 6620 6f72 7468 6f67 6f6e  ..  def orthogon
+00007e20: 616c 2873 656c 662c 0d0a 2020 2020 2020  al(self,..      
+00007e30: 2020 2020 2020 2020 2020 206e 3a20 696e             n: in
+00007e40: 742c 0d0a 2020 2020 2020 2020 2020 2020  t,..            
+00007e50: 2020 2020 2073 697a 653a 204f 7074 696f       size: Optio
+00007e60: 6e61 6c5b 5369 7a65 5d20 3d20 4e6f 6e65  nal[Size] = None
+00007e70: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00007e80: 2020 2020 6b65 793a 204f 7074 696f 6e61      key: Optiona
+00007e90: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
+00007ea0: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+00007eb0: 2020 2020 2020 2064 7479 7065 3a20 4454         dtype: DT
+00007ec0: 7970 654c 696b 6520 3d20 4e6f 6e65 293a  ypeLike = None):
+00007ed0: 0d0a 2020 2020 6474 7970 6520 3d20 6474  ..    dtype = dt
+00007ee0: 7970 6520 6f72 2065 6e76 6972 6f6e 2e64  ype or environ.d
+00007ef0: 6674 7970 6528 290d 0a20 2020 206b 6579  ftype()..    key
+00007f00: 203d 2073 656c 662e 7370 6c69 745f 6b65   = self.split_ke
+00007f10: 7928 2920 6966 206b 6579 2069 7320 4e6f  y() if key is No
+00007f20: 6e65 2065 6c73 6520 5f66 6f72 6d61 6c69  ne else _formali
+00007f30: 7a65 5f6b 6579 286b 6579 290d 0a20 2020  ze_key(key)..   
+00007f40: 2073 697a 6520 3d20 5f73 697a 6532 7368   size = _size2sh
+00007f50: 6170 6528 7369 7a65 290d 0a20 2020 205f  ape(size)..    _
+00007f60: 6368 6563 6b5f 7368 6170 6528 226f 7274  check_shape("ort
+00007f70: 686f 676f 6e61 6c22 2c20 7369 7a65 290d  hogonal", size).
+00007f80: 0a20 2020 206e 203d 2063 6f72 652e 636f  .    n = core.co
+00007f90: 6e63 7265 7465 5f6f 725f 6572 726f 7228  ncrete_or_error(
+00007fa0: 696e 6465 782c 206e 2c20 2254 6865 2065  index, n, "The e
+00007fb0: 7272 6f72 206f 6363 7572 7265 6420 696e  rror occurred in
+00007fc0: 206a 6178 2e72 616e 646f 6d2e 6f72 7468   jax.random.orth
+00007fd0: 6f67 6f6e 616c 2829 2229 0d0a 2020 2020  ogonal()")..    
+00007fe0: 7a20 3d20 6a72 2e6e 6f72 6d61 6c28 6b65  z = jr.normal(ke
+00007ff0: 792c 2073 697a 6520 2b20 286e 2c20 6e29  y, size + (n, n)
+00008000: 2c20 6474 7970 653d 6474 7970 6529 0d0a  , dtype=dtype)..
+00008010: 2020 2020 712c 2072 203d 206a 6e70 2e6c      q, r = jnp.l
+00008020: 696e 616c 672e 7172 287a 290d 0a20 2020  inalg.qr(z)..   
+00008030: 2064 203d 206a 6e70 2e64 6961 676f 6e61   d = jnp.diagona
+00008040: 6c28 722c 2030 2c20 2d32 2c20 2d31 290d  l(r, 0, -2, -1).
+00008050: 0a20 2020 2072 203d 2071 202a 206a 6e70  .    r = q * jnp
+00008060: 2e65 7870 616e 645f 6469 6d73 2864 202f  .expand_dims(d /
+00008070: 2061 6273 2864 292c 202d 3229 0d0a 2020   abs(d), -2)..  
+00008080: 2020 7265 7475 726e 2072 0d0a 0d0a 2020    return r....  
+00008090: 6465 6620 6e6f 6e63 656e 7472 616c 5f63  def noncentral_c
+000080a0: 6869 7371 7561 7265 2873 656c 662c 0d0a  hisquare(self,..
+000080b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000080c0: 2020 2020 2020 2020 2020 2064 662c 0d0a             df,..
+000080d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000080e0: 2020 2020 2020 2020 2020 206e 6f6e 632c             nonc,
+000080f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008100: 2020 2020 2020 2020 2020 2020 2073 697a               siz
+00008110: 653a 204f 7074 696f 6e61 6c5b 5369 7a65  e: Optional[Size
+00008120: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2020  ] = None,..     
+00008130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008140: 2020 2020 2020 6b65 793a 204f 7074 696f        key: Optio
+00008150: 6e61 6c5b 5365 6564 4f72 4b65 795d 203d  nal[SeedOrKey] =
+00008160: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
+00008170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008180: 2020 2064 7479 7065 3a20 4454 7970 654c     dtype: DTypeL
+00008190: 696b 6520 3d20 4e6f 6e65 293a 0d0a 2020  ike = None):..  
+000081a0: 2020 6474 7970 6520 3d20 6474 7970 6520    dtype = dtype 
+000081b0: 6f72 2065 6e76 6972 6f6e 2e64 6674 7970  or environ.dftyp
+000081c0: 6528 290d 0a20 2020 2064 6620 3d20 6a6e  e()..    df = jn
+000081d0: 702e 6173 6172 7261 7928 5f63 6865 636b  p.asarray(_check
+000081e0: 5f70 795f 7365 7128 6466 292c 2064 7479  _py_seq(df), dty
+000081f0: 7065 3d64 7479 7065 290d 0a20 2020 206e  pe=dtype)..    n
+00008200: 6f6e 6320 3d20 6a6e 702e 6173 6172 7261  onc = jnp.asarra
+00008210: 7928 5f63 6865 636b 5f70 795f 7365 7128  y(_check_py_seq(
+00008220: 6e6f 6e63 292c 2064 7479 7065 3d64 7479  nonc), dtype=dty
+00008230: 7065 290d 0a20 2020 2069 6620 7369 7a65  pe)..    if size
+00008240: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
+00008250: 2073 697a 6520 3d20 6c61 782e 6272 6f61   size = lax.broa
+00008260: 6463 6173 745f 7368 6170 6573 286a 6e70  dcast_shapes(jnp
+00008270: 2e73 6861 7065 2864 6629 2c20 6a6e 702e  .shape(df), jnp.
+00008280: 7368 6170 6528 6e6f 6e63 2929 0d0a 2020  shape(nonc))..  
+00008290: 2020 7369 7a65 203d 205f 7369 7a65 3273    size = _size2s
+000082a0: 6861 7065 2873 697a 6529 0d0a 2020 2020  hape(size)..    
+000082b0: 6966 206b 6579 2069 7320 4e6f 6e65 3a0d  if key is None:.
+000082c0: 0a20 2020 2020 206b 6579 7320 3d20 7365  .      keys = se
+000082d0: 6c66 2e73 706c 6974 5f6b 6579 7328 3329  lf.split_keys(3)
+000082e0: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
+000082f0: 2020 206b 6579 7320 3d20 6a72 2e73 706c     keys = jr.spl
+00008300: 6974 285f 666f 726d 616c 697a 655f 6b65  it(_formalize_ke
+00008310: 7928 6b65 7929 2c20 3329 0d0a 2020 2020  y(key), 3)..    
+00008320: 6920 3d20 6a72 2e70 6f69 7373 6f6e 286b  i = jr.poisson(k
+00008330: 6579 735b 305d 2c20 302e 3520 2a20 6e6f  eys[0], 0.5 * no
+00008340: 6e63 2c20 7368 6170 653d 7369 7a65 2c20  nc, shape=size, 
+00008350: 6474 7970 653d 656e 7669 726f 6e2e 6469  dtype=environ.di
+00008360: 7479 7065 2829 290d 0a20 2020 206e 203d  type())..    n =
+00008370: 206a 722e 6e6f 726d 616c 286b 6579 735b   jr.normal(keys[
+00008380: 315d 2c20 7368 6170 653d 7369 7a65 2c20  1], shape=size, 
+00008390: 6474 7970 653d 6474 7970 6529 202b 206a  dtype=dtype) + j
+000083a0: 6e70 2e73 7172 7428 6e6f 6e63 290d 0a20  np.sqrt(nonc).. 
+000083b0: 2020 2063 6f6e 6420 3d20 6a6e 702e 6772     cond = jnp.gr
+000083c0: 6561 7465 7228 6466 2c20 312e 3029 0d0a  eater(df, 1.0)..
+000083d0: 2020 2020 6466 3220 3d20 6a6e 702e 7768      df2 = jnp.wh
+000083e0: 6572 6528 636f 6e64 2c20 6466 202d 2031  ere(cond, df - 1
+000083f0: 2e30 2c20 6466 202b 2032 2e30 202a 2069  .0, df + 2.0 * i
+00008400: 290d 0a20 2020 2063 6869 3220 3d20 322e  )..    chi2 = 2.
+00008410: 3020 2a20 6a72 2e67 616d 6d61 286b 6579  0 * jr.gamma(key
+00008420: 735b 325d 2c20 302e 3520 2a20 6466 322c  s[2], 0.5 * df2,
+00008430: 2073 6861 7065 3d73 697a 652c 2064 7479   shape=size, dty
+00008440: 7065 3d64 7479 7065 290d 0a20 2020 2072  pe=dtype)..    r
+00008450: 203d 206a 6e70 2e77 6865 7265 2863 6f6e   = jnp.where(con
+00008460: 642c 2063 6869 3220 2b20 6e20 2a20 6e2c  d, chi2 + n * n,
+00008470: 2063 6869 3229 0d0a 2020 2020 7265 7475   chi2)..    retu
+00008480: 726e 2072 0d0a 0d0a 2020 6465 6620 6c6f  rn r....  def lo
+00008490: 6767 616d 6d61 2873 656c 662c 0d0a 2020  ggamma(self,..  
+000084a0: 2020 2020 2020 2020 2020 2020 2061 2c0d               a,.
+000084b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000084c0: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b53  size: Optional[S
+000084d0: 697a 655d 203d 204e 6f6e 652c 0d0a 2020  ize] = None,..  
+000084e0: 2020 2020 2020 2020 2020 2020 206b 6579               key
+000084f0: 3a20 4f70 7469 6f6e 616c 5b53 6565 644f  : Optional[SeedO
+00008500: 724b 6579 5d20 3d20 4e6f 6e65 2c0d 0a20  rKey] = None,.. 
+00008510: 2020 2020 2020 2020 2020 2020 2020 6474                dt
+00008520: 7970 653a 2044 5479 7065 4c69 6b65 203d  ype: DTypeLike =
+00008530: 204e 6f6e 6529 3a0d 0a20 2020 2064 7479   None):..    dty
+00008540: 7065 203d 2064 7479 7065 206f 7220 656e  pe = dtype or en
+00008550: 7669 726f 6e2e 6466 7479 7065 2829 0d0a  viron.dftype()..
+00008560: 2020 2020 6b65 7920 3d20 7365 6c66 2e73      key = self.s
+00008570: 706c 6974 5f6b 6579 2829 2069 6620 6b65  plit_key() if ke
+00008580: 7920 6973 204e 6f6e 6520 656c 7365 205f  y is None else _
+00008590: 666f 726d 616c 697a 655f 6b65 7928 6b65  formalize_key(ke
+000085a0: 7929 0d0a 2020 2020 6120 3d20 5f63 6865  y)..    a = _che
+000085b0: 636b 5f70 795f 7365 7128 6129 0d0a 2020  ck_py_seq(a)..  
+000085c0: 2020 6966 2073 697a 6520 6973 204e 6f6e    if size is Non
+000085d0: 653a 0d0a 2020 2020 2020 7369 7a65 203d  e:..      size =
+000085e0: 206a 6e70 2e73 6861 7065 2861 290d 0a20   jnp.shape(a).. 
+000085f0: 2020 2072 203d 206a 722e 6c6f 6767 616d     r = jr.loggam
+00008600: 6d61 286b 6579 2c20 612c 2073 6861 7065  ma(key, a, shape
+00008610: 3d5f 7369 7a65 3273 6861 7065 2873 697a  =_size2shape(siz
+00008620: 6529 2c20 6474 7970 653d 6474 7970 6529  e), dtype=dtype)
+00008630: 0d0a 2020 2020 7265 7475 726e 2072 0d0a  ..    return r..
+00008640: 0d0a 2020 6465 6620 6361 7465 676f 7269  ..  def categori
+00008650: 6361 6c28 7365 6c66 2c0d 0a20 2020 2020  cal(self,..     
+00008660: 2020 2020 2020 2020 2020 2020 206c 6f67               log
+00008670: 6974 732c 0d0a 2020 2020 2020 2020 2020  its,..          
+00008680: 2020 2020 2020 2020 6178 6973 3a20 696e          axis: in
+00008690: 7420 3d20 2d31 2c0d 0a20 2020 2020 2020  t = -1,..       
+000086a0: 2020 2020 2020 2020 2020 2073 697a 653a             size:
+000086b0: 204f 7074 696f 6e61 6c5b 5369 7a65 5d20   Optional[Size] 
+000086c0: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 2020  = None,..       
+000086d0: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
+000086e0: 4f70 7469 6f6e 616c 5b53 6565 644f 724b  Optional[SeedOrK
+000086f0: 6579 5d20 3d20 4e6f 6e65 293a 0d0a 2020  ey] = None):..  
+00008700: 2020 6b65 7920 3d20 7365 6c66 2e73 706c    key = self.spl
+00008710: 6974 5f6b 6579 2829 2069 6620 6b65 7920  it_key() if key 
+00008720: 6973 204e 6f6e 6520 656c 7365 205f 666f  is None else _fo
+00008730: 726d 616c 697a 655f 6b65 7928 6b65 7929  rmalize_key(key)
+00008740: 0d0a 2020 2020 6c6f 6769 7473 203d 205f  ..    logits = _
+00008750: 6368 6563 6b5f 7079 5f73 6571 286c 6f67  check_py_seq(log
+00008760: 6974 7329 0d0a 2020 2020 6966 2073 697a  its)..    if siz
+00008770: 6520 6973 204e 6f6e 653a 0d0a 2020 2020  e is None:..    
+00008780: 2020 7369 7a65 203d 206c 6973 7428 6a6e    size = list(jn
+00008790: 702e 7368 6170 6528 6c6f 6769 7473 2929  p.shape(logits))
+000087a0: 0d0a 2020 2020 2020 7369 7a65 2e70 6f70  ..      size.pop
+000087b0: 2861 7869 7329 0d0a 2020 2020 7220 3d20  (axis)..    r = 
+000087c0: 6a72 2e63 6174 6567 6f72 6963 616c 286b  jr.categorical(k
+000087d0: 6579 2c20 6c6f 6769 7473 2c20 6178 6973  ey, logits, axis
+000087e0: 3d61 7869 732c 2073 6861 7065 3d5f 7369  =axis, shape=_si
+000087f0: 7a65 3273 6861 7065 2873 697a 6529 290d  ze2shape(size)).
+00008800: 0a20 2020 2072 6574 7572 6e20 720d 0a0d  .    return r...
+00008810: 0a20 2064 6566 207a 6970 6628 7365 6c66  .  def zipf(self
+00008820: 2c0d 0a20 2020 2020 2020 2020 2020 612c  ,..           a,
+00008830: 0d0a 2020 2020 2020 2020 2020 2073 697a  ..           siz
+00008840: 653a 204f 7074 696f 6e61 6c5b 5369 7a65  e: Optional[Size
+00008850: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2020  ] = None,..     
+00008860: 2020 2020 2020 6b65 793a 204f 7074 696f        key: Optio
+00008870: 6e61 6c5b 5365 6564 4f72 4b65 795d 203d  nal[SeedOrKey] =
+00008880: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
+00008890: 2020 2064 7479 7065 3a20 4454 7970 654c     dtype: DTypeL
+000088a0: 696b 6520 3d20 4e6f 6e65 293a 0d0a 2020  ike = None):..  
+000088b0: 2020 6120 3d20 5f63 6865 636b 5f70 795f    a = _check_py_
+000088c0: 7365 7128 6129 0d0a 2020 2020 6966 2073  seq(a)..    if s
+000088d0: 697a 6520 6973 204e 6f6e 653a 0d0a 2020  ize is None:..  
+000088e0: 2020 2020 7369 7a65 203d 206a 6e70 2e73      size = jnp.s
+000088f0: 6861 7065 2861 290d 0a20 2020 2064 7479  hape(a)..    dty
+00008900: 7065 203d 2064 7479 7065 206f 7220 656e  pe = dtype or en
+00008910: 7669 726f 6e2e 6469 7479 7065 2829 0d0a  viron.ditype()..
+00008920: 2020 2020 7220 3d20 6a61 782e 7075 7265      r = jax.pure
+00008930: 5f63 616c 6c62 6163 6b28 6c61 6d62 6461  _callback(lambda
+00008940: 2078 3a20 6e70 2e72 616e 646f 6d2e 7a69   x: np.random.zi
+00008950: 7066 2878 2c20 7369 7a65 292e 6173 7479  pf(x, size).asty
+00008960: 7065 2864 7479 7065 292c 0d0a 2020 2020  pe(dtype),..    
+00008970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008980: 2020 2020 2020 6a61 782e 5368 6170 6544        jax.ShapeD
+00008990: 7479 7065 5374 7275 6374 2873 697a 652c  typeStruct(size,
+000089a0: 2064 7479 7065 292c 0d0a 2020 2020 2020   dtype),..      
+000089b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000089c0: 2020 2020 6129 0d0a 2020 2020 7265 7475      a)..    retu
+000089d0: 726e 2072 0d0a 0d0a 2020 6465 6620 706f  rn r....  def po
+000089e0: 7765 7228 7365 6c66 2c0d 0a20 2020 2020  wer(self,..     
+000089f0: 2020 2020 2020 2061 2c0d 0a20 2020 2020         a,..     
+00008a00: 2020 2020 2020 2073 697a 653a 204f 7074         size: Opt
+00008a10: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
+00008a20: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
+00008a30: 206b 6579 3a20 4f70 7469 6f6e 616c 5b53   key: Optional[S
+00008a40: 6565 644f 724b 6579 5d20 3d20 4e6f 6e65  eedOrKey] = None
+00008a50: 2c0d 0a20 2020 2020 2020 2020 2020 2064  ,..            d
+00008a60: 7479 7065 3a20 4454 7970 654c 696b 6520  type: DTypeLike 
+00008a70: 3d20 4e6f 6e65 293a 0d0a 2020 2020 6120  = None):..    a 
+00008a80: 3d20 5f63 6865 636b 5f70 795f 7365 7128  = _check_py_seq(
+00008a90: 6129 0d0a 2020 2020 6966 2073 697a 6520  a)..    if size 
+00008aa0: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
+00008ab0: 7369 7a65 203d 206a 6e70 2e73 6861 7065  size = jnp.shape
+00008ac0: 2861 290d 0a20 2020 2073 697a 6520 3d20  (a)..    size = 
+00008ad0: 5f73 697a 6532 7368 6170 6528 7369 7a65  _size2shape(size
+00008ae0: 290d 0a20 2020 2064 7479 7065 203d 2064  )..    dtype = d
+00008af0: 7479 7065 206f 7220 656e 7669 726f 6e2e  type or environ.
+00008b00: 6466 7479 7065 2829 0d0a 2020 2020 7220  dftype()..    r 
+00008b10: 3d20 6a61 782e 7075 7265 5f63 616c 6c62  = jax.pure_callb
+00008b20: 6163 6b28 6c61 6d62 6461 2061 3a20 6e70  ack(lambda a: np
+00008b30: 2e72 616e 646f 6d2e 706f 7765 7228 613d  .random.power(a=
+00008b40: 612c 2073 697a 653d 7369 7a65 292e 6173  a, size=size).as
+00008b50: 7479 7065 2864 7479 7065 292c 0d0a 2020  type(dtype),..  
+00008b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008b70: 2020 2020 2020 2020 6a61 782e 5368 6170          jax.Shap
+00008b80: 6544 7479 7065 5374 7275 6374 2873 697a  eDtypeStruct(siz
+00008b90: 652c 2064 7479 7065 292c 0d0a 2020 2020  e, dtype),..    
+00008ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008bb0: 2020 2020 2020 6129 0d0a 2020 2020 7265        a)..    re
+00008bc0: 7475 726e 2072 0d0a 0d0a 2020 6465 6620  turn r....  def 
+00008bd0: 6628 7365 6c66 2c0d 0a20 2020 2020 2020  f(self,..       
+00008be0: 2064 666e 756d 2c0d 0a20 2020 2020 2020   dfnum,..       
+00008bf0: 2064 6664 656e 2c0d 0a20 2020 2020 2020   dfden,..       
+00008c00: 2073 697a 653a 204f 7074 696f 6e61 6c5b   size: Optional[
+00008c10: 5369 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20  Size] = None,.. 
+00008c20: 2020 2020 2020 206b 6579 3a20 4f70 7469         key: Opti
+00008c30: 6f6e 616c 5b53 6565 644f 724b 6579 5d20  onal[SeedOrKey] 
+00008c40: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 2020  = None,..       
+00008c50: 2064 7479 7065 3a20 4454 7970 654c 696b   dtype: DTypeLik
+00008c60: 6520 3d20 4e6f 6e65 293a 0d0a 2020 2020  e = None):..    
+00008c70: 6466 6e75 6d20 3d20 5f63 6865 636b 5f70  dfnum = _check_p
+00008c80: 795f 7365 7128 6466 6e75 6d29 0d0a 2020  y_seq(dfnum)..  
+00008c90: 2020 6466 6465 6e20 3d20 5f63 6865 636b    dfden = _check
+00008ca0: 5f70 795f 7365 7128 6466 6465 6e29 0d0a  _py_seq(dfden)..
+00008cb0: 2020 2020 6966 2073 697a 6520 6973 204e      if size is N
+00008cc0: 6f6e 653a 0d0a 2020 2020 2020 7369 7a65  one:..      size
+00008cd0: 203d 206a 6e70 2e62 726f 6164 6361 7374   = jnp.broadcast
+00008ce0: 5f73 6861 7065 7328 6a6e 702e 7368 6170  _shapes(jnp.shap
+00008cf0: 6528 6466 6e75 6d29 2c20 6a6e 702e 7368  e(dfnum), jnp.sh
+00008d00: 6170 6528 6466 6465 6e29 290d 0a20 2020  ape(dfden))..   
+00008d10: 2073 697a 6520 3d20 5f73 697a 6532 7368   size = _size2sh
+00008d20: 6170 6528 7369 7a65 290d 0a20 2020 2064  ape(size)..    d
+00008d30: 203d 207b 2764 666e 756d 273a 2064 666e   = {'dfnum': dfn
+00008d40: 756d 2c20 2764 6664 656e 273a 2064 6664  um, 'dfden': dfd
+00008d50: 656e 7d0d 0a20 2020 2064 7479 7065 203d  en}..    dtype =
+00008d60: 2064 7479 7065 206f 7220 656e 7669 726f   dtype or enviro
+00008d70: 6e2e 6466 7479 7065 2829 0d0a 2020 2020  n.dftype()..    
+00008d80: 7220 3d20 6a61 782e 7075 7265 5f63 616c  r = jax.pure_cal
+00008d90: 6c62 6163 6b28 6c61 6d62 6461 2064 666e  lback(lambda dfn
+00008da0: 756d 5f2c 2064 6664 656e 5f3a 206e 702e  um_, dfden_: np.
+00008db0: 7261 6e64 6f6d 2e66 2864 666e 756d 3d64  random.f(dfnum=d
+00008dc0: 666e 756d 5f2c 0d0a 2020 2020 2020 2020  fnum_,..        
+00008dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008e00: 2020 2020 2064 6664 656e 3d64 6664 656e       dfden=dfden
+00008e10: 5f2c 0d0a 2020 2020 2020 2020 2020 2020  _,..            
+00008e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008e50: 2073 697a 653d 7369 7a65 292e 6173 7479   size=size).asty
+00008e60: 7065 2864 7479 7065 292c 0d0a 2020 2020  pe(dtype),..    
 00008e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008e90: 6a6e 702e 7368 6170 6528 6e62 6164 292c  jnp.shape(nbad),
-00008ea0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008e80: 2020 2020 2020 6a61 782e 5368 6170 6544        jax.ShapeD
+00008e90: 7479 7065 5374 7275 6374 2873 697a 652c  typeStruct(size,
+00008ea0: 2064 7479 7065 292c 0d0a 2020 2020 2020   dtype),..      
 00008eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008ec0: 2020 2020 6a6e 702e 7368 6170 6528 6e73      jnp.shape(ns
-00008ed0: 616d 706c 6529 290d 0a20 2020 2073 697a  ample))..    siz
-00008ee0: 6520 3d20 5f73 697a 6532 7368 6170 6528  e = _size2shape(
-00008ef0: 7369 7a65 290d 0a20 2020 2064 7479 7065  size)..    dtype
-00008f00: 203d 2064 7479 7065 206f 7220 656e 7669   = dtype or envi
-00008f10: 726f 6e2e 6469 7479 7065 2829 0d0a 2020  ron.ditype()..  
-00008f20: 2020 6420 3d20 7b27 6e67 6f6f 6427 3a20    d = {'ngood': 
-00008f30: 6e67 6f6f 642c 2027 6e62 6164 273a 206e  ngood, 'nbad': n
-00008f40: 6261 642c 2027 6e73 616d 706c 6527 3a20  bad, 'nsample': 
-00008f50: 6e73 616d 706c 657d 0d0a 2020 2020 7220  nsample}..    r 
-00008f60: 3d20 6361 6c6c 286c 616d 6264 6120 643a  = call(lambda d:
-00008f70: 206e 702e 7261 6e64 6f6d 2e68 7970 6572   np.random.hyper
-00008f80: 6765 6f6d 6574 7269 6328 6e67 6f6f 643d  geometric(ngood=
-00008f90: 645b 276e 676f 6f64 275d 2c0d 0a20 2020  d['ngood'],..   
-00008fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008fc0: 2020 2020 2020 2020 2020 2020 206e 6261               nba
-00008fd0: 643d 645b 276e 6261 6427 5d2c 0d0a 2020  d=d['nbad'],..  
-00008fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009000: 2020 2020 2020 2020 2020 2020 2020 6e73                ns
-00009010: 616d 706c 653d 645b 276e 7361 6d70 6c65  ample=d['nsample
-00009020: 275d 2c0d 0a20 2020 2020 2020 2020 2020  '],..           
-00009030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009050: 2020 2020 2073 697a 653d 7369 7a65 292e       size=size).
-00009060: 6173 7479 7065 2864 7479 7065 292c 0d0a  astype(dtype),..
-00009070: 2020 2020 2020 2020 2020 2020 2064 2c0d               d,.
-00009080: 0a20 2020 2020 2020 2020 2020 2020 7265  .             re
-00009090: 7375 6c74 5f73 6861 7065 3d6a 6178 2e53  sult_shape=jax.S
-000090a0: 6861 7065 4474 7970 6553 7472 7563 7428  hapeDtypeStruct(
-000090b0: 7369 7a65 2c20 6474 7970 6529 290d 0a20  size, dtype)).. 
-000090c0: 2020 2072 6574 7572 6e20 720d 0a0d 0a20     return r.... 
-000090d0: 2064 6566 206c 6f67 7365 7269 6573 2873   def logseries(s
-000090e0: 656c 662c 0d0a 2020 2020 2020 2020 2020  elf,..          
-000090f0: 2020 2020 2020 702c 0d0a 2020 2020 2020        p,..      
-00009100: 2020 2020 2020 2020 2020 7369 7a65 3a20            size: 
-00009110: 4f70 7469 6f6e 616c 5b53 697a 655d 203d  Optional[Size] =
-00009120: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
-00009130: 2020 2020 2020 2020 6b65 793a 204f 7074          key: Opt
-00009140: 696f 6e61 6c5b 5365 6564 4f72 4b65 795d  ional[SeedOrKey]
-00009150: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
-00009160: 2020 2020 2020 2020 2020 6474 7970 653a            dtype:
-00009170: 2044 5479 7065 4c69 6b65 203d 204e 6f6e   DTypeLike = Non
-00009180: 6529 3a0d 0a20 2020 2070 203d 205f 6368  e):..    p = _ch
-00009190: 6563 6b5f 7079 5f73 6571 2870 290d 0a20  eck_py_seq(p).. 
-000091a0: 2020 2069 6620 7369 7a65 2069 7320 4e6f     if size is No
-000091b0: 6e65 3a0d 0a20 2020 2020 2073 697a 6520  ne:..      size 
-000091c0: 3d20 6a6e 702e 7368 6170 6528 7029 0d0a  = jnp.shape(p)..
-000091d0: 2020 2020 7369 7a65 203d 205f 7369 7a65      size = _size
-000091e0: 3273 6861 7065 2873 697a 6529 0d0a 2020  2shape(size)..  
-000091f0: 2020 6474 7970 6520 3d20 6474 7970 6520    dtype = dtype 
-00009200: 6f72 2065 6e76 6972 6f6e 2e64 6974 7970  or environ.dityp
-00009210: 6528 290d 0a20 2020 2072 203d 2063 616c  e()..    r = cal
-00009220: 6c28 6c61 6d62 6461 2070 3a20 6e70 2e72  l(lambda p: np.r
-00009230: 616e 646f 6d2e 6c6f 6773 6572 6965 7328  andom.logseries(
-00009240: 703d 702c 2073 697a 653d 7369 7a65 292e  p=p, size=size).
-00009250: 6173 7479 7065 2864 7479 7065 292c 0d0a  astype(dtype),..
-00009260: 2020 2020 2020 2020 2020 2020 2070 2c0d               p,.
-00009270: 0a20 2020 2020 2020 2020 2020 2020 7265  .             re
-00009280: 7375 6c74 5f73 6861 7065 3d6a 6178 2e53  sult_shape=jax.S
-00009290: 6861 7065 4474 7970 6553 7472 7563 7428  hapeDtypeStruct(
-000092a0: 7369 7a65 2c20 6474 7970 6529 290d 0a20  size, dtype)).. 
-000092b0: 2020 2072 6574 7572 6e20 720d 0a0d 0a20     return r.... 
-000092c0: 2064 6566 206e 6f6e 6365 6e74 7261 6c5f   def noncentral_
-000092d0: 6628 7365 6c66 2c0d 0a20 2020 2020 2020  f(self,..       
-000092e0: 2020 2020 2020 2020 2020 2020 6466 6e75              dfnu
-000092f0: 6d2c 0d0a 2020 2020 2020 2020 2020 2020  m,..            
-00009300: 2020 2020 2020 2064 6664 656e 2c0d 0a20         dfden,.. 
-00009310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009320: 2020 6e6f 6e63 2c0d 0a20 2020 2020 2020    nonc,..       
-00009330: 2020 2020 2020 2020 2020 2020 7369 7a65              size
-00009340: 3a20 4f70 7469 6f6e 616c 5b53 697a 655d  : Optional[Size]
-00009350: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
-00009360: 2020 2020 2020 2020 2020 2020 206b 6579               key
-00009370: 3a20 4f70 7469 6f6e 616c 5b53 6565 644f  : Optional[SeedO
-00009380: 724b 6579 5d20 3d20 4e6f 6e65 2c0d 0a20  rKey] = None,.. 
-00009390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000093a0: 2020 6474 7970 653a 2044 5479 7065 4c69    dtype: DTypeLi
-000093b0: 6b65 203d 204e 6f6e 6529 3a0d 0a20 2020  ke = None):..   
-000093c0: 2064 666e 756d 203d 205f 6368 6563 6b5f   dfnum = _check_
-000093d0: 7079 5f73 6571 2864 666e 756d 290d 0a20  py_seq(dfnum).. 
-000093e0: 2020 2064 6664 656e 203d 205f 6368 6563     dfden = _chec
-000093f0: 6b5f 7079 5f73 6571 2864 6664 656e 290d  k_py_seq(dfden).
-00009400: 0a20 2020 206e 6f6e 6320 3d20 5f63 6865  .    nonc = _che
-00009410: 636b 5f70 795f 7365 7128 6e6f 6e63 290d  ck_py_seq(nonc).
-00009420: 0a20 2020 2069 6620 7369 7a65 2069 7320  .    if size is 
-00009430: 4e6f 6e65 3a0d 0a20 2020 2020 2073 697a  None:..      siz
-00009440: 6520 3d20 6c61 782e 6272 6f61 6463 6173  e = lax.broadcas
-00009450: 745f 7368 6170 6573 286a 6e70 2e73 6861  t_shapes(jnp.sha
-00009460: 7065 2864 666e 756d 292c 0d0a 2020 2020  pe(dfnum),..    
-00009470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009480: 2020 2020 2020 2020 2020 2020 2020 6a6e                jn
-00009490: 702e 7368 6170 6528 6466 6465 6e29 2c0d  p.shape(dfden),.
-000094a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000094b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000094c0: 2020 206a 6e70 2e73 6861 7065 286e 6f6e     jnp.shape(non
-000094d0: 6329 290d 0a20 2020 2073 697a 6520 3d20  c))..    size = 
-000094e0: 5f73 697a 6532 7368 6170 6528 7369 7a65  _size2shape(size
-000094f0: 290d 0a20 2020 2064 203d 207b 2764 666e  )..    d = {'dfn
-00009500: 756d 273a 2064 666e 756d 2c20 2764 6664  um': dfnum, 'dfd
-00009510: 656e 273a 2064 6664 656e 2c20 276e 6f6e  en': dfden, 'non
-00009520: 6327 3a20 6e6f 6e63 7d0d 0a20 2020 2064  c': nonc}..    d
-00009530: 7479 7065 203d 2064 7479 7065 206f 7220  type = dtype or 
-00009540: 656e 7669 726f 6e2e 6466 7479 7065 2829  environ.dftype()
-00009550: 0d0a 2020 2020 7220 3d20 6361 6c6c 286c  ..    r = call(l
-00009560: 616d 6264 6120 783a 206e 702e 7261 6e64  ambda x: np.rand
-00009570: 6f6d 2e6e 6f6e 6365 6e74 7261 6c5f 6628  om.noncentral_f(
-00009580: 6466 6e75 6d3d 785b 2764 666e 756d 275d  dfnum=x['dfnum']
-00009590: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00008ec0: 2020 2020 6466 6e75 6d2c 2064 6664 656e      dfnum, dfden
+00008ed0: 290d 0a20 2020 2072 6574 7572 6e20 720d  )..    return r.
+00008ee0: 0a0d 0a20 2064 6566 2068 7970 6572 6765  ...  def hyperge
+00008ef0: 6f6d 6574 7269 6328 0d0a 2020 2020 2020  ometric(..      
+00008f00: 7365 6c66 2c0d 0a20 2020 2020 206e 676f  self,..      ngo
+00008f10: 6f64 2c0d 0a20 2020 2020 206e 6261 642c  od,..      nbad,
+00008f20: 0d0a 2020 2020 2020 6e73 616d 706c 652c  ..      nsample,
+00008f30: 0d0a 2020 2020 2020 7369 7a65 3a20 4f70  ..      size: Op
+00008f40: 7469 6f6e 616c 5b53 697a 655d 203d 204e  tional[Size] = N
+00008f50: 6f6e 652c 0d0a 2020 2020 2020 6b65 793a  one,..      key:
+00008f60: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
+00008f70: 4b65 795d 203d 204e 6f6e 652c 0d0a 2020  Key] = None,..  
+00008f80: 2020 2020 6474 7970 653a 2044 5479 7065      dtype: DType
+00008f90: 4c69 6b65 203d 204e 6f6e 650d 0a20 2029  Like = None..  )
+00008fa0: 3a0d 0a20 2020 206e 676f 6f64 203d 205f  :..    ngood = _
+00008fb0: 6368 6563 6b5f 7079 5f73 6571 286e 676f  check_py_seq(ngo
+00008fc0: 6f64 290d 0a20 2020 206e 6261 6420 3d20  od)..    nbad = 
+00008fd0: 5f63 6865 636b 5f70 795f 7365 7128 6e62  _check_py_seq(nb
+00008fe0: 6164 290d 0a20 2020 206e 7361 6d70 6c65  ad)..    nsample
+00008ff0: 203d 205f 6368 6563 6b5f 7079 5f73 6571   = _check_py_seq
+00009000: 286e 7361 6d70 6c65 290d 0a0d 0a20 2020  (nsample)....   
+00009010: 2069 6620 7369 7a65 2069 7320 4e6f 6e65   if size is None
+00009020: 3a0d 0a20 2020 2020 2073 697a 6520 3d20  :..      size = 
+00009030: 6c61 782e 6272 6f61 6463 6173 745f 7368  lax.broadcast_sh
+00009040: 6170 6573 286a 6e70 2e73 6861 7065 286e  apes(jnp.shape(n
+00009050: 676f 6f64 292c 0d0a 2020 2020 2020 2020  good),..        
+00009060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009070: 2020 2020 2020 2020 2020 6a6e 702e 7368            jnp.sh
+00009080: 6170 6528 6e62 6164 292c 0d0a 2020 2020  ape(nbad),..    
+00009090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000090a0: 2020 2020 2020 2020 2020 2020 2020 6a6e                jn
+000090b0: 702e 7368 6170 6528 6e73 616d 706c 6529  p.shape(nsample)
+000090c0: 290d 0a20 2020 2073 697a 6520 3d20 5f73  )..    size = _s
+000090d0: 697a 6532 7368 6170 6528 7369 7a65 290d  ize2shape(size).
+000090e0: 0a20 2020 2064 7479 7065 203d 2064 7479  .    dtype = dty
+000090f0: 7065 206f 7220 656e 7669 726f 6e2e 6469  pe or environ.di
+00009100: 7479 7065 2829 0d0a 2020 2020 6420 3d20  type()..    d = 
+00009110: 7b27 6e67 6f6f 6427 3a20 6e67 6f6f 642c  {'ngood': ngood,
+00009120: 2027 6e62 6164 273a 206e 6261 642c 2027   'nbad': nbad, '
+00009130: 6e73 616d 706c 6527 3a20 6e73 616d 706c  nsample': nsampl
+00009140: 657d 0d0a 2020 2020 7220 3d20 6a61 782e  e}..    r = jax.
+00009150: 7075 7265 5f63 616c 6c62 6163 6b28 6c61  pure_callback(la
+00009160: 6d62 6461 2064 3a20 6e70 2e72 616e 646f  mbda d: np.rando
+00009170: 6d2e 6879 7065 7267 656f 6d65 7472 6963  m.hypergeometric
+00009180: 286e 676f 6f64 3d64 5b27 6e67 6f6f 6427  (ngood=d['ngood'
+00009190: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+000091a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000091b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000091c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000091d0: 206e 6261 643d 645b 276e 6261 6427 5d2c   nbad=d['nbad'],
+000091e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000091f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009210: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00009220: 7361 6d70 6c65 3d64 5b27 6e73 616d 706c  sample=d['nsampl
+00009230: 6527 5d2c 0d0a 2020 2020 2020 2020 2020  e'],..          
+00009240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009270: 2020 2073 697a 653d 7369 7a65 292e 6173     size=size).as
+00009280: 7479 7065 2864 7479 7065 292c 0d0a 2020  type(dtype),..  
+00009290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000092a0: 2020 2020 2020 2020 6a61 782e 5368 6170          jax.Shap
+000092b0: 6544 7479 7065 5374 7275 6374 2873 697a  eDtypeStruct(siz
+000092c0: 652c 2064 7479 7065 292c 0d0a 2020 2020  e, dtype),..    
+000092d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000092e0: 2020 2020 2020 6429 0d0a 2020 2020 7265        d)..    re
+000092f0: 7475 726e 2072 0d0a 0d0a 2020 6465 6620  turn r....  def 
+00009300: 6c6f 6773 6572 6965 7328 7365 6c66 2c0d  logseries(self,.
+00009310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009320: 2070 2c0d 0a20 2020 2020 2020 2020 2020   p,..           
+00009330: 2020 2020 2073 697a 653a 204f 7074 696f       size: Optio
+00009340: 6e61 6c5b 5369 7a65 5d20 3d20 4e6f 6e65  nal[Size] = None
+00009350: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00009360: 2020 206b 6579 3a20 4f70 7469 6f6e 616c     key: Optional
+00009370: 5b53 6565 644f 724b 6579 5d20 3d20 4e6f  [SeedOrKey] = No
+00009380: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
+00009390: 2020 2020 2064 7479 7065 3a20 4454 7970       dtype: DTyp
+000093a0: 654c 696b 6520 3d20 4e6f 6e65 293a 0d0a  eLike = None):..
+000093b0: 2020 2020 7020 3d20 5f63 6865 636b 5f70      p = _check_p
+000093c0: 795f 7365 7128 7029 0d0a 2020 2020 6966  y_seq(p)..    if
+000093d0: 2073 697a 6520 6973 204e 6f6e 653a 0d0a   size is None:..
+000093e0: 2020 2020 2020 7369 7a65 203d 206a 6e70        size = jnp
+000093f0: 2e73 6861 7065 2870 290d 0a20 2020 2073  .shape(p)..    s
+00009400: 697a 6520 3d20 5f73 697a 6532 7368 6170  ize = _size2shap
+00009410: 6528 7369 7a65 290d 0a20 2020 2064 7479  e(size)..    dty
+00009420: 7065 203d 2064 7479 7065 206f 7220 656e  pe = dtype or en
+00009430: 7669 726f 6e2e 6469 7479 7065 2829 0d0a  viron.ditype()..
+00009440: 2020 2020 7220 3d20 6a61 782e 7075 7265      r = jax.pure
+00009450: 5f63 616c 6c62 6163 6b28 6c61 6d62 6461  _callback(lambda
+00009460: 2070 3a20 6e70 2e72 616e 646f 6d2e 6c6f   p: np.random.lo
+00009470: 6773 6572 6965 7328 703d 702c 2073 697a  gseries(p=p, siz
+00009480: 653d 7369 7a65 292e 6173 7479 7065 2864  e=size).astype(d
+00009490: 7479 7065 292c 0d0a 2020 2020 2020 2020  type),..        
+000094a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000094b0: 2020 6a61 782e 5368 6170 6544 7479 7065    jax.ShapeDtype
+000094c0: 5374 7275 6374 2873 697a 652c 2064 7479  Struct(size, dty
+000094d0: 7065 292c 0d0a 2020 2020 2020 2020 2020  pe),..          
+000094e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000094f0: 7029 0d0a 2020 2020 7265 7475 726e 2072  p)..    return r
+00009500: 0d0a 0d0a 2020 6465 6620 6e6f 6e63 656e  ....  def noncen
+00009510: 7472 616c 5f66 2873 656c 662c 0d0a 2020  tral_f(self,..  
+00009520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009530: 2064 666e 756d 2c0d 0a20 2020 2020 2020   dfnum,..       
+00009540: 2020 2020 2020 2020 2020 2020 6466 6465              dfde
+00009550: 6e2c 0d0a 2020 2020 2020 2020 2020 2020  n,..            
+00009560: 2020 2020 2020 206e 6f6e 632c 0d0a 2020         nonc,..  
+00009570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009580: 2073 697a 653a 204f 7074 696f 6e61 6c5b   size: Optional[
+00009590: 5369 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20  Size] = None,.. 
 000095a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000095b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000095c0: 2064 6664 656e 3d78 5b27 6466 6465 6e27   dfden=x['dfden'
-000095d0: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-000095e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000095f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009600: 2020 6e6f 6e63 3d78 5b27 6e6f 6e63 275d    nonc=x['nonc']
-00009610: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00009620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009640: 2073 697a 653d 7369 7a65 292e 6173 7479   size=size).asty
-00009650: 7065 2864 7479 7065 292c 0d0a 2020 2020  pe(dtype),..    
-00009660: 2020 2020 2020 2020 2064 2c20 7265 7375           d, resu
-00009670: 6c74 5f73 6861 7065 3d6a 6178 2e53 6861  lt_shape=jax.Sha
-00009680: 7065 4474 7970 6553 7472 7563 7428 7369  peDtypeStruct(si
-00009690: 7a65 2c20 6474 7970 6529 290d 0a20 2020  ze, dtype))..   
-000096a0: 2072 6574 7572 6e20 720d 0a0d 0a20 2023   return r....  #
-000096b0: 2050 7954 6f72 6368 2063 6f6d 7061 7469   PyTorch compati
-000096c0: 6269 6c69 7479 2023 0d0a 2020 2320 2d2d  bility #..  # --
-000096d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000096e0: 2d2d 2d20 230d 0a0d 0a20 2064 6566 2072  --- #....  def r
-000096f0: 616e 645f 6c69 6b65 2873 656c 662c 2069  and_like(self, i
-00009700: 6e70 7574 2c20 2a2c 2064 7479 7065 3d4e  nput, *, dtype=N
-00009710: 6f6e 652c 206b 6579 3a20 4f70 7469 6f6e  one, key: Option
-00009720: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
-00009730: 4e6f 6e65 293a 0d0a 2020 2020 2222 2252  None):..    """R
-00009740: 6574 7572 6e73 2061 2074 656e 736f 7220  eturns a tensor 
-00009750: 7769 7468 2074 6865 2073 616d 6520 7369  with the same si
-00009760: 7a65 2061 7320 696e 7075 7420 7468 6174  ze as input that
-00009770: 2069 7320 6669 6c6c 6564 2077 6974 6820   is filled with 
-00009780: 7261 6e64 6f6d 0d0a 2020 2020 6e75 6d62  random..    numb
-00009790: 6572 7320 6672 6f6d 2061 2075 6e69 666f  ers from a unifo
-000097a0: 726d 2064 6973 7472 6962 7574 696f 6e20  rm distribution 
-000097b0: 6f6e 2074 6865 2069 6e74 6572 7661 6c20  on the interval 
-000097c0: 6060 5b30 2c20 3129 6060 2e0d 0a0d 0a20  ``[0, 1)``..... 
-000097d0: 2020 2041 7267 733a 0d0a 2020 2020 2020     Args:..      
-000097e0: 696e 7075 743a 2020 7468 6520 6060 7369  input:  the ``si
-000097f0: 7a65 6060 206f 6620 696e 7075 7420 7769  ze`` of input wi
-00009800: 6c6c 2064 6574 6572 6d69 6e65 2073 697a  ll determine siz
-00009810: 6520 6f66 2074 6865 206f 7574 7075 7420  e of the output 
-00009820: 7465 6e73 6f72 2e0d 0a20 2020 2020 2064  tensor...      d
-00009830: 7479 7065 3a20 2074 6865 2064 6573 6972  type:  the desir
-00009840: 6564 2064 6174 6120 7479 7065 206f 6620  ed data type of 
-00009850: 7265 7475 726e 6564 2054 656e 736f 722e  returned Tensor.
-00009860: 2044 6566 6175 6c74 3a20 6966 2060 604e   Default: if ``N
-00009870: 6f6e 6560 602c 2064 6566 6175 6c74 7320  one``, defaults 
-00009880: 746f 2074 6865 2064 7479 7065 206f 6620  to the dtype of 
-00009890: 696e 7075 742e 0d0a 2020 2020 2020 6b65  input...      ke
-000098a0: 793a 2074 6865 2073 6565 6420 6f72 206b  y: the seed or k
-000098b0: 6579 2066 6f72 2074 6865 2072 616e 646f  ey for the rando
-000098c0: 6d2e 0d0a 0d0a 2020 2020 5265 7475 726e  m.....    Return
-000098d0: 733a 0d0a 2020 2020 2020 5468 6520 7261  s:..      The ra
-000098e0: 6e64 6f6d 2064 6174 612e 0d0a 2020 2020  ndom data...    
-000098f0: 2222 220d 0a20 2020 2072 6574 7572 6e20  """..    return 
-00009900: 7365 6c66 2e72 616e 646f 6d28 6a6e 702e  self.random(jnp.
-00009910: 7368 6170 6528 696e 7075 7429 2c20 6b65  shape(input), ke
-00009920: 793d 6b65 7929 2e61 7374 7970 6528 6474  y=key).astype(dt
-00009930: 7970 6529 0d0a 0d0a 2020 6465 6620 7261  ype)....  def ra
-00009940: 6e64 6e5f 6c69 6b65 2873 656c 662c 2069  ndn_like(self, i
-00009950: 6e70 7574 2c20 2a2c 2064 7479 7065 3d4e  nput, *, dtype=N
-00009960: 6f6e 652c 206b 6579 3a20 4f70 7469 6f6e  one, key: Option
-00009970: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
-00009980: 4e6f 6e65 293a 0d0a 2020 2020 2222 2252  None):..    """R
-00009990: 6574 7572 6e73 2061 2074 656e 736f 7220  eturns a tensor 
-000099a0: 7769 7468 2074 6865 2073 616d 6520 7369  with the same si
-000099b0: 7a65 2061 7320 6060 696e 7075 7460 6020  ze as ``input`` 
-000099c0: 7468 6174 2069 7320 6669 6c6c 6564 2077  that is filled w
-000099d0: 6974 680d 0a20 2020 2072 616e 646f 6d20  ith..    random 
-000099e0: 6e75 6d62 6572 7320 6672 6f6d 2061 206e  numbers from a n
-000099f0: 6f72 6d61 6c20 6469 7374 7269 6275 7469  ormal distributi
-00009a00: 6f6e 2077 6974 6820 6d65 616e 2030 2061  on with mean 0 a
-00009a10: 6e64 2076 6172 6961 6e63 6520 312e 0d0a  nd variance 1...
-00009a20: 0d0a 2020 2020 4172 6773 3a0d 0a20 2020  ..    Args:..   
-00009a30: 2020 2069 6e70 7574 3a20 2074 6865 2060     input:  the `
-00009a40: 6073 697a 6560 6020 6f66 2069 6e70 7574  `size`` of input
-00009a50: 2077 696c 6c20 6465 7465 726d 696e 6520   will determine 
-00009a60: 7369 7a65 206f 6620 7468 6520 6f75 7470  size of the outp
-00009a70: 7574 2074 656e 736f 722e 0d0a 2020 2020  ut tensor...    
-00009a80: 2020 6474 7970 653a 2020 7468 6520 6465    dtype:  the de
-00009a90: 7369 7265 6420 6461 7461 2074 7970 6520  sired data type 
-00009aa0: 6f66 2072 6574 7572 6e65 6420 5465 6e73  of returned Tens
-00009ab0: 6f72 2e20 4465 6661 756c 743a 2069 6620  or. Default: if 
-00009ac0: 6060 4e6f 6e65 6060 2c20 6465 6661 756c  ``None``, defaul
-00009ad0: 7473 2074 6f20 7468 6520 6474 7970 6520  ts to the dtype 
-00009ae0: 6f66 2069 6e70 7574 2e0d 0a20 2020 2020  of input...     
-00009af0: 206b 6579 3a20 7468 6520 7365 6564 206f   key: the seed o
-00009b00: 7220 6b65 7920 666f 7220 7468 6520 7261  r key for the ra
-00009b10: 6e64 6f6d 2e0d 0a0d 0a20 2020 2052 6574  ndom.....    Ret
-00009b20: 7572 6e73 3a0d 0a20 2020 2020 2054 6865  urns:..      The
-00009b30: 2072 616e 646f 6d20 6461 7461 2e0d 0a20   random data... 
-00009b40: 2020 2022 2222 0d0a 2020 2020 7265 7475     """..    retu
-00009b50: 726e 2073 656c 662e 7261 6e64 6e28 2a6a  rn self.randn(*j
-00009b60: 6e70 2e73 6861 7065 2869 6e70 7574 292c  np.shape(input),
-00009b70: 206b 6579 3d6b 6579 292e 6173 7479 7065   key=key).astype
-00009b80: 2864 7479 7065 290d 0a0d 0a20 2064 6566  (dtype)....  def
-00009b90: 2072 616e 6469 6e74 5f6c 696b 6528 7365   randint_like(se
-00009ba0: 6c66 2c20 696e 7075 742c 206c 6f77 3d30  lf, input, low=0
-00009bb0: 2c20 6869 6768 3d4e 6f6e 652c 202a 2c20  , high=None, *, 
-00009bc0: 6474 7970 653d 4e6f 6e65 2c20 6b65 793a  dtype=None, key:
-00009bd0: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
-00009be0: 4b65 795d 203d 204e 6f6e 6529 3a0d 0a20  Key] = None):.. 
-00009bf0: 2020 2069 6620 6869 6768 2069 7320 4e6f     if high is No
-00009c00: 6e65 3a0d 0a20 2020 2020 2068 6967 6820  ne:..      high 
-00009c10: 3d20 6d61 7828 696e 7075 7429 0d0a 2020  = max(input)..  
-00009c20: 2020 7265 7475 726e 2073 656c 662e 7261    return self.ra
-00009c30: 6e64 696e 7428 6c6f 772c 2068 6967 683d  ndint(low, high=
-00009c40: 6869 6768 2c20 7369 7a65 3d6a 6e70 2e73  high, size=jnp.s
-00009c50: 6861 7065 2869 6e70 7574 292c 2064 7479  hape(input), dty
-00009c60: 7065 3d64 7479 7065 2c20 6b65 793d 6b65  pe=dtype, key=ke
-00009c70: 7929 0d0a 0d0a 0d0a 2320 6465 6661 756c  y)......# defaul
-00009c80: 7420 7261 6e64 6f6d 2067 656e 6572 6174  t random generat
-00009c90: 6f72 0d0a 4445 4641 554c 5420 3d20 5261  or..DEFAULT = Ra
-00009ca0: 6e64 6f6d 5374 6174 6528 6e70 2e72 616e  ndomState(np.ran
-00009cb0: 646f 6d2e 7261 6e64 696e 7428 302c 2031  dom.randint(0, 1
-00009cc0: 3030 3030 2c20 7369 7a65 3d32 2c20 6474  0000, size=2, dt
-00009cd0: 7970 653d 6e70 2e75 696e 7433 3229 290d  ype=np.uint32)).
-00009ce0: 0a0d 0a0d 0a64 6566 2073 706c 6974 5f6b  .....def split_k
-00009cf0: 6579 2829 3a0d 0a20 2022 2222 4372 6561  ey():..  """Crea
-00009d00: 7465 2061 206e 6577 2073 6565 6420 6672  te a new seed fr
-00009d10: 6f6d 2074 6865 2063 7572 7265 6e74 2073  om the current s
-00009d20: 6565 642e 0d0a 0d0a 2020 5468 6973 2066  eed.....  This f
-00009d30: 756e 6374 696f 6e20 6973 2075 7365 6675  unction is usefu
-00009d40: 6c20 666f 7220 7468 6520 636f 6e73 6973  l for the consis
-00009d50: 7465 6e63 7920 7769 7468 204a 4158 2773  tency with JAX's
-00009d60: 2072 616e 646f 6d20 7061 7261 6469 676d   random paradigm
-00009d70: 2e22 2222 0d0a 2020 7265 7475 726e 2044  ."""..  return D
-00009d80: 4546 4155 4c54 2e73 706c 6974 5f6b 6579  EFAULT.split_key
-00009d90: 2829 0d0a 0d0a 0d0a 6465 6620 7370 6c69  ()......def spli
-00009da0: 745f 6b65 7973 286e 293a 0d0a 2020 2222  t_keys(n):..  ""
-00009db0: 2243 7265 6174 6520 6d75 6c74 6970 6c65  "Create multiple
-00009dc0: 2073 6565 6473 2066 726f 6d20 7468 6520   seeds from the 
-00009dd0: 6375 7272 656e 7420 7365 6564 2e20 5468  current seed. Th
-00009de0: 6973 2069 7320 7573 6564 0d0a 2020 696e  is is used..  in
-00009df0: 7465 726e 616c 6c79 2062 7920 6070 6d61  ternally by `pma
-00009e00: 7060 2061 6e64 2060 766d 6170 6020 746f  p` and `vmap` to
-00009e10: 2065 6e73 7572 6520 7468 6174 2072 616e   ensure that ran
-00009e20: 646f 6d20 6e75 6d62 6572 730d 0a20 2061  dom numbers..  a
-00009e30: 7265 2064 6966 6665 7265 6e74 2069 6e20  re different in 
-00009e40: 7061 7261 6c6c 656c 2074 6872 6561 6473  parallel threads
-00009e50: 2e0d 0a0d 0a20 2050 6172 616d 6574 6572  .....  Parameter
-00009e60: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
-00009e70: 0a20 206e 203a 2069 6e74 0d0a 2020 2020  .  n : int..    
-00009e80: 5468 6520 6e75 6d62 6572 206f 6620 7365  The number of se
-00009e90: 6564 7320 746f 2067 656e 6572 6174 652e  eds to generate.
-00009ea0: 0d0a 2020 2222 220d 0a20 2072 6574 7572  ..  """..  retur
-00009eb0: 6e20 4445 4641 554c 542e 7370 6c69 745f  n DEFAULT.split_
-00009ec0: 6b65 7973 286e 290d 0a0d 0a0d 0a64 6566  keys(n)......def
-00009ed0: 2063 6c6f 6e65 5f72 6e67 2873 6565 645f   clone_rng(seed_
-00009ee0: 6f72 5f6b 6579 3d4e 6f6e 652c 2063 6c6f  or_key=None, clo
-00009ef0: 6e65 3a20 626f 6f6c 203d 2054 7275 6529  ne: bool = True)
-00009f00: 202d 3e20 5261 6e64 6f6d 5374 6174 653a   -> RandomState:
-00009f10: 0d0a 2020 2222 2243 6c6f 6e65 2074 6865  ..  """Clone the
-00009f20: 2072 616e 646f 6d20 7374 6174 6520 6163   random state ac
-00009f30: 636f 7264 696e 6720 746f 2074 6865 2067  cording to the g
-00009f40: 6976 656e 2073 6574 7469 6e67 2e0d 0a0d  iven setting....
-00009f50: 0a20 2041 7267 733a 0d0a 2020 2020 7365  .  Args:..    se
-00009f60: 6564 5f6f 725f 6b65 793a 2054 6865 2073  ed_or_key: The s
-00009f70: 6565 6420 2861 6e20 696e 7465 6765 7229  eed (an integer)
-00009f80: 206f 7220 7468 6520 7261 6e64 6f6d 206b   or the random k
-00009f90: 6579 2e0d 0a20 2020 2063 6c6f 6e65 3a20  ey...    clone: 
-00009fa0: 426f 6f6c 2e20 5768 6574 6865 7220 636c  Bool. Whether cl
-00009fb0: 6f6e 6520 7468 6520 6465 6661 756c 7420  one the default 
-00009fc0: 7261 6e64 6f6d 2073 7461 7465 2e0d 0a0d  random state....
-00009fd0: 0a20 2052 6574 7572 6e73 3a0d 0a20 2020  .  Returns:..   
-00009fe0: 2054 6865 2072 616e 646f 6d20 7374 6174   The random stat
-00009ff0: 652e 0d0a 2020 2222 220d 0a20 2069 6620  e...  """..  if 
-0000a000: 7365 6564 5f6f 725f 6b65 7920 6973 204e  seed_or_key is N
-0000a010: 6f6e 653a 0d0a 2020 2020 7265 7475 726e  one:..    return
-0000a020: 2044 4546 4155 4c54 2e63 6c6f 6e65 2829   DEFAULT.clone()
-0000a030: 2069 6620 636c 6f6e 6520 656c 7365 2044   if clone else D
-0000a040: 4546 4155 4c54 0d0a 2020 656c 7365 3a0d  EFAULT..  else:.
-0000a050: 0a20 2020 2072 6574 7572 6e20 5261 6e64  .    return Rand
-0000a060: 6f6d 5374 6174 6528 7365 6564 5f6f 725f  omState(seed_or_
-0000a070: 6b65 7929 0d0a 0d0a 0d0a 6465 6620 6465  key)......def de
-0000a080: 6661 756c 745f 726e 6728 7365 6564 5f6f  fault_rng(seed_o
-0000a090: 725f 6b65 793d 4e6f 6e65 2c20 636c 6f6e  r_key=None, clon
-0000a0a0: 653a 2062 6f6f 6c20 3d20 5472 7565 2920  e: bool = True) 
-0000a0b0: 2d3e 2052 616e 646f 6d53 7461 7465 3a0d  -> RandomState:.
-0000a0c0: 0a20 2069 6620 7365 6564 5f6f 725f 6b65  .  if seed_or_ke
-0000a0d0: 7920 6973 204e 6f6e 653a 0d0a 2020 2020  y is None:..    
-0000a0e0: 7265 7475 726e 2044 4546 4155 4c54 2e63  return DEFAULT.c
-0000a0f0: 6c6f 6e65 2829 2069 6620 636c 6f6e 6520  lone() if clone 
-0000a100: 656c 7365 2044 4546 4155 4c54 0d0a 2020  else DEFAULT..  
-0000a110: 656c 7365 3a0d 0a20 2020 2072 6574 7572  else:..    retur
-0000a120: 6e20 5261 6e64 6f6d 5374 6174 6528 7365  n RandomState(se
-0000a130: 6564 5f6f 725f 6b65 7929 0d0a 0d0a 0d0a  ed_or_key)......
-0000a140: 6465 6620 7365 6564 2873 6565 643a 2069  def seed(seed: i
-0000a150: 6e74 203d 204e 6f6e 6529 3a0d 0a20 2022  nt = None):..  "
-0000a160: 2222 5365 7473 2061 206e 6577 2072 616e  ""Sets a new ran
-0000a170: 646f 6d20 7365 6564 2e0d 0a0d 0a20 2050  dom seed.....  P
-0000a180: 6172 616d 6574 6572 730d 0a20 202d 2d2d  arameters..  ---
-0000a190: 2d2d 2d2d 2d2d 2d0d 0a20 2073 6565 643a  -------..  seed:
-0000a1a0: 2069 6e74 2c20 6f70 7469 6f6e 616c 0d0a   int, optional..
-0000a1b0: 2020 2020 5468 6520 7261 6e64 6f6d 2073      The random s
-0000a1c0: 6565 642e 0d0a 2020 2222 220d 0a20 2077  eed...  """..  w
-0000a1d0: 6974 6820 6a61 782e 656e 7375 7265 5f63  ith jax.ensure_c
-0000a1e0: 6f6d 7069 6c65 5f74 696d 655f 6576 616c  ompile_time_eval
-0000a1f0: 2829 3a0d 0a20 2020 2069 6620 7365 6564  ():..    if seed
-0000a200: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
-0000a210: 2073 6565 6420 3d20 6e70 2e72 616e 646f   seed = np.rando
-0000a220: 6d2e 7261 6e64 696e 7428 302c 2031 3030  m.randint(0, 100
-0000a230: 3030 3029 0d0a 2020 2020 6e70 2e72 616e  000)..    np.ran
-0000a240: 646f 6d2e 7365 6564 2873 6565 6429 0d0a  dom.seed(seed)..
-0000a250: 2020 4445 4641 554c 542e 7365 6564 2873    DEFAULT.seed(s
-0000a260: 6565 6429 0d0a 0d0a 0d0a 6465 6620 7261  eed)......def ra
-0000a270: 6e64 282a 646e 2c20 6b65 793a 204f 7074  nd(*dn, key: Opt
-0000a280: 696f 6e61 6c5b 5365 6564 4f72 4b65 795d  ional[SeedOrKey]
-0000a290: 203d 204e 6f6e 652c 2064 7479 7065 3a20   = None, dtype: 
-0000a2a0: 4454 7970 654c 696b 6520 3d20 4e6f 6e65  DTypeLike = None
-0000a2b0: 293a 0d0a 2020 7222 2222 5261 6e64 6f6d  ):..  r"""Random
-0000a2c0: 2076 616c 7565 7320 696e 2061 2067 6976   values in a giv
-0000a2d0: 656e 2073 6861 7065 2e0d 0a0d 0a20 202e  en shape.....  .
-0000a2e0: 2e20 6e6f 7465 3a3a 0d0a 2020 2020 2020  . note::..      
-0000a2f0: 5468 6973 2069 7320 6120 636f 6e76 656e  This is a conven
-0000a300: 6965 6e63 6520 6675 6e63 7469 6f6e 2066  ience function f
-0000a310: 6f72 2075 7365 7273 2070 6f72 7469 6e67  or users porting
-0000a320: 2063 6f64 6520 6672 6f6d 204d 6174 6c61   code from Matla
-0000a330: 622c 0d0a 2020 2020 2020 616e 6420 7772  b,..      and wr
-0000a340: 6170 7320 6072 616e 646f 6d5f 7361 6d70  aps `random_samp
-0000a350: 6c65 602e 2054 6861 7420 6675 6e63 7469  le`. That functi
-0000a360: 6f6e 2074 616b 6573 2061 0d0a 2020 2020  on takes a..    
-0000a370: 2020 7475 706c 6520 746f 2073 7065 6369    tuple to speci
-0000a380: 6679 2074 6865 2073 697a 6520 6f66 2074  fy the size of t
-0000a390: 6865 206f 7574 7075 742c 2077 6869 6368  he output, which
-0000a3a0: 2069 7320 636f 6e73 6973 7465 6e74 2077   is consistent w
-0000a3b0: 6974 680d 0a20 2020 2020 206f 7468 6572  ith..      other
-0000a3c0: 204e 756d 5079 2066 756e 6374 696f 6e73   NumPy functions
-0000a3d0: 206c 696b 6520 606e 756d 7079 2e7a 6572   like `numpy.zer
-0000a3e0: 6f73 6020 616e 6420 606e 756d 7079 2e6f  os` and `numpy.o
-0000a3f0: 6e65 7360 2e0d 0a0d 0a20 2043 7265 6174  nes`.....  Creat
-0000a400: 6520 616e 2061 7272 6179 206f 6620 7468  e an array of th
-0000a410: 6520 6769 7665 6e20 7368 6170 6520 616e  e given shape an
-0000a420: 6420 706f 7075 6c61 7465 2069 7420 7769  d populate it wi
-0000a430: 7468 0d0a 2020 7261 6e64 6f6d 2073 616d  th..  random sam
-0000a440: 706c 6573 2066 726f 6d20 6120 756e 6966  ples from a unif
-0000a450: 6f72 6d20 6469 7374 7269 6275 7469 6f6e  orm distribution
-0000a460: 0d0a 2020 6f76 6572 2060 605b 302c 2031  ..  over ``[0, 1
-0000a470: 2960 602e 0d0a 0d0a 2020 5061 7261 6d65  )``.....  Parame
-0000a480: 7465 7273 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ters..  --------
-0000a490: 2d2d 0d0a 2020 6430 2c20 6431 2c20 2e2e  --..  d0, d1, ..
-0000a4a0: 2e2c 2064 6e20 3a20 696e 742c 206f 7074  ., dn : int, opt
-0000a4b0: 696f 6e61 6c0d 0a20 2020 2020 2054 6865  ional..      The
-0000a4c0: 2064 696d 656e 7369 6f6e 7320 6f66 2074   dimensions of t
-0000a4d0: 6865 2072 6574 7572 6e65 6420 6172 7261  he returned arra
-0000a4e0: 792c 206d 7573 7420 6265 206e 6f6e 2d6e  y, must be non-n
-0000a4f0: 6567 6174 6976 652e 0d0a 2020 2020 2020  egative...      
-0000a500: 4966 206e 6f20 6172 6775 6d65 6e74 2069  If no argument i
-0000a510: 7320 6769 7665 6e20 6120 7369 6e67 6c65  s given a single
-0000a520: 2050 7974 686f 6e20 666c 6f61 7420 6973   Python float is
-0000a530: 2072 6574 7572 6e65 642e 0d0a 2020 6474   returned...  dt
-0000a540: 7970 6520 3a20 6474 7970 652c 206f 7074  ype : dtype, opt
-0000a550: 696f 6e61 6c0d 0a20 2020 2020 2044 6573  ional..      Des
-0000a560: 6972 6564 2064 7479 7065 206f 6620 7468  ired dtype of th
-0000a570: 6520 7265 7375 6c74 2e20 4279 7465 6f72  e result. Byteor
-0000a580: 6465 7220 6d75 7374 2062 6520 6e61 7469  der must be nati
-0000a590: 7665 2e0d 0a20 2020 2020 2054 6865 2064  ve...      The d
-0000a5a0: 6566 6175 6c74 2076 616c 7565 2069 7320  efault value is 
-0000a5b0: 666c 6f61 742e 0d0a 0d0a 2020 5265 7475  float.....  Retu
-0000a5c0: 726e 730d 0a20 202d 2d2d 2d2d 2d2d 0d0a  rns..  -------..
-0000a5d0: 2020 6f75 7420 3a20 6e64 6172 7261 792c    out : ndarray,
-0000a5e0: 2073 6861 7065 2060 6028 6430 2c20 6431   shape ``(d0, d1
-0000a5f0: 2c20 2e2e 2e2c 2064 6e29 6060 0d0a 2020  , ..., dn)``..  
-0000a600: 2020 2020 5261 6e64 6f6d 2076 616c 7565      Random value
-0000a610: 732e 0d0a 0d0a 2020 5365 6520 416c 736f  s.....  See Also
-0000a620: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ..  --------..  
-0000a630: 7261 6e64 6f6d 0d0a 0d0a 2020 4578 616d  random....  Exam
-0000a640: 706c 6573 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ples..  --------
-0000a650: 0d0a 2020 3e3e 3e20 6272 6169 6e63 6f72  ..  >>> braincor
-0000a660: 652e 6d61 7468 2e72 616e 646f 6d2e 7261  e.math.random.ra
-0000a670: 6e64 2833 2c32 290d 0a20 2061 7272 6179  nd(3,2)..  array
-0000a680: 285b 5b20 302e 3134 3032 3234 3731 2c20  ([[ 0.14022471, 
-0000a690: 2030 2e39 3633 3630 3631 385d 2c20 2023   0.96360618],  #
-0000a6a0: 7261 6e64 6f6d 0d0a 2020 2020 2020 2020  random..        
-0000a6b0: 205b 2030 2e33 3736 3031 3033 322c 2020   [ 0.37601032,  
-0000a6c0: 302e 3235 3532 3834 3131 5d2c 2020 2372  0.25528411],  #r
-0000a6d0: 616e 646f 6d0d 0a20 2020 2020 2020 2020  andom..         
-0000a6e0: 5b20 302e 3439 3331 3330 3439 2c20 2030  [ 0.49313049,  0
-0000a6f0: 2e39 3439 3039 3837 385d 5d29 2023 7261  .94909878]]) #ra
-0000a700: 6e64 6f6d 0d0a 2020 2222 220d 0a20 2072  ndom..  """..  r
-0000a710: 6574 7572 6e20 4445 4641 554c 542e 7261  eturn DEFAULT.ra
-0000a720: 6e64 282a 646e 2c20 6b65 793d 6b65 792c  nd(*dn, key=key,
-0000a730: 2064 7479 7065 3d64 7479 7065 290d 0a0d   dtype=dtype)...
-0000a740: 0a0d 0a64 6566 2072 616e 6469 6e74 286c  ...def randint(l
-0000a750: 6f77 2c20 6869 6768 3d4e 6f6e 652c 2073  ow, high=None, s
-0000a760: 697a 653a 204f 7074 696f 6e61 6c5b 5369  ize: Optional[Si
-0000a770: 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ze] = None,..   
-0000a780: 2020 2020 2020 2020 206b 6579 3a20 4f70           key: Op
-0000a790: 7469 6f6e 616c 5b53 6565 644f 724b 6579  tional[SeedOrKey
-0000a7a0: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2020  ] = None,..     
-0000a7b0: 2020 2020 2020 2064 7479 7065 3a20 4454         dtype: DT
-0000a7c0: 7970 654c 696b 6520 3d20 4e6f 6e65 293a  ypeLike = None):
-0000a7d0: 0d0a 2020 7222 2222 5265 7475 726e 2072  ..  r"""Return r
-0000a7e0: 616e 646f 6d20 696e 7465 6765 7273 2066  andom integers f
-0000a7f0: 726f 6d20 606c 6f77 6020 2869 6e63 6c75  rom `low` (inclu
-0000a800: 7369 7665 2920 746f 2060 6869 6768 6020  sive) to `high` 
-0000a810: 2865 7863 6c75 7369 7665 292e 0d0a 0d0a  (exclusive).....
-0000a820: 2020 5265 7475 726e 2072 616e 646f 6d20    Return random 
-0000a830: 696e 7465 6765 7273 2066 726f 6d20 7468  integers from th
-0000a840: 6520 2264 6973 6372 6574 6520 756e 6966  e "discrete unif
-0000a850: 6f72 6d22 2064 6973 7472 6962 7574 696f  orm" distributio
-0000a860: 6e20 6f66 0d0a 2020 7468 6520 7370 6563  n of..  the spec
-0000a870: 6966 6965 6420 6474 7970 6520 696e 2074  ified dtype in t
-0000a880: 6865 2022 6861 6c66 2d6f 7065 6e22 2069  he "half-open" i
-0000a890: 6e74 6572 7661 6c20 5b60 6c6f 7760 2c20  nterval [`low`, 
-0000a8a0: 6068 6967 6860 292e 2049 660d 0a20 2060  `high`). If..  `
-0000a8b0: 6869 6768 6020 6973 204e 6f6e 6520 2874  high` is None (t
-0000a8c0: 6865 2064 6566 6175 6c74 292c 2074 6865  he default), the
-0000a8d0: 6e20 7265 7375 6c74 7320 6172 6520 6672  n results are fr
-0000a8e0: 6f6d 205b 302c 2060 6c6f 7760 292e 0d0a  om [0, `low`)...
-0000a8f0: 0d0a 2020 5061 7261 6d65 7465 7273 0d0a  ..  Parameters..
-0000a900: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-0000a910: 6c6f 7720 3a20 696e 7420 6f72 2061 7272  low : int or arr
-0000a920: 6179 2d6c 696b 6520 6f66 2069 6e74 730d  ay-like of ints.
-0000a930: 0a20 2020 2020 204c 6f77 6573 7420 2873  .      Lowest (s
-0000a940: 6967 6e65 6429 2069 6e74 6567 6572 7320  igned) integers 
-0000a950: 746f 2062 6520 6472 6177 6e20 6672 6f6d  to be drawn from
-0000a960: 2074 6865 2064 6973 7472 6962 7574 696f   the distributio
-0000a970: 6e20 2875 6e6c 6573 730d 0a20 2020 2020  n (unless..     
-0000a980: 2060 6068 6967 683d 4e6f 6e65 6060 2c20   ``high=None``, 
-0000a990: 696e 2077 6869 6368 2063 6173 6520 7468  in which case th
-0000a9a0: 6973 2070 6172 616d 6574 6572 2069 7320  is parameter is 
-0000a9b0: 6f6e 6520 6162 6f76 6520 7468 650d 0a20  one above the.. 
-0000a9c0: 2020 2020 202a 6869 6768 6573 742a 2073       *highest* s
-0000a9d0: 7563 6820 696e 7465 6765 7229 2e0d 0a20  uch integer)... 
-0000a9e0: 2068 6967 6820 3a20 696e 7420 6f72 2061   high : int or a
-0000a9f0: 7272 6179 2d6c 696b 6520 6f66 2069 6e74  rray-like of int
-0000aa00: 732c 206f 7074 696f 6e61 6c0d 0a20 2020  s, optional..   
-0000aa10: 2020 2049 6620 7072 6f76 6964 6564 2c20     If provided, 
-0000aa20: 6f6e 6520 6162 6f76 6520 7468 6520 6c61  one above the la
-0000aa30: 7267 6573 7420 2873 6967 6e65 6429 2069  rgest (signed) i
-0000aa40: 6e74 6567 6572 2074 6f20 6265 2064 7261  nteger to be dra
-0000aa50: 776e 0d0a 2020 2020 2020 6672 6f6d 2074  wn..      from t
-0000aa60: 6865 2064 6973 7472 6962 7574 696f 6e20  he distribution 
-0000aa70: 2873 6565 2061 626f 7665 2066 6f72 2062  (see above for b
-0000aa80: 6568 6176 696f 7220 6966 2060 6068 6967  ehavior if ``hig
-0000aa90: 683d 4e6f 6e65 6060 292e 0d0a 2020 2020  h=None``)...    
-0000aaa0: 2020 4966 2061 7272 6179 2d6c 696b 652c    If array-like,
-0000aab0: 206d 7573 7420 636f 6e74 6169 6e20 696e   must contain in
-0000aac0: 7465 6765 7220 7661 6c75 6573 0d0a 2020  teger values..  
-0000aad0: 7369 7a65 203a 2069 6e74 206f 7220 7475  size : int or tu
-0000aae0: 706c 6520 6f66 2069 6e74 732c 206f 7074  ple of ints, opt
-0000aaf0: 696f 6e61 6c0d 0a20 2020 2020 204f 7574  ional..      Out
-0000ab00: 7075 7420 7368 6170 652e 2020 4966 2074  put shape.  If t
-0000ab10: 6865 2067 6976 656e 2073 6861 7065 2069  he given shape i
-0000ab20: 732c 2065 2e67 2e2c 2060 6028 6d2c 206e  s, e.g., ``(m, n
-0000ab30: 2c20 6b29 6060 2c20 7468 656e 0d0a 2020  , k)``, then..  
-0000ab40: 2020 2020 6060 6d20 2a20 6e20 2a20 6b60      ``m * n * k`
-0000ab50: 6020 7361 6d70 6c65 7320 6172 6520 6472  ` samples are dr
-0000ab60: 6177 6e2e 2020 4465 6661 756c 7420 6973  awn.  Default is
-0000ab70: 204e 6f6e 652c 2069 6e20 7768 6963 6820   None, in which 
-0000ab80: 6361 7365 2061 0d0a 2020 2020 2020 7369  case a..      si
-0000ab90: 6e67 6c65 2076 616c 7565 2069 7320 7265  ngle value is re
-0000aba0: 7475 726e 6564 2e0d 0a20 2064 7479 7065  turned...  dtype
-0000abb0: 203a 2064 7479 7065 2c20 6f70 7469 6f6e   : dtype, option
-0000abc0: 616c 0d0a 2020 2020 2020 4465 7369 7265  al..      Desire
-0000abd0: 6420 6474 7970 6520 6f66 2074 6865 2072  d dtype of the r
-0000abe0: 6573 756c 742e 2042 7974 656f 7264 6572  esult. Byteorder
-0000abf0: 206d 7573 7420 6265 206e 6174 6976 652e   must be native.
-0000ac00: 0d0a 2020 2020 2020 5468 6520 6465 6661  ..      The defa
-0000ac10: 756c 7420 7661 6c75 6520 6973 2069 6e74  ult value is int
-0000ac20: 2e0d 0a20 206b 6579 203a 2050 524e 474b  ...  key : PRNGK
-0000ac30: 6579 2c20 6f70 7469 6f6e 616c 0d0a 2020  ey, optional..  
-0000ac40: 2020 2020 5468 6520 6b65 7920 666f 7220      The key for 
-0000ac50: 7468 6520 7261 6e64 6f6d 206e 756d 6265  the random numbe
-0000ac60: 7220 6765 6e65 7261 746f 722e 2049 6620  r generator. If 
-0000ac70: 6e6f 7420 6769 7665 6e2c 2074 6865 0d0a  not given, the..
-0000ac80: 2020 2020 2020 6465 6661 756c 7420 7261        default ra
-0000ac90: 6e64 6f6d 206e 756d 6265 7220 6765 6e65  ndom number gene
-0000aca0: 7261 746f 7220 6973 2075 7365 642e 0d0a  rator is used...
-0000acb0: 2020 6474 7970 6520 3a20 6474 7970 652c    dtype : dtype,
-0000acc0: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-0000acd0: 2044 6573 6972 6564 2064 7479 7065 206f   Desired dtype o
-0000ace0: 6620 7468 6520 7265 7375 6c74 2e20 4279  f the result. By
-0000acf0: 7465 6f72 6465 7220 6d75 7374 2062 6520  teorder must be 
-0000ad00: 6e61 7469 7665 2e0d 0a20 2020 2020 2054  native...      T
-0000ad10: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
-0000ad20: 2069 7320 696e 742e 0d0a 0d0a 2020 5265   is int.....  Re
-0000ad30: 7475 726e 730d 0a20 202d 2d2d 2d2d 2d2d  turns..  -------
-0000ad40: 0d0a 2020 6f75 7420 3a20 696e 7420 6f72  ..  out : int or
-0000ad50: 206e 6461 7272 6179 206f 6620 696e 7473   ndarray of ints
-0000ad60: 0d0a 2020 2020 2020 6073 697a 6560 2d73  ..      `size`-s
-0000ad70: 6861 7065 6420 6172 7261 7920 6f66 2072  haped array of r
-0000ad80: 616e 646f 6d20 696e 7465 6765 7273 2066  andom integers f
-0000ad90: 726f 6d20 7468 6520 6170 7072 6f70 7269  rom the appropri
-0000ada0: 6174 650d 0a20 2020 2020 2064 6973 7472  ate..      distr
-0000adb0: 6962 7574 696f 6e2c 206f 7220 6120 7369  ibution, or a si
-0000adc0: 6e67 6c65 2073 7563 6820 7261 6e64 6f6d  ngle such random
-0000add0: 2069 6e74 2069 6620 6073 697a 6560 206e   int if `size` n
-0000ade0: 6f74 2070 726f 7669 6465 642e 0d0a 0d0a  ot provided.....
-0000adf0: 2020 5365 6520 416c 736f 0d0a 2020 2d2d    See Also..  --
-0000ae00: 2d2d 2d2d 2d2d 0d0a 2020 7261 6e64 6f6d  ------..  random
-0000ae10: 5f69 6e74 6567 6572 7320 3a20 7369 6d69  _integers : simi
-0000ae20: 6c61 7220 746f 2060 7261 6e64 696e 7460  lar to `randint`
-0000ae30: 2c20 6f6e 6c79 2066 6f72 2074 6865 2063  , only for the c
-0000ae40: 6c6f 7365 640d 0a20 2020 2020 2069 6e74  losed..      int
-0000ae50: 6572 7661 6c20 5b60 6c6f 7760 2c20 6068  erval [`low`, `h
-0000ae60: 6967 6860 5d2c 2061 6e64 2031 2069 7320  igh`], and 1 is 
-0000ae70: 7468 6520 6c6f 7765 7374 2076 616c 7565  the lowest value
-0000ae80: 2069 6620 6068 6967 6860 2069 730d 0a20   if `high` is.. 
-0000ae90: 2020 2020 206f 6d69 7474 6564 2e0d 0a20       omitted... 
-0000aea0: 2047 656e 6572 6174 6f72 2e69 6e74 6567   Generator.integ
-0000aeb0: 6572 733a 2077 6869 6368 2073 686f 756c  ers: which shoul
-0000aec0: 6420 6265 2075 7365 6420 666f 7220 6e65  d be used for ne
-0000aed0: 7720 636f 6465 2e0d 0a0d 0a20 2045 7861  w code.....  Exa
-0000aee0: 6d70 6c65 730d 0a20 202d 2d2d 2d2d 2d2d  mples..  -------
-0000aef0: 2d0d 0a20 203e 3e3e 2069 6d70 6f72 7420  -..  >>> import 
-0000af00: 6272 6169 6e63 6f72 6520 6173 2062 630d  braincore as bc.
-0000af10: 0a20 203e 3e3e 2062 632e 7261 6e64 6f6d  .  >>> bc.random
-0000af20: 2e72 616e 6469 6e74 2832 2c20 7369 7a65  .randint(2, size
-0000af30: 3d31 3029 0d0a 2020 6172 7261 7928 5b31  =10)..  array([1
-0000af40: 2c20 302c 2030 2c20 302c 2031 2c20 312c  , 0, 0, 0, 1, 1,
-0000af50: 2030 2c20 302c 2031 2c20 305d 2920 2320   0, 0, 1, 0]) # 
-0000af60: 7261 6e64 6f6d 0d0a 2020 3e3e 3e20 6263  random..  >>> bc
-0000af70: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
-0000af80: 312c 2073 697a 653d 3130 290d 0a20 2061  1, size=10)..  a
-0000af90: 7272 6179 285b 302c 2030 2c20 302c 2030  rray([0, 0, 0, 0
-0000afa0: 2c20 302c 2030 2c20 302c 2030 2c20 302c  , 0, 0, 0, 0, 0,
-0000afb0: 2030 5d29 0d0a 0d0a 2020 4765 6e65 7261   0])....  Genera
-0000afc0: 7465 2061 2032 2078 2034 2061 7272 6179  te a 2 x 4 array
-0000afd0: 206f 6620 696e 7473 2062 6574 7765 656e   of ints between
-0000afe0: 2030 2061 6e64 2034 2c20 696e 636c 7573   0 and 4, inclus
-0000aff0: 6976 653a 0d0a 0d0a 2020 3e3e 3e20 6263  ive:....  >>> bc
-0000b000: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
-0000b010: 352c 2073 697a 653d 2832 2c20 3429 290d  5, size=(2, 4)).
-0000b020: 0a20 2061 7272 6179 285b 5b34 2c20 302c  .  array([[4, 0,
-0000b030: 2032 2c20 315d 2c20 2320 7261 6e64 6f6d   2, 1], # random
-0000b040: 0d0a 2020 2020 2020 2020 205b 332c 2032  ..         [3, 2
-0000b050: 2c20 322c 2030 5d5d 290d 0a0d 0a20 2047  , 2, 0]])....  G
-0000b060: 656e 6572 6174 6520 6120 3120 7820 3320  enerate a 1 x 3 
-0000b070: 6172 7261 7920 7769 7468 2033 2064 6966  array with 3 dif
-0000b080: 6665 7265 6e74 2075 7070 6572 2062 6f75  ferent upper bou
-0000b090: 6e64 730d 0a0d 0a20 203e 3e3e 2062 632e  nds....  >>> bc.
-0000b0a0: 7261 6e64 6f6d 2e72 616e 6469 6e74 2831  random.randint(1
-0000b0b0: 2c20 5b33 2c20 352c 2031 305d 290d 0a20  , [3, 5, 10]).. 
-0000b0c0: 2061 7272 6179 285b 322c 2032 2c20 395d   array([2, 2, 9]
-0000b0d0: 2920 2320 7261 6e64 6f6d 0d0a 0d0a 2020  ) # random....  
-0000b0e0: 4765 6e65 7261 7465 2061 2031 2062 7920  Generate a 1 by 
-0000b0f0: 3320 6172 7261 7920 7769 7468 2033 2064  3 array with 3 d
-0000b100: 6966 6665 7265 6e74 206c 6f77 6572 2062  ifferent lower b
-0000b110: 6f75 6e64 730d 0a0d 0a20 203e 3e3e 2062  ounds....  >>> b
-0000b120: 632e 7261 6e64 6f6d 2e72 616e 6469 6e74  c.random.randint
-0000b130: 285b 312c 2035 2c20 375d 2c20 3130 290d  ([1, 5, 7], 10).
-0000b140: 0a20 2061 7272 6179 285b 392c 2038 2c20  .  array([9, 8, 
-0000b150: 375d 2920 2320 7261 6e64 6f6d 0d0a 0d0a  7]) # random....
-0000b160: 2020 4765 6e65 7261 7465 2061 2032 2062    Generate a 2 b
-0000b170: 7920 3420 6172 7261 7920 7573 696e 6720  y 4 array using 
-0000b180: 6272 6f61 6463 6173 7469 6e67 2077 6974  broadcasting wit
-0000b190: 6820 6474 7970 6520 6f66 2075 696e 7438  h dtype of uint8
-0000b1a0: 0d0a 0d0a 2020 3e3e 3e20 6263 2e72 616e  ....  >>> bc.ran
-0000b1b0: 646f 6d2e 7261 6e64 696e 7428 5b31 2c20  dom.randint([1, 
-0000b1c0: 332c 2035 2c20 375d 2c20 5b5b 3130 5d2c  3, 5, 7], [[10],
-0000b1d0: 205b 3230 5d5d 2c20 6474 7970 653d 6e70   [20]], dtype=np
-0000b1e0: 2e75 696e 7438 290d 0a20 2061 7272 6179  .uint8)..  array
-0000b1f0: 285b 5b20 382c 2020 362c 2020 392c 2020  ([[ 8,  6,  9,  
-0000b200: 375d 2c20 2320 7261 6e64 6f6d 0d0a 2020  7], # random..  
-0000b210: 2020 2020 2020 205b 2031 2c20 3136 2c20         [ 1, 16, 
-0000b220: 2039 2c20 3132 5d5d 2c20 6474 7970 653d   9, 12]], dtype=
-0000b230: 7569 6e74 3829 0d0a 2020 2222 220d 0a0d  uint8)..  """...
-0000b240: 0a20 2072 6574 7572 6e20 4445 4641 554c  .  return DEFAUL
-0000b250: 542e 7261 6e64 696e 7428 6c6f 772c 2068  T.randint(low, h
-0000b260: 6967 683d 6869 6768 2c20 7369 7a65 3d73  igh=high, size=s
-0000b270: 697a 652c 2064 7479 7065 3d64 7479 7065  ize, dtype=dtype
-0000b280: 2c20 6b65 793d 6b65 7929 0d0a 0d0a 0d0a  , key=key)......
-0000b290: 6465 6620 7261 6e64 6f6d 5f69 6e74 6567  def random_integ
-0000b2a0: 6572 7328 6c6f 772c 0d0a 2020 2020 2020  ers(low,..      
-0000b2b0: 2020 2020 2020 2020 2020 2020 2020 6869                hi
-0000b2c0: 6768 3d4e 6f6e 652c 0d0a 2020 2020 2020  gh=None,..      
-0000b2d0: 2020 2020 2020 2020 2020 2020 2020 7369                si
-0000b2e0: 7a65 3a20 4f70 7469 6f6e 616c 5b53 697a  ze: Optional[Siz
-0000b2f0: 655d 203d 204e 6f6e 652c 0d0a 2020 2020  e] = None,..    
-0000b300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b310: 6b65 793a 204f 7074 696f 6e61 6c5b 5365  key: Optional[Se
-0000b320: 6564 4f72 4b65 795d 203d 204e 6f6e 652c  edOrKey] = None,
-0000b330: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000b340: 2020 2020 2020 6474 7970 653a 2044 5479        dtype: DTy
-0000b350: 7065 4c69 6b65 203d 204e 6f6e 6529 3a0d  peLike = None):.
-0000b360: 0a20 2072 2222 220d 0a20 2052 616e 646f  .  r"""..  Rando
-0000b370: 6d20 696e 7465 6765 7273 206f 6620 7479  m integers of ty
-0000b380: 7065 2060 6e70 2e69 6e74 5f60 2062 6574  pe `np.int_` bet
-0000b390: 7765 656e 2060 6c6f 7760 2061 6e64 2060  ween `low` and `
-0000b3a0: 6869 6768 602c 2069 6e63 6c75 7369 7665  high`, inclusive
-0000b3b0: 2e0d 0a0d 0a20 2052 6574 7572 6e20 7261  .....  Return ra
-0000b3c0: 6e64 6f6d 2069 6e74 6567 6572 7320 6f66  ndom integers of
-0000b3d0: 2074 7970 6520 606e 702e 696e 745f 6020   type `np.int_` 
-0000b3e0: 6672 6f6d 2074 6865 2022 6469 7363 7265  from the "discre
-0000b3f0: 7465 2075 6e69 666f 726d 220d 0a20 2064  te uniform"..  d
-0000b400: 6973 7472 6962 7574 696f 6e20 696e 2074  istribution in t
-0000b410: 6865 2063 6c6f 7365 6420 696e 7465 7276  he closed interv
-0000b420: 616c 205b 606c 6f77 602c 2060 6869 6768  al [`low`, `high
-0000b430: 605d 2e20 2049 6620 6068 6967 6860 2069  `].  If `high` i
-0000b440: 730d 0a20 204e 6f6e 6520 2874 6865 2064  s..  None (the d
-0000b450: 6566 6175 6c74 292c 2074 6865 6e20 7265  efault), then re
-0000b460: 7375 6c74 7320 6172 6520 6672 6f6d 205b  sults are from [
-0000b470: 312c 2060 6c6f 7760 5d2e 2054 6865 2060  1, `low`]. The `
-0000b480: 6e70 2e69 6e74 5f60 0d0a 2020 7479 7065  np.int_`..  type
-0000b490: 2074 7261 6e73 6c61 7465 7320 746f 2074   translates to t
-0000b4a0: 6865 2043 206c 6f6e 6720 696e 7465 6765  he C long intege
-0000b4b0: 7220 7479 7065 2061 6e64 2069 7473 2070  r type and its p
-0000b4c0: 7265 6369 7369 6f6e 0d0a 2020 6973 2070  recision..  is p
-0000b4d0: 6c61 7466 6f72 6d20 6465 7065 6e64 656e  latform dependen
-0000b4e0: 742e 0d0a 0d0a 2020 5061 7261 6d65 7465  t.....  Paramete
-0000b4f0: 7273 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d  rs..  ----------
-0000b500: 0d0a 2020 6c6f 7720 3a20 696e 740d 0a20  ..  low : int.. 
-0000b510: 2020 2020 204c 6f77 6573 7420 2873 6967       Lowest (sig
-0000b520: 6e65 6429 2069 6e74 6567 6572 2074 6f20  ned) integer to 
-0000b530: 6265 2064 7261 776e 2066 726f 6d20 7468  be drawn from th
-0000b540: 6520 6469 7374 7269 6275 7469 6f6e 2028  e distribution (
-0000b550: 756e 6c65 7373 0d0a 2020 2020 2020 6060  unless..      ``
-0000b560: 6869 6768 3d4e 6f6e 6560 602c 2069 6e20  high=None``, in 
-0000b570: 7768 6963 6820 6361 7365 2074 6869 7320  which case this 
-0000b580: 7061 7261 6d65 7465 7220 6973 2074 6865  parameter is the
-0000b590: 202a 6869 6768 6573 742a 2073 7563 680d   *highest* such.
-0000b5a0: 0a20 2020 2020 2069 6e74 6567 6572 292e  .      integer).
-0000b5b0: 0d0a 2020 6869 6768 203a 2069 6e74 2c20  ..  high : int, 
-0000b5c0: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-0000b5d0: 4966 2070 726f 7669 6465 642c 2074 6865  If provided, the
-0000b5e0: 206c 6172 6765 7374 2028 7369 676e 6564   largest (signed
-0000b5f0: 2920 696e 7465 6765 7220 746f 2062 6520  ) integer to be 
-0000b600: 6472 6177 6e20 6672 6f6d 2074 6865 0d0a  drawn from the..
-0000b610: 2020 2020 2020 6469 7374 7269 6275 7469        distributi
-0000b620: 6f6e 2028 7365 6520 6162 6f76 6520 666f  on (see above fo
-0000b630: 7220 6265 6861 7669 6f72 2069 6620 6060  r behavior if ``
-0000b640: 6869 6768 3d4e 6f6e 6560 6029 2e0d 0a20  high=None``)... 
-0000b650: 2073 697a 6520 3a20 696e 7420 6f72 2074   size : int or t
-0000b660: 7570 6c65 206f 6620 696e 7473 2c20 6f70  uple of ints, op
-0000b670: 7469 6f6e 616c 0d0a 2020 2020 2020 4f75  tional..      Ou
-0000b680: 7470 7574 2073 6861 7065 2e20 2049 6620  tput shape.  If 
-0000b690: 7468 6520 6769 7665 6e20 7368 6170 6520  the given shape 
-0000b6a0: 6973 2c20 652e 672e 2c20 6060 286d 2c20  is, e.g., ``(m, 
-0000b6b0: 6e2c 206b 2960 602c 2074 6865 6e0d 0a20  n, k)``, then.. 
-0000b6c0: 2020 2020 2060 606d 202a 206e 202a 206b       ``m * n * k
-0000b6d0: 6060 2073 616d 706c 6573 2061 7265 2064  `` samples are d
-0000b6e0: 7261 776e 2e20 2044 6566 6175 6c74 2069  rawn.  Default i
-0000b6f0: 7320 4e6f 6e65 2c20 696e 2077 6869 6368  s None, in which
-0000b700: 2063 6173 6520 610d 0a20 2020 2020 2073   case a..      s
-0000b710: 696e 676c 6520 7661 6c75 6520 6973 2072  ingle value is r
-0000b720: 6574 7572 6e65 642e 0d0a 2020 6b65 7920  eturned...  key 
-0000b730: 3a20 5052 4e47 4b65 792c 206f 7074 696f  : PRNGKey, optio
-0000b740: 6e61 6c0d 0a20 2020 2020 2054 6865 206b  nal..      The k
-0000b750: 6579 2066 6f72 2074 6865 2072 616e 646f  ey for the rando
-0000b760: 6d20 6e75 6d62 6572 2067 656e 6572 6174  m number generat
-0000b770: 6f72 2e20 4966 206e 6f74 2067 6976 656e  or. If not given
-0000b780: 2c20 7468 650d 0a20 2020 2020 2064 6566  , the..      def
-0000b790: 6175 6c74 2072 616e 646f 6d20 6e75 6d62  ault random numb
-0000b7a0: 6572 2067 656e 6572 6174 6f72 2069 7320  er generator is 
-0000b7b0: 7573 6564 2e0d 0a0d 0a20 2052 6574 7572  used.....  Retur
-0000b7c0: 6e73 0d0a 2020 2d2d 2d2d 2d2d 2d0d 0a20  ns..  -------.. 
-0000b7d0: 206f 7574 203a 2069 6e74 206f 7220 6e64   out : int or nd
-0000b7e0: 6172 7261 7920 6f66 2069 6e74 730d 0a20  array of ints.. 
-0000b7f0: 2020 2020 2060 7369 7a65 602d 7368 6170       `size`-shap
-0000b800: 6564 2061 7272 6179 206f 6620 7261 6e64  ed array of rand
-0000b810: 6f6d 2069 6e74 6567 6572 7320 6672 6f6d  om integers from
-0000b820: 2074 6865 2061 7070 726f 7072 6961 7465   the appropriate
-0000b830: 0d0a 2020 2020 2020 6469 7374 7269 6275  ..      distribu
-0000b840: 7469 6f6e 2c20 6f72 2061 2073 696e 676c  tion, or a singl
-0000b850: 6520 7375 6368 2072 616e 646f 6d20 696e  e such random in
-0000b860: 7420 6966 2060 7369 7a65 6020 6e6f 7420  t if `size` not 
-0000b870: 7072 6f76 6964 6564 2e0d 0a0d 0a20 2053  provided.....  S
-0000b880: 6565 2041 6c73 6f0d 0a20 202d 2d2d 2d2d  ee Also..  -----
-0000b890: 2d2d 2d0d 0a20 2072 616e 6469 6e74 203a  ---..  randint :
-0000b8a0: 2053 696d 696c 6172 2074 6f20 6072 616e   Similar to `ran
-0000b8b0: 646f 6d5f 696e 7465 6765 7273 602c 206f  dom_integers`, o
-0000b8c0: 6e6c 7920 666f 7220 7468 6520 6861 6c66  nly for the half
-0000b8d0: 2d6f 7065 6e0d 0a20 2020 2020 2069 6e74  -open..      int
-0000b8e0: 6572 7661 6c20 5b60 6c6f 7760 2c20 6068  erval [`low`, `h
-0000b8f0: 6967 6860 292c 2061 6e64 2030 2069 7320  igh`), and 0 is 
-0000b900: 7468 6520 6c6f 7765 7374 2076 616c 7565  the lowest value
-0000b910: 2069 6620 6068 6967 6860 2069 730d 0a20   if `high` is.. 
-0000b920: 2020 2020 206f 6d69 7474 6564 2e0d 0a0d       omitted....
-0000b930: 0a20 204e 6f74 6573 0d0a 2020 2d2d 2d2d  .  Notes..  ----
-0000b940: 2d0d 0a20 2054 6f20 7361 6d70 6c65 2066  -..  To sample f
-0000b950: 726f 6d20 4e20 6576 656e 6c79 2073 7061  rom N evenly spa
-0000b960: 6365 6420 666c 6f61 7469 6e67 2d70 6f69  ced floating-poi
-0000b970: 6e74 206e 756d 6265 7273 2062 6574 7765  nt numbers betwe
-0000b980: 656e 2061 2061 6e64 2062 2c0d 0a20 2075  en a and b,..  u
-0000b990: 7365 3a3a 0d0a 0d0a 2020 2020 6120 2b20  se::....    a + 
-0000b9a0: 2862 202d 2061 2920 2a20 2862 632e 7261  (b - a) * (bc.ra
-0000b9b0: 6e64 6f6d 2e72 616e 646f 6d5f 696e 7465  ndom.random_inte
-0000b9c0: 6765 7273 284e 2920 2d20 3129 202f 2028  gers(N) - 1) / (
-0000b9d0: 4e20 2d20 312e 290d 0a0d 0a20 2045 7861  N - 1.)....  Exa
-0000b9e0: 6d70 6c65 730d 0a20 202d 2d2d 2d2d 2d2d  mples..  -------
-0000b9f0: 2d0d 0a20 203e 3e3e 2069 6d70 6f72 7420  -..  >>> import 
-0000ba00: 6272 6169 6e63 6f72 6520 6173 2062 630d  braincore as bc.
-0000ba10: 0a20 203e 3e3e 2062 632e 7261 6e64 6f6d  .  >>> bc.random
-0000ba20: 2e72 616e 646f 6d5f 696e 7465 6765 7273  .random_integers
-0000ba30: 2835 290d 0a20 2034 2023 2072 616e 646f  (5)..  4 # rando
-0000ba40: 6d0d 0a20 203e 3e3e 2074 7970 6528 6263  m..  >>> type(bc
-0000ba50: 2e72 616e 646f 6d2e 7261 6e64 6f6d 5f69  .random.random_i
-0000ba60: 6e74 6567 6572 7328 3529 290d 0a20 203c  ntegers(5))..  <
-0000ba70: 636c 6173 7320 276e 756d 7079 2e69 6e74  class 'numpy.int
-0000ba80: 3634 273e 0d0a 2020 3e3e 3e20 6263 2e72  64'>..  >>> bc.r
-0000ba90: 616e 646f 6d2e 7261 6e64 6f6d 5f69 6e74  andom.random_int
-0000baa0: 6567 6572 7328 352c 2073 697a 653d 2833  egers(5, size=(3
-0000bab0: 2c32 2929 0d0a 2020 6172 7261 7928 5b5b  ,2))..  array([[
-0000bac0: 352c 2034 5d2c 2023 2072 616e 646f 6d0d  5, 4], # random.
-0000bad0: 0a20 2020 2020 2020 2020 5b33 2c20 335d  .         [3, 3]
-0000bae0: 2c0d 0a20 2020 2020 2020 2020 5b34 2c20  ,..         [4, 
-0000baf0: 355d 5d29 0d0a 0d0a 2020 4368 6f6f 7365  5]])....  Choose
-0000bb00: 2066 6976 6520 7261 6e64 6f6d 206e 756d   five random num
-0000bb10: 6265 7273 2066 726f 6d20 7468 6520 7365  bers from the se
-0000bb20: 7420 6f66 2066 6976 6520 6576 656e 6c79  t of five evenly
-0000bb30: 2d73 7061 6365 640d 0a20 206e 756d 6265  -spaced..  numbe
-0000bb40: 7273 2062 6574 7765 656e 2030 2061 6e64  rs between 0 and
-0000bb50: 2032 2e35 2c20 696e 636c 7573 6976 6520   2.5, inclusive 
-0000bb60: 282a 692e 652e 2a2c 2066 726f 6d20 7468  (*i.e.*, from th
-0000bb70: 6520 7365 740d 0a20 203a 6d61 7468 3a60  e set..  :math:`
-0000bb80: 7b30 2c20 352f 382c 2031 302f 382c 2031  {0, 5/8, 10/8, 1
-0000bb90: 352f 382c 2032 302f 387d 6029 3a0d 0a0d  5/8, 20/8}`):...
-0000bba0: 0a20 203e 3e3e 2032 2e35 202a 2028 6263  .  >>> 2.5 * (bc
-0000bbb0: 2e72 616e 646f 6d2e 7261 6e64 6f6d 5f69  .random.random_i
-0000bbc0: 6e74 6567 6572 7328 352c 2073 697a 653d  ntegers(5, size=
-0000bbd0: 2835 2c29 2920 2d20 3129 202f 2034 2e0d  (5,)) - 1) / 4..
-0000bbe0: 0a20 2061 7272 6179 285b 2030 2e36 3235  .  array([ 0.625
-0000bbf0: 2c20 2031 2e32 3520 2c20 2030 2e36 3235  ,  1.25 ,  0.625
-0000bc00: 2c20 2030 2e36 3235 2c20 2032 2e35 2020  ,  0.625,  2.5  
-0000bc10: 5d29 2023 2072 616e 646f 6d0d 0a0d 0a20  ]) # random.... 
-0000bc20: 2052 6f6c 6c20 7477 6f20 7369 7820 7369   Roll two six si
-0000bc30: 6465 6420 6469 6365 2031 3030 3020 7469  ded dice 1000 ti
-0000bc40: 6d65 7320 616e 6420 7375 6d20 7468 6520  mes and sum the 
-0000bc50: 7265 7375 6c74 733a 0d0a 0d0a 2020 3e3e  results:....  >>
-0000bc60: 3e20 6431 203d 2062 632e 7261 6e64 6f6d  > d1 = bc.random
-0000bc70: 2e72 616e 646f 6d5f 696e 7465 6765 7273  .random_integers
-0000bc80: 2831 2c20 362c 2031 3030 3029 0d0a 2020  (1, 6, 1000)..  
-0000bc90: 3e3e 3e20 6432 203d 2062 632e 7261 6e64  >>> d2 = bc.rand
-0000bca0: 6f6d 2e72 616e 646f 6d5f 696e 7465 6765  om.random_intege
-0000bcb0: 7273 2831 2c20 362c 2031 3030 3029 0d0a  rs(1, 6, 1000)..
-0000bcc0: 2020 3e3e 3e20 6473 756d 7320 3d20 6431    >>> dsums = d1
-0000bcd0: 202b 2064 320d 0a0d 0a20 2044 6973 706c   + d2....  Displ
-0000bce0: 6179 2072 6573 756c 7473 2061 7320 6120  ay results as a 
-0000bcf0: 6869 7374 6f67 7261 6d3a 0d0a 0d0a 2020  histogram:....  
-0000bd00: 3e3e 3e20 696d 706f 7274 206d 6174 706c  >>> import matpl
-0000bd10: 6f74 6c69 622e 7079 706c 6f74 2061 7320  otlib.pyplot as 
-0000bd20: 706c 7420 2023 206e 6f71 610d 0a20 203e  plt  # noqa..  >
-0000bd30: 3e3e 2063 6f75 6e74 2c20 6269 6e73 2c20  >> count, bins, 
-0000bd40: 6967 6e6f 7265 6420 3d20 706c 742e 6869  ignored = plt.hi
-0000bd50: 7374 2864 7375 6d73 2c20 3131 2c20 6465  st(dsums, 11, de
-0000bd60: 6e73 6974 793d 5472 7565 290d 0a20 203e  nsity=True)..  >
-0000bd70: 3e3e 2070 6c74 2e73 686f 7728 290d 0a20  >> plt.show().. 
-0000bd80: 2022 2222 0d0a 0d0a 2020 7265 7475 726e   """....  return
-0000bd90: 2044 4546 4155 4c54 2e72 616e 646f 6d5f   DEFAULT.random_
-0000bda0: 696e 7465 6765 7273 286c 6f77 2c20 6869  integers(low, hi
-0000bdb0: 6768 3d68 6967 682c 2073 697a 653d 7369  gh=high, size=si
-0000bdc0: 7a65 2c20 6b65 793d 6b65 792c 2064 7479  ze, key=key, dty
-0000bdd0: 7065 3d64 7479 7065 290d 0a0d 0a0d 0a64  pe=dtype)......d
-0000bde0: 6566 2072 616e 646e 282a 646e 2c20 6b65  ef randn(*dn, ke
-0000bdf0: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
-0000be00: 4f72 4b65 795d 203d 204e 6f6e 652c 2064  OrKey] = None, d
-0000be10: 7479 7065 3a20 4454 7970 654c 696b 6520  type: DTypeLike 
-0000be20: 3d20 4e6f 6e65 293a 0d0a 2020 7222 2222  = None):..  r"""
-0000be30: 0d0a 2020 5265 7475 726e 2061 2073 616d  ..  Return a sam
-0000be40: 706c 6520 286f 7220 7361 6d70 6c65 7329  ple (or samples)
-0000be50: 2066 726f 6d20 7468 6520 2273 7461 6e64   from the "stand
-0000be60: 6172 6420 6e6f 726d 616c 2220 6469 7374  ard normal" dist
-0000be70: 7269 6275 7469 6f6e 2e0d 0a0d 0a20 202e  ribution.....  .
-0000be80: 2e20 6e6f 7465 3a3a 0d0a 2020 2020 2020  . note::..      
-0000be90: 5468 6973 2069 7320 6120 636f 6e76 656e  This is a conven
-0000bea0: 6965 6e63 6520 6675 6e63 7469 6f6e 2066  ience function f
-0000beb0: 6f72 2075 7365 7273 2070 6f72 7469 6e67  or users porting
-0000bec0: 2063 6f64 6520 6672 6f6d 204d 6174 6c61   code from Matla
-0000bed0: 622c 0d0a 2020 2020 2020 616e 6420 7772  b,..      and wr
-0000bee0: 6170 7320 6073 7461 6e64 6172 645f 6e6f  aps `standard_no
-0000bef0: 726d 616c 602e 2054 6861 7420 6675 6e63  rmal`. That func
-0000bf00: 7469 6f6e 2074 616b 6573 2061 0d0a 2020  tion takes a..  
-0000bf10: 2020 2020 7475 706c 6520 746f 2073 7065      tuple to spe
-0000bf20: 6369 6679 2074 6865 2073 697a 6520 6f66  cify the size of
-0000bf30: 2074 6865 206f 7574 7075 742c 2077 6869   the output, whi
-0000bf40: 6368 2069 7320 636f 6e73 6973 7465 6e74  ch is consistent
-0000bf50: 2077 6974 680d 0a20 2020 2020 206f 7468   with..      oth
-0000bf60: 6572 204e 756d 5079 2066 756e 6374 696f  er NumPy functio
-0000bf70: 6e73 206c 696b 6520 606e 756d 7079 2e7a  ns like `numpy.z
-0000bf80: 6572 6f73 6020 616e 6420 606e 756d 7079  eros` and `numpy
-0000bf90: 2e6f 6e65 7360 2e0d 0a0d 0a20 202e 2e20  .ones`.....  .. 
-0000bfa0: 6e6f 7465 3a3a 0d0a 2020 2020 2020 4e65  note::..      Ne
-0000bfb0: 7720 636f 6465 2073 686f 756c 6420 7573  w code should us
-0000bfc0: 6520 7468 6520 6060 7374 616e 6461 7264  e the ``standard
-0000bfd0: 5f6e 6f72 6d61 6c60 6020 6d65 7468 6f64  _normal`` method
-0000bfe0: 206f 6620 6120 6060 6465 6661 756c 745f   of a ``default_
-0000bff0: 726e 6728 2960 600d 0a20 2020 2020 2069  rng()``..      i
-0000c000: 6e73 7461 6e63 6520 696e 7374 6561 643b  nstance instead;
-0000c010: 2070 6c65 6173 6520 7365 6520 7468 6520   please see the 
-0000c020: 3a72 6566 3a60 7261 6e64 6f6d 2d71 7569  :ref:`random-qui
-0000c030: 636b 2d73 7461 7274 602e 0d0a 0d0a 2020  ck-start`.....  
-0000c040: 4966 2070 6f73 6974 6976 6520 696e 745f  If positive int_
-0000c050: 6c69 6b65 2061 7267 756d 656e 7473 2061  like arguments a
-0000c060: 7265 2070 726f 7669 6465 642c 2060 7261  re provided, `ra
-0000c070: 6e64 6e60 2067 656e 6572 6174 6573 2061  ndn` generates a
-0000c080: 6e20 6172 7261 790d 0a20 206f 6620 7368  n array..  of sh
-0000c090: 6170 6520 6060 2864 302c 2064 312c 202e  ape ``(d0, d1, .
-0000c0a0: 2e2e 2c20 646e 2960 602c 2066 696c 6c65  .., dn)``, fille
-0000c0b0: 640d 0a20 2077 6974 6820 7261 6e64 6f6d  d..  with random
-0000c0c0: 2066 6c6f 6174 7320 7361 6d70 6c65 6420   floats sampled 
-0000c0d0: 6672 6f6d 2061 2075 6e69 7661 7269 6174  from a univariat
-0000c0e0: 6520 226e 6f72 6d61 6c22 2028 4761 7573  e "normal" (Gaus
-0000c0f0: 7369 616e 290d 0a20 2064 6973 7472 6962  sian)..  distrib
-0000c100: 7574 696f 6e20 6f66 206d 6561 6e20 3020  ution of mean 0 
-0000c110: 616e 6420 7661 7269 616e 6365 2031 2e20  and variance 1. 
-0000c120: 4120 7369 6e67 6c65 2066 6c6f 6174 2072  A single float r
-0000c130: 616e 646f 6d6c 7920 7361 6d70 6c65 640d  andomly sampled.
-0000c140: 0a20 2066 726f 6d20 7468 6520 6469 7374  .  from the dist
-0000c150: 7269 6275 7469 6f6e 2069 7320 7265 7475  ribution is retu
-0000c160: 726e 6564 2069 6620 6e6f 2061 7267 756d  rned if no argum
-0000c170: 656e 7420 6973 2070 726f 7669 6465 642e  ent is provided.
-0000c180: 0d0a 0d0a 2020 5061 7261 6d65 7465 7273  ....  Parameters
-0000c190: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  ..  ----------..
-0000c1a0: 2020 6430 2c20 6431 2c20 2e2e 2e2c 2064    d0, d1, ..., d
-0000c1b0: 6e20 3a20 696e 742c 206f 7074 696f 6e61  n : int, optiona
-0000c1c0: 6c0d 0a20 2020 2020 2054 6865 2064 696d  l..      The dim
-0000c1d0: 656e 7369 6f6e 7320 6f66 2074 6865 2072  ensions of the r
-0000c1e0: 6574 7572 6e65 6420 6172 7261 792c 206d  eturned array, m
-0000c1f0: 7573 7420 6265 206e 6f6e 2d6e 6567 6174  ust be non-negat
-0000c200: 6976 652e 0d0a 2020 2020 2020 4966 206e  ive...      If n
-0000c210: 6f20 6172 6775 6d65 6e74 2069 7320 6769  o argument is gi
-0000c220: 7665 6e20 6120 7369 6e67 6c65 2050 7974  ven a single Pyt
-0000c230: 686f 6e20 666c 6f61 7420 6973 2072 6574  hon float is ret
-0000c240: 7572 6e65 642e 0d0a 2020 6b65 7920 3a20  urned...  key : 
-0000c250: 5052 4e47 4b65 792c 206f 7074 696f 6e61  PRNGKey, optiona
-0000c260: 6c0d 0a20 2020 2020 2054 6865 206b 6579  l..      The key
-0000c270: 2066 6f72 2074 6865 2072 616e 646f 6d20   for the random 
-0000c280: 6e75 6d62 6572 2067 656e 6572 6174 6f72  number generator
-0000c290: 2e20 4966 206e 6f74 2067 6976 656e 2c20  . If not given, 
-0000c2a0: 7468 650d 0a20 2020 2020 2064 6566 6175  the..      defau
-0000c2b0: 6c74 2072 616e 646f 6d20 6e75 6d62 6572  lt random number
-0000c2c0: 2067 656e 6572 6174 6f72 2069 7320 7573   generator is us
-0000c2d0: 6564 2e0d 0a0d 0a20 2052 6574 7572 6e73  ed.....  Returns
-0000c2e0: 0d0a 2020 2d2d 2d2d 2d2d 2d0d 0a20 205a  ..  -------..  Z
-0000c2f0: 203a 206e 6461 7272 6179 206f 7220 666c   : ndarray or fl
-0000c300: 6f61 740d 0a20 2020 2020 2041 2060 6028  oat..      A ``(
-0000c310: 6430 2c20 6431 2c20 2e2e 2e2c 2064 6e29  d0, d1, ..., dn)
-0000c320: 6060 2d73 6861 7065 6420 6172 7261 7920  ``-shaped array 
-0000c330: 6f66 2066 6c6f 6174 696e 672d 706f 696e  of floating-poin
-0000c340: 7420 7361 6d70 6c65 7320 6672 6f6d 0d0a  t samples from..
-0000c350: 2020 2020 2020 7468 6520 7374 616e 6461        the standa
-0000c360: 7264 206e 6f72 6d61 6c20 6469 7374 7269  rd normal distri
-0000c370: 6275 7469 6f6e 2c20 6f72 2061 2073 696e  bution, or a sin
-0000c380: 676c 6520 7375 6368 2066 6c6f 6174 2069  gle such float i
-0000c390: 660d 0a20 2020 2020 206e 6f20 7061 7261  f..      no para
-0000c3a0: 6d65 7465 7273 2077 6572 6520 7375 7070  meters were supp
-0000c3b0: 6c69 6564 2e0d 0a0d 0a20 2053 6565 2041  lied.....  See A
-0000c3c0: 6c73 6f0d 0a20 202d 2d2d 2d2d 2d2d 2d0d  lso..  --------.
-0000c3d0: 0a20 2073 7461 6e64 6172 645f 6e6f 726d  .  standard_norm
-0000c3e0: 616c 203a 2053 696d 696c 6172 2c20 6275  al : Similar, bu
-0000c3f0: 7420 7461 6b65 7320 6120 7475 706c 6520  t takes a tuple 
-0000c400: 6173 2069 7473 2061 7267 756d 656e 742e  as its argument.
-0000c410: 0d0a 2020 6e6f 726d 616c 203a 2041 6c73  ..  normal : Als
-0000c420: 6f20 6163 6365 7074 7320 6d75 2061 6e64  o accepts mu and
-0000c430: 2073 6967 6d61 2061 7267 756d 656e 7473   sigma arguments
-0000c440: 2e0d 0a0d 0a20 204e 6f74 6573 0d0a 2020  .....  Notes..  
-0000c450: 2d2d 2d2d 2d0d 0a20 2046 6f72 2072 616e  -----..  For ran
-0000c460: 646f 6d20 7361 6d70 6c65 7320 6672 6f6d  dom samples from
-0000c470: 203a 6d61 7468 3a60 4e28 5c6d 752c 205c   :math:`N(\mu, \
-0000c480: 7369 676d 615e 3229 602c 2075 7365 3a0d  sigma^2)`, use:.
-0000c490: 0a0d 0a20 2060 6073 6967 6d61 202a 2062  ...  ``sigma * b
-0000c4a0: 632e 7261 6e64 6f6d 2e72 616e 646e 282e  c.random.randn(.
-0000c4b0: 2e2e 2920 2b20 6d75 6060 0d0a 0d0a 2020  ..) + mu``....  
-0000c4c0: 4578 616d 706c 6573 0d0a 2020 2d2d 2d2d  Examples..  ----
-0000c4d0: 2d2d 2d2d 0d0a 2020 3e3e 3e20 696d 706f  ----..  >>> impo
-0000c4e0: 7274 2062 7261 696e 636f 7265 2061 7320  rt braincore as 
-0000c4f0: 6263 0d0a 2020 3e3e 3e20 6263 2e72 616e  bc..  >>> bc.ran
-0000c500: 646f 6d2e 7261 6e64 6e28 290d 0a20 2032  dom.randn()..  2
-0000c510: 2e31 3932 3338 3735 3333 3535 3337 3331  .192387533553731
-0000c520: 3520 2023 2072 616e 646f 6d0d 0a0d 0a20  5  # random.... 
-0000c530: 2054 776f 2d62 792d 666f 7572 2061 7272   Two-by-four arr
-0000c540: 6179 206f 6620 7361 6d70 6c65 7320 6672  ay of samples fr
-0000c550: 6f6d 204e 2833 2c20 362e 3235 293a 0d0a  om N(3, 6.25):..
-0000c560: 0d0a 2020 3e3e 3e20 3320 2b20 322e 3520  ..  >>> 3 + 2.5 
-0000c570: 2a20 6263 2e72 616e 646f 6d2e 7261 6e64  * bc.random.rand
-0000c580: 6e28 322c 2034 290d 0a20 2061 7272 6179  n(2, 4)..  array
-0000c590: 285b 5b2d 342e 3439 3430 3135 3031 2c20  ([[-4.49401501, 
-0000c5a0: 2034 2e30 3039 3530 3033 342c 202d 312e   4.00950034, -1.
-0000c5b0: 3831 3831 3438 3637 2c20 2037 2e32 3937  81814867,  7.297
-0000c5c0: 3138 3637 375d 2c20 2020 2320 7261 6e64  18677],   # rand
-0000c5d0: 6f6d 0d0a 2020 2020 2020 2020 205b 2030  om..         [ 0
-0000c5e0: 2e33 3939 3234 3830 342c 2020 342e 3638  .39924804,  4.68
-0000c5f0: 3435 3633 3136 2c20 2034 2e39 3933 3934  456316,  4.99394
-0000c600: 3532 392c 2020 342e 3834 3035 3732 3534  529,  4.84057254
-0000c610: 5d5d 2920 2023 2072 616e 646f 6d0d 0a20  ]])  # random.. 
-0000c620: 2022 2222 0d0a 0d0a 2020 7265 7475 726e   """....  return
-0000c630: 2044 4546 4155 4c54 2e72 616e 646e 282a   DEFAULT.randn(*
-0000c640: 646e 2c20 6b65 793d 6b65 792c 2064 7479  dn, key=key, dty
-0000c650: 7065 3d64 7479 7065 290d 0a0d 0a0d 0a64  pe=dtype)......d
-0000c660: 6566 2072 616e 646f 6d28 7369 7a65 3a20  ef random(size: 
-0000c670: 4f70 7469 6f6e 616c 5b53 697a 655d 203d  Optional[Size] =
-0000c680: 204e 6f6e 652c 206b 6579 3a20 4f70 7469   None, key: Opti
-0000c690: 6f6e 616c 5b53 6565 644f 724b 6579 5d20  onal[SeedOrKey] 
-0000c6a0: 3d20 4e6f 6e65 2c20 6474 7970 653a 2044  = None, dtype: D
-0000c6b0: 5479 7065 4c69 6b65 203d 204e 6f6e 6529  TypeLike = None)
-0000c6c0: 3a0d 0a20 2072 2222 220d 0a20 2052 6574  :..  r"""..  Ret
-0000c6d0: 7572 6e20 7261 6e64 6f6d 2066 6c6f 6174  urn random float
-0000c6e0: 7320 696e 2074 6865 2068 616c 662d 6f70  s in the half-op
-0000c6f0: 656e 2069 6e74 6572 7661 6c20 5b30 2e30  en interval [0.0
-0000c700: 2c20 312e 3029 2e20 416c 6961 7320 666f  , 1.0). Alias fo
-0000c710: 720d 0a20 2060 7261 6e64 6f6d 5f73 616d  r..  `random_sam
-0000c720: 706c 6560 2074 6f20 6561 7365 2066 6f72  ple` to ease for
-0000c730: 7761 7264 2d70 6f72 7469 6e67 2074 6f20  ward-porting to 
-0000c740: 7468 6520 6e65 7720 7261 6e64 6f6d 2041  the new random A
-0000c750: 5049 2e0d 0a20 2022 2222 0d0a 2020 7265  PI...  """..  re
-0000c760: 7475 726e 2044 4546 4155 4c54 2e72 616e  turn DEFAULT.ran
-0000c770: 646f 6d28 7369 7a65 2c20 6b65 793d 6b65  dom(size, key=ke
-0000c780: 792c 2064 7479 7065 3d64 7479 7065 290d  y, dtype=dtype).
-0000c790: 0a0d 0a0d 0a64 6566 2072 616e 646f 6d5f  .....def random_
-0000c7a0: 7361 6d70 6c65 2873 697a 653a 204f 7074  sample(size: Opt
-0000c7b0: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
-0000c7c0: 6e65 2c20 6b65 793a 204f 7074 696f 6e61  ne, key: Optiona
-0000c7d0: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
-0000c7e0: 6f6e 652c 2064 7479 7065 3a20 4454 7970  one, dtype: DTyp
-0000c7f0: 654c 696b 6520 3d20 4e6f 6e65 293a 0d0a  eLike = None):..
-0000c800: 2020 7222 2222 0d0a 2020 5265 7475 726e    r"""..  Return
-0000c810: 2072 616e 646f 6d20 666c 6f61 7473 2069   random floats i
-0000c820: 6e20 7468 6520 6861 6c66 2d6f 7065 6e20  n the half-open 
-0000c830: 696e 7465 7276 616c 205b 302e 302c 2031  interval [0.0, 1
-0000c840: 2e30 292e 0d0a 0d0a 2020 5265 7375 6c74  .0).....  Result
-0000c850: 7320 6172 6520 6672 6f6d 2074 6865 2022  s are from the "
-0000c860: 636f 6e74 696e 756f 7573 2075 6e69 666f  continuous unifo
-0000c870: 726d 2220 6469 7374 7269 6275 7469 6f6e  rm" distribution
-0000c880: 206f 7665 7220 7468 650d 0a20 2073 7461   over the..  sta
-0000c890: 7465 6420 696e 7465 7276 616c 2e20 2054  ted interval.  T
-0000c8a0: 6f20 7361 6d70 6c65 203a 6d61 7468 3a60  o sample :math:`
-0000c8b0: 556e 6966 5b61 2c20 6229 2c20 6220 3e20  Unif[a, b), b > 
-0000c8c0: 6160 206d 756c 7469 706c 790d 0a20 2074  a` multiply..  t
-0000c8d0: 6865 206f 7574 7075 7420 6f66 2060 7261  he output of `ra
-0000c8e0: 6e64 6f6d 5f73 616d 706c 6560 2062 7920  ndom_sample` by 
-0000c8f0: 6028 622d 6129 6020 616e 6420 6164 6420  `(b-a)` and add 
-0000c900: 6061 603a 3a0d 0a0d 0a20 2020 2028 6220  `a`::....    (b 
-0000c910: 2d20 6129 202a 2072 616e 646f 6d5f 7361  - a) * random_sa
-0000c920: 6d70 6c65 2829 202b 2061 0d0a 0d0a 2020  mple() + a....  
-0000c930: 2e2e 206e 6f74 653a 3a0d 0a20 2020 2020  .. note::..     
-0000c940: 204e 6577 2063 6f64 6520 7368 6f75 6c64   New code should
-0000c950: 2075 7365 2074 6865 2060 6072 616e 646f   use the ``rando
-0000c960: 6d60 6020 6d65 7468 6f64 206f 6620 6120  m`` method of a 
-0000c970: 6060 6465 6661 756c 745f 726e 6728 2960  ``default_rng()`
-0000c980: 600d 0a20 2020 2020 2069 6e73 7461 6e63  `..      instanc
-0000c990: 6520 696e 7374 6561 643b 2070 6c65 6173  e instead; pleas
-0000c9a0: 6520 7365 6520 7468 6520 3a72 6566 3a60  e see the :ref:`
-0000c9b0: 7261 6e64 6f6d 2d71 7569 636b 2d73 7461  random-quick-sta
-0000c9c0: 7274 602e 0d0a 0d0a 2020 5061 7261 6d65  rt`.....  Parame
-0000c9d0: 7465 7273 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ters..  --------
-0000c9e0: 2d2d 0d0a 2020 7369 7a65 203a 2069 6e74  --..  size : int
-0000c9f0: 206f 7220 7475 706c 6520 6f66 2069 6e74   or tuple of int
-0000ca00: 732c 206f 7074 696f 6e61 6c0d 0a20 2020  s, optional..   
-0000ca10: 2020 204f 7574 7075 7420 7368 6170 652e     Output shape.
-0000ca20: 2020 4966 2074 6865 2067 6976 656e 2073    If the given s
-0000ca30: 6861 7065 2069 732c 2065 2e67 2e2c 2060  hape is, e.g., `
-0000ca40: 6028 6d2c 206e 2c20 6b29 6060 2c20 7468  `(m, n, k)``, th
-0000ca50: 656e 0d0a 2020 2020 2020 6060 6d20 2a20  en..      ``m * 
-0000ca60: 6e20 2a20 6b60 6020 7361 6d70 6c65 7320  n * k`` samples 
-0000ca70: 6172 6520 6472 6177 6e2e 2020 4465 6661  are drawn.  Defa
-0000ca80: 756c 7420 6973 204e 6f6e 652c 2069 6e20  ult is None, in 
-0000ca90: 7768 6963 6820 6361 7365 2061 0d0a 2020  which case a..  
-0000caa0: 2020 2020 7369 6e67 6c65 2076 616c 7565      single value
-0000cab0: 2069 7320 7265 7475 726e 6564 2e0d 0a20   is returned... 
-0000cac0: 206b 6579 203a 2050 524e 474b 6579 2c20   key : PRNGKey, 
-0000cad0: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-0000cae0: 5468 6520 6b65 7920 666f 7220 7468 6520  The key for the 
-0000caf0: 7261 6e64 6f6d 206e 756d 6265 7220 6765  random number ge
-0000cb00: 6e65 7261 746f 722e 2049 6620 6e6f 7420  nerator. If not 
-0000cb10: 6769 7665 6e2c 2074 6865 0d0a 2020 2020  given, the..    
-0000cb20: 2020 6465 6661 756c 7420 7261 6e64 6f6d    default random
-0000cb30: 206e 756d 6265 7220 6765 6e65 7261 746f   number generato
-0000cb40: 7220 6973 2075 7365 642e 0d0a 0d0a 2020  r is used.....  
-0000cb50: 5265 7475 726e 730d 0a20 202d 2d2d 2d2d  Returns..  -----
-0000cb60: 2d2d 0d0a 2020 6f75 7420 3a20 666c 6f61  --..  out : floa
-0000cb70: 7420 6f72 206e 6461 7272 6179 206f 6620  t or ndarray of 
-0000cb80: 666c 6f61 7473 0d0a 2020 2020 2020 4172  floats..      Ar
-0000cb90: 7261 7920 6f66 2072 616e 646f 6d20 666c  ray of random fl
-0000cba0: 6f61 7473 206f 6620 7368 6170 6520 6073  oats of shape `s
-0000cbb0: 697a 6560 2028 756e 6c65 7373 2060 6073  ize` (unless ``s
-0000cbc0: 697a 653d 4e6f 6e65 6060 2c20 696e 2077  ize=None``, in w
-0000cbd0: 6869 6368 0d0a 2020 2020 2020 6361 7365  hich..      case
-0000cbe0: 2061 2073 696e 676c 6520 666c 6f61 7420   a single float 
-0000cbf0: 6973 2072 6574 7572 6e65 6429 2e0d 0a0d  is returned)....
-0000cc00: 0a20 2053 6565 2041 6c73 6f0d 0a20 202d  .  See Also..  -
-0000cc10: 2d2d 2d2d 2d2d 2d0d 0a20 2047 656e 6572  -------..  Gener
-0000cc20: 6174 6f72 2e72 616e 646f 6d3a 2077 6869  ator.random: whi
-0000cc30: 6368 2073 686f 756c 6420 6265 2075 7365  ch should be use
-0000cc40: 6420 666f 7220 6e65 7720 636f 6465 2e0d  d for new code..
-0000cc50: 0a0d 0a20 2045 7861 6d70 6c65 730d 0a20  ...  Examples.. 
-0000cc60: 202d 2d2d 2d2d 2d2d 2d0d 0a20 203e 3e3e   --------..  >>>
-0000cc70: 2069 6d70 6f72 7420 6272 6169 6e63 6f72   import braincor
-0000cc80: 6520 6173 2062 630d 0a20 203e 3e3e 2062  e as bc..  >>> b
-0000cc90: 632e 7261 6e64 6f6d 2e72 616e 646f 6d5f  c.random.random_
-0000cca0: 7361 6d70 6c65 2829 0d0a 2020 302e 3437  sample()..  0.47
-0000ccb0: 3130 3835 3437 3939 3533 3536 3039 3820  108547995356098 
-0000ccc0: 2320 7261 6e64 6f6d 0d0a 2020 3e3e 3e20  # random..  >>> 
-0000ccd0: 7479 7065 2862 632e 7261 6e64 6f6d 2e72  type(bc.random.r
-0000cce0: 616e 646f 6d5f 7361 6d70 6c65 2829 290d  andom_sample()).
-0000ccf0: 0a20 203c 636c 6173 7320 2766 6c6f 6174  .  <class 'float
-0000cd00: 273e 0d0a 2020 3e3e 3e20 6263 2e72 616e  '>..  >>> bc.ran
-0000cd10: 646f 6d2e 7261 6e64 6f6d 5f73 616d 706c  dom.random_sampl
-0000cd20: 6528 2835 2c29 290d 0a20 2061 7272 6179  e((5,))..  array
-0000cd30: 285b 2030 2e33 3032 3230 3438 322c 2020  ([ 0.30220482,  
-0000cd40: 302e 3836 3832 3034 3031 2c20 2030 2e31  0.86820401,  0.1
-0000cd50: 3635 3435 3033 202c 2020 302e 3131 3635  654503 ,  0.1165
-0000cd60: 3931 3439 2c20 2030 2e35 3433 3233 3432  9149,  0.5432342
-0000cd70: 385d 2920 2320 7261 6e64 6f6d 0d0a 0d0a  8]) # random....
-0000cd80: 2020 5468 7265 652d 6279 2d74 776f 2061    Three-by-two a
-0000cd90: 7272 6179 206f 6620 7261 6e64 6f6d 206e  rray of random n
-0000cda0: 756d 6265 7273 2066 726f 6d20 5b2d 352c  umbers from [-5,
-0000cdb0: 2030 293a 0d0a 0d0a 2020 3e3e 3e20 3520   0):....  >>> 5 
-0000cdc0: 2a20 6263 2e72 616e 646f 6d2e 7261 6e64  * bc.random.rand
-0000cdd0: 6f6d 5f73 616d 706c 6528 2833 2c20 3229  om_sample((3, 2)
-0000cde0: 2920 2d20 350d 0a20 2061 7272 6179 285b  ) - 5..  array([
-0000cdf0: 5b2d 332e 3939 3134 3939 3839 2c20 2d30  [-3.99149989, -0
-0000ce00: 2e35 3233 3338 3938 345d 2c20 2320 7261  .52338984], # ra
-0000ce10: 6e64 6f6d 0d0a 2020 2020 2020 2020 205b  ndom..         [
-0000ce20: 2d32 2e39 3930 3931 3835 382c 202d 302e  -2.99091858, -0.
-0000ce30: 3739 3437 3935 3038 5d2c 0d0a 2020 2020  79479508],..    
-0000ce40: 2020 2020 205b 2d31 2e32 3332 3034 3334       [-1.2320434
-0000ce50: 352c 202d 312e 3735 3232 3434 3934 5d5d  5, -1.75224494]]
-0000ce60: 290d 0a20 2022 2222 0d0a 2020 7265 7475  )..  """..  retu
-0000ce70: 726e 2044 4546 4155 4c54 2e72 616e 646f  rn DEFAULT.rando
-0000ce80: 6d5f 7361 6d70 6c65 2873 697a 652c 206b  m_sample(size, k
-0000ce90: 6579 3d6b 6579 2c20 6474 7970 653d 6474  ey=key, dtype=dt
-0000cea0: 7970 6529 0d0a 0d0a 0d0a 6465 6620 7261  ype)......def ra
-0000ceb0: 6e66 2873 697a 653a 204f 7074 696f 6e61  nf(size: Optiona
-0000cec0: 6c5b 5369 7a65 5d20 3d20 4e6f 6e65 2c20  l[Size] = None, 
-0000ced0: 6b65 793a 204f 7074 696f 6e61 6c5b 5365  key: Optional[Se
-0000cee0: 6564 4f72 4b65 795d 203d 204e 6f6e 652c  edOrKey] = None,
-0000cef0: 2064 7479 7065 3a20 4454 7970 654c 696b   dtype: DTypeLik
-0000cf00: 6520 3d20 4e6f 6e65 293a 0d0a 2020 7222  e = None):..  r"
-0000cf10: 2222 0d0a 2020 5468 6973 2069 7320 616e  ""..  This is an
-0000cf20: 2061 6c69 6173 206f 6620 6072 616e 646f   alias of `rando
-0000cf30: 6d5f 7361 6d70 6c65 602e 2053 6565 2060  m_sample`. See `
-0000cf40: 7261 6e64 6f6d 5f73 616d 706c 6560 2020  random_sample`  
-0000cf50: 666f 7220 7468 6520 636f 6d70 6c65 7465  for the complete
-0000cf60: 0d0a 2020 646f 6375 6d65 6e74 6174 696f  ..  documentatio
-0000cf70: 6e2e 0d0a 2020 2222 220d 0a20 2072 6574  n...  """..  ret
-0000cf80: 7572 6e20 4445 4641 554c 542e 7261 6e66  urn DEFAULT.ranf
-0000cf90: 2873 697a 652c 206b 6579 3d6b 6579 2c20  (size, key=key, 
-0000cfa0: 6474 7970 653d 6474 7970 6529 0d0a 0d0a  dtype=dtype)....
-0000cfb0: 0d0a 6465 6620 7361 6d70 6c65 2873 697a  ..def sample(siz
-0000cfc0: 653a 204f 7074 696f 6e61 6c5b 5369 7a65  e: Optional[Size
-0000cfd0: 5d20 3d20 4e6f 6e65 2c20 6b65 793a 204f  ] = None, key: O
-0000cfe0: 7074 696f 6e61 6c5b 5365 6564 4f72 4b65  ptional[SeedOrKe
-0000cff0: 795d 203d 204e 6f6e 652c 2064 7479 7065  y] = None, dtype
-0000d000: 3a20 4454 7970 654c 696b 6520 3d20 4e6f  : DTypeLike = No
-0000d010: 6e65 293a 0d0a 2020 2222 220d 0a20 2054  ne):..  """..  T
-0000d020: 6869 7320 6973 2061 6e20 616c 6961 7320  his is an alias 
-0000d030: 6f66 2060 7261 6e64 6f6d 5f73 616d 706c  of `random_sampl
-0000d040: 6560 2e20 5365 6520 6072 616e 646f 6d5f  e`. See `random_
-0000d050: 7361 6d70 6c65 6020 2066 6f72 2074 6865  sample`  for the
-0000d060: 2063 6f6d 706c 6574 650d 0a20 2064 6f63   complete..  doc
-0000d070: 756d 656e 7461 7469 6f6e 2e0d 0a20 2022  umentation...  "
-0000d080: 2222 0d0a 2020 7265 7475 726e 2044 4546  ""..  return DEF
-0000d090: 4155 4c54 2e73 616d 706c 6528 7369 7a65  AULT.sample(size
-0000d0a0: 2c20 6b65 793d 6b65 792c 2064 7479 7065  , key=key, dtype
-0000d0b0: 3d64 7479 7065 290d 0a0d 0a0d 0a64 6566  =dtype)......def
-0000d0c0: 2063 686f 6963 6528 612c 2073 697a 653a   choice(a, size:
-0000d0d0: 204f 7074 696f 6e61 6c5b 5369 7a65 5d20   Optional[Size] 
-0000d0e0: 3d20 4e6f 6e65 2c20 7265 706c 6163 653d  = None, replace=
-0000d0f0: 5472 7565 2c20 703d 4e6f 6e65 2c0d 0a20  True, p=None,.. 
-0000d100: 2020 2020 2020 2020 2020 6b65 793a 204f            key: O
-0000d110: 7074 696f 6e61 6c5b 5365 6564 4f72 4b65  ptional[SeedOrKe
-0000d120: 795d 203d 204e 6f6e 6529 3a0d 0a20 2072  y] = None):..  r
-0000d130: 2222 220d 0a20 2047 656e 6572 6174 6573  """..  Generates
-0000d140: 2061 2072 616e 646f 6d20 7361 6d70 6c65   a random sample
-0000d150: 2066 726f 6d20 6120 6769 7665 6e20 312d   from a given 1-
-0000d160: 4420 6172 7261 790d 0a0d 0a20 2050 6172  D array....  Par
-0000d170: 616d 6574 6572 730d 0a20 202d 2d2d 2d2d  ameters..  -----
-0000d180: 2d2d 2d2d 2d0d 0a20 2061 203a 2031 2d44  -----..  a : 1-D
-0000d190: 2061 7272 6179 2d6c 696b 6520 6f72 2069   array-like or i
-0000d1a0: 6e74 0d0a 2020 2020 2020 4966 2061 6e20  nt..      If an 
-0000d1b0: 6e64 6172 7261 792c 2061 2072 616e 646f  ndarray, a rando
-0000d1c0: 6d20 7361 6d70 6c65 2069 7320 6765 6e65  m sample is gene
-0000d1d0: 7261 7465 6420 6672 6f6d 2069 7473 2065  rated from its e
-0000d1e0: 6c65 6d65 6e74 732e 0d0a 2020 2020 2020  lements...      
-0000d1f0: 4966 2061 6e20 696e 742c 2074 6865 2072  If an int, the r
-0000d200: 616e 646f 6d20 7361 6d70 6c65 2069 7320  andom sample is 
-0000d210: 6765 6e65 7261 7465 6420 6173 2069 6620  generated as if 
-0000d220: 6974 2077 6572 6520 6060 6e70 2e61 7261  it were ``np.ara
-0000d230: 6e67 6528 6129 6060 0d0a 2020 7369 7a65  nge(a)``..  size
-0000d240: 203a 2069 6e74 206f 7220 7475 706c 6520   : int or tuple 
-0000d250: 6f66 2069 6e74 732c 206f 7074 696f 6e61  of ints, optiona
-0000d260: 6c0d 0a20 2020 2020 204f 7574 7075 7420  l..      Output 
-0000d270: 7368 6170 652e 2020 4966 2074 6865 2067  shape.  If the g
-0000d280: 6976 656e 2073 6861 7065 2069 732c 2065  iven shape is, e
-0000d290: 2e67 2e2c 2060 6028 6d2c 206e 2c20 6b29  .g., ``(m, n, k)
-0000d2a0: 6060 2c20 7468 656e 0d0a 2020 2020 2020  ``, then..      
-0000d2b0: 6060 6d20 2a20 6e20 2a20 6b60 6020 7361  ``m * n * k`` sa
-0000d2c0: 6d70 6c65 7320 6172 6520 6472 6177 6e2e  mples are drawn.
-0000d2d0: 2020 4465 6661 756c 7420 6973 204e 6f6e    Default is Non
-0000d2e0: 652c 2069 6e20 7768 6963 6820 6361 7365  e, in which case
-0000d2f0: 2061 0d0a 2020 2020 2020 7369 6e67 6c65   a..      single
-0000d300: 2076 616c 7565 2069 7320 7265 7475 726e   value is return
-0000d310: 6564 2e0d 0a20 2072 6570 6c61 6365 203a  ed...  replace :
-0000d320: 2062 6f6f 6c65 616e 2c20 6f70 7469 6f6e   boolean, option
-0000d330: 616c 0d0a 2020 2020 2020 5768 6574 6865  al..      Whethe
-0000d340: 7220 7468 6520 7361 6d70 6c65 2069 7320  r the sample is 
-0000d350: 7769 7468 206f 7220 7769 7468 6f75 7420  with or without 
-0000d360: 7265 706c 6163 656d 656e 742e 2044 6566  replacement. Def
-0000d370: 6175 6c74 2069 7320 5472 7565 2c0d 0a20  ault is True,.. 
-0000d380: 2020 2020 206d 6561 6e69 6e67 2074 6861       meaning tha
-0000d390: 7420 6120 7661 6c75 6520 6f66 2060 6061  t a value of ``a
-0000d3a0: 6060 2063 616e 2062 6520 7365 6c65 6374  `` can be select
-0000d3b0: 6564 206d 756c 7469 706c 6520 7469 6d65  ed multiple time
-0000d3c0: 732e 0d0a 2020 7020 3a20 312d 4420 6172  s...  p : 1-D ar
-0000d3d0: 7261 792d 6c69 6b65 2c20 6f70 7469 6f6e  ray-like, option
-0000d3e0: 616c 0d0a 2020 2020 2020 5468 6520 7072  al..      The pr
-0000d3f0: 6f62 6162 696c 6974 6965 7320 6173 736f  obabilities asso
-0000d400: 6369 6174 6564 2077 6974 6820 6561 6368  ciated with each
-0000d410: 2065 6e74 7279 2069 6e20 612e 0d0a 2020   entry in a...  
-0000d420: 2020 2020 4966 206e 6f74 2067 6976 656e      If not given
-0000d430: 2c20 7468 6520 7361 6d70 6c65 2061 7373  , the sample ass
-0000d440: 756d 6573 2061 2075 6e69 666f 726d 2064  umes a uniform d
-0000d450: 6973 7472 6962 7574 696f 6e20 6f76 6572  istribution over
-0000d460: 2061 6c6c 0d0a 2020 2020 2020 656e 7472   all..      entr
-0000d470: 6965 7320 696e 2060 6061 6060 2e0d 0a20  ies in ``a``... 
-0000d480: 206b 6579 203a 2050 524e 474b 6579 2c20   key : PRNGKey, 
-0000d490: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-0000d4a0: 5468 6520 6b65 7920 666f 7220 7468 6520  The key for the 
-0000d4b0: 7261 6e64 6f6d 206e 756d 6265 7220 6765  random number ge
-0000d4c0: 6e65 7261 746f 722e 2049 6620 6e6f 7420  nerator. If not 
-0000d4d0: 6769 7665 6e2c 2074 6865 0d0a 2020 2020  given, the..    
-0000d4e0: 2020 6465 6661 756c 7420 7261 6e64 6f6d    default random
-0000d4f0: 206e 756d 6265 7220 6765 6e65 7261 746f   number generato
-0000d500: 7220 6973 2075 7365 642e 0d0a 0d0a 2020  r is used.....  
-0000d510: 5265 7475 726e 730d 0a20 202d 2d2d 2d2d  Returns..  -----
-0000d520: 2d2d 0d0a 2020 7361 6d70 6c65 7320 3a20  --..  samples : 
-0000d530: 7369 6e67 6c65 2069 7465 6d20 6f72 206e  single item or n
-0000d540: 6461 7272 6179 0d0a 2020 2020 2020 5468  darray..      Th
-0000d550: 6520 6765 6e65 7261 7465 6420 7261 6e64  e generated rand
-0000d560: 6f6d 2073 616d 706c 6573 0d0a 0d0a 2020  om samples....  
-0000d570: 5261 6973 6573 0d0a 2020 2d2d 2d2d 2d2d  Raises..  ------
-0000d580: 0d0a 2020 5661 6c75 6545 7272 6f72 0d0a  ..  ValueError..
-0000d590: 2020 2020 2020 4966 2061 2069 7320 616e        If a is an
-0000d5a0: 2069 6e74 2061 6e64 206c 6573 7320 7468   int and less th
-0000d5b0: 616e 207a 6572 6f2c 2069 6620 6120 6f72  an zero, if a or
-0000d5c0: 2070 2061 7265 206e 6f74 2031 2d64 696d   p are not 1-dim
-0000d5d0: 656e 7369 6f6e 616c 2c0d 0a20 2020 2020  ensional,..     
-0000d5e0: 2069 6620 6120 6973 2061 6e20 6172 7261   if a is an arra
-0000d5f0: 792d 6c69 6b65 206f 6620 7369 7a65 2030  y-like of size 0
-0000d600: 2c20 6966 2070 2069 7320 6e6f 7420 6120  , if p is not a 
-0000d610: 7665 6374 6f72 206f 660d 0a20 2020 2020  vector of..     
-0000d620: 2070 726f 6261 6269 6c69 7469 6573 2c20   probabilities, 
-0000d630: 6966 2061 2061 6e64 2070 2068 6176 6520  if a and p have 
-0000d640: 6469 6666 6572 656e 7420 6c65 6e67 7468  different length
-0000d650: 732c 206f 7220 6966 0d0a 2020 2020 2020  s, or if..      
-0000d660: 7265 706c 6163 653d 4661 6c73 6520 616e  replace=False an
-0000d670: 6420 7468 6520 7361 6d70 6c65 2073 697a  d the sample siz
-0000d680: 6520 6973 2067 7265 6174 6572 2074 6861  e is greater tha
-0000d690: 6e20 7468 6520 706f 7075 6c61 7469 6f6e  n the population
-0000d6a0: 0d0a 2020 2020 2020 7369 7a65 0d0a 0d0a  ..      size....
-0000d6b0: 2020 5365 6520 416c 736f 0d0a 2020 2d2d    See Also..  --
-0000d6c0: 2d2d 2d2d 2d2d 0d0a 2020 7261 6e64 696e  ------..  randin
-0000d6d0: 742c 2073 6875 6666 6c65 2c20 7065 726d  t, shuffle, perm
-0000d6e0: 7574 6174 696f 6e0d 0a20 2047 656e 6572  utation..  Gener
-0000d6f0: 6174 6f72 2e63 686f 6963 653a 2077 6869  ator.choice: whi
-0000d700: 6368 2073 686f 756c 6420 6265 2075 7365  ch should be use
-0000d710: 6420 696e 206e 6577 2063 6f64 650d 0a0d  d in new code...
-0000d720: 0a20 204e 6f74 6573 0d0a 2020 2d2d 2d2d  .  Notes..  ----
-0000d730: 2d0d 0a20 2053 6574 7469 6e67 2075 7365  -..  Setting use
-0000d740: 722d 7370 6563 6966 6965 6420 7072 6f62  r-specified prob
-0000d750: 6162 696c 6974 6965 7320 7468 726f 7567  abilities throug
-0000d760: 6820 6060 7060 6020 7573 6573 2061 206d  h ``p`` uses a m
-0000d770: 6f72 6520 6765 6e65 7261 6c20 6275 7420  ore general but 
-0000d780: 6c65 7373 0d0a 2020 6566 6669 6369 656e  less..  efficien
-0000d790: 7420 7361 6d70 6c65 7220 7468 616e 2074  t sampler than t
-0000d7a0: 6865 2064 6566 6175 6c74 2e20 5468 6520  he default. The 
-0000d7b0: 6765 6e65 7261 6c20 7361 6d70 6c65 7220  general sampler 
-0000d7c0: 7072 6f64 7563 6573 2061 2064 6966 6665  produces a diffe
-0000d7d0: 7265 6e74 2073 616d 706c 650d 0a20 2074  rent sample..  t
-0000d7e0: 6861 6e20 7468 6520 6f70 7469 6d69 7a65  han the optimize
-0000d7f0: 6420 7361 6d70 6c65 7220 6576 656e 2069  d sampler even i
-0000d800: 6620 6561 6368 2065 6c65 6d65 6e74 206f  f each element o
-0000d810: 6620 6060 7060 6020 6973 2031 202f 206c  f ``p`` is 1 / l
-0000d820: 656e 2861 292e 0d0a 0d0a 2020 5361 6d70  en(a).....  Samp
-0000d830: 6c69 6e67 2072 616e 646f 6d20 726f 7773  ling random rows
-0000d840: 2066 726f 6d20 6120 322d 4420 6172 7261   from a 2-D arra
-0000d850: 7920 6973 206e 6f74 2070 6f73 7369 626c  y is not possibl
-0000d860: 6520 7769 7468 2074 6869 7320 6675 6e63  e with this func
-0000d870: 7469 6f6e 2c0d 0a20 2062 7574 2069 7320  tion,..  but is 
-0000d880: 706f 7373 6962 6c65 2077 6974 6820 6047  possible with `G
-0000d890: 656e 6572 6174 6f72 2e63 686f 6963 6560  enerator.choice`
-0000d8a0: 2074 6872 6f75 6768 2069 7473 2060 6061   through its ``a
-0000d8b0: 7869 7360 6020 6b65 7977 6f72 642e 0d0a  xis`` keyword...
-0000d8c0: 0d0a 2020 4578 616d 706c 6573 0d0a 2020  ..  Examples..  
-0000d8d0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 4765 6e65  --------..  Gene
-0000d8e0: 7261 7465 2061 2075 6e69 666f 726d 2072  rate a uniform r
-0000d8f0: 616e 646f 6d20 7361 6d70 6c65 2066 726f  andom sample fro
-0000d900: 6d20 6e70 2e61 7261 6e67 6528 3529 206f  m np.arange(5) o
-0000d910: 6620 7369 7a65 2033 3a0d 0a0d 0a20 203e  f size 3:....  >
-0000d920: 3e3e 2069 6d70 6f72 7420 6272 6169 6e63  >> import brainc
-0000d930: 6f72 6520 6173 2062 630d 0a20 203e 3e3e  ore as bc..  >>>
-0000d940: 2062 632e 7261 6e64 6f6d 2e63 686f 6963   bc.random.choic
-0000d950: 6528 352c 2033 290d 0a20 2061 7272 6179  e(5, 3)..  array
-0000d960: 285b 302c 2033 2c20 345d 2920 2320 7261  ([0, 3, 4]) # ra
-0000d970: 6e64 6f6d 0d0a 2020 3e3e 3e20 2354 6869  ndom..  >>> #Thi
-0000d980: 7320 6973 2065 7175 6976 616c 656e 7420  s is equivalent 
-0000d990: 746f 2062 7261 696e 7079 2e6d 6174 682e  to brainpy.math.
-0000d9a0: 7261 6e64 6f6d 2e72 616e 6469 6e74 2830  random.randint(0
-0000d9b0: 2c35 2c33 290d 0a0d 0a20 2047 656e 6572  ,5,3)....  Gener
-0000d9c0: 6174 6520 6120 6e6f 6e2d 756e 6966 6f72  ate a non-unifor
-0000d9d0: 6d20 7261 6e64 6f6d 2073 616d 706c 6520  m random sample 
-0000d9e0: 6672 6f6d 206e 702e 6172 616e 6765 2835  from np.arange(5
-0000d9f0: 2920 6f66 2073 697a 6520 333a 0d0a 0d0a  ) of size 3:....
-0000da00: 2020 3e3e 3e20 6263 2e72 616e 646f 6d2e    >>> bc.random.
-0000da10: 6368 6f69 6365 2835 2c20 332c 2070 3d5b  choice(5, 3, p=[
-0000da20: 302e 312c 2030 2c20 302e 332c 2030 2e36  0.1, 0, 0.3, 0.6
-0000da30: 2c20 305d 290d 0a20 2061 7272 6179 285b  , 0])..  array([
-0000da40: 332c 2033 2c20 305d 2920 2320 7261 6e64  3, 3, 0]) # rand
-0000da50: 6f6d 0d0a 0d0a 2020 4765 6e65 7261 7465  om....  Generate
-0000da60: 2061 2075 6e69 666f 726d 2072 616e 646f   a uniform rando
-0000da70: 6d20 7361 6d70 6c65 2066 726f 6d20 6e70  m sample from np
-0000da80: 2e61 7261 6e67 6528 3529 206f 6620 7369  .arange(5) of si
-0000da90: 7a65 2033 2077 6974 686f 7574 0d0a 2020  ze 3 without..  
-0000daa0: 7265 706c 6163 656d 656e 743a 0d0a 0d0a  replacement:....
-0000dab0: 2020 3e3e 3e20 6263 2e72 616e 646f 6d2e    >>> bc.random.
-0000dac0: 6368 6f69 6365 2835 2c20 332c 2072 6570  choice(5, 3, rep
-0000dad0: 6c61 6365 3d46 616c 7365 290d 0a20 2061  lace=False)..  a
-0000dae0: 7272 6179 285b 332c 312c 305d 2920 2320  rray([3,1,0]) # 
-0000daf0: 7261 6e64 6f6d 0d0a 2020 3e3e 3e20 2354  random..  >>> #T
-0000db00: 6869 7320 6973 2065 7175 6976 616c 656e  his is equivalen
-0000db10: 7420 746f 2062 7261 696e 7079 2e6d 6174  t to brainpy.mat
-0000db20: 682e 7261 6e64 6f6d 2e70 6572 6d75 7461  h.random.permuta
-0000db30: 7469 6f6e 286e 702e 6172 616e 6765 2835  tion(np.arange(5
-0000db40: 2929 5b3a 335d 0d0a 0d0a 2020 4765 6e65  ))[:3]....  Gene
-0000db50: 7261 7465 2061 206e 6f6e 2d75 6e69 666f  rate a non-unifo
-0000db60: 726d 2072 616e 646f 6d20 7361 6d70 6c65  rm random sample
-0000db70: 2066 726f 6d20 6e70 2e61 7261 6e67 6528   from np.arange(
-0000db80: 3529 206f 6620 7369 7a65 0d0a 2020 3320  5) of size..  3 
-0000db90: 7769 7468 6f75 7420 7265 706c 6163 656d  without replacem
-0000dba0: 656e 743a 0d0a 0d0a 2020 3e3e 3e20 6263  ent:....  >>> bc
-0000dbb0: 2e72 616e 646f 6d2e 6368 6f69 6365 2835  .random.choice(5
-0000dbc0: 2c20 332c 2072 6570 6c61 6365 3d46 616c  , 3, replace=Fal
-0000dbd0: 7365 2c20 703d 5b30 2e31 2c20 302c 2030  se, p=[0.1, 0, 0
-0000dbe0: 2e33 2c20 302e 362c 2030 5d29 0d0a 2020  .3, 0.6, 0])..  
-0000dbf0: 6172 7261 7928 5b32 2c20 332c 2030 5d29  array([2, 3, 0])
-0000dc00: 2023 2072 616e 646f 6d0d 0a0d 0a20 2041   # random....  A
-0000dc10: 6e79 206f 6620 7468 6520 6162 6f76 6520  ny of the above 
-0000dc20: 6361 6e20 6265 2072 6570 6561 7465 6420  can be repeated 
-0000dc30: 7769 7468 2061 6e20 6172 6269 7472 6172  with an arbitrar
-0000dc40: 7920 6172 7261 792d 6c69 6b65 0d0a 2020  y array-like..  
-0000dc50: 696e 7374 6561 6420 6f66 206a 7573 7420  instead of just 
-0000dc60: 696e 7465 6765 7273 2e20 466f 7220 696e  integers. For in
-0000dc70: 7374 616e 6365 3a0d 0a0d 0a20 203e 3e3e  stance:....  >>>
-0000dc80: 2061 615f 6d69 6c6e 655f 6172 7220 3d20   aa_milne_arr = 
-0000dc90: 5b27 706f 6f68 272c 2027 7261 6262 6974  ['pooh', 'rabbit
-0000dca0: 272c 2027 7069 676c 6574 272c 2027 4368  ', 'piglet', 'Ch
-0000dcb0: 7269 7374 6f70 6865 7227 5d0d 0a20 203e  ristopher']..  >
-0000dcc0: 3e3e 2062 632e 7261 6e64 6f6d 2e63 686f  >> bc.random.cho
-0000dcd0: 6963 6528 6161 5f6d 696c 6e65 5f61 7272  ice(aa_milne_arr
-0000dce0: 2c20 352c 2070 3d5b 302e 352c 2030 2e31  , 5, p=[0.5, 0.1
-0000dcf0: 2c20 302e 312c 2030 2e33 5d29 0d0a 2020  , 0.1, 0.3])..  
-0000dd00: 6172 7261 7928 5b27 706f 6f68 272c 2027  array(['pooh', '
-0000dd10: 706f 6f68 272c 2027 706f 6f68 272c 2027  pooh', 'pooh', '
-0000dd20: 4368 7269 7374 6f70 6865 7227 2c20 2770  Christopher', 'p
-0000dd30: 6967 6c65 7427 5d2c 2023 2072 616e 646f  iglet'], # rando
-0000dd40: 6d0d 0a20 2020 2020 2020 2064 7479 7065  m..        dtype
-0000dd50: 3d27 3c55 3131 2729 0d0a 2020 2222 220d  ='<U11')..  """.
-0000dd60: 0a20 2061 203d 2061 0d0a 2020 7265 7475  .  a = a..  retu
-0000dd70: 726e 2044 4546 4155 4c54 2e63 686f 6963  rn DEFAULT.choic
-0000dd80: 6528 613d 612c 2073 697a 653d 7369 7a65  e(a=a, size=size
-0000dd90: 2c20 7265 706c 6163 653d 7265 706c 6163  , replace=replac
-0000dda0: 652c 2070 3d70 2c20 6b65 793d 6b65 7929  e, p=p, key=key)
-0000ddb0: 0d0a 0d0a 0d0a 6465 6620 7065 726d 7574  ......def permut
-0000ddc0: 6174 696f 6e28 782c 0d0a 2020 2020 2020  ation(x,..      
-0000ddd0: 2020 2020 2020 2020 2020 6178 6973 3a20            axis: 
-0000dde0: 696e 7420 3d20 302c 0d0a 2020 2020 2020  int = 0,..      
-0000ddf0: 2020 2020 2020 2020 2020 696e 6465 7065            indepe
-0000de00: 6e64 656e 743a 2062 6f6f 6c20 3d20 4661  ndent: bool = Fa
-0000de10: 6c73 652c 0d0a 2020 2020 2020 2020 2020  lse,..          
-0000de20: 2020 2020 2020 6b65 793a 204f 7074 696f        key: Optio
-0000de30: 6e61 6c5b 5365 6564 4f72 4b65 795d 203d  nal[SeedOrKey] =
-0000de40: 204e 6f6e 6529 3a0d 0a20 2072 2222 220d   None):..  r""".
-0000de50: 0a20 2052 616e 646f 6d6c 7920 7065 726d  .  Randomly perm
-0000de60: 7574 6520 6120 7365 7175 656e 6365 2c20  ute a sequence, 
-0000de70: 6f72 2072 6574 7572 6e20 6120 7065 726d  or return a perm
-0000de80: 7574 6564 2072 616e 6765 2e0d 0a0d 0a20  uted range..... 
-0000de90: 2049 6620 6078 6020 6973 2061 206d 756c   If `x` is a mul
-0000dea0: 7469 2d64 696d 656e 7369 6f6e 616c 2061  ti-dimensional a
-0000deb0: 7272 6179 2c20 6974 2069 7320 6f6e 6c79  rray, it is only
-0000dec0: 2073 6875 6666 6c65 6420 616c 6f6e 6720   shuffled along 
-0000ded0: 6974 730d 0a20 2066 6972 7374 2069 6e64  its..  first ind
-0000dee0: 6578 2e0d 0a0d 0a20 2050 6172 616d 6574  ex.....  Paramet
-0000def0: 6572 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d  ers..  ---------
-0000df00: 2d0d 0a20 2078 203a 2069 6e74 206f 7220  -..  x : int or 
-0000df10: 6172 7261 795f 6c69 6b65 0d0a 2020 2020  array_like..    
-0000df20: 2020 4966 2060 7860 2069 7320 616e 2069    If `x` is an i
-0000df30: 6e74 6567 6572 2c20 7261 6e64 6f6d 6c79  nteger, randomly
-0000df40: 2070 6572 6d75 7465 2060 606e 702e 6172   permute ``np.ar
-0000df50: 616e 6765 2878 2960 602e 0d0a 2020 2020  ange(x)``...    
-0000df60: 2020 4966 2060 7860 2069 7320 616e 2061    If `x` is an a
-0000df70: 7272 6179 2c20 6d61 6b65 2061 2063 6f70  rray, make a cop
-0000df80: 7920 616e 6420 7368 7566 666c 6520 7468  y and shuffle th
-0000df90: 6520 656c 656d 656e 7473 0d0a 2020 2020  e elements..    
-0000dfa0: 2020 7261 6e64 6f6d 6c79 2e0d 0a20 2061    randomly...  a
-0000dfb0: 7869 7320 3a20 696e 742c 206f 7074 696f  xis : int, optio
-0000dfc0: 6e61 6c0d 0a20 2020 2020 2054 6865 2061  nal..      The a
-0000dfd0: 7869 7320 7768 6963 6820 6078 6020 6973  xis which `x` is
-0000dfe0: 2073 6875 6666 6c65 6420 616c 6f6e 672e   shuffled along.
-0000dff0: 2044 6566 6175 6c74 2069 7320 302e 0d0a   Default is 0...
-0000e000: 2020 696e 6465 7065 6e64 656e 7420 3a20    independent : 
-0000e010: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0d0a  bool, optional..
-0000e020: 2020 2020 2020 5768 6574 6865 7220 746f        Whether to
-0000e030: 2075 7365 2069 6e64 6570 656e 6465 6e74   use independent
-0000e040: 2072 616e 646f 6d20 7065 726d 7574 6174   random permutat
-0000e050: 696f 6e73 2066 6f72 2065 6163 680d 0a20  ions for each.. 
-0000e060: 2020 2020 2062 6174 6368 2e20 4966 2060       batch. If `
-0000e070: 6046 616c 7365 6060 2028 6465 6661 756c  `False`` (defaul
-0000e080: 7429 2c20 7468 6520 7361 6d65 2072 616e  t), the same ran
-0000e090: 646f 6d20 7065 726d 7574 6174 696f 6e20  dom permutation 
-0000e0a0: 6973 0d0a 2020 2020 2020 7573 6564 2066  is..      used f
-0000e0b0: 6f72 2061 6c6c 2062 6174 6368 6573 2e20  or all batches. 
-0000e0c0: 4966 2060 6054 7275 6560 602c 2065 6163  If ``True``, eac
-0000e0d0: 6820 6261 7463 6820 6973 2073 6875 6666  h batch is shuff
-0000e0e0: 6c65 640d 0a20 2020 2020 2069 6e64 6570  led..      indep
-0000e0f0: 656e 6465 6e74 6c79 2e20 4967 6e6f 7265  endently. Ignore
-0000e100: 6420 6966 2060 7860 2069 7320 616e 2069  d if `x` is an i
-0000e110: 6e74 6567 6572 2e0d 0a20 206b 6579 203a  nteger...  key :
-0000e120: 2050 524e 474b 6579 2c20 6f70 7469 6f6e   PRNGKey, option
-0000e130: 616c 0d0a 2020 2020 2020 5468 6520 6b65  al..      The ke
-0000e140: 7920 666f 7220 7468 6520 7261 6e64 6f6d  y for the random
-0000e150: 206e 756d 6265 7220 6765 6e65 7261 746f   number generato
-0000e160: 722e 2049 6620 6e6f 7420 6769 7665 6e2c  r. If not given,
-0000e170: 2074 6865 0d0a 2020 2020 2020 6465 6661   the..      defa
-0000e180: 756c 7420 7261 6e64 6f6d 206e 756d 6265  ult random numbe
-0000e190: 7220 6765 6e65 7261 746f 7220 6973 2075  r generator is u
-0000e1a0: 7365 642e 0d0a 0d0a 2020 5265 7475 726e  sed.....  Return
-0000e1b0: 730d 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020  s..  -------..  
-0000e1c0: 6f75 7420 3a20 6e64 6172 7261 790d 0a20  out : ndarray.. 
-0000e1d0: 2020 2020 2050 6572 6d75 7465 6420 7365       Permuted se
-0000e1e0: 7175 656e 6365 206f 7220 6172 7261 7920  quence or array 
-0000e1f0: 7261 6e67 652e 0d0a 0d0a 2020 4578 616d  range.....  Exam
-0000e200: 706c 6573 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ples..  --------
-0000e210: 0d0a 2020 3e3e 3e20 696d 706f 7274 2062  ..  >>> import b
-0000e220: 7261 696e 636f 7265 2061 7320 6263 0d0a  raincore as bc..
-0000e230: 2020 3e3e 3e20 6263 2e72 616e 646f 6d2e    >>> bc.random.
-0000e240: 7065 726d 7574 6174 696f 6e28 3130 290d  permutation(10).
-0000e250: 0a20 2061 7272 6179 285b 312c 2037 2c20  .  array([1, 7, 
-0000e260: 342c 2033 2c20 302c 2039 2c20 322c 2035  4, 3, 0, 9, 2, 5
-0000e270: 2c20 382c 2036 5d29 2023 2072 616e 646f  , 8, 6]) # rando
-0000e280: 6d0d 0a0d 0a20 203e 3e3e 2062 632e 7261  m....  >>> bc.ra
-0000e290: 6e64 6f6d 2e70 6572 6d75 7461 7469 6f6e  ndom.permutation
-0000e2a0: 285b 312c 2034 2c20 392c 2031 322c 2031  ([1, 4, 9, 12, 1
-0000e2b0: 355d 290d 0a20 2061 7272 6179 285b 3135  5])..  array([15
-0000e2c0: 2c20 2031 2c20 2039 2c20 2034 2c20 3132  ,  1,  9,  4, 12
-0000e2d0: 5d29 2023 2072 616e 646f 6d0d 0a0d 0a20  ]) # random.... 
-0000e2e0: 203e 3e3e 2061 7272 203d 206e 702e 6172   >>> arr = np.ar
-0000e2f0: 616e 6765 2839 292e 7265 7368 6170 6528  ange(9).reshape(
-0000e300: 2833 2c20 3329 290d 0a20 203e 3e3e 2062  (3, 3))..  >>> b
-0000e310: 632e 7261 6e64 6f6d 2e70 6572 6d75 7461  c.random.permuta
-0000e320: 7469 6f6e 2861 7272 290d 0a20 2061 7272  tion(arr)..  arr
-0000e330: 6179 285b 5b36 2c20 372c 2038 5d2c 2023  ay([[6, 7, 8], #
-0000e340: 2072 616e 646f 6d0d 0a20 2020 2020 2020   random..       
-0000e350: 2020 5b30 2c20 312c 2032 5d2c 0d0a 2020    [0, 1, 2],..  
-0000e360: 2020 2020 2020 205b 332c 2034 2c20 355d         [3, 4, 5]
-0000e370: 5d29 0d0a 2020 2222 220d 0a20 2072 6574  ])..  """..  ret
-0000e380: 7572 6e20 4445 4641 554c 542e 7065 726d  urn DEFAULT.perm
-0000e390: 7574 6174 696f 6e28 782c 2061 7869 733d  utation(x, axis=
-0000e3a0: 6178 6973 2c20 696e 6465 7065 6e64 656e  axis, independen
-0000e3b0: 743d 696e 6465 7065 6e64 656e 742c 206b  t=independent, k
-0000e3c0: 6579 3d6b 6579 290d 0a0d 0a0d 0a64 6566  ey=key)......def
-0000e3d0: 2073 6875 6666 6c65 2878 2c20 6178 6973   shuffle(x, axis
-0000e3e0: 3d30 2c20 6b65 793a 204f 7074 696f 6e61  =0, key: Optiona
-0000e3f0: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
-0000e400: 6f6e 6529 3a0d 0a20 2072 2222 220d 0a20  one):..  r""".. 
-0000e410: 204d 6f64 6966 7920 6120 7365 7175 656e   Modify a sequen
-0000e420: 6365 2069 6e2d 706c 6163 6520 6279 2073  ce in-place by s
-0000e430: 6875 6666 6c69 6e67 2069 7473 2063 6f6e  huffling its con
-0000e440: 7465 6e74 732e 0d0a 0d0a 2020 5468 6973  tents.....  This
-0000e450: 2066 756e 6374 696f 6e20 6f6e 6c79 2073   function only s
-0000e460: 6875 6666 6c65 7320 7468 6520 6172 7261  huffles the arra
-0000e470: 7920 616c 6f6e 6720 7468 6520 6669 7273  y along the firs
-0000e480: 7420 6178 6973 206f 6620 610d 0a20 206d  t axis of a..  m
-0000e490: 756c 7469 2d64 696d 656e 7369 6f6e 616c  ulti-dimensional
-0000e4a0: 2061 7272 6179 2e20 5468 6520 6f72 6465   array. The orde
-0000e4b0: 7220 6f66 2073 7562 2d61 7272 6179 7320  r of sub-arrays 
-0000e4c0: 6973 2063 6861 6e67 6564 2062 7574 0d0a  is changed but..
-0000e4d0: 2020 7468 6569 7220 636f 6e74 656e 7473    their contents
-0000e4e0: 2072 656d 6169 6e73 2074 6865 2073 616d   remains the sam
-0000e4f0: 652e 0d0a 0d0a 2020 5061 7261 6d65 7465  e.....  Paramete
-0000e500: 7273 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d  rs..  ----------
-0000e510: 0d0a 2020 7820 3a20 6e64 6172 7261 7920  ..  x : ndarray 
-0000e520: 6f72 204d 7574 6162 6c65 5365 7175 656e  or MutableSequen
-0000e530: 6365 0d0a 2020 2020 2020 5468 6520 6172  ce..      The ar
-0000e540: 7261 792c 206c 6973 7420 6f72 206d 7574  ray, list or mut
-0000e550: 6162 6c65 2073 6571 7565 6e63 6520 746f  able sequence to
-0000e560: 2062 6520 7368 7566 666c 6564 2e0d 0a20   be shuffled... 
-0000e570: 206b 6579 203a 2050 524e 474b 6579 2c20   key : PRNGKey, 
-0000e580: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-0000e590: 5468 6520 6b65 7920 666f 7220 7468 6520  The key for the 
-0000e5a0: 7261 6e64 6f6d 206e 756d 6265 7220 6765  random number ge
-0000e5b0: 6e65 7261 746f 722e 2049 6620 6e6f 7420  nerator. If not 
-0000e5c0: 6769 7665 6e2c 2074 6865 0d0a 2020 2020  given, the..    
-0000e5d0: 2020 6465 6661 756c 7420 7261 6e64 6f6d    default random
-0000e5e0: 206e 756d 6265 7220 6765 6e65 7261 746f   number generato
-0000e5f0: 7220 6973 2075 7365 642e 0d0a 0d0a 2020  r is used.....  
-0000e600: 5265 7475 726e 730d 0a20 202d 2d2d 2d2d  Returns..  -----
-0000e610: 2d2d 0d0a 2020 4e6f 6e65 0d0a 0d0a 2020  --..  None....  
-0000e620: 4578 616d 706c 6573 0d0a 2020 2d2d 2d2d  Examples..  ----
-0000e630: 2d2d 2d2d 0d0a 2020 3e3e 3e20 696d 706f  ----..  >>> impo
-0000e640: 7274 2062 7261 696e 636f 7265 2061 7320  rt braincore as 
-0000e650: 6263 0d0a 2020 3e3e 3e20 6172 7220 3d20  bc..  >>> arr = 
-0000e660: 6e70 2e61 7261 6e67 6528 3130 290d 0a20  np.arange(10).. 
-0000e670: 203e 3e3e 2062 632e 7261 6e64 6f6d 2e73   >>> bc.random.s
-0000e680: 6875 6666 6c65 2861 7272 290d 0a20 203e  huffle(arr)..  >
-0000e690: 3e3e 2061 7272 0d0a 2020 5b31 2037 2035  >> arr..  [1 7 5
-0000e6a0: 2032 2039 2034 2033 2036 2030 2038 5d20   2 9 4 3 6 0 8] 
-0000e6b0: 2320 7261 6e64 6f6d 0d0a 0d0a 2020 4d75  # random....  Mu
-0000e6c0: 6c74 692d 6469 6d65 6e73 696f 6e61 6c20  lti-dimensional 
-0000e6d0: 6172 7261 7973 2061 7265 206f 6e6c 7920  arrays are only 
-0000e6e0: 7368 7566 666c 6564 2061 6c6f 6e67 2074  shuffled along t
-0000e6f0: 6865 2066 6972 7374 2061 7869 733a 0d0a  he first axis:..
-0000e700: 0d0a 2020 3e3e 3e20 6172 7220 3d20 6e70  ..  >>> arr = np
-0000e710: 2e61 7261 6e67 6528 3929 2e72 6573 6861  .arange(9).resha
-0000e720: 7065 2828 332c 2033 2929 0d0a 2020 3e3e  pe((3, 3))..  >>
-0000e730: 3e20 6263 2e72 616e 646f 6d2e 7368 7566  > bc.random.shuf
-0000e740: 666c 6528 6172 7229 0d0a 2020 3e3e 3e20  fle(arr)..  >>> 
-0000e750: 6172 720d 0a20 2061 7272 6179 285b 5b33  arr..  array([[3
-0000e760: 2c20 342c 2035 5d2c 2023 2072 616e 646f  , 4, 5], # rando
-0000e770: 6d0d 0a20 2020 2020 2020 2020 5b36 2c20  m..         [6, 
-0000e780: 372c 2038 5d2c 0d0a 2020 2020 2020 2020  7, 8],..        
-0000e790: 205b 302c 2031 2c20 325d 5d29 0d0a 2020   [0, 1, 2]])..  
-0000e7a0: 2222 220d 0a20 2044 4546 4155 4c54 2e73  """..  DEFAULT.s
-0000e7b0: 6875 6666 6c65 2878 2c20 6178 6973 2c20  huffle(x, axis, 
-0000e7c0: 6b65 793d 6b65 7929 0d0a 0d0a 0d0a 6465  key=key)......de
-0000e7d0: 6620 6265 7461 2861 2c20 622c 2073 697a  f beta(a, b, siz
-0000e7e0: 653a 204f 7074 696f 6e61 6c5b 5369 7a65  e: Optional[Size
-0000e7f0: 5d20 3d20 4e6f 6e65 2c20 6b65 793a 204f  ] = None, key: O
-0000e800: 7074 696f 6e61 6c5b 5365 6564 4f72 4b65  ptional[SeedOrKe
-0000e810: 795d 203d 204e 6f6e 652c 2064 7479 7065  y] = None, dtype
-0000e820: 3a20 4454 7970 654c 696b 6520 3d20 4e6f  : DTypeLike = No
-0000e830: 6e65 293a 0d0a 2020 7222 2222 0d0a 2020  ne):..  r"""..  
-0000e840: 4472 6177 2073 616d 706c 6573 2066 726f  Draw samples fro
-0000e850: 6d20 6120 4265 7461 2064 6973 7472 6962  m a Beta distrib
-0000e860: 7574 696f 6e2e 0d0a 0d0a 2020 5468 6520  ution.....  The 
-0000e870: 4265 7461 2064 6973 7472 6962 7574 696f  Beta distributio
-0000e880: 6e20 6973 2061 2073 7065 6369 616c 2063  n is a special c
-0000e890: 6173 6520 6f66 2074 6865 2044 6972 6963  ase of the Diric
-0000e8a0: 686c 6574 2064 6973 7472 6962 7574 696f  hlet distributio
-0000e8b0: 6e2c 0d0a 2020 616e 6420 6973 2072 656c  n,..  and is rel
-0000e8c0: 6174 6564 2074 6f20 7468 6520 4761 6d6d  ated to the Gamm
-0000e8d0: 6120 6469 7374 7269 6275 7469 6f6e 2e20  a distribution. 
-0000e8e0: 2049 7420 6861 7320 7468 6520 7072 6f62   It has the prob
-0000e8f0: 6162 696c 6974 790d 0a20 2064 6973 7472  ability..  distr
-0000e900: 6962 7574 696f 6e20 6675 6e63 7469 6f6e  ibution function
-0000e910: 0d0a 0d0a 2020 2e2e 206d 6174 683a 3a20  ....  .. math:: 
-0000e920: 6628 783b 2061 2c62 2920 3d20 5c66 7261  f(x; a,b) = \fra
-0000e930: 637b 317d 7b42 285c 616c 7068 612c 205c  c{1}{B(\alpha, \
-0000e940: 6265 7461 297d 2078 5e7b 5c61 6c70 6861  beta)} x^{\alpha
-0000e950: 202d 2031 7d0d 0a20 2020 2020 2020 2020   - 1}..         
-0000e960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e980: 2020 2020 2020 2020 2020 2831 202d 2078            (1 - x
-0000e990: 295e 7b5c 6265 7461 202d 2031 7d2c 0d0a  )^{\beta - 1},..
-0000e9a0: 0d0a 2020 7768 6572 6520 7468 6520 6e6f  ..  where the no
-0000e9b0: 726d 616c 697a 6174 696f 6e2c 2042 2c20  rmalization, B, 
-0000e9c0: 6973 2074 6865 2062 6574 6120 6675 6e63  is the beta func
-0000e9d0: 7469 6f6e 2c0d 0a0d 0a20 202e 2e20 6d61  tion,....  .. ma
-0000e9e0: 7468 3a3a 2042 285c 616c 7068 612c 205c  th:: B(\alpha, \
-0000e9f0: 6265 7461 2920 3d20 5c69 6e74 5f30 5e31  beta) = \int_0^1
-0000ea00: 2074 5e7b 5c61 6c70 6861 202d 2031 7d0d   t^{\alpha - 1}.
-0000ea10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ea20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea30: 2831 202d 2074 295e 7b5c 6265 7461 202d  (1 - t)^{\beta -
-0000ea40: 2031 7d20 6474 2e0d 0a0d 0a20 2049 7420   1} dt.....  It 
-0000ea50: 6973 206f 6674 656e 2073 6565 6e20 696e  is often seen in
-0000ea60: 2042 6179 6573 6961 6e20 696e 6665 7265   Bayesian infere
-0000ea70: 6e63 6520 616e 6420 6f72 6465 7220 7374  nce and order st
-0000ea80: 6174 6973 7469 6373 2e0d 0a0d 0a20 2050  atistics.....  P
-0000ea90: 6172 616d 6574 6572 730d 0a20 202d 2d2d  arameters..  ---
-0000eaa0: 2d2d 2d2d 2d2d 2d0d 0a20 2061 203a 2066  -------..  a : f
-0000eab0: 6c6f 6174 206f 7220 6172 7261 795f 6c69  loat or array_li
-0000eac0: 6b65 206f 6620 666c 6f61 7473 0d0a 2020  ke of floats..  
-0000ead0: 2020 2020 416c 7068 612c 2070 6f73 6974      Alpha, posit
-0000eae0: 6976 6520 283e 3029 2e0d 0a20 2062 203a  ive (>0)...  b :
-0000eaf0: 2066 6c6f 6174 206f 7220 6172 7261 795f   float or array_
-0000eb00: 6c69 6b65 206f 6620 666c 6f61 7473 0d0a  like of floats..
-0000eb10: 2020 2020 2020 4265 7461 2c20 706f 7369        Beta, posi
-0000eb20: 7469 7665 2028 3e30 292e 0d0a 2020 7369  tive (>0)...  si
-0000eb30: 7a65 203a 2069 6e74 206f 7220 7475 706c  ze : int or tupl
-0000eb40: 6520 6f66 2069 6e74 732c 206f 7074 696f  e of ints, optio
-0000eb50: 6e61 6c0d 0a20 2020 2020 204f 7574 7075  nal..      Outpu
-0000eb60: 7420 7368 6170 652e 2020 4966 2074 6865  t shape.  If the
-0000eb70: 2067 6976 656e 2073 6861 7065 2069 732c   given shape is,
-0000eb80: 2065 2e67 2e2c 2060 6028 6d2c 206e 2c20   e.g., ``(m, n, 
-0000eb90: 6b29 6060 2c20 7468 656e 0d0a 2020 2020  k)``, then..    
-0000eba0: 2020 6060 6d20 2a20 6e20 2a20 6b60 6020    ``m * n * k`` 
-0000ebb0: 7361 6d70 6c65 7320 6172 6520 6472 6177  samples are draw
-0000ebc0: 6e2e 2020 4966 2073 697a 6520 6973 2060  n.  If size is `
-0000ebd0: 604e 6f6e 6560 6020 2864 6566 6175 6c74  `None`` (default
-0000ebe0: 292c 0d0a 2020 2020 2020 6120 7369 6e67  ),..      a sing
-0000ebf0: 6c65 2076 616c 7565 2069 7320 7265 7475  le value is retu
-0000ec00: 726e 6564 2069 6620 6060 6160 6020 616e  rned if ``a`` an
-0000ec10: 6420 6060 6260 6020 6172 6520 626f 7468  d ``b`` are both
-0000ec20: 2073 6361 6c61 7273 2e0d 0a20 2020 2020   scalars...     
-0000ec30: 204f 7468 6572 7769 7365 2c20 6060 6e70   Otherwise, ``np
-0000ec40: 2e62 726f 6164 6361 7374 2861 2c20 6229  .broadcast(a, b)
-0000ec50: 2e73 697a 6560 6020 7361 6d70 6c65 7320  .size`` samples 
-0000ec60: 6172 6520 6472 6177 6e2e 0d0a 2020 6b65  are drawn...  ke
-0000ec70: 7920 3a20 5052 4e47 4b65 792c 206f 7074  y : PRNGKey, opt
-0000ec80: 696f 6e61 6c0d 0a20 2020 2020 2054 6865  ional..      The
-0000ec90: 206b 6579 2066 6f72 2074 6865 2072 616e   key for the ran
-0000eca0: 646f 6d20 6e75 6d62 6572 2067 656e 6572  dom number gener
-0000ecb0: 6174 6f72 2e20 4966 206e 6f74 2067 6976  ator. If not giv
-0000ecc0: 656e 2c20 7468 650d 0a20 2020 2020 2064  en, the..      d
-0000ecd0: 6566 6175 6c74 2072 616e 646f 6d20 6e75  efault random nu
-0000ece0: 6d62 6572 2067 656e 6572 6174 6f72 2069  mber generator i
-0000ecf0: 7320 7573 6564 2e0d 0a0d 0a20 2052 6574  s used.....  Ret
-0000ed00: 7572 6e73 0d0a 2020 2d2d 2d2d 2d2d 2d0d  urns..  -------.
-0000ed10: 0a20 206f 7574 203a 206e 6461 7272 6179  .  out : ndarray
-0000ed20: 206f 7220 7363 616c 6172 0d0a 2020 2020   or scalar..    
-0000ed30: 2020 4472 6177 6e20 7361 6d70 6c65 7320    Drawn samples 
-0000ed40: 6672 6f6d 2074 6865 2070 6172 616d 6574  from the paramet
-0000ed50: 6572 697a 6564 2062 6574 6120 6469 7374  erized beta dist
-0000ed60: 7269 6275 7469 6f6e 2e0d 0a20 2022 2222  ribution...  """
-0000ed70: 0d0a 2020 7265 7475 726e 2044 4546 4155  ..  return DEFAU
-0000ed80: 4c54 2e62 6574 6128 612c 2062 2c20 7369  LT.beta(a, b, si
-0000ed90: 7a65 3d73 697a 652c 206b 6579 3d6b 6579  ze=size, key=key
-0000eda0: 2c20 6474 7970 653d 6474 7970 6529 0d0a  , dtype=dtype)..
-0000edb0: 0d0a 0d0a 6465 6620 6578 706f 6e65 6e74  ....def exponent
-0000edc0: 6961 6c28 7363 616c 653d 4e6f 6e65 2c20  ial(scale=None, 
-0000edd0: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b53  size: Optional[S
-0000ede0: 697a 655d 203d 204e 6f6e 652c 0d0a 2020  ize] = None,..  
-0000edf0: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
-0000ee00: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
-0000ee10: 4f72 4b65 795d 203d 204e 6f6e 652c 0d0a  OrKey] = None,..
-0000ee20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ee30: 6474 7970 653a 2044 5479 7065 4c69 6b65  dtype: DTypeLike
-0000ee40: 203d 204e 6f6e 6529 3a0d 0a20 2072 2222   = None):..  r""
-0000ee50: 220d 0a20 2044 7261 7720 7361 6d70 6c65  "..  Draw sample
-0000ee60: 7320 6672 6f6d 2061 6e20 6578 706f 6e65  s from an expone
-0000ee70: 6e74 6961 6c20 6469 7374 7269 6275 7469  ntial distributi
-0000ee80: 6f6e 2e0d 0a0d 0a20 2049 7473 2070 726f  on.....  Its pro
-0000ee90: 6261 6269 6c69 7479 2064 656e 7369 7479  bability density
-0000eea0: 2066 756e 6374 696f 6e20 6973 0d0a 0d0a   function is....
-0000eeb0: 2020 2e2e 206d 6174 683a 3a20 6628 783b    .. math:: f(x;
-0000eec0: 205c 6672 6163 7b31 7d7b 5c62 6574 617d   \frac{1}{\beta}
-0000eed0: 2920 3d20 5c66 7261 637b 317d 7b5c 6265  ) = \frac{1}{\be
-0000eee0: 7461 7d20 5c65 7870 282d 5c66 7261 637b  ta} \exp(-\frac{
-0000eef0: 787d 7b5c 6265 7461 7d29 2c0d 0a0d 0a20  x}{\beta}),.... 
-0000ef00: 2066 6f72 2060 6078 203e 2030 6060 2061   for ``x > 0`` a
-0000ef10: 6e64 2030 2065 6c73 6577 6865 7265 2e20  nd 0 elsewhere. 
-0000ef20: 3a6d 6174 683a 605c 6265 7461 6020 6973  :math:`\beta` is
-0000ef30: 2074 6865 2073 6361 6c65 2070 6172 616d   the scale param
-0000ef40: 6574 6572 2c0d 0a20 2077 6869 6368 2069  eter,..  which i
-0000ef50: 7320 7468 6520 696e 7665 7273 6520 6f66  s the inverse of
-0000ef60: 2074 6865 2072 6174 6520 7061 7261 6d65   the rate parame
-0000ef70: 7465 7220 3a6d 6174 683a 605c 6c61 6d62  ter :math:`\lamb
-0000ef80: 6461 203d 2031 2f5c 6265 7461 602e 0d0a  da = 1/\beta`...
-0000ef90: 2020 5468 6520 7261 7465 2070 6172 616d    The rate param
-0000efa0: 6574 6572 2069 7320 616e 2061 6c74 6572  eter is an alter
-0000efb0: 6e61 7469 7665 2c20 7769 6465 6c79 2075  native, widely u
-0000efc0: 7365 6420 7061 7261 6d65 7465 7269 7a61  sed parameteriza
-0000efd0: 7469 6f6e 0d0a 2020 6f66 2074 6865 2065  tion..  of the e
-0000efe0: 7870 6f6e 656e 7469 616c 2064 6973 7472  xponential distr
-0000eff0: 6962 7574 696f 6e20 5b33 5d5f 2e0d 0a0d  ibution [3]_....
-0000f000: 0a20 2054 6865 2065 7870 6f6e 656e 7469  .  The exponenti
-0000f010: 616c 2064 6973 7472 6962 7574 696f 6e20  al distribution 
-0000f020: 6973 2061 2063 6f6e 7469 6e75 6f75 7320  is a continuous 
-0000f030: 616e 616c 6f67 7565 206f 6620 7468 650d  analogue of the.
-0000f040: 0a20 2067 656f 6d65 7472 6963 2064 6973  .  geometric dis
-0000f050: 7472 6962 7574 696f 6e2e 2020 4974 2064  tribution.  It d
-0000f060: 6573 6372 6962 6573 206d 616e 7920 636f  escribes many co
-0000f070: 6d6d 6f6e 2073 6974 7561 7469 6f6e 732c  mmon situations,
-0000f080: 2073 7563 6820 6173 0d0a 2020 7468 6520   such as..  the 
-0000f090: 7369 7a65 206f 6620 7261 696e 6472 6f70  size of raindrop
-0000f0a0: 7320 6d65 6173 7572 6564 206f 7665 7220  s measured over 
-0000f0b0: 6d61 6e79 2072 6169 6e73 746f 726d 7320  many rainstorms 
-0000f0c0: 5b31 5d5f 2c20 6f72 2074 6865 2074 696d  [1]_, or the tim
-0000f0d0: 650d 0a20 2062 6574 7765 656e 2070 6167  e..  between pag
-0000f0e0: 6520 7265 7175 6573 7473 2074 6f20 5769  e requests to Wi
-0000f0f0: 6b69 7065 6469 6120 5b32 5d5f 2e0d 0a0d  kipedia [2]_....
-0000f100: 0a20 2050 6172 616d 6574 6572 730d 0a20  .  Parameters.. 
-0000f110: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2073   ----------..  s
-0000f120: 6361 6c65 203a 2066 6c6f 6174 206f 7220  cale : float or 
-0000f130: 6172 7261 795f 6c69 6b65 206f 6620 666c  array_like of fl
-0000f140: 6f61 7473 0d0a 2020 2020 2020 5468 6520  oats..      The 
-0000f150: 7363 616c 6520 7061 7261 6d65 7465 722c  scale parameter,
-0000f160: 203a 6d61 7468 3a60 5c62 6574 6120 3d20   :math:`\beta = 
-0000f170: 312f 5c6c 616d 6264 6160 2e20 4d75 7374  1/\lambda`. Must
-0000f180: 2062 650d 0a20 2020 2020 206e 6f6e 2d6e   be..      non-n
-0000f190: 6567 6174 6976 652e 0d0a 2020 7369 7a65  egative...  size
-0000f1a0: 203a 2069 6e74 206f 7220 7475 706c 6520   : int or tuple 
-0000f1b0: 6f66 2069 6e74 732c 206f 7074 696f 6e61  of ints, optiona
-0000f1c0: 6c0d 0a20 2020 2020 204f 7574 7075 7420  l..      Output 
-0000f1d0: 7368 6170 652e 2020 4966 2074 6865 2067  shape.  If the g
-0000f1e0: 6976 656e 2073 6861 7065 2069 732c 2065  iven shape is, e
-0000f1f0: 2e67 2e2c 2060 6028 6d2c 206e 2c20 6b29  .g., ``(m, n, k)
-0000f200: 6060 2c20 7468 656e 0d0a 2020 2020 2020  ``, then..      
-0000f210: 6060 6d20 2a20 6e20 2a20 6b60 6020 7361  ``m * n * k`` sa
-0000f220: 6d70 6c65 7320 6172 6520 6472 6177 6e2e  mples are drawn.
-0000f230: 2020 4966 2073 697a 6520 6973 2060 604e    If size is ``N
-0000f240: 6f6e 6560 6020 2864 6566 6175 6c74 292c  one`` (default),
-0000f250: 0d0a 2020 2020 2020 6120 7369 6e67 6c65  ..      a single
-0000f260: 2076 616c 7565 2069 7320 7265 7475 726e   value is return
-0000f270: 6564 2069 6620 6060 7363 616c 6560 6020  ed if ``scale`` 
-0000f280: 6973 2061 2073 6361 6c61 722e 2020 4f74  is a scalar.  Ot
-0000f290: 6865 7277 6973 652c 0d0a 2020 2020 2020  herwise,..      
-0000f2a0: 6060 6e70 2e61 7272 6179 2873 6361 6c65  ``np.array(scale
-0000f2b0: 292e 7369 7a65 6060 2073 616d 706c 6573  ).size`` samples
-0000f2c0: 2061 7265 2064 7261 776e 2e0d 0a20 206b   are drawn...  k
-0000f2d0: 6579 203a 2050 524e 474b 6579 2c20 6f70  ey : PRNGKey, op
-0000f2e0: 7469 6f6e 616c 0d0a 2020 2020 2020 5468  tional..      Th
-0000f2f0: 6520 6b65 7920 666f 7220 7468 6520 7261  e key for the ra
-0000f300: 6e64 6f6d 206e 756d 6265 7220 6765 6e65  ndom number gene
-0000f310: 7261 746f 722e 2049 6620 6e6f 7420 6769  rator. If not gi
-0000f320: 7665 6e2c 2074 6865 0d0a 2020 2020 2020  ven, the..      
-0000f330: 6465 6661 756c 7420 7261 6e64 6f6d 206e  default random n
-0000f340: 756d 6265 7220 6765 6e65 7261 746f 7220  umber generator 
-0000f350: 6973 2075 7365 642e 0d0a 0d0a 2020 5265  is used.....  Re
-0000f360: 7475 726e 730d 0a20 202d 2d2d 2d2d 2d2d  turns..  -------
-0000f370: 0d0a 2020 6f75 7420 3a20 6e64 6172 7261  ..  out : ndarra
-0000f380: 7920 6f72 2073 6361 6c61 720d 0a20 2020  y or scalar..   
-0000f390: 2020 2044 7261 776e 2073 616d 706c 6573     Drawn samples
-0000f3a0: 2066 726f 6d20 7468 6520 7061 7261 6d65   from the parame
-0000f3b0: 7465 7269 7a65 6420 6578 706f 6e65 6e74  terized exponent
-0000f3c0: 6961 6c20 6469 7374 7269 6275 7469 6f6e  ial distribution
-0000f3d0: 2e0d 0a0d 0a20 2052 6566 6572 656e 6365  .....  Reference
-0000f3e0: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
-0000f3f0: 0a20 202e 2e20 5b31 5d20 5065 7974 6f6e  .  .. [1] Peyton
-0000f400: 205a 2e20 5065 6562 6c65 7320 4a72 2e2c   Z. Peebles Jr.,
-0000f410: 2022 5072 6f62 6162 696c 6974 792c 2052   "Probability, R
-0000f420: 616e 646f 6d20 5661 7269 6162 6c65 7320  andom Variables 
-0000f430: 616e 640d 0a20 2020 2020 2020 2020 5261  and..         Ra
-0000f440: 6e64 6f6d 2053 6967 6e61 6c20 5072 696e  ndom Signal Prin
-0000f450: 6369 706c 6573 222c 2034 7468 2065 642c  ciples", 4th ed,
-0000f460: 2032 3030 312c 2070 2e20 3537 2e0d 0a20   2001, p. 57... 
-0000f470: 202e 2e20 5b32 5d20 5769 6b69 7065 6469   .. [2] Wikipedi
-0000f480: 612c 2022 506f 6973 736f 6e20 7072 6f63  a, "Poisson proc
-0000f490: 6573 7322 2c0d 0a20 2020 2020 2020 2020  ess",..         
-0000f4a0: 6874 7470 733a 2f2f 656e 2e77 696b 6970  https://en.wikip
-0000f4b0: 6564 6961 2e6f 7267 2f77 696b 692f 506f  edia.org/wiki/Po
-0000f4c0: 6973 736f 6e5f 7072 6f63 6573 730d 0a20  isson_process.. 
-0000f4d0: 202e 2e20 5b33 5d20 5769 6b69 7065 6469   .. [3] Wikipedi
-0000f4e0: 612c 2022 4578 706f 6e65 6e74 6961 6c20  a, "Exponential 
-0000f4f0: 6469 7374 7269 6275 7469 6f6e 222c 0d0a  distribution",..
-0000f500: 2020 2020 2020 2020 2068 7474 7073 3a2f           https:/
-0000f510: 2f65 6e2e 7769 6b69 7065 6469 612e 6f72  /en.wikipedia.or
-0000f520: 672f 7769 6b69 2f45 7870 6f6e 656e 7469  g/wiki/Exponenti
-0000f530: 616c 5f64 6973 7472 6962 7574 696f 6e0d  al_distribution.
-0000f540: 0a20 2022 2222 0d0a 2020 7265 7475 726e  .  """..  return
-0000f550: 2044 4546 4155 4c54 2e65 7870 6f6e 656e   DEFAULT.exponen
-0000f560: 7469 616c 2873 6361 6c65 2c20 7369 7a65  tial(scale, size
-0000f570: 2c20 6b65 793d 6b65 792c 2064 7479 7065  , key=key, dtype
-0000f580: 3d64 7479 7065 290d 0a0d 0a0d 0a64 6566  =dtype)......def
-0000f590: 2067 616d 6d61 2873 6861 7065 2c20 7363   gamma(shape, sc
-0000f5a0: 616c 653d 4e6f 6e65 2c20 7369 7a65 3a20  ale=None, size: 
-0000f5b0: 4f70 7469 6f6e 616c 5b53 697a 655d 203d  Optional[Size] =
-0000f5c0: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
-0000f5d0: 2020 6b65 793a 204f 7074 696f 6e61 6c5b    key: Optional[
-0000f5e0: 5365 6564 4f72 4b65 795d 203d 204e 6f6e  SeedOrKey] = Non
-0000f5f0: 652c 0d0a 2020 2020 2020 2020 2020 6474  e,..          dt
-0000f600: 7970 653a 2044 5479 7065 4c69 6b65 203d  ype: DTypeLike =
-0000f610: 204e 6f6e 6529 3a0d 0a20 2072 2222 220d   None):..  r""".
-0000f620: 0a20 2044 7261 7720 7361 6d70 6c65 7320  .  Draw samples 
-0000f630: 6672 6f6d 2061 2047 616d 6d61 2064 6973  from a Gamma dis
-0000f640: 7472 6962 7574 696f 6e2e 0d0a 0d0a 2020  tribution.....  
-0000f650: 5361 6d70 6c65 7320 6172 6520 6472 6177  Samples are draw
-0000f660: 6e20 6672 6f6d 2061 2047 616d 6d61 2064  n from a Gamma d
-0000f670: 6973 7472 6962 7574 696f 6e20 7769 7468  istribution with
-0000f680: 2073 7065 6369 6669 6564 2070 6172 616d   specified param
-0000f690: 6574 6572 732c 0d0a 2020 6073 6861 7065  eters,..  `shape
-0000f6a0: 6020 2873 6f6d 6574 696d 6573 2064 6573  ` (sometimes des
-0000f6b0: 6967 6e61 7465 6420 226b 2229 2061 6e64  ignated "k") and
-0000f6c0: 2060 7363 616c 6560 2028 736f 6d65 7469   `scale` (someti
-0000f6d0: 6d65 7320 6465 7369 676e 6174 6564 0d0a  mes designated..
-0000f6e0: 2020 2274 6865 7461 2229 2c20 7768 6572    "theta"), wher
-0000f6f0: 6520 626f 7468 2070 6172 616d 6574 6572  e both parameter
-0000f700: 7320 6172 6520 3e20 302e 0d0a 0d0a 2020  s are > 0.....  
-0000f710: 5061 7261 6d65 7465 7273 0d0a 2020 2d2d  Parameters..  --
-0000f720: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 7368 6170  --------..  shap
-0000f730: 6520 3a20 666c 6f61 7420 6f72 2061 7272  e : float or arr
-0000f740: 6179 5f6c 696b 6520 6f66 2066 6c6f 6174  ay_like of float
-0000f750: 730d 0a20 2020 2020 2054 6865 2073 6861  s..      The sha
-0000f760: 7065 206f 6620 7468 6520 6761 6d6d 6120  pe of the gamma 
-0000f770: 6469 7374 7269 6275 7469 6f6e 2e20 4d75  distribution. Mu
-0000f780: 7374 2062 6520 6e6f 6e2d 6e65 6761 7469  st be non-negati
-0000f790: 7665 2e0d 0a20 2073 6361 6c65 203a 2066  ve...  scale : f
-0000f7a0: 6c6f 6174 206f 7220 6172 7261 795f 6c69  loat or array_li
-0000f7b0: 6b65 206f 6620 666c 6f61 7473 2c20 6f70  ke of floats, op
-0000f7c0: 7469 6f6e 616c 0d0a 2020 2020 2020 5468  tional..      Th
-0000f7d0: 6520 7363 616c 6520 6f66 2074 6865 2067  e scale of the g
-0000f7e0: 616d 6d61 2064 6973 7472 6962 7574 696f  amma distributio
-0000f7f0: 6e2e 204d 7573 7420 6265 206e 6f6e 2d6e  n. Must be non-n
-0000f800: 6567 6174 6976 652e 0d0a 2020 2020 2020  egative...      
-0000f810: 4465 6661 756c 7420 6973 2065 7175 616c  Default is equal
-0000f820: 2074 6f20 312e 0d0a 2020 7369 7a65 203a   to 1...  size :
-0000f830: 2069 6e74 206f 7220 7475 706c 6520 6f66   int or tuple of
-0000f840: 2069 6e74 732c 206f 7074 696f 6e61 6c0d   ints, optional.
-0000f850: 0a20 2020 2020 204f 7574 7075 7420 7368  .      Output sh
-0000f860: 6170 652e 2020 4966 2074 6865 2067 6976  ape.  If the giv
-0000f870: 656e 2073 6861 7065 2069 732c 2065 2e67  en shape is, e.g
-0000f880: 2e2c 2060 6028 6d2c 206e 2c20 6b29 6060  ., ``(m, n, k)``
-0000f890: 2c20 7468 656e 0d0a 2020 2020 2020 6060  , then..      ``
-0000f8a0: 6d20 2a20 6e20 2a20 6b60 6020 7361 6d70  m * n * k`` samp
-0000f8b0: 6c65 7320 6172 6520 6472 6177 6e2e 2020  les are drawn.  
-0000f8c0: 4966 2073 697a 6520 6973 2060 604e 6f6e  If size is ``Non
-0000f8d0: 6560 6020 2864 6566 6175 6c74 292c 0d0a  e`` (default),..
-0000f8e0: 2020 2020 2020 6120 7369 6e67 6c65 2076        a single v
-0000f8f0: 616c 7565 2069 7320 7265 7475 726e 6564  alue is returned
-0000f900: 2069 6620 6060 7368 6170 6560 6020 616e   if ``shape`` an
-0000f910: 6420 6060 7363 616c 6560 6020 6172 6520  d ``scale`` are 
-0000f920: 626f 7468 2073 6361 6c61 7273 2e0d 0a20  both scalars... 
-0000f930: 2020 2020 204f 7468 6572 7769 7365 2c20       Otherwise, 
-0000f940: 6060 6e70 2e62 726f 6164 6361 7374 2873  ``np.broadcast(s
-0000f950: 6861 7065 2c20 7363 616c 6529 2e73 697a  hape, scale).siz
-0000f960: 6560 6020 7361 6d70 6c65 7320 6172 6520  e`` samples are 
-0000f970: 6472 6177 6e2e 0d0a 2020 6b65 7920 3a20  drawn...  key : 
-0000f980: 5052 4e47 4b65 792c 206f 7074 696f 6e61  PRNGKey, optiona
-0000f990: 6c0d 0a20 2020 2020 2054 6865 206b 6579  l..      The key
-0000f9a0: 2066 6f72 2074 6865 2072 616e 646f 6d20   for the random 
-0000f9b0: 6e75 6d62 6572 2067 656e 6572 6174 6f72  number generator
-0000f9c0: 2e20 4966 206e 6f74 2067 6976 656e 2c20  . If not given, 
-0000f9d0: 7468 650d 0a20 2020 2020 2064 6566 6175  the..      defau
-0000f9e0: 6c74 2072 616e 646f 6d20 6e75 6d62 6572  lt random number
-0000f9f0: 2067 656e 6572 6174 6f72 2069 7320 7573   generator is us
-0000fa00: 6564 2e0d 0a0d 0a20 2052 6574 7572 6e73  ed.....  Returns
-0000fa10: 0d0a 2020 2d2d 2d2d 2d2d 2d0d 0a20 206f  ..  -------..  o
-0000fa20: 7574 203a 206e 6461 7272 6179 206f 7220  ut : ndarray or 
-0000fa30: 7363 616c 6172 0d0a 2020 2020 2020 4472  scalar..      Dr
-0000fa40: 6177 6e20 7361 6d70 6c65 7320 6672 6f6d  awn samples from
-0000fa50: 2074 6865 2070 6172 616d 6574 6572 697a   the parameteriz
-0000fa60: 6564 2067 616d 6d61 2064 6973 7472 6962  ed gamma distrib
-0000fa70: 7574 696f 6e2e 0d0a 0d0a 0d0a 2020 4e6f  ution.......  No
-0000fa80: 7465 730d 0a20 202d 2d2d 2d2d 0d0a 2020  tes..  -----..  
-0000fa90: 5468 6520 7072 6f62 6162 696c 6974 7920  The probability 
-0000faa0: 6465 6e73 6974 7920 666f 7220 7468 6520  density for the 
-0000fab0: 4761 6d6d 6120 6469 7374 7269 6275 7469  Gamma distributi
-0000fac0: 6f6e 2069 730d 0a0d 0a20 202e 2e20 6d61  on is....  .. ma
-0000fad0: 7468 3a3a 2070 2878 2920 3d20 785e 7b6b  th:: p(x) = x^{k
-0000fae0: 2d31 7d5c 6672 6163 7b65 5e7b 2d78 2f5c  -1}\frac{e^{-x/\
-0000faf0: 7468 6574 617d 7d7b 5c74 6865 7461 5e6b  theta}}{\theta^k
-0000fb00: 5c47 616d 6d61 286b 297d 2c0d 0a0d 0a20  \Gamma(k)},.... 
-0000fb10: 2077 6865 7265 203a 6d61 7468 3a60 6b60   where :math:`k`
-0000fb20: 2069 7320 7468 6520 7368 6170 6520 616e   is the shape an
-0000fb30: 6420 3a6d 6174 683a 605c 7468 6574 6160  d :math:`\theta`
-0000fb40: 2074 6865 2073 6361 6c65 2c0d 0a20 2061   the scale,..  a
-0000fb50: 6e64 203a 6d61 7468 3a60 5c47 616d 6d61  nd :math:`\Gamma
-0000fb60: 6020 6973 2074 6865 2047 616d 6d61 2066  ` is the Gamma f
-0000fb70: 756e 6374 696f 6e2e 0d0a 0d0a 2020 5468  unction.....  Th
-0000fb80: 6520 4761 6d6d 6120 6469 7374 7269 6275  e Gamma distribu
-0000fb90: 7469 6f6e 2069 7320 6f66 7465 6e20 7573  tion is often us
-0000fba0: 6564 2074 6f20 6d6f 6465 6c20 7468 6520  ed to model the 
-0000fbb0: 7469 6d65 7320 746f 2066 6169 6c75 7265  times to failure
-0000fbc0: 206f 660d 0a20 2065 6c65 6374 726f 6e69   of..  electroni
-0000fbd0: 6320 636f 6d70 6f6e 656e 7473 2c20 616e  c components, an
-0000fbe0: 6420 6172 6973 6573 206e 6174 7572 616c  d arises natural
-0000fbf0: 6c79 2069 6e20 7072 6f63 6573 7365 7320  ly in processes 
-0000fc00: 666f 7220 7768 6963 6820 7468 650d 0a20  for which the.. 
-0000fc10: 2077 6169 7469 6e67 2074 696d 6573 2062   waiting times b
-0000fc20: 6574 7765 656e 2050 6f69 7373 6f6e 2064  etween Poisson d
-0000fc30: 6973 7472 6962 7574 6564 2065 7665 6e74  istributed event
-0000fc40: 7320 6172 6520 7265 6c65 7661 6e74 2e0d  s are relevant..
-0000fc50: 0a0d 0a20 2052 6566 6572 656e 6365 730d  ...  References.
-0000fc60: 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  .  ----------.. 
-0000fc70: 202e 2e20 5b31 5d20 5765 6973 7374 6569   .. [1] Weisstei
-0000fc80: 6e2c 2045 7269 6320 572e 2022 4761 6d6d  n, Eric W. "Gamm
-0000fc90: 6120 4469 7374 7269 6275 7469 6f6e 2e22  a Distribution."
-0000fca0: 2046 726f 6d20 4d61 7468 576f 726c 642d   From MathWorld-
-0000fcb0: 2d41 0d0a 2020 2020 2020 2020 2057 6f6c  -A..         Wol
-0000fcc0: 6672 616d 2057 6562 2052 6573 6f75 7263  fram Web Resourc
-0000fcd0: 652e 0d0a 2020 2020 2020 2020 2068 7474  e...         htt
-0000fce0: 703a 2f2f 6d61 7468 776f 726c 642e 776f  p://mathworld.wo
-0000fcf0: 6c66 7261 6d2e 636f 6d2f 4761 6d6d 6144  lfram.com/GammaD
-0000fd00: 6973 7472 6962 7574 696f 6e2e 6874 6d6c  istribution.html
-0000fd10: 0d0a 2020 2e2e 205b 325d 2057 696b 6970  ..  .. [2] Wikip
-0000fd20: 6564 6961 2c20 2247 616d 6d61 2064 6973  edia, "Gamma dis
-0000fd30: 7472 6962 7574 696f 6e22 2c0d 0a20 2020  tribution",..   
-0000fd40: 2020 2020 2020 6874 7470 733a 2f2f 656e        https://en
-0000fd50: 2e77 696b 6970 6564 6961 2e6f 7267 2f77  .wikipedia.org/w
-0000fd60: 696b 692f 4761 6d6d 615f 6469 7374 7269  iki/Gamma_distri
-0000fd70: 6275 7469 6f6e 0d0a 0d0a 2020 2222 220d  bution....  """.
-0000fd80: 0a20 2072 6574 7572 6e20 4445 4641 554c  .  return DEFAUL
-0000fd90: 542e 6761 6d6d 6128 7368 6170 652c 2073  T.gamma(shape, s
-0000fda0: 6361 6c65 2c20 7369 7a65 3d73 697a 652c  cale, size=size,
-0000fdb0: 206b 6579 3d6b 6579 2c20 6474 7970 653d   key=key, dtype=
-0000fdc0: 6474 7970 6529 0d0a 0d0a 0d0a 6465 6620  dtype)......def 
-0000fdd0: 6775 6d62 656c 286c 6f63 3d4e 6f6e 652c  gumbel(loc=None,
-0000fde0: 2073 6361 6c65 3d4e 6f6e 652c 2073 697a   scale=None, siz
-0000fdf0: 653a 204f 7074 696f 6e61 6c5b 5369 7a65  e: Optional[Size
-0000fe00: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2020  ] = None,..     
-0000fe10: 2020 2020 2020 6b65 793a 204f 7074 696f        key: Optio
-0000fe20: 6e61 6c5b 5365 6564 4f72 4b65 795d 203d  nal[SeedOrKey] =
-0000fe30: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
-0000fe40: 2020 2064 7479 7065 3a20 4454 7970 654c     dtype: DTypeL
-0000fe50: 696b 6520 3d20 4e6f 6e65 293a 0d0a 2020  ike = None):..  
-0000fe60: 7222 2222 0d0a 2020 4472 6177 2073 616d  r"""..  Draw sam
-0000fe70: 706c 6573 2066 726f 6d20 6120 4775 6d62  ples from a Gumb
-0000fe80: 656c 2064 6973 7472 6962 7574 696f 6e2e  el distribution.
-0000fe90: 0d0a 0d0a 2020 4472 6177 2073 616d 706c  ....  Draw sampl
-0000fea0: 6573 2066 726f 6d20 6120 4775 6d62 656c  es from a Gumbel
-0000feb0: 2064 6973 7472 6962 7574 696f 6e20 7769   distribution wi
-0000fec0: 7468 2073 7065 6369 6669 6564 206c 6f63  th specified loc
-0000fed0: 6174 696f 6e20 616e 640d 0a20 2073 6361  ation and..  sca
-0000fee0: 6c65 2e20 2046 6f72 206d 6f72 6520 696e  le.  For more in
-0000fef0: 666f 726d 6174 696f 6e20 6f6e 2074 6865  formation on the
-0000ff00: 2047 756d 6265 6c20 6469 7374 7269 6275   Gumbel distribu
-0000ff10: 7469 6f6e 2c20 7365 650d 0a20 204e 6f74  tion, see..  Not
-0000ff20: 6573 2061 6e64 2052 6566 6572 656e 6365  es and Reference
-0000ff30: 7320 6265 6c6f 772e 0d0a 0d0a 2020 5061  s below.....  Pa
-0000ff40: 7261 6d65 7465 7273 0d0a 2020 2d2d 2d2d  rameters..  ----
-0000ff50: 2d2d 2d2d 2d2d 0d0a 2020 6c6f 6320 3a20  ------..  loc : 
-0000ff60: 666c 6f61 7420 6f72 2061 7272 6179 5f6c  float or array_l
-0000ff70: 696b 6520 6f66 2066 6c6f 6174 732c 206f  ike of floats, o
-0000ff80: 7074 696f 6e61 6c0d 0a20 2020 2020 2054  ptional..      T
-0000ff90: 6865 206c 6f63 6174 696f 6e20 6f66 2074  he location of t
-0000ffa0: 6865 206d 6f64 6520 6f66 2074 6865 2064  he mode of the d
-0000ffb0: 6973 7472 6962 7574 696f 6e2e 2044 6566  istribution. Def
-0000ffc0: 6175 6c74 2069 7320 302e 0d0a 2020 7363  ault is 0...  sc
-0000ffd0: 616c 6520 3a20 666c 6f61 7420 6f72 2061  ale : float or a
-0000ffe0: 7272 6179 5f6c 696b 6520 6f66 2066 6c6f  rray_like of flo
-0000fff0: 6174 732c 206f 7074 696f 6e61 6c0d 0a20  ats, optional.. 
-00010000: 2020 2020 2054 6865 2073 6361 6c65 2070       The scale p
-00010010: 6172 616d 6574 6572 206f 6620 7468 6520  arameter of the 
-00010020: 6469 7374 7269 6275 7469 6f6e 2e20 4465  distribution. De
-00010030: 6661 756c 7420 6973 2031 2e20 4d75 7374  fault is 1. Must
-00010040: 2062 6520 6e6f 6e2d 0d0a 2020 2020 2020   be non-..      
-00010050: 6e65 6761 7469 7665 2e0d 0a20 2073 697a  negative...  siz
-00010060: 6520 3a20 696e 7420 6f72 2074 7570 6c65  e : int or tuple
-00010070: 206f 6620 696e 7473 2c20 6f70 7469 6f6e   of ints, option
-00010080: 616c 0d0a 2020 2020 2020 4f75 7470 7574  al..      Output
-00010090: 2073 6861 7065 2e20 2049 6620 7468 6520   shape.  If the 
-000100a0: 6769 7665 6e20 7368 6170 6520 6973 2c20  given shape is, 
-000100b0: 652e 672e 2c20 6060 286d 2c20 6e2c 206b  e.g., ``(m, n, k
-000100c0: 2960 602c 2074 6865 6e0d 0a20 2020 2020  )``, then..     
-000100d0: 2060 606d 202a 206e 202a 206b 6060 2073   ``m * n * k`` s
-000100e0: 616d 706c 6573 2061 7265 2064 7261 776e  amples are drawn
-000100f0: 2e20 2049 6620 7369 7a65 2069 7320 6060  .  If size is ``
-00010100: 4e6f 6e65 6060 2028 6465 6661 756c 7429  None`` (default)
-00010110: 2c0d 0a20 2020 2020 2061 2073 696e 676c  ,..      a singl
-00010120: 6520 7661 6c75 6520 6973 2072 6574 7572  e value is retur
-00010130: 6e65 6420 6966 2060 606c 6f63 6060 2061  ned if ``loc`` a
-00010140: 6e64 2060 6073 6361 6c65 6060 2061 7265  nd ``scale`` are
-00010150: 2062 6f74 6820 7363 616c 6172 732e 0d0a   both scalars...
-00010160: 2020 2020 2020 4f74 6865 7277 6973 652c        Otherwise,
-00010170: 2060 606e 702e 6272 6f61 6463 6173 7428   ``np.broadcast(
-00010180: 6c6f 632c 2073 6361 6c65 292e 7369 7a65  loc, scale).size
-00010190: 6060 2073 616d 706c 6573 2061 7265 2064  `` samples are d
-000101a0: 7261 776e 2e0d 0a20 206b 6579 203a 2050  rawn...  key : P
-000101b0: 524e 474b 6579 2c20 6f70 7469 6f6e 616c  RNGKey, optional
-000101c0: 0d0a 2020 2020 2020 5468 6520 6b65 7920  ..      The key 
-000101d0: 666f 7220 7468 6520 7261 6e64 6f6d 206e  for the random n
-000101e0: 756d 6265 7220 6765 6e65 7261 746f 722e  umber generator.
-000101f0: 2049 6620 6e6f 7420 6769 7665 6e2c 2074   If not given, t
-00010200: 6865 0d0a 2020 2020 2020 6465 6661 756c  he..      defaul
-00010210: 7420 7261 6e64 6f6d 206e 756d 6265 7220  t random number 
-00010220: 6765 6e65 7261 746f 7220 6973 2075 7365  generator is use
-00010230: 642e 0d0a 0d0a 2020 5265 7475 726e 730d  d.....  Returns.
-00010240: 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020 6f75  .  -------..  ou
-00010250: 7420 3a20 6e64 6172 7261 7920 6f72 2073  t : ndarray or s
-00010260: 6361 6c61 720d 0a20 2020 2020 2044 7261  calar..      Dra
-00010270: 776e 2073 616d 706c 6573 2066 726f 6d20  wn samples from 
-00010280: 7468 6520 7061 7261 6d65 7465 7269 7a65  the parameterize
-00010290: 6420 4775 6d62 656c 2064 6973 7472 6962  d Gumbel distrib
-000102a0: 7574 696f 6e2e 0d0a 0d0a 2020 4e6f 7465  ution.....  Note
-000102b0: 730d 0a20 202d 2d2d 2d2d 0d0a 2020 5468  s..  -----..  Th
-000102c0: 6520 4775 6d62 656c 2028 6f72 2053 6d61  e Gumbel (or Sma
-000102d0: 6c6c 6573 7420 4578 7472 656d 6520 5661  llest Extreme Va
-000102e0: 6c75 6520 2853 4556 2920 6f72 2074 6865  lue (SEV) or the
-000102f0: 2053 6d61 6c6c 6573 7420 4578 7472 656d   Smallest Extrem
-00010300: 650d 0a20 2056 616c 7565 2054 7970 6520  e..  Value Type 
-00010310: 4929 2064 6973 7472 6962 7574 696f 6e20  I) distribution 
-00010320: 6973 206f 6e65 206f 6620 6120 636c 6173  is one of a clas
-00010330: 7320 6f66 2047 656e 6572 616c 697a 6564  s of Generalized
-00010340: 2045 7874 7265 6d65 0d0a 2020 5661 6c75   Extreme..  Valu
-00010350: 6520 2847 4556 2920 6469 7374 7269 6275  e (GEV) distribu
-00010360: 7469 6f6e 7320 7573 6564 2069 6e20 6d6f  tions used in mo
-00010370: 6465 6c69 6e67 2065 7874 7265 6d65 2076  deling extreme v
-00010380: 616c 7565 2070 726f 626c 656d 732e 0d0a  alue problems...
-00010390: 2020 5468 6520 4775 6d62 656c 2069 7320    The Gumbel is 
-000103a0: 6120 7370 6563 6961 6c20 6361 7365 206f  a special case o
-000103b0: 6620 7468 6520 4578 7472 656d 6520 5661  f the Extreme Va
-000103c0: 6c75 6520 5479 7065 2049 2064 6973 7472  lue Type I distr
-000103d0: 6962 7574 696f 6e0d 0a20 2066 6f72 206d  ibution..  for m
-000103e0: 6178 696d 756d 7320 6672 6f6d 2064 6973  aximums from dis
-000103f0: 7472 6962 7574 696f 6e73 2077 6974 6820  tributions with 
-00010400: 2265 7870 6f6e 656e 7469 616c 2d6c 696b  "exponential-lik
-00010410: 6522 2074 6169 6c73 2e0d 0a0d 0a20 2054  e" tails.....  T
-00010420: 6865 2070 726f 6261 6269 6c69 7479 2064  he probability d
-00010430: 656e 7369 7479 2066 6f72 2074 6865 2047  ensity for the G
-00010440: 756d 6265 6c20 6469 7374 7269 6275 7469  umbel distributi
-00010450: 6f6e 2069 730d 0a0d 0a20 202e 2e20 6d61  on is....  .. ma
-00010460: 7468 3a3a 2070 2878 2920 3d20 5c66 7261  th:: p(x) = \fra
-00010470: 637b 655e 7b2d 2878 202d 205c 6d75 292f  c{e^{-(x - \mu)/
-00010480: 205c 6265 7461 7d7d 7b5c 6265 7461 7d20   \beta}}{\beta} 
-00010490: 655e 7b20 2d65 5e7b 2d28 7820 2d20 5c6d  e^{ -e^{-(x - \m
-000104a0: 7529 2f0d 0a20 2020 2020 2020 2020 2020  u)/..           
-000104b0: 205c 6265 7461 7d7d 2c0d 0a0d 0a20 2077   \beta}},....  w
-000104c0: 6865 7265 203a 6d61 7468 3a60 5c6d 7560  here :math:`\mu`
-000104d0: 2069 7320 7468 6520 6d6f 6465 2c20 6120   is the mode, a 
-000104e0: 6c6f 6361 7469 6f6e 2070 6172 616d 6574  location paramet
-000104f0: 6572 2c20 616e 640d 0a20 203a 6d61 7468  er, and..  :math
-00010500: 3a60 5c62 6574 6160 2069 7320 7468 6520  :`\beta` is the 
-00010510: 7363 616c 6520 7061 7261 6d65 7465 722e  scale parameter.
-00010520: 0d0a 0d0a 2020 5468 6520 4775 6d62 656c  ....  The Gumbel
-00010530: 2028 6e61 6d65 6420 666f 7220 4765 726d   (named for Germ
-00010540: 616e 206d 6174 6865 6d61 7469 6369 616e  an mathematician
-00010550: 2045 6d69 6c20 4a75 6c69 7573 2047 756d   Emil Julius Gum
-00010560: 6265 6c29 2077 6173 2075 7365 640d 0a20  bel) was used.. 
-00010570: 2076 6572 7920 6561 726c 7920 696e 2074   very early in t
-00010580: 6865 2068 7964 726f 6c6f 6779 206c 6974  he hydrology lit
-00010590: 6572 6174 7572 652c 2066 6f72 206d 6f64  erature, for mod
-000105a0: 656c 696e 6720 7468 6520 6f63 6375 7272  eling the occurr
-000105b0: 656e 6365 206f 660d 0a20 2066 6c6f 6f64  ence of..  flood
-000105c0: 2065 7665 6e74 732e 2049 7420 6973 2061   events. It is a
-000105d0: 6c73 6f20 7573 6564 2066 6f72 206d 6f64  lso used for mod
-000105e0: 656c 696e 6720 6d61 7869 6d75 6d20 7769  eling maximum wi
-000105f0: 6e64 2073 7065 6564 2061 6e64 0d0a 2020  nd speed and..  
-00010600: 7261 696e 6661 6c6c 2072 6174 6573 2e20  rainfall rates. 
-00010610: 2049 7420 6973 2061 2022 6661 742d 7461   It is a "fat-ta
-00010620: 696c 6564 2220 6469 7374 7269 6275 7469  iled" distributi
-00010630: 6f6e 202d 2074 6865 2070 726f 6261 6269  on - the probabi
-00010640: 6c69 7479 206f 660d 0a20 2061 6e20 6576  lity of..  an ev
-00010650: 656e 7420 696e 2074 6865 2074 6169 6c20  ent in the tail 
-00010660: 6f66 2074 6865 2064 6973 7472 6962 7574  of the distribut
-00010670: 696f 6e20 6973 206c 6172 6765 7220 7468  ion is larger th
-00010680: 616e 2069 6620 6f6e 6520 7573 6564 2061  an if one used a
-00010690: 0d0a 2020 4761 7573 7369 616e 2c20 6865  ..  Gaussian, he
-000106a0: 6e63 6520 7468 6520 7375 7270 7269 7369  nce the surprisi
-000106b0: 6e67 6c79 2066 7265 7175 656e 7420 6f63  ngly frequent oc
-000106c0: 6375 7272 656e 6365 206f 6620 3130 302d  currence of 100-
-000106d0: 7965 6172 0d0a 2020 666c 6f6f 6473 2e20  year..  floods. 
-000106e0: 466c 6f6f 6473 2077 6572 6520 696e 6974  Floods were init
-000106f0: 6961 6c6c 7920 6d6f 6465 6c65 6420 6173  ially modeled as
-00010700: 2061 2047 6175 7373 6961 6e20 7072 6f63   a Gaussian proc
-00010710: 6573 732c 2077 6869 6368 0d0a 2020 756e  ess, which..  un
-00010720: 6465 7265 7374 696d 6174 6564 2074 6865  derestimated the
-00010730: 2066 7265 7175 656e 6379 206f 6620 6578   frequency of ex
-00010740: 7472 656d 6520 6576 656e 7473 2e0d 0a0d  treme events....
-00010750: 0a20 2049 7420 6973 206f 6e65 206f 6620  .  It is one of 
-00010760: 6120 636c 6173 7320 6f66 2065 7874 7265  a class of extre
-00010770: 6d65 2076 616c 7565 2064 6973 7472 6962  me value distrib
-00010780: 7574 696f 6e73 2c20 7468 6520 4765 6e65  utions, the Gene
-00010790: 7261 6c69 7a65 640d 0a20 2045 7874 7265  ralized..  Extre
-000107a0: 6d65 2056 616c 7565 2028 4745 5629 2064  me Value (GEV) d
-000107b0: 6973 7472 6962 7574 696f 6e73 2c20 7768  istributions, wh
-000107c0: 6963 6820 616c 736f 2069 6e63 6c75 6465  ich also include
-000107d0: 7320 7468 6520 5765 6962 756c 6c20 616e  s the Weibull an
-000107e0: 640d 0a20 2046 7265 6368 6574 2e0d 0a0d  d..  Frechet....
-000107f0: 0a20 2054 6865 2066 756e 6374 696f 6e20  .  The function 
-00010800: 6861 7320 6120 6d65 616e 206f 6620 3a6d  has a mean of :m
-00010810: 6174 683a 605c 6d75 202b 2030 2e35 3737  ath:`\mu + 0.577
-00010820: 3231 5c62 6574 6160 2061 6e64 2061 2076  21\beta` and a v
-00010830: 6172 6961 6e63 650d 0a20 206f 6620 3a6d  ariance..  of :m
-00010840: 6174 683a 605c 6672 6163 7b5c 7069 5e32  ath:`\frac{\pi^2
-00010850: 7d7b 367d 5c62 6574 615e 3260 2e0d 0a0d  }{6}\beta^2`....
-00010860: 0a20 2052 6566 6572 656e 6365 730d 0a20  .  References.. 
-00010870: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 202e   ----------..  .
-00010880: 2e20 5b31 5d20 4775 6d62 656c 2c20 452e  . [1] Gumbel, E.
-00010890: 204a 2e2c 2022 5374 6174 6973 7469 6373   J., "Statistics
-000108a0: 206f 6620 4578 7472 656d 6573 2c22 0d0a   of Extremes,"..
-000108b0: 2020 2020 2020 2020 204e 6577 2059 6f72           New Yor
-000108c0: 6b3a 2043 6f6c 756d 6269 6120 556e 6976  k: Columbia Univ
-000108d0: 6572 7369 7479 2050 7265 7373 2c20 3139  ersity Press, 19
-000108e0: 3538 2e0d 0a20 202e 2e20 5b32 5d20 5265  58...  .. [2] Re
-000108f0: 6973 732c 2052 2e2d 442e 2061 6e64 2054  iss, R.-D. and T
-00010900: 686f 6d61 732c 204d 2e2c 2022 5374 6174  homas, M., "Stat
-00010910: 6973 7469 6361 6c20 416e 616c 7973 6973  istical Analysis
-00010920: 206f 6620 4578 7472 656d 650d 0a20 2020   of Extreme..   
-00010930: 2020 2020 2020 5661 6c75 6573 2066 726f        Values fro
-00010940: 6d20 496e 7375 7261 6e63 652c 2046 696e  m Insurance, Fin
-00010950: 616e 6365 2c20 4879 6472 6f6c 6f67 7920  ance, Hydrology 
-00010960: 616e 6420 4f74 6865 7220 4669 656c 6473  and Other Fields
-00010970: 2c22 0d0a 2020 2020 2020 2020 2042 6173  ,"..         Bas
-00010980: 656c 3a20 4269 726b 6861 7573 6572 2056  el: Birkhauser V
-00010990: 6572 6c61 672c 2032 3030 312e 0d0a 2020  erlag, 2001...  
-000109a0: 2222 220d 0a20 2072 6574 7572 6e20 4445  """..  return DE
-000109b0: 4641 554c 542e 6775 6d62 656c 286c 6f63  FAULT.gumbel(loc
-000109c0: 2c20 7363 616c 652c 2073 697a 653d 7369  , scale, size=si
-000109d0: 7a65 2c20 6b65 793d 6b65 792c 2064 7479  ze, key=key, dty
-000109e0: 7065 3d64 7479 7065 290d 0a0d 0a0d 0a64  pe=dtype)......d
-000109f0: 6566 206c 6170 6c61 6365 286c 6f63 3d4e  ef laplace(loc=N
-00010a00: 6f6e 652c 2073 6361 6c65 3d4e 6f6e 652c  one, scale=None,
-00010a10: 2073 697a 653a 204f 7074 696f 6e61 6c5b   size: Optional[
-00010a20: 5369 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20  Size] = None,.. 
-00010a30: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
-00010a40: 4f70 7469 6f6e 616c 5b53 6565 644f 724b  Optional[SeedOrK
-00010a50: 6579 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ey] = None,..   
-00010a60: 2020 2020 2020 2020 2064 7479 7065 3a20           dtype: 
-00010a70: 4454 7970 654c 696b 6520 3d20 4e6f 6e65  DTypeLike = None
-00010a80: 293a 0d0a 2020 7222 2222 0d0a 2020 4472  ):..  r"""..  Dr
-00010a90: 6177 2073 616d 706c 6573 2066 726f 6d20  aw samples from 
-00010aa0: 7468 6520 4c61 706c 6163 6520 6f72 2064  the Laplace or d
-00010ab0: 6f75 626c 6520 6578 706f 6e65 6e74 6961  ouble exponentia
-00010ac0: 6c20 6469 7374 7269 6275 7469 6f6e 2077  l distribution w
-00010ad0: 6974 680d 0a20 2073 7065 6369 6669 6564  ith..  specified
-00010ae0: 206c 6f63 6174 696f 6e20 286f 7220 6d65   location (or me
-00010af0: 616e 2920 616e 6420 7363 616c 6520 2864  an) and scale (d
-00010b00: 6563 6179 292e 0d0a 0d0a 2020 5468 6520  ecay).....  The 
-00010b10: 4c61 706c 6163 6520 6469 7374 7269 6275  Laplace distribu
-00010b20: 7469 6f6e 2069 7320 7369 6d69 6c61 7220  tion is similar 
-00010b30: 746f 2074 6865 2047 6175 7373 6961 6e2f  to the Gaussian/
-00010b40: 6e6f 726d 616c 2064 6973 7472 6962 7574  normal distribut
-00010b50: 696f 6e2c 0d0a 2020 6275 7420 6973 2073  ion,..  but is s
-00010b60: 6861 7270 6572 2061 7420 7468 6520 7065  harper at the pe
-00010b70: 616b 2061 6e64 2068 6173 2066 6174 7465  ak and has fatte
-00010b80: 7220 7461 696c 732e 2049 7420 7265 7072  r tails. It repr
-00010b90: 6573 656e 7473 2074 6865 0d0a 2020 6469  esents the..  di
-00010ba0: 6666 6572 656e 6365 2062 6574 7765 656e  fference between
-00010bb0: 2074 776f 2069 6e64 6570 656e 6465 6e74   two independent
-00010bc0: 2c20 6964 656e 7469 6361 6c6c 7920 6469  , identically di
-00010bd0: 7374 7269 6275 7465 6420 6578 706f 6e65  stributed expone
-00010be0: 6e74 6961 6c0d 0a20 2072 616e 646f 6d20  ntial..  random 
-00010bf0: 7661 7269 6162 6c65 732e 0d0a 0d0a 2020  variables.....  
-00010c00: 5061 7261 6d65 7465 7273 0d0a 2020 2d2d  Parameters..  --
-00010c10: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 6c6f 6320  --------..  loc 
-00010c20: 3a20 666c 6f61 7420 6f72 2061 7272 6179  : float or array
-00010c30: 5f6c 696b 6520 6f66 2066 6c6f 6174 732c  _like of floats,
-00010c40: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-00010c50: 2054 6865 2070 6f73 6974 696f 6e2c 203a   The position, :
-00010c60: 6d61 7468 3a60 5c6d 7560 2c20 6f66 2074  math:`\mu`, of t
-00010c70: 6865 2064 6973 7472 6962 7574 696f 6e20  he distribution 
-00010c80: 7065 616b 2e20 4465 6661 756c 7420 6973  peak. Default is
-00010c90: 2030 2e0d 0a20 2073 6361 6c65 203a 2066   0...  scale : f
-00010ca0: 6c6f 6174 206f 7220 6172 7261 795f 6c69  loat or array_li
-00010cb0: 6b65 206f 6620 666c 6f61 7473 2c20 6f70  ke of floats, op
-00010cc0: 7469 6f6e 616c 0d0a 2020 2020 2020 3a6d  tional..      :m
-00010cd0: 6174 683a 605c 6c61 6d62 6461 602c 2074  ath:`\lambda`, t
-00010ce0: 6865 2065 7870 6f6e 656e 7469 616c 2064  he exponential d
-00010cf0: 6563 6179 2e20 4465 6661 756c 7420 6973  ecay. Default is
-00010d00: 2031 2e20 4d75 7374 2062 6520 6e6f 6e2d   1. Must be non-
-00010d10: 0d0a 2020 2020 2020 6e65 6761 7469 7665  ..      negative
-00010d20: 2e0d 0a20 2073 697a 6520 3a20 696e 7420  ...  size : int 
-00010d30: 6f72 2074 7570 6c65 206f 6620 696e 7473  or tuple of ints
-00010d40: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-00010d50: 2020 4f75 7470 7574 2073 6861 7065 2e20    Output shape. 
-00010d60: 2049 6620 7468 6520 6769 7665 6e20 7368   If the given sh
-00010d70: 6170 6520 6973 2c20 652e 672e 2c20 6060  ape is, e.g., ``
-00010d80: 286d 2c20 6e2c 206b 2960 602c 2074 6865  (m, n, k)``, the
-00010d90: 6e0d 0a20 2020 2020 2060 606d 202a 206e  n..      ``m * n
-00010da0: 202a 206b 6060 2073 616d 706c 6573 2061   * k`` samples a
-00010db0: 7265 2064 7261 776e 2e20 2049 6620 7369  re drawn.  If si
-00010dc0: 7a65 2069 7320 6060 4e6f 6e65 6060 2028  ze is ``None`` (
-00010dd0: 6465 6661 756c 7429 2c0d 0a20 2020 2020  default),..     
-00010de0: 2061 2073 696e 676c 6520 7661 6c75 6520   a single value 
-00010df0: 6973 2072 6574 7572 6e65 6420 6966 2060  is returned if `
-00010e00: 606c 6f63 6060 2061 6e64 2060 6073 6361  `loc`` and ``sca
-00010e10: 6c65 6060 2061 7265 2062 6f74 6820 7363  le`` are both sc
-00010e20: 616c 6172 732e 0d0a 2020 2020 2020 4f74  alars...      Ot
-00010e30: 6865 7277 6973 652c 2060 606e 702e 6272  herwise, ``np.br
-00010e40: 6f61 6463 6173 7428 6c6f 632c 2073 6361  oadcast(loc, sca
-00010e50: 6c65 292e 7369 7a65 6060 2073 616d 706c  le).size`` sampl
-00010e60: 6573 2061 7265 2064 7261 776e 2e0d 0a20  es are drawn... 
-00010e70: 206b 6579 203a 2050 524e 474b 6579 2c20   key : PRNGKey, 
-00010e80: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-00010e90: 5468 6520 6b65 7920 666f 7220 7468 6520  The key for the 
-00010ea0: 7261 6e64 6f6d 206e 756d 6265 7220 6765  random number ge
-00010eb0: 6e65 7261 746f 722e 2049 6620 6e6f 7420  nerator. If not 
-00010ec0: 6769 7665 6e2c 2074 6865 0d0a 2020 2020  given, the..    
-00010ed0: 2020 6465 6661 756c 7420 7261 6e64 6f6d    default random
-00010ee0: 206e 756d 6265 7220 6765 6e65 7261 746f   number generato
-00010ef0: 7220 6973 2075 7365 642e 0d0a 0d0a 2020  r is used.....  
-00010f00: 5265 7475 726e 730d 0a20 202d 2d2d 2d2d  Returns..  -----
-00010f10: 2d2d 0d0a 2020 6f75 7420 3a20 6e64 6172  --..  out : ndar
-00010f20: 7261 7920 6f72 2073 6361 6c61 720d 0a20  ray or scalar.. 
-00010f30: 2020 2020 2044 7261 776e 2073 616d 706c       Drawn sampl
-00010f40: 6573 2066 726f 6d20 7468 6520 7061 7261  es from the para
-00010f50: 6d65 7465 7269 7a65 6420 4c61 706c 6163  meterized Laplac
-00010f60: 6520 6469 7374 7269 6275 7469 6f6e 2e0d  e distribution..
-00010f70: 0a0d 0a20 204e 6f74 6573 0d0a 2020 2d2d  ...  Notes..  --
-00010f80: 2d2d 2d0d 0a20 2049 7420 6861 7320 7468  ---..  It has th
-00010f90: 6520 7072 6f62 6162 696c 6974 7920 6465  e probability de
-00010fa0: 6e73 6974 7920 6675 6e63 7469 6f6e 0d0a  nsity function..
-00010fb0: 0d0a 2020 2e2e 206d 6174 683a 3a20 6628  ..  .. math:: f(
-00010fc0: 783b 205c 6d75 2c20 5c6c 616d 6264 6129  x; \mu, \lambda)
-00010fd0: 203d 205c 6672 6163 7b31 7d7b 325c 6c61   = \frac{1}{2\la
-00010fe0: 6d62 6461 7d0d 0a20 2020 2020 2020 2020  mbda}..         
-00010ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011000: 2020 2020 2020 2020 5c65 7870 5c6c 6566          \exp\lef
-00011010: 7428 2d5c 6672 6163 7b7c 7820 2d20 5c6d  t(-\frac{|x - \m
-00011020: 757c 7d7b 5c6c 616d 6264 617d 5c72 6967  u|}{\lambda}\rig
-00011030: 6874 292e 0d0a 0d0a 2020 5468 6520 6669  ht).....  The fi
-00011040: 7273 7420 6c61 7720 6f66 204c 6170 6c61  rst law of Lapla
-00011050: 6365 2c20 6672 6f6d 2031 3737 342c 2073  ce, from 1774, s
-00011060: 7461 7465 7320 7468 6174 2074 6865 2066  tates that the f
-00011070: 7265 7175 656e 6379 0d0a 2020 6f66 2061  requency..  of a
-00011080: 6e20 6572 726f 7220 6361 6e20 6265 2065  n error can be e
-00011090: 7870 7265 7373 6564 2061 7320 616e 2065  xpressed as an e
-000110a0: 7870 6f6e 656e 7469 616c 2066 756e 6374  xponential funct
-000110b0: 696f 6e20 6f66 2074 6865 0d0a 2020 6162  ion of the..  ab
-000110c0: 736f 6c75 7465 206d 6167 6e69 7475 6465  solute magnitude
-000110d0: 206f 6620 7468 6520 6572 726f 722c 2077   of the error, w
-000110e0: 6869 6368 206c 6561 6473 2074 6f20 7468  hich leads to th
-000110f0: 6520 4c61 706c 6163 650d 0a20 2064 6973  e Laplace..  dis
-00011100: 7472 6962 7574 696f 6e2e 2046 6f72 206d  tribution. For m
-00011110: 616e 7920 7072 6f62 6c65 6d73 2069 6e20  any problems in 
-00011120: 6563 6f6e 6f6d 6963 7320 616e 6420 6865  economics and he
-00011130: 616c 7468 0d0a 2020 7363 6965 6e63 6573  alth..  sciences
-00011140: 2c20 7468 6973 2064 6973 7472 6962 7574  , this distribut
-00011150: 696f 6e20 7365 656d 7320 746f 206d 6f64  ion seems to mod
-00011160: 656c 2074 6865 2064 6174 6120 6265 7474  el the data bett
-00011170: 6572 0d0a 2020 7468 616e 2074 6865 2073  er..  than the s
-00011180: 7461 6e64 6172 6420 4761 7573 7369 616e  tandard Gaussian
-00011190: 2064 6973 7472 6962 7574 696f 6e2e 0d0a   distribution...
-000111a0: 0d0a 2020 5265 6665 7265 6e63 6573 0d0a  ..  References..
-000111b0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-000111c0: 2e2e 205b 315d 2041 6272 616d 6f77 6974  .. [1] Abramowit
-000111d0: 7a2c 204d 2e20 616e 6420 5374 6567 756e  z, M. and Stegun
-000111e0: 2c20 492e 2041 2e20 2845 6473 2e29 2e20  , I. A. (Eds.). 
-000111f0: 2248 616e 6462 6f6f 6b20 6f66 0d0a 2020  "Handbook of..  
-00011200: 2020 2020 2020 204d 6174 6865 6d61 7469         Mathemati
-00011210: 6361 6c20 4675 6e63 7469 6f6e 7320 7769  cal Functions wi
-00011220: 7468 2046 6f72 6d75 6c61 732c 2047 7261  th Formulas, Gra
-00011230: 7068 732c 2061 6e64 204d 6174 6865 6d61  phs, and Mathema
-00011240: 7469 6361 6c0d 0a20 2020 2020 2020 2020  tical..         
-00011250: 5461 626c 6573 2c20 3974 6820 7072 696e  Tables, 9th prin
-00011260: 7469 6e67 2c22 204e 6577 2059 6f72 6b3a  ting," New York:
-00011270: 2044 6f76 6572 2c20 3139 3732 2e0d 0a20   Dover, 1972... 
-00011280: 202e 2e20 5b32 5d20 4b6f 747a 2c20 5361   .. [2] Kotz, Sa
-00011290: 6d75 656c 2c20 6574 2e20 616c 2e20 2254  muel, et. al. "T
-000112a0: 6865 204c 6170 6c61 6365 2044 6973 7472  he Laplace Distr
-000112b0: 6962 7574 696f 6e20 616e 640d 0a20 2020  ibution and..   
-000112c0: 2020 2020 2020 4765 6e65 7261 6c69 7a61        Generaliza
-000112d0: 7469 6f6e 732c 2022 2042 6972 6b68 6175  tions, " Birkhau
-000112e0: 7365 722c 2032 3030 312e 0d0a 2020 2e2e  ser, 2001...  ..
-000112f0: 205b 335d 2057 6569 7373 7465 696e 2c20   [3] Weisstein, 
-00011300: 4572 6963 2057 2e20 224c 6170 6c61 6365  Eric W. "Laplace
-00011310: 2044 6973 7472 6962 7574 696f 6e2e 220d   Distribution.".
-00011320: 0a20 2020 2020 2020 2020 4672 6f6d 204d  .         From M
-00011330: 6174 6857 6f72 6c64 2d2d 4120 576f 6c66  athWorld--A Wolf
-00011340: 7261 6d20 5765 6220 5265 736f 7572 6365  ram Web Resource
-00011350: 2e0d 0a20 2020 2020 2020 2020 6874 7470  ...         http
-00011360: 3a2f 2f6d 6174 6877 6f72 6c64 2e77 6f6c  ://mathworld.wol
-00011370: 6672 616d 2e63 6f6d 2f4c 6170 6c61 6365  fram.com/Laplace
-00011380: 4469 7374 7269 6275 7469 6f6e 2e68 746d  Distribution.htm
-00011390: 6c0d 0a20 202e 2e20 5b34 5d20 5769 6b69  l..  .. [4] Wiki
-000113a0: 7065 6469 612c 2022 4c61 706c 6163 6520  pedia, "Laplace 
-000113b0: 6469 7374 7269 6275 7469 6f6e 222c 0d0a  distribution",..
-000113c0: 2020 2020 2020 2020 2068 7474 7073 3a2f           https:/
-000113d0: 2f65 6e2e 7769 6b69 7065 6469 612e 6f72  /en.wikipedia.or
-000113e0: 672f 7769 6b69 2f4c 6170 6c61 6365 5f64  g/wiki/Laplace_d
-000113f0: 6973 7472 6962 7574 696f 6e0d 0a0d 0a20  istribution.... 
-00011400: 2045 7861 6d70 6c65 730d 0a20 202d 2d2d   Examples..  ---
-00011410: 2d2d 2d2d 2d0d 0a20 2044 7261 7720 7361  -----..  Draw sa
-00011420: 6d70 6c65 7320 6672 6f6d 2074 6865 2064  mples from the d
-00011430: 6973 7472 6962 7574 696f 6e0d 0a0d 0a20  istribution.... 
-00011440: 203e 3e3e 206c 6f63 2c20 7363 616c 6520   >>> loc, scale 
-00011450: 3d20 302e 2c20 312e 0d0a 2020 3e3e 3e20  = 0., 1...  >>> 
-00011460: 7320 3d20 6263 2e72 616e 646f 6d2e 6c61  s = bc.random.la
-00011470: 706c 6163 6528 6c6f 632c 2073 6361 6c65  place(loc, scale
-00011480: 2c20 3130 3030 290d 0a0d 0a20 2044 6973  , 1000)....  Dis
-00011490: 706c 6179 2074 6865 2068 6973 746f 6772  play the histogr
-000114a0: 616d 206f 6620 7468 6520 7361 6d70 6c65  am of the sample
-000114b0: 732c 2061 6c6f 6e67 2077 6974 680d 0a20  s, along with.. 
-000114c0: 2074 6865 2070 726f 6261 6269 6c69 7479   the probability
-000114d0: 2064 656e 7369 7479 2066 756e 6374 696f   density functio
-000114e0: 6e3a 0d0a 0d0a 2020 3e3e 3e20 696d 706f  n:....  >>> impo
-000114f0: 7274 206d 6174 706c 6f74 6c69 622e 7079  rt matplotlib.py
-00011500: 706c 6f74 2061 7320 706c 7420 2023 206e  plot as plt  # n
-00011510: 6f71 6120 2023 206e 6f71 610d 0a20 203e  oqa  # noqa..  >
-00011520: 3e3e 2063 6f75 6e74 2c20 6269 6e73 2c20  >> count, bins, 
-00011530: 6967 6e6f 7265 6420 3d20 706c 742e 6869  ignored = plt.hi
-00011540: 7374 2873 2c20 3330 2c20 6465 6e73 6974  st(s, 30, densit
-00011550: 793d 5472 7565 290d 0a20 203e 3e3e 2078  y=True)..  >>> x
-00011560: 203d 206e 702e 6172 616e 6765 282d 382e   = np.arange(-8.
-00011570: 2c20 382e 2c20 2e30 3129 0d0a 2020 3e3e  , 8., .01)..  >>
-00011580: 3e20 7064 6620 3d20 6e70 2e65 7870 282d  > pdf = np.exp(-
-00011590: 6162 7328 782d 6c6f 6329 2f73 6361 6c65  abs(x-loc)/scale
-000115a0: 292f 2832 2e2a 7363 616c 6529 0d0a 2020  )/(2.*scale)..  
-000115b0: 3e3e 3e20 706c 742e 706c 6f74 2878 2c20  >>> plt.plot(x, 
-000115c0: 7064 6629 0d0a 0d0a 2020 506c 6f74 2047  pdf)....  Plot G
-000115d0: 6175 7373 6961 6e20 666f 7220 636f 6d70  aussian for comp
-000115e0: 6172 6973 6f6e 3a0d 0a0d 0a20 203e 3e3e  arison:....  >>>
-000115f0: 2067 203d 2028 312f 2873 6361 6c65 202a   g = (1/(scale *
-00011600: 206e 702e 7371 7274 2832 202a 206e 702e   np.sqrt(2 * np.
-00011610: 7069 2929 202a 0d0a 2020 2e2e 2e20 2020  pi)) *..  ...   
-00011620: 2020 206e 702e 6578 7028 2d28 7820 2d20     np.exp(-(x - 
-00011630: 6c6f 6329 2a2a 3220 2f20 2832 202a 2073  loc)**2 / (2 * s
-00011640: 6361 6c65 2a2a 3229 2929 0d0a 2020 3e3e  cale**2)))..  >>
-00011650: 3e20 706c 742e 706c 6f74 2878 2c67 290d  > plt.plot(x,g).
-00011660: 0a20 2022 2222 0d0a 2020 7265 7475 726e  .  """..  return
-00011670: 2044 4546 4155 4c54 2e6c 6170 6c61 6365   DEFAULT.laplace
-00011680: 286c 6f63 2c20 7363 616c 652c 2073 697a  (loc, scale, siz
-00011690: 652c 206b 6579 3d6b 6579 2c20 6474 7970  e, key=key, dtyp
-000116a0: 653d 6474 7970 6529 0d0a 0d0a 0d0a 6465  e=dtype)......de
-000116b0: 6620 6c6f 6769 7374 6963 286c 6f63 3d4e  f logistic(loc=N
-000116c0: 6f6e 652c 2073 6361 6c65 3d4e 6f6e 652c  one, scale=None,
-000116d0: 2073 697a 653a 204f 7074 696f 6e61 6c5b   size: Optional[
-000116e0: 5369 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20  Size] = None,.. 
-000116f0: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
-00011700: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
-00011710: 4b65 795d 203d 204e 6f6e 652c 0d0a 2020  Key] = None,..  
-00011720: 2020 2020 2020 2020 2020 2064 7479 7065             dtype
-00011730: 3a20 4454 7970 654c 696b 6520 3d20 4e6f  : DTypeLike = No
-00011740: 6e65 293a 0d0a 2020 7222 2222 0d0a 2020  ne):..  r"""..  
-00011750: 4472 6177 2073 616d 706c 6573 2066 726f  Draw samples fro
-00011760: 6d20 6120 6c6f 6769 7374 6963 2064 6973  m a logistic dis
-00011770: 7472 6962 7574 696f 6e2e 0d0a 0d0a 2020  tribution.....  
-00011780: 5361 6d70 6c65 7320 6172 6520 6472 6177  Samples are draw
-00011790: 6e20 6672 6f6d 2061 206c 6f67 6973 7469  n from a logisti
-000117a0: 6320 6469 7374 7269 6275 7469 6f6e 2077  c distribution w
-000117b0: 6974 6820 7370 6563 6966 6965 640d 0a20  ith specified.. 
-000117c0: 2070 6172 616d 6574 6572 732c 206c 6f63   parameters, loc
-000117d0: 2028 6c6f 6361 7469 6f6e 206f 7220 6d65   (location or me
-000117e0: 616e 2c20 616c 736f 206d 6564 6961 6e29  an, also median)
-000117f0: 2c20 616e 6420 7363 616c 6520 283e 3029  , and scale (>0)
-00011800: 2e0d 0a0d 0a20 2050 6172 616d 6574 6572  .....  Parameter
-00011810: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
-00011820: 0a20 206c 6f63 203a 2066 6c6f 6174 206f  .  loc : float o
-00011830: 7220 6172 7261 795f 6c69 6b65 206f 6620  r array_like of 
-00011840: 666c 6f61 7473 2c20 6f70 7469 6f6e 616c  floats, optional
-00011850: 0d0a 2020 2020 2020 5061 7261 6d65 7465  ..      Paramete
-00011860: 7220 6f66 2074 6865 2064 6973 7472 6962  r of the distrib
-00011870: 7574 696f 6e2e 2044 6566 6175 6c74 2069  ution. Default i
-00011880: 7320 302e 0d0a 2020 7363 616c 6520 3a20  s 0...  scale : 
-00011890: 666c 6f61 7420 6f72 2061 7272 6179 5f6c  float or array_l
-000118a0: 696b 6520 6f66 2066 6c6f 6174 732c 206f  ike of floats, o
-000118b0: 7074 696f 6e61 6c0d 0a20 2020 2020 2050  ptional..      P
-000118c0: 6172 616d 6574 6572 206f 6620 7468 6520  arameter of the 
-000118d0: 6469 7374 7269 6275 7469 6f6e 2e20 4d75  distribution. Mu
-000118e0: 7374 2062 6520 6e6f 6e2d 6e65 6761 7469  st be non-negati
-000118f0: 7665 2e0d 0a20 2020 2020 2044 6566 6175  ve...      Defau
-00011900: 6c74 2069 7320 312e 0d0a 2020 7369 7a65  lt is 1...  size
-00011910: 203a 2069 6e74 206f 7220 7475 706c 6520   : int or tuple 
-00011920: 6f66 2069 6e74 732c 206f 7074 696f 6e61  of ints, optiona
-00011930: 6c0d 0a20 2020 2020 204f 7574 7075 7420  l..      Output 
-00011940: 7368 6170 652e 2020 4966 2074 6865 2067  shape.  If the g
-00011950: 6976 656e 2073 6861 7065 2069 732c 2065  iven shape is, e
-00011960: 2e67 2e2c 2060 6028 6d2c 206e 2c20 6b29  .g., ``(m, n, k)
-00011970: 6060 2c20 7468 656e 0d0a 2020 2020 2020  ``, then..      
-00011980: 6060 6d20 2a20 6e20 2a20 6b60 6020 7361  ``m * n * k`` sa
-00011990: 6d70 6c65 7320 6172 6520 6472 6177 6e2e  mples are drawn.
-000119a0: 2020 4966 2073 697a 6520 6973 2060 604e    If size is ``N
-000119b0: 6f6e 6560 6020 2864 6566 6175 6c74 292c  one`` (default),
-000119c0: 0d0a 2020 2020 2020 6120 7369 6e67 6c65  ..      a single
-000119d0: 2076 616c 7565 2069 7320 7265 7475 726e   value is return
-000119e0: 6564 2069 6620 6060 6c6f 6360 6020 616e  ed if ``loc`` an
-000119f0: 6420 6060 7363 616c 6560 6020 6172 6520  d ``scale`` are 
-00011a00: 626f 7468 2073 6361 6c61 7273 2e0d 0a20  both scalars... 
-00011a10: 2020 2020 204f 7468 6572 7769 7365 2c20       Otherwise, 
-00011a20: 6060 6e70 2e62 726f 6164 6361 7374 286c  ``np.broadcast(l
-00011a30: 6f63 2c20 7363 616c 6529 2e73 697a 6560  oc, scale).size`
-00011a40: 6020 7361 6d70 6c65 7320 6172 6520 6472  ` samples are dr
-00011a50: 6177 6e2e 0d0a 2020 6b65 7920 3a20 5052  awn...  key : PR
-00011a60: 4e47 4b65 792c 206f 7074 696f 6e61 6c0d  NGKey, optional.
-00011a70: 0a20 2020 2020 2054 6865 206b 6579 2066  .      The key f
-00011a80: 6f72 2074 6865 2072 616e 646f 6d20 6e75  or the random nu
-00011a90: 6d62 6572 2067 656e 6572 6174 6f72 2e20  mber generator. 
-00011aa0: 4966 206e 6f74 2067 6976 656e 2c20 7468  If not given, th
-00011ab0: 650d 0a20 2020 2020 2064 6566 6175 6c74  e..      default
-00011ac0: 2072 616e 646f 6d20 6e75 6d62 6572 2067   random number g
-00011ad0: 656e 6572 6174 6f72 2069 7320 7573 6564  enerator is used
-00011ae0: 2e0d 0a0d 0a20 2052 6574 7572 6e73 0d0a  .....  Returns..
-00011af0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574    -------..  out
-00011b00: 203a 206e 6461 7272 6179 206f 7220 7363   : ndarray or sc
-00011b10: 616c 6172 0d0a 2020 2020 2020 4472 6177  alar..      Draw
-00011b20: 6e20 7361 6d70 6c65 7320 6672 6f6d 2074  n samples from t
-00011b30: 6865 2070 6172 616d 6574 6572 697a 6564  he parameterized
-00011b40: 206c 6f67 6973 7469 6320 6469 7374 7269   logistic distri
-00011b50: 6275 7469 6f6e 2e0d 0a0d 0a20 204e 6f74  bution.....  Not
-00011b60: 6573 0d0a 2020 2d2d 2d2d 2d0d 0a20 2054  es..  -----..  T
-00011b70: 6865 2070 726f 6261 6269 6c69 7479 2064  he probability d
-00011b80: 656e 7369 7479 2066 6f72 2074 6865 204c  ensity for the L
-00011b90: 6f67 6973 7469 6320 6469 7374 7269 6275  ogistic distribu
-00011ba0: 7469 6f6e 2069 730d 0a0d 0a20 202e 2e20  tion is....  .. 
-00011bb0: 6d61 7468 3a3a 2050 2878 2920 3d20 5028  math:: P(x) = P(
-00011bc0: 7829 203d 205c 6672 6163 7b65 5e7b 2d28  x) = \frac{e^{-(
-00011bd0: 782d 5c6d 7529 2f73 7d7d 7b73 2831 2b65  x-\mu)/s}}{s(1+e
-00011be0: 5e7b 2d28 782d 5c6d 7529 2f73 7d29 5e32  ^{-(x-\mu)/s})^2
-00011bf0: 7d2c 0d0a 0d0a 2020 7768 6572 6520 3a6d  },....  where :m
-00011c00: 6174 683a 605c 6d75 6020 3d20 6c6f 6361  ath:`\mu` = loca
-00011c10: 7469 6f6e 2061 6e64 203a 6d61 7468 3a60  tion and :math:`
-00011c20: 7360 203d 2073 6361 6c65 2e0d 0a0d 0a20  s` = scale..... 
-00011c30: 2054 6865 204c 6f67 6973 7469 6320 6469   The Logistic di
-00011c40: 7374 7269 6275 7469 6f6e 2069 7320 7573  stribution is us
-00011c50: 6564 2069 6e20 4578 7472 656d 6520 5661  ed in Extreme Va
-00011c60: 6c75 6520 7072 6f62 6c65 6d73 2077 6865  lue problems whe
-00011c70: 7265 2069 740d 0a20 2063 616e 2061 6374  re it..  can act
-00011c80: 2061 7320 6120 6d69 7874 7572 6520 6f66   as a mixture of
-00011c90: 2047 756d 6265 6c20 6469 7374 7269 6275   Gumbel distribu
-00011ca0: 7469 6f6e 732c 2069 6e20 4570 6964 656d  tions, in Epidem
-00011cb0: 696f 6c6f 6779 2c20 616e 6420 6279 0d0a  iology, and by..
-00011cc0: 2020 7468 6520 576f 726c 6420 4368 6573    the World Ches
-00011cd0: 7320 4665 6465 7261 7469 6f6e 2028 4649  s Federation (FI
-00011ce0: 4445 2920 7768 6572 6520 6974 2069 7320  DE) where it is 
-00011cf0: 7573 6564 2069 6e20 7468 6520 456c 6f20  used in the Elo 
-00011d00: 7261 6e6b 696e 670d 0a20 2073 7973 7465  ranking..  syste
-00011d10: 6d2c 2061 7373 756d 696e 6720 7468 6520  m, assuming the 
-00011d20: 7065 7266 6f72 6d61 6e63 6520 6f66 2065  performance of e
-00011d30: 6163 6820 706c 6179 6572 2069 7320 6120  ach player is a 
-00011d40: 6c6f 6769 7374 6963 616c 6c79 0d0a 2020  logistically..  
-00011d50: 6469 7374 7269 6275 7465 6420 7261 6e64  distributed rand
-00011d60: 6f6d 2076 6172 6961 626c 652e 0d0a 0d0a  om variable.....
-00011d70: 2020 5265 6665 7265 6e63 6573 0d0a 2020    References..  
-00011d80: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2e2e  ----------..  ..
-00011d90: 205b 315d 2052 6569 7373 2c20 522e 2d44   [1] Reiss, R.-D
-00011da0: 2e20 616e 6420 5468 6f6d 6173 204d 2e20  . and Thomas M. 
-00011db0: 2832 3030 3129 2c20 2253 7461 7469 7374  (2001), "Statist
-00011dc0: 6963 616c 2041 6e61 6c79 7369 7320 6f66  ical Analysis of
-00011dd0: 0d0a 2020 2020 2020 2020 2045 7874 7265  ..         Extre
-00011de0: 6d65 2056 616c 7565 732c 2066 726f 6d20  me Values, from 
-00011df0: 496e 7375 7261 6e63 652c 2046 696e 616e  Insurance, Finan
-00011e00: 6365 2c20 4879 6472 6f6c 6f67 7920 616e  ce, Hydrology an
-00011e10: 6420 4f74 6865 720d 0a20 2020 2020 2020  d Other..       
-00011e20: 2020 4669 656c 6473 2c22 2042 6972 6b68    Fields," Birkh
-00011e30: 6175 7365 7220 5665 726c 6167 2c20 4261  auser Verlag, Ba
-00011e40: 7365 6c2c 2070 7020 3133 322d 3133 332e  sel, pp 132-133.
-00011e50: 0d0a 2020 2e2e 205b 325d 2057 6569 7373  ..  .. [2] Weiss
-00011e60: 7465 696e 2c20 4572 6963 2057 2e20 224c  tein, Eric W. "L
-00011e70: 6f67 6973 7469 6320 4469 7374 7269 6275  ogistic Distribu
-00011e80: 7469 6f6e 2e22 2046 726f 6d0d 0a20 2020  tion." From..   
-00011e90: 2020 2020 2020 4d61 7468 576f 726c 642d        MathWorld-
-00011ea0: 2d41 2057 6f6c 6672 616d 2057 6562 2052  -A Wolfram Web R
-00011eb0: 6573 6f75 7263 652e 0d0a 2020 2020 2020  esource...      
-00011ec0: 2020 2068 7474 703a 2f2f 6d61 7468 776f     http://mathwo
-00011ed0: 726c 642e 776f 6c66 7261 6d2e 636f 6d2f  rld.wolfram.com/
-00011ee0: 4c6f 6769 7374 6963 4469 7374 7269 6275  LogisticDistribu
-00011ef0: 7469 6f6e 2e68 746d 6c0d 0a20 202e 2e20  tion.html..  .. 
-00011f00: 5b33 5d20 5769 6b69 7065 6469 612c 2022  [3] Wikipedia, "
-00011f10: 4c6f 6769 7374 6963 2d64 6973 7472 6962  Logistic-distrib
-00011f20: 7574 696f 6e22 2c0d 0a20 2020 2020 2020  ution",..       
-00011f30: 2020 6874 7470 733a 2f2f 656e 2e77 696b    https://en.wik
-00011f40: 6970 6564 6961 2e6f 7267 2f77 696b 692f  ipedia.org/wiki/
-00011f50: 4c6f 6769 7374 6963 5f64 6973 7472 6962  Logistic_distrib
-00011f60: 7574 696f 6e0d 0a0d 0a20 2045 7861 6d70  ution....  Examp
-00011f70: 6c65 730d 0a20 202d 2d2d 2d2d 2d2d 2d0d  les..  --------.
-00011f80: 0a20 2044 7261 7720 7361 6d70 6c65 7320  .  Draw samples 
-00011f90: 6672 6f6d 2074 6865 2064 6973 7472 6962  from the distrib
-00011fa0: 7574 696f 6e3a 0d0a 0d0a 2020 3e3e 3e20  ution:....  >>> 
-00011fb0: 6c6f 632c 2073 6361 6c65 203d 2031 302c  loc, scale = 10,
-00011fc0: 2031 0d0a 2020 3e3e 3e20 7320 3d20 6263   1..  >>> s = bc
-00011fd0: 2e72 616e 646f 6d2e 6c6f 6769 7374 6963  .random.logistic
-00011fe0: 286c 6f63 2c20 7363 616c 652c 2031 3030  (loc, scale, 100
-00011ff0: 3030 290d 0a20 203e 3e3e 2069 6d70 6f72  00)..  >>> impor
-00012000: 7420 6d61 7470 6c6f 746c 6962 2e70 7970  t matplotlib.pyp
-00012010: 6c6f 7420 6173 2070 6c74 2020 2320 6e6f  lot as plt  # no
-00012020: 7161 0d0a 2020 3e3e 3e20 636f 756e 742c  qa..  >>> count,
-00012030: 2062 696e 732c 2069 676e 6f72 6564 203d   bins, ignored =
-00012040: 2070 6c74 2e68 6973 7428 732c 2062 696e   plt.hist(s, bin
-00012050: 733d 3530 290d 0a0d 0a20 2023 2020 2070  s=50)....  #   p
-00012060: 6c6f 7420 6167 6169 6e73 7420 6469 7374  lot against dist
-00012070: 7269 6275 7469 6f6e 0d0a 0d0a 2020 3e3e  ribution....  >>
-00012080: 3e20 6465 6620 6c6f 6769 7374 2878 2c20  > def logist(x, 
-00012090: 6c6f 632c 2073 6361 6c65 293a 0d0a 2020  loc, scale):..  
-000120a0: 2e2e 2e20 2020 2020 7265 7475 726e 206e  ...     return n
-000120b0: 702e 6578 7028 286c 6f63 2d78 292f 7363  p.exp((loc-x)/sc
-000120c0: 616c 6529 2f28 7363 616c 652a 2831 2b6e  ale)/(scale*(1+n
-000120d0: 702e 6578 7028 286c 6f63 2d78 292f 7363  p.exp((loc-x)/sc
-000120e0: 616c 6529 292a 2a32 290d 0a20 203e 3e3e  ale))**2)..  >>>
-000120f0: 206c 6773 745f 7661 6c20 3d20 6c6f 6769   lgst_val = logi
-00012100: 7374 2862 696e 732c 206c 6f63 2c20 7363  st(bins, loc, sc
-00012110: 616c 6529 0d0a 2020 3e3e 3e20 706c 742e  ale)..  >>> plt.
-00012120: 706c 6f74 2862 696e 732c 206c 6773 745f  plot(bins, lgst_
-00012130: 7661 6c20 2a20 636f 756e 742e 6d61 7828  val * count.max(
-00012140: 2920 2f20 6c67 7374 5f76 616c 2e6d 6178  ) / lgst_val.max
-00012150: 2829 290d 0a20 203e 3e3e 2070 6c74 2e73  ())..  >>> plt.s
-00012160: 686f 7728 290d 0a20 2022 2222 0d0a 2020  how()..  """..  
-00012170: 7265 7475 726e 2044 4546 4155 4c54 2e6c  return DEFAULT.l
-00012180: 6f67 6973 7469 6328 6c6f 632c 2073 6361  ogistic(loc, sca
-00012190: 6c65 2c20 7369 7a65 2c20 6b65 793d 6b65  le, size, key=ke
-000121a0: 792c 2064 7479 7065 3d64 7479 7065 290d  y, dtype=dtype).
-000121b0: 0a0d 0a0d 0a64 6566 206e 6f72 6d61 6c28  .....def normal(
-000121c0: 6c6f 633d 4e6f 6e65 2c20 7363 616c 653d  loc=None, scale=
-000121d0: 4e6f 6e65 2c20 7369 7a65 3a20 4f70 7469  None, size: Opti
-000121e0: 6f6e 616c 5b53 697a 655d 203d 204e 6f6e  onal[Size] = Non
-000121f0: 652c 0d0a 2020 2020 2020 2020 2020 206b  e,..           k
-00012200: 6579 3a20 4f70 7469 6f6e 616c 5b53 6565  ey: Optional[See
-00012210: 644f 724b 6579 5d20 3d20 4e6f 6e65 2c0d  dOrKey] = None,.
-00012220: 0a20 2020 2020 2020 2020 2020 6474 7970  .           dtyp
-00012230: 653a 2044 5479 7065 4c69 6b65 203d 204e  e: DTypeLike = N
-00012240: 6f6e 6529 3a0d 0a20 2072 2222 220d 0a20  one):..  r""".. 
-00012250: 2044 7261 7720 7261 6e64 6f6d 2073 616d   Draw random sam
-00012260: 706c 6573 2066 726f 6d20 6120 6e6f 726d  ples from a norm
-00012270: 616c 2028 4761 7573 7369 616e 2920 6469  al (Gaussian) di
-00012280: 7374 7269 6275 7469 6f6e 2e0d 0a0d 0a20  stribution..... 
-00012290: 2054 6865 2070 726f 6261 6269 6c69 7479   The probability
-000122a0: 2064 656e 7369 7479 2066 756e 6374 696f   density functio
-000122b0: 6e20 6f66 2074 6865 206e 6f72 6d61 6c20  n of the normal 
-000122c0: 6469 7374 7269 6275 7469 6f6e 2c20 6669  distribution, fi
-000122d0: 7273 740d 0a20 2064 6572 6976 6564 2062  rst..  derived b
-000122e0: 7920 4465 204d 6f69 7672 6520 616e 6420  y De Moivre and 
-000122f0: 3230 3020 7965 6172 7320 6c61 7465 7220  200 years later 
-00012300: 6279 2062 6f74 6820 4761 7573 7320 616e  by both Gauss an
-00012310: 6420 4c61 706c 6163 650d 0a20 2069 6e64  d Laplace..  ind
-00012320: 6570 656e 6465 6e74 6c79 205b 325d 5f2c  ependently [2]_,
-00012330: 2069 7320 6f66 7465 6e20 6361 6c6c 6564   is often called
-00012340: 2074 6865 2062 656c 6c20 6375 7276 6520   the bell curve 
-00012350: 6265 6361 7573 6520 6f66 0d0a 2020 6974  because of..  it
-00012360: 7320 6368 6172 6163 7465 7269 7374 6963  s characteristic
-00012370: 2073 6861 7065 2028 7365 6520 7468 6520   shape (see the 
-00012380: 6578 616d 706c 6520 6265 6c6f 7729 2e0d  example below)..
-00012390: 0a0d 0a20 2054 6865 206e 6f72 6d61 6c20  ...  The normal 
-000123a0: 6469 7374 7269 6275 7469 6f6e 7320 6f63  distributions oc
-000123b0: 6375 7273 206f 6674 656e 2069 6e20 6e61  curs often in na
-000123c0: 7475 7265 2e20 2046 6f72 2065 7861 6d70  ture.  For examp
-000123d0: 6c65 2c20 6974 0d0a 2020 6465 7363 7269  le, it..  descri
-000123e0: 6265 7320 7468 6520 636f 6d6d 6f6e 6c79  bes the commonly
-000123f0: 206f 6363 7572 7269 6e67 2064 6973 7472   occurring distr
-00012400: 6962 7574 696f 6e20 6f66 2073 616d 706c  ibution of sampl
-00012410: 6573 2069 6e66 6c75 656e 6365 640d 0a20  es influenced.. 
-00012420: 2062 7920 6120 6c61 7267 6520 6e75 6d62   by a large numb
-00012430: 6572 206f 6620 7469 6e79 2c20 7261 6e64  er of tiny, rand
-00012440: 6f6d 2064 6973 7475 7262 616e 6365 732c  om disturbances,
-00012450: 2065 6163 6820 7769 7468 2069 7473 206f   each with its o
-00012460: 776e 0d0a 2020 756e 6971 7565 2064 6973  wn..  unique dis
-00012470: 7472 6962 7574 696f 6e20 5b32 5d5f 2e0d  tribution [2]_..
-00012480: 0a0d 0a20 2050 6172 616d 6574 6572 730d  ...  Parameters.
-00012490: 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  .  ----------.. 
-000124a0: 206c 6f63 203a 2066 6c6f 6174 206f 7220   loc : float or 
-000124b0: 6172 7261 795f 6c69 6b65 206f 6620 666c  array_like of fl
-000124c0: 6f61 7473 0d0a 2020 2020 2020 4d65 616e  oats..      Mean
-000124d0: 2028 2263 656e 7472 6522 2920 6f66 2074   ("centre") of t
-000124e0: 6865 2064 6973 7472 6962 7574 696f 6e2e  he distribution.
-000124f0: 0d0a 2020 7363 616c 6520 3a20 666c 6f61  ..  scale : floa
-00012500: 7420 6f72 2061 7272 6179 5f6c 696b 6520  t or array_like 
-00012510: 6f66 2066 6c6f 6174 730d 0a20 2020 2020  of floats..     
-00012520: 2053 7461 6e64 6172 6420 6465 7669 6174   Standard deviat
-00012530: 696f 6e20 2873 7072 6561 6420 6f72 2022  ion (spread or "
-00012540: 7769 6474 6822 2920 6f66 2074 6865 2064  width") of the d
-00012550: 6973 7472 6962 7574 696f 6e2e 204d 7573  istribution. Mus
-00012560: 7420 6265 0d0a 2020 2020 2020 6e6f 6e2d  t be..      non-
-00012570: 6e65 6761 7469 7665 2e0d 0a20 2073 697a  negative...  siz
-00012580: 6520 3a20 696e 7420 6f72 2074 7570 6c65  e : int or tuple
-00012590: 206f 6620 696e 7473 2c20 6f70 7469 6f6e   of ints, option
-000125a0: 616c 0d0a 2020 2020 2020 4f75 7470 7574  al..      Output
-000125b0: 2073 6861 7065 2e20 2049 6620 7468 6520   shape.  If the 
-000125c0: 6769 7665 6e20 7368 6170 6520 6973 2c20  given shape is, 
-000125d0: 652e 672e 2c20 6060 286d 2c20 6e2c 206b  e.g., ``(m, n, k
-000125e0: 2960 602c 2074 6865 6e0d 0a20 2020 2020  )``, then..     
-000125f0: 2060 606d 202a 206e 202a 206b 6060 2073   ``m * n * k`` s
-00012600: 616d 706c 6573 2061 7265 2064 7261 776e  amples are drawn
-00012610: 2e20 2049 6620 7369 7a65 2069 7320 6060  .  If size is ``
-00012620: 4e6f 6e65 6060 2028 6465 6661 756c 7429  None`` (default)
-00012630: 2c0d 0a20 2020 2020 2061 2073 696e 676c  ,..      a singl
-00012640: 6520 7661 6c75 6520 6973 2072 6574 7572  e value is retur
-00012650: 6e65 6420 6966 2060 606c 6f63 6060 2061  ned if ``loc`` a
-00012660: 6e64 2060 6073 6361 6c65 6060 2061 7265  nd ``scale`` are
-00012670: 2062 6f74 6820 7363 616c 6172 732e 0d0a   both scalars...
-00012680: 2020 2020 2020 4f74 6865 7277 6973 652c        Otherwise,
-00012690: 2060 606e 702e 6272 6f61 6463 6173 7428   ``np.broadcast(
-000126a0: 6c6f 632c 2073 6361 6c65 292e 7369 7a65  loc, scale).size
-000126b0: 6060 2073 616d 706c 6573 2061 7265 2064  `` samples are d
-000126c0: 7261 776e 2e0d 0a20 206b 6579 203a 2050  rawn...  key : P
-000126d0: 524e 474b 6579 2c20 6f70 7469 6f6e 616c  RNGKey, optional
-000126e0: 0d0a 2020 2020 2020 5468 6520 6b65 7920  ..      The key 
-000126f0: 666f 7220 7468 6520 7261 6e64 6f6d 206e  for the random n
-00012700: 756d 6265 7220 6765 6e65 7261 746f 722e  umber generator.
-00012710: 2049 6620 6e6f 7420 6769 7665 6e2c 2074   If not given, t
-00012720: 6865 0d0a 2020 2020 2020 6465 6661 756c  he..      defaul
-00012730: 7420 7261 6e64 6f6d 206e 756d 6265 7220  t random number 
-00012740: 6765 6e65 7261 746f 7220 6973 2075 7365  generator is use
-00012750: 642e 0d0a 0d0a 2020 5265 7475 726e 730d  d.....  Returns.
-00012760: 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020 6f75  .  -------..  ou
-00012770: 7420 3a20 6e64 6172 7261 7920 6f72 2073  t : ndarray or s
-00012780: 6361 6c61 720d 0a20 2020 2020 2044 7261  calar..      Dra
-00012790: 776e 2073 616d 706c 6573 2066 726f 6d20  wn samples from 
-000127a0: 7468 6520 7061 7261 6d65 7465 7269 7a65  the parameterize
-000127b0: 6420 6e6f 726d 616c 2064 6973 7472 6962  d normal distrib
-000127c0: 7574 696f 6e2e 0d0a 0d0a 2020 4e6f 7465  ution.....  Note
-000127d0: 730d 0a20 202d 2d2d 2d2d 0d0a 2020 5468  s..  -----..  Th
-000127e0: 6520 7072 6f62 6162 696c 6974 7920 6465  e probability de
-000127f0: 6e73 6974 7920 666f 7220 7468 6520 4761  nsity for the Ga
-00012800: 7573 7369 616e 2064 6973 7472 6962 7574  ussian distribut
-00012810: 696f 6e20 6973 0d0a 0d0a 2020 2e2e 206d  ion is....  .. m
-00012820: 6174 683a 3a20 7028 7829 203d 205c 6672  ath:: p(x) = \fr
-00012830: 6163 7b31 7d7b 5c73 7172 747b 2032 205c  ac{1}{\sqrt{ 2 \
-00012840: 7069 205c 7369 676d 615e 3220 7d7d 0d0a  pi \sigma^2 }}..
-00012850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012860: 2020 2065 5e7b 202d 205c 6672 6163 7b20     e^{ - \frac{ 
-00012870: 2878 202d 205c 6d75 295e 3220 7d20 7b32  (x - \mu)^2 } {2
-00012880: 205c 7369 676d 615e 327d 207d 2c0d 0a0d   \sigma^2} },...
-00012890: 0a20 2077 6865 7265 203a 6d61 7468 3a60  .  where :math:`
-000128a0: 5c6d 7560 2069 7320 7468 6520 6d65 616e  \mu` is the mean
-000128b0: 2061 6e64 203a 6d61 7468 3a60 5c73 6967   and :math:`\sig
-000128c0: 6d61 6020 7468 6520 7374 616e 6461 7264  ma` the standard
-000128d0: 0d0a 2020 6465 7669 6174 696f 6e2e 2054  ..  deviation. T
-000128e0: 6865 2073 7175 6172 6520 6f66 2074 6865  he square of the
-000128f0: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
-00012900: 696f 6e2c 203a 6d61 7468 3a60 5c73 6967  ion, :math:`\sig
-00012910: 6d61 5e32 602c 0d0a 2020 6973 2063 616c  ma^2`,..  is cal
-00012920: 6c65 6420 7468 6520 7661 7269 616e 6365  led the variance
-00012930: 2e0d 0a0d 0a20 2054 6865 2066 756e 6374  .....  The funct
-00012940: 696f 6e20 6861 7320 6974 7320 7065 616b  ion has its peak
-00012950: 2061 7420 7468 6520 6d65 616e 2c20 616e   at the mean, an
-00012960: 6420 6974 7320 2273 7072 6561 6422 2069  d its "spread" i
-00012970: 6e63 7265 6173 6573 2077 6974 680d 0a20  ncreases with.. 
-00012980: 2074 6865 2073 7461 6e64 6172 6420 6465   the standard de
-00012990: 7669 6174 696f 6e20 2874 6865 2066 756e  viation (the fun
-000129a0: 6374 696f 6e20 7265 6163 6865 7320 302e  ction reaches 0.
-000129b0: 3630 3720 7469 6d65 7320 6974 7320 6d61  607 times its ma
-000129c0: 7869 6d75 6d20 6174 0d0a 2020 3a6d 6174  ximum at..  :mat
-000129d0: 683a 6078 202b 205c 7369 676d 6160 2061  h:`x + \sigma` a
-000129e0: 6e64 203a 6d61 7468 3a60 7820 2d20 5c73  nd :math:`x - \s
-000129f0: 6967 6d61 6020 5b32 5d5f 292e 2020 5468  igma` [2]_).  Th
-00012a00: 6973 2069 6d70 6c69 6573 2074 6861 740d  is implies that.
-00012a10: 0a20 206e 6f72 6d61 6c20 6973 206d 6f72  .  normal is mor
-00012a20: 6520 6c69 6b65 6c79 2074 6f20 7265 7475  e likely to retu
-00012a30: 726e 2073 616d 706c 6573 206c 7969 6e67  rn samples lying
-00012a40: 2063 6c6f 7365 2074 6f20 7468 6520 6d65   close to the me
-00012a50: 616e 2c20 7261 7468 6572 0d0a 2020 7468  an, rather..  th
-00012a60: 616e 2074 686f 7365 2066 6172 2061 7761  an those far awa
-00012a70: 792e 0d0a 0d0a 2020 5265 6665 7265 6e63  y.....  Referenc
-00012a80: 6573 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d  es..  ----------
-00012a90: 0d0a 2020 2e2e 205b 315d 2057 696b 6970  ..  .. [1] Wikip
-00012aa0: 6564 6961 2c20 224e 6f72 6d61 6c20 6469  edia, "Normal di
-00012ab0: 7374 7269 6275 7469 6f6e 222c 0d0a 2020  stribution",..  
-00012ac0: 2020 2020 2020 2068 7474 7073 3a2f 2f65         https://e
-00012ad0: 6e2e 7769 6b69 7065 6469 612e 6f72 672f  n.wikipedia.org/
-00012ae0: 7769 6b69 2f4e 6f72 6d61 6c5f 6469 7374  wiki/Normal_dist
-00012af0: 7269 6275 7469 6f6e 0d0a 2020 2e2e 205b  ribution..  .. [
-00012b00: 325d 2050 2e20 522e 2050 6565 626c 6573  2] P. R. Peebles
-00012b10: 204a 722e 2c20 2243 656e 7472 616c 204c   Jr., "Central L
-00012b20: 696d 6974 2054 6865 6f72 656d 2220 696e  imit Theorem" in
-00012b30: 2022 5072 6f62 6162 696c 6974 792c 0d0a   "Probability,..
-00012b40: 2020 2020 2020 2020 2052 616e 646f 6d20           Random 
-00012b50: 5661 7269 6162 6c65 7320 616e 6420 5261  Variables and Ra
-00012b60: 6e64 6f6d 2053 6967 6e61 6c20 5072 696e  ndom Signal Prin
-00012b70: 6369 706c 6573 222c 2034 7468 2065 642e  ciples", 4th ed.
-00012b80: 2c20 3230 3031 2c0d 0a20 2020 2020 2020  , 2001,..       
-00012b90: 2020 7070 2e20 3531 2c20 3531 2c20 3132    pp. 51, 51, 12
-00012ba0: 352e 0d0a 0d0a 2020 4578 616d 706c 6573  5.....  Examples
-00012bb0: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ..  --------..  
-00012bc0: 4472 6177 2073 616d 706c 6573 2066 726f  Draw samples fro
-00012bd0: 6d20 7468 6520 6469 7374 7269 6275 7469  m the distributi
-00012be0: 6f6e 3a0d 0a0d 0a20 203e 3e3e 206d 752c  on:....  >>> mu,
-00012bf0: 2073 6967 6d61 203d 2030 2c20 302e 3120   sigma = 0, 0.1 
-00012c00: 2320 6d65 616e 2061 6e64 2073 7461 6e64  # mean and stand
-00012c10: 6172 6420 6465 7669 6174 696f 6e0d 0a20  ard deviation.. 
-00012c20: 203e 3e3e 2073 203d 2062 632e 7261 6e64   >>> s = bc.rand
-00012c30: 6f6d 2e6e 6f72 6d61 6c28 6d75 2c20 7369  om.normal(mu, si
-00012c40: 676d 612c 2031 3030 3029 0d0a 0d0a 2020  gma, 1000)....  
-00012c50: 5665 7269 6679 2074 6865 206d 6561 6e20  Verify the mean 
-00012c60: 616e 6420 7468 6520 7661 7269 616e 6365  and the variance
-00012c70: 3a0d 0a0d 0a20 203e 3e3e 2061 6273 286d  :....  >>> abs(m
-00012c80: 7520 2d20 6e70 2e6d 6561 6e28 7329 290d  u - np.mean(s)).
-00012c90: 0a20 2030 2e30 2020 2320 6d61 7920 7661  .  0.0  # may va
-00012ca0: 7279 0d0a 0d0a 2020 3e3e 3e20 6162 7328  ry....  >>> abs(
-00012cb0: 7369 676d 6120 2d20 6e70 2e73 7464 2873  sigma - np.std(s
-00012cc0: 2c20 6464 6f66 3d31 2929 0d0a 2020 302e  , ddof=1))..  0.
-00012cd0: 3120 2023 206d 6179 2076 6172 790d 0a0d  1  # may vary...
-00012ce0: 0a20 2044 6973 706c 6179 2074 6865 2068  .  Display the h
-00012cf0: 6973 746f 6772 616d 206f 6620 7468 6520  istogram of the 
-00012d00: 7361 6d70 6c65 732c 2061 6c6f 6e67 2077  samples, along w
-00012d10: 6974 680d 0a20 2074 6865 2070 726f 6261  ith..  the proba
-00012d20: 6269 6c69 7479 2064 656e 7369 7479 2066  bility density f
-00012d30: 756e 6374 696f 6e3a 0d0a 0d0a 2020 3e3e  unction:....  >>
-00012d40: 3e20 696d 706f 7274 206d 6174 706c 6f74  > import matplot
-00012d50: 6c69 622e 7079 706c 6f74 2061 7320 706c  lib.pyplot as pl
-00012d60: 7420 2023 206e 6f71 610d 0a20 203e 3e3e  t  # noqa..  >>>
-00012d70: 2063 6f75 6e74 2c20 6269 6e73 2c20 6967   count, bins, ig
-00012d80: 6e6f 7265 6420 3d20 706c 742e 6869 7374  nored = plt.hist
-00012d90: 2873 2c20 3330 2c20 6465 6e73 6974 793d  (s, 30, density=
-00012da0: 5472 7565 290d 0a20 203e 3e3e 2070 6c74  True)..  >>> plt
-00012db0: 2e70 6c6f 7428 6269 6e73 2c20 312f 2873  .plot(bins, 1/(s
-00012dc0: 6967 6d61 202a 206e 702e 7371 7274 2832  igma * np.sqrt(2
-00012dd0: 202a 206e 702e 7069 2929 202a 0d0a 2020   * np.pi)) *..  
-00012de0: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-00012df0: 2020 206e 702e 6578 7028 202d 2028 6269     np.exp( - (bi
-00012e00: 6e73 202d 206d 7529 2a2a 3220 2f20 2832  ns - mu)**2 / (2
-00012e10: 202a 2073 6967 6d61 2a2a 3229 2029 2c0d   * sigma**2) ),.
-00012e20: 0a20 202e 2e2e 2020 2020 2020 2020 2020  .  ...          
-00012e30: 6c69 6e65 7769 6474 683d 322c 2063 6f6c  linewidth=2, col
-00012e40: 6f72 3d27 7227 290d 0a20 203e 3e3e 2070  or='r')..  >>> p
-00012e50: 6c74 2e73 686f 7728 290d 0a0d 0a20 2054  lt.show()....  T
-00012e60: 776f 2d62 792d 666f 7572 2061 7272 6179  wo-by-four array
-00012e70: 206f 6620 7361 6d70 6c65 7320 6672 6f6d   of samples from
-00012e80: 2074 6865 206e 6f72 6d61 6c20 6469 7374   the normal dist
-00012e90: 7269 6275 7469 6f6e 2077 6974 680d 0a20  ribution with.. 
-00012ea0: 206d 6561 6e20 3320 616e 6420 7374 616e   mean 3 and stan
-00012eb0: 6461 7264 2064 6576 6961 7469 6f6e 2032  dard deviation 2
-00012ec0: 2e35 3a0d 0a0d 0a20 203e 3e3e 2062 632e  .5:....  >>> bc.
-00012ed0: 7261 6e64 6f6d 2e6e 6f72 6d61 6c28 332c  random.normal(3,
-00012ee0: 2032 2e35 2c20 7369 7a65 3d28 322c 2034   2.5, size=(2, 4
-00012ef0: 2929 0d0a 2020 6172 7261 7928 5b5b 2d34  ))..  array([[-4
-00012f00: 2e34 3934 3031 3530 312c 2020 342e 3030  .49401501,  4.00
-00012f10: 3935 3030 3334 2c20 2d31 2e38 3138 3134  950034, -1.81814
-00012f20: 3836 372c 2020 372e 3239 3731 3836 3737  867,  7.29718677
-00012f30: 5d2c 2020 2023 2072 616e 646f 6d0d 0a20  ],   # random.. 
-00012f40: 2020 2020 2020 2020 5b20 302e 3339 3932          [ 0.3992
-00012f50: 3438 3034 2c20 2034 2e36 3834 3536 3331  4804,  4.6845631
-00012f60: 362c 2020 342e 3939 3339 3435 3239 2c20  6,  4.99394529, 
-00012f70: 2034 2e38 3430 3537 3235 345d 5d29 2020   4.84057254]])  
-00012f80: 2320 7261 6e64 6f6d 0d0a 2020 2222 220d  # random..  """.
-00012f90: 0a20 2072 6574 7572 6e20 4445 4641 554c  .  return DEFAUL
-00012fa0: 542e 6e6f 726d 616c 286c 6f63 2c20 7363  T.normal(loc, sc
-00012fb0: 616c 652c 2073 697a 652c 206b 6579 3d6b  ale, size, key=k
-00012fc0: 6579 2c20 6474 7970 653d 6474 7970 6529  ey, dtype=dtype)
-00012fd0: 0d0a 0d0a 0d0a 6465 6620 7061 7265 746f  ......def pareto
-00012fe0: 2861 2c20 7369 7a65 3a20 4f70 7469 6f6e  (a, size: Option
-00012ff0: 616c 5b53 697a 655d 203d 204e 6f6e 652c  al[Size] = None,
-00013000: 206b 6579 3a20 4f70 7469 6f6e 616c 5b53   key: Optional[S
-00013010: 6565 644f 724b 6579 5d20 3d20 4e6f 6e65  eedOrKey] = None
-00013020: 2c20 6474 7970 653a 2044 5479 7065 4c69  , dtype: DTypeLi
-00013030: 6b65 203d 204e 6f6e 6529 3a0d 0a20 2072  ke = None):..  r
-00013040: 2222 220d 0a20 2044 7261 7720 7361 6d70  """..  Draw samp
-00013050: 6c65 7320 6672 6f6d 2061 2050 6172 6574  les from a Paret
-00013060: 6f20 4949 206f 7220 4c6f 6d61 7820 6469  o II or Lomax di
-00013070: 7374 7269 6275 7469 6f6e 2077 6974 680d  stribution with.
-00013080: 0a20 2073 7065 6369 6669 6564 2073 6861  .  specified sha
-00013090: 7065 2e0d 0a0d 0a20 2054 6865 204c 6f6d  pe.....  The Lom
-000130a0: 6178 206f 7220 5061 7265 746f 2049 4920  ax or Pareto II 
-000130b0: 6469 7374 7269 6275 7469 6f6e 2069 7320  distribution is 
-000130c0: 6120 7368 6966 7465 6420 5061 7265 746f  a shifted Pareto
-000130d0: 0d0a 2020 6469 7374 7269 6275 7469 6f6e  ..  distribution
-000130e0: 2e20 5468 6520 636c 6173 7369 6361 6c20  . The classical 
-000130f0: 5061 7265 746f 2064 6973 7472 6962 7574  Pareto distribut
-00013100: 696f 6e20 6361 6e20 6265 0d0a 2020 6f62  ion can be..  ob
-00013110: 7461 696e 6564 2066 726f 6d20 7468 6520  tained from the 
-00013120: 4c6f 6d61 7820 6469 7374 7269 6275 7469  Lomax distributi
-00013130: 6f6e 2062 7920 6164 6469 6e67 2031 2061  on by adding 1 a
-00013140: 6e64 0d0a 2020 6d75 6c74 6970 6c79 696e  nd..  multiplyin
-00013150: 6720 6279 2074 6865 2073 6361 6c65 2070  g by the scale p
-00013160: 6172 616d 6574 6572 2060 606d 6060 2028  arameter ``m`` (
-00013170: 7365 6520 4e6f 7465 7329 2e20 2054 6865  see Notes).  The
-00013180: 0d0a 2020 736d 616c 6c65 7374 2076 616c  ..  smallest val
-00013190: 7565 206f 6620 7468 6520 4c6f 6d61 7820  ue of the Lomax 
-000131a0: 6469 7374 7269 6275 7469 6f6e 2069 7320  distribution is 
-000131b0: 7a65 726f 2077 6869 6c65 2066 6f72 2074  zero while for t
-000131c0: 6865 0d0a 2020 636c 6173 7369 6361 6c20  he..  classical 
-000131d0: 5061 7265 746f 2064 6973 7472 6962 7574  Pareto distribut
-000131e0: 696f 6e20 6974 2069 7320 6060 6d75 6060  ion it is ``mu``
-000131f0: 2c20 7768 6572 6520 7468 6520 7374 616e  , where the stan
-00013200: 6461 7264 0d0a 2020 5061 7265 746f 2064  dard..  Pareto d
-00013210: 6973 7472 6962 7574 696f 6e20 6861 7320  istribution has 
-00013220: 6c6f 6361 7469 6f6e 2060 606d 7520 3d20  location ``mu = 
-00013230: 3160 602e 2020 4c6f 6d61 7820 6361 6e20  1``.  Lomax can 
-00013240: 616c 736f 0d0a 2020 6265 2063 6f6e 7369  also..  be consi
-00013250: 6465 7265 6420 6173 2061 2073 696d 706c  dered as a simpl
-00013260: 6966 6965 6420 7665 7273 696f 6e20 6f66  ified version of
-00013270: 2074 6865 2047 656e 6572 616c 697a 6564   the Generalized
-00013280: 0d0a 2020 5061 7265 746f 2064 6973 7472  ..  Pareto distr
-00013290: 6962 7574 696f 6e20 2861 7661 696c 6162  ibution (availab
-000132a0: 6c65 2069 6e20 5363 6950 7929 2c20 7769  le in SciPy), wi
-000132b0: 7468 2074 6865 2073 6361 6c65 2073 6574  th the scale set
-000132c0: 0d0a 2020 746f 206f 6e65 2061 6e64 2074  ..  to one and t
-000132d0: 6865 206c 6f63 6174 696f 6e20 7365 7420  he location set 
-000132e0: 746f 207a 6572 6f2e 0d0a 0d0a 2020 5468  to zero.....  Th
-000132f0: 6520 5061 7265 746f 2064 6973 7472 6962  e Pareto distrib
-00013300: 7574 696f 6e20 6d75 7374 2062 6520 6772  ution must be gr
-00013310: 6561 7465 7220 7468 616e 207a 6572 6f2c  eater than zero,
-00013320: 2061 6e64 2069 730d 0a20 2075 6e62 6f75   and is..  unbou
-00013330: 6e64 6564 2061 626f 7665 2e20 2049 7420  nded above.  It 
-00013340: 6973 2061 6c73 6f20 6b6e 6f77 6e20 6173  is also known as
-00013350: 2074 6865 2022 3830 2d32 3020 7275 6c65   the "80-20 rule
-00013360: 222e 2020 496e 0d0a 2020 7468 6973 2064  ".  In..  this d
-00013370: 6973 7472 6962 7574 696f 6e2c 2038 3020  istribution, 80 
-00013380: 7065 7263 656e 7420 6f66 2074 6865 2077  percent of the w
-00013390: 6569 6768 7473 2061 7265 2069 6e20 7468  eights are in th
-000133a0: 6520 6c6f 7765 7374 0d0a 2020 3230 2070  e lowest..  20 p
-000133b0: 6572 6365 6e74 206f 6620 7468 6520 7261  ercent of the ra
-000133c0: 6e67 652c 2077 6869 6c65 2074 6865 206f  nge, while the o
-000133d0: 7468 6572 2032 3020 7065 7263 656e 7420  ther 20 percent 
-000133e0: 6669 6c6c 2074 6865 0d0a 2020 7265 6d61  fill the..  rema
-000133f0: 696e 696e 6720 3830 2070 6572 6365 6e74  ining 80 percent
-00013400: 206f 6620 7468 6520 7261 6e67 652e 0d0a   of the range...
-00013410: 0d0a 2020 5061 7261 6d65 7465 7273 0d0a  ..  Parameters..
-00013420: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00013430: 6120 3a20 666c 6f61 7420 6f72 2061 7272  a : float or arr
-00013440: 6179 5f6c 696b 6520 6f66 2066 6c6f 6174  ay_like of float
-00013450: 730d 0a20 2020 2020 2053 6861 7065 206f  s..      Shape o
-00013460: 6620 7468 6520 6469 7374 7269 6275 7469  f the distributi
-00013470: 6f6e 2e20 4d75 7374 2062 6520 706f 7369  on. Must be posi
-00013480: 7469 7665 2e0d 0a20 2073 697a 6520 3a20  tive...  size : 
-00013490: 696e 7420 6f72 2074 7570 6c65 206f 6620  int or tuple of 
-000134a0: 696e 7473 2c20 6f70 7469 6f6e 616c 0d0a  ints, optional..
-000134b0: 2020 2020 2020 4f75 7470 7574 2073 6861        Output sha
-000134c0: 7065 2e20 2049 6620 7468 6520 6769 7665  pe.  If the give
-000134d0: 6e20 7368 6170 6520 6973 2c20 652e 672e  n shape is, e.g.
-000134e0: 2c20 6060 286d 2c20 6e2c 206b 2960 602c  , ``(m, n, k)``,
-000134f0: 2074 6865 6e0d 0a20 2020 2020 2060 606d   then..      ``m
-00013500: 202a 206e 202a 206b 6060 2073 616d 706c   * n * k`` sampl
-00013510: 6573 2061 7265 2064 7261 776e 2e20 2049  es are drawn.  I
-00013520: 6620 7369 7a65 2069 7320 6060 4e6f 6e65  f size is ``None
-00013530: 6060 2028 6465 6661 756c 7429 2c0d 0a20  `` (default),.. 
-00013540: 2020 2020 2061 2073 696e 676c 6520 7661       a single va
-00013550: 6c75 6520 6973 2072 6574 7572 6e65 6420  lue is returned 
-00013560: 6966 2060 6061 6060 2069 7320 6120 7363  if ``a`` is a sc
-00013570: 616c 6172 2e20 204f 7468 6572 7769 7365  alar.  Otherwise
-00013580: 2c0d 0a20 2020 2020 2060 606e 702e 6172  ,..      ``np.ar
-00013590: 7261 7928 6129 2e73 697a 6560 6020 7361  ray(a).size`` sa
-000135a0: 6d70 6c65 7320 6172 6520 6472 6177 6e2e  mples are drawn.
-000135b0: 0d0a 2020 6b65 7920 3a20 5052 4e47 4b65  ..  key : PRNGKe
-000135c0: 792c 206f 7074 696f 6e61 6c0d 0a20 2020  y, optional..   
-000135d0: 2020 2054 6865 206b 6579 2066 6f72 2074     The key for t
-000135e0: 6865 2072 616e 646f 6d20 6e75 6d62 6572  he random number
-000135f0: 2067 656e 6572 6174 6f72 2e20 4966 206e   generator. If n
-00013600: 6f74 2067 6976 656e 2c20 7468 650d 0a20  ot given, the.. 
-00013610: 2020 2020 2064 6566 6175 6c74 2072 616e       default ran
-00013620: 646f 6d20 6e75 6d62 6572 2067 656e 6572  dom number gener
-00013630: 6174 6f72 2069 7320 7573 6564 2e0d 0a0d  ator is used....
-00013640: 0a20 2052 6574 7572 6e73 0d0a 2020 2d2d  .  Returns..  --
-00013650: 2d2d 2d2d 2d0d 0a20 206f 7574 203a 206e  -----..  out : n
-00013660: 6461 7272 6179 206f 7220 7363 616c 6172  darray or scalar
-00013670: 0d0a 2020 2020 2020 4472 6177 6e20 7361  ..      Drawn sa
-00013680: 6d70 6c65 7320 6672 6f6d 2074 6865 2070  mples from the p
-00013690: 6172 616d 6574 6572 697a 6564 2050 6172  arameterized Par
-000136a0: 6574 6f20 6469 7374 7269 6275 7469 6f6e  eto distribution
-000136b0: 2e0d 0a0d 0a20 2053 6565 2041 6c73 6f0d  .....  See Also.
-000136c0: 0a20 202d 2d2d 2d2d 2d2d 2d0d 0a20 2073  .  --------..  s
-000136d0: 6369 7079 2e73 7461 7473 2e6c 6f6d 6178  cipy.stats.lomax
-000136e0: 203a 2070 726f 6261 6269 6c69 7479 2064   : probability d
-000136f0: 656e 7369 7479 2066 756e 6374 696f 6e2c  ensity function,
-00013700: 2064 6973 7472 6962 7574 696f 6e20 6f72   distribution or
-00013710: 0d0a 2020 2020 2020 6375 6d75 6c61 7469  ..      cumulati
-00013720: 7665 2064 656e 7369 7479 2066 756e 6374  ve density funct
-00013730: 696f 6e2c 2065 7463 2e0d 0a20 2073 6369  ion, etc...  sci
-00013740: 7079 2e73 7461 7473 2e67 656e 7061 7265  py.stats.genpare
-00013750: 746f 203a 2070 726f 6261 6269 6c69 7479  to : probability
-00013760: 2064 656e 7369 7479 2066 756e 6374 696f   density functio
-00013770: 6e2c 2064 6973 7472 6962 7574 696f 6e20  n, distribution 
-00013780: 6f72 0d0a 2020 2020 2020 6375 6d75 6c61  or..      cumula
-00013790: 7469 7665 2064 656e 7369 7479 2066 756e  tive density fun
-000137a0: 6374 696f 6e2c 2065 7463 2e0d 0a0d 0a20  ction, etc..... 
-000137b0: 204e 6f74 6573 0d0a 2020 2d2d 2d2d 2d0d   Notes..  -----.
-000137c0: 0a20 2054 6865 2070 726f 6261 6269 6c69  .  The probabili
-000137d0: 7479 2064 656e 7369 7479 2066 6f72 2074  ty density for t
-000137e0: 6865 2050 6172 6574 6f20 6469 7374 7269  he Pareto distri
-000137f0: 6275 7469 6f6e 2069 730d 0a0d 0a20 202e  bution is....  .
-00013800: 2e20 6d61 7468 3a3a 2070 2878 2920 3d20  . math:: p(x) = 
-00013810: 5c66 7261 637b 616d 5e61 7d7b 785e 7b61  \frac{am^a}{x^{a
-00013820: 2b31 7d7d 0d0a 0d0a 2020 7768 6572 6520  +1}}....  where 
-00013830: 3a6d 6174 683a 6061 6020 6973 2074 6865  :math:`a` is the
-00013840: 2073 6861 7065 2061 6e64 203a 6d61 7468   shape and :math
-00013850: 3a60 6d60 2074 6865 2073 6361 6c65 2e0d  :`m` the scale..
-00013860: 0a0d 0a20 2054 6865 2050 6172 6574 6f20  ...  The Pareto 
-00013870: 6469 7374 7269 6275 7469 6f6e 2c20 6e61  distribution, na
-00013880: 6d65 6420 6166 7465 7220 7468 6520 4974  med after the It
-00013890: 616c 6961 6e20 6563 6f6e 6f6d 6973 740d  alian economist.
-000138a0: 0a20 2056 696c 6672 6564 6f20 5061 7265  .  Vilfredo Pare
-000138b0: 746f 2c20 6973 2061 2070 6f77 6572 206c  to, is a power l
-000138c0: 6177 2070 726f 6261 6269 6c69 7479 2064  aw probability d
-000138d0: 6973 7472 6962 7574 696f 6e0d 0a20 2075  istribution..  u
-000138e0: 7365 6675 6c20 696e 206d 616e 7920 7265  seful in many re
-000138f0: 616c 2077 6f72 6c64 2070 726f 626c 656d  al world problem
-00013900: 732e 2020 4f75 7473 6964 6520 7468 6520  s.  Outside the 
-00013910: 6669 656c 6420 6f66 0d0a 2020 6563 6f6e  field of..  econ
-00013920: 6f6d 6963 7320 6974 2069 7320 6765 6e65  omics it is gene
-00013930: 7261 6c6c 7920 7265 6665 7272 6564 2074  rally referred t
-00013940: 6f20 6173 2074 6865 2042 7261 6466 6f72  o as the Bradfor
-00013950: 640d 0a20 2064 6973 7472 6962 7574 696f  d..  distributio
-00013960: 6e2e 2050 6172 6574 6f20 6465 7665 6c6f  n. Pareto develo
-00013970: 7065 6420 7468 6520 6469 7374 7269 6275  ped the distribu
-00013980: 7469 6f6e 2074 6f20 6465 7363 7269 6265  tion to describe
-00013990: 0d0a 2020 7468 6520 6469 7374 7269 6275  ..  the distribu
-000139a0: 7469 6f6e 206f 6620 7765 616c 7468 2069  tion of wealth i
-000139b0: 6e20 616e 2065 636f 6e6f 6d79 2e20 2049  n an economy.  I
-000139c0: 7420 6861 7320 616c 736f 2066 6f75 6e64  t has also found
-000139d0: 0d0a 2020 7573 6520 696e 2069 6e73 7572  ..  use in insur
-000139e0: 616e 6365 2c20 7765 6220 7061 6765 2061  ance, web page a
-000139f0: 6363 6573 7320 7374 6174 6973 7469 6373  ccess statistics
-00013a00: 2c20 6f69 6c20 6669 656c 6420 7369 7a65  , oil field size
-00013a10: 732c 0d0a 2020 616e 6420 6d61 6e79 206f  s,..  and many o
-00013a20: 7468 6572 2070 726f 626c 656d 732c 2069  ther problems, i
-00013a30: 6e63 6c75 6469 6e67 2074 6865 2064 6f77  ncluding the dow
-00013a40: 6e6c 6f61 6420 6672 6571 7565 6e63 7920  nload frequency 
-00013a50: 666f 720d 0a20 2070 726f 6a65 6374 7320  for..  projects 
-00013a60: 696e 2053 6f75 7263 6566 6f72 6765 205b  in Sourceforge [
-00013a70: 315d 5f2e 2020 4974 2069 7320 6f6e 6520  1]_.  It is one 
-00013a80: 6f66 2074 6865 2073 6f2d 6361 6c6c 6564  of the so-called
-00013a90: 0d0a 2020 2266 6174 2d74 6169 6c65 6422  ..  "fat-tailed"
-00013aa0: 2064 6973 7472 6962 7574 696f 6e73 2e0d   distributions..
-00013ab0: 0a0d 0a20 2052 6566 6572 656e 6365 730d  ...  References.
-00013ac0: 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  .  ----------.. 
-00013ad0: 202e 2e20 5b31 5d20 4672 616e 6369 7320   .. [1] Francis 
-00013ae0: 4875 6e74 2061 6e64 2050 6175 6c20 4a6f  Hunt and Paul Jo
-00013af0: 686e 736f 6e2c 204f 6e20 7468 6520 5061  hnson, On the Pa
-00013b00: 7265 746f 2044 6973 7472 6962 7574 696f  reto Distributio
-00013b10: 6e20 6f66 0d0a 2020 2020 2020 2020 2053  n of..         S
-00013b20: 6f75 7263 6566 6f72 6765 2070 726f 6a65  ourceforge proje
-00013b30: 6374 732e 0d0a 2020 2e2e 205b 325d 2050  cts...  .. [2] P
-00013b40: 6172 6574 6f2c 2056 2e20 2831 3839 3629  areto, V. (1896)
-00013b50: 2e20 436f 7572 7365 206f 6620 506f 6c69  . Course of Poli
-00013b60: 7469 6361 6c20 4563 6f6e 6f6d 792e 204c  tical Economy. L
-00013b70: 6175 7361 6e6e 652e 0d0a 2020 2e2e 205b  ausanne...  .. [
-00013b80: 335d 2052 6569 7373 2c20 522e 442e 2c20  3] Reiss, R.D., 
-00013b90: 5468 6f6d 6173 2c20 4d2e 2832 3030 3129  Thomas, M.(2001)
-00013ba0: 2c20 5374 6174 6973 7469 6361 6c20 416e  , Statistical An
-00013bb0: 616c 7973 6973 206f 6620 4578 7472 656d  alysis of Extrem
-00013bc0: 650d 0a20 2020 2020 2020 2020 5661 6c75  e..         Valu
-00013bd0: 6573 2c20 4269 726b 6861 7573 6572 2056  es, Birkhauser V
-00013be0: 6572 6c61 672c 2042 6173 656c 2c20 7070  erlag, Basel, pp
-00013bf0: 2032 332d 3330 2e0d 0a20 202e 2e20 5b34   23-30...  .. [4
-00013c00: 5d20 5769 6b69 7065 6469 612c 2022 5061  ] Wikipedia, "Pa
-00013c10: 7265 746f 2064 6973 7472 6962 7574 696f  reto distributio
-00013c20: 6e22 2c0d 0a20 2020 2020 2020 2020 6874  n",..         ht
-00013c30: 7470 733a 2f2f 656e 2e77 696b 6970 6564  tps://en.wikiped
-00013c40: 6961 2e6f 7267 2f77 696b 692f 5061 7265  ia.org/wiki/Pare
-00013c50: 746f 5f64 6973 7472 6962 7574 696f 6e0d  to_distribution.
-00013c60: 0a0d 0a20 2045 7861 6d70 6c65 730d 0a20  ...  Examples.. 
-00013c70: 202d 2d2d 2d2d 2d2d 2d0d 0a20 2044 7261   --------..  Dra
-00013c80: 7720 7361 6d70 6c65 7320 6672 6f6d 2074  w samples from t
-00013c90: 6865 2064 6973 7472 6962 7574 696f 6e3a  he distribution:
-00013ca0: 0d0a 0d0a 2020 3e3e 3e20 612c 206d 203d  ....  >>> a, m =
-00013cb0: 2033 2e2c 2032 2e20 2023 2073 6861 7065   3., 2.  # shape
-00013cc0: 2061 6e64 206d 6f64 650d 0a20 203e 3e3e   and mode..  >>>
-00013cd0: 2073 203d 2028 6263 2e72 616e 646f 6d2e   s = (bc.random.
-00013ce0: 7061 7265 746f 2861 2c20 3130 3030 2920  pareto(a, 1000) 
-00013cf0: 2b20 3129 202a 206d 0d0a 0d0a 2020 4469  + 1) * m....  Di
-00013d00: 7370 6c61 7920 7468 6520 6869 7374 6f67  splay the histog
-00013d10: 7261 6d20 6f66 2074 6865 2073 616d 706c  ram of the sampl
-00013d20: 6573 2c20 616c 6f6e 6720 7769 7468 2074  es, along with t
-00013d30: 6865 2070 726f 6261 6269 6c69 7479 0d0a  he probability..
-00013d40: 2020 6465 6e73 6974 7920 6675 6e63 7469    density functi
-00013d50: 6f6e 3a0d 0a0d 0a20 203e 3e3e 2069 6d70  on:....  >>> imp
-00013d60: 6f72 7420 6d61 7470 6c6f 746c 6962 2e70  ort matplotlib.p
-00013d70: 7970 6c6f 7420 6173 2070 6c74 2020 2320  yplot as plt  # 
-00013d80: 6e6f 7161 0d0a 2020 3e3e 3e20 636f 756e  noqa..  >>> coun
-00013d90: 742c 2062 696e 732c 205f 203d 2070 6c74  t, bins, _ = plt
-00013da0: 2e68 6973 7428 732c 2031 3030 2c20 6465  .hist(s, 100, de
-00013db0: 6e73 6974 793d 5472 7565 290d 0a20 203e  nsity=True)..  >
-00013dc0: 3e3e 2066 6974 203d 2061 2a6d 2a2a 6120  >> fit = a*m**a 
-00013dd0: 2f20 6269 6e73 2a2a 2861 2b31 290d 0a20  / bins**(a+1).. 
-00013de0: 203e 3e3e 2070 6c74 2e70 6c6f 7428 6269   >>> plt.plot(bi
-00013df0: 6e73 2c20 6d61 7828 636f 756e 7429 2a66  ns, max(count)*f
-00013e00: 6974 2f6d 6178 2866 6974 292c 206c 696e  it/max(fit), lin
-00013e10: 6577 6964 7468 3d32 2c20 636f 6c6f 723d  ewidth=2, color=
-00013e20: 2772 2729 0d0a 2020 3e3e 3e20 706c 742e  'r')..  >>> plt.
-00013e30: 7368 6f77 2829 0d0a 2020 2222 220d 0a20  show()..  """.. 
-00013e40: 2072 6574 7572 6e20 4445 4641 554c 542e   return DEFAULT.
-00013e50: 7061 7265 746f 2861 2c20 7369 7a65 2c20  pareto(a, size, 
-00013e60: 6b65 793d 6b65 792c 2064 7479 7065 3d64  key=key, dtype=d
-00013e70: 7479 7065 290d 0a0d 0a0d 0a64 6566 2070  type)......def p
-00013e80: 6f69 7373 6f6e 286c 616d 3d31 2e30 2c20  oisson(lam=1.0, 
-00013e90: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b53  size: Optional[S
-00013ea0: 697a 655d 203d 204e 6f6e 652c 206b 6579  ize] = None, key
-00013eb0: 3a20 4f70 7469 6f6e 616c 5b53 6565 644f  : Optional[SeedO
-00013ec0: 724b 6579 5d20 3d20 4e6f 6e65 2c20 6474  rKey] = None, dt
-00013ed0: 7970 653a 2044 5479 7065 4c69 6b65 203d  ype: DTypeLike =
-00013ee0: 204e 6f6e 6529 3a0d 0a20 2072 2222 220d   None):..  r""".
-00013ef0: 0a20 2044 7261 7720 7361 6d70 6c65 7320  .  Draw samples 
-00013f00: 6672 6f6d 2061 2050 6f69 7373 6f6e 2064  from a Poisson d
-00013f10: 6973 7472 6962 7574 696f 6e2e 0d0a 0d0a  istribution.....
-00013f20: 2020 5468 6520 506f 6973 736f 6e20 6469    The Poisson di
-00013f30: 7374 7269 6275 7469 6f6e 2069 7320 7468  stribution is th
-00013f40: 6520 6c69 6d69 7420 6f66 2074 6865 2062  e limit of the b
-00013f50: 696e 6f6d 6961 6c20 6469 7374 7269 6275  inomial distribu
-00013f60: 7469 6f6e 0d0a 2020 666f 7220 6c61 7267  tion..  for larg
-00013f70: 6520 4e2e 0d0a 0d0a 2020 5061 7261 6d65  e N.....  Parame
-00013f80: 7465 7273 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ters..  --------
-00013f90: 2d2d 0d0a 2020 6c61 6d20 3a20 666c 6f61  --..  lam : floa
-00013fa0: 7420 6f72 2061 7272 6179 5f6c 696b 6520  t or array_like 
-00013fb0: 6f66 2066 6c6f 6174 730d 0a20 2020 2020  of floats..     
-00013fc0: 2045 7870 6563 7465 6420 6e75 6d62 6572   Expected number
-00013fd0: 206f 6620 6576 656e 7473 206f 6363 7572   of events occur
-00013fe0: 7269 6e67 2069 6e20 6120 6669 7865 642d  ring in a fixed-
-00013ff0: 7469 6d65 2069 6e74 6572 7661 6c2c 0d0a  time interval,..
-00014000: 2020 2020 2020 6d75 7374 2062 6520 3e3d        must be >=
-00014010: 2030 2e20 4120 7365 7175 656e 6365 206d   0. A sequence m
-00014020: 7573 7420 6265 2062 726f 6164 6361 7374  ust be broadcast
-00014030: 6162 6c65 206f 7665 7220 7468 6520 7265  able over the re
-00014040: 7175 6573 7465 640d 0a20 2020 2020 2073  quested..      s
-00014050: 697a 652e 0d0a 2020 7369 7a65 203a 2069  ize...  size : i
-00014060: 6e74 206f 7220 7475 706c 6520 6f66 2069  nt or tuple of i
-00014070: 6e74 732c 206f 7074 696f 6e61 6c0d 0a20  nts, optional.. 
-00014080: 2020 2020 204f 7574 7075 7420 7368 6170       Output shap
-00014090: 652e 2020 4966 2074 6865 2067 6976 656e  e.  If the given
-000140a0: 2073 6861 7065 2069 732c 2065 2e67 2e2c   shape is, e.g.,
-000140b0: 2060 6028 6d2c 206e 2c20 6b29 6060 2c20   ``(m, n, k)``, 
-000140c0: 7468 656e 0d0a 2020 2020 2020 6060 6d20  then..      ``m 
-000140d0: 2a20 6e20 2a20 6b60 6020 7361 6d70 6c65  * n * k`` sample
-000140e0: 7320 6172 6520 6472 6177 6e2e 2020 4966  s are drawn.  If
-000140f0: 2073 697a 6520 6973 2060 604e 6f6e 6560   size is ``None`
-00014100: 6020 2864 6566 6175 6c74 292c 0d0a 2020  ` (default),..  
-00014110: 2020 2020 6120 7369 6e67 6c65 2076 616c      a single val
-00014120: 7565 2069 7320 7265 7475 726e 6564 2069  ue is returned i
-00014130: 6620 6060 6c61 6d60 6020 6973 2061 2073  f ``lam`` is a s
-00014140: 6361 6c61 722e 204f 7468 6572 7769 7365  calar. Otherwise
-00014150: 2c0d 0a20 2020 2020 2060 606e 702e 6172  ,..      ``np.ar
-00014160: 7261 7928 6c61 6d29 2e73 697a 6560 6020  ray(lam).size`` 
-00014170: 7361 6d70 6c65 7320 6172 6520 6472 6177  samples are draw
-00014180: 6e2e 0d0a 2020 6b65 7920 3a20 5052 4e47  n...  key : PRNG
-00014190: 4b65 792c 206f 7074 696f 6e61 6c0d 0a20  Key, optional.. 
-000141a0: 2020 2020 2054 6865 206b 6579 2066 6f72       The key for
-000141b0: 2074 6865 2072 616e 646f 6d20 6e75 6d62   the random numb
-000141c0: 6572 2067 656e 6572 6174 6f72 2e20 4966  er generator. If
-000141d0: 206e 6f74 2067 6976 656e 2c20 7468 650d   not given, the.
-000141e0: 0a20 2020 2020 2064 6566 6175 6c74 2072  .      default r
-000141f0: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
-00014200: 6572 6174 6f72 2069 7320 7573 6564 2e0d  erator is used..
-00014210: 0a0d 0a20 2052 6574 7572 6e73 0d0a 2020  ...  Returns..  
-00014220: 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574 203a  -------..  out :
-00014230: 206e 6461 7272 6179 206f 7220 7363 616c   ndarray or scal
-00014240: 6172 0d0a 2020 2020 2020 4472 6177 6e20  ar..      Drawn 
-00014250: 7361 6d70 6c65 7320 6672 6f6d 2074 6865  samples from the
-00014260: 2070 6172 616d 6574 6572 697a 6564 2050   parameterized P
-00014270: 6f69 7373 6f6e 2064 6973 7472 6962 7574  oisson distribut
-00014280: 696f 6e2e 0d0a 0d0a 2020 4e6f 7465 730d  ion.....  Notes.
-00014290: 0a20 202d 2d2d 2d2d 0d0a 2020 5468 6520  .  -----..  The 
-000142a0: 506f 6973 736f 6e20 6469 7374 7269 6275  Poisson distribu
-000142b0: 7469 6f6e 0d0a 0d0a 2020 2e2e 206d 6174  tion....  .. mat
-000142c0: 683a 3a20 6628 6b3b 205c 6c61 6d62 6461  h:: f(k; \lambda
-000142d0: 293d 5c66 7261 637b 5c6c 616d 6264 615e  )=\frac{\lambda^
-000142e0: 6b20 655e 7b2d 5c6c 616d 6264 617d 7d7b  k e^{-\lambda}}{
-000142f0: 6b21 7d0d 0a0d 0a20 2046 6f72 2065 7665  k!}....  For eve
-00014300: 6e74 7320 7769 7468 2061 6e20 6578 7065  nts with an expe
-00014310: 6374 6564 2073 6570 6172 6174 696f 6e20  cted separation 
-00014320: 3a6d 6174 683a 605c 6c61 6d62 6461 6020  :math:`\lambda` 
-00014330: 7468 6520 506f 6973 736f 6e0d 0a20 2064  the Poisson..  d
-00014340: 6973 7472 6962 7574 696f 6e20 3a6d 6174  istribution :mat
-00014350: 683a 6066 286b 3b20 5c6c 616d 6264 6129  h:`f(k; \lambda)
-00014360: 6020 6465 7363 7269 6265 7320 7468 6520  ` describes the 
-00014370: 7072 6f62 6162 696c 6974 7920 6f66 0d0a  probability of..
-00014380: 2020 3a6d 6174 683a 606b 6020 6576 656e    :math:`k` even
-00014390: 7473 206f 6363 7572 7269 6e67 2077 6974  ts occurring wit
-000143a0: 6869 6e20 7468 6520 6f62 7365 7276 6564  hin the observed
-000143b0: 0d0a 2020 696e 7465 7276 616c 203a 6d61  ..  interval :ma
-000143c0: 7468 3a60 5c6c 616d 6264 6160 2e0d 0a0d  th:`\lambda`....
-000143d0: 0a20 2042 6563 6175 7365 2074 6865 206f  .  Because the o
-000143e0: 7574 7075 7420 6973 206c 696d 6974 6564  utput is limited
-000143f0: 2074 6f20 7468 6520 7261 6e67 6520 6f66   to the range of
-00014400: 2074 6865 2043 2069 6e74 3634 2074 7970   the C int64 typ
-00014410: 652c 2061 0d0a 2020 5661 6c75 6545 7272  e, a..  ValueErr
-00014420: 6f72 2069 7320 7261 6973 6564 2077 6865  or is raised whe
-00014430: 6e20 606c 616d 6020 6973 2077 6974 6869  n `lam` is withi
-00014440: 6e20 3130 2073 6967 6d61 206f 6620 7468  n 10 sigma of th
-00014450: 6520 6d61 7869 6d75 6d0d 0a20 2072 6570  e maximum..  rep
-00014460: 7265 7365 6e74 6162 6c65 2076 616c 7565  resentable value
-00014470: 2e0d 0a0d 0a20 2052 6566 6572 656e 6365  .....  Reference
-00014480: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
-00014490: 0a20 202e 2e20 5b31 5d20 5765 6973 7374  .  .. [1] Weisst
-000144a0: 6569 6e2c 2045 7269 6320 572e 2022 506f  ein, Eric W. "Po
-000144b0: 6973 736f 6e20 4469 7374 7269 6275 7469  isson Distributi
-000144c0: 6f6e 2e22 0d0a 2020 2020 2020 2020 2046  on."..         F
-000144d0: 726f 6d20 4d61 7468 576f 726c 642d 2d41  rom MathWorld--A
-000144e0: 2057 6f6c 6672 616d 2057 6562 2052 6573   Wolfram Web Res
-000144f0: 6f75 7263 652e 0d0a 2020 2020 2020 2020  ource...        
-00014500: 2068 7474 703a 2f2f 6d61 7468 776f 726c   http://mathworl
-00014510: 642e 776f 6c66 7261 6d2e 636f 6d2f 506f  d.wolfram.com/Po
-00014520: 6973 736f 6e44 6973 7472 6962 7574 696f  issonDistributio
-00014530: 6e2e 6874 6d6c 0d0a 2020 2e2e 205b 325d  n.html..  .. [2]
-00014540: 2057 696b 6970 6564 6961 2c20 2250 6f69   Wikipedia, "Poi
-00014550: 7373 6f6e 2064 6973 7472 6962 7574 696f  sson distributio
-00014560: 6e22 2c0d 0a20 2020 2020 2020 2020 6874  n",..         ht
-00014570: 7470 733a 2f2f 656e 2e77 696b 6970 6564  tps://en.wikiped
-00014580: 6961 2e6f 7267 2f77 696b 692f 506f 6973  ia.org/wiki/Pois
-00014590: 736f 6e5f 6469 7374 7269 6275 7469 6f6e  son_distribution
-000145a0: 0d0a 0d0a 2020 4578 616d 706c 6573 0d0a  ....  Examples..
-000145b0: 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020 4472    --------..  Dr
-000145c0: 6177 2073 616d 706c 6573 2066 726f 6d20  aw samples from 
-000145d0: 7468 6520 6469 7374 7269 6275 7469 6f6e  the distribution
-000145e0: 3a0d 0a0d 0a20 203e 3e3e 2069 6d70 6f72  :....  >>> impor
-000145f0: 7420 6e75 6d70 7920 6173 206e 700d 0a20  t numpy as np.. 
-00014600: 203e 3e3e 2073 203d 2062 632e 7261 6e64   >>> s = bc.rand
-00014610: 6f6d 2e70 6f69 7373 6f6e 2835 2c20 3130  om.poisson(5, 10
-00014620: 3030 3029 0d0a 0d0a 2020 4469 7370 6c61  000)....  Displa
-00014630: 7920 6869 7374 6f67 7261 6d20 6f66 2074  y histogram of t
-00014640: 6865 2073 616d 706c 653a 0d0a 0d0a 2020  he sample:....  
-00014650: 3e3e 3e20 696d 706f 7274 206d 6174 706c  >>> import matpl
-00014660: 6f74 6c69 622e 7079 706c 6f74 2061 7320  otlib.pyplot as 
-00014670: 706c 7420 2023 206e 6f71 610d 0a20 203e  plt  # noqa..  >
-00014680: 3e3e 2063 6f75 6e74 2c20 6269 6e73 2c20  >> count, bins, 
-00014690: 6967 6e6f 7265 6420 3d20 706c 742e 6869  ignored = plt.hi
-000146a0: 7374 2873 2c20 3134 2c20 6465 6e73 6974  st(s, 14, densit
-000146b0: 793d 5472 7565 290d 0a20 203e 3e3e 2070  y=True)..  >>> p
-000146c0: 6c74 2e73 686f 7728 290d 0a0d 0a20 2044  lt.show()....  D
-000146d0: 7261 7720 6561 6368 2031 3030 2076 616c  raw each 100 val
-000146e0: 7565 7320 666f 7220 6c61 6d62 6461 2031  ues for lambda 1
-000146f0: 3030 2061 6e64 2035 3030 3a0d 0a0d 0a20  00 and 500:.... 
-00014700: 203e 3e3e 2073 203d 2062 632e 7261 6e64   >>> s = bc.rand
-00014710: 6f6d 2e70 6f69 7373 6f6e 286c 616d 3d28  om.poisson(lam=(
-00014720: 3130 302e 2c20 3530 302e 292c 2073 697a  100., 500.), siz
-00014730: 653d 2831 3030 2c20 3229 290d 0a20 2022  e=(100, 2))..  "
-00014740: 2222 0d0a 2020 7265 7475 726e 2044 4546  ""..  return DEF
-00014750: 4155 4c54 2e70 6f69 7373 6f6e 286c 616d  AULT.poisson(lam
-00014760: 2c20 7369 7a65 2c20 6b65 793d 6b65 792c  , size, key=key,
-00014770: 2064 7479 7065 3d64 7479 7065 290d 0a0d   dtype=dtype)...
-00014780: 0a0d 0a64 6566 2073 7461 6e64 6172 645f  ...def standard_
-00014790: 6361 7563 6879 2873 697a 653a 204f 7074  cauchy(size: Opt
-000147a0: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
-000147b0: 6e65 2c20 6b65 793a 204f 7074 696f 6e61  ne, key: Optiona
-000147c0: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
-000147d0: 6f6e 652c 2064 7479 7065 3a20 4454 7970  one, dtype: DTyp
-000147e0: 654c 696b 6520 3d20 4e6f 6e65 293a 0d0a  eLike = None):..
-000147f0: 2020 7222 2222 0d0a 2020 4472 6177 2073    r"""..  Draw s
-00014800: 616d 706c 6573 2066 726f 6d20 6120 7374  amples from a st
-00014810: 616e 6461 7264 2043 6175 6368 7920 6469  andard Cauchy di
-00014820: 7374 7269 6275 7469 6f6e 2077 6974 6820  stribution with 
-00014830: 6d6f 6465 203d 2030 2e0d 0a0d 0a20 2041  mode = 0.....  A
-00014840: 6c73 6f20 6b6e 6f77 6e20 6173 2074 6865  lso known as the
-00014850: 204c 6f72 656e 747a 2064 6973 7472 6962   Lorentz distrib
-00014860: 7574 696f 6e2e 0d0a 0d0a 2020 5061 7261  ution.....  Para
-00014870: 6d65 7465 7273 0d0a 2020 2d2d 2d2d 2d2d  meters..  ------
-00014880: 2d2d 2d2d 0d0a 2020 7369 7a65 203a 2069  ----..  size : i
-00014890: 6e74 206f 7220 7475 706c 6520 6f66 2069  nt or tuple of i
-000148a0: 6e74 732c 206f 7074 696f 6e61 6c0d 0a20  nts, optional.. 
-000148b0: 2020 2020 204f 7574 7075 7420 7368 6170       Output shap
-000148c0: 652e 2020 4966 2074 6865 2067 6976 656e  e.  If the given
-000148d0: 2073 6861 7065 2069 732c 2065 2e67 2e2c   shape is, e.g.,
-000148e0: 2060 6028 6d2c 206e 2c20 6b29 6060 2c20   ``(m, n, k)``, 
-000148f0: 7468 656e 0d0a 2020 2020 2020 6060 6d20  then..      ``m 
-00014900: 2a20 6e20 2a20 6b60 6020 7361 6d70 6c65  * n * k`` sample
-00014910: 7320 6172 6520 6472 6177 6e2e 2020 4465  s are drawn.  De
-00014920: 6661 756c 7420 6973 204e 6f6e 652c 2069  fault is None, i
-00014930: 6e20 7768 6963 6820 6361 7365 2061 0d0a  n which case a..
-00014940: 2020 2020 2020 7369 6e67 6c65 2076 616c        single val
-00014950: 7565 2069 7320 7265 7475 726e 6564 2e0d  ue is returned..
-00014960: 0a20 206b 6579 203a 2050 524e 474b 6579  .  key : PRNGKey
-00014970: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-00014980: 2020 5468 6520 6b65 7920 666f 7220 7468    The key for th
-00014990: 6520 7261 6e64 6f6d 206e 756d 6265 7220  e random number 
-000149a0: 6765 6e65 7261 746f 722e 2049 6620 6e6f  generator. If no
-000149b0: 7420 6769 7665 6e2c 2074 6865 0d0a 2020  t given, the..  
-000149c0: 2020 2020 6465 6661 756c 7420 7261 6e64      default rand
-000149d0: 6f6d 206e 756d 6265 7220 6765 6e65 7261  om number genera
-000149e0: 746f 7220 6973 2075 7365 642e 0d0a 0d0a  tor is used.....
-000149f0: 2020 5265 7475 726e 730d 0a20 202d 2d2d    Returns..  ---
-00014a00: 2d2d 2d2d 0d0a 2020 7361 6d70 6c65 7320  ----..  samples 
-00014a10: 3a20 6e64 6172 7261 7920 6f72 2073 6361  : ndarray or sca
-00014a20: 6c61 720d 0a20 2020 2020 2054 6865 2064  lar..      The d
-00014a30: 7261 776e 2073 616d 706c 6573 2e0d 0a0d  rawn samples....
-00014a40: 0a20 204e 6f74 6573 0d0a 2020 2d2d 2d2d  .  Notes..  ----
-00014a50: 2d0d 0a20 2054 6865 2070 726f 6261 6269  -..  The probabi
-00014a60: 6c69 7479 2064 656e 7369 7479 2066 756e  lity density fun
-00014a70: 6374 696f 6e20 666f 7220 7468 6520 6675  ction for the fu
-00014a80: 6c6c 2043 6175 6368 7920 6469 7374 7269  ll Cauchy distri
-00014a90: 6275 7469 6f6e 2069 730d 0a0d 0a20 202e  bution is....  .
-00014aa0: 2e20 6d61 7468 3a3a 2050 2878 3b20 785f  . math:: P(x; x_
-00014ab0: 302c 205c 6761 6d6d 6129 203d 205c 6672  0, \gamma) = \fr
-00014ac0: 6163 7b31 7d7b 5c70 6920 5c67 616d 6d61  ac{1}{\pi \gamma
-00014ad0: 205c 6269 676c 5b20 312b 0d0a 2020 2020   \bigl[ 1+..    
-00014ae0: 2020 2020 2020 2020 285c 6672 6163 7b78          (\frac{x
-00014af0: 2d78 5f30 7d7b 5c67 616d 6d61 7d29 5e32  -x_0}{\gamma})^2
-00014b00: 205c 6269 6772 5d20 7d0d 0a0d 0a20 2061   \bigr] }....  a
-00014b10: 6e64 2074 6865 2053 7461 6e64 6172 6420  nd the Standard 
-00014b20: 4361 7563 6879 2064 6973 7472 6962 7574  Cauchy distribut
-00014b30: 696f 6e20 6a75 7374 2073 6574 7320 3a6d  ion just sets :m
-00014b40: 6174 683a 6078 5f30 3d30 6020 616e 640d  ath:`x_0=0` and.
-00014b50: 0a20 203a 6d61 7468 3a60 5c67 616d 6d61  .  :math:`\gamma
-00014b60: 3d31 600d 0a0d 0a20 2054 6865 2043 6175  =1`....  The Cau
-00014b70: 6368 7920 6469 7374 7269 6275 7469 6f6e  chy distribution
-00014b80: 2061 7269 7365 7320 696e 2074 6865 2073   arises in the s
-00014b90: 6f6c 7574 696f 6e20 746f 2074 6865 2064  olution to the d
-00014ba0: 7269 7665 6e20 6861 726d 6f6e 6963 0d0a  riven harmonic..
-00014bb0: 2020 6f73 6369 6c6c 6174 6f72 2070 726f    oscillator pro
-00014bc0: 626c 656d 2c20 616e 6420 616c 736f 2064  blem, and also d
-00014bd0: 6573 6372 6962 6573 2073 7065 6374 7261  escribes spectra
-00014be0: 6c20 6c69 6e65 2062 726f 6164 656e 696e  l line broadenin
-00014bf0: 672e 2049 740d 0a20 2061 6c73 6f20 6465  g. It..  also de
-00014c00: 7363 7269 6265 7320 7468 6520 6469 7374  scribes the dist
-00014c10: 7269 6275 7469 6f6e 206f 6620 7661 6c75  ribution of valu
-00014c20: 6573 2061 7420 7768 6963 6820 6120 6c69  es at which a li
-00014c30: 6e65 2074 696c 7465 6420 6174 0d0a 2020  ne tilted at..  
-00014c40: 6120 7261 6e64 6f6d 2061 6e67 6c65 2077  a random angle w
-00014c50: 696c 6c20 6375 7420 7468 6520 7820 6178  ill cut the x ax
-00014c60: 6973 2e0d 0a0d 0a20 2057 6865 6e20 7374  is.....  When st
-00014c70: 7564 7969 6e67 2068 7970 6f74 6865 7369  udying hypothesi
-00014c80: 7320 7465 7374 7320 7468 6174 2061 7373  s tests that ass
-00014c90: 756d 6520 6e6f 726d 616c 6974 792c 2073  ume normality, s
-00014ca0: 6565 696e 6720 686f 7720 7468 650d 0a20  eeing how the.. 
-00014cb0: 2074 6573 7473 2070 6572 666f 726d 206f   tests perform o
-00014cc0: 6e20 6461 7461 2066 726f 6d20 6120 4361  n data from a Ca
-00014cd0: 7563 6879 2064 6973 7472 6962 7574 696f  uchy distributio
-00014ce0: 6e20 6973 2061 2067 6f6f 6420 696e 6469  n is a good indi
-00014cf0: 6361 746f 7220 6f66 0d0a 2020 7468 6569  cator of..  thei
-00014d00: 7220 7365 6e73 6974 6976 6974 7920 746f  r sensitivity to
-00014d10: 2061 2068 6561 7679 2d74 6169 6c65 6420   a heavy-tailed 
-00014d20: 6469 7374 7269 6275 7469 6f6e 2c20 7369  distribution, si
-00014d30: 6e63 6520 7468 6520 4361 7563 6879 206c  nce the Cauchy l
-00014d40: 6f6f 6b73 0d0a 2020 7665 7279 206d 7563  ooks..  very muc
-00014d50: 6820 6c69 6b65 2061 2047 6175 7373 6961  h like a Gaussia
-00014d60: 6e20 6469 7374 7269 6275 7469 6f6e 2c20  n distribution, 
-00014d70: 6275 7420 7769 7468 2068 6561 7669 6572  but with heavier
-00014d80: 2074 6169 6c73 2e0d 0a0d 0a20 2052 6566   tails.....  Ref
-00014d90: 6572 656e 6365 730d 0a20 202d 2d2d 2d2d  erences..  -----
-00014da0: 2d2d 2d2d 2d0d 0a20 202e 2e20 5b31 5d20  -----..  .. [1] 
-00014db0: 4e49 5354 2f53 454d 4154 4543 4820 652d  NIST/SEMATECH e-
-00014dc0: 4861 6e64 626f 6f6b 206f 6620 5374 6174  Handbook of Stat
-00014dd0: 6973 7469 6361 6c20 4d65 7468 6f64 732c  istical Methods,
-00014de0: 2022 4361 7563 6879 0d0a 2020 2020 2020   "Cauchy..      
-00014df0: 2020 4469 7374 7269 6275 7469 6f6e 222c    Distribution",
-00014e00: 0d0a 2020 2020 2020 2020 6874 7470 733a  ..        https:
-00014e10: 2f2f 7777 772e 6974 6c2e 6e69 7374 2e67  //www.itl.nist.g
-00014e20: 6f76 2f64 6976 3839 382f 6861 6e64 626f  ov/div898/handbo
-00014e30: 6f6b 2f65 6461 2f73 6563 7469 6f6e 332f  ok/eda/section3/
-00014e40: 6564 6133 3636 332e 6874 6d0d 0a20 202e  eda3663.htm..  .
-00014e50: 2e20 5b32 5d20 5765 6973 7374 6569 6e2c  . [2] Weisstein,
-00014e60: 2045 7269 6320 572e 2022 4361 7563 6879   Eric W. "Cauchy
-00014e70: 2044 6973 7472 6962 7574 696f 6e2e 2220   Distribution." 
-00014e80: 4672 6f6d 204d 6174 6857 6f72 6c64 2d2d  From MathWorld--
-00014e90: 410d 0a20 2020 2020 2020 2057 6f6c 6672  A..        Wolfr
-00014ea0: 616d 2057 6562 2052 6573 6f75 7263 652e  am Web Resource.
-00014eb0: 0d0a 2020 2020 2020 2020 6874 7470 3a2f  ..        http:/
-00014ec0: 2f6d 6174 6877 6f72 6c64 2e77 6f6c 6672  /mathworld.wolfr
-00014ed0: 616d 2e63 6f6d 2f43 6175 6368 7944 6973  am.com/CauchyDis
-00014ee0: 7472 6962 7574 696f 6e2e 6874 6d6c 0d0a  tribution.html..
-00014ef0: 2020 2e2e 205b 335d 2057 696b 6970 6564    .. [3] Wikiped
-00014f00: 6961 2c20 2243 6175 6368 7920 6469 7374  ia, "Cauchy dist
-00014f10: 7269 6275 7469 6f6e 220d 0a20 2020 2020  ribution"..     
-00014f20: 2020 2068 7474 7073 3a2f 2f65 6e2e 7769     https://en.wi
-00014f30: 6b69 7065 6469 612e 6f72 672f 7769 6b69  kipedia.org/wiki
-00014f40: 2f43 6175 6368 795f 6469 7374 7269 6275  /Cauchy_distribu
-00014f50: 7469 6f6e 0d0a 0d0a 2020 4578 616d 706c  tion....  Exampl
-00014f60: 6573 0d0a 2020 2d2d 2d2d 2d2d 2d2d 0d0a  es..  --------..
-00014f70: 2020 4472 6177 2073 616d 706c 6573 2061    Draw samples a
-00014f80: 6e64 2070 6c6f 7420 7468 6520 6469 7374  nd plot the dist
-00014f90: 7269 6275 7469 6f6e 3a0d 0a0d 0a20 203e  ribution:....  >
-00014fa0: 3e3e 2069 6d70 6f72 7420 6d61 7470 6c6f  >> import matplo
-00014fb0: 746c 6962 2e70 7970 6c6f 7420 6173 2070  tlib.pyplot as p
-00014fc0: 6c74 2020 2320 6e6f 7161 0d0a 2020 3e3e  lt  # noqa..  >>
-00014fd0: 3e20 7320 3d20 6263 2e72 616e 646f 6d2e  > s = bc.random.
-00014fe0: 7374 616e 6461 7264 5f63 6175 6368 7928  standard_cauchy(
-00014ff0: 3130 3030 3030 3029 0d0a 2020 3e3e 3e20  1000000)..  >>> 
-00015000: 7320 3d20 735b 2873 3e2d 3235 2920 2620  s = s[(s>-25) & 
-00015010: 2873 3c32 3529 5d20 2023 2074 7275 6e63  (s<25)]  # trunc
-00015020: 6174 6520 6469 7374 7269 6275 7469 6f6e  ate distribution
-00015030: 2073 6f20 6974 2070 6c6f 7473 2077 656c   so it plots wel
-00015040: 6c0d 0a20 203e 3e3e 2070 6c74 2e68 6973  l..  >>> plt.his
-00015050: 7428 732c 2062 696e 733d 3130 3029 0d0a  t(s, bins=100)..
-00015060: 2020 3e3e 3e20 706c 742e 7368 6f77 2829    >>> plt.show()
-00015070: 0d0a 2020 2222 220d 0a20 2072 6574 7572  ..  """..  retur
-00015080: 6e20 4445 4641 554c 542e 7374 616e 6461  n DEFAULT.standa
-00015090: 7264 5f63 6175 6368 7928 7369 7a65 2c20  rd_cauchy(size, 
-000150a0: 6b65 793d 6b65 792c 2064 7479 7065 3d64  key=key, dtype=d
-000150b0: 7479 7065 290d 0a0d 0a0d 0a64 6566 2073  type)......def s
-000150c0: 7461 6e64 6172 645f 6578 706f 6e65 6e74  tandard_exponent
-000150d0: 6961 6c28 7369 7a65 3a20 4f70 7469 6f6e  ial(size: Option
-000150e0: 616c 5b53 697a 655d 203d 204e 6f6e 652c  al[Size] = None,
-000150f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00015100: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
-00015110: 4f70 7469 6f6e 616c 5b53 6565 644f 724b  Optional[SeedOrK
-00015120: 6579 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ey] = None,..   
-00015130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015140: 2020 2020 2020 6474 7970 653a 2044 5479        dtype: DTy
-00015150: 7065 4c69 6b65 203d 204e 6f6e 6529 3a0d  peLike = None):.
-00015160: 0a20 2072 2222 220d 0a20 2044 7261 7720  .  r"""..  Draw 
-00015170: 7361 6d70 6c65 7320 6672 6f6d 2074 6865  samples from the
-00015180: 2073 7461 6e64 6172 6420 6578 706f 6e65   standard expone
-00015190: 6e74 6961 6c20 6469 7374 7269 6275 7469  ntial distributi
-000151a0: 6f6e 2e0d 0a0d 0a20 2060 7374 616e 6461  on.....  `standa
-000151b0: 7264 5f65 7870 6f6e 656e 7469 616c 6020  rd_exponential` 
-000151c0: 6973 2069 6465 6e74 6963 616c 2074 6f20  is identical to 
-000151d0: 7468 6520 6578 706f 6e65 6e74 6961 6c20  the exponential 
-000151e0: 6469 7374 7269 6275 7469 6f6e 0d0a 2020  distribution..  
-000151f0: 7769 7468 2061 2073 6361 6c65 2070 6172  with a scale par
-00015200: 616d 6574 6572 206f 6620 312e 0d0a 0d0a  ameter of 1.....
-00015210: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-00015220: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 7369  ----------..  si
-00015230: 7a65 203a 2069 6e74 206f 7220 7475 706c  ze : int or tupl
-00015240: 6520 6f66 2069 6e74 732c 206f 7074 696f  e of ints, optio
-00015250: 6e61 6c0d 0a20 2020 2020 204f 7574 7075  nal..      Outpu
-00015260: 7420 7368 6170 652e 2020 4966 2074 6865  t shape.  If the
-00015270: 2067 6976 656e 2073 6861 7065 2069 732c   given shape is,
-00015280: 2065 2e67 2e2c 2060 6028 6d2c 206e 2c20   e.g., ``(m, n, 
-00015290: 6b29 6060 2c20 7468 656e 0d0a 2020 2020  k)``, then..    
-000152a0: 2020 6060 6d20 2a20 6e20 2a20 6b60 6020    ``m * n * k`` 
-000152b0: 7361 6d70 6c65 7320 6172 6520 6472 6177  samples are draw
-000152c0: 6e2e 2020 4465 6661 756c 7420 6973 204e  n.  Default is N
-000152d0: 6f6e 652c 2069 6e20 7768 6963 6820 6361  one, in which ca
-000152e0: 7365 2061 0d0a 2020 2020 2020 7369 6e67  se a..      sing
-000152f0: 6c65 2076 616c 7565 2069 7320 7265 7475  le value is retu
-00015300: 726e 6564 2e0d 0a20 206b 6579 203a 2050  rned...  key : P
-00015310: 524e 474b 6579 2c20 6f70 7469 6f6e 616c  RNGKey, optional
-00015320: 0d0a 2020 2020 2020 5468 6520 6b65 7920  ..      The key 
-00015330: 666f 7220 7468 6520 7261 6e64 6f6d 206e  for the random n
-00015340: 756d 6265 7220 6765 6e65 7261 746f 722e  umber generator.
-00015350: 2049 6620 6e6f 7420 6769 7665 6e2c 2074   If not given, t
-00015360: 6865 0d0a 2020 2020 2020 6465 6661 756c  he..      defaul
-00015370: 7420 7261 6e64 6f6d 206e 756d 6265 7220  t random number 
-00015380: 6765 6e65 7261 746f 7220 6973 2075 7365  generator is use
-00015390: 642e 0d0a 0d0a 2020 5265 7475 726e 730d  d.....  Returns.
-000153a0: 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020 6f75  .  -------..  ou
-000153b0: 7420 3a20 666c 6f61 7420 6f72 206e 6461  t : float or nda
-000153c0: 7272 6179 0d0a 2020 2020 2020 4472 6177  rray..      Draw
-000153d0: 6e20 7361 6d70 6c65 732e 0d0a 0d0a 2020  n samples.....  
-000153e0: 4578 616d 706c 6573 0d0a 2020 2d2d 2d2d  Examples..  ----
-000153f0: 2d2d 2d2d 0d0a 2020 4f75 7470 7574 2061  ----..  Output a
-00015400: 2033 7838 3030 3020 6172 7261 793a 0d0a   3x8000 array:..
-00015410: 0d0a 2020 3e3e 3e20 6e20 3d20 6263 2e72  ..  >>> n = bc.r
-00015420: 616e 646f 6d2e 7374 616e 6461 7264 5f65  andom.standard_e
-00015430: 7870 6f6e 656e 7469 616c 2828 332c 2038  xponential((3, 8
-00015440: 3030 3029 290d 0a20 2022 2222 0d0a 2020  000))..  """..  
-00015450: 7265 7475 726e 2044 4546 4155 4c54 2e73  return DEFAULT.s
-00015460: 7461 6e64 6172 645f 6578 706f 6e65 6e74  tandard_exponent
-00015470: 6961 6c28 7369 7a65 2c20 6b65 793d 6b65  ial(size, key=ke
-00015480: 792c 2064 7479 7065 3d64 7479 7065 290d  y, dtype=dtype).
-00015490: 0a0d 0a0d 0a64 6566 2073 7461 6e64 6172  .....def standar
-000154a0: 645f 6761 6d6d 6128 7368 6170 652c 2073  d_gamma(shape, s
-000154b0: 697a 653a 204f 7074 696f 6e61 6c5b 5369  ize: Optional[Si
-000154c0: 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ze] = None,..   
-000154d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000154e0: 6b65 793a 204f 7074 696f 6e61 6c5b 5365  key: Optional[Se
-000154f0: 6564 4f72 4b65 795d 203d 204e 6f6e 652c  edOrKey] = None,
-00015500: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00015510: 2020 2020 2064 7479 7065 3a20 4454 7970       dtype: DTyp
-00015520: 654c 696b 6520 3d20 4e6f 6e65 293a 0d0a  eLike = None):..
-00015530: 2020 7222 2222 0d0a 2020 4472 6177 2073    r"""..  Draw s
-00015540: 616d 706c 6573 2066 726f 6d20 6120 7374  amples from a st
-00015550: 616e 6461 7264 2047 616d 6d61 2064 6973  andard Gamma dis
-00015560: 7472 6962 7574 696f 6e2e 0d0a 0d0a 2020  tribution.....  
-00015570: 5361 6d70 6c65 7320 6172 6520 6472 6177  Samples are draw
-00015580: 6e20 6672 6f6d 2061 2047 616d 6d61 2064  n from a Gamma d
-00015590: 6973 7472 6962 7574 696f 6e20 7769 7468  istribution with
-000155a0: 2073 7065 6369 6669 6564 2070 6172 616d   specified param
-000155b0: 6574 6572 732c 0d0a 2020 7368 6170 6520  eters,..  shape 
-000155c0: 2873 6f6d 6574 696d 6573 2064 6573 6967  (sometimes desig
-000155d0: 6e61 7465 6420 226b 2229 2061 6e64 2073  nated "k") and s
-000155e0: 6361 6c65 3d31 2e0d 0a0d 0a20 2050 6172  cale=1.....  Par
-000155f0: 616d 6574 6572 730d 0a20 202d 2d2d 2d2d  ameters..  -----
-00015600: 2d2d 2d2d 2d0d 0a20 2073 6861 7065 203a  -----..  shape :
-00015610: 2066 6c6f 6174 206f 7220 6172 7261 795f   float or array_
-00015620: 6c69 6b65 206f 6620 666c 6f61 7473 0d0a  like of floats..
-00015630: 2020 2020 2020 5061 7261 6d65 7465 722c        Parameter,
-00015640: 206d 7573 7420 6265 206e 6f6e 2d6e 6567   must be non-neg
-00015650: 6174 6976 652e 0d0a 2020 7369 7a65 203a  ative...  size :
-00015660: 2069 6e74 206f 7220 7475 706c 6520 6f66   int or tuple of
-00015670: 2069 6e74 732c 206f 7074 696f 6e61 6c0d   ints, optional.
-00015680: 0a20 2020 2020 204f 7574 7075 7420 7368  .      Output sh
-00015690: 6170 652e 2020 4966 2074 6865 2067 6976  ape.  If the giv
-000156a0: 656e 2073 6861 7065 2069 732c 2065 2e67  en shape is, e.g
-000156b0: 2e2c 2060 6028 6d2c 206e 2c20 6b29 6060  ., ``(m, n, k)``
-000156c0: 2c20 7468 656e 0d0a 2020 2020 2020 6060  , then..      ``
-000156d0: 6d20 2a20 6e20 2a20 6b60 6020 7361 6d70  m * n * k`` samp
-000156e0: 6c65 7320 6172 6520 6472 6177 6e2e 2020  les are drawn.  
-000156f0: 4966 2073 697a 6520 6973 2060 604e 6f6e  If size is ``Non
-00015700: 6560 6020 2864 6566 6175 6c74 292c 0d0a  e`` (default),..
-00015710: 2020 2020 2020 6120 7369 6e67 6c65 2076        a single v
-00015720: 616c 7565 2069 7320 7265 7475 726e 6564  alue is returned
-00015730: 2069 6620 6060 7368 6170 6560 6020 6973   if ``shape`` is
-00015740: 2061 2073 6361 6c61 722e 2020 4f74 6865   a scalar.  Othe
-00015750: 7277 6973 652c 0d0a 2020 2020 2020 6060  rwise,..      ``
-00015760: 6e70 2e61 7272 6179 2873 6861 7065 292e  np.array(shape).
-00015770: 7369 7a65 6060 2073 616d 706c 6573 2061  size`` samples a
-00015780: 7265 2064 7261 776e 2e0d 0a20 206b 6579  re drawn...  key
-00015790: 203a 2050 524e 474b 6579 2c20 6f70 7469   : PRNGKey, opti
-000157a0: 6f6e 616c 0d0a 2020 2020 2020 5468 6520  onal..      The 
-000157b0: 6b65 7920 666f 7220 7468 6520 7261 6e64  key for the rand
-000157c0: 6f6d 206e 756d 6265 7220 6765 6e65 7261  om number genera
-000157d0: 746f 722e 2049 6620 6e6f 7420 6769 7665  tor. If not give
-000157e0: 6e2c 2074 6865 0d0a 2020 2020 2020 6465  n, the..      de
-000157f0: 6661 756c 7420 7261 6e64 6f6d 206e 756d  fault random num
-00015800: 6265 7220 6765 6e65 7261 746f 7220 6973  ber generator is
-00015810: 2075 7365 642e 0d0a 0d0a 2020 5265 7475   used.....  Retu
-00015820: 726e 730d 0a20 202d 2d2d 2d2d 2d2d 0d0a  rns..  -------..
-00015830: 2020 6f75 7420 3a20 6e64 6172 7261 7920    out : ndarray 
-00015840: 6f72 2073 6361 6c61 720d 0a20 2020 2020  or scalar..     
-00015850: 2044 7261 776e 2073 616d 706c 6573 2066   Drawn samples f
-00015860: 726f 6d20 7468 6520 7061 7261 6d65 7465  rom the paramete
-00015870: 7269 7a65 6420 7374 616e 6461 7264 2067  rized standard g
-00015880: 616d 6d61 2064 6973 7472 6962 7574 696f  amma distributio
-00015890: 6e2e 0d0a 0d0a 2020 5365 6520 416c 736f  n.....  See Also
-000158a0: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ..  --------..  
-000158b0: 7363 6970 792e 7374 6174 732e 6761 6d6d  scipy.stats.gamm
-000158c0: 6120 3a20 7072 6f62 6162 696c 6974 7920  a : probability 
-000158d0: 6465 6e73 6974 7920 6675 6e63 7469 6f6e  density function
-000158e0: 2c20 6469 7374 7269 6275 7469 6f6e 206f  , distribution o
-000158f0: 720d 0a20 2020 2020 2063 756d 756c 6174  r..      cumulat
-00015900: 6976 6520 6465 6e73 6974 7920 6675 6e63  ive density func
-00015910: 7469 6f6e 2c20 6574 632e 0d0a 0d0a 2020  tion, etc.....  
-00015920: 4e6f 7465 730d 0a20 202d 2d2d 2d2d 0d0a  Notes..  -----..
-00015930: 2020 5468 6520 7072 6f62 6162 696c 6974    The probabilit
-00015940: 7920 6465 6e73 6974 7920 666f 7220 7468  y density for th
-00015950: 6520 4761 6d6d 6120 6469 7374 7269 6275  e Gamma distribu
-00015960: 7469 6f6e 2069 730d 0a0d 0a20 202e 2e20  tion is....  .. 
-00015970: 6d61 7468 3a3a 2070 2878 2920 3d20 785e  math:: p(x) = x^
-00015980: 7b6b 2d31 7d5c 6672 6163 7b65 5e7b 2d78  {k-1}\frac{e^{-x
-00015990: 2f5c 7468 6574 617d 7d7b 5c74 6865 7461  /\theta}}{\theta
-000159a0: 5e6b 5c47 616d 6d61 286b 297d 2c0d 0a0d  ^k\Gamma(k)},...
-000159b0: 0a20 2077 6865 7265 203a 6d61 7468 3a60  .  where :math:`
-000159c0: 6b60 2069 7320 7468 6520 7368 6170 6520  k` is the shape 
-000159d0: 616e 6420 3a6d 6174 683a 605c 7468 6574  and :math:`\thet
-000159e0: 6160 2074 6865 2073 6361 6c65 2c0d 0a20  a` the scale,.. 
-000159f0: 2061 6e64 203a 6d61 7468 3a60 5c47 616d   and :math:`\Gam
-00015a00: 6d61 6020 6973 2074 6865 2047 616d 6d61  ma` is the Gamma
-00015a10: 2066 756e 6374 696f 6e2e 0d0a 0d0a 2020   function.....  
-00015a20: 5468 6520 4761 6d6d 6120 6469 7374 7269  The Gamma distri
-00015a30: 6275 7469 6f6e 2069 7320 6f66 7465 6e20  bution is often 
-00015a40: 7573 6564 2074 6f20 6d6f 6465 6c20 7468  used to model th
-00015a50: 6520 7469 6d65 7320 746f 2066 6169 6c75  e times to failu
-00015a60: 7265 206f 660d 0a20 2065 6c65 6374 726f  re of..  electro
-00015a70: 6e69 6320 636f 6d70 6f6e 656e 7473 2c20  nic components, 
-00015a80: 616e 6420 6172 6973 6573 206e 6174 7572  and arises natur
-00015a90: 616c 6c79 2069 6e20 7072 6f63 6573 7365  ally in processe
-00015aa0: 7320 666f 7220 7768 6963 6820 7468 650d  s for which the.
-00015ab0: 0a20 2077 6169 7469 6e67 2074 696d 6573  .  waiting times
-00015ac0: 2062 6574 7765 656e 2050 6f69 7373 6f6e   between Poisson
-00015ad0: 2064 6973 7472 6962 7574 6564 2065 7665   distributed eve
-00015ae0: 6e74 7320 6172 6520 7265 6c65 7661 6e74  nts are relevant
-00015af0: 2e0d 0a0d 0a20 2052 6566 6572 656e 6365  .....  Reference
-00015b00: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
-00015b10: 0a20 202e 2e20 5b31 5d20 5765 6973 7374  .  .. [1] Weisst
-00015b20: 6569 6e2c 2045 7269 6320 572e 2022 4761  ein, Eric W. "Ga
-00015b30: 6d6d 6120 4469 7374 7269 6275 7469 6f6e  mma Distribution
-00015b40: 2e22 2046 726f 6d20 4d61 7468 576f 726c  ." From MathWorl
-00015b50: 642d 2d41 0d0a 2020 2020 2020 2020 2057  d--A..         W
-00015b60: 6f6c 6672 616d 2057 6562 2052 6573 6f75  olfram Web Resou
-00015b70: 7263 652e 0d0a 2020 2020 2020 2020 2068  rce...         h
-00015b80: 7474 703a 2f2f 6d61 7468 776f 726c 642e  ttp://mathworld.
-00015b90: 776f 6c66 7261 6d2e 636f 6d2f 4761 6d6d  wolfram.com/Gamm
-00015ba0: 6144 6973 7472 6962 7574 696f 6e2e 6874  aDistribution.ht
-00015bb0: 6d6c 0d0a 2020 2e2e 205b 325d 2057 696b  ml..  .. [2] Wik
-00015bc0: 6970 6564 6961 2c20 2247 616d 6d61 2064  ipedia, "Gamma d
-00015bd0: 6973 7472 6962 7574 696f 6e22 2c0d 0a20  istribution",.. 
-00015be0: 2020 2020 2020 2020 6874 7470 733a 2f2f          https://
-00015bf0: 656e 2e77 696b 6970 6564 6961 2e6f 7267  en.wikipedia.org
-00015c00: 2f77 696b 692f 4761 6d6d 615f 6469 7374  /wiki/Gamma_dist
-00015c10: 7269 6275 7469 6f6e 0d0a 0d0a 2020 4578  ribution....  Ex
-00015c20: 616d 706c 6573 0d0a 2020 2d2d 2d2d 2d2d  amples..  ------
-00015c30: 2d2d 0d0a 2020 4472 6177 2073 616d 706c  --..  Draw sampl
-00015c40: 6573 2066 726f 6d20 7468 6520 6469 7374  es from the dist
-00015c50: 7269 6275 7469 6f6e 3a0d 0a0d 0a20 203e  ribution:....  >
-00015c60: 3e3e 2073 6861 7065 2c20 7363 616c 6520  >> shape, scale 
-00015c70: 3d20 322e 2c20 312e 2023 206d 6561 6e20  = 2., 1. # mean 
-00015c80: 616e 6420 7769 6474 680d 0a20 203e 3e3e  and width..  >>>
-00015c90: 2073 203d 2062 632e 7261 6e64 6f6d 2e73   s = bc.random.s
-00015ca0: 7461 6e64 6172 645f 6761 6d6d 6128 7368  tandard_gamma(sh
-00015cb0: 6170 652c 2031 3030 3030 3030 290d 0a0d  ape, 1000000)...
-00015cc0: 0a20 2044 6973 706c 6179 2074 6865 2068  .  Display the h
-00015cd0: 6973 746f 6772 616d 206f 6620 7468 6520  istogram of the 
-00015ce0: 7361 6d70 6c65 732c 2061 6c6f 6e67 2077  samples, along w
-00015cf0: 6974 680d 0a20 2074 6865 2070 726f 6261  ith..  the proba
-00015d00: 6269 6c69 7479 2064 656e 7369 7479 2066  bility density f
-00015d10: 756e 6374 696f 6e3a 0d0a 0d0a 2020 3e3e  unction:....  >>
-00015d20: 3e20 696d 706f 7274 206d 6174 706c 6f74  > import matplot
-00015d30: 6c69 622e 7079 706c 6f74 2061 7320 706c  lib.pyplot as pl
-00015d40: 7420 2023 206e 6f71 610d 0a20 203e 3e3e  t  # noqa..  >>>
-00015d50: 2069 6d70 6f72 7420 7363 6970 792e 7370   import scipy.sp
-00015d60: 6563 6961 6c20 6173 2073 7073 2020 2320  ecial as sps  # 
-00015d70: 646f 6374 6573 743a 202b 534b 4950 0d0a  doctest: +SKIP..
-00015d80: 2020 3e3e 3e20 636f 756e 742c 2062 696e    >>> count, bin
-00015d90: 732c 2069 676e 6f72 6564 203d 2070 6c74  s, ignored = plt
-00015da0: 2e68 6973 7428 732c 2035 302c 2064 656e  .hist(s, 50, den
-00015db0: 7369 7479 3d54 7275 6529 0d0a 2020 3e3e  sity=True)..  >>
-00015dc0: 3e20 7920 3d20 6269 6e73 2a2a 2873 6861  > y = bins**(sha
-00015dd0: 7065 2d31 2920 2a20 2828 6e70 2e65 7870  pe-1) * ((np.exp
-00015de0: 282d 6269 6e73 2f73 6361 6c65 2929 2f20  (-bins/scale))/ 
-00015df0: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
-00015e00: 500d 0a20 202e 2e2e 2020 2020 2020 2020  P..  ...        
-00015e10: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-00015e20: 7370 732e 6761 6d6d 6128 7368 6170 6529  sps.gamma(shape)
-00015e30: 202a 2073 6361 6c65 2a2a 7368 6170 6529   * scale**shape)
-00015e40: 290d 0a20 203e 3e3e 2070 6c74 2e70 6c6f  )..  >>> plt.plo
-00015e50: 7428 6269 6e73 2c20 792c 206c 696e 6577  t(bins, y, linew
-00015e60: 6964 7468 3d32 2c20 636f 6c6f 723d 2772  idth=2, color='r
-00015e70: 2729 2020 2320 646f 6374 6573 743a 202b  ')  # doctest: +
-00015e80: 534b 4950 0d0a 2020 3e3e 3e20 706c 742e  SKIP..  >>> plt.
-00015e90: 7368 6f77 2829 0d0a 2020 2222 220d 0a20  show()..  """.. 
-00015ea0: 2072 6574 7572 6e20 4445 4641 554c 542e   return DEFAULT.
-00015eb0: 7374 616e 6461 7264 5f67 616d 6d61 2873  standard_gamma(s
-00015ec0: 6861 7065 2c20 7369 7a65 2c20 6b65 793d  hape, size, key=
-00015ed0: 6b65 792c 2064 7479 7065 3d64 7479 7065  key, dtype=dtype
-00015ee0: 290d 0a0d 0a0d 0a64 6566 2073 7461 6e64  )......def stand
-00015ef0: 6172 645f 6e6f 726d 616c 2873 697a 653a  ard_normal(size:
-00015f00: 204f 7074 696f 6e61 6c5b 5369 7a65 5d20   Optional[Size] 
-00015f10: 3d20 4e6f 6e65 2c20 6b65 793a 204f 7074  = None, key: Opt
-00015f20: 696f 6e61 6c5b 5365 6564 4f72 4b65 795d  ional[SeedOrKey]
-00015f30: 203d 204e 6f6e 652c 2064 7479 7065 3a20   = None, dtype: 
-00015f40: 4454 7970 654c 696b 6520 3d20 4e6f 6e65  DTypeLike = None
-00015f50: 293a 0d0a 2020 7222 2222 0d0a 2020 4472  ):..  r"""..  Dr
-00015f60: 6177 2073 616d 706c 6573 2066 726f 6d20  aw samples from 
-00015f70: 6120 7374 616e 6461 7264 204e 6f72 6d61  a standard Norma
-00015f80: 6c20 6469 7374 7269 6275 7469 6f6e 2028  l distribution (
-00015f90: 6d65 616e 3d30 2c20 7374 6465 763d 3129  mean=0, stdev=1)
-00015fa0: 2e0d 0a0d 0a20 2050 6172 616d 6574 6572  .....  Parameter
-00015fb0: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
-00015fc0: 0a20 2073 697a 6520 3a20 696e 7420 6f72  .  size : int or
-00015fd0: 2074 7570 6c65 206f 6620 696e 7473 2c20   tuple of ints, 
-00015fe0: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-00015ff0: 4f75 7470 7574 2073 6861 7065 2e20 2049  Output shape.  I
-00016000: 6620 7468 6520 6769 7665 6e20 7368 6170  f the given shap
-00016010: 6520 6973 2c20 652e 672e 2c20 6060 286d  e is, e.g., ``(m
-00016020: 2c20 6e2c 206b 2960 602c 2074 6865 6e0d  , n, k)``, then.
-00016030: 0a20 2020 2020 2060 606d 202a 206e 202a  .      ``m * n *
-00016040: 206b 6060 2073 616d 706c 6573 2061 7265   k`` samples are
-00016050: 2064 7261 776e 2e20 2044 6566 6175 6c74   drawn.  Default
-00016060: 2069 7320 4e6f 6e65 2c20 696e 2077 6869   is None, in whi
-00016070: 6368 2063 6173 6520 610d 0a20 2020 2020  ch case a..     
-00016080: 2073 696e 676c 6520 7661 6c75 6520 6973   single value is
-00016090: 2072 6574 7572 6e65 642e 0d0a 2020 6b65   returned...  ke
-000160a0: 7920 3a20 5052 4e47 4b65 792c 206f 7074  y : PRNGKey, opt
-000160b0: 696f 6e61 6c0d 0a20 2020 2020 2054 6865  ional..      The
-000160c0: 206b 6579 2066 6f72 2074 6865 2072 616e   key for the ran
-000160d0: 646f 6d20 6e75 6d62 6572 2067 656e 6572  dom number gener
-000160e0: 6174 6f72 2e20 4966 206e 6f74 2067 6976  ator. If not giv
-000160f0: 656e 2c20 7468 650d 0a20 2020 2020 2064  en, the..      d
-00016100: 6566 6175 6c74 2072 616e 646f 6d20 6e75  efault random nu
-00016110: 6d62 6572 2067 656e 6572 6174 6f72 2069  mber generator i
-00016120: 7320 7573 6564 2e0d 0a0d 0a20 2052 6574  s used.....  Ret
-00016130: 7572 6e73 0d0a 2020 2d2d 2d2d 2d2d 2d0d  urns..  -------.
-00016140: 0a20 206f 7574 203a 2066 6c6f 6174 206f  .  out : float o
-00016150: 7220 6e64 6172 7261 790d 0a20 2020 2020  r ndarray..     
-00016160: 2041 2066 6c6f 6174 696e 672d 706f 696e   A floating-poin
-00016170: 7420 6172 7261 7920 6f66 2073 6861 7065  t array of shape
-00016180: 2060 6073 697a 6560 6020 6f66 2064 7261   ``size`` of dra
-00016190: 776e 2073 616d 706c 6573 2c20 6f72 2061  wn samples, or a
-000161a0: 0d0a 2020 2020 2020 7369 6e67 6c65 2073  ..      single s
-000161b0: 616d 706c 6520 6966 2060 6073 697a 6560  ample if ``size`
-000161c0: 6020 7761 7320 6e6f 7420 7370 6563 6966  ` was not specif
-000161d0: 6965 642e 0d0a 0d0a 2020 5365 6520 416c  ied.....  See Al
-000161e0: 736f 0d0a 2020 2d2d 2d2d 2d2d 2d2d 0d0a  so..  --------..
-000161f0: 2020 6e6f 726d 616c 203a 0d0a 2020 2020    normal :..    
-00016200: 2020 4571 7569 7661 6c65 6e74 2066 756e    Equivalent fun
-00016210: 6374 696f 6e20 7769 7468 2061 6464 6974  ction with addit
-00016220: 696f 6e61 6c20 6060 6c6f 6360 6020 616e  ional ``loc`` an
-00016230: 6420 6060 7363 616c 6560 6020 6172 6775  d ``scale`` argu
-00016240: 6d65 6e74 730d 0a20 2020 2020 2066 6f72  ments..      for
-00016250: 2073 6574 7469 6e67 2074 6865 206d 6561   setting the mea
-00016260: 6e20 616e 6420 7374 616e 6461 7264 2064  n and standard d
-00016270: 6576 6961 7469 6f6e 2e0d 0a0d 0a20 204e  eviation.....  N
-00016280: 6f74 6573 0d0a 2020 2d2d 2d2d 2d0d 0a20  otes..  -----.. 
-00016290: 2046 6f72 2072 616e 646f 6d20 7361 6d70   For random samp
-000162a0: 6c65 7320 6672 6f6d 2074 6865 206e 6f72  les from the nor
-000162b0: 6d61 6c20 6469 7374 7269 6275 7469 6f6e  mal distribution
-000162c0: 2077 6974 6820 6d65 616e 2060 606d 7560   with mean ``mu`
-000162d0: 6020 616e 640d 0a20 2073 7461 6e64 6172  ` and..  standar
-000162e0: 6420 6465 7669 6174 696f 6e20 6060 7369  d deviation ``si
-000162f0: 676d 6160 602c 2075 7365 206f 6e65 206f  gma``, use one o
-00016300: 663a 3a0d 0a0d 0a20 2020 2020 206d 7520  f::....      mu 
-00016310: 2b20 7369 676d 6120 2a20 6263 2e72 616e  + sigma * bc.ran
-00016320: 646f 6d2e 7374 616e 6461 7264 5f6e 6f72  dom.standard_nor
-00016330: 6d61 6c28 7369 7a65 3d2e 2e2e 290d 0a20  mal(size=...).. 
-00016340: 2020 2020 2062 632e 7261 6e64 6f6d 2e6e       bc.random.n
-00016350: 6f72 6d61 6c28 6d75 2c20 7369 676d 612c  ormal(mu, sigma,
-00016360: 2073 697a 653d 2e2e 2e29 0d0a 0d0a 2020   size=...)....  
-00016370: 4578 616d 706c 6573 0d0a 2020 2d2d 2d2d  Examples..  ----
-00016380: 2d2d 2d2d 0d0a 2020 3e3e 3e20 6263 2e72  ----..  >>> bc.r
-00016390: 616e 646f 6d2e 7374 616e 6461 7264 5f6e  andom.standard_n
-000163a0: 6f72 6d61 6c28 290d 0a20 2032 2e31 3932  ormal()..  2.192
-000163b0: 3338 3735 3333 3535 3337 3331 3520 2372  3875335537315 #r
-000163c0: 616e 646f 6d0d 0a0d 0a20 203e 3e3e 2073  andom....  >>> s
-000163d0: 203d 2062 632e 7261 6e64 6f6d 2e73 7461   = bc.random.sta
-000163e0: 6e64 6172 645f 6e6f 726d 616c 2838 3030  ndard_normal(800
-000163f0: 3029 0d0a 2020 3e3e 3e20 730d 0a20 2061  0)..  >>> s..  a
-00016400: 7272 6179 285b 2030 2e36 3838 3838 3933  rray([ 0.6888893
-00016410: 202c 2020 302e 3738 3039 3632 3632 2c20   ,  0.78096262, 
-00016420: 2d30 2e38 3930 3836 3530 352c 202e 2e2e  -0.89086505, ...
-00016430: 2c20 2030 2e34 3938 3736 3331 312c 2020  ,  0.49876311,  
-00016440: 2320 7261 6e64 6f6d 0d0a 2020 2020 2020  # random..      
-00016450: 2020 202d 302e 3338 3637 3236 3936 2c20     -0.38672696, 
-00016460: 2d30 2e34 3638 3530 3036 205d 2920 2020  -0.4685006 ])   
-00016470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016480: 2020 2020 2020 2020 2020 2020 2023 2072               # r
-00016490: 616e 646f 6d0d 0a20 203e 3e3e 2073 2e73  andom..  >>> s.s
-000164a0: 6861 7065 0d0a 2020 2838 3030 302c 290d  hape..  (8000,).
-000164b0: 0a20 203e 3e3e 2073 203d 2062 632e 7261  .  >>> s = bc.ra
-000164c0: 6e64 6f6d 2e73 7461 6e64 6172 645f 6e6f  ndom.standard_no
-000164d0: 726d 616c 2873 697a 653d 2833 2c20 342c  rmal(size=(3, 4,
-000164e0: 2032 2929 0d0a 2020 3e3e 3e20 732e 7368   2))..  >>> s.sh
-000164f0: 6170 650d 0a20 2028 332c 2034 2c20 3229  ape..  (3, 4, 2)
-00016500: 0d0a 0d0a 2020 5477 6f2d 6279 2d66 6f75  ....  Two-by-fou
-00016510: 7220 6172 7261 7920 6f66 2073 616d 706c  r array of sampl
-00016520: 6573 2066 726f 6d20 7468 6520 6e6f 726d  es from the norm
-00016530: 616c 2064 6973 7472 6962 7574 696f 6e20  al distribution 
-00016540: 7769 7468 0d0a 2020 6d65 616e 2033 2061  with..  mean 3 a
-00016550: 6e64 2073 7461 6e64 6172 6420 6465 7669  nd standard devi
-00016560: 6174 696f 6e20 322e 353a 0d0a 0d0a 2020  ation 2.5:....  
-00016570: 3e3e 3e20 3320 2b20 322e 3520 2a20 6263  >>> 3 + 2.5 * bc
-00016580: 2e72 616e 646f 6d2e 7374 616e 6461 7264  .random.standard
-00016590: 5f6e 6f72 6d61 6c28 7369 7a65 3d28 322c  _normal(size=(2,
-000165a0: 2034 2929 0d0a 2020 6172 7261 7928 5b5b   4))..  array([[
-000165b0: 2d34 2e34 3934 3031 3530 312c 2020 342e  -4.49401501,  4.
-000165c0: 3030 3935 3030 3334 2c20 2d31 2e38 3138  00950034, -1.818
-000165d0: 3134 3836 372c 2020 372e 3239 3731 3836  14867,  7.297186
-000165e0: 3737 5d2c 2020 2023 2072 616e 646f 6d0d  77],   # random.
-000165f0: 0a20 2020 2020 2020 2020 5b20 302e 3339  .         [ 0.39
-00016600: 3932 3438 3034 2c20 2034 2e36 3834 3536  924804,  4.68456
-00016610: 3331 362c 2020 342e 3939 3339 3435 3239  316,  4.99394529
-00016620: 2c20 2034 2e38 3430 3537 3235 345d 5d29  ,  4.84057254]])
-00016630: 2020 2320 7261 6e64 6f6d 0d0a 2020 2222    # random..  ""
-00016640: 220d 0a20 2072 6574 7572 6e20 4445 4641  "..  return DEFA
-00016650: 554c 542e 7374 616e 6461 7264 5f6e 6f72  ULT.standard_nor
-00016660: 6d61 6c28 7369 7a65 2c20 6b65 793d 6b65  mal(size, key=ke
-00016670: 792c 2064 7479 7065 3d64 7479 7065 290d  y, dtype=dtype).
-00016680: 0a0d 0a0d 0a64 6566 2073 7461 6e64 6172  .....def standar
-00016690: 645f 7428 6466 2c20 7369 7a65 3a20 4f70  d_t(df, size: Op
-000166a0: 7469 6f6e 616c 5b53 697a 655d 203d 204e  tional[Size] = N
-000166b0: 6f6e 652c 206b 6579 3a20 4f70 7469 6f6e  one, key: Option
-000166c0: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
-000166d0: 4e6f 6e65 2c20 6474 7970 653a 2044 5479  None, dtype: DTy
-000166e0: 7065 4c69 6b65 203d 204e 6f6e 6529 3a0d  peLike = None):.
-000166f0: 0a20 2072 2222 220d 0a20 2044 7261 7720  .  r"""..  Draw 
-00016700: 7361 6d70 6c65 7320 6672 6f6d 2061 2073  samples from a s
-00016710: 7461 6e64 6172 6420 5374 7564 656e 7427  tandard Student'
-00016720: 7320 7420 6469 7374 7269 6275 7469 6f6e  s t distribution
-00016730: 2077 6974 6820 6064 6660 2064 6567 7265   with `df` degre
-00016740: 6573 0d0a 2020 6f66 2066 7265 6564 6f6d  es..  of freedom
-00016750: 2e0d 0a0d 0a20 2041 2073 7065 6369 616c  .....  A special
-00016760: 2063 6173 6520 6f66 2074 6865 2068 7970   case of the hyp
-00016770: 6572 626f 6c69 6320 6469 7374 7269 6275  erbolic distribu
-00016780: 7469 6f6e 2e20 2041 7320 6064 6660 2067  tion.  As `df` g
-00016790: 6574 730d 0a20 206c 6172 6765 2c20 7468  ets..  large, th
-000167a0: 6520 7265 7375 6c74 2072 6573 656d 626c  e result resembl
-000167b0: 6573 2074 6861 7420 6f66 2074 6865 2073  es that of the s
-000167c0: 7461 6e64 6172 6420 6e6f 726d 616c 0d0a  tandard normal..
-000167d0: 2020 6469 7374 7269 6275 7469 6f6e 2028    distribution (
-000167e0: 6073 7461 6e64 6172 645f 6e6f 726d 616c  `standard_normal
-000167f0: 6029 2e0d 0a0d 0a20 2050 6172 616d 6574  `).....  Paramet
-00016800: 6572 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d  ers..  ---------
-00016810: 2d0d 0a20 2064 6620 3a20 666c 6f61 7420  -..  df : float 
-00016820: 6f72 2061 7272 6179 5f6c 696b 6520 6f66  or array_like of
-00016830: 2066 6c6f 6174 730d 0a20 2020 2020 2044   floats..      D
-00016840: 6567 7265 6573 206f 6620 6672 6565 646f  egrees of freedo
-00016850: 6d2c 206d 7573 7420 6265 203e 2030 2e0d  m, must be > 0..
-00016860: 0a20 2073 697a 6520 3a20 696e 7420 6f72  .  size : int or
-00016870: 2074 7570 6c65 206f 6620 696e 7473 2c20   tuple of ints, 
-00016880: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-00016890: 4f75 7470 7574 2073 6861 7065 2e20 2049  Output shape.  I
-000168a0: 6620 7468 6520 6769 7665 6e20 7368 6170  f the given shap
-000168b0: 6520 6973 2c20 652e 672e 2c20 6060 286d  e is, e.g., ``(m
-000168c0: 2c20 6e2c 206b 2960 602c 2074 6865 6e0d  , n, k)``, then.
-000168d0: 0a20 2020 2020 2060 606d 202a 206e 202a  .      ``m * n *
-000168e0: 206b 6060 2073 616d 706c 6573 2061 7265   k`` samples are
-000168f0: 2064 7261 776e 2e20 2049 6620 7369 7a65   drawn.  If size
-00016900: 2069 7320 6060 4e6f 6e65 6060 2028 6465   is ``None`` (de
-00016910: 6661 756c 7429 2c0d 0a20 2020 2020 2061  fault),..      a
-00016920: 2073 696e 676c 6520 7661 6c75 6520 6973   single value is
-00016930: 2072 6574 7572 6e65 6420 6966 2060 6064   returned if ``d
-00016940: 6660 6020 6973 2061 2073 6361 6c61 722e  f`` is a scalar.
-00016950: 2020 4f74 6865 7277 6973 652c 0d0a 2020    Otherwise,..  
-00016960: 2020 2020 6060 6e70 2e61 7272 6179 2864      ``np.array(d
-00016970: 6629 2e73 697a 6560 6020 7361 6d70 6c65  f).size`` sample
-00016980: 7320 6172 6520 6472 6177 6e2e 0d0a 2020  s are drawn...  
-00016990: 6b65 7920 3a20 5052 4e47 4b65 792c 206f  key : PRNGKey, o
-000169a0: 7074 696f 6e61 6c0d 0a20 2020 2020 2054  ptional..      T
-000169b0: 6865 206b 6579 2066 6f72 2074 6865 2072  he key for the r
-000169c0: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
-000169d0: 6572 6174 6f72 2e20 4966 206e 6f74 2067  erator. If not g
-000169e0: 6976 656e 2c20 7468 650d 0a20 2020 2020  iven, the..     
-000169f0: 2064 6566 6175 6c74 2072 616e 646f 6d20   default random 
-00016a00: 6e75 6d62 6572 2067 656e 6572 6174 6f72  number generator
-00016a10: 2069 7320 7573 6564 2e0d 0a0d 0a20 2052   is used.....  R
-00016a20: 6574 7572 6e73 0d0a 2020 2d2d 2d2d 2d2d  eturns..  ------
-00016a30: 2d0d 0a20 206f 7574 203a 206e 6461 7272  -..  out : ndarr
-00016a40: 6179 206f 7220 7363 616c 6172 0d0a 2020  ay or scalar..  
-00016a50: 2020 2020 4472 6177 6e20 7361 6d70 6c65      Drawn sample
-00016a60: 7320 6672 6f6d 2074 6865 2070 6172 616d  s from the param
-00016a70: 6574 6572 697a 6564 2073 7461 6e64 6172  eterized standar
-00016a80: 6420 5374 7564 656e 7427 7320 7420 6469  d Student's t di
-00016a90: 7374 7269 6275 7469 6f6e 2e0d 0a0d 0a20  stribution..... 
-00016aa0: 204e 6f74 6573 0d0a 2020 2d2d 2d2d 2d0d   Notes..  -----.
-00016ab0: 0a20 2054 6865 2070 726f 6261 6269 6c69  .  The probabili
-00016ac0: 7479 2064 656e 7369 7479 2066 756e 6374  ty density funct
-00016ad0: 696f 6e20 666f 7220 7468 6520 7420 6469  ion for the t di
-00016ae0: 7374 7269 6275 7469 6f6e 2069 730d 0a0d  stribution is...
-00016af0: 0a20 202e 2e20 6d61 7468 3a3a 2050 2878  .  .. math:: P(x
-00016b00: 2c20 6466 2920 3d20 5c66 7261 637b 5c47  , df) = \frac{\G
-00016b10: 616d 6d61 285c 6672 6163 7b64 662b 317d  amma(\frac{df+1}
-00016b20: 7b32 7d29 7d7b 5c73 7172 747b 5c70 6920  {2})}{\sqrt{\pi 
-00016b30: 6466 7d0d 0a20 2020 2020 2020 2020 2020  df}..           
-00016b40: 205c 4761 6d6d 6128 5c66 7261 637b 6466   \Gamma(\frac{df
-00016b50: 7d7b 327d 297d 5c42 6967 6c28 2031 2b5c  }{2})}\Bigl( 1+\
-00016b60: 6672 6163 7b78 5e32 7d7b 6466 7d20 5c42  frac{x^2}{df} \B
-00016b70: 6967 7229 5e7b 2d28 6466 2b31 292f 327d  igr)^{-(df+1)/2}
-00016b80: 0d0a 0d0a 2020 5468 6520 7420 7465 7374  ....  The t test
-00016b90: 2069 7320 6261 7365 6420 6f6e 2061 6e20   is based on an 
-00016ba0: 6173 7375 6d70 7469 6f6e 2074 6861 7420  assumption that 
-00016bb0: 7468 6520 6461 7461 2063 6f6d 6520 6672  the data come fr
-00016bc0: 6f6d 2061 0d0a 2020 4e6f 726d 616c 2064  om a..  Normal d
-00016bd0: 6973 7472 6962 7574 696f 6e2e 2054 6865  istribution. The
-00016be0: 2074 2074 6573 7420 7072 6f76 6964 6573   t test provides
-00016bf0: 2061 2077 6179 2074 6f20 7465 7374 2077   a way to test w
-00016c00: 6865 7468 6572 0d0a 2020 7468 6520 7361  hether..  the sa
-00016c10: 6d70 6c65 206d 6561 6e20 2874 6861 7420  mple mean (that 
-00016c20: 6973 2074 6865 206d 6561 6e20 6361 6c63  is the mean calc
-00016c30: 756c 6174 6564 2066 726f 6d20 7468 6520  ulated from the 
-00016c40: 6461 7461 2920 6973 0d0a 2020 6120 676f  data) is..  a go
-00016c50: 6f64 2065 7374 696d 6174 6520 6f66 2074  od estimate of t
-00016c60: 6865 2074 7275 6520 6d65 616e 2e0d 0a0d  he true mean....
-00016c70: 0a20 2054 6865 2064 6572 6976 6174 696f  .  The derivatio
-00016c80: 6e20 6f66 2074 6865 2074 2d64 6973 7472  n of the t-distr
-00016c90: 6962 7574 696f 6e20 7761 7320 6669 7273  ibution was firs
-00016ca0: 7420 7075 626c 6973 6865 6420 696e 0d0a  t published in..
-00016cb0: 2020 3139 3038 2062 7920 5769 6c6c 6961    1908 by Willia
-00016cc0: 6d20 476f 7373 6574 2077 6869 6c65 2077  m Gosset while w
-00016cd0: 6f72 6b69 6e67 2066 6f72 2074 6865 2047  orking for the G
-00016ce0: 7569 6e6e 6573 7320 4272 6577 6572 790d  uinness Brewery.
-00016cf0: 0a20 2069 6e20 4475 626c 696e 2e20 4475  .  in Dublin. Du
-00016d00: 6520 746f 2070 726f 7072 6965 7461 7279  e to proprietary
-00016d10: 2069 7373 7565 732c 2068 6520 6861 6420   issues, he had 
-00016d20: 746f 2070 7562 6c69 7368 2075 6e64 6572  to publish under
-00016d30: 0d0a 2020 6120 7073 6575 646f 6e79 6d2c  ..  a pseudonym,
-00016d40: 2061 6e64 2073 6f20 6865 2075 7365 6420   and so he used 
-00016d50: 7468 6520 6e61 6d65 2053 7475 6465 6e74  the name Student
-00016d60: 2e0d 0a0d 0a20 2052 6566 6572 656e 6365  .....  Reference
-00016d70: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
-00016d80: 0a20 202e 2e20 5b31 5d20 4461 6c67 6161  .  .. [1] Dalgaa
-00016d90: 7264 2c20 5065 7465 722c 2022 496e 7472  rd, Peter, "Intr
-00016da0: 6f64 7563 746f 7279 2053 7461 7469 7374  oductory Statist
-00016db0: 6963 7320 5769 7468 2052 222c 0d0a 2020  ics With R",..  
-00016dc0: 2020 2020 2020 2053 7072 696e 6765 722c         Springer,
-00016dd0: 2032 3030 322e 0d0a 2020 2e2e 205b 325d   2002...  .. [2]
-00016de0: 2057 696b 6970 6564 6961 2c20 2253 7475   Wikipedia, "Stu
-00016df0: 6465 6e74 2773 2074 2d64 6973 7472 6962  dent's t-distrib
-00016e00: 7574 696f 6e22 0d0a 2020 2020 2020 2020  ution"..        
-00016e10: 2068 7474 7073 3a2f 2f65 6e2e 7769 6b69   https://en.wiki
-00016e20: 7065 6469 612e 6f72 672f 7769 6b69 2f53  pedia.org/wiki/S
-00016e30: 7475 6465 6e74 2773 5f74 2d64 6973 7472  tudent's_t-distr
-00016e40: 6962 7574 696f 6e0d 0a0d 0a20 2045 7861  ibution....  Exa
-00016e50: 6d70 6c65 730d 0a20 202d 2d2d 2d2d 2d2d  mples..  -------
-00016e60: 2d0d 0a20 2046 726f 6d20 4461 6c67 6161  -..  From Dalgaa
-00016e70: 7264 2070 6167 6520 3833 205b 315d 5f2c  rd page 83 [1]_,
-00016e80: 2073 7570 706f 7365 2074 6865 2064 6169   suppose the dai
-00016e90: 6c79 2065 6e65 7267 7920 696e 7461 6b65  ly energy intake
-00016ea0: 2066 6f72 2031 310d 0a20 2077 6f6d 656e   for 11..  women
-00016eb0: 2069 6e20 6b69 6c6f 6a6f 756c 6573 2028   in kilojoules (
-00016ec0: 6b4a 2920 6973 3a0d 0a0d 0a20 203e 3e3e  kJ) is:....  >>>
-00016ed0: 2069 6e74 616b 6520 3d20 6e70 2e61 7272   intake = np.arr
-00016ee0: 6179 285b 3532 3630 2e2c 2035 3437 302c  ay([5260., 5470,
-00016ef0: 2035 3634 302c 2036 3138 302c 2036 3339   5640, 6180, 639
-00016f00: 302c 2036 3531 352c 2036 3830 352c 2037  0, 6515, 6805, 7
-00016f10: 3531 352c 205c 0d0a 2020 2e2e 2e20 2020  515, \..  ...   
-00016f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016f30: 2037 3531 352c 2038 3233 302c 2038 3737   7515, 8230, 877
-00016f40: 305d 290d 0a0d 0a20 2044 6f65 7320 7468  0])....  Does th
-00016f50: 6569 7220 656e 6572 6779 2069 6e74 616b  eir energy intak
-00016f60: 6520 6465 7669 6174 6520 7379 7374 656d  e deviate system
-00016f70: 6174 6963 616c 6c79 2066 726f 6d20 7468  atically from th
-00016f80: 6520 7265 636f 6d6d 656e 6465 640d 0a20  e recommended.. 
-00016f90: 2076 616c 7565 206f 6620 3737 3235 206b   value of 7725 k
-00016fa0: 4a3f 204f 7572 206e 756c 6c20 6879 706f  J? Our null hypo
-00016fb0: 7468 6573 6973 2077 696c 6c20 6265 2074  thesis will be t
-00016fc0: 6865 2061 6273 656e 6365 206f 6620 6465  he absence of de
-00016fd0: 7669 6174 696f 6e2c 0d0a 2020 616e 6420  viation,..  and 
-00016fe0: 7468 6520 616c 7465 726e 6174 6520 6879  the alternate hy
-00016ff0: 706f 7468 6573 6973 2077 696c 6c20 6265  pothesis will be
-00017000: 2074 6865 2070 7265 7365 6e63 6520 6f66   the presence of
-00017010: 2061 6e20 6566 6665 6374 2074 6861 7420   an effect that 
-00017020: 636f 756c 6420 6265 0d0a 2020 6569 7468  could be..  eith
-00017030: 6572 2070 6f73 6974 6976 6520 6f72 206e  er positive or n
-00017040: 6567 6174 6976 652c 2068 656e 6365 206d  egative, hence m
-00017050: 616b 696e 6720 6f75 7220 7465 7374 2032  aking our test 2
-00017060: 2d74 6169 6c65 642e 0d0a 0d0a 2020 4265  -tailed.....  Be
-00017070: 6361 7573 6520 7765 2061 7265 2065 7374  cause we are est
-00017080: 696d 6174 696e 6720 7468 6520 6d65 616e  imating the mean
-00017090: 2061 6e64 2077 6520 6861 7665 204e 3d31   and we have N=1
-000170a0: 3120 7661 6c75 6573 2069 6e20 6f75 7220  1 values in our 
-000170b0: 7361 6d70 6c65 2c0d 0a20 2077 6520 6861  sample,..  we ha
-000170c0: 7665 204e 2d31 3d31 3020 6465 6772 6565  ve N-1=10 degree
-000170d0: 7320 6f66 2066 7265 6564 6f6d 2e20 5765  s of freedom. We
-000170e0: 2073 6574 206f 7572 2073 6967 6e69 6669   set our signifi
-000170f0: 6361 6e63 6520 6c65 7665 6c20 746f 2039  cance level to 9
-00017100: 3525 2061 6e64 0d0a 2020 636f 6d70 7574  5% and..  comput
-00017110: 6520 7468 6520 7420 7374 6174 6973 7469  e the t statisti
-00017120: 6320 7573 696e 6720 7468 6520 656d 7069  c using the empi
-00017130: 7269 6361 6c20 6d65 616e 2061 6e64 2065  rical mean and e
-00017140: 6d70 6972 6963 616c 2073 7461 6e64 6172  mpirical standar
-00017150: 640d 0a20 2064 6576 6961 7469 6f6e 206f  d..  deviation o
-00017160: 6620 6f75 7220 696e 7461 6b65 2e20 5765  f our intake. We
-00017170: 2075 7365 2061 2064 646f 6620 6f66 2031   use a ddof of 1
-00017180: 2074 6f20 6261 7365 2074 6865 2063 6f6d   to base the com
-00017190: 7075 7461 7469 6f6e 206f 6620 6f75 720d  putation of our.
-000171a0: 0a20 2065 6d70 6972 6963 616c 2073 7461  .  empirical sta
-000171b0: 6e64 6172 6420 6465 7669 6174 696f 6e20  ndard deviation 
-000171c0: 6f6e 2061 6e20 756e 6269 6173 6564 2065  on an unbiased e
-000171d0: 7374 696d 6174 6520 6f66 2074 6865 2076  stimate of the v
-000171e0: 6172 6961 6e63 6520 286e 6f74 653a 0d0a  ariance (note:..
-000171f0: 2020 7468 6520 6669 6e61 6c20 6573 7469    the final esti
-00017200: 6d61 7465 2069 7320 6e6f 7420 756e 6269  mate is not unbi
-00017210: 6173 6564 2064 7565 2074 6f20 7468 6520  ased due to the 
-00017220: 636f 6e63 6176 6520 6e61 7475 7265 206f  concave nature o
-00017230: 6620 7468 6520 7371 7561 7265 0d0a 2020  f the square..  
-00017240: 726f 6f74 292e 0d0a 0d0a 2020 3e3e 3e20  root).....  >>> 
-00017250: 6e70 2e6d 6561 6e28 696e 7461 6b65 290d  np.mean(intake).
-00017260: 0a20 2036 3735 332e 3633 3633 3633 3633  .  6753.63636363
-00017270: 3633 3634 0d0a 2020 3e3e 3e20 696e 7461  6364..  >>> inta
-00017280: 6b65 2e73 7464 2864 646f 663d 3129 0d0a  ke.std(ddof=1)..
-00017290: 2020 3131 3432 2e31 3233 3232 3231 3337    1142.123222137
-000172a0: 3337 3237 0d0a 2020 3e3e 3e20 7420 3d20  3727..  >>> t = 
-000172b0: 286e 702e 6d65 616e 2869 6e74 616b 6529  (np.mean(intake)
-000172c0: 2d37 3732 3529 2f28 696e 7461 6b65 2e73  -7725)/(intake.s
-000172d0: 7464 2864 646f 663d 3129 2f6e 702e 7371  td(ddof=1)/np.sq
-000172e0: 7274 286c 656e 2869 6e74 616b 6529 2929  rt(len(intake)))
-000172f0: 0d0a 2020 3e3e 3e20 740d 0a20 202d 322e  ..  >>> t..  -2.
-00017300: 3832 3037 3534 3036 3038 3331 3031 3938  8207540608310198
-00017310: 0d0a 0d0a 2020 5765 2064 7261 7720 3130  ....  We draw 10
-00017320: 3030 3030 3020 7361 6d70 6c65 7320 6672  00000 samples fr
-00017330: 6f6d 2053 7475 6465 6e74 2773 2074 2064  om Student's t d
-00017340: 6973 7472 6962 7574 696f 6e20 7769 7468  istribution with
-00017350: 2074 6865 2061 6465 7175 6174 650d 0a20   the adequate.. 
-00017360: 2064 6567 7265 6573 206f 6620 6672 6565   degrees of free
-00017370: 646f 6d2e 0d0a 0d0a 2020 3e3e 3e20 696d  dom.....  >>> im
-00017380: 706f 7274 206d 6174 706c 6f74 6c69 622e  port matplotlib.
-00017390: 7079 706c 6f74 2061 7320 706c 7420 2023  pyplot as plt  #
-000173a0: 206e 6f71 610d 0a20 203e 3e3e 2073 203d   noqa..  >>> s =
-000173b0: 2062 632e 7261 6e64 6f6d 2e73 7461 6e64   bc.random.stand
-000173c0: 6172 645f 7428 3130 2c20 7369 7a65 3d31  ard_t(10, size=1
-000173d0: 3030 3030 3030 290d 0a20 203e 3e3e 2068  000000)..  >>> h
-000173e0: 203d 2070 6c74 2e68 6973 7428 732c 2062   = plt.hist(s, b
-000173f0: 696e 733d 3130 302c 2064 656e 7369 7479  ins=100, density
-00017400: 3d54 7275 6529 0d0a 0d0a 2020 446f 6573  =True)....  Does
-00017410: 206f 7572 2074 2073 7461 7469 7374 6963   our t statistic
-00017420: 206c 616e 6420 696e 206f 6e65 206f 6620   land in one of 
-00017430: 7468 6520 7477 6f20 6372 6974 6963 616c  the two critical
-00017440: 2072 6567 696f 6e73 2066 6f75 6e64 2061   regions found a
-00017450: 740d 0a20 2062 6f74 6820 7461 696c 7320  t..  both tails 
-00017460: 6f66 2074 6865 2064 6973 7472 6962 7574  of the distribut
-00017470: 696f 6e3f 0d0a 0d0a 2020 3e3e 3e20 6e70  ion?....  >>> np
-00017480: 2e73 756d 286e 702e 6162 7328 7429 203c  .sum(np.abs(t) <
-00017490: 206e 702e 6162 7328 7329 2920 2f20 666c   np.abs(s)) / fl
-000174a0: 6f61 7428 6c65 6e28 7329 290d 0a20 2030  oat(len(s))..  0
-000174b0: 2e30 3138 3331 3820 2023 7261 6e64 6f6d  .018318  #random
-000174c0: 203c 2030 2e30 352c 2073 7461 7469 7374   < 0.05, statist
-000174d0: 6963 2069 7320 696e 2063 7269 7469 6361  ic is in critica
-000174e0: 6c20 7265 6769 6f6e 0d0a 0d0a 2020 5468  l region....  Th
-000174f0: 6520 7072 6f62 6162 696c 6974 7920 7661  e probability va
-00017500: 6c75 6520 666f 7220 7468 6973 2032 2d74  lue for this 2-t
-00017510: 6169 6c65 6420 7465 7374 2069 7320 6162  ailed test is ab
-00017520: 6f75 7420 312e 3833 252c 2077 6869 6368  out 1.83%, which
-00017530: 2069 730d 0a20 206c 6f77 6572 2074 6861   is..  lower tha
-00017540: 6e20 7468 6520 3525 2070 7265 2d64 6574  n the 5% pre-det
-00017550: 6572 6d69 6e65 6420 7369 676e 6966 6963  ermined signific
-00017560: 616e 6365 2074 6872 6573 686f 6c64 2e0d  ance threshold..
-00017570: 0a0d 0a20 2054 6865 7265 666f 7265 2c20  ...  Therefore, 
-00017580: 7468 6520 7072 6f62 6162 696c 6974 7920  the probability 
-00017590: 6f66 206f 6273 6572 7669 6e67 2076 616c  of observing val
-000175a0: 7565 7320 6173 2065 7874 7265 6d65 2061  ues as extreme a
-000175b0: 7320 6f75 7220 696e 7461 6b65 0d0a 2020  s our intake..  
-000175c0: 636f 6e64 6974 696f 6e61 6c6c 7920 6f6e  conditionally on
-000175d0: 2074 6865 206e 756c 6c20 6879 706f 7468   the null hypoth
-000175e0: 6573 6973 2062 6569 6e67 2074 7275 6520  esis being true 
-000175f0: 6973 2074 6f6f 206c 6f77 2c20 616e 6420  is too low, and 
-00017600: 7765 2072 656a 6563 740d 0a20 2074 6865  we reject..  the
-00017610: 206e 756c 6c20 6879 706f 7468 6573 6973   null hypothesis
-00017620: 206f 6620 6e6f 2064 6576 6961 7469 6f6e   of no deviation
-00017630: 2e0d 0a20 2022 2222 0d0a 2020 7265 7475  ...  """..  retu
-00017640: 726e 2044 4546 4155 4c54 2e73 7461 6e64  rn DEFAULT.stand
-00017650: 6172 645f 7428 6466 2c20 7369 7a65 2c20  ard_t(df, size, 
-00017660: 6b65 793d 6b65 792c 2064 7479 7065 3d64  key=key, dtype=d
-00017670: 7479 7065 290d 0a0d 0a0d 0a64 6566 2075  type)......def u
-00017680: 6e69 666f 726d 286c 6f77 3d30 2e30 2c20  niform(low=0.0, 
-00017690: 6869 6768 3d31 2e30 2c20 7369 7a65 3a20  high=1.0, size: 
-000176a0: 4f70 7469 6f6e 616c 5b53 697a 655d 203d  Optional[Size] =
-000176b0: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
-000176c0: 2020 2020 6b65 793a 204f 7074 696f 6e61      key: Optiona
-000176d0: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
-000176e0: 6f6e 652c 2064 7479 7065 3a20 4454 7970  one, dtype: DTyp
-000176f0: 654c 696b 6520 3d20 4e6f 6e65 293a 0d0a  eLike = None):..
-00017700: 2020 7222 2222 0d0a 2020 4472 6177 2073    r"""..  Draw s
-00017710: 616d 706c 6573 2066 726f 6d20 6120 756e  amples from a un
-00017720: 6966 6f72 6d20 6469 7374 7269 6275 7469  iform distributi
-00017730: 6f6e 2e0d 0a0d 0a20 2053 616d 706c 6573  on.....  Samples
-00017740: 2061 7265 2075 6e69 666f 726d 6c79 2064   are uniformly d
-00017750: 6973 7472 6962 7574 6564 206f 7665 7220  istributed over 
-00017760: 7468 6520 6861 6c66 2d6f 7065 6e20 696e  the half-open in
-00017770: 7465 7276 616c 0d0a 2020 6060 5b6c 6f77  terval..  ``[low
-00017780: 2c20 6869 6768 2960 6020 2869 6e63 6c75  , high)`` (inclu
-00017790: 6465 7320 6c6f 772c 2062 7574 2065 7863  des low, but exc
-000177a0: 6c75 6465 7320 6869 6768 292e 2020 496e  ludes high).  In
-000177b0: 206f 7468 6572 2077 6f72 6473 2c0d 0a20   other words,.. 
-000177c0: 2061 6e79 2076 616c 7565 2077 6974 6869   any value withi
-000177d0: 6e20 7468 6520 6769 7665 6e20 696e 7465  n the given inte
-000177e0: 7276 616c 2069 7320 6571 7561 6c6c 7920  rval is equally 
-000177f0: 6c69 6b65 6c79 2074 6f20 6265 2064 7261  likely to be dra
-00017800: 776e 0d0a 2020 6279 2060 756e 6966 6f72  wn..  by `unifor
-00017810: 6d60 2e0d 0a0d 0a20 2050 6172 616d 6574  m`.....  Paramet
-00017820: 6572 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d  ers..  ---------
-00017830: 2d0d 0a20 206c 6f77 203a 2066 6c6f 6174  -..  low : float
-00017840: 206f 7220 6172 7261 795f 6c69 6b65 206f   or array_like o
-00017850: 6620 666c 6f61 7473 2c20 6f70 7469 6f6e  f floats, option
-00017860: 616c 0d0a 2020 2020 2020 4c6f 7765 7220  al..      Lower 
-00017870: 626f 756e 6461 7279 206f 6620 7468 6520  boundary of the 
-00017880: 6f75 7470 7574 2069 6e74 6572 7661 6c2e  output interval.
-00017890: 2020 416c 6c20 7661 6c75 6573 2067 656e    All values gen
-000178a0: 6572 6174 6564 2077 696c 6c20 6265 0d0a  erated will be..
-000178b0: 2020 2020 2020 6772 6561 7465 7220 7468        greater th
-000178c0: 616e 206f 7220 6571 7561 6c20 746f 206c  an or equal to l
-000178d0: 6f77 2e20 2054 6865 2064 6566 6175 6c74  ow.  The default
-000178e0: 2076 616c 7565 2069 7320 302e 0d0a 2020   value is 0...  
-000178f0: 6869 6768 203a 2066 6c6f 6174 206f 7220  high : float or 
-00017900: 6172 7261 795f 6c69 6b65 206f 6620 666c  array_like of fl
-00017910: 6f61 7473 0d0a 2020 2020 2020 5570 7065  oats..      Uppe
-00017920: 7220 626f 756e 6461 7279 206f 6620 7468  r boundary of th
-00017930: 6520 6f75 7470 7574 2069 6e74 6572 7661  e output interva
-00017940: 6c2e 2020 416c 6c20 7661 6c75 6573 2067  l.  All values g
-00017950: 656e 6572 6174 6564 2077 696c 6c20 6265  enerated will be
-00017960: 0d0a 2020 2020 2020 6c65 7373 2074 6861  ..      less tha
-00017970: 6e20 6f72 2065 7175 616c 2074 6f20 6869  n or equal to hi
-00017980: 6768 2e20 2054 6865 2068 6967 6820 6c69  gh.  The high li
-00017990: 6d69 7420 6d61 7920 6265 2069 6e63 6c75  mit may be inclu
-000179a0: 6465 6420 696e 2074 6865 0d0a 2020 2020  ded in the..    
-000179b0: 2020 7265 7475 726e 6564 2061 7272 6179    returned array
-000179c0: 206f 6620 666c 6f61 7473 2064 7565 2074   of floats due t
-000179d0: 6f20 666c 6f61 7469 6e67 2d70 6f69 6e74  o floating-point
-000179e0: 2072 6f75 6e64 696e 6720 696e 2074 6865   rounding in the
-000179f0: 0d0a 2020 2020 2020 6571 7561 7469 6f6e  ..      equation
-00017a00: 2060 606c 6f77 202b 2028 6869 6768 2d6c   ``low + (high-l
-00017a10: 6f77 2920 2a20 7261 6e64 6f6d 5f73 616d  ow) * random_sam
-00017a20: 706c 6528 2960 602e 2020 5468 6520 6465  ple()``.  The de
-00017a30: 6661 756c 7420 7661 6c75 650d 0a20 2020  fault value..   
-00017a40: 2020 2069 7320 312e 302e 0d0a 2020 7369     is 1.0...  si
-00017a50: 7a65 203a 2069 6e74 206f 7220 7475 706c  ze : int or tupl
-00017a60: 6520 6f66 2069 6e74 732c 206f 7074 696f  e of ints, optio
-00017a70: 6e61 6c0d 0a20 2020 2020 204f 7574 7075  nal..      Outpu
-00017a80: 7420 7368 6170 652e 2020 4966 2074 6865  t shape.  If the
-00017a90: 2067 6976 656e 2073 6861 7065 2069 732c   given shape is,
-00017aa0: 2065 2e67 2e2c 2060 6028 6d2c 206e 2c20   e.g., ``(m, n, 
-00017ab0: 6b29 6060 2c20 7468 656e 0d0a 2020 2020  k)``, then..    
-00017ac0: 2020 6060 6d20 2a20 6e20 2a20 6b60 6020    ``m * n * k`` 
-00017ad0: 7361 6d70 6c65 7320 6172 6520 6472 6177  samples are draw
-00017ae0: 6e2e 2020 4966 2073 697a 6520 6973 2060  n.  If size is `
-00017af0: 604e 6f6e 6560 6020 2864 6566 6175 6c74  `None`` (default
-00017b00: 292c 0d0a 2020 2020 2020 6120 7369 6e67  ),..      a sing
-00017b10: 6c65 2076 616c 7565 2069 7320 7265 7475  le value is retu
-00017b20: 726e 6564 2069 6620 6060 6c6f 7760 6020  rned if ``low`` 
-00017b30: 616e 6420 6060 6869 6768 6060 2061 7265  and ``high`` are
-00017b40: 2062 6f74 6820 7363 616c 6172 732e 0d0a   both scalars...
-00017b50: 2020 2020 2020 4f74 6865 7277 6973 652c        Otherwise,
-00017b60: 2060 606e 702e 6272 6f61 6463 6173 7428   ``np.broadcast(
-00017b70: 6c6f 772c 2068 6967 6829 2e73 697a 6560  low, high).size`
-00017b80: 6020 7361 6d70 6c65 7320 6172 6520 6472  ` samples are dr
-00017b90: 6177 6e2e 0d0a 2020 6b65 7920 3a20 5052  awn...  key : PR
-00017ba0: 4e47 4b65 792c 206f 7074 696f 6e61 6c0d  NGKey, optional.
-00017bb0: 0a20 2020 2020 2054 6865 206b 6579 2066  .      The key f
-00017bc0: 6f72 2074 6865 2072 616e 646f 6d20 6e75  or the random nu
-00017bd0: 6d62 6572 2067 656e 6572 6174 6f72 2e20  mber generator. 
-00017be0: 4966 206e 6f74 2067 6976 656e 2c20 7468  If not given, th
-00017bf0: 650d 0a20 2020 2020 2064 6566 6175 6c74  e..      default
-00017c00: 2072 616e 646f 6d20 6e75 6d62 6572 2067   random number g
-00017c10: 656e 6572 6174 6f72 2069 7320 7573 6564  enerator is used
-00017c20: 2e0d 0a0d 0a20 2052 6574 7572 6e73 0d0a  .....  Returns..
-00017c30: 2020 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574    -------..  out
-00017c40: 203a 206e 6461 7272 6179 206f 7220 7363   : ndarray or sc
-00017c50: 616c 6172 0d0a 2020 2020 2020 4472 6177  alar..      Draw
-00017c60: 6e20 7361 6d70 6c65 7320 6672 6f6d 2074  n samples from t
-00017c70: 6865 2070 6172 616d 6574 6572 697a 6564  he parameterized
-00017c80: 2075 6e69 666f 726d 2064 6973 7472 6962   uniform distrib
-00017c90: 7574 696f 6e2e 0d0a 0d0a 2020 5365 6520  ution.....  See 
-00017ca0: 416c 736f 0d0a 2020 2d2d 2d2d 2d2d 2d2d  Also..  --------
-00017cb0: 0d0a 2020 7261 6e64 696e 7420 3a20 4469  ..  randint : Di
-00017cc0: 7363 7265 7465 2075 6e69 666f 726d 2064  screte uniform d
-00017cd0: 6973 7472 6962 7574 696f 6e2c 2079 6965  istribution, yie
-00017ce0: 6c64 696e 6720 696e 7465 6765 7273 2e0d  lding integers..
-00017cf0: 0a20 2072 616e 646f 6d5f 696e 7465 6765  .  random_intege
-00017d00: 7273 203a 2044 6973 6372 6574 6520 756e  rs : Discrete un
-00017d10: 6966 6f72 6d20 6469 7374 7269 6275 7469  iform distributi
-00017d20: 6f6e 206f 7665 7220 7468 6520 636c 6f73  on over the clos
-00017d30: 6564 0d0a 2020 2020 2020 2020 2020 2020  ed..            
-00017d40: 2020 2020 2020 2020 696e 7465 7276 616c          interval
-00017d50: 2060 605b 6c6f 772c 2068 6967 685d 6060   ``[low, high]``
-00017d60: 2e0d 0a20 2072 616e 646f 6d5f 7361 6d70  ...  random_samp
-00017d70: 6c65 203a 2046 6c6f 6174 7320 756e 6966  le : Floats unif
-00017d80: 6f72 6d6c 7920 6469 7374 7269 6275 7465  ormly distribute
-00017d90: 6420 6f76 6572 2060 605b 302c 2031 2960  d over ``[0, 1)`
-00017da0: 602e 0d0a 2020 7261 6e64 6f6d 203a 2041  `...  random : A
-00017db0: 6c69 6173 2066 6f72 2060 7261 6e64 6f6d  lias for `random
-00017dc0: 5f73 616d 706c 6560 2e0d 0a20 2072 616e  _sample`...  ran
-00017dd0: 6420 3a20 436f 6e76 656e 6965 6e63 6520  d : Convenience 
-00017de0: 6675 6e63 7469 6f6e 2074 6861 7420 6163  function that ac
-00017df0: 6365 7074 7320 6469 6d65 6e73 696f 6e73  cepts dimensions
-00017e00: 2061 7320 696e 7075 742c 2065 2e67 2e2c   as input, e.g.,
-00017e10: 0d0a 2020 2020 2020 2020 2060 6072 616e  ..         ``ran
-00017e20: 6428 322c 3229 6060 2077 6f75 6c64 2067  d(2,2)`` would g
-00017e30: 656e 6572 6174 6520 6120 322d 6279 2d32  enerate a 2-by-2
-00017e40: 2061 7272 6179 206f 6620 666c 6f61 7473   array of floats
-00017e50: 2c0d 0a20 2020 2020 2020 2020 756e 6966  ,..         unif
-00017e60: 6f72 6d6c 7920 6469 7374 7269 6275 7465  ormly distribute
-00017e70: 6420 6f76 6572 2060 605b 302c 2031 2960  d over ``[0, 1)`
-00017e80: 602e 0d0a 0d0a 2020 4e6f 7465 730d 0a20  `.....  Notes.. 
-00017e90: 202d 2d2d 2d2d 0d0a 2020 5468 6520 7072   -----..  The pr
-00017ea0: 6f62 6162 696c 6974 7920 6465 6e73 6974  obability densit
-00017eb0: 7920 6675 6e63 7469 6f6e 206f 6620 7468  y function of th
-00017ec0: 6520 756e 6966 6f72 6d20 6469 7374 7269  e uniform distri
-00017ed0: 6275 7469 6f6e 2069 730d 0a0d 0a20 202e  bution is....  .
-00017ee0: 2e20 6d61 7468 3a3a 2070 2878 2920 3d20  . math:: p(x) = 
-00017ef0: 5c66 7261 637b 317d 7b62 202d 2061 7d0d  \frac{1}{b - a}.
-00017f00: 0a0d 0a20 2061 6e79 7768 6572 6520 7769  ...  anywhere wi
-00017f10: 7468 696e 2074 6865 2069 6e74 6572 7661  thin the interva
-00017f20: 6c20 6060 5b61 2c20 6229 6060 2c20 616e  l ``[a, b)``, an
-00017f30: 6420 7a65 726f 2065 6c73 6577 6865 7265  d zero elsewhere
-00017f40: 2e0d 0a0d 0a20 2057 6865 6e20 6060 6869  .....  When ``hi
-00017f50: 6768 6060 203d 3d20 6060 6c6f 7760 602c  gh`` == ``low``,
-00017f60: 2076 616c 7565 7320 6f66 2060 606c 6f77   values of ``low
-00017f70: 6060 2077 696c 6c20 6265 2072 6574 7572  `` will be retur
-00017f80: 6e65 642e 0d0a 2020 4966 2060 6068 6967  ned...  If ``hig
-00017f90: 6860 6020 3c20 6060 6c6f 7760 602c 2074  h`` < ``low``, t
-00017fa0: 6865 2072 6573 756c 7473 2061 7265 206f  he results are o
-00017fb0: 6666 6963 6961 6c6c 7920 756e 6465 6669  fficially undefi
-00017fc0: 6e65 640d 0a20 2061 6e64 206d 6179 2065  ned..  and may e
-00017fd0: 7665 6e74 7561 6c6c 7920 7261 6973 6520  ventually raise 
-00017fe0: 616e 2065 7272 6f72 2c20 692e 652e 2064  an error, i.e. d
-00017ff0: 6f20 6e6f 7420 7265 6c79 206f 6e20 7468  o not rely on th
-00018000: 6973 0d0a 2020 6675 6e63 7469 6f6e 2074  is..  function t
-00018010: 6f20 6265 6861 7665 2077 6865 6e20 7061  o behave when pa
-00018020: 7373 6564 2061 7267 756d 656e 7473 2073  ssed arguments s
-00018030: 6174 6973 6679 696e 6720 7468 6174 0d0a  atisfying that..
-00018040: 2020 696e 6571 7561 6c69 7479 2063 6f6e    inequality con
-00018050: 6469 7469 6f6e 2e20 5468 6520 6060 6869  dition. The ``hi
-00018060: 6768 6060 206c 696d 6974 206d 6179 2062  gh`` limit may b
-00018070: 6520 696e 636c 7564 6564 2069 6e20 7468  e included in th
-00018080: 650d 0a20 2072 6574 7572 6e65 6420 6172  e..  returned ar
-00018090: 7261 7920 6f66 2066 6c6f 6174 7320 6475  ray of floats du
-000180a0: 6520 746f 2066 6c6f 6174 696e 672d 706f  e to floating-po
-000180b0: 696e 7420 726f 756e 6469 6e67 2069 6e20  int rounding in 
-000180c0: 7468 650d 0a20 2065 7175 6174 696f 6e20  the..  equation 
-000180d0: 6060 6c6f 7720 2b20 2868 6967 682d 6c6f  ``low + (high-lo
-000180e0: 7729 202a 2072 616e 646f 6d5f 7361 6d70  w) * random_samp
-000180f0: 6c65 2829 6060 2e20 466f 7220 6578 616d  le()``. For exam
-00018100: 706c 653a 0d0a 0d0a 2020 3e3e 3e20 7820  ple:....  >>> x 
-00018110: 3d20 6e70 2e66 6c6f 6174 3332 2835 2a30  = np.float32(5*0
-00018120: 2e39 3939 3939 3939 3929 0d0a 2020 3e3e  .99999999)..  >>
-00018130: 3e20 780d 0a20 2035 2e30 0d0a 0d0a 0d0a  > x..  5.0......
-00018140: 2020 4578 616d 706c 6573 0d0a 2020 2d2d    Examples..  --
-00018150: 2d2d 2d2d 2d2d 0d0a 2020 4472 6177 2073  ------..  Draw s
-00018160: 616d 706c 6573 2066 726f 6d20 7468 6520  amples from the 
-00018170: 6469 7374 7269 6275 7469 6f6e 3a0d 0a0d  distribution:...
-00018180: 0a20 203e 3e3e 2073 203d 2062 632e 7261  .  >>> s = bc.ra
-00018190: 6e64 6f6d 2e75 6e69 666f 726d 282d 312c  ndom.uniform(-1,
-000181a0: 302c 3130 3030 290d 0a0d 0a20 2041 6c6c  0,1000)....  All
-000181b0: 2076 616c 7565 7320 6172 6520 7769 7468   values are with
-000181c0: 696e 2074 6865 2067 6976 656e 2069 6e74  in the given int
-000181d0: 6572 7661 6c3a 0d0a 0d0a 2020 3e3e 3e20  erval:....  >>> 
-000181e0: 6e70 2e61 6c6c 2873 203e 3d20 2d31 290d  np.all(s >= -1).
-000181f0: 0a20 2054 7275 650d 0a20 203e 3e3e 206e  .  True..  >>> n
-00018200: 702e 616c 6c28 7320 3c20 3029 0d0a 2020  p.all(s < 0)..  
-00018210: 5472 7565 0d0a 0d0a 2020 4469 7370 6c61  True....  Displa
-00018220: 7920 7468 6520 6869 7374 6f67 7261 6d20  y the histogram 
-00018230: 6f66 2074 6865 2073 616d 706c 6573 2c20  of the samples, 
-00018240: 616c 6f6e 6720 7769 7468 2074 6865 0d0a  along with the..
-00018250: 2020 7072 6f62 6162 696c 6974 7920 6465    probability de
-00018260: 6e73 6974 7920 6675 6e63 7469 6f6e 3a0d  nsity function:.
-00018270: 0a0d 0a20 203e 3e3e 2069 6d70 6f72 7420  ...  >>> import 
-00018280: 6d61 7470 6c6f 746c 6962 2e70 7970 6c6f  matplotlib.pyplo
-00018290: 7420 6173 2070 6c74 2020 2320 6e6f 7161  t as plt  # noqa
-000182a0: 0d0a 2020 3e3e 3e20 636f 756e 742c 2062  ..  >>> count, b
-000182b0: 696e 732c 2069 676e 6f72 6564 203d 2070  ins, ignored = p
-000182c0: 6c74 2e68 6973 7428 732c 2031 352c 2064  lt.hist(s, 15, d
-000182d0: 656e 7369 7479 3d54 7275 6529 0d0a 2020  ensity=True)..  
-000182e0: 3e3e 3e20 706c 742e 706c 6f74 2862 696e  >>> plt.plot(bin
-000182f0: 732c 206e 702e 6f6e 6573 5f6c 696b 6528  s, np.ones_like(
-00018300: 6269 6e73 292c 206c 696e 6577 6964 7468  bins), linewidth
-00018310: 3d32 2c20 636f 6c6f 723d 2772 2729 0d0a  =2, color='r')..
-00018320: 2020 3e3e 3e20 706c 742e 7368 6f77 2829    >>> plt.show()
-00018330: 0d0a 2020 2222 220d 0a20 2072 6574 7572  ..  """..  retur
-00018340: 6e20 4445 4641 554c 542e 756e 6966 6f72  n DEFAULT.unifor
-00018350: 6d28 6c6f 772c 2068 6967 682c 2073 697a  m(low, high, siz
-00018360: 652c 206b 6579 3d6b 6579 2c20 6474 7970  e, key=key, dtyp
-00018370: 653d 6474 7970 6529 0d0a 0d0a 0d0a 6465  e=dtype)......de
-00018380: 6620 7472 756e 6361 7465 645f 6e6f 726d  f truncated_norm
-00018390: 616c 286c 6f77 6572 2c20 7570 7065 722c  al(lower, upper,
-000183a0: 2073 697a 653a 204f 7074 696f 6e61 6c5b   size: Optional[
-000183b0: 5369 7a65 5d20 3d20 4e6f 6e65 2c20 6c6f  Size] = None, lo
-000183c0: 633d 302e 2c20 7363 616c 653d 312e 2c0d  c=0., scale=1.,.
-000183d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000183e0: 2020 2020 2020 6b65 793a 204f 7074 696f        key: Optio
-000183f0: 6e61 6c5b 5365 6564 4f72 4b65 795d 203d  nal[SeedOrKey] =
-00018400: 204e 6f6e 652c 2064 7479 7065 3a20 4454   None, dtype: DT
-00018410: 7970 654c 696b 6520 3d20 4e6f 6e65 293a  ypeLike = None):
-00018420: 0d0a 2020 7222 2222 5361 6d70 6c65 2074  ..  r"""Sample t
-00018430: 7275 6e63 6174 6564 2073 7461 6e64 6172  runcated standar
-00018440: 6420 6e6f 726d 616c 2072 616e 646f 6d20  d normal random 
-00018450: 7661 6c75 6573 2077 6974 6820 6769 7665  values with give
-00018460: 6e20 7368 6170 6520 616e 6420 6474 7970  n shape and dtyp
-00018470: 652e 0d0a 0d0a 2020 4d65 7468 6f64 2062  e.....  Method b
-00018480: 6173 6564 206f 6e20 6874 7470 733a 2f2f  ased on https://
-00018490: 7065 6f70 6c65 2e73 632e 6673 752e 6564  people.sc.fsu.ed
-000184a0: 752f 7e6a 6275 726b 6172 6474 2f70 7265  u/~jburkardt/pre
-000184b0: 7365 6e74 6174 696f 6e73 2f74 7275 6e63  sentations/trunc
-000184c0: 6174 6564 5f6e 6f72 6d61 6c2e 7064 660d  ated_normal.pdf.
-000184d0: 0a0d 0a0d 0a20 204e 6f74 6573 0d0a 2020  .....  Notes..  
-000184e0: 2d2d 2d2d 2d0d 0a20 2054 6869 7320 6469  -----..  This di
-000184f0: 7374 7269 6275 7469 6f6e 2069 7320 7468  stribution is th
-00018500: 6520 6e6f 726d 616c 2064 6973 7472 6962  e normal distrib
-00018510: 7574 696f 6e20 6365 6e74 6572 6564 206f  ution centered o
-00018520: 6e20 6060 6c6f 6360 6020 2864 6566 6175  n ``loc`` (defau
-00018530: 6c74 0d0a 2020 3029 2c20 7769 7468 2073  lt..  0), with s
-00018540: 7461 6e64 6172 6420 6465 7669 6174 696f  tandard deviatio
-00018550: 6e20 6060 7363 616c 6560 6020 2864 6566  n ``scale`` (def
-00018560: 6175 6c74 2031 292c 2061 6e64 2063 6c69  ault 1), and cli
-00018570: 7070 6564 2061 7420 6060 6160 602c 0d0a  pped at ``a``,..
-00018580: 2020 6060 6260 6020 7374 616e 6461 7264    ``b`` standard
-00018590: 2064 6576 6961 7469 6f6e 7320 746f 2074   deviations to t
-000185a0: 6865 206c 6566 742c 2072 6967 6874 2028  he left, right (
-000185b0: 7265 7370 6563 7469 7665 6c79 2920 6672  respectively) fr
-000185c0: 6f6d 2060 606c 6f63 6060 2e0d 0a20 2049  om ``loc``...  I
-000185d0: 6620 6060 6d79 636c 6970 5f61 6060 2061  f ``myclip_a`` a
-000185e0: 6e64 2060 606d 7963 6c69 705f 6260 6020  nd ``myclip_b`` 
-000185f0: 6172 6520 636c 6970 2076 616c 7565 7320  are clip values 
-00018600: 696e 2074 6865 2073 616d 706c 6520 7370  in the sample sp
-00018610: 6163 6520 2861 730d 0a20 206f 7070 6f73  ace (as..  oppos
-00018620: 6564 2074 6f20 7468 6520 6e75 6d62 6572  ed to the number
-00018630: 206f 6620 7374 616e 6461 7264 2064 6576   of standard dev
-00018640: 6961 7469 6f6e 7329 2074 6865 6e20 7468  iations) then th
-00018650: 6579 2063 616e 2062 6520 636f 6e76 6572  ey can be conver
-00018660: 7465 640d 0a20 2074 6f20 7468 6520 7265  ted..  to the re
-00018670: 7175 6972 6564 2066 6f72 6d20 6163 636f  quired form acco
-00018680: 7264 696e 6720 746f 3a3a 0d0a 0d0a 2020  rding to::....  
-00018690: 2020 2020 612c 2062 203d 2028 6d79 636c      a, b = (mycl
-000186a0: 6970 5f61 202d 206c 6f63 2920 2f20 7363  ip_a - loc) / sc
-000186b0: 616c 652c 2028 6d79 636c 6970 5f62 202d  ale, (myclip_b -
-000186c0: 206c 6f63 2920 2f20 7363 616c 650d 0a0d   loc) / scale...
-000186d0: 0a0d 0a20 2050 6172 616d 6574 6572 730d  ...  Parameters.
-000186e0: 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  .  ----------.. 
-000186f0: 206c 6f77 6572 203a 2066 6c6f 6174 2c20   lower : float, 
-00018700: 6e64 6172 7261 790d 0a20 2020 2041 2066  ndarray..    A f
-00018710: 6c6f 6174 206f 7220 6172 7261 7920 6f66  loat or array of
-00018720: 2066 6c6f 6174 7320 7265 7072 6573 656e   floats represen
-00018730: 7469 6e67 2074 6865 206c 6f77 6572 2062  ting the lower b
-00018740: 6f75 6e64 2066 6f72 0d0a 2020 2020 7472  ound for..    tr
-00018750: 756e 6361 7469 6f6e 2e20 4d75 7374 2062  uncation. Must b
-00018760: 6520 6272 6f61 6463 6173 742d 636f 6d70  e broadcast-comp
-00018770: 6174 6962 6c65 2077 6974 6820 6060 7570  atible with ``up
-00018780: 7065 7260 602e 0d0a 2020 7570 7065 7220  per``...  upper 
-00018790: 3a20 666c 6f61 742c 206e 6461 7272 6179  : float, ndarray
-000187a0: 0d0a 2020 2020 4120 666c 6f61 7420 6f72  ..    A float or
-000187b0: 2061 7272 6179 206f 6620 666c 6f61 7473   array of floats
-000187c0: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
-000187d0: 6520 2075 7070 6572 2062 6f75 6e64 2066  e  upper bound f
-000187e0: 6f72 0d0a 2020 2020 7472 756e 6361 7469  or..    truncati
-000187f0: 6f6e 2e20 4d75 7374 2062 6520 6272 6f61  on. Must be broa
-00018800: 6463 6173 742d 636f 6d70 6174 6962 6c65  dcast-compatible
-00018810: 2077 6974 6820 6060 6c6f 7765 7260 602e   with ``lower``.
-00018820: 0d0a 2020 6c6f 6320 3a20 666c 6f61 742c  ..  loc : float,
-00018830: 206e 6461 7272 6179 0d0a 2020 2020 4d65   ndarray..    Me
-00018840: 616e 2028 2263 656e 7472 6522 2920 6f66  an ("centre") of
-00018850: 2074 6865 2064 6973 7472 6962 7574 696f   the distributio
-00018860: 6e20 6265 666f 7265 2074 7275 6e63 6174  n before truncat
-00018870: 696e 672e 204e 6f74 6520 7468 6174 200d  ing. Note that .
-00018880: 0a20 2020 2074 6865 206d 6561 6e20 6f66  .    the mean of
-00018890: 2074 6865 2074 7275 6e63 6174 6564 2064   the truncated d
-000188a0: 6973 7472 6962 7574 696f 6e20 7769 6c6c  istribution will
-000188b0: 206e 6f74 2062 6520 6578 6163 746c 7920   not be exactly 
-000188c0: 6571 7561 6c20 0d0a 2020 2020 746f 2060  equal ..    to `
-000188d0: 606c 6f63 6060 2e0d 0a20 2073 697a 6520  `loc``...  size 
-000188e0: 3a20 6f70 7469 6f6e 616c 2c20 6c69 7374  : optional, list
-000188f0: 206f 6620 696e 742c 2074 7570 6c65 206f   of int, tuple o
-00018900: 6620 696e 740d 0a20 2020 2041 2074 7570  f int..    A tup
-00018910: 6c65 206f 6620 6e6f 6e6e 6567 6174 6976  le of nonnegativ
-00018920: 6520 696e 7465 6765 7273 2073 7065 6369  e integers speci
-00018930: 6679 696e 6720 7468 6520 7265 7375 6c74  fying the result
-00018940: 0d0a 2020 2020 7368 6170 652e 204d 7573  ..    shape. Mus
-00018950: 7420 6265 2062 726f 6164 6361 7374 2d63  t be broadcast-c
-00018960: 6f6d 7061 7469 626c 6520 7769 7468 2060  ompatible with `
-00018970: 606c 6f77 6572 6060 2061 6e64 2060 6075  `lower`` and ``u
-00018980: 7070 6572 6060 2e20 5468 650d 0a20 2020  pper``. The..   
-00018990: 2064 6566 6175 6c74 2028 4e6f 6e65 2920   default (None) 
-000189a0: 7072 6f64 7563 6573 2061 2072 6573 756c  produces a resul
-000189b0: 7420 7368 6170 6520 6279 2062 726f 6164  t shape by broad
-000189c0: 6361 7374 696e 6720 6060 6c6f 7765 7260  casting ``lower`
-000189d0: 6020 616e 640d 0a20 2020 2060 6075 7070  ` and..    ``upp
-000189e0: 6572 6060 2e0d 0a20 206c 6f63 3a20 6f70  er``...  loc: op
-000189f0: 7469 6f6e 616c 2c20 666c 6f61 742c 206e  tional, float, n
-00018a00: 6461 7272 6179 0d0a 2020 2020 4120 666c  darray..    A fl
-00018a10: 6f61 7420 6f72 2061 7272 6179 206f 6620  oat or array of 
-00018a20: 666c 6f61 7473 2072 6570 7265 7365 6e74  floats represent
-00018a30: 696e 6720 7468 6520 6d65 616e 206f 6620  ing the mean of 
-00018a40: 7468 650d 0a20 2020 2064 6973 7472 6962  the..    distrib
-00018a50: 7574 696f 6e2e 2044 6566 6175 6c74 2069  ution. Default i
-00018a60: 7320 302e 0d0a 2020 7363 616c 6520 3a20  s 0...  scale : 
-00018a70: 666c 6f61 742c 206e 6461 7272 6179 0d0a  float, ndarray..
-00018a80: 2020 2020 5374 616e 6461 7264 2064 6576      Standard dev
-00018a90: 6961 7469 6f6e 2028 7370 7265 6164 206f  iation (spread o
-00018aa0: 7220 2277 6964 7468 2229 206f 6620 7468  r "width") of th
-00018ab0: 6520 6469 7374 7269 6275 7469 6f6e 2e20  e distribution. 
-00018ac0: 4d75 7374 2062 650d 0a20 2020 206e 6f6e  Must be..    non
-00018ad0: 2d6e 6567 6174 6976 652e 2044 6566 6175  -negative. Defau
-00018ae0: 6c74 2069 7320 312e 0d0a 2020 6474 7970  lt is 1...  dtyp
-00018af0: 653a 206f 7074 696f 6e61 6c0d 0a20 2020  e: optional..   
-00018b00: 2054 6865 2066 6c6f 6174 2064 7479 7065   The float dtype
-00018b10: 2066 6f72 2074 6865 2072 6574 7572 6e65   for the returne
-00018b20: 6420 7661 6c75 6573 2028 6465 6661 756c  d values (defaul
-00018b30: 7420 666c 6f61 7436 3420 6966 0d0a 2020  t float64 if..  
-00018b40: 2020 6a61 785f 656e 6162 6c65 5f78 3634    jax_enable_x64
-00018b50: 2069 7320 7472 7565 2c20 6f74 6865 7277   is true, otherw
-00018b60: 6973 6520 666c 6f61 7433 3229 2e0d 0a20  ise float32)... 
-00018b70: 206b 6579 203a 2050 524e 474b 6579 2c20   key : PRNGKey, 
-00018b80: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-00018b90: 5468 6520 6b65 7920 666f 7220 7468 6520  The key for the 
-00018ba0: 7261 6e64 6f6d 206e 756d 6265 7220 6765  random number ge
-00018bb0: 6e65 7261 746f 722e 2049 6620 6e6f 7420  nerator. If not 
-00018bc0: 6769 7665 6e2c 2074 6865 0d0a 2020 2020  given, the..    
-00018bd0: 2020 6465 6661 756c 7420 7261 6e64 6f6d    default random
-00018be0: 206e 756d 6265 7220 6765 6e65 7261 746f   number generato
-00018bf0: 7220 6973 2075 7365 642e 0d0a 0d0a 0d0a  r is used.......
-00018c00: 2020 5265 7475 726e 730d 0a20 202d 2d2d    Returns..  ---
-00018c10: 2d2d 2d2d 0d0a 2020 6f75 7420 3a20 4172  ----..  out : Ar
-00018c20: 7261 790d 0a20 2020 2041 2072 616e 646f  ray..    A rando
-00018c30: 6d20 6172 7261 7920 7769 7468 2074 6865  m array with the
-00018c40: 2073 7065 6369 6669 6564 2064 7479 7065   specified dtype
-00018c50: 2061 6e64 2073 6861 7065 2067 6976 656e   and shape given
-00018c60: 2062 7920 6060 7368 6170 6560 6020 6966   by ``shape`` if
-00018c70: 0d0a 2020 2020 6060 7368 6170 6560 6020  ..    ``shape`` 
-00018c80: 6973 206e 6f74 204e 6f6e 652c 206f 7220  is not None, or 
-00018c90: 656c 7365 2062 7920 6272 6f61 6463 6173  else by broadcas
-00018ca0: 7469 6e67 2060 606c 6f77 6572 6060 2061  ting ``lower`` a
-00018cb0: 6e64 2060 6075 7070 6572 6060 2e0d 0a20  nd ``upper``... 
-00018cc0: 2020 2052 6574 7572 6e73 2076 616c 7565     Returns value
-00018cd0: 7320 696e 2074 6865 206f 7065 6e20 696e  s in the open in
-00018ce0: 7465 7276 616c 2060 6028 6c6f 7765 722c  terval ``(lower,
-00018cf0: 2075 7070 6572 2960 602e 0d0a 2020 2222   upper)``...  ""
-00018d00: 220d 0a20 2072 6574 7572 6e20 4445 4641  "..  return DEFA
-00018d10: 554c 542e 7472 756e 6361 7465 645f 6e6f  ULT.truncated_no
-00018d20: 726d 616c 286c 6f77 6572 2c20 7570 7065  rmal(lower, uppe
-00018d30: 722c 2073 697a 652c 206c 6f63 2c20 7363  r, size, loc, sc
-00018d40: 616c 652c 206b 6579 3d6b 6579 2c20 6474  ale, key=key, dt
-00018d50: 7970 653d 6474 7970 6529 0d0a 0d0a 0d0a  ype=dtype)......
-00018d60: 5261 6e64 6f6d 5374 6174 652e 7472 756e  RandomState.trun
-00018d70: 6361 7465 645f 6e6f 726d 616c 2e5f 5f64  cated_normal.__d
-00018d80: 6f63 5f5f 203d 2074 7275 6e63 6174 6564  oc__ = truncated
-00018d90: 5f6e 6f72 6d61 6c2e 5f5f 646f 635f 5f0d  _normal.__doc__.
-00018da0: 0a0d 0a0d 0a64 6566 2062 6572 6e6f 756c  .....def bernoul
-00018db0: 6c69 2870 3d30 2e35 2c20 7369 7a65 3a20  li(p=0.5, size: 
-00018dc0: 4f70 7469 6f6e 616c 5b53 697a 655d 203d  Optional[Size] =
-00018dd0: 204e 6f6e 652c 206b 6579 3a20 4f70 7469   None, key: Opti
-00018de0: 6f6e 616c 5b53 6565 644f 724b 6579 5d20  onal[SeedOrKey] 
-00018df0: 3d20 4e6f 6e65 293a 0d0a 2020 7222 2222  = None):..  r"""
-00018e00: 5361 6d70 6c65 2042 6572 6e6f 756c 6c69  Sample Bernoulli
-00018e10: 2072 616e 646f 6d20 7661 6c75 6573 2077   random values w
-00018e20: 6974 6820 6769 7665 6e20 7368 6170 6520  ith given shape 
-00018e30: 616e 6420 6d65 616e 2e0d 0a0d 0a20 2050  and mean.....  P
-00018e40: 6172 616d 6574 6572 730d 0a20 202d 2d2d  arameters..  ---
-00018e50: 2d2d 2d2d 2d2d 2d0d 0a20 2070 3a20 666c  -------..  p: fl
-00018e60: 6f61 742c 2061 7272 6179 5f6c 696b 652c  oat, array_like,
-00018e70: 206f 7074 696f 6e61 6c0d 0a20 2020 2041   optional..    A
-00018e80: 2066 6c6f 6174 206f 7220 6172 7261 7920   float or array 
-00018e90: 6f66 2066 6c6f 6174 7320 666f 7220 7468  of floats for th
-00018ea0: 6520 6d65 616e 206f 6620 7468 6520 7261  e mean of the ra
-00018eb0: 6e64 6f6d 0d0a 2020 2020 7661 7269 6162  ndom..    variab
-00018ec0: 6c65 732e 204d 7573 7420 6265 2062 726f  les. Must be bro
-00018ed0: 6164 6361 7374 2d63 6f6d 7061 7469 626c  adcast-compatibl
-00018ee0: 6520 7769 7468 2060 6073 6861 7065 6060  e with ``shape``
-00018ef0: 2061 6e64 2074 6865 2076 616c 7565 730d   and the values.
-00018f00: 0a20 2020 2073 686f 756c 6420 6265 2077  .    should be w
-00018f10: 6974 6869 6e20 5b30 2c20 315d 2e20 4465  ithin [0, 1]. De
-00018f20: 6661 756c 7420 302e 352e 0d0a 2020 7369  fault 0.5...  si
-00018f30: 7a65 3a20 6f70 7469 6f6e 616c 2c20 7475  ze: optional, tu
-00018f40: 706c 6520 6f66 2069 6e74 2c20 696e 740d  ple of int, int.
-00018f50: 0a20 2020 2041 2074 7570 6c65 206f 6620  .    A tuple of 
-00018f60: 6e6f 6e6e 6567 6174 6976 6520 696e 7465  nonnegative inte
-00018f70: 6765 7273 2072 6570 7265 7365 6e74 696e  gers representin
-00018f80: 6720 7468 6520 7265 7375 6c74 0d0a 2020  g the result..  
-00018f90: 2020 7368 6170 652e 204d 7573 7420 6265    shape. Must be
-00018fa0: 2062 726f 6164 6361 7374 2d63 6f6d 7061   broadcast-compa
-00018fb0: 7469 626c 6520 7769 7468 2060 6070 2e73  tible with ``p.s
-00018fc0: 6861 7065 6060 2e20 5468 6520 6465 6661  hape``. The defa
-00018fd0: 756c 7420 284e 6f6e 6529 0d0a 2020 2020  ult (None)..    
-00018fe0: 7072 6f64 7563 6573 2061 2072 6573 756c  produces a resul
-00018ff0: 7420 7368 6170 6520 6571 7561 6c20 746f  t shape equal to
-00019000: 2060 6070 2e73 6861 7065 6060 2e0d 0a20   ``p.shape``... 
-00019010: 206b 6579 203a 2050 524e 474b 6579 2c20   key : PRNGKey, 
-00019020: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-00019030: 5468 6520 6b65 7920 666f 7220 7468 6520  The key for the 
-00019040: 7261 6e64 6f6d 206e 756d 6265 7220 6765  random number ge
-00019050: 6e65 7261 746f 722e 2049 6620 6e6f 7420  nerator. If not 
-00019060: 6769 7665 6e2c 2074 6865 0d0a 2020 2020  given, the..    
-00019070: 2020 6465 6661 756c 7420 7261 6e64 6f6d    default random
-00019080: 206e 756d 6265 7220 6765 6e65 7261 746f   number generato
-00019090: 7220 6973 2075 7365 642e 0d0a 0d0a 2020  r is used.....  
-000190a0: 5265 7475 726e 730d 0a20 202d 2d2d 2d2d  Returns..  -----
-000190b0: 2d2d 0d0a 2020 6f75 743a 2061 7272 6179  --..  out: array
-000190c0: 5f6c 696b 650d 0a20 2020 2041 2072 616e  _like..    A ran
-000190d0: 646f 6d20 6172 7261 7920 7769 7468 2062  dom array with b
-000190e0: 6f6f 6c65 616e 2064 7479 7065 2061 6e64  oolean dtype and
-000190f0: 2073 6861 7065 2067 6976 656e 2062 7920   shape given by 
-00019100: 6060 7368 6170 6560 6020 6966 2060 6073  ``shape`` if ``s
-00019110: 6861 7065 6060 0d0a 2020 2020 6973 206e  hape``..    is n
-00019120: 6f74 204e 6f6e 652c 206f 7220 656c 7365  ot None, or else
-00019130: 2060 6070 2e73 6861 7065 6060 2e0d 0a20   ``p.shape``... 
-00019140: 2022 2222 0d0a 2020 7265 7475 726e 2044   """..  return D
-00019150: 4546 4155 4c54 2e62 6572 6e6f 756c 6c69  EFAULT.bernoulli
-00019160: 2870 2c20 7369 7a65 2c20 6b65 793d 6b65  (p, size, key=ke
-00019170: 7929 0d0a 0d0a 0d0a 6465 6620 6c6f 676e  y)......def logn
-00019180: 6f72 6d61 6c28 6d65 616e 3d4e 6f6e 652c  ormal(mean=None,
-00019190: 2073 6967 6d61 3d4e 6f6e 652c 2073 697a   sigma=None, siz
-000191a0: 653a 204f 7074 696f 6e61 6c5b 5369 7a65  e: Optional[Size
-000191b0: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2020  ] = None,..     
-000191c0: 2020 2020 2020 2020 206b 6579 3a20 4f70           key: Op
-000191d0: 7469 6f6e 616c 5b53 6565 644f 724b 6579  tional[SeedOrKey
-000191e0: 5d20 3d20 4e6f 6e65 2c20 6474 7970 653a  ] = None, dtype:
-000191f0: 2044 5479 7065 4c69 6b65 203d 204e 6f6e   DTypeLike = Non
-00019200: 6529 3a0d 0a20 2072 2222 220d 0a20 2044  e):..  r"""..  D
-00019210: 7261 7720 7361 6d70 6c65 7320 6672 6f6d  raw samples from
-00019220: 2061 206c 6f67 2d6e 6f72 6d61 6c20 6469   a log-normal di
-00019230: 7374 7269 6275 7469 6f6e 2e0d 0a0d 0a20  stribution..... 
-00019240: 2044 7261 7720 7361 6d70 6c65 7320 6672   Draw samples fr
-00019250: 6f6d 2061 206c 6f67 2d6e 6f72 6d61 6c20  om a log-normal 
-00019260: 6469 7374 7269 6275 7469 6f6e 2077 6974  distribution wit
-00019270: 6820 7370 6563 6966 6965 6420 6d65 616e  h specified mean
-00019280: 2c0d 0a20 2073 7461 6e64 6172 6420 6465  ,..  standard de
-00019290: 7669 6174 696f 6e2c 2061 6e64 2061 7272  viation, and arr
-000192a0: 6179 2073 6861 7065 2e20 204e 6f74 6520  ay shape.  Note 
-000192b0: 7468 6174 2074 6865 206d 6561 6e20 616e  that the mean an
-000192c0: 6420 7374 616e 6461 7264 0d0a 2020 6465  d standard..  de
-000192d0: 7669 6174 696f 6e20 6172 6520 6e6f 7420  viation are not 
-000192e0: 7468 6520 7661 6c75 6573 2066 6f72 2074  the values for t
-000192f0: 6865 2064 6973 7472 6962 7574 696f 6e20  he distribution 
-00019300: 6974 7365 6c66 2c20 6275 7420 6f66 2074  itself, but of t
-00019310: 6865 0d0a 2020 756e 6465 726c 7969 6e67  he..  underlying
-00019320: 206e 6f72 6d61 6c20 6469 7374 7269 6275   normal distribu
-00019330: 7469 6f6e 2069 7420 6973 2064 6572 6976  tion it is deriv
-00019340: 6564 2066 726f 6d2e 0d0a 0d0a 2020 5061  ed from.....  Pa
-00019350: 7261 6d65 7465 7273 0d0a 2020 2d2d 2d2d  rameters..  ----
-00019360: 2d2d 2d2d 2d2d 0d0a 2020 6d65 616e 203a  ------..  mean :
-00019370: 2066 6c6f 6174 206f 7220 6172 7261 795f   float or array_
-00019380: 6c69 6b65 206f 6620 666c 6f61 7473 2c20  like of floats, 
-00019390: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-000193a0: 4d65 616e 2076 616c 7565 206f 6620 7468  Mean value of th
-000193b0: 6520 756e 6465 726c 7969 6e67 206e 6f72  e underlying nor
-000193c0: 6d61 6c20 6469 7374 7269 6275 7469 6f6e  mal distribution
-000193d0: 2e20 4465 6661 756c 7420 6973 2030 2e0d  . Default is 0..
-000193e0: 0a20 2073 6967 6d61 203a 2066 6c6f 6174  .  sigma : float
-000193f0: 206f 7220 6172 7261 795f 6c69 6b65 206f   or array_like o
-00019400: 6620 666c 6f61 7473 2c20 6f70 7469 6f6e  f floats, option
-00019410: 616c 0d0a 2020 2020 2020 5374 616e 6461  al..      Standa
-00019420: 7264 2064 6576 6961 7469 6f6e 206f 6620  rd deviation of 
-00019430: 7468 6520 756e 6465 726c 7969 6e67 206e  the underlying n
-00019440: 6f72 6d61 6c20 6469 7374 7269 6275 7469  ormal distributi
-00019450: 6f6e 2e20 4d75 7374 2062 650d 0a20 2020  on. Must be..   
-00019460: 2020 206e 6f6e 2d6e 6567 6174 6976 652e     non-negative.
-00019470: 2044 6566 6175 6c74 2069 7320 312e 0d0a   Default is 1...
-00019480: 2020 7369 7a65 203a 2069 6e74 206f 7220    size : int or 
-00019490: 7475 706c 6520 6f66 2069 6e74 732c 206f  tuple of ints, o
-000194a0: 7074 696f 6e61 6c0d 0a20 2020 2020 204f  ptional..      O
-000194b0: 7574 7075 7420 7368 6170 652e 2020 4966  utput shape.  If
-000194c0: 2074 6865 2067 6976 656e 2073 6861 7065   the given shape
-000194d0: 2069 732c 2065 2e67 2e2c 2060 6028 6d2c   is, e.g., ``(m,
-000194e0: 206e 2c20 6b29 6060 2c20 7468 656e 0d0a   n, k)``, then..
-000194f0: 2020 2020 2020 6060 6d20 2a20 6e20 2a20        ``m * n * 
-00019500: 6b60 6020 7361 6d70 6c65 7320 6172 6520  k`` samples are 
-00019510: 6472 6177 6e2e 2020 4966 2073 697a 6520  drawn.  If size 
-00019520: 6973 2060 604e 6f6e 6560 6020 2864 6566  is ``None`` (def
-00019530: 6175 6c74 292c 0d0a 2020 2020 2020 6120  ault),..      a 
-00019540: 7369 6e67 6c65 2076 616c 7565 2069 7320  single value is 
-00019550: 7265 7475 726e 6564 2069 6620 6060 6d65  returned if ``me
-00019560: 616e 6060 2061 6e64 2060 6073 6967 6d61  an`` and ``sigma
-00019570: 6060 2061 7265 2062 6f74 6820 7363 616c  `` are both scal
-00019580: 6172 732e 0d0a 2020 2020 2020 4f74 6865  ars...      Othe
-00019590: 7277 6973 652c 2060 606e 702e 6272 6f61  rwise, ``np.broa
-000195a0: 6463 6173 7428 6d65 616e 2c20 7369 676d  dcast(mean, sigm
-000195b0: 6129 2e73 697a 6560 6020 7361 6d70 6c65  a).size`` sample
-000195c0: 7320 6172 6520 6472 6177 6e2e 0d0a 2020  s are drawn...  
-000195d0: 6b65 7920 3a20 5052 4e47 4b65 792c 206f  key : PRNGKey, o
-000195e0: 7074 696f 6e61 6c0d 0a20 2020 2020 2054  ptional..      T
-000195f0: 6865 206b 6579 2066 6f72 2074 6865 2072  he key for the r
-00019600: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
-00019610: 6572 6174 6f72 2e20 4966 206e 6f74 2067  erator. If not g
-00019620: 6976 656e 2c20 7468 650d 0a20 2020 2020  iven, the..     
-00019630: 2064 6566 6175 6c74 2072 616e 646f 6d20   default random 
-00019640: 6e75 6d62 6572 2067 656e 6572 6174 6f72  number generator
-00019650: 2069 7320 7573 6564 2e0d 0a0d 0a20 2052   is used.....  R
-00019660: 6574 7572 6e73 0d0a 2020 2d2d 2d2d 2d2d  eturns..  ------
-00019670: 2d0d 0a20 206f 7574 203a 206e 6461 7272  -..  out : ndarr
-00019680: 6179 206f 7220 7363 616c 6172 0d0a 2020  ay or scalar..  
-00019690: 2020 2020 4472 6177 6e20 7361 6d70 6c65      Drawn sample
-000196a0: 7320 6672 6f6d 2074 6865 2070 6172 616d  s from the param
-000196b0: 6574 6572 697a 6564 206c 6f67 2d6e 6f72  eterized log-nor
-000196c0: 6d61 6c20 6469 7374 7269 6275 7469 6f6e  mal distribution
-000196d0: 2e0d 0a0d 0a20 2053 6565 2041 6c73 6f0d  .....  See Also.
-000196e0: 0a20 202d 2d2d 2d2d 2d2d 2d0d 0a20 2073  .  --------..  s
-000196f0: 6369 7079 2e73 7461 7473 2e6c 6f67 6e6f  cipy.stats.logno
-00019700: 726d 203a 2070 726f 6261 6269 6c69 7479  rm : probability
-00019710: 2064 656e 7369 7479 2066 756e 6374 696f   density functio
-00019720: 6e2c 2064 6973 7472 6962 7574 696f 6e2c  n, distribution,
-00019730: 0d0a 2020 2020 2020 6375 6d75 6c61 7469  ..      cumulati
-00019740: 7665 2064 656e 7369 7479 2066 756e 6374  ve density funct
-00019750: 696f 6e2c 2065 7463 2e0d 0a0d 0a20 204e  ion, etc.....  N
-00019760: 6f74 6573 0d0a 2020 2d2d 2d2d 2d0d 0a20  otes..  -----.. 
-00019770: 2041 2076 6172 6961 626c 6520 6078 6020   A variable `x` 
-00019780: 6861 7320 6120 6c6f 672d 6e6f 726d 616c  has a log-normal
-00019790: 2064 6973 7472 6962 7574 696f 6e20 6966   distribution if
-000197a0: 2060 6c6f 6728 7829 6020 6973 206e 6f72   `log(x)` is nor
-000197b0: 6d61 6c6c 790d 0a20 2064 6973 7472 6962  mally..  distrib
-000197c0: 7574 6564 2e20 2054 6865 2070 726f 6261  uted.  The proba
-000197d0: 6269 6c69 7479 2064 656e 7369 7479 2066  bility density f
-000197e0: 756e 6374 696f 6e20 666f 7220 7468 6520  unction for the 
-000197f0: 6c6f 672d 6e6f 726d 616c 0d0a 2020 6469  log-normal..  di
-00019800: 7374 7269 6275 7469 6f6e 2069 733a 0d0a  stribution is:..
-00019810: 0d0a 2020 2e2e 206d 6174 683a 3a20 7028  ..  .. math:: p(
-00019820: 7829 203d 205c 6672 6163 7b31 7d7b 5c73  x) = \frac{1}{\s
-00019830: 6967 6d61 2078 205c 7371 7274 7b32 5c70  igma x \sqrt{2\p
-00019840: 697d 7d0d 0a20 2020 2020 2020 2020 2020  i}}..           
-00019850: 2020 2020 2020 2020 655e 7b28 2d5c 6672          e^{(-\fr
-00019860: 6163 7b28 6c6e 2878 292d 5c6d 7529 5e32  ac{(ln(x)-\mu)^2
-00019870: 7d7b 325c 7369 676d 615e 327d 297d 0d0a  }{2\sigma^2})}..
-00019880: 0d0a 2020 7768 6572 6520 3a6d 6174 683a  ..  where :math:
-00019890: 605c 6d75 6020 6973 2074 6865 206d 6561  `\mu` is the mea
-000198a0: 6e20 616e 6420 3a6d 6174 683a 605c 7369  n and :math:`\si
-000198b0: 676d 6160 2069 7320 7468 6520 7374 616e  gma` is the stan
-000198c0: 6461 7264 0d0a 2020 6465 7669 6174 696f  dard..  deviatio
-000198d0: 6e20 6f66 2074 6865 206e 6f72 6d61 6c6c  n of the normall
-000198e0: 7920 6469 7374 7269 6275 7465 6420 6c6f  y distributed lo
-000198f0: 6761 7269 7468 6d20 6f66 2074 6865 2076  garithm of the v
-00019900: 6172 6961 626c 652e 0d0a 2020 4120 6c6f  ariable...  A lo
-00019910: 672d 6e6f 726d 616c 2064 6973 7472 6962  g-normal distrib
-00019920: 7574 696f 6e20 7265 7375 6c74 7320 6966  ution results if
-00019930: 2061 2072 616e 646f 6d20 7661 7269 6162   a random variab
-00019940: 6c65 2069 7320 7468 6520 2a70 726f 6475  le is the *produ
-00019950: 6374 2a0d 0a20 206f 6620 6120 6c61 7267  ct*..  of a larg
-00019960: 6520 6e75 6d62 6572 206f 6620 696e 6465  e number of inde
-00019970: 7065 6e64 656e 742c 2069 6465 6e74 6963  pendent, identic
-00019980: 616c 6c79 2d64 6973 7472 6962 7574 6564  ally-distributed
-00019990: 2076 6172 6961 626c 6573 2069 6e0d 0a20   variables in.. 
-000199a0: 2074 6865 2073 616d 6520 7761 7920 7468   the same way th
-000199b0: 6174 2061 206e 6f72 6d61 6c20 6469 7374  at a normal dist
-000199c0: 7269 6275 7469 6f6e 2072 6573 756c 7473  ribution results
-000199d0: 2069 6620 7468 6520 7661 7269 6162 6c65   if the variable
-000199e0: 2069 7320 7468 650d 0a20 202a 7375 6d2a   is the..  *sum*
-000199f0: 206f 6620 6120 6c61 7267 6520 6e75 6d62   of a large numb
-00019a00: 6572 206f 6620 696e 6465 7065 6e64 656e  er of independen
-00019a10: 742c 2069 6465 6e74 6963 616c 6c79 2d64  t, identically-d
-00019a20: 6973 7472 6962 7574 6564 0d0a 2020 7661  istributed..  va
-00019a30: 7269 6162 6c65 732e 0d0a 0d0a 2020 5265  riables.....  Re
-00019a40: 6665 7265 6e63 6573 0d0a 2020 2d2d 2d2d  ferences..  ----
-00019a50: 2d2d 2d2d 2d2d 0d0a 2020 2e2e 205b 315d  ------..  .. [1]
-00019a60: 204c 696d 7065 7274 2c20 452e 2c20 5374   Limpert, E., St
-00019a70: 6168 656c 2c20 572e 2041 2e2c 2061 6e64  ahel, W. A., and
-00019a80: 2041 6262 742c 204d 2e2c 2022 4c6f 672d   Abbt, M., "Log-
-00019a90: 6e6f 726d 616c 0d0a 2020 2020 2020 2020  normal..        
-00019aa0: 2044 6973 7472 6962 7574 696f 6e73 2061   Distributions a
-00019ab0: 6372 6f73 7320 7468 6520 5363 6965 6e63  cross the Scienc
-00019ac0: 6573 3a20 4b65 7973 2061 6e64 2043 6c75  es: Keys and Clu
-00019ad0: 6573 2c22 0d0a 2020 2020 2020 2020 2042  es,"..         B
-00019ae0: 696f 5363 6965 6e63 652c 2056 6f6c 2e20  ioScience, Vol. 
-00019af0: 3531 2c20 4e6f 2e20 352c 204d 6179 2c20  51, No. 5, May, 
-00019b00: 3230 3031 2e0d 0a20 2020 2020 2020 2020  2001...         
-00019b10: 6874 7470 733a 2f2f 7374 6174 2e65 7468  https://stat.eth
-00019b20: 7a2e 6368 2f7e 7374 6168 656c 2f6c 6f67  z.ch/~stahel/log
-00019b30: 6e6f 726d 616c 2f62 696f 7363 6965 6e63  normal/bioscienc
-00019b40: 652e 7064 660d 0a20 202e 2e20 5b32 5d20  e.pdf..  .. [2] 
-00019b50: 5265 6973 732c 2052 2e44 2e20 616e 6420  Reiss, R.D. and 
-00019b60: 5468 6f6d 6173 2c20 4d2e 2c20 2253 7461  Thomas, M., "Sta
-00019b70: 7469 7374 6963 616c 2041 6e61 6c79 7369  tistical Analysi
-00019b80: 7320 6f66 2045 7874 7265 6d65 0d0a 2020  s of Extreme..  
-00019b90: 2020 2020 2020 2056 616c 7565 732c 2220         Values," 
-00019ba0: 4261 7365 6c3a 2042 6972 6b68 6175 7365  Basel: Birkhause
-00019bb0: 7220 5665 726c 6167 2c20 3230 3031 2c20  r Verlag, 2001, 
-00019bc0: 7070 2e20 3331 2d33 322e 0d0a 0d0a 2020  pp. 31-32.....  
-00019bd0: 4578 616d 706c 6573 0d0a 2020 2d2d 2d2d  Examples..  ----
-00019be0: 2d2d 2d2d 0d0a 2020 4472 6177 2073 616d  ----..  Draw sam
-00019bf0: 706c 6573 2066 726f 6d20 7468 6520 6469  ples from the di
-00019c00: 7374 7269 6275 7469 6f6e 3a0d 0a0d 0a20  stribution:.... 
-00019c10: 203e 3e3e 206d 752c 2073 6967 6d61 203d   >>> mu, sigma =
-00019c20: 2033 2e2c 2031 2e20 2320 6d65 616e 2061   3., 1. # mean a
-00019c30: 6e64 2073 7461 6e64 6172 6420 6465 7669  nd standard devi
-00019c40: 6174 696f 6e0d 0a20 203e 3e3e 2073 203d  ation..  >>> s =
-00019c50: 2062 632e 7261 6e64 6f6d 2e6c 6f67 6e6f   bc.random.logno
-00019c60: 726d 616c 286d 752c 2073 6967 6d61 2c20  rmal(mu, sigma, 
-00019c70: 3130 3030 290d 0a0d 0a20 2044 6973 706c  1000)....  Displ
-00019c80: 6179 2074 6865 2068 6973 746f 6772 616d  ay the histogram
-00019c90: 206f 6620 7468 6520 7361 6d70 6c65 732c   of the samples,
-00019ca0: 2061 6c6f 6e67 2077 6974 680d 0a20 2074   along with..  t
-00019cb0: 6865 2070 726f 6261 6269 6c69 7479 2064  he probability d
-00019cc0: 656e 7369 7479 2066 756e 6374 696f 6e3a  ensity function:
-00019cd0: 0d0a 0d0a 2020 3e3e 3e20 696d 706f 7274  ....  >>> import
-00019ce0: 206d 6174 706c 6f74 6c69 622e 7079 706c   matplotlib.pypl
-00019cf0: 6f74 2061 7320 706c 7420 2023 206e 6f71  ot as plt  # noq
-00019d00: 610d 0a20 203e 3e3e 2063 6f75 6e74 2c20  a..  >>> count, 
-00019d10: 6269 6e73 2c20 6967 6e6f 7265 6420 3d20  bins, ignored = 
-00019d20: 706c 742e 6869 7374 2873 2c20 3130 302c  plt.hist(s, 100,
-00019d30: 2064 656e 7369 7479 3d54 7275 652c 2061   density=True, a
-00019d40: 6c69 676e 3d27 6d69 6427 290d 0a0d 0a20  lign='mid').... 
-00019d50: 203e 3e3e 2078 203d 206e 702e 6c69 6e73   >>> x = np.lins
-00019d60: 7061 6365 286d 696e 2862 696e 7329 2c20  pace(min(bins), 
-00019d70: 6d61 7828 6269 6e73 292c 2031 3030 3030  max(bins), 10000
-00019d80: 290d 0a20 203e 3e3e 2070 6466 203d 2028  )..  >>> pdf = (
-00019d90: 6e70 2e65 7870 282d 286e 702e 6c6f 6728  np.exp(-(np.log(
-00019da0: 7829 202d 206d 7529 2a2a 3220 2f20 2832  x) - mu)**2 / (2
-00019db0: 202a 2073 6967 6d61 2a2a 3229 290d 0a20   * sigma**2)).. 
-00019dc0: 202e 2e2e 2020 2020 2020 2020 2f20 2878   ...        / (x
-00019dd0: 202a 2073 6967 6d61 202a 206e 702e 7371   * sigma * np.sq
-00019de0: 7274 2832 202a 206e 702e 7069 2929 290d  rt(2 * np.pi))).
-00019df0: 0a0d 0a20 203e 3e3e 2070 6c74 2e70 6c6f  ...  >>> plt.plo
-00019e00: 7428 782c 2070 6466 2c20 6c69 6e65 7769  t(x, pdf, linewi
-00019e10: 6474 683d 322c 2063 6f6c 6f72 3d27 7227  dth=2, color='r'
-00019e20: 290d 0a20 203e 3e3e 2070 6c74 2e61 7869  )..  >>> plt.axi
-00019e30: 7328 2774 6967 6874 2729 0d0a 2020 3e3e  s('tight')..  >>
-00019e40: 3e20 706c 742e 7368 6f77 2829 0d0a 0d0a  > plt.show()....
-00019e50: 2020 4465 6d6f 6e73 7472 6174 6520 7468    Demonstrate th
-00019e60: 6174 2074 616b 696e 6720 7468 6520 7072  at taking the pr
-00019e70: 6f64 7563 7473 206f 6620 7261 6e64 6f6d  oducts of random
-00019e80: 2073 616d 706c 6573 2066 726f 6d20 6120   samples from a 
-00019e90: 756e 6966 6f72 6d0d 0a20 2064 6973 7472  uniform..  distr
-00019ea0: 6962 7574 696f 6e20 6361 6e20 6265 2066  ibution can be f
-00019eb0: 6974 2077 656c 6c20 6279 2061 206c 6f67  it well by a log
-00019ec0: 2d6e 6f72 6d61 6c20 7072 6f62 6162 696c  -normal probabil
-00019ed0: 6974 7920 6465 6e73 6974 790d 0a20 2066  ity density..  f
-00019ee0: 756e 6374 696f 6e2e 0d0a 0d0a 2020 3e3e  unction.....  >>
-00019ef0: 3e20 2320 4765 6e65 7261 7465 2061 2074  > # Generate a t
-00019f00: 686f 7573 616e 6420 7361 6d70 6c65 733a  housand samples:
-00019f10: 2065 6163 6820 6973 2074 6865 2070 726f   each is the pro
-00019f20: 6475 6374 206f 6620 3130 3020 7261 6e64  duct of 100 rand
-00019f30: 6f6d 0d0a 2020 3e3e 3e20 2320 7661 6c75  om..  >>> # valu
-00019f40: 6573 2c20 6472 6177 6e20 6672 6f6d 2061  es, drawn from a
-00019f50: 206e 6f72 6d61 6c20 6469 7374 7269 6275   normal distribu
-00019f60: 7469 6f6e 2e0d 0a20 203e 3e3e 2062 203d  tion...  >>> b =
-00019f70: 205b 5d0d 0a20 203e 3e3e 2066 6f72 2069   []..  >>> for i
-00019f80: 2069 6e20 7261 6e67 6528 3130 3030 293a   in range(1000):
-00019f90: 0d0a 2020 2e2e 2e20 2020 2061 203d 2031  ..  ...    a = 1
-00019fa0: 302e 202b 2062 632e 7261 6e64 6f6d 2e73  0. + bc.random.s
-00019fb0: 7461 6e64 6172 645f 6e6f 726d 616c 2831  tandard_normal(1
-00019fc0: 3030 290d 0a20 202e 2e2e 2020 2020 622e  00)..  ...    b.
-00019fd0: 6170 7065 6e64 286e 702e 7072 6f64 7563  append(np.produc
-00019fe0: 7428 6129 290d 0a0d 0a20 203e 3e3e 2062  t(a))....  >>> b
-00019ff0: 203d 206e 702e 6172 7261 7928 6229 202f   = np.array(b) /
-0001a000: 206e 702e 6d69 6e28 6229 2023 2073 6361   np.min(b) # sca
-0001a010: 6c65 2076 616c 7565 7320 746f 2062 6520  le values to be 
-0001a020: 706f 7369 7469 7665 0d0a 2020 3e3e 3e20  positive..  >>> 
-0001a030: 636f 756e 742c 2062 696e 732c 2069 676e  count, bins, ign
-0001a040: 6f72 6564 203d 2070 6c74 2e68 6973 7428  ored = plt.hist(
-0001a050: 622c 2031 3030 2c20 6465 6e73 6974 793d  b, 100, density=
-0001a060: 5472 7565 2c20 616c 6967 6e3d 276d 6964  True, align='mid
-0001a070: 2729 0d0a 2020 3e3e 3e20 7369 676d 6120  ')..  >>> sigma 
-0001a080: 3d20 6e70 2e73 7464 286e 702e 6c6f 6728  = np.std(np.log(
-0001a090: 6229 290d 0a20 203e 3e3e 206d 7520 3d20  b))..  >>> mu = 
-0001a0a0: 6e70 2e6d 6561 6e28 6e70 2e6c 6f67 2862  np.mean(np.log(b
-0001a0b0: 2929 0d0a 0d0a 2020 3e3e 3e20 7820 3d20  ))....  >>> x = 
-0001a0c0: 6e70 2e6c 696e 7370 6163 6528 6d69 6e28  np.linspace(min(
-0001a0d0: 6269 6e73 292c 206d 6178 2862 696e 7329  bins), max(bins)
-0001a0e0: 2c20 3130 3030 3029 0d0a 2020 3e3e 3e20  , 10000)..  >>> 
-0001a0f0: 7064 6620 3d20 286e 702e 6578 7028 2d28  pdf = (np.exp(-(
-0001a100: 6e70 2e6c 6f67 2878 2920 2d20 6d75 292a  np.log(x) - mu)*
-0001a110: 2a32 202f 2028 3220 2a20 7369 676d 612a  *2 / (2 * sigma*
-0001a120: 2a32 2929 0d0a 2020 2e2e 2e20 2020 2020  *2))..  ...     
-0001a130: 2020 202f 2028 7820 2a20 7369 676d 6120     / (x * sigma 
-0001a140: 2a20 6e70 2e73 7172 7428 3220 2a20 6e70  * np.sqrt(2 * np
-0001a150: 2e70 6929 2929 0d0a 0d0a 2020 3e3e 3e20  .pi)))....  >>> 
-0001a160: 706c 742e 706c 6f74 2878 2c20 7064 662c  plt.plot(x, pdf,
-0001a170: 2063 6f6c 6f72 3d27 7227 2c20 6c69 6e65   color='r', line
-0001a180: 7769 6474 683d 3229 0d0a 2020 3e3e 3e20  width=2)..  >>> 
-0001a190: 706c 742e 7368 6f77 2829 0d0a 2020 2222  plt.show()..  ""
-0001a1a0: 220d 0a20 2072 6574 7572 6e20 4445 4641  "..  return DEFA
-0001a1b0: 554c 542e 6c6f 676e 6f72 6d61 6c28 6d65  ULT.lognormal(me
-0001a1c0: 616e 2c20 7369 676d 612c 2073 697a 652c  an, sigma, size,
-0001a1d0: 206b 6579 3d6b 6579 2c20 6474 7970 653d   key=key, dtype=
-0001a1e0: 6474 7970 6529 0d0a 0d0a 0d0a 6465 6620  dtype)......def 
-0001a1f0: 6269 6e6f 6d69 616c 286e 2c20 702c 2073  binomial(n, p, s
-0001a200: 697a 653a 204f 7074 696f 6e61 6c5b 5369  ize: Optional[Si
-0001a210: 7a65 5d20 3d20 4e6f 6e65 2c20 6b65 793a  ze] = None, key:
-0001a220: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
-0001a230: 4b65 795d 203d 204e 6f6e 652c 2064 7479  Key] = None, dty
-0001a240: 7065 3a20 4454 7970 654c 696b 6520 3d20  pe: DTypeLike = 
-0001a250: 4e6f 6e65 293a 0d0a 2020 7222 2222 0d0a  None):..  r"""..
-0001a260: 2020 4472 6177 2073 616d 706c 6573 2066    Draw samples f
-0001a270: 726f 6d20 6120 6269 6e6f 6d69 616c 2064  rom a binomial d
-0001a280: 6973 7472 6962 7574 696f 6e2e 0d0a 0d0a  istribution.....
-0001a290: 2020 5361 6d70 6c65 7320 6172 6520 6472    Samples are dr
-0001a2a0: 6177 6e20 6672 6f6d 2061 2062 696e 6f6d  awn from a binom
-0001a2b0: 6961 6c20 6469 7374 7269 6275 7469 6f6e  ial distribution
-0001a2c0: 2077 6974 6820 7370 6563 6966 6965 640d   with specified.
-0001a2d0: 0a20 2070 6172 616d 6574 6572 732c 206e  .  parameters, n
-0001a2e0: 2074 7269 616c 7320 616e 6420 7020 7072   trials and p pr
-0001a2f0: 6f62 6162 696c 6974 7920 6f66 2073 7563  obability of suc
-0001a300: 6365 7373 2077 6865 7265 0d0a 2020 6e20  cess where..  n 
-0001a310: 616e 2069 6e74 6567 6572 203e 3d20 3020  an integer >= 0 
-0001a320: 616e 6420 7020 6973 2069 6e20 7468 6520  and p is in the 
-0001a330: 696e 7465 7276 616c 205b 302c 315d 2e20  interval [0,1]. 
-0001a340: 286e 206d 6179 2062 650d 0a20 2069 6e70  (n may be..  inp
-0001a350: 7574 2061 7320 6120 666c 6f61 742c 2062  ut as a float, b
-0001a360: 7574 2069 7420 6973 2074 7275 6e63 6174  ut it is truncat
-0001a370: 6564 2074 6f20 616e 2069 6e74 6567 6572  ed to an integer
-0001a380: 2069 6e20 7573 6529 0d0a 0d0a 2020 5061   in use)....  Pa
-0001a390: 7261 6d65 7465 7273 0d0a 2020 2d2d 2d2d  rameters..  ----
-0001a3a0: 2d2d 2d2d 2d2d 0d0a 2020 6e20 3a20 696e  ------..  n : in
-0001a3b0: 7420 6f72 2061 7272 6179 5f6c 696b 6520  t or array_like 
-0001a3c0: 6f66 2069 6e74 730d 0a20 2020 2020 2050  of ints..      P
-0001a3d0: 6172 616d 6574 6572 206f 6620 7468 6520  arameter of the 
-0001a3e0: 6469 7374 7269 6275 7469 6f6e 2c20 3e3d  distribution, >=
-0001a3f0: 2030 2e20 466c 6f61 7473 2061 7265 2061   0. Floats are a
-0001a400: 6c73 6f20 6163 6365 7074 6564 2c0d 0a20  lso accepted,.. 
-0001a410: 2020 2020 2062 7574 2074 6865 7920 7769       but they wi
-0001a420: 6c6c 2062 6520 7472 756e 6361 7465 6420  ll be truncated 
-0001a430: 746f 2069 6e74 6567 6572 732e 0d0a 2020  to integers...  
-0001a440: 7020 3a20 666c 6f61 7420 6f72 2061 7272  p : float or arr
-0001a450: 6179 5f6c 696b 6520 6f66 2066 6c6f 6174  ay_like of float
-0001a460: 730d 0a20 2020 2020 2050 6172 616d 6574  s..      Paramet
-0001a470: 6572 206f 6620 7468 6520 6469 7374 7269  er of the distri
-0001a480: 6275 7469 6f6e 2c20 3e3d 2030 2061 6e64  bution, >= 0 and
-0001a490: 203c 3d31 2e0d 0a20 2073 697a 6520 3a20   <=1...  size : 
-0001a4a0: 696e 7420 6f72 2074 7570 6c65 206f 6620  int or tuple of 
-0001a4b0: 696e 7473 2c20 6f70 7469 6f6e 616c 0d0a  ints, optional..
-0001a4c0: 2020 2020 2020 4f75 7470 7574 2073 6861        Output sha
-0001a4d0: 7065 2e20 2049 6620 7468 6520 6769 7665  pe.  If the give
-0001a4e0: 6e20 7368 6170 6520 6973 2c20 652e 672e  n shape is, e.g.
-0001a4f0: 2c20 6060 286d 2c20 6e2c 206b 2960 602c  , ``(m, n, k)``,
-0001a500: 2074 6865 6e0d 0a20 2020 2020 2060 606d   then..      ``m
-0001a510: 202a 206e 202a 206b 6060 2073 616d 706c   * n * k`` sampl
-0001a520: 6573 2061 7265 2064 7261 776e 2e20 2049  es are drawn.  I
-0001a530: 6620 7369 7a65 2069 7320 6060 4e6f 6e65  f size is ``None
-0001a540: 6060 2028 6465 6661 756c 7429 2c0d 0a20  `` (default),.. 
-0001a550: 2020 2020 2061 2073 696e 676c 6520 7661       a single va
-0001a560: 6c75 6520 6973 2072 6574 7572 6e65 6420  lue is returned 
-0001a570: 6966 2060 606e 6060 2061 6e64 2060 6070  if ``n`` and ``p
-0001a580: 6060 2061 7265 2062 6f74 6820 7363 616c  `` are both scal
-0001a590: 6172 732e 0d0a 2020 2020 2020 4f74 6865  ars...      Othe
-0001a5a0: 7277 6973 652c 2060 606e 702e 6272 6f61  rwise, ``np.broa
-0001a5b0: 6463 6173 7428 6e2c 2070 292e 7369 7a65  dcast(n, p).size
-0001a5c0: 6060 2073 616d 706c 6573 2061 7265 2064  `` samples are d
-0001a5d0: 7261 776e 2e0d 0a20 206b 6579 203a 2050  rawn...  key : P
-0001a5e0: 524e 474b 6579 2c20 6f70 7469 6f6e 616c  RNGKey, optional
-0001a5f0: 0d0a 2020 2020 2020 5468 6520 6b65 7920  ..      The key 
-0001a600: 666f 7220 7468 6520 7261 6e64 6f6d 206e  for the random n
-0001a610: 756d 6265 7220 6765 6e65 7261 746f 722e  umber generator.
-0001a620: 2049 6620 6e6f 7420 6769 7665 6e2c 2074   If not given, t
-0001a630: 6865 0d0a 2020 2020 2020 6465 6661 756c  he..      defaul
-0001a640: 7420 7261 6e64 6f6d 206e 756d 6265 7220  t random number 
-0001a650: 6765 6e65 7261 746f 7220 6973 2075 7365  generator is use
-0001a660: 642e 0d0a 0d0a 2020 5265 7475 726e 730d  d.....  Returns.
-0001a670: 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020 6f75  .  -------..  ou
-0001a680: 7420 3a20 6e64 6172 7261 7920 6f72 2073  t : ndarray or s
-0001a690: 6361 6c61 720d 0a20 2020 2020 2044 7261  calar..      Dra
-0001a6a0: 776e 2073 616d 706c 6573 2066 726f 6d20  wn samples from 
-0001a6b0: 7468 6520 7061 7261 6d65 7465 7269 7a65  the parameterize
-0001a6c0: 6420 6269 6e6f 6d69 616c 2064 6973 7472  d binomial distr
-0001a6d0: 6962 7574 696f 6e2c 2077 6865 7265 0d0a  ibution, where..
-0001a6e0: 2020 2020 2020 6561 6368 2073 616d 706c        each sampl
-0001a6f0: 6520 6973 2065 7175 616c 2074 6f20 7468  e is equal to th
-0001a700: 6520 6e75 6d62 6572 206f 6620 7375 6363  e number of succ
-0001a710: 6573 7365 7320 6f76 6572 2074 6865 206e  esses over the n
-0001a720: 2074 7269 616c 732e 0d0a 0d0a 2020 5365   trials.....  Se
-0001a730: 6520 416c 736f 0d0a 2020 2d2d 2d2d 2d2d  e Also..  ------
-0001a740: 2d2d 0d0a 2020 7363 6970 792e 7374 6174  --..  scipy.stat
-0001a750: 732e 6269 6e6f 6d20 3a20 7072 6f62 6162  s.binom : probab
-0001a760: 696c 6974 7920 6465 6e73 6974 7920 6675  ility density fu
-0001a770: 6e63 7469 6f6e 2c20 6469 7374 7269 6275  nction, distribu
-0001a780: 7469 6f6e 206f 720d 0a20 2020 2020 2063  tion or..      c
-0001a790: 756d 756c 6174 6976 6520 6465 6e73 6974  umulative densit
-0001a7a0: 7920 6675 6e63 7469 6f6e 2c20 6574 632e  y function, etc.
-0001a7b0: 0d0a 0d0a 2020 4e6f 7465 730d 0a20 202d  ....  Notes..  -
-0001a7c0: 2d2d 2d2d 0d0a 2020 5468 6520 7072 6f62  ----..  The prob
-0001a7d0: 6162 696c 6974 7920 6465 6e73 6974 7920  ability density 
-0001a7e0: 666f 7220 7468 6520 6269 6e6f 6d69 616c  for the binomial
-0001a7f0: 2064 6973 7472 6962 7574 696f 6e20 6973   distribution is
-0001a800: 0d0a 0d0a 2020 2e2e 206d 6174 683a 3a20  ....  .. math:: 
-0001a810: 5028 4e29 203d 205c 6269 6e6f 6d7b 6e7d  P(N) = \binom{n}
-0001a820: 7b4e 7d70 5e4e 2831 2d70 295e 7b6e 2d4e  {N}p^N(1-p)^{n-N
-0001a830: 7d2c 0d0a 0d0a 2020 7768 6572 6520 3a6d  },....  where :m
-0001a840: 6174 683a 606e 6020 6973 2074 6865 206e  ath:`n` is the n
-0001a850: 756d 6265 7220 6f66 2074 7269 616c 732c  umber of trials,
-0001a860: 203a 6d61 7468 3a60 7060 2069 7320 7468   :math:`p` is th
-0001a870: 6520 7072 6f62 6162 696c 6974 790d 0a20  e probability.. 
-0001a880: 206f 6620 7375 6363 6573 732c 2061 6e64   of success, and
-0001a890: 203a 6d61 7468 3a60 4e60 2069 7320 7468   :math:`N` is th
-0001a8a0: 6520 6e75 6d62 6572 206f 6620 7375 6363  e number of succ
-0001a8b0: 6573 7365 732e 0d0a 0d0a 2020 5768 656e  esses.....  When
-0001a8c0: 2065 7374 696d 6174 696e 6720 7468 6520   estimating the 
-0001a8d0: 7374 616e 6461 7264 2065 7272 6f72 206f  standard error o
-0001a8e0: 6620 6120 7072 6f70 6f72 7469 6f6e 2069  f a proportion i
-0001a8f0: 6e20 6120 706f 7075 6c61 7469 6f6e 2062  n a population b
-0001a900: 790d 0a20 2075 7369 6e67 2061 2072 616e  y..  using a ran
-0001a910: 646f 6d20 7361 6d70 6c65 2c20 7468 6520  dom sample, the 
-0001a920: 6e6f 726d 616c 2064 6973 7472 6962 7574  normal distribut
-0001a930: 696f 6e20 776f 726b 7320 7765 6c6c 2075  ion works well u
-0001a940: 6e6c 6573 7320 7468 650d 0a20 2070 726f  nless the..  pro
-0001a950: 6475 6374 2070 2a6e 203c 3d35 2c20 7768  duct p*n <=5, wh
-0001a960: 6572 6520 7020 3d20 706f 7075 6c61 7469  ere p = populati
-0001a970: 6f6e 2070 726f 706f 7274 696f 6e20 6573  on proportion es
-0001a980: 7469 6d61 7465 2c20 616e 6420 6e20 3d0d  timate, and n =.
-0001a990: 0a20 206e 756d 6265 7220 6f66 2073 616d  .  number of sam
-0001a9a0: 706c 6573 2c20 696e 2077 6869 6368 2063  ples, in which c
-0001a9b0: 6173 6520 7468 6520 6269 6e6f 6d69 616c  ase the binomial
-0001a9c0: 2064 6973 7472 6962 7574 696f 6e20 6973   distribution is
-0001a9d0: 2075 7365 640d 0a20 2069 6e73 7465 6164   used..  instead
-0001a9e0: 2e20 466f 7220 6578 616d 706c 652c 2061  . For example, a
-0001a9f0: 2073 616d 706c 6520 6f66 2031 3520 7065   sample of 15 pe
-0001aa00: 6f70 6c65 2073 686f 7773 2034 2077 686f  ople shows 4 who
-0001aa10: 2061 7265 206c 6566 740d 0a20 2068 616e   are left..  han
-0001aa20: 6465 642c 2061 6e64 2031 3120 7768 6f20  ded, and 11 who 
-0001aa30: 6172 6520 7269 6768 7420 6861 6e64 6564  are right handed
-0001aa40: 2e20 5468 656e 2070 203d 2034 2f31 3520  . Then p = 4/15 
-0001aa50: 3d20 3237 252e 2030 2e32 372a 3135 203d  = 27%. 0.27*15 =
-0001aa60: 2034 2c0d 0a20 2073 6f20 7468 6520 6269   4,..  so the bi
-0001aa70: 6e6f 6d69 616c 2064 6973 7472 6962 7574  nomial distribut
-0001aa80: 696f 6e20 7368 6f75 6c64 2062 6520 7573  ion should be us
-0001aa90: 6564 2069 6e20 7468 6973 2063 6173 652e  ed in this case.
-0001aaa0: 0d0a 0d0a 2020 5265 6665 7265 6e63 6573  ....  References
-0001aab0: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  ..  ----------..
-0001aac0: 2020 2e2e 205b 315d 2044 616c 6761 6172    .. [1] Dalgaar
-0001aad0: 642c 2050 6574 6572 2c20 2249 6e74 726f  d, Peter, "Intro
-0001aae0: 6475 6374 6f72 7920 5374 6174 6973 7469  ductory Statisti
-0001aaf0: 6373 2077 6974 6820 5222 2c0d 0a20 2020  cs with R",..   
-0001ab00: 2020 2020 2020 5370 7269 6e67 6572 2d56        Springer-V
-0001ab10: 6572 6c61 672c 2032 3030 322e 0d0a 2020  erlag, 2002...  
-0001ab20: 2e2e 205b 325d 2047 6c61 6e74 7a2c 2053  .. [2] Glantz, S
-0001ab30: 7461 6e74 6f6e 2041 2e20 2250 7269 6d65  tanton A. "Prime
-0001ab40: 7220 6f66 2042 696f 7374 6174 6973 7469  r of Biostatisti
-0001ab50: 6373 2e22 2c20 4d63 4772 6177 2d48 696c  cs.", McGraw-Hil
-0001ab60: 6c2c 0d0a 2020 2020 2020 2020 2046 6966  l,..         Fif
-0001ab70: 7468 2045 6469 7469 6f6e 2c20 3230 3032  th Edition, 2002
-0001ab80: 2e0d 0a20 202e 2e20 5b33 5d20 4c65 6e74  ...  .. [3] Lent
-0001ab90: 6e65 722c 204d 6172 7669 6e2c 2022 456c  ner, Marvin, "El
-0001aba0: 656d 656e 7461 7279 2041 7070 6c69 6564  ementary Applied
-0001abb0: 2053 7461 7469 7374 6963 7322 2c20 426f   Statistics", Bo
-0001abc0: 6764 656e 0d0a 2020 2020 2020 2020 2061  gden..         a
-0001abd0: 6e64 2051 7569 676c 6579 2c20 3139 3732  nd Quigley, 1972
-0001abe0: 2e0d 0a20 202e 2e20 5b34 5d20 5765 6973  ...  .. [4] Weis
-0001abf0: 7374 6569 6e2c 2045 7269 6320 572e 2022  stein, Eric W. "
-0001ac00: 4269 6e6f 6d69 616c 2044 6973 7472 6962  Binomial Distrib
-0001ac10: 7574 696f 6e2e 2220 4672 6f6d 204d 6174  ution." From Mat
-0001ac20: 6857 6f72 6c64 2d2d 410d 0a20 2020 2020  hWorld--A..     
-0001ac30: 2020 2020 576f 6c66 7261 6d20 5765 6220      Wolfram Web 
-0001ac40: 5265 736f 7572 6365 2e0d 0a20 2020 2020  Resource...     
-0001ac50: 2020 2020 6874 7470 3a2f 2f6d 6174 6877      http://mathw
-0001ac60: 6f72 6c64 2e77 6f6c 6672 616d 2e63 6f6d  orld.wolfram.com
-0001ac70: 2f42 696e 6f6d 6961 6c44 6973 7472 6962  /BinomialDistrib
-0001ac80: 7574 696f 6e2e 6874 6d6c 0d0a 2020 2e2e  ution.html..  ..
-0001ac90: 205b 355d 2057 696b 6970 6564 6961 2c20   [5] Wikipedia, 
-0001aca0: 2242 696e 6f6d 6961 6c20 6469 7374 7269  "Binomial distri
-0001acb0: 6275 7469 6f6e 222c 0d0a 2020 2020 2020  bution",..      
-0001acc0: 2020 2068 7474 7073 3a2f 2f65 6e2e 7769     https://en.wi
-0001acd0: 6b69 7065 6469 612e 6f72 672f 7769 6b69  kipedia.org/wiki
-0001ace0: 2f42 696e 6f6d 6961 6c5f 6469 7374 7269  /Binomial_distri
-0001acf0: 6275 7469 6f6e 0d0a 0d0a 2020 4578 616d  bution....  Exam
-0001ad00: 706c 6573 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ples..  --------
-0001ad10: 0d0a 2020 4472 6177 2073 616d 706c 6573  ..  Draw samples
-0001ad20: 2066 726f 6d20 7468 6520 6469 7374 7269   from the distri
-0001ad30: 6275 7469 6f6e 3a0d 0a0d 0a20 203e 3e3e  bution:....  >>>
-0001ad40: 206e 2c20 7020 3d20 3130 2c20 2e35 2020   n, p = 10, .5  
-0001ad50: 2320 6e75 6d62 6572 206f 6620 7472 6961  # number of tria
-0001ad60: 6c73 2c20 7072 6f62 6162 696c 6974 7920  ls, probability 
-0001ad70: 6f66 2065 6163 6820 7472 6961 6c0d 0a20  of each trial.. 
-0001ad80: 203e 3e3e 2073 203d 2062 632e 7261 6e64   >>> s = bc.rand
-0001ad90: 6f6d 2e62 696e 6f6d 6961 6c28 6e2c 2070  om.binomial(n, p
-0001ada0: 2c20 3130 3030 290d 0a20 2023 2072 6573  , 1000)..  # res
-0001adb0: 756c 7420 6f66 2066 6c69 7070 696e 6720  ult of flipping 
-0001adc0: 6120 636f 696e 2031 3020 7469 6d65 732c  a coin 10 times,
-0001add0: 2074 6573 7465 6420 3130 3030 2074 696d   tested 1000 tim
-0001ade0: 6573 2e0d 0a0d 0a20 2041 2072 6561 6c20  es.....  A real 
-0001adf0: 776f 726c 6420 6578 616d 706c 652e 2041  world example. A
-0001ae00: 2063 6f6d 7061 6e79 2064 7269 6c6c 7320   company drills 
-0001ae10: 3920 7769 6c64 2d63 6174 206f 696c 2065  9 wild-cat oil e
-0001ae20: 7870 6c6f 7261 7469 6f6e 0d0a 2020 7765  xploration..  we
-0001ae30: 6c6c 732c 2065 6163 6820 7769 7468 2061  lls, each with a
-0001ae40: 6e20 6573 7469 6d61 7465 6420 7072 6f62  n estimated prob
-0001ae50: 6162 696c 6974 7920 6f66 2073 7563 6365  ability of succe
-0001ae60: 7373 206f 6620 302e 312e 2041 6c6c 206e  ss of 0.1. All n
-0001ae70: 696e 650d 0a20 2077 656c 6c73 2066 6169  ine..  wells fai
-0001ae80: 6c2e 2057 6861 7420 6973 2074 6865 2070  l. What is the p
-0001ae90: 726f 6261 6269 6c69 7479 206f 6620 7468  robability of th
-0001aea0: 6174 2068 6170 7065 6e69 6e67 3f0d 0a0d  at happening?...
-0001aeb0: 0a20 204c 6574 2773 2064 6f20 3230 2c30  .  Let's do 20,0
-0001aec0: 3030 2074 7269 616c 7320 6f66 2074 6865  00 trials of the
-0001aed0: 206d 6f64 656c 2c20 616e 6420 636f 756e   model, and coun
-0001aee0: 7420 7468 6520 6e75 6d62 6572 2074 6861  t the number tha
-0001aef0: 740d 0a20 2067 656e 6572 6174 6520 7a65  t..  generate ze
-0001af00: 726f 2070 6f73 6974 6976 6520 7265 7375  ro positive resu
-0001af10: 6c74 732e 0d0a 0d0a 2020 3e3e 3e20 7375  lts.....  >>> su
-0001af20: 6d28 6263 2e72 616e 646f 6d2e 6269 6e6f  m(bc.random.bino
-0001af30: 6d69 616c 2839 2c20 302e 312c 2032 3030  mial(9, 0.1, 200
-0001af40: 3030 2920 3d3d 2030 292f 3230 3030 302e  00) == 0)/20000.
-0001af50: 0d0a 2020 2320 616e 7377 6572 203d 2030  ..  # answer = 0
-0001af60: 2e33 3838 3835 2c20 6f72 2033 3825 2e0d  .38885, or 38%..
-0001af70: 0a20 2022 2222 0d0a 2020 7265 7475 726e  .  """..  return
-0001af80: 2044 4546 4155 4c54 2e62 696e 6f6d 6961   DEFAULT.binomia
-0001af90: 6c28 6e2c 2070 2c20 7369 7a65 2c20 6b65  l(n, p, size, ke
-0001afa0: 793d 6b65 792c 2064 7479 7065 3d64 7479  y=key, dtype=dty
-0001afb0: 7065 290d 0a0d 0a0d 0a64 6566 2063 6869  pe)......def chi
-0001afc0: 7371 7561 7265 2864 662c 2073 697a 653a  square(df, size:
-0001afd0: 204f 7074 696f 6e61 6c5b 5369 7a65 5d20   Optional[Size] 
-0001afe0: 3d20 4e6f 6e65 2c20 6b65 793a 204f 7074  = None, key: Opt
-0001aff0: 696f 6e61 6c5b 5365 6564 4f72 4b65 795d  ional[SeedOrKey]
-0001b000: 203d 204e 6f6e 652c 2064 7479 7065 3a20   = None, dtype: 
-0001b010: 4454 7970 654c 696b 6520 3d20 4e6f 6e65  DTypeLike = None
-0001b020: 293a 0d0a 2020 7222 2222 0d0a 2020 4472  ):..  r"""..  Dr
-0001b030: 6177 2073 616d 706c 6573 2066 726f 6d20  aw samples from 
-0001b040: 6120 6368 692d 7371 7561 7265 2064 6973  a chi-square dis
-0001b050: 7472 6962 7574 696f 6e2e 0d0a 0d0a 2020  tribution.....  
-0001b060: 5768 656e 2060 6466 6020 696e 6465 7065  When `df` indepe
-0001b070: 6e64 656e 7420 7261 6e64 6f6d 2076 6172  ndent random var
-0001b080: 6961 626c 6573 2c20 6561 6368 2077 6974  iables, each wit
-0001b090: 6820 7374 616e 6461 7264 206e 6f72 6d61  h standard norma
-0001b0a0: 6c0d 0a20 2064 6973 7472 6962 7574 696f  l..  distributio
-0001b0b0: 6e73 2028 6d65 616e 2030 2c20 7661 7269  ns (mean 0, vari
-0001b0c0: 616e 6365 2031 292c 2061 7265 2073 7175  ance 1), are squ
-0001b0d0: 6172 6564 2061 6e64 2073 756d 6d65 642c  ared and summed,
-0001b0e0: 2074 6865 0d0a 2020 7265 7375 6c74 696e   the..  resultin
-0001b0f0: 6720 6469 7374 7269 6275 7469 6f6e 2069  g distribution i
-0001b100: 7320 6368 692d 7371 7561 7265 2028 7365  s chi-square (se
-0001b110: 6520 4e6f 7465 7329 2e20 2054 6869 7320  e Notes).  This 
-0001b120: 6469 7374 7269 6275 7469 6f6e 0d0a 2020  distribution..  
-0001b130: 6973 206f 6674 656e 2075 7365 6420 696e  is often used in
-0001b140: 2068 7970 6f74 6865 7369 7320 7465 7374   hypothesis test
-0001b150: 696e 672e 0d0a 0d0a 2020 5061 7261 6d65  ing.....  Parame
-0001b160: 7465 7273 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ters..  --------
-0001b170: 2d2d 0d0a 2020 6466 203a 2066 6c6f 6174  --..  df : float
-0001b180: 206f 7220 6172 7261 795f 6c69 6b65 206f   or array_like o
-0001b190: 6620 666c 6f61 7473 0d0a 2020 2020 2020  f floats..      
-0001b1a0: 204e 756d 6265 7220 6f66 2064 6567 7265   Number of degre
-0001b1b0: 6573 206f 6620 6672 6565 646f 6d2c 206d  es of freedom, m
-0001b1c0: 7573 7420 6265 203e 2030 2e0d 0a20 2073  ust be > 0...  s
-0001b1d0: 697a 6520 3a20 696e 7420 6f72 2074 7570  ize : int or tup
-0001b1e0: 6c65 206f 6620 696e 7473 2c20 6f70 7469  le of ints, opti
-0001b1f0: 6f6e 616c 0d0a 2020 2020 2020 4f75 7470  onal..      Outp
-0001b200: 7574 2073 6861 7065 2e20 2049 6620 7468  ut shape.  If th
-0001b210: 6520 6769 7665 6e20 7368 6170 6520 6973  e given shape is
-0001b220: 2c20 652e 672e 2c20 6060 286d 2c20 6e2c  , e.g., ``(m, n,
-0001b230: 206b 2960 602c 2074 6865 6e0d 0a20 2020   k)``, then..   
-0001b240: 2020 2060 606d 202a 206e 202a 206b 6060     ``m * n * k``
-0001b250: 2073 616d 706c 6573 2061 7265 2064 7261   samples are dra
-0001b260: 776e 2e20 2049 6620 7369 7a65 2069 7320  wn.  If size is 
-0001b270: 6060 4e6f 6e65 6060 2028 6465 6661 756c  ``None`` (defaul
-0001b280: 7429 2c0d 0a20 2020 2020 2061 2073 696e  t),..      a sin
-0001b290: 676c 6520 7661 6c75 6520 6973 2072 6574  gle value is ret
-0001b2a0: 7572 6e65 6420 6966 2060 6064 6660 6020  urned if ``df`` 
-0001b2b0: 6973 2061 2073 6361 6c61 722e 2020 4f74  is a scalar.  Ot
-0001b2c0: 6865 7277 6973 652c 0d0a 2020 2020 2020  herwise,..      
-0001b2d0: 6060 6e70 2e61 7272 6179 2864 6629 2e73  ``np.array(df).s
-0001b2e0: 697a 6560 6020 7361 6d70 6c65 7320 6172  ize`` samples ar
-0001b2f0: 6520 6472 6177 6e2e 0d0a 2020 6b65 7920  e drawn...  key 
-0001b300: 3a20 5052 4e47 4b65 792c 206f 7074 696f  : PRNGKey, optio
-0001b310: 6e61 6c0d 0a20 2020 2020 2054 6865 206b  nal..      The k
-0001b320: 6579 2066 6f72 2074 6865 2072 616e 646f  ey for the rando
-0001b330: 6d20 6e75 6d62 6572 2067 656e 6572 6174  m number generat
-0001b340: 6f72 2e20 4966 206e 6f74 2067 6976 656e  or. If not given
-0001b350: 2c20 7468 650d 0a20 2020 2020 2064 6566  , the..      def
-0001b360: 6175 6c74 2072 616e 646f 6d20 6e75 6d62  ault random numb
-0001b370: 6572 2067 656e 6572 6174 6f72 2069 7320  er generator is 
-0001b380: 7573 6564 2e0d 0a0d 0a20 2052 6574 7572  used.....  Retur
-0001b390: 6e73 0d0a 2020 2d2d 2d2d 2d2d 2d0d 0a20  ns..  -------.. 
-0001b3a0: 206f 7574 203a 206e 6461 7272 6179 206f   out : ndarray o
-0001b3b0: 7220 7363 616c 6172 0d0a 2020 2020 2020  r scalar..      
-0001b3c0: 4472 6177 6e20 7361 6d70 6c65 7320 6672  Drawn samples fr
-0001b3d0: 6f6d 2074 6865 2070 6172 616d 6574 6572  om the parameter
-0001b3e0: 697a 6564 2063 6869 2d73 7175 6172 6520  ized chi-square 
-0001b3f0: 6469 7374 7269 6275 7469 6f6e 2e0d 0a0d  distribution....
-0001b400: 0a20 2052 6169 7365 730d 0a20 202d 2d2d  .  Raises..  ---
-0001b410: 2d2d 2d0d 0a20 2056 616c 7565 4572 726f  ---..  ValueErro
-0001b420: 720d 0a20 2020 2020 2057 6865 6e20 6064  r..      When `d
-0001b430: 6660 203c 3d20 3020 6f72 2077 6865 6e20  f` <= 0 or when 
-0001b440: 616e 2069 6e61 7070 726f 7072 6961 7465  an inappropriate
-0001b450: 2060 7369 7a65 6020 2865 2e67 2e20 6060   `size` (e.g. ``
-0001b460: 7369 7a65 3d2d 3160 6029 0d0a 2020 2020  size=-1``)..    
-0001b470: 2020 6973 2067 6976 656e 2e0d 0a0d 0a20    is given..... 
-0001b480: 204e 6f74 6573 0d0a 2020 2d2d 2d2d 2d0d   Notes..  -----.
-0001b490: 0a20 2054 6865 2076 6172 6961 626c 6520  .  The variable 
-0001b4a0: 6f62 7461 696e 6564 2062 7920 7375 6d6d  obtained by summ
-0001b4b0: 696e 6720 7468 6520 7371 7561 7265 7320  ing the squares 
-0001b4c0: 6f66 2060 6466 6020 696e 6465 7065 6e64  of `df` independ
-0001b4d0: 656e 742c 0d0a 2020 7374 616e 6461 7264  ent,..  standard
-0001b4e0: 206e 6f72 6d61 6c6c 7920 6469 7374 7269   normally distri
-0001b4f0: 6275 7465 6420 7261 6e64 6f6d 2076 6172  buted random var
-0001b500: 6961 626c 6573 3a0d 0a0d 0a20 202e 2e20  iables:....  .. 
-0001b510: 6d61 7468 3a3a 2051 203d 205c 7375 6d5f  math:: Q = \sum_
-0001b520: 7b69 3d30 7d5e 7b5c 6d61 7468 7474 7b64  {i=0}^{\mathtt{d
-0001b530: 667d 7d20 585e 325f 690d 0a0d 0a20 2069  f}} X^2_i....  i
-0001b540: 7320 6368 692d 7371 7561 7265 2064 6973  s chi-square dis
-0001b550: 7472 6962 7574 6564 2c20 6465 6e6f 7465  tributed, denote
-0001b560: 640d 0a0d 0a20 202e 2e20 6d61 7468 3a3a  d....  .. math::
-0001b570: 2051 205c 7369 6d20 5c63 6869 5e32 5f6b   Q \sim \chi^2_k
-0001b580: 2e0d 0a0d 0a20 2054 6865 2070 726f 6261  .....  The proba
-0001b590: 6269 6c69 7479 2064 656e 7369 7479 2066  bility density f
-0001b5a0: 756e 6374 696f 6e20 6f66 2074 6865 2063  unction of the c
-0001b5b0: 6869 2d73 7175 6172 6564 2064 6973 7472  hi-squared distr
-0001b5c0: 6962 7574 696f 6e20 6973 0d0a 0d0a 2020  ibution is....  
-0001b5d0: 2e2e 206d 6174 683a 3a20 7028 7829 203d  .. math:: p(x) =
-0001b5e0: 205c 6672 6163 7b28 312f 3229 5e7b 6b2f   \frac{(1/2)^{k/
-0001b5f0: 327d 7d7b 5c47 616d 6d61 286b 2f32 297d  2}}{\Gamma(k/2)}
-0001b600: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001b610: 2020 2020 2078 5e7b 6b2f 3220 2d20 317d       x^{k/2 - 1}
-0001b620: 2065 5e7b 2d78 2f32 7d2c 0d0a 0d0a 2020   e^{-x/2},....  
-0001b630: 7768 6572 6520 3a6d 6174 683a 605c 4761  where :math:`\Ga
-0001b640: 6d6d 6160 2069 7320 7468 6520 6761 6d6d  mma` is the gamm
-0001b650: 6120 6675 6e63 7469 6f6e 2c0d 0a0d 0a20  a function,.... 
-0001b660: 202e 2e20 6d61 7468 3a3a 205c 4761 6d6d   .. math:: \Gamm
-0001b670: 6128 7829 203d 205c 696e 745f 305e 7b2d  a(x) = \int_0^{-
-0001b680: 5c69 6e66 7479 7d20 745e 7b78 202d 2031  \infty} t^{x - 1
-0001b690: 7d20 655e 7b2d 747d 2064 742e 0d0a 0d0a  } e^{-t} dt.....
-0001b6a0: 2020 5265 6665 7265 6e63 6573 0d0a 2020    References..  
-0001b6b0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2e2e  ----------..  ..
-0001b6c0: 205b 315d 204e 4953 5420 2245 6e67 696e   [1] NIST "Engin
-0001b6d0: 6565 7269 6e67 2053 7461 7469 7374 6963  eering Statistic
-0001b6e0: 7320 4861 6e64 626f 6f6b 220d 0a20 2020  s Handbook"..   
-0001b6f0: 2020 2020 2020 6874 7470 733a 2f2f 7777        https://ww
-0001b700: 772e 6974 6c2e 6e69 7374 2e67 6f76 2f64  w.itl.nist.gov/d
-0001b710: 6976 3839 382f 6861 6e64 626f 6f6b 2f65  iv898/handbook/e
-0001b720: 6461 2f73 6563 7469 6f6e 332f 6564 6133  da/section3/eda3
-0001b730: 3636 362e 6874 6d0d 0a0d 0a20 2045 7861  666.htm....  Exa
-0001b740: 6d70 6c65 730d 0a20 202d 2d2d 2d2d 2d2d  mples..  -------
-0001b750: 2d0d 0a20 203e 3e3e 2062 632e 7261 6e64  -..  >>> bc.rand
-0001b760: 6f6d 2e63 6869 7371 7561 7265 2832 2c34  om.chisquare(2,4
-0001b770: 290d 0a20 2061 7272 6179 285b 2031 2e38  )..  array([ 1.8
-0001b780: 3939 3230 3031 342c 2020 392e 3030 3836  9920014,  9.0086
-0001b790: 3737 3136 2c20 2033 2e31 3337 3130 3533  7716,  3.1371053
-0001b7a0: 332c 2020 352e 3632 3331 3832 3732 5d29  3,  5.62318272])
-0001b7b0: 2023 2072 616e 646f 6d0d 0a20 2022 2222   # random..  """
-0001b7c0: 0d0a 2020 7265 7475 726e 2044 4546 4155  ..  return DEFAU
-0001b7d0: 4c54 2e63 6869 7371 7561 7265 2864 662c  LT.chisquare(df,
-0001b7e0: 2073 697a 652c 206b 6579 3d6b 6579 2c20   size, key=key, 
-0001b7f0: 6474 7970 653d 6474 7970 6529 0d0a 0d0a  dtype=dtype)....
-0001b800: 0d0a 6465 6620 6469 7269 6368 6c65 7428  ..def dirichlet(
-0001b810: 616c 7068 612c 2073 697a 653a 204f 7074  alpha, size: Opt
-0001b820: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
-0001b830: 6e65 2c20 6b65 793a 204f 7074 696f 6e61  ne, key: Optiona
-0001b840: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
-0001b850: 6f6e 652c 2064 7479 7065 3a20 4454 7970  one, dtype: DTyp
-0001b860: 654c 696b 6520 3d20 4e6f 6e65 293a 0d0a  eLike = None):..
-0001b870: 2020 7222 2222 0d0a 2020 4472 6177 2073    r"""..  Draw s
-0001b880: 616d 706c 6573 2066 726f 6d20 7468 6520  amples from the 
-0001b890: 4469 7269 6368 6c65 7420 6469 7374 7269  Dirichlet distri
-0001b8a0: 6275 7469 6f6e 2e0d 0a0d 0a20 2044 7261  bution.....  Dra
-0001b8b0: 7720 6073 697a 6560 2073 616d 706c 6573  w `size` samples
-0001b8c0: 206f 6620 6469 6d65 6e73 696f 6e20 6b20   of dimension k 
-0001b8d0: 6672 6f6d 2061 2044 6972 6963 686c 6574  from a Dirichlet
-0001b8e0: 2064 6973 7472 6962 7574 696f 6e2e 2041   distribution. A
-0001b8f0: 0d0a 2020 4469 7269 6368 6c65 742d 6469  ..  Dirichlet-di
+000095b0: 2020 6b65 793a 204f 7074 696f 6e61 6c5b    key: Optional[
+000095c0: 5365 6564 4f72 4b65 795d 203d 204e 6f6e  SeedOrKey] = Non
+000095d0: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+000095e0: 2020 2020 2020 2064 7479 7065 3a20 4454         dtype: DT
+000095f0: 7970 654c 696b 6520 3d20 4e6f 6e65 293a  ypeLike = None):
+00009600: 0d0a 2020 2020 6466 6e75 6d20 3d20 5f63  ..    dfnum = _c
+00009610: 6865 636b 5f70 795f 7365 7128 6466 6e75  heck_py_seq(dfnu
+00009620: 6d29 0d0a 2020 2020 6466 6465 6e20 3d20  m)..    dfden = 
+00009630: 5f63 6865 636b 5f70 795f 7365 7128 6466  _check_py_seq(df
+00009640: 6465 6e29 0d0a 2020 2020 6e6f 6e63 203d  den)..    nonc =
+00009650: 205f 6368 6563 6b5f 7079 5f73 6571 286e   _check_py_seq(n
+00009660: 6f6e 6329 0d0a 2020 2020 6966 2073 697a  onc)..    if siz
+00009670: 6520 6973 204e 6f6e 653a 0d0a 2020 2020  e is None:..    
+00009680: 2020 7369 7a65 203d 206c 6178 2e62 726f    size = lax.bro
+00009690: 6164 6361 7374 5f73 6861 7065 7328 6a6e  adcast_shapes(jn
+000096a0: 702e 7368 6170 6528 6466 6e75 6d29 2c0d  p.shape(dfnum),.
+000096b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000096c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000096d0: 2020 206a 6e70 2e73 6861 7065 2864 6664     jnp.shape(dfd
+000096e0: 656e 292c 0d0a 2020 2020 2020 2020 2020  en),..          
+000096f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009700: 2020 2020 2020 2020 6a6e 702e 7368 6170          jnp.shap
+00009710: 6528 6e6f 6e63 2929 0d0a 2020 2020 7369  e(nonc))..    si
+00009720: 7a65 203d 205f 7369 7a65 3273 6861 7065  ze = _size2shape
+00009730: 2873 697a 6529 0d0a 2020 2020 6420 3d20  (size)..    d = 
+00009740: 7b27 6466 6e75 6d27 3a20 6466 6e75 6d2c  {'dfnum': dfnum,
+00009750: 2027 6466 6465 6e27 3a20 6466 6465 6e2c   'dfden': dfden,
+00009760: 2027 6e6f 6e63 273a 206e 6f6e 637d 0d0a   'nonc': nonc}..
+00009770: 2020 2020 6474 7970 6520 3d20 6474 7970      dtype = dtyp
+00009780: 6520 6f72 2065 6e76 6972 6f6e 2e64 6674  e or environ.dft
+00009790: 7970 6528 290d 0a20 2020 2072 203d 206a  ype()..    r = j
+000097a0: 6178 2e70 7572 655f 6361 6c6c 6261 636b  ax.pure_callback
+000097b0: 286c 616d 6264 6120 783a 206e 702e 7261  (lambda x: np.ra
+000097c0: 6e64 6f6d 2e6e 6f6e 6365 6e74 7261 6c5f  ndom.noncentral_
+000097d0: 6628 6466 6e75 6d3d 785b 2764 666e 756d  f(dfnum=x['dfnum
+000097e0: 275d 2c0d 0a20 2020 2020 2020 2020 2020  '],..           
+000097f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009820: 6466 6465 6e3d 785b 2764 6664 656e 275d  dfden=x['dfden']
+00009830: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00009840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009860: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
+00009870: 6e63 3d78 5b27 6e6f 6e63 275d 2c0d 0a20  nc=x['nonc'],.. 
+00009880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000098a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000098b0: 2020 2020 2020 2020 2020 7369 7a65 3d73            size=s
+000098c0: 697a 6529 2e61 7374 7970 6528 6474 7970  ize).astype(dtyp
+000098d0: 6529 2c0d 0a20 2020 2020 2020 2020 2020  e),..           
+000098e0: 2020 2020 2020 2020 2020 2020 2020 206a                 j
+000098f0: 6178 2e53 6861 7065 4474 7970 6553 7472  ax.ShapeDtypeStr
+00009900: 7563 7428 7369 7a65 2c20 6474 7970 6529  uct(size, dtype)
+00009910: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00009920: 2020 2020 2020 2020 2020 2020 2064 290d               d).
+00009930: 0a20 2020 2072 6574 7572 6e20 720d 0a0d  .    return r...
+00009940: 0a20 2023 2050 7954 6f72 6368 2063 6f6d  .  # PyTorch com
+00009950: 7061 7469 6269 6c69 7479 2023 0d0a 2020  patibility #..  
+00009960: 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  # --------------
+00009970: 2d2d 2d2d 2d2d 2d20 230d 0a0d 0a20 2064  ------- #....  d
+00009980: 6566 2072 616e 645f 6c69 6b65 2873 656c  ef rand_like(sel
+00009990: 662c 2069 6e70 7574 2c20 2a2c 2064 7479  f, input, *, dty
+000099a0: 7065 3d4e 6f6e 652c 206b 6579 3a20 4f70  pe=None, key: Op
+000099b0: 7469 6f6e 616c 5b53 6565 644f 724b 6579  tional[SeedOrKey
+000099c0: 5d20 3d20 4e6f 6e65 293a 0d0a 2020 2020  ] = None):..    
+000099d0: 2222 2252 6574 7572 6e73 2061 2074 656e  """Returns a ten
+000099e0: 736f 7220 7769 7468 2074 6865 2073 616d  sor with the sam
+000099f0: 6520 7369 7a65 2061 7320 696e 7075 7420  e size as input 
+00009a00: 7468 6174 2069 7320 6669 6c6c 6564 2077  that is filled w
+00009a10: 6974 6820 7261 6e64 6f6d 0d0a 2020 2020  ith random..    
+00009a20: 6e75 6d62 6572 7320 6672 6f6d 2061 2075  numbers from a u
+00009a30: 6e69 666f 726d 2064 6973 7472 6962 7574  niform distribut
+00009a40: 696f 6e20 6f6e 2074 6865 2069 6e74 6572  ion on the inter
+00009a50: 7661 6c20 6060 5b30 2c20 3129 6060 2e0d  val ``[0, 1)``..
+00009a60: 0a0d 0a20 2020 2041 7267 733a 0d0a 2020  ...    Args:..  
+00009a70: 2020 2020 696e 7075 743a 2020 7468 6520      input:  the 
+00009a80: 6060 7369 7a65 6060 206f 6620 696e 7075  ``size`` of inpu
+00009a90: 7420 7769 6c6c 2064 6574 6572 6d69 6e65  t will determine
+00009aa0: 2073 697a 6520 6f66 2074 6865 206f 7574   size of the out
+00009ab0: 7075 7420 7465 6e73 6f72 2e0d 0a20 2020  put tensor...   
+00009ac0: 2020 2064 7479 7065 3a20 2074 6865 2064     dtype:  the d
+00009ad0: 6573 6972 6564 2064 6174 6120 7479 7065  esired data type
+00009ae0: 206f 6620 7265 7475 726e 6564 2054 656e   of returned Ten
+00009af0: 736f 722e 2044 6566 6175 6c74 3a20 6966  sor. Default: if
+00009b00: 2060 604e 6f6e 6560 602c 2064 6566 6175   ``None``, defau
+00009b10: 6c74 7320 746f 2074 6865 2064 7479 7065  lts to the dtype
+00009b20: 206f 6620 696e 7075 742e 0d0a 2020 2020   of input...    
+00009b30: 2020 6b65 793a 2074 6865 2073 6565 6420    key: the seed 
+00009b40: 6f72 206b 6579 2066 6f72 2074 6865 2072  or key for the r
+00009b50: 616e 646f 6d2e 0d0a 0d0a 2020 2020 5265  andom.....    Re
+00009b60: 7475 726e 733a 0d0a 2020 2020 2020 5468  turns:..      Th
+00009b70: 6520 7261 6e64 6f6d 2064 6174 612e 0d0a  e random data...
+00009b80: 2020 2020 2222 220d 0a20 2020 2072 6574      """..    ret
+00009b90: 7572 6e20 7365 6c66 2e72 616e 646f 6d28  urn self.random(
+00009ba0: 6a6e 702e 7368 6170 6528 696e 7075 7429  jnp.shape(input)
+00009bb0: 2c20 6b65 793d 6b65 7929 2e61 7374 7970  , key=key).astyp
+00009bc0: 6528 6474 7970 6529 0d0a 0d0a 2020 6465  e(dtype)....  de
+00009bd0: 6620 7261 6e64 6e5f 6c69 6b65 2873 656c  f randn_like(sel
+00009be0: 662c 2069 6e70 7574 2c20 2a2c 2064 7479  f, input, *, dty
+00009bf0: 7065 3d4e 6f6e 652c 206b 6579 3a20 4f70  pe=None, key: Op
+00009c00: 7469 6f6e 616c 5b53 6565 644f 724b 6579  tional[SeedOrKey
+00009c10: 5d20 3d20 4e6f 6e65 293a 0d0a 2020 2020  ] = None):..    
+00009c20: 2222 2252 6574 7572 6e73 2061 2074 656e  """Returns a ten
+00009c30: 736f 7220 7769 7468 2074 6865 2073 616d  sor with the sam
+00009c40: 6520 7369 7a65 2061 7320 6060 696e 7075  e size as ``inpu
+00009c50: 7460 6020 7468 6174 2069 7320 6669 6c6c  t`` that is fill
+00009c60: 6564 2077 6974 680d 0a20 2020 2072 616e  ed with..    ran
+00009c70: 646f 6d20 6e75 6d62 6572 7320 6672 6f6d  dom numbers from
+00009c80: 2061 206e 6f72 6d61 6c20 6469 7374 7269   a normal distri
+00009c90: 6275 7469 6f6e 2077 6974 6820 6d65 616e  bution with mean
+00009ca0: 2030 2061 6e64 2076 6172 6961 6e63 6520   0 and variance 
+00009cb0: 312e 0d0a 0d0a 2020 2020 4172 6773 3a0d  1.....    Args:.
+00009cc0: 0a20 2020 2020 2069 6e70 7574 3a20 2074  .      input:  t
+00009cd0: 6865 2060 6073 697a 6560 6020 6f66 2069  he ``size`` of i
+00009ce0: 6e70 7574 2077 696c 6c20 6465 7465 726d  nput will determ
+00009cf0: 696e 6520 7369 7a65 206f 6620 7468 6520  ine size of the 
+00009d00: 6f75 7470 7574 2074 656e 736f 722e 0d0a  output tensor...
+00009d10: 2020 2020 2020 6474 7970 653a 2020 7468        dtype:  th
+00009d20: 6520 6465 7369 7265 6420 6461 7461 2074  e desired data t
+00009d30: 7970 6520 6f66 2072 6574 7572 6e65 6420  ype of returned 
+00009d40: 5465 6e73 6f72 2e20 4465 6661 756c 743a  Tensor. Default:
+00009d50: 2069 6620 6060 4e6f 6e65 6060 2c20 6465   if ``None``, de
+00009d60: 6661 756c 7473 2074 6f20 7468 6520 6474  faults to the dt
+00009d70: 7970 6520 6f66 2069 6e70 7574 2e0d 0a20  ype of input... 
+00009d80: 2020 2020 206b 6579 3a20 7468 6520 7365       key: the se
+00009d90: 6564 206f 7220 6b65 7920 666f 7220 7468  ed or key for th
+00009da0: 6520 7261 6e64 6f6d 2e0d 0a0d 0a20 2020  e random.....   
+00009db0: 2052 6574 7572 6e73 3a0d 0a20 2020 2020   Returns:..     
+00009dc0: 2054 6865 2072 616e 646f 6d20 6461 7461   The random data
+00009dd0: 2e0d 0a20 2020 2022 2222 0d0a 2020 2020  ...    """..    
+00009de0: 7265 7475 726e 2073 656c 662e 7261 6e64  return self.rand
+00009df0: 6e28 2a6a 6e70 2e73 6861 7065 2869 6e70  n(*jnp.shape(inp
+00009e00: 7574 292c 206b 6579 3d6b 6579 292e 6173  ut), key=key).as
+00009e10: 7479 7065 2864 7479 7065 290d 0a0d 0a20  type(dtype).... 
+00009e20: 2064 6566 2072 616e 6469 6e74 5f6c 696b   def randint_lik
+00009e30: 6528 7365 6c66 2c20 696e 7075 742c 206c  e(self, input, l
+00009e40: 6f77 3d30 2c20 6869 6768 3d4e 6f6e 652c  ow=0, high=None,
+00009e50: 202a 2c20 6474 7970 653d 4e6f 6e65 2c20   *, dtype=None, 
+00009e60: 6b65 793a 204f 7074 696f 6e61 6c5b 5365  key: Optional[Se
+00009e70: 6564 4f72 4b65 795d 203d 204e 6f6e 6529  edOrKey] = None)
+00009e80: 3a0d 0a20 2020 2069 6620 6869 6768 2069  :..    if high i
+00009e90: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2068  s None:..      h
+00009ea0: 6967 6820 3d20 6d61 7828 696e 7075 7429  igh = max(input)
+00009eb0: 0d0a 2020 2020 7265 7475 726e 2073 656c  ..    return sel
+00009ec0: 662e 7261 6e64 696e 7428 6c6f 772c 2068  f.randint(low, h
+00009ed0: 6967 683d 6869 6768 2c20 7369 7a65 3d6a  igh=high, size=j
+00009ee0: 6e70 2e73 6861 7065 2869 6e70 7574 292c  np.shape(input),
+00009ef0: 2064 7479 7065 3d64 7479 7065 2c20 6b65   dtype=dtype, ke
+00009f00: 793d 6b65 7929 0d0a 0d0a 0d0a 2320 6465  y=key)......# de
+00009f10: 6661 756c 7420 7261 6e64 6f6d 2067 656e  fault random gen
+00009f20: 6572 6174 6f72 0d0a 4445 4641 554c 5420  erator..DEFAULT 
+00009f30: 3d20 5261 6e64 6f6d 5374 6174 6528 6e70  = RandomState(np
+00009f40: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
+00009f50: 302c 2031 3030 3030 2c20 7369 7a65 3d32  0, 10000, size=2
+00009f60: 2c20 6474 7970 653d 6e70 2e75 696e 7433  , dtype=np.uint3
+00009f70: 3229 290d 0a0d 0a0d 0a64 6566 2073 706c  2))......def spl
+00009f80: 6974 5f6b 6579 2829 3a0d 0a20 2022 2222  it_key():..  """
+00009f90: 4372 6561 7465 2061 206e 6577 2073 6565  Create a new see
+00009fa0: 6420 6672 6f6d 2074 6865 2063 7572 7265  d from the curre
+00009fb0: 6e74 2073 6565 642e 0d0a 0d0a 2020 5468  nt seed.....  Th
+00009fc0: 6973 2066 756e 6374 696f 6e20 6973 2075  is function is u
+00009fd0: 7365 6675 6c20 666f 7220 7468 6520 636f  seful for the co
+00009fe0: 6e73 6973 7465 6e63 7920 7769 7468 204a  nsistency with J
+00009ff0: 4158 2773 2072 616e 646f 6d20 7061 7261  AX's random para
+0000a000: 6469 676d 2e22 2222 0d0a 2020 7265 7475  digm."""..  retu
+0000a010: 726e 2044 4546 4155 4c54 2e73 706c 6974  rn DEFAULT.split
+0000a020: 5f6b 6579 2829 0d0a 0d0a 0d0a 6465 6620  _key()......def 
+0000a030: 7370 6c69 745f 6b65 7973 286e 293a 0d0a  split_keys(n):..
+0000a040: 2020 2222 2243 7265 6174 6520 6d75 6c74    """Create mult
+0000a050: 6970 6c65 2073 6565 6473 2066 726f 6d20  iple seeds from 
+0000a060: 7468 6520 6375 7272 656e 7420 7365 6564  the current seed
+0000a070: 2e20 5468 6973 2069 7320 7573 6564 0d0a  . This is used..
+0000a080: 2020 696e 7465 726e 616c 6c79 2062 7920    internally by 
+0000a090: 6070 6d61 7060 2061 6e64 2060 766d 6170  `pmap` and `vmap
+0000a0a0: 6020 746f 2065 6e73 7572 6520 7468 6174  ` to ensure that
+0000a0b0: 2072 616e 646f 6d20 6e75 6d62 6572 730d   random numbers.
+0000a0c0: 0a20 2061 7265 2064 6966 6665 7265 6e74  .  are different
+0000a0d0: 2069 6e20 7061 7261 6c6c 656c 2074 6872   in parallel thr
+0000a0e0: 6561 6473 2e0d 0a0d 0a20 2050 6172 616d  eads.....  Param
+0000a0f0: 6574 6572 730d 0a20 202d 2d2d 2d2d 2d2d  eters..  -------
+0000a100: 2d2d 2d0d 0a20 206e 203a 2069 6e74 0d0a  ---..  n : int..
+0000a110: 2020 2020 5468 6520 6e75 6d62 6572 206f      The number o
+0000a120: 6620 7365 6564 7320 746f 2067 656e 6572  f seeds to gener
+0000a130: 6174 652e 0d0a 2020 2222 220d 0a20 2072  ate...  """..  r
+0000a140: 6574 7572 6e20 4445 4641 554c 542e 7370  eturn DEFAULT.sp
+0000a150: 6c69 745f 6b65 7973 286e 290d 0a0d 0a0d  lit_keys(n).....
+0000a160: 0a64 6566 2063 6c6f 6e65 5f72 6e67 2873  .def clone_rng(s
+0000a170: 6565 645f 6f72 5f6b 6579 3d4e 6f6e 652c  eed_or_key=None,
+0000a180: 2063 6c6f 6e65 3a20 626f 6f6c 203d 2054   clone: bool = T
+0000a190: 7275 6529 202d 3e20 5261 6e64 6f6d 5374  rue) -> RandomSt
+0000a1a0: 6174 653a 0d0a 2020 2222 2243 6c6f 6e65  ate:..  """Clone
+0000a1b0: 2074 6865 2072 616e 646f 6d20 7374 6174   the random stat
+0000a1c0: 6520 6163 636f 7264 696e 6720 746f 2074  e according to t
+0000a1d0: 6865 2067 6976 656e 2073 6574 7469 6e67  he given setting
+0000a1e0: 2e0d 0a0d 0a20 2041 7267 733a 0d0a 2020  .....  Args:..  
+0000a1f0: 2020 7365 6564 5f6f 725f 6b65 793a 2054    seed_or_key: T
+0000a200: 6865 2073 6565 6420 2861 6e20 696e 7465  he seed (an inte
+0000a210: 6765 7229 206f 7220 7468 6520 7261 6e64  ger) or the rand
+0000a220: 6f6d 206b 6579 2e0d 0a20 2020 2063 6c6f  om key...    clo
+0000a230: 6e65 3a20 426f 6f6c 2e20 5768 6574 6865  ne: Bool. Whethe
+0000a240: 7220 636c 6f6e 6520 7468 6520 6465 6661  r clone the defa
+0000a250: 756c 7420 7261 6e64 6f6d 2073 7461 7465  ult random state
+0000a260: 2e0d 0a0d 0a20 2052 6574 7572 6e73 3a0d  .....  Returns:.
+0000a270: 0a20 2020 2054 6865 2072 616e 646f 6d20  .    The random 
+0000a280: 7374 6174 652e 0d0a 2020 2222 220d 0a20  state...  """.. 
+0000a290: 2069 6620 7365 6564 5f6f 725f 6b65 7920   if seed_or_key 
+0000a2a0: 6973 204e 6f6e 653a 0d0a 2020 2020 7265  is None:..    re
+0000a2b0: 7475 726e 2044 4546 4155 4c54 2e63 6c6f  turn DEFAULT.clo
+0000a2c0: 6e65 2829 2069 6620 636c 6f6e 6520 656c  ne() if clone el
+0000a2d0: 7365 2044 4546 4155 4c54 0d0a 2020 656c  se DEFAULT..  el
+0000a2e0: 7365 3a0d 0a20 2020 2072 6574 7572 6e20  se:..    return 
+0000a2f0: 5261 6e64 6f6d 5374 6174 6528 7365 6564  RandomState(seed
+0000a300: 5f6f 725f 6b65 7929 0d0a 0d0a 0d0a 6465  _or_key)......de
+0000a310: 6620 6465 6661 756c 745f 726e 6728 7365  f default_rng(se
+0000a320: 6564 5f6f 725f 6b65 793d 4e6f 6e65 2c20  ed_or_key=None, 
+0000a330: 636c 6f6e 653a 2062 6f6f 6c20 3d20 5472  clone: bool = Tr
+0000a340: 7565 2920 2d3e 2052 616e 646f 6d53 7461  ue) -> RandomSta
+0000a350: 7465 3a0d 0a20 2022 2222 0d0a 2020 4765  te:..  """..  Ge
+0000a360: 7420 7468 6520 6465 6661 756c 7420 7261  t the default ra
+0000a370: 6e64 6f6d 2073 7461 7465 2e0d 0a0d 0a20  ndom state..... 
+0000a380: 2041 7267 733a 0d0a 2020 2020 7365 6564   Args:..    seed
+0000a390: 5f6f 725f 6b65 793a 2054 6865 2073 6565  _or_key: The see
+0000a3a0: 6420 2861 6e20 696e 7465 6765 7229 206f  d (an integer) o
+0000a3b0: 7220 7468 6520 6a61 7820 7261 6e64 6f6d  r the jax random
+0000a3c0: 206b 6579 2e0d 0a20 2020 2063 6c6f 6e65   key...    clone
+0000a3d0: 3a20 426f 6f6c 2e20 5768 6574 6865 7220  : Bool. Whether 
+0000a3e0: 636c 6f6e 6520 7468 6520 6465 6661 756c  clone the defaul
+0000a3f0: 7420 7261 6e64 6f6d 2073 7461 7465 2e0d  t random state..
+0000a400: 0a0d 0a20 2052 6574 7572 6e73 3a0d 0a20  ...  Returns:.. 
+0000a410: 2020 2054 6865 2072 616e 646f 6d20 7374     The random st
+0000a420: 6174 652e 0d0a 2020 2222 220d 0a20 2069  ate...  """..  i
+0000a430: 6620 7365 6564 5f6f 725f 6b65 7920 6973  f seed_or_key is
+0000a440: 204e 6f6e 653a 0d0a 2020 2020 7265 7475   None:..    retu
+0000a450: 726e 2044 4546 4155 4c54 2e63 6c6f 6e65  rn DEFAULT.clone
+0000a460: 2829 2069 6620 636c 6f6e 6520 656c 7365  () if clone else
+0000a470: 2044 4546 4155 4c54 0d0a 2020 656c 7365   DEFAULT..  else
+0000a480: 3a0d 0a20 2020 2072 6574 7572 6e20 5261  :..    return Ra
+0000a490: 6e64 6f6d 5374 6174 6528 7365 6564 5f6f  ndomState(seed_o
+0000a4a0: 725f 6b65 7929 0d0a 0d0a 0d0a 6465 6620  r_key)......def 
+0000a4b0: 7365 6564 2873 6565 643a 2069 6e74 203d  seed(seed: int =
+0000a4c0: 204e 6f6e 6529 3a0d 0a20 2022 2222 5365   None):..  """Se
+0000a4d0: 7473 2061 206e 6577 2072 616e 646f 6d20  ts a new random 
+0000a4e0: 7365 6564 2e0d 0a0d 0a20 2050 6172 616d  seed.....  Param
+0000a4f0: 6574 6572 730d 0a20 202d 2d2d 2d2d 2d2d  eters..  -------
+0000a500: 2d2d 2d0d 0a20 2073 6565 643a 2069 6e74  ---..  seed: int
+0000a510: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+0000a520: 5468 6520 7261 6e64 6f6d 2073 6565 642e  The random seed.
+0000a530: 0d0a 2020 2222 220d 0a20 2077 6974 6820  ..  """..  with 
+0000a540: 6a61 782e 656e 7375 7265 5f63 6f6d 7069  jax.ensure_compi
+0000a550: 6c65 5f74 696d 655f 6576 616c 2829 3a0d  le_time_eval():.
+0000a560: 0a20 2020 2069 6620 7365 6564 2069 7320  .    if seed is 
+0000a570: 4e6f 6e65 3a0d 0a20 2020 2020 2073 6565  None:..      see
+0000a580: 6420 3d20 6e70 2e72 616e 646f 6d2e 7261  d = np.random.ra
+0000a590: 6e64 696e 7428 302c 2031 3030 3030 3029  ndint(0, 100000)
+0000a5a0: 0d0a 2020 2020 6e70 2e72 616e 646f 6d2e  ..    np.random.
+0000a5b0: 7365 6564 2873 6565 6429 0d0a 2020 4445  seed(seed)..  DE
+0000a5c0: 4641 554c 542e 7365 6564 2873 6565 6429  FAULT.seed(seed)
+0000a5d0: 0d0a 0d0a 0d0a 6465 6620 7261 6e64 282a  ......def rand(*
+0000a5e0: 646e 2c20 6b65 793a 204f 7074 696f 6e61  dn, key: Optiona
+0000a5f0: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
+0000a600: 6f6e 652c 2064 7479 7065 3a20 4454 7970  one, dtype: DTyp
+0000a610: 654c 696b 6520 3d20 4e6f 6e65 293a 0d0a  eLike = None):..
+0000a620: 2020 7222 2222 5261 6e64 6f6d 2076 616c    r"""Random val
+0000a630: 7565 7320 696e 2061 2067 6976 656e 2073  ues in a given s
+0000a640: 6861 7065 2e0d 0a0d 0a20 202e 2e20 6e6f  hape.....  .. no
+0000a650: 7465 3a3a 0d0a 2020 2020 2020 5468 6973  te::..      This
+0000a660: 2069 7320 6120 636f 6e76 656e 6965 6e63   is a convenienc
+0000a670: 6520 6675 6e63 7469 6f6e 2066 6f72 2075  e function for u
+0000a680: 7365 7273 2070 6f72 7469 6e67 2063 6f64  sers porting cod
+0000a690: 6520 6672 6f6d 204d 6174 6c61 622c 0d0a  e from Matlab,..
+0000a6a0: 2020 2020 2020 616e 6420 7772 6170 7320        and wraps 
+0000a6b0: 6072 616e 646f 6d5f 7361 6d70 6c65 602e  `random_sample`.
+0000a6c0: 2054 6861 7420 6675 6e63 7469 6f6e 2074   That function t
+0000a6d0: 616b 6573 2061 0d0a 2020 2020 2020 7475  akes a..      tu
+0000a6e0: 706c 6520 746f 2073 7065 6369 6679 2074  ple to specify t
+0000a6f0: 6865 2073 697a 6520 6f66 2074 6865 206f  he size of the o
+0000a700: 7574 7075 742c 2077 6869 6368 2069 7320  utput, which is 
+0000a710: 636f 6e73 6973 7465 6e74 2077 6974 680d  consistent with.
+0000a720: 0a20 2020 2020 206f 7468 6572 204e 756d  .      other Num
+0000a730: 5079 2066 756e 6374 696f 6e73 206c 696b  Py functions lik
+0000a740: 6520 606e 756d 7079 2e7a 6572 6f73 6020  e `numpy.zeros` 
+0000a750: 616e 6420 606e 756d 7079 2e6f 6e65 7360  and `numpy.ones`
+0000a760: 2e0d 0a0d 0a20 2043 7265 6174 6520 616e  .....  Create an
+0000a770: 2061 7272 6179 206f 6620 7468 6520 6769   array of the gi
+0000a780: 7665 6e20 7368 6170 6520 616e 6420 706f  ven shape and po
+0000a790: 7075 6c61 7465 2069 7420 7769 7468 0d0a  pulate it with..
+0000a7a0: 2020 7261 6e64 6f6d 2073 616d 706c 6573    random samples
+0000a7b0: 2066 726f 6d20 6120 756e 6966 6f72 6d20   from a uniform 
+0000a7c0: 6469 7374 7269 6275 7469 6f6e 0d0a 2020  distribution..  
+0000a7d0: 6f76 6572 2060 605b 302c 2031 2960 602e  over ``[0, 1)``.
+0000a7e0: 0d0a 0d0a 2020 5061 7261 6d65 7465 7273  ....  Parameters
+0000a7f0: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  ..  ----------..
+0000a800: 2020 6430 2c20 6431 2c20 2e2e 2e2c 2064    d0, d1, ..., d
+0000a810: 6e20 3a20 696e 742c 206f 7074 696f 6e61  n : int, optiona
+0000a820: 6c0d 0a20 2020 2020 2054 6865 2064 696d  l..      The dim
+0000a830: 656e 7369 6f6e 7320 6f66 2074 6865 2072  ensions of the r
+0000a840: 6574 7572 6e65 6420 6172 7261 792c 206d  eturned array, m
+0000a850: 7573 7420 6265 206e 6f6e 2d6e 6567 6174  ust be non-negat
+0000a860: 6976 652e 0d0a 2020 2020 2020 4966 206e  ive...      If n
+0000a870: 6f20 6172 6775 6d65 6e74 2069 7320 6769  o argument is gi
+0000a880: 7665 6e20 6120 7369 6e67 6c65 2050 7974  ven a single Pyt
+0000a890: 686f 6e20 666c 6f61 7420 6973 2072 6574  hon float is ret
+0000a8a0: 7572 6e65 642e 0d0a 2020 6474 7970 6520  urned...  dtype 
+0000a8b0: 3a20 6474 7970 652c 206f 7074 696f 6e61  : dtype, optiona
+0000a8c0: 6c0d 0a20 2020 2020 2044 6573 6972 6564  l..      Desired
+0000a8d0: 2064 7479 7065 206f 6620 7468 6520 7265   dtype of the re
+0000a8e0: 7375 6c74 2e20 4279 7465 6f72 6465 7220  sult. Byteorder 
+0000a8f0: 6d75 7374 2062 6520 6e61 7469 7665 2e0d  must be native..
+0000a900: 0a20 2020 2020 2054 6865 2064 6566 6175  .      The defau
+0000a910: 6c74 2076 616c 7565 2069 7320 666c 6f61  lt value is floa
+0000a920: 742e 0d0a 0d0a 2020 5265 7475 726e 730d  t.....  Returns.
+0000a930: 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020 6f75  .  -------..  ou
+0000a940: 7420 3a20 6e64 6172 7261 792c 2073 6861  t : ndarray, sha
+0000a950: 7065 2060 6028 6430 2c20 6431 2c20 2e2e  pe ``(d0, d1, ..
+0000a960: 2e2c 2064 6e29 6060 0d0a 2020 2020 2020  ., dn)``..      
+0000a970: 5261 6e64 6f6d 2076 616c 7565 732e 0d0a  Random values...
+0000a980: 0d0a 2020 5365 6520 416c 736f 0d0a 2020  ..  See Also..  
+0000a990: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 7261 6e64  --------..  rand
+0000a9a0: 6f6d 0d0a 0d0a 2020 4578 616d 706c 6573  om....  Examples
+0000a9b0: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ..  --------..  
+0000a9c0: 3e3e 3e20 6272 6169 6e63 6f72 652e 6d61  >>> braincore.ma
+0000a9d0: 7468 2e72 616e 646f 6d2e 7261 6e64 2833  th.random.rand(3
+0000a9e0: 2c32 290d 0a20 2061 7272 6179 285b 5b20  ,2)..  array([[ 
+0000a9f0: 302e 3134 3032 3234 3731 2c20 2030 2e39  0.14022471,  0.9
+0000aa00: 3633 3630 3631 385d 2c20 2023 7261 6e64  6360618],  #rand
+0000aa10: 6f6d 0d0a 2020 2020 2020 2020 205b 2030  om..         [ 0
+0000aa20: 2e33 3736 3031 3033 322c 2020 302e 3235  .37601032,  0.25
+0000aa30: 3532 3834 3131 5d2c 2020 2372 616e 646f  528411],  #rando
+0000aa40: 6d0d 0a20 2020 2020 2020 2020 5b20 302e  m..         [ 0.
+0000aa50: 3439 3331 3330 3439 2c20 2030 2e39 3439  49313049,  0.949
+0000aa60: 3039 3837 385d 5d29 2023 7261 6e64 6f6d  09878]]) #random
+0000aa70: 0d0a 2020 2222 220d 0a20 2072 6574 7572  ..  """..  retur
+0000aa80: 6e20 4445 4641 554c 542e 7261 6e64 282a  n DEFAULT.rand(*
+0000aa90: 646e 2c20 6b65 793d 6b65 792c 2064 7479  dn, key=key, dty
+0000aaa0: 7065 3d64 7479 7065 290d 0a0d 0a0d 0a64  pe=dtype)......d
+0000aab0: 6566 2072 616e 6469 6e74 286c 6f77 2c20  ef randint(low, 
+0000aac0: 6869 6768 3d4e 6f6e 652c 2073 697a 653a  high=None, size:
+0000aad0: 204f 7074 696f 6e61 6c5b 5369 7a65 5d20   Optional[Size] 
+0000aae0: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 2020  = None,..       
+0000aaf0: 2020 2020 206b 6579 3a20 4f70 7469 6f6e       key: Option
+0000ab00: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
+0000ab10: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+0000ab20: 2020 2064 7479 7065 3a20 4454 7970 654c     dtype: DTypeL
+0000ab30: 696b 6520 3d20 4e6f 6e65 293a 0d0a 2020  ike = None):..  
+0000ab40: 7222 2222 5265 7475 726e 2072 616e 646f  r"""Return rando
+0000ab50: 6d20 696e 7465 6765 7273 2066 726f 6d20  m integers from 
+0000ab60: 606c 6f77 6020 2869 6e63 6c75 7369 7665  `low` (inclusive
+0000ab70: 2920 746f 2060 6869 6768 6020 2865 7863  ) to `high` (exc
+0000ab80: 6c75 7369 7665 292e 0d0a 0d0a 2020 5265  lusive).....  Re
+0000ab90: 7475 726e 2072 616e 646f 6d20 696e 7465  turn random inte
+0000aba0: 6765 7273 2066 726f 6d20 7468 6520 2264  gers from the "d
+0000abb0: 6973 6372 6574 6520 756e 6966 6f72 6d22  iscrete uniform"
+0000abc0: 2064 6973 7472 6962 7574 696f 6e20 6f66   distribution of
+0000abd0: 0d0a 2020 7468 6520 7370 6563 6966 6965  ..  the specifie
+0000abe0: 6420 6474 7970 6520 696e 2074 6865 2022  d dtype in the "
+0000abf0: 6861 6c66 2d6f 7065 6e22 2069 6e74 6572  half-open" inter
+0000ac00: 7661 6c20 5b60 6c6f 7760 2c20 6068 6967  val [`low`, `hig
+0000ac10: 6860 292e 2049 660d 0a20 2060 6869 6768  h`). If..  `high
+0000ac20: 6020 6973 204e 6f6e 6520 2874 6865 2064  ` is None (the d
+0000ac30: 6566 6175 6c74 292c 2074 6865 6e20 7265  efault), then re
+0000ac40: 7375 6c74 7320 6172 6520 6672 6f6d 205b  sults are from [
+0000ac50: 302c 2060 6c6f 7760 292e 0d0a 0d0a 2020  0, `low`).....  
+0000ac60: 5061 7261 6d65 7465 7273 0d0a 2020 2d2d  Parameters..  --
+0000ac70: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 6c6f 7720  --------..  low 
+0000ac80: 3a20 696e 7420 6f72 2061 7272 6179 2d6c  : int or array-l
+0000ac90: 696b 6520 6f66 2069 6e74 730d 0a20 2020  ike of ints..   
+0000aca0: 2020 204c 6f77 6573 7420 2873 6967 6e65     Lowest (signe
+0000acb0: 6429 2069 6e74 6567 6572 7320 746f 2062  d) integers to b
+0000acc0: 6520 6472 6177 6e20 6672 6f6d 2074 6865  e drawn from the
+0000acd0: 2064 6973 7472 6962 7574 696f 6e20 2875   distribution (u
+0000ace0: 6e6c 6573 730d 0a20 2020 2020 2060 6068  nless..      ``h
+0000acf0: 6967 683d 4e6f 6e65 6060 2c20 696e 2077  igh=None``, in w
+0000ad00: 6869 6368 2063 6173 6520 7468 6973 2070  hich case this p
+0000ad10: 6172 616d 6574 6572 2069 7320 6f6e 6520  arameter is one 
+0000ad20: 6162 6f76 6520 7468 650d 0a20 2020 2020  above the..     
+0000ad30: 202a 6869 6768 6573 742a 2073 7563 6820   *highest* such 
+0000ad40: 696e 7465 6765 7229 2e0d 0a20 2068 6967  integer)...  hig
+0000ad50: 6820 3a20 696e 7420 6f72 2061 7272 6179  h : int or array
+0000ad60: 2d6c 696b 6520 6f66 2069 6e74 732c 206f  -like of ints, o
+0000ad70: 7074 696f 6e61 6c0d 0a20 2020 2020 2049  ptional..      I
+0000ad80: 6620 7072 6f76 6964 6564 2c20 6f6e 6520  f provided, one 
+0000ad90: 6162 6f76 6520 7468 6520 6c61 7267 6573  above the larges
+0000ada0: 7420 2873 6967 6e65 6429 2069 6e74 6567  t (signed) integ
+0000adb0: 6572 2074 6f20 6265 2064 7261 776e 0d0a  er to be drawn..
+0000adc0: 2020 2020 2020 6672 6f6d 2074 6865 2064        from the d
+0000add0: 6973 7472 6962 7574 696f 6e20 2873 6565  istribution (see
+0000ade0: 2061 626f 7665 2066 6f72 2062 6568 6176   above for behav
+0000adf0: 696f 7220 6966 2060 6068 6967 683d 4e6f  ior if ``high=No
+0000ae00: 6e65 6060 292e 0d0a 2020 2020 2020 4966  ne``)...      If
+0000ae10: 2061 7272 6179 2d6c 696b 652c 206d 7573   array-like, mus
+0000ae20: 7420 636f 6e74 6169 6e20 696e 7465 6765  t contain intege
+0000ae30: 7220 7661 6c75 6573 0d0a 2020 7369 7a65  r values..  size
+0000ae40: 203a 2069 6e74 206f 7220 7475 706c 6520   : int or tuple 
+0000ae50: 6f66 2069 6e74 732c 206f 7074 696f 6e61  of ints, optiona
+0000ae60: 6c0d 0a20 2020 2020 204f 7574 7075 7420  l..      Output 
+0000ae70: 7368 6170 652e 2020 4966 2074 6865 2067  shape.  If the g
+0000ae80: 6976 656e 2073 6861 7065 2069 732c 2065  iven shape is, e
+0000ae90: 2e67 2e2c 2060 6028 6d2c 206e 2c20 6b29  .g., ``(m, n, k)
+0000aea0: 6060 2c20 7468 656e 0d0a 2020 2020 2020  ``, then..      
+0000aeb0: 6060 6d20 2a20 6e20 2a20 6b60 6020 7361  ``m * n * k`` sa
+0000aec0: 6d70 6c65 7320 6172 6520 6472 6177 6e2e  mples are drawn.
+0000aed0: 2020 4465 6661 756c 7420 6973 204e 6f6e    Default is Non
+0000aee0: 652c 2069 6e20 7768 6963 6820 6361 7365  e, in which case
+0000aef0: 2061 0d0a 2020 2020 2020 7369 6e67 6c65   a..      single
+0000af00: 2076 616c 7565 2069 7320 7265 7475 726e   value is return
+0000af10: 6564 2e0d 0a20 2064 7479 7065 203a 2064  ed...  dtype : d
+0000af20: 7479 7065 2c20 6f70 7469 6f6e 616c 0d0a  type, optional..
+0000af30: 2020 2020 2020 4465 7369 7265 6420 6474        Desired dt
+0000af40: 7970 6520 6f66 2074 6865 2072 6573 756c  ype of the resul
+0000af50: 742e 2042 7974 656f 7264 6572 206d 7573  t. Byteorder mus
+0000af60: 7420 6265 206e 6174 6976 652e 0d0a 2020  t be native...  
+0000af70: 2020 2020 5468 6520 6465 6661 756c 7420      The default 
+0000af80: 7661 6c75 6520 6973 2069 6e74 2e0d 0a20  value is int... 
+0000af90: 206b 6579 203a 2050 524e 474b 6579 2c20   key : PRNGKey, 
+0000afa0: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+0000afb0: 5468 6520 6b65 7920 666f 7220 7468 6520  The key for the 
+0000afc0: 7261 6e64 6f6d 206e 756d 6265 7220 6765  random number ge
+0000afd0: 6e65 7261 746f 722e 2049 6620 6e6f 7420  nerator. If not 
+0000afe0: 6769 7665 6e2c 2074 6865 0d0a 2020 2020  given, the..    
+0000aff0: 2020 6465 6661 756c 7420 7261 6e64 6f6d    default random
+0000b000: 206e 756d 6265 7220 6765 6e65 7261 746f   number generato
+0000b010: 7220 6973 2075 7365 642e 0d0a 2020 6474  r is used...  dt
+0000b020: 7970 6520 3a20 6474 7970 652c 206f 7074  ype : dtype, opt
+0000b030: 696f 6e61 6c0d 0a20 2020 2020 2044 6573  ional..      Des
+0000b040: 6972 6564 2064 7479 7065 206f 6620 7468  ired dtype of th
+0000b050: 6520 7265 7375 6c74 2e20 4279 7465 6f72  e result. Byteor
+0000b060: 6465 7220 6d75 7374 2062 6520 6e61 7469  der must be nati
+0000b070: 7665 2e0d 0a20 2020 2020 2054 6865 2064  ve...      The d
+0000b080: 6566 6175 6c74 2076 616c 7565 2069 7320  efault value is 
+0000b090: 696e 742e 0d0a 0d0a 2020 5265 7475 726e  int.....  Return
+0000b0a0: 730d 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020  s..  -------..  
+0000b0b0: 6f75 7420 3a20 696e 7420 6f72 206e 6461  out : int or nda
+0000b0c0: 7272 6179 206f 6620 696e 7473 0d0a 2020  rray of ints..  
+0000b0d0: 2020 2020 6073 697a 6560 2d73 6861 7065      `size`-shape
+0000b0e0: 6420 6172 7261 7920 6f66 2072 616e 646f  d array of rando
+0000b0f0: 6d20 696e 7465 6765 7273 2066 726f 6d20  m integers from 
+0000b100: 7468 6520 6170 7072 6f70 7269 6174 650d  the appropriate.
+0000b110: 0a20 2020 2020 2064 6973 7472 6962 7574  .      distribut
+0000b120: 696f 6e2c 206f 7220 6120 7369 6e67 6c65  ion, or a single
+0000b130: 2073 7563 6820 7261 6e64 6f6d 2069 6e74   such random int
+0000b140: 2069 6620 6073 697a 6560 206e 6f74 2070   if `size` not p
+0000b150: 726f 7669 6465 642e 0d0a 0d0a 2020 5365  rovided.....  Se
+0000b160: 6520 416c 736f 0d0a 2020 2d2d 2d2d 2d2d  e Also..  ------
+0000b170: 2d2d 0d0a 2020 7261 6e64 6f6d 5f69 6e74  --..  random_int
+0000b180: 6567 6572 7320 3a20 7369 6d69 6c61 7220  egers : similar 
+0000b190: 746f 2060 7261 6e64 696e 7460 2c20 6f6e  to `randint`, on
+0000b1a0: 6c79 2066 6f72 2074 6865 2063 6c6f 7365  ly for the close
+0000b1b0: 640d 0a20 2020 2020 2069 6e74 6572 7661  d..      interva
+0000b1c0: 6c20 5b60 6c6f 7760 2c20 6068 6967 6860  l [`low`, `high`
+0000b1d0: 5d2c 2061 6e64 2031 2069 7320 7468 6520  ], and 1 is the 
+0000b1e0: 6c6f 7765 7374 2076 616c 7565 2069 6620  lowest value if 
+0000b1f0: 6068 6967 6860 2069 730d 0a20 2020 2020  `high` is..     
+0000b200: 206f 6d69 7474 6564 2e0d 0a20 2047 656e   omitted...  Gen
+0000b210: 6572 6174 6f72 2e69 6e74 6567 6572 733a  erator.integers:
+0000b220: 2077 6869 6368 2073 686f 756c 6420 6265   which should be
+0000b230: 2075 7365 6420 666f 7220 6e65 7720 636f   used for new co
+0000b240: 6465 2e0d 0a0d 0a20 2045 7861 6d70 6c65  de.....  Example
+0000b250: 730d 0a20 202d 2d2d 2d2d 2d2d 2d0d 0a20  s..  --------.. 
+0000b260: 203e 3e3e 2069 6d70 6f72 7420 6272 6169   >>> import brai
+0000b270: 6e63 6f72 6520 6173 2062 630d 0a20 203e  ncore as bc..  >
+0000b280: 3e3e 2062 632e 7261 6e64 6f6d 2e72 616e  >> bc.random.ran
+0000b290: 6469 6e74 2832 2c20 7369 7a65 3d31 3029  dint(2, size=10)
+0000b2a0: 0d0a 2020 6172 7261 7928 5b31 2c20 302c  ..  array([1, 0,
+0000b2b0: 2030 2c20 302c 2031 2c20 312c 2030 2c20   0, 0, 1, 1, 0, 
+0000b2c0: 302c 2031 2c20 305d 2920 2320 7261 6e64  0, 1, 0]) # rand
+0000b2d0: 6f6d 0d0a 2020 3e3e 3e20 6263 2e72 616e  om..  >>> bc.ran
+0000b2e0: 646f 6d2e 7261 6e64 696e 7428 312c 2073  dom.randint(1, s
+0000b2f0: 697a 653d 3130 290d 0a20 2061 7272 6179  ize=10)..  array
+0000b300: 285b 302c 2030 2c20 302c 2030 2c20 302c  ([0, 0, 0, 0, 0,
+0000b310: 2030 2c20 302c 2030 2c20 302c 2030 5d29   0, 0, 0, 0, 0])
+0000b320: 0d0a 0d0a 2020 4765 6e65 7261 7465 2061  ....  Generate a
+0000b330: 2032 2078 2034 2061 7272 6179 206f 6620   2 x 4 array of 
+0000b340: 696e 7473 2062 6574 7765 656e 2030 2061  ints between 0 a
+0000b350: 6e64 2034 2c20 696e 636c 7573 6976 653a  nd 4, inclusive:
+0000b360: 0d0a 0d0a 2020 3e3e 3e20 6263 2e72 616e  ....  >>> bc.ran
+0000b370: 646f 6d2e 7261 6e64 696e 7428 352c 2073  dom.randint(5, s
+0000b380: 697a 653d 2832 2c20 3429 290d 0a20 2061  ize=(2, 4))..  a
+0000b390: 7272 6179 285b 5b34 2c20 302c 2032 2c20  rray([[4, 0, 2, 
+0000b3a0: 315d 2c20 2320 7261 6e64 6f6d 0d0a 2020  1], # random..  
+0000b3b0: 2020 2020 2020 205b 332c 2032 2c20 322c         [3, 2, 2,
+0000b3c0: 2030 5d5d 290d 0a0d 0a20 2047 656e 6572   0]])....  Gener
+0000b3d0: 6174 6520 6120 3120 7820 3320 6172 7261  ate a 1 x 3 arra
+0000b3e0: 7920 7769 7468 2033 2064 6966 6665 7265  y with 3 differe
+0000b3f0: 6e74 2075 7070 6572 2062 6f75 6e64 730d  nt upper bounds.
+0000b400: 0a0d 0a20 203e 3e3e 2062 632e 7261 6e64  ...  >>> bc.rand
+0000b410: 6f6d 2e72 616e 6469 6e74 2831 2c20 5b33  om.randint(1, [3
+0000b420: 2c20 352c 2031 305d 290d 0a20 2061 7272  , 5, 10])..  arr
+0000b430: 6179 285b 322c 2032 2c20 395d 2920 2320  ay([2, 2, 9]) # 
+0000b440: 7261 6e64 6f6d 0d0a 0d0a 2020 4765 6e65  random....  Gene
+0000b450: 7261 7465 2061 2031 2062 7920 3320 6172  rate a 1 by 3 ar
+0000b460: 7261 7920 7769 7468 2033 2064 6966 6665  ray with 3 diffe
+0000b470: 7265 6e74 206c 6f77 6572 2062 6f75 6e64  rent lower bound
+0000b480: 730d 0a0d 0a20 203e 3e3e 2062 632e 7261  s....  >>> bc.ra
+0000b490: 6e64 6f6d 2e72 616e 6469 6e74 285b 312c  ndom.randint([1,
+0000b4a0: 2035 2c20 375d 2c20 3130 290d 0a20 2061   5, 7], 10)..  a
+0000b4b0: 7272 6179 285b 392c 2038 2c20 375d 2920  rray([9, 8, 7]) 
+0000b4c0: 2320 7261 6e64 6f6d 0d0a 0d0a 2020 4765  # random....  Ge
+0000b4d0: 6e65 7261 7465 2061 2032 2062 7920 3420  nerate a 2 by 4 
+0000b4e0: 6172 7261 7920 7573 696e 6720 6272 6f61  array using broa
+0000b4f0: 6463 6173 7469 6e67 2077 6974 6820 6474  dcasting with dt
+0000b500: 7970 6520 6f66 2075 696e 7438 0d0a 0d0a  ype of uint8....
+0000b510: 2020 3e3e 3e20 6263 2e72 616e 646f 6d2e    >>> bc.random.
+0000b520: 7261 6e64 696e 7428 5b31 2c20 332c 2035  randint([1, 3, 5
+0000b530: 2c20 375d 2c20 5b5b 3130 5d2c 205b 3230  , 7], [[10], [20
+0000b540: 5d5d 2c20 6474 7970 653d 6e70 2e75 696e  ]], dtype=np.uin
+0000b550: 7438 290d 0a20 2061 7272 6179 285b 5b20  t8)..  array([[ 
+0000b560: 382c 2020 362c 2020 392c 2020 375d 2c20  8,  6,  9,  7], 
+0000b570: 2320 7261 6e64 6f6d 0d0a 2020 2020 2020  # random..      
+0000b580: 2020 205b 2031 2c20 3136 2c20 2039 2c20     [ 1, 16,  9, 
+0000b590: 3132 5d5d 2c20 6474 7970 653d 7569 6e74  12]], dtype=uint
+0000b5a0: 3829 0d0a 2020 2222 220d 0a0d 0a20 2072  8)..  """....  r
+0000b5b0: 6574 7572 6e20 4445 4641 554c 542e 7261  eturn DEFAULT.ra
+0000b5c0: 6e64 696e 7428 6c6f 772c 2068 6967 683d  ndint(low, high=
+0000b5d0: 6869 6768 2c20 7369 7a65 3d73 697a 652c  high, size=size,
+0000b5e0: 2064 7479 7065 3d64 7479 7065 2c20 6b65   dtype=dtype, ke
+0000b5f0: 793d 6b65 7929 0d0a 0d0a 0d0a 6465 6620  y=key)......def 
+0000b600: 7261 6e64 6f6d 5f69 6e74 6567 6572 7328  random_integers(
+0000b610: 6c6f 772c 0d0a 2020 2020 2020 2020 2020  low,..          
+0000b620: 2020 2020 2020 2020 2020 6869 6768 3d4e            high=N
+0000b630: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+0000b640: 2020 2020 2020 2020 2020 7369 7a65 3a20            size: 
+0000b650: 4f70 7469 6f6e 616c 5b53 697a 655d 203d  Optional[Size] =
+0000b660: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
+0000b670: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
+0000b680: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
+0000b690: 4b65 795d 203d 204e 6f6e 652c 0d0a 2020  Key] = None,..  
+0000b6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b6b0: 2020 6474 7970 653a 2044 5479 7065 4c69    dtype: DTypeLi
+0000b6c0: 6b65 203d 204e 6f6e 6529 3a0d 0a20 2072  ke = None):..  r
+0000b6d0: 2222 220d 0a20 2052 616e 646f 6d20 696e  """..  Random in
+0000b6e0: 7465 6765 7273 206f 6620 7479 7065 2060  tegers of type `
+0000b6f0: 6e70 2e69 6e74 5f60 2062 6574 7765 656e  np.int_` between
+0000b700: 2060 6c6f 7760 2061 6e64 2060 6869 6768   `low` and `high
+0000b710: 602c 2069 6e63 6c75 7369 7665 2e0d 0a0d  `, inclusive....
+0000b720: 0a20 2052 6574 7572 6e20 7261 6e64 6f6d  .  Return random
+0000b730: 2069 6e74 6567 6572 7320 6f66 2074 7970   integers of typ
+0000b740: 6520 606e 702e 696e 745f 6020 6672 6f6d  e `np.int_` from
+0000b750: 2074 6865 2022 6469 7363 7265 7465 2075   the "discrete u
+0000b760: 6e69 666f 726d 220d 0a20 2064 6973 7472  niform"..  distr
+0000b770: 6962 7574 696f 6e20 696e 2074 6865 2063  ibution in the c
+0000b780: 6c6f 7365 6420 696e 7465 7276 616c 205b  losed interval [
+0000b790: 606c 6f77 602c 2060 6869 6768 605d 2e20  `low`, `high`]. 
+0000b7a0: 2049 6620 6068 6967 6860 2069 730d 0a20   If `high` is.. 
+0000b7b0: 204e 6f6e 6520 2874 6865 2064 6566 6175   None (the defau
+0000b7c0: 6c74 292c 2074 6865 6e20 7265 7375 6c74  lt), then result
+0000b7d0: 7320 6172 6520 6672 6f6d 205b 312c 2060  s are from [1, `
+0000b7e0: 6c6f 7760 5d2e 2054 6865 2060 6e70 2e69  low`]. The `np.i
+0000b7f0: 6e74 5f60 0d0a 2020 7479 7065 2074 7261  nt_`..  type tra
+0000b800: 6e73 6c61 7465 7320 746f 2074 6865 2043  nslates to the C
+0000b810: 206c 6f6e 6720 696e 7465 6765 7220 7479   long integer ty
+0000b820: 7065 2061 6e64 2069 7473 2070 7265 6369  pe and its preci
+0000b830: 7369 6f6e 0d0a 2020 6973 2070 6c61 7466  sion..  is platf
+0000b840: 6f72 6d20 6465 7065 6e64 656e 742e 0d0a  orm dependent...
+0000b850: 0d0a 2020 5061 7261 6d65 7465 7273 0d0a  ..  Parameters..
+0000b860: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+0000b870: 6c6f 7720 3a20 696e 740d 0a20 2020 2020  low : int..     
+0000b880: 204c 6f77 6573 7420 2873 6967 6e65 6429   Lowest (signed)
+0000b890: 2069 6e74 6567 6572 2074 6f20 6265 2064   integer to be d
+0000b8a0: 7261 776e 2066 726f 6d20 7468 6520 6469  rawn from the di
+0000b8b0: 7374 7269 6275 7469 6f6e 2028 756e 6c65  stribution (unle
+0000b8c0: 7373 0d0a 2020 2020 2020 6060 6869 6768  ss..      ``high
+0000b8d0: 3d4e 6f6e 6560 602c 2069 6e20 7768 6963  =None``, in whic
+0000b8e0: 6820 6361 7365 2074 6869 7320 7061 7261  h case this para
+0000b8f0: 6d65 7465 7220 6973 2074 6865 202a 6869  meter is the *hi
+0000b900: 6768 6573 742a 2073 7563 680d 0a20 2020  ghest* such..   
+0000b910: 2020 2069 6e74 6567 6572 292e 0d0a 2020     integer)...  
+0000b920: 6869 6768 203a 2069 6e74 2c20 6f70 7469  high : int, opti
+0000b930: 6f6e 616c 0d0a 2020 2020 2020 4966 2070  onal..      If p
+0000b940: 726f 7669 6465 642c 2074 6865 206c 6172  rovided, the lar
+0000b950: 6765 7374 2028 7369 676e 6564 2920 696e  gest (signed) in
+0000b960: 7465 6765 7220 746f 2062 6520 6472 6177  teger to be draw
+0000b970: 6e20 6672 6f6d 2074 6865 0d0a 2020 2020  n from the..    
+0000b980: 2020 6469 7374 7269 6275 7469 6f6e 2028    distribution (
+0000b990: 7365 6520 6162 6f76 6520 666f 7220 6265  see above for be
+0000b9a0: 6861 7669 6f72 2069 6620 6060 6869 6768  havior if ``high
+0000b9b0: 3d4e 6f6e 6560 6029 2e0d 0a20 2073 697a  =None``)...  siz
+0000b9c0: 6520 3a20 696e 7420 6f72 2074 7570 6c65  e : int or tuple
+0000b9d0: 206f 6620 696e 7473 2c20 6f70 7469 6f6e   of ints, option
+0000b9e0: 616c 0d0a 2020 2020 2020 4f75 7470 7574  al..      Output
+0000b9f0: 2073 6861 7065 2e20 2049 6620 7468 6520   shape.  If the 
+0000ba00: 6769 7665 6e20 7368 6170 6520 6973 2c20  given shape is, 
+0000ba10: 652e 672e 2c20 6060 286d 2c20 6e2c 206b  e.g., ``(m, n, k
+0000ba20: 2960 602c 2074 6865 6e0d 0a20 2020 2020  )``, then..     
+0000ba30: 2060 606d 202a 206e 202a 206b 6060 2073   ``m * n * k`` s
+0000ba40: 616d 706c 6573 2061 7265 2064 7261 776e  amples are drawn
+0000ba50: 2e20 2044 6566 6175 6c74 2069 7320 4e6f  .  Default is No
+0000ba60: 6e65 2c20 696e 2077 6869 6368 2063 6173  ne, in which cas
+0000ba70: 6520 610d 0a20 2020 2020 2073 696e 676c  e a..      singl
+0000ba80: 6520 7661 6c75 6520 6973 2072 6574 7572  e value is retur
+0000ba90: 6e65 642e 0d0a 2020 6b65 7920 3a20 5052  ned...  key : PR
+0000baa0: 4e47 4b65 792c 206f 7074 696f 6e61 6c0d  NGKey, optional.
+0000bab0: 0a20 2020 2020 2054 6865 206b 6579 2066  .      The key f
+0000bac0: 6f72 2074 6865 2072 616e 646f 6d20 6e75  or the random nu
+0000bad0: 6d62 6572 2067 656e 6572 6174 6f72 2e20  mber generator. 
+0000bae0: 4966 206e 6f74 2067 6976 656e 2c20 7468  If not given, th
+0000baf0: 650d 0a20 2020 2020 2064 6566 6175 6c74  e..      default
+0000bb00: 2072 616e 646f 6d20 6e75 6d62 6572 2067   random number g
+0000bb10: 656e 6572 6174 6f72 2069 7320 7573 6564  enerator is used
+0000bb20: 2e0d 0a0d 0a20 2052 6574 7572 6e73 0d0a  .....  Returns..
+0000bb30: 2020 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574    -------..  out
+0000bb40: 203a 2069 6e74 206f 7220 6e64 6172 7261   : int or ndarra
+0000bb50: 7920 6f66 2069 6e74 730d 0a20 2020 2020  y of ints..     
+0000bb60: 2060 7369 7a65 602d 7368 6170 6564 2061   `size`-shaped a
+0000bb70: 7272 6179 206f 6620 7261 6e64 6f6d 2069  rray of random i
+0000bb80: 6e74 6567 6572 7320 6672 6f6d 2074 6865  ntegers from the
+0000bb90: 2061 7070 726f 7072 6961 7465 0d0a 2020   appropriate..  
+0000bba0: 2020 2020 6469 7374 7269 6275 7469 6f6e      distribution
+0000bbb0: 2c20 6f72 2061 2073 696e 676c 6520 7375  , or a single su
+0000bbc0: 6368 2072 616e 646f 6d20 696e 7420 6966  ch random int if
+0000bbd0: 2060 7369 7a65 6020 6e6f 7420 7072 6f76   `size` not prov
+0000bbe0: 6964 6564 2e0d 0a0d 0a20 2053 6565 2041  ided.....  See A
+0000bbf0: 6c73 6f0d 0a20 202d 2d2d 2d2d 2d2d 2d0d  lso..  --------.
+0000bc00: 0a20 2072 616e 6469 6e74 203a 2053 696d  .  randint : Sim
+0000bc10: 696c 6172 2074 6f20 6072 616e 646f 6d5f  ilar to `random_
+0000bc20: 696e 7465 6765 7273 602c 206f 6e6c 7920  integers`, only 
+0000bc30: 666f 7220 7468 6520 6861 6c66 2d6f 7065  for the half-ope
+0000bc40: 6e0d 0a20 2020 2020 2069 6e74 6572 7661  n..      interva
+0000bc50: 6c20 5b60 6c6f 7760 2c20 6068 6967 6860  l [`low`, `high`
+0000bc60: 292c 2061 6e64 2030 2069 7320 7468 6520  ), and 0 is the 
+0000bc70: 6c6f 7765 7374 2076 616c 7565 2069 6620  lowest value if 
+0000bc80: 6068 6967 6860 2069 730d 0a20 2020 2020  `high` is..     
+0000bc90: 206f 6d69 7474 6564 2e0d 0a0d 0a20 204e   omitted.....  N
+0000bca0: 6f74 6573 0d0a 2020 2d2d 2d2d 2d0d 0a20  otes..  -----.. 
+0000bcb0: 2054 6f20 7361 6d70 6c65 2066 726f 6d20   To sample from 
+0000bcc0: 4e20 6576 656e 6c79 2073 7061 6365 6420  N evenly spaced 
+0000bcd0: 666c 6f61 7469 6e67 2d70 6f69 6e74 206e  floating-point n
+0000bce0: 756d 6265 7273 2062 6574 7765 656e 2061  umbers between a
+0000bcf0: 2061 6e64 2062 2c0d 0a20 2075 7365 3a3a   and b,..  use::
+0000bd00: 0d0a 0d0a 2020 2020 6120 2b20 2862 202d  ....    a + (b -
+0000bd10: 2061 2920 2a20 2862 7261 696e 636f 7265   a) * (braincore
+0000bd20: 2e72 616e 646f 6d2e 7261 6e64 6f6d 5f69  .random.random_i
+0000bd30: 6e74 6567 6572 7328 4e29 202d 2031 2920  ntegers(N) - 1) 
+0000bd40: 2f20 284e 202d 2031 2e29 0d0a 0d0a 2020  / (N - 1.)....  
+0000bd50: 4578 616d 706c 6573 0d0a 2020 2d2d 2d2d  Examples..  ----
+0000bd60: 2d2d 2d2d 0d0a 2020 3e3e 3e20 696d 706f  ----..  >>> impo
+0000bd70: 7274 2062 7261 696e 636f 7265 2061 7320  rt braincore as 
+0000bd80: 6263 0d0a 2020 3e3e 3e20 6263 2e72 616e  bc..  >>> bc.ran
+0000bd90: 646f 6d2e 7261 6e64 6f6d 5f69 6e74 6567  dom.random_integ
+0000bda0: 6572 7328 3529 0d0a 2020 3420 2320 7261  ers(5)..  4 # ra
+0000bdb0: 6e64 6f6d 0d0a 2020 3e3e 3e20 7479 7065  ndom..  >>> type
+0000bdc0: 2862 632e 7261 6e64 6f6d 2e72 616e 646f  (bc.random.rando
+0000bdd0: 6d5f 696e 7465 6765 7273 2835 2929 0d0a  m_integers(5))..
+0000bde0: 2020 3c63 6c61 7373 2027 6e75 6d70 792e    <class 'numpy.
+0000bdf0: 696e 7436 3427 3e0d 0a20 203e 3e3e 2062  int64'>..  >>> b
+0000be00: 632e 7261 6e64 6f6d 2e72 616e 646f 6d5f  c.random.random_
+0000be10: 696e 7465 6765 7273 2835 2c20 7369 7a65  integers(5, size
+0000be20: 3d28 332c 3229 290d 0a20 2061 7272 6179  =(3,2))..  array
+0000be30: 285b 5b35 2c20 345d 2c20 2320 7261 6e64  ([[5, 4], # rand
+0000be40: 6f6d 0d0a 2020 2020 2020 2020 205b 332c  om..         [3,
+0000be50: 2033 5d2c 0d0a 2020 2020 2020 2020 205b   3],..         [
+0000be60: 342c 2035 5d5d 290d 0a0d 0a20 2043 686f  4, 5]])....  Cho
+0000be70: 6f73 6520 6669 7665 2072 616e 646f 6d20  ose five random 
+0000be80: 6e75 6d62 6572 7320 6672 6f6d 2074 6865  numbers from the
+0000be90: 2073 6574 206f 6620 6669 7665 2065 7665   set of five eve
+0000bea0: 6e6c 792d 7370 6163 6564 0d0a 2020 6e75  nly-spaced..  nu
+0000beb0: 6d62 6572 7320 6265 7477 6565 6e20 3020  mbers between 0 
+0000bec0: 616e 6420 322e 352c 2069 6e63 6c75 7369  and 2.5, inclusi
+0000bed0: 7665 2028 2a69 2e65 2e2a 2c20 6672 6f6d  ve (*i.e.*, from
+0000bee0: 2074 6865 2073 6574 0d0a 2020 3a6d 6174   the set..  :mat
+0000bef0: 683a 607b 302c 2035 2f38 2c20 3130 2f38  h:`{0, 5/8, 10/8
+0000bf00: 2c20 3135 2f38 2c20 3230 2f38 7d60 293a  , 15/8, 20/8}`):
+0000bf10: 0d0a 0d0a 2020 3e3e 3e20 322e 3520 2a20  ....  >>> 2.5 * 
+0000bf20: 2862 632e 7261 6e64 6f6d 2e72 616e 646f  (bc.random.rando
+0000bf30: 6d5f 696e 7465 6765 7273 2835 2c20 7369  m_integers(5, si
+0000bf40: 7a65 3d28 352c 2929 202d 2031 2920 2f20  ze=(5,)) - 1) / 
+0000bf50: 342e 0d0a 2020 6172 7261 7928 5b20 302e  4...  array([ 0.
+0000bf60: 3632 352c 2020 312e 3235 202c 2020 302e  625,  1.25 ,  0.
+0000bf70: 3632 352c 2020 302e 3632 352c 2020 322e  625,  0.625,  2.
+0000bf80: 3520 205d 2920 2320 7261 6e64 6f6d 0d0a  5  ]) # random..
+0000bf90: 0d0a 2020 526f 6c6c 2074 776f 2073 6978  ..  Roll two six
+0000bfa0: 2073 6964 6564 2064 6963 6520 3130 3030   sided dice 1000
+0000bfb0: 2074 696d 6573 2061 6e64 2073 756d 2074   times and sum t
+0000bfc0: 6865 2072 6573 756c 7473 3a0d 0a0d 0a20  he results:.... 
+0000bfd0: 203e 3e3e 2064 3120 3d20 6263 2e72 616e   >>> d1 = bc.ran
+0000bfe0: 646f 6d2e 7261 6e64 6f6d 5f69 6e74 6567  dom.random_integ
+0000bff0: 6572 7328 312c 2036 2c20 3130 3030 290d  ers(1, 6, 1000).
+0000c000: 0a20 203e 3e3e 2064 3220 3d20 6263 2e72  .  >>> d2 = bc.r
+0000c010: 616e 646f 6d2e 7261 6e64 6f6d 5f69 6e74  andom.random_int
+0000c020: 6567 6572 7328 312c 2036 2c20 3130 3030  egers(1, 6, 1000
+0000c030: 290d 0a20 203e 3e3e 2064 7375 6d73 203d  )..  >>> dsums =
+0000c040: 2064 3120 2b20 6432 0d0a 0d0a 2020 4469   d1 + d2....  Di
+0000c050: 7370 6c61 7920 7265 7375 6c74 7320 6173  splay results as
+0000c060: 2061 2068 6973 746f 6772 616d 3a0d 0a0d   a histogram:...
+0000c070: 0a20 203e 3e3e 2069 6d70 6f72 7420 6d61  .  >>> import ma
+0000c080: 7470 6c6f 746c 6962 2e70 7970 6c6f 7420  tplotlib.pyplot 
+0000c090: 6173 2070 6c74 2020 2320 6e6f 7161 0d0a  as plt  # noqa..
+0000c0a0: 2020 3e3e 3e20 636f 756e 742c 2062 696e    >>> count, bin
+0000c0b0: 732c 2069 676e 6f72 6564 203d 2070 6c74  s, ignored = plt
+0000c0c0: 2e68 6973 7428 6473 756d 732c 2031 312c  .hist(dsums, 11,
+0000c0d0: 2064 656e 7369 7479 3d54 7275 6529 0d0a   density=True)..
+0000c0e0: 2020 3e3e 3e20 706c 742e 7368 6f77 2829    >>> plt.show()
+0000c0f0: 0d0a 2020 2222 220d 0a0d 0a20 2072 6574  ..  """....  ret
+0000c100: 7572 6e20 4445 4641 554c 542e 7261 6e64  urn DEFAULT.rand
+0000c110: 6f6d 5f69 6e74 6567 6572 7328 6c6f 772c  om_integers(low,
+0000c120: 2068 6967 683d 6869 6768 2c20 7369 7a65   high=high, size
+0000c130: 3d73 697a 652c 206b 6579 3d6b 6579 2c20  =size, key=key, 
+0000c140: 6474 7970 653d 6474 7970 6529 0d0a 0d0a  dtype=dtype)....
+0000c150: 0d0a 6465 6620 7261 6e64 6e28 2a64 6e2c  ..def randn(*dn,
+0000c160: 206b 6579 3a20 4f70 7469 6f6e 616c 5b53   key: Optional[S
+0000c170: 6565 644f 724b 6579 5d20 3d20 4e6f 6e65  eedOrKey] = None
+0000c180: 2c20 6474 7970 653a 2044 5479 7065 4c69  , dtype: DTypeLi
+0000c190: 6b65 203d 204e 6f6e 6529 3a0d 0a20 2072  ke = None):..  r
+0000c1a0: 2222 220d 0a20 2052 6574 7572 6e20 6120  """..  Return a 
+0000c1b0: 7361 6d70 6c65 2028 6f72 2073 616d 706c  sample (or sampl
+0000c1c0: 6573 2920 6672 6f6d 2074 6865 2022 7374  es) from the "st
+0000c1d0: 616e 6461 7264 206e 6f72 6d61 6c22 2064  andard normal" d
+0000c1e0: 6973 7472 6962 7574 696f 6e2e 0d0a 0d0a  istribution.....
+0000c1f0: 2020 2e2e 206e 6f74 653a 3a0d 0a20 2020    .. note::..   
+0000c200: 2020 2054 6869 7320 6973 2061 2063 6f6e     This is a con
+0000c210: 7665 6e69 656e 6365 2066 756e 6374 696f  venience functio
+0000c220: 6e20 666f 7220 7573 6572 7320 706f 7274  n for users port
+0000c230: 696e 6720 636f 6465 2066 726f 6d20 4d61  ing code from Ma
+0000c240: 746c 6162 2c0d 0a20 2020 2020 2061 6e64  tlab,..      and
+0000c250: 2077 7261 7073 2060 7374 616e 6461 7264   wraps `standard
+0000c260: 5f6e 6f72 6d61 6c60 2e20 5468 6174 2066  _normal`. That f
+0000c270: 756e 6374 696f 6e20 7461 6b65 7320 610d  unction takes a.
+0000c280: 0a20 2020 2020 2074 7570 6c65 2074 6f20  .      tuple to 
+0000c290: 7370 6563 6966 7920 7468 6520 7369 7a65  specify the size
+0000c2a0: 206f 6620 7468 6520 6f75 7470 7574 2c20   of the output, 
+0000c2b0: 7768 6963 6820 6973 2063 6f6e 7369 7374  which is consist
+0000c2c0: 656e 7420 7769 7468 0d0a 2020 2020 2020  ent with..      
+0000c2d0: 6f74 6865 7220 4e75 6d50 7920 6675 6e63  other NumPy func
+0000c2e0: 7469 6f6e 7320 6c69 6b65 2060 6e75 6d70  tions like `nump
+0000c2f0: 792e 7a65 726f 7360 2061 6e64 2060 6e75  y.zeros` and `nu
+0000c300: 6d70 792e 6f6e 6573 602e 0d0a 0d0a 2020  mpy.ones`.....  
+0000c310: 2e2e 206e 6f74 653a 3a0d 0a20 2020 2020  .. note::..     
+0000c320: 204e 6577 2063 6f64 6520 7368 6f75 6c64   New code should
+0000c330: 2075 7365 2074 6865 2060 6073 7461 6e64   use the ``stand
+0000c340: 6172 645f 6e6f 726d 616c 6060 206d 6574  ard_normal`` met
+0000c350: 686f 6420 6f66 2061 2060 6064 6566 6175  hod of a ``defau
+0000c360: 6c74 5f72 6e67 2829 6060 0d0a 2020 2020  lt_rng()``..    
+0000c370: 2020 696e 7374 616e 6365 2069 6e73 7465    instance inste
+0000c380: 6164 3b20 706c 6561 7365 2073 6565 2074  ad; please see t
+0000c390: 6865 203a 7265 663a 6072 616e 646f 6d2d  he :ref:`random-
+0000c3a0: 7175 6963 6b2d 7374 6172 7460 2e0d 0a0d  quick-start`....
+0000c3b0: 0a20 2049 6620 706f 7369 7469 7665 2069  .  If positive i
+0000c3c0: 6e74 5f6c 696b 6520 6172 6775 6d65 6e74  nt_like argument
+0000c3d0: 7320 6172 6520 7072 6f76 6964 6564 2c20  s are provided, 
+0000c3e0: 6072 616e 646e 6020 6765 6e65 7261 7465  `randn` generate
+0000c3f0: 7320 616e 2061 7272 6179 0d0a 2020 6f66  s an array..  of
+0000c400: 2073 6861 7065 2060 6028 6430 2c20 6431   shape ``(d0, d1
+0000c410: 2c20 2e2e 2e2c 2064 6e29 6060 2c20 6669  , ..., dn)``, fi
+0000c420: 6c6c 6564 0d0a 2020 7769 7468 2072 616e  lled..  with ran
+0000c430: 646f 6d20 666c 6f61 7473 2073 616d 706c  dom floats sampl
+0000c440: 6564 2066 726f 6d20 6120 756e 6976 6172  ed from a univar
+0000c450: 6961 7465 2022 6e6f 726d 616c 2220 2847  iate "normal" (G
+0000c460: 6175 7373 6961 6e29 0d0a 2020 6469 7374  aussian)..  dist
+0000c470: 7269 6275 7469 6f6e 206f 6620 6d65 616e  ribution of mean
+0000c480: 2030 2061 6e64 2076 6172 6961 6e63 6520   0 and variance 
+0000c490: 312e 2041 2073 696e 676c 6520 666c 6f61  1. A single floa
+0000c4a0: 7420 7261 6e64 6f6d 6c79 2073 616d 706c  t randomly sampl
+0000c4b0: 6564 0d0a 2020 6672 6f6d 2074 6865 2064  ed..  from the d
+0000c4c0: 6973 7472 6962 7574 696f 6e20 6973 2072  istribution is r
+0000c4d0: 6574 7572 6e65 6420 6966 206e 6f20 6172  eturned if no ar
+0000c4e0: 6775 6d65 6e74 2069 7320 7072 6f76 6964  gument is provid
+0000c4f0: 6564 2e0d 0a0d 0a20 2050 6172 616d 6574  ed.....  Paramet
+0000c500: 6572 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d  ers..  ---------
+0000c510: 2d0d 0a20 2064 302c 2064 312c 202e 2e2e  -..  d0, d1, ...
+0000c520: 2c20 646e 203a 2069 6e74 2c20 6f70 7469  , dn : int, opti
+0000c530: 6f6e 616c 0d0a 2020 2020 2020 5468 6520  onal..      The 
+0000c540: 6469 6d65 6e73 696f 6e73 206f 6620 7468  dimensions of th
+0000c550: 6520 7265 7475 726e 6564 2061 7272 6179  e returned array
+0000c560: 2c20 6d75 7374 2062 6520 6e6f 6e2d 6e65  , must be non-ne
+0000c570: 6761 7469 7665 2e0d 0a20 2020 2020 2049  gative...      I
+0000c580: 6620 6e6f 2061 7267 756d 656e 7420 6973  f no argument is
+0000c590: 2067 6976 656e 2061 2073 696e 676c 6520   given a single 
+0000c5a0: 5079 7468 6f6e 2066 6c6f 6174 2069 7320  Python float is 
+0000c5b0: 7265 7475 726e 6564 2e0d 0a20 206b 6579  returned...  key
+0000c5c0: 203a 2050 524e 474b 6579 2c20 6f70 7469   : PRNGKey, opti
+0000c5d0: 6f6e 616c 0d0a 2020 2020 2020 5468 6520  onal..      The 
+0000c5e0: 6b65 7920 666f 7220 7468 6520 7261 6e64  key for the rand
+0000c5f0: 6f6d 206e 756d 6265 7220 6765 6e65 7261  om number genera
+0000c600: 746f 722e 2049 6620 6e6f 7420 6769 7665  tor. If not give
+0000c610: 6e2c 2074 6865 0d0a 2020 2020 2020 6465  n, the..      de
+0000c620: 6661 756c 7420 7261 6e64 6f6d 206e 756d  fault random num
+0000c630: 6265 7220 6765 6e65 7261 746f 7220 6973  ber generator is
+0000c640: 2075 7365 642e 0d0a 0d0a 2020 5265 7475   used.....  Retu
+0000c650: 726e 730d 0a20 202d 2d2d 2d2d 2d2d 0d0a  rns..  -------..
+0000c660: 2020 5a20 3a20 6e64 6172 7261 7920 6f72    Z : ndarray or
+0000c670: 2066 6c6f 6174 0d0a 2020 2020 2020 4120   float..      A 
+0000c680: 6060 2864 302c 2064 312c 202e 2e2e 2c20  ``(d0, d1, ..., 
+0000c690: 646e 2960 602d 7368 6170 6564 2061 7272  dn)``-shaped arr
+0000c6a0: 6179 206f 6620 666c 6f61 7469 6e67 2d70  ay of floating-p
+0000c6b0: 6f69 6e74 2073 616d 706c 6573 2066 726f  oint samples fro
+0000c6c0: 6d0d 0a20 2020 2020 2074 6865 2073 7461  m..      the sta
+0000c6d0: 6e64 6172 6420 6e6f 726d 616c 2064 6973  ndard normal dis
+0000c6e0: 7472 6962 7574 696f 6e2c 206f 7220 6120  tribution, or a 
+0000c6f0: 7369 6e67 6c65 2073 7563 6820 666c 6f61  single such floa
+0000c700: 7420 6966 0d0a 2020 2020 2020 6e6f 2070  t if..      no p
+0000c710: 6172 616d 6574 6572 7320 7765 7265 2073  arameters were s
+0000c720: 7570 706c 6965 642e 0d0a 0d0a 2020 5365  upplied.....  Se
+0000c730: 6520 416c 736f 0d0a 2020 2d2d 2d2d 2d2d  e Also..  ------
+0000c740: 2d2d 0d0a 2020 7374 616e 6461 7264 5f6e  --..  standard_n
+0000c750: 6f72 6d61 6c20 3a20 5369 6d69 6c61 722c  ormal : Similar,
+0000c760: 2062 7574 2074 616b 6573 2061 2074 7570   but takes a tup
+0000c770: 6c65 2061 7320 6974 7320 6172 6775 6d65  le as its argume
+0000c780: 6e74 2e0d 0a20 206e 6f72 6d61 6c20 3a20  nt...  normal : 
+0000c790: 416c 736f 2061 6363 6570 7473 206d 7520  Also accepts mu 
+0000c7a0: 616e 6420 7369 676d 6120 6172 6775 6d65  and sigma argume
+0000c7b0: 6e74 732e 0d0a 0d0a 2020 4e6f 7465 730d  nts.....  Notes.
+0000c7c0: 0a20 202d 2d2d 2d2d 0d0a 2020 466f 7220  .  -----..  For 
+0000c7d0: 7261 6e64 6f6d 2073 616d 706c 6573 2066  random samples f
+0000c7e0: 726f 6d20 3a6d 6174 683a 604e 285c 6d75  rom :math:`N(\mu
+0000c7f0: 2c20 5c73 6967 6d61 5e32 2960 2c20 7573  , \sigma^2)`, us
+0000c800: 653a 0d0a 0d0a 2020 6060 7369 676d 6120  e:....  ``sigma 
+0000c810: 2a20 6272 6169 6e63 6f72 652e 7261 6e64  * braincore.rand
+0000c820: 6f6d 2e72 616e 646e 282e 2e2e 2920 2b20  om.randn(...) + 
+0000c830: 6d75 6060 0d0a 0d0a 2020 4578 616d 706c  mu``....  Exampl
+0000c840: 6573 0d0a 2020 2d2d 2d2d 2d2d 2d2d 0d0a  es..  --------..
+0000c850: 2020 3e3e 3e20 696d 706f 7274 2062 7261    >>> import bra
+0000c860: 696e 636f 7265 2061 7320 6263 0d0a 2020  incore as bc..  
+0000c870: 3e3e 3e20 6263 2e72 616e 646f 6d2e 7261  >>> bc.random.ra
+0000c880: 6e64 6e28 290d 0a20 2032 2e31 3932 3338  ndn()..  2.19238
+0000c890: 3735 3333 3535 3337 3331 3520 2023 2072  75335537315  # r
+0000c8a0: 616e 646f 6d0d 0a0d 0a20 2054 776f 2d62  andom....  Two-b
+0000c8b0: 792d 666f 7572 2061 7272 6179 206f 6620  y-four array of 
+0000c8c0: 7361 6d70 6c65 7320 6672 6f6d 204e 2833  samples from N(3
+0000c8d0: 2c20 362e 3235 293a 0d0a 0d0a 2020 3e3e  , 6.25):....  >>
+0000c8e0: 3e20 3320 2b20 322e 3520 2a20 6263 2e72  > 3 + 2.5 * bc.r
+0000c8f0: 616e 646f 6d2e 7261 6e64 6e28 322c 2034  andom.randn(2, 4
+0000c900: 290d 0a20 2061 7272 6179 285b 5b2d 342e  )..  array([[-4.
+0000c910: 3439 3430 3135 3031 2c20 2034 2e30 3039  49401501,  4.009
+0000c920: 3530 3033 342c 202d 312e 3831 3831 3438  50034, -1.818148
+0000c930: 3637 2c20 2037 2e32 3937 3138 3637 375d  67,  7.29718677]
+0000c940: 2c20 2020 2320 7261 6e64 6f6d 0d0a 2020  ,   # random..  
+0000c950: 2020 2020 2020 205b 2030 2e33 3939 3234         [ 0.39924
+0000c960: 3830 342c 2020 342e 3638 3435 3633 3136  804,  4.68456316
+0000c970: 2c20 2034 2e39 3933 3934 3532 392c 2020  ,  4.99394529,  
+0000c980: 342e 3834 3035 3732 3534 5d5d 2920 2023  4.84057254]])  #
+0000c990: 2072 616e 646f 6d0d 0a20 2022 2222 0d0a   random..  """..
+0000c9a0: 0d0a 2020 7265 7475 726e 2044 4546 4155  ..  return DEFAU
+0000c9b0: 4c54 2e72 616e 646e 282a 646e 2c20 6b65  LT.randn(*dn, ke
+0000c9c0: 793d 6b65 792c 2064 7479 7065 3d64 7479  y=key, dtype=dty
+0000c9d0: 7065 290d 0a0d 0a0d 0a64 6566 2072 616e  pe)......def ran
+0000c9e0: 646f 6d28 7369 7a65 3a20 4f70 7469 6f6e  dom(size: Option
+0000c9f0: 616c 5b53 697a 655d 203d 204e 6f6e 652c  al[Size] = None,
+0000ca00: 206b 6579 3a20 4f70 7469 6f6e 616c 5b53   key: Optional[S
+0000ca10: 6565 644f 724b 6579 5d20 3d20 4e6f 6e65  eedOrKey] = None
+0000ca20: 2c20 6474 7970 653a 2044 5479 7065 4c69  , dtype: DTypeLi
+0000ca30: 6b65 203d 204e 6f6e 6529 3a0d 0a20 2072  ke = None):..  r
+0000ca40: 2222 220d 0a20 2052 6574 7572 6e20 7261  """..  Return ra
+0000ca50: 6e64 6f6d 2066 6c6f 6174 7320 696e 2074  ndom floats in t
+0000ca60: 6865 2068 616c 662d 6f70 656e 2069 6e74  he half-open int
+0000ca70: 6572 7661 6c20 5b30 2e30 2c20 312e 3029  erval [0.0, 1.0)
+0000ca80: 2e20 416c 6961 7320 666f 720d 0a20 2060  . Alias for..  `
+0000ca90: 7261 6e64 6f6d 5f73 616d 706c 6560 2074  random_sample` t
+0000caa0: 6f20 6561 7365 2066 6f72 7761 7264 2d70  o ease forward-p
+0000cab0: 6f72 7469 6e67 2074 6f20 7468 6520 6e65  orting to the ne
+0000cac0: 7720 7261 6e64 6f6d 2041 5049 2e0d 0a20  w random API... 
+0000cad0: 2022 2222 0d0a 2020 7265 7475 726e 2044   """..  return D
+0000cae0: 4546 4155 4c54 2e72 616e 646f 6d28 7369  EFAULT.random(si
+0000caf0: 7a65 2c20 6b65 793d 6b65 792c 2064 7479  ze, key=key, dty
+0000cb00: 7065 3d64 7479 7065 290d 0a0d 0a0d 0a64  pe=dtype)......d
+0000cb10: 6566 2072 616e 646f 6d5f 7361 6d70 6c65  ef random_sample
+0000cb20: 2873 697a 653a 204f 7074 696f 6e61 6c5b  (size: Optional[
+0000cb30: 5369 7a65 5d20 3d20 4e6f 6e65 2c20 6b65  Size] = None, ke
+0000cb40: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
+0000cb50: 4f72 4b65 795d 203d 204e 6f6e 652c 2064  OrKey] = None, d
+0000cb60: 7479 7065 3a20 4454 7970 654c 696b 6520  type: DTypeLike 
+0000cb70: 3d20 4e6f 6e65 293a 0d0a 2020 7222 2222  = None):..  r"""
+0000cb80: 0d0a 2020 5265 7475 726e 2072 616e 646f  ..  Return rando
+0000cb90: 6d20 666c 6f61 7473 2069 6e20 7468 6520  m floats in the 
+0000cba0: 6861 6c66 2d6f 7065 6e20 696e 7465 7276  half-open interv
+0000cbb0: 616c 205b 302e 302c 2031 2e30 292e 0d0a  al [0.0, 1.0)...
+0000cbc0: 0d0a 2020 5265 7375 6c74 7320 6172 6520  ..  Results are 
+0000cbd0: 6672 6f6d 2074 6865 2022 636f 6e74 696e  from the "contin
+0000cbe0: 756f 7573 2075 6e69 666f 726d 2220 6469  uous uniform" di
+0000cbf0: 7374 7269 6275 7469 6f6e 206f 7665 7220  stribution over 
+0000cc00: 7468 650d 0a20 2073 7461 7465 6420 696e  the..  stated in
+0000cc10: 7465 7276 616c 2e20 2054 6f20 7361 6d70  terval.  To samp
+0000cc20: 6c65 203a 6d61 7468 3a60 556e 6966 5b61  le :math:`Unif[a
+0000cc30: 2c20 6229 2c20 6220 3e20 6160 206d 756c  , b), b > a` mul
+0000cc40: 7469 706c 790d 0a20 2074 6865 206f 7574  tiply..  the out
+0000cc50: 7075 7420 6f66 2060 7261 6e64 6f6d 5f73  put of `random_s
+0000cc60: 616d 706c 6560 2062 7920 6028 622d 6129  ample` by `(b-a)
+0000cc70: 6020 616e 6420 6164 6420 6061 603a 3a0d  ` and add `a`::.
+0000cc80: 0a0d 0a20 2020 2028 6220 2d20 6129 202a  ...    (b - a) *
+0000cc90: 2072 616e 646f 6d5f 7361 6d70 6c65 2829   random_sample()
+0000cca0: 202b 2061 0d0a 0d0a 2020 2e2e 206e 6f74   + a....  .. not
+0000ccb0: 653a 3a0d 0a20 2020 2020 204e 6577 2063  e::..      New c
+0000ccc0: 6f64 6520 7368 6f75 6c64 2075 7365 2074  ode should use t
+0000ccd0: 6865 2060 6072 616e 646f 6d60 6020 6d65  he ``random`` me
+0000cce0: 7468 6f64 206f 6620 6120 6060 6465 6661  thod of a ``defa
+0000ccf0: 756c 745f 726e 6728 2960 600d 0a20 2020  ult_rng()``..   
+0000cd00: 2020 2069 6e73 7461 6e63 6520 696e 7374     instance inst
+0000cd10: 6561 643b 2070 6c65 6173 6520 7365 6520  ead; please see 
+0000cd20: 7468 6520 3a72 6566 3a60 7261 6e64 6f6d  the :ref:`random
+0000cd30: 2d71 7569 636b 2d73 7461 7274 602e 0d0a  -quick-start`...
+0000cd40: 0d0a 2020 5061 7261 6d65 7465 7273 0d0a  ..  Parameters..
+0000cd50: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+0000cd60: 7369 7a65 203a 2069 6e74 206f 7220 7475  size : int or tu
+0000cd70: 706c 6520 6f66 2069 6e74 732c 206f 7074  ple of ints, opt
+0000cd80: 696f 6e61 6c0d 0a20 2020 2020 204f 7574  ional..      Out
+0000cd90: 7075 7420 7368 6170 652e 2020 4966 2074  put shape.  If t
+0000cda0: 6865 2067 6976 656e 2073 6861 7065 2069  he given shape i
+0000cdb0: 732c 2065 2e67 2e2c 2060 6028 6d2c 206e  s, e.g., ``(m, n
+0000cdc0: 2c20 6b29 6060 2c20 7468 656e 0d0a 2020  , k)``, then..  
+0000cdd0: 2020 2020 6060 6d20 2a20 6e20 2a20 6b60      ``m * n * k`
+0000cde0: 6020 7361 6d70 6c65 7320 6172 6520 6472  ` samples are dr
+0000cdf0: 6177 6e2e 2020 4465 6661 756c 7420 6973  awn.  Default is
+0000ce00: 204e 6f6e 652c 2069 6e20 7768 6963 6820   None, in which 
+0000ce10: 6361 7365 2061 0d0a 2020 2020 2020 7369  case a..      si
+0000ce20: 6e67 6c65 2076 616c 7565 2069 7320 7265  ngle value is re
+0000ce30: 7475 726e 6564 2e0d 0a20 206b 6579 203a  turned...  key :
+0000ce40: 2050 524e 474b 6579 2c20 6f70 7469 6f6e   PRNGKey, option
+0000ce50: 616c 0d0a 2020 2020 2020 5468 6520 6b65  al..      The ke
+0000ce60: 7920 666f 7220 7468 6520 7261 6e64 6f6d  y for the random
+0000ce70: 206e 756d 6265 7220 6765 6e65 7261 746f   number generato
+0000ce80: 722e 2049 6620 6e6f 7420 6769 7665 6e2c  r. If not given,
+0000ce90: 2074 6865 0d0a 2020 2020 2020 6465 6661   the..      defa
+0000cea0: 756c 7420 7261 6e64 6f6d 206e 756d 6265  ult random numbe
+0000ceb0: 7220 6765 6e65 7261 746f 7220 6973 2075  r generator is u
+0000cec0: 7365 642e 0d0a 0d0a 2020 5265 7475 726e  sed.....  Return
+0000ced0: 730d 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020  s..  -------..  
+0000cee0: 6f75 7420 3a20 666c 6f61 7420 6f72 206e  out : float or n
+0000cef0: 6461 7272 6179 206f 6620 666c 6f61 7473  darray of floats
+0000cf00: 0d0a 2020 2020 2020 4172 7261 7920 6f66  ..      Array of
+0000cf10: 2072 616e 646f 6d20 666c 6f61 7473 206f   random floats o
+0000cf20: 6620 7368 6170 6520 6073 697a 6560 2028  f shape `size` (
+0000cf30: 756e 6c65 7373 2060 6073 697a 653d 4e6f  unless ``size=No
+0000cf40: 6e65 6060 2c20 696e 2077 6869 6368 0d0a  ne``, in which..
+0000cf50: 2020 2020 2020 6361 7365 2061 2073 696e        case a sin
+0000cf60: 676c 6520 666c 6f61 7420 6973 2072 6574  gle float is ret
+0000cf70: 7572 6e65 6429 2e0d 0a0d 0a20 2053 6565  urned).....  See
+0000cf80: 2041 6c73 6f0d 0a20 202d 2d2d 2d2d 2d2d   Also..  -------
+0000cf90: 2d0d 0a20 2047 656e 6572 6174 6f72 2e72  -..  Generator.r
+0000cfa0: 616e 646f 6d3a 2077 6869 6368 2073 686f  andom: which sho
+0000cfb0: 756c 6420 6265 2075 7365 6420 666f 7220  uld be used for 
+0000cfc0: 6e65 7720 636f 6465 2e0d 0a0d 0a20 2045  new code.....  E
+0000cfd0: 7861 6d70 6c65 730d 0a20 202d 2d2d 2d2d  xamples..  -----
+0000cfe0: 2d2d 2d0d 0a20 203e 3e3e 2069 6d70 6f72  ---..  >>> impor
+0000cff0: 7420 6272 6169 6e63 6f72 6520 6173 2062  t braincore as b
+0000d000: 630d 0a20 203e 3e3e 2062 632e 7261 6e64  c..  >>> bc.rand
+0000d010: 6f6d 2e72 616e 646f 6d5f 7361 6d70 6c65  om.random_sample
+0000d020: 2829 0d0a 2020 302e 3437 3130 3835 3437  ()..  0.47108547
+0000d030: 3939 3533 3536 3039 3820 2320 7261 6e64  995356098 # rand
+0000d040: 6f6d 0d0a 2020 3e3e 3e20 7479 7065 2862  om..  >>> type(b
+0000d050: 632e 7261 6e64 6f6d 2e72 616e 646f 6d5f  c.random.random_
+0000d060: 7361 6d70 6c65 2829 290d 0a20 203c 636c  sample())..  <cl
+0000d070: 6173 7320 2766 6c6f 6174 273e 0d0a 2020  ass 'float'>..  
+0000d080: 3e3e 3e20 6263 2e72 616e 646f 6d2e 7261  >>> bc.random.ra
+0000d090: 6e64 6f6d 5f73 616d 706c 6528 2835 2c29  ndom_sample((5,)
+0000d0a0: 290d 0a20 2061 7272 6179 285b 2030 2e33  )..  array([ 0.3
+0000d0b0: 3032 3230 3438 322c 2020 302e 3836 3832  0220482,  0.8682
+0000d0c0: 3034 3031 2c20 2030 2e31 3635 3435 3033  0401,  0.1654503
+0000d0d0: 202c 2020 302e 3131 3635 3931 3439 2c20   ,  0.11659149, 
+0000d0e0: 2030 2e35 3433 3233 3432 385d 2920 2320   0.54323428]) # 
+0000d0f0: 7261 6e64 6f6d 0d0a 0d0a 2020 5468 7265  random....  Thre
+0000d100: 652d 6279 2d74 776f 2061 7272 6179 206f  e-by-two array o
+0000d110: 6620 7261 6e64 6f6d 206e 756d 6265 7273  f random numbers
+0000d120: 2066 726f 6d20 5b2d 352c 2030 293a 0d0a   from [-5, 0):..
+0000d130: 0d0a 2020 3e3e 3e20 3520 2a20 6263 2e72  ..  >>> 5 * bc.r
+0000d140: 616e 646f 6d2e 7261 6e64 6f6d 5f73 616d  andom.random_sam
+0000d150: 706c 6528 2833 2c20 3229 2920 2d20 350d  ple((3, 2)) - 5.
+0000d160: 0a20 2061 7272 6179 285b 5b2d 332e 3939  .  array([[-3.99
+0000d170: 3134 3939 3839 2c20 2d30 2e35 3233 3338  149989, -0.52338
+0000d180: 3938 345d 2c20 2320 7261 6e64 6f6d 0d0a  984], # random..
+0000d190: 2020 2020 2020 2020 205b 2d32 2e39 3930           [-2.990
+0000d1a0: 3931 3835 382c 202d 302e 3739 3437 3935  91858, -0.794795
+0000d1b0: 3038 5d2c 0d0a 2020 2020 2020 2020 205b  08],..         [
+0000d1c0: 2d31 2e32 3332 3034 3334 352c 202d 312e  -1.23204345, -1.
+0000d1d0: 3735 3232 3434 3934 5d5d 290d 0a20 2022  75224494]])..  "
+0000d1e0: 2222 0d0a 2020 7265 7475 726e 2044 4546  ""..  return DEF
+0000d1f0: 4155 4c54 2e72 616e 646f 6d5f 7361 6d70  AULT.random_samp
+0000d200: 6c65 2873 697a 652c 206b 6579 3d6b 6579  le(size, key=key
+0000d210: 2c20 6474 7970 653d 6474 7970 6529 0d0a  , dtype=dtype)..
+0000d220: 0d0a 0d0a 6465 6620 7261 6e66 2873 697a  ....def ranf(siz
+0000d230: 653a 204f 7074 696f 6e61 6c5b 5369 7a65  e: Optional[Size
+0000d240: 5d20 3d20 4e6f 6e65 2c20 6b65 793a 204f  ] = None, key: O
+0000d250: 7074 696f 6e61 6c5b 5365 6564 4f72 4b65  ptional[SeedOrKe
+0000d260: 795d 203d 204e 6f6e 652c 2064 7479 7065  y] = None, dtype
+0000d270: 3a20 4454 7970 654c 696b 6520 3d20 4e6f  : DTypeLike = No
+0000d280: 6e65 293a 0d0a 2020 7222 2222 0d0a 2020  ne):..  r"""..  
+0000d290: 5468 6973 2069 7320 616e 2061 6c69 6173  This is an alias
+0000d2a0: 206f 6620 6072 616e 646f 6d5f 7361 6d70   of `random_samp
+0000d2b0: 6c65 602e 2053 6565 2060 7261 6e64 6f6d  le`. See `random
+0000d2c0: 5f73 616d 706c 6560 2020 666f 7220 7468  _sample`  for th
+0000d2d0: 6520 636f 6d70 6c65 7465 0d0a 2020 646f  e complete..  do
+0000d2e0: 6375 6d65 6e74 6174 696f 6e2e 0d0a 2020  cumentation...  
+0000d2f0: 2222 220d 0a20 2072 6574 7572 6e20 4445  """..  return DE
+0000d300: 4641 554c 542e 7261 6e66 2873 697a 652c  FAULT.ranf(size,
+0000d310: 206b 6579 3d6b 6579 2c20 6474 7970 653d   key=key, dtype=
+0000d320: 6474 7970 6529 0d0a 0d0a 0d0a 6465 6620  dtype)......def 
+0000d330: 7361 6d70 6c65 2873 697a 653a 204f 7074  sample(size: Opt
+0000d340: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
+0000d350: 6e65 2c20 6b65 793a 204f 7074 696f 6e61  ne, key: Optiona
+0000d360: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
+0000d370: 6f6e 652c 2064 7479 7065 3a20 4454 7970  one, dtype: DTyp
+0000d380: 654c 696b 6520 3d20 4e6f 6e65 293a 0d0a  eLike = None):..
+0000d390: 2020 2222 220d 0a20 2054 6869 7320 6973    """..  This is
+0000d3a0: 2061 6e20 616c 6961 7320 6f66 2060 7261   an alias of `ra
+0000d3b0: 6e64 6f6d 5f73 616d 706c 6560 2e20 5365  ndom_sample`. Se
+0000d3c0: 6520 6072 616e 646f 6d5f 7361 6d70 6c65  e `random_sample
+0000d3d0: 6020 2066 6f72 2074 6865 2063 6f6d 706c  `  for the compl
+0000d3e0: 6574 650d 0a20 2064 6f63 756d 656e 7461  ete..  documenta
+0000d3f0: 7469 6f6e 2e0d 0a20 2022 2222 0d0a 2020  tion...  """..  
+0000d400: 7265 7475 726e 2044 4546 4155 4c54 2e73  return DEFAULT.s
+0000d410: 616d 706c 6528 7369 7a65 2c20 6b65 793d  ample(size, key=
+0000d420: 6b65 792c 2064 7479 7065 3d64 7479 7065  key, dtype=dtype
+0000d430: 290d 0a0d 0a0d 0a64 6566 2063 686f 6963  )......def choic
+0000d440: 6528 612c 2073 697a 653a 204f 7074 696f  e(a, size: Optio
+0000d450: 6e61 6c5b 5369 7a65 5d20 3d20 4e6f 6e65  nal[Size] = None
+0000d460: 2c20 7265 706c 6163 653d 5472 7565 2c20  , replace=True, 
+0000d470: 703d 4e6f 6e65 2c0d 0a20 2020 2020 2020  p=None,..       
+0000d480: 2020 2020 6b65 793a 204f 7074 696f 6e61      key: Optiona
+0000d490: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
+0000d4a0: 6f6e 6529 3a0d 0a20 2072 2222 220d 0a20  one):..  r""".. 
+0000d4b0: 2047 656e 6572 6174 6573 2061 2072 616e   Generates a ran
+0000d4c0: 646f 6d20 7361 6d70 6c65 2066 726f 6d20  dom sample from 
+0000d4d0: 6120 6769 7665 6e20 312d 4420 6172 7261  a given 1-D arra
+0000d4e0: 790d 0a0d 0a20 2050 6172 616d 6574 6572  y....  Parameter
+0000d4f0: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
+0000d500: 0a20 2061 203a 2031 2d44 2061 7272 6179  .  a : 1-D array
+0000d510: 2d6c 696b 6520 6f72 2069 6e74 0d0a 2020  -like or int..  
+0000d520: 2020 2020 4966 2061 6e20 6e64 6172 7261      If an ndarra
+0000d530: 792c 2061 2072 616e 646f 6d20 7361 6d70  y, a random samp
+0000d540: 6c65 2069 7320 6765 6e65 7261 7465 6420  le is generated 
+0000d550: 6672 6f6d 2069 7473 2065 6c65 6d65 6e74  from its element
+0000d560: 732e 0d0a 2020 2020 2020 4966 2061 6e20  s...      If an 
+0000d570: 696e 742c 2074 6865 2072 616e 646f 6d20  int, the random 
+0000d580: 7361 6d70 6c65 2069 7320 6765 6e65 7261  sample is genera
+0000d590: 7465 6420 6173 2069 6620 6974 2077 6572  ted as if it wer
+0000d5a0: 6520 6060 6e70 2e61 7261 6e67 6528 6129  e ``np.arange(a)
+0000d5b0: 6060 0d0a 2020 7369 7a65 203a 2069 6e74  ``..  size : int
+0000d5c0: 206f 7220 7475 706c 6520 6f66 2069 6e74   or tuple of int
+0000d5d0: 732c 206f 7074 696f 6e61 6c0d 0a20 2020  s, optional..   
+0000d5e0: 2020 204f 7574 7075 7420 7368 6170 652e     Output shape.
+0000d5f0: 2020 4966 2074 6865 2067 6976 656e 2073    If the given s
+0000d600: 6861 7065 2069 732c 2065 2e67 2e2c 2060  hape is, e.g., `
+0000d610: 6028 6d2c 206e 2c20 6b29 6060 2c20 7468  `(m, n, k)``, th
+0000d620: 656e 0d0a 2020 2020 2020 6060 6d20 2a20  en..      ``m * 
+0000d630: 6e20 2a20 6b60 6020 7361 6d70 6c65 7320  n * k`` samples 
+0000d640: 6172 6520 6472 6177 6e2e 2020 4465 6661  are drawn.  Defa
+0000d650: 756c 7420 6973 204e 6f6e 652c 2069 6e20  ult is None, in 
+0000d660: 7768 6963 6820 6361 7365 2061 0d0a 2020  which case a..  
+0000d670: 2020 2020 7369 6e67 6c65 2076 616c 7565      single value
+0000d680: 2069 7320 7265 7475 726e 6564 2e0d 0a20   is returned... 
+0000d690: 2072 6570 6c61 6365 203a 2062 6f6f 6c65   replace : boole
+0000d6a0: 616e 2c20 6f70 7469 6f6e 616c 0d0a 2020  an, optional..  
+0000d6b0: 2020 2020 5768 6574 6865 7220 7468 6520      Whether the 
+0000d6c0: 7361 6d70 6c65 2069 7320 7769 7468 206f  sample is with o
+0000d6d0: 7220 7769 7468 6f75 7420 7265 706c 6163  r without replac
+0000d6e0: 656d 656e 742e 2044 6566 6175 6c74 2069  ement. Default i
+0000d6f0: 7320 5472 7565 2c0d 0a20 2020 2020 206d  s True,..      m
+0000d700: 6561 6e69 6e67 2074 6861 7420 6120 7661  eaning that a va
+0000d710: 6c75 6520 6f66 2060 6061 6060 2063 616e  lue of ``a`` can
+0000d720: 2062 6520 7365 6c65 6374 6564 206d 756c   be selected mul
+0000d730: 7469 706c 6520 7469 6d65 732e 0d0a 2020  tiple times...  
+0000d740: 7020 3a20 312d 4420 6172 7261 792d 6c69  p : 1-D array-li
+0000d750: 6b65 2c20 6f70 7469 6f6e 616c 0d0a 2020  ke, optional..  
+0000d760: 2020 2020 5468 6520 7072 6f62 6162 696c      The probabil
+0000d770: 6974 6965 7320 6173 736f 6369 6174 6564  ities associated
+0000d780: 2077 6974 6820 6561 6368 2065 6e74 7279   with each entry
+0000d790: 2069 6e20 612e 0d0a 2020 2020 2020 4966   in a...      If
+0000d7a0: 206e 6f74 2067 6976 656e 2c20 7468 6520   not given, the 
+0000d7b0: 7361 6d70 6c65 2061 7373 756d 6573 2061  sample assumes a
+0000d7c0: 2075 6e69 666f 726d 2064 6973 7472 6962   uniform distrib
+0000d7d0: 7574 696f 6e20 6f76 6572 2061 6c6c 0d0a  ution over all..
+0000d7e0: 2020 2020 2020 656e 7472 6965 7320 696e        entries in
+0000d7f0: 2060 6061 6060 2e0d 0a20 206b 6579 203a   ``a``...  key :
+0000d800: 2050 524e 474b 6579 2c20 6f70 7469 6f6e   PRNGKey, option
+0000d810: 616c 0d0a 2020 2020 2020 5468 6520 6b65  al..      The ke
+0000d820: 7920 666f 7220 7468 6520 7261 6e64 6f6d  y for the random
+0000d830: 206e 756d 6265 7220 6765 6e65 7261 746f   number generato
+0000d840: 722e 2049 6620 6e6f 7420 6769 7665 6e2c  r. If not given,
+0000d850: 2074 6865 0d0a 2020 2020 2020 6465 6661   the..      defa
+0000d860: 756c 7420 7261 6e64 6f6d 206e 756d 6265  ult random numbe
+0000d870: 7220 6765 6e65 7261 746f 7220 6973 2075  r generator is u
+0000d880: 7365 642e 0d0a 0d0a 2020 5265 7475 726e  sed.....  Return
+0000d890: 730d 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020  s..  -------..  
+0000d8a0: 7361 6d70 6c65 7320 3a20 7369 6e67 6c65  samples : single
+0000d8b0: 2069 7465 6d20 6f72 206e 6461 7272 6179   item or ndarray
+0000d8c0: 0d0a 2020 2020 2020 5468 6520 6765 6e65  ..      The gene
+0000d8d0: 7261 7465 6420 7261 6e64 6f6d 2073 616d  rated random sam
+0000d8e0: 706c 6573 0d0a 0d0a 2020 5261 6973 6573  ples....  Raises
+0000d8f0: 0d0a 2020 2d2d 2d2d 2d2d 0d0a 2020 5661  ..  ------..  Va
+0000d900: 6c75 6545 7272 6f72 0d0a 2020 2020 2020  lueError..      
+0000d910: 4966 2061 2069 7320 616e 2069 6e74 2061  If a is an int a
+0000d920: 6e64 206c 6573 7320 7468 616e 207a 6572  nd less than zer
+0000d930: 6f2c 2069 6620 6120 6f72 2070 2061 7265  o, if a or p are
+0000d940: 206e 6f74 2031 2d64 696d 656e 7369 6f6e   not 1-dimension
+0000d950: 616c 2c0d 0a20 2020 2020 2069 6620 6120  al,..      if a 
+0000d960: 6973 2061 6e20 6172 7261 792d 6c69 6b65  is an array-like
+0000d970: 206f 6620 7369 7a65 2030 2c20 6966 2070   of size 0, if p
+0000d980: 2069 7320 6e6f 7420 6120 7665 6374 6f72   is not a vector
+0000d990: 206f 660d 0a20 2020 2020 2070 726f 6261   of..      proba
+0000d9a0: 6269 6c69 7469 6573 2c20 6966 2061 2061  bilities, if a a
+0000d9b0: 6e64 2070 2068 6176 6520 6469 6666 6572  nd p have differ
+0000d9c0: 656e 7420 6c65 6e67 7468 732c 206f 7220  ent lengths, or 
+0000d9d0: 6966 0d0a 2020 2020 2020 7265 706c 6163  if..      replac
+0000d9e0: 653d 4661 6c73 6520 616e 6420 7468 6520  e=False and the 
+0000d9f0: 7361 6d70 6c65 2073 697a 6520 6973 2067  sample size is g
+0000da00: 7265 6174 6572 2074 6861 6e20 7468 6520  reater than the 
+0000da10: 706f 7075 6c61 7469 6f6e 0d0a 2020 2020  population..    
+0000da20: 2020 7369 7a65 0d0a 0d0a 2020 5365 6520    size....  See 
+0000da30: 416c 736f 0d0a 2020 2d2d 2d2d 2d2d 2d2d  Also..  --------
+0000da40: 0d0a 2020 7261 6e64 696e 742c 2073 6875  ..  randint, shu
+0000da50: 6666 6c65 2c20 7065 726d 7574 6174 696f  ffle, permutatio
+0000da60: 6e0d 0a20 2047 656e 6572 6174 6f72 2e63  n..  Generator.c
+0000da70: 686f 6963 653a 2077 6869 6368 2073 686f  hoice: which sho
+0000da80: 756c 6420 6265 2075 7365 6420 696e 206e  uld be used in n
+0000da90: 6577 2063 6f64 650d 0a0d 0a20 204e 6f74  ew code....  Not
+0000daa0: 6573 0d0a 2020 2d2d 2d2d 2d0d 0a20 2053  es..  -----..  S
+0000dab0: 6574 7469 6e67 2075 7365 722d 7370 6563  etting user-spec
+0000dac0: 6966 6965 6420 7072 6f62 6162 696c 6974  ified probabilit
+0000dad0: 6965 7320 7468 726f 7567 6820 6060 7060  ies through ``p`
+0000dae0: 6020 7573 6573 2061 206d 6f72 6520 6765  ` uses a more ge
+0000daf0: 6e65 7261 6c20 6275 7420 6c65 7373 0d0a  neral but less..
+0000db00: 2020 6566 6669 6369 656e 7420 7361 6d70    efficient samp
+0000db10: 6c65 7220 7468 616e 2074 6865 2064 6566  ler than the def
+0000db20: 6175 6c74 2e20 5468 6520 6765 6e65 7261  ault. The genera
+0000db30: 6c20 7361 6d70 6c65 7220 7072 6f64 7563  l sampler produc
+0000db40: 6573 2061 2064 6966 6665 7265 6e74 2073  es a different s
+0000db50: 616d 706c 650d 0a20 2074 6861 6e20 7468  ample..  than th
+0000db60: 6520 6f70 7469 6d69 7a65 6420 7361 6d70  e optimized samp
+0000db70: 6c65 7220 6576 656e 2069 6620 6561 6368  ler even if each
+0000db80: 2065 6c65 6d65 6e74 206f 6620 6060 7060   element of ``p`
+0000db90: 6020 6973 2031 202f 206c 656e 2861 292e  ` is 1 / len(a).
+0000dba0: 0d0a 0d0a 2020 5361 6d70 6c69 6e67 2072  ....  Sampling r
+0000dbb0: 616e 646f 6d20 726f 7773 2066 726f 6d20  andom rows from 
+0000dbc0: 6120 322d 4420 6172 7261 7920 6973 206e  a 2-D array is n
+0000dbd0: 6f74 2070 6f73 7369 626c 6520 7769 7468  ot possible with
+0000dbe0: 2074 6869 7320 6675 6e63 7469 6f6e 2c0d   this function,.
+0000dbf0: 0a20 2062 7574 2069 7320 706f 7373 6962  .  but is possib
+0000dc00: 6c65 2077 6974 6820 6047 656e 6572 6174  le with `Generat
+0000dc10: 6f72 2e63 686f 6963 6560 2074 6872 6f75  or.choice` throu
+0000dc20: 6768 2069 7473 2060 6061 7869 7360 6020  gh its ``axis`` 
+0000dc30: 6b65 7977 6f72 642e 0d0a 0d0a 2020 4578  keyword.....  Ex
+0000dc40: 616d 706c 6573 0d0a 2020 2d2d 2d2d 2d2d  amples..  ------
+0000dc50: 2d2d 0d0a 2020 4765 6e65 7261 7465 2061  --..  Generate a
+0000dc60: 2075 6e69 666f 726d 2072 616e 646f 6d20   uniform random 
+0000dc70: 7361 6d70 6c65 2066 726f 6d20 6e70 2e61  sample from np.a
+0000dc80: 7261 6e67 6528 3529 206f 6620 7369 7a65  range(5) of size
+0000dc90: 2033 3a0d 0a0d 0a20 203e 3e3e 2069 6d70   3:....  >>> imp
+0000dca0: 6f72 7420 6272 6169 6e63 6f72 6520 6173  ort braincore as
+0000dcb0: 2062 630d 0a20 203e 3e3e 2062 632e 7261   bc..  >>> bc.ra
+0000dcc0: 6e64 6f6d 2e63 686f 6963 6528 352c 2033  ndom.choice(5, 3
+0000dcd0: 290d 0a20 2061 7272 6179 285b 302c 2033  )..  array([0, 3
+0000dce0: 2c20 345d 2920 2320 7261 6e64 6f6d 0d0a  , 4]) # random..
+0000dcf0: 2020 3e3e 3e20 2354 6869 7320 6973 2065    >>> #This is e
+0000dd00: 7175 6976 616c 656e 7420 746f 2062 7261  quivalent to bra
+0000dd10: 696e 7079 2e6d 6174 682e 7261 6e64 6f6d  inpy.math.random
+0000dd20: 2e72 616e 6469 6e74 2830 2c35 2c33 290d  .randint(0,5,3).
+0000dd30: 0a0d 0a20 2047 656e 6572 6174 6520 6120  ...  Generate a 
+0000dd40: 6e6f 6e2d 756e 6966 6f72 6d20 7261 6e64  non-uniform rand
+0000dd50: 6f6d 2073 616d 706c 6520 6672 6f6d 206e  om sample from n
+0000dd60: 702e 6172 616e 6765 2835 2920 6f66 2073  p.arange(5) of s
+0000dd70: 697a 6520 333a 0d0a 0d0a 2020 3e3e 3e20  ize 3:....  >>> 
+0000dd80: 6263 2e72 616e 646f 6d2e 6368 6f69 6365  bc.random.choice
+0000dd90: 2835 2c20 332c 2070 3d5b 302e 312c 2030  (5, 3, p=[0.1, 0
+0000dda0: 2c20 302e 332c 2030 2e36 2c20 305d 290d  , 0.3, 0.6, 0]).
+0000ddb0: 0a20 2061 7272 6179 285b 332c 2033 2c20  .  array([3, 3, 
+0000ddc0: 305d 2920 2320 7261 6e64 6f6d 0d0a 0d0a  0]) # random....
+0000ddd0: 2020 4765 6e65 7261 7465 2061 2075 6e69    Generate a uni
+0000dde0: 666f 726d 2072 616e 646f 6d20 7361 6d70  form random samp
+0000ddf0: 6c65 2066 726f 6d20 6e70 2e61 7261 6e67  le from np.arang
+0000de00: 6528 3529 206f 6620 7369 7a65 2033 2077  e(5) of size 3 w
+0000de10: 6974 686f 7574 0d0a 2020 7265 706c 6163  ithout..  replac
+0000de20: 656d 656e 743a 0d0a 0d0a 2020 3e3e 3e20  ement:....  >>> 
+0000de30: 6263 2e72 616e 646f 6d2e 6368 6f69 6365  bc.random.choice
+0000de40: 2835 2c20 332c 2072 6570 6c61 6365 3d46  (5, 3, replace=F
+0000de50: 616c 7365 290d 0a20 2061 7272 6179 285b  alse)..  array([
+0000de60: 332c 312c 305d 2920 2320 7261 6e64 6f6d  3,1,0]) # random
+0000de70: 0d0a 2020 3e3e 3e20 2354 6869 7320 6973  ..  >>> #This is
+0000de80: 2065 7175 6976 616c 656e 7420 746f 2062   equivalent to b
+0000de90: 7261 696e 7079 2e6d 6174 682e 7261 6e64  rainpy.math.rand
+0000dea0: 6f6d 2e70 6572 6d75 7461 7469 6f6e 286e  om.permutation(n
+0000deb0: 702e 6172 616e 6765 2835 2929 5b3a 335d  p.arange(5))[:3]
+0000dec0: 0d0a 0d0a 2020 4765 6e65 7261 7465 2061  ....  Generate a
+0000ded0: 206e 6f6e 2d75 6e69 666f 726d 2072 616e   non-uniform ran
+0000dee0: 646f 6d20 7361 6d70 6c65 2066 726f 6d20  dom sample from 
+0000def0: 6e70 2e61 7261 6e67 6528 3529 206f 6620  np.arange(5) of 
+0000df00: 7369 7a65 0d0a 2020 3320 7769 7468 6f75  size..  3 withou
+0000df10: 7420 7265 706c 6163 656d 656e 743a 0d0a  t replacement:..
+0000df20: 0d0a 2020 3e3e 3e20 6263 2e72 616e 646f  ..  >>> bc.rando
+0000df30: 6d2e 6368 6f69 6365 2835 2c20 332c 2072  m.choice(5, 3, r
+0000df40: 6570 6c61 6365 3d46 616c 7365 2c20 703d  eplace=False, p=
+0000df50: 5b30 2e31 2c20 302c 2030 2e33 2c20 302e  [0.1, 0, 0.3, 0.
+0000df60: 362c 2030 5d29 0d0a 2020 6172 7261 7928  6, 0])..  array(
+0000df70: 5b32 2c20 332c 2030 5d29 2023 2072 616e  [2, 3, 0]) # ran
+0000df80: 646f 6d0d 0a0d 0a20 2041 6e79 206f 6620  dom....  Any of 
+0000df90: 7468 6520 6162 6f76 6520 6361 6e20 6265  the above can be
+0000dfa0: 2072 6570 6561 7465 6420 7769 7468 2061   repeated with a
+0000dfb0: 6e20 6172 6269 7472 6172 7920 6172 7261  n arbitrary arra
+0000dfc0: 792d 6c69 6b65 0d0a 2020 696e 7374 6561  y-like..  instea
+0000dfd0: 6420 6f66 206a 7573 7420 696e 7465 6765  d of just intege
+0000dfe0: 7273 2e20 466f 7220 696e 7374 616e 6365  rs. For instance
+0000dff0: 3a0d 0a0d 0a20 203e 3e3e 2061 615f 6d69  :....  >>> aa_mi
+0000e000: 6c6e 655f 6172 7220 3d20 5b27 706f 6f68  lne_arr = ['pooh
+0000e010: 272c 2027 7261 6262 6974 272c 2027 7069  ', 'rabbit', 'pi
+0000e020: 676c 6574 272c 2027 4368 7269 7374 6f70  glet', 'Christop
+0000e030: 6865 7227 5d0d 0a20 203e 3e3e 2062 632e  her']..  >>> bc.
+0000e040: 7261 6e64 6f6d 2e63 686f 6963 6528 6161  random.choice(aa
+0000e050: 5f6d 696c 6e65 5f61 7272 2c20 352c 2070  _milne_arr, 5, p
+0000e060: 3d5b 302e 352c 2030 2e31 2c20 302e 312c  =[0.5, 0.1, 0.1,
+0000e070: 2030 2e33 5d29 0d0a 2020 6172 7261 7928   0.3])..  array(
+0000e080: 5b27 706f 6f68 272c 2027 706f 6f68 272c  ['pooh', 'pooh',
+0000e090: 2027 706f 6f68 272c 2027 4368 7269 7374   'pooh', 'Christ
+0000e0a0: 6f70 6865 7227 2c20 2770 6967 6c65 7427  opher', 'piglet'
+0000e0b0: 5d2c 2023 2072 616e 646f 6d0d 0a20 2020  ], # random..   
+0000e0c0: 2020 2020 2064 7479 7065 3d27 3c55 3131       dtype='<U11
+0000e0d0: 2729 0d0a 2020 2222 220d 0a20 2061 203d  ')..  """..  a =
+0000e0e0: 2061 0d0a 2020 7265 7475 726e 2044 4546   a..  return DEF
+0000e0f0: 4155 4c54 2e63 686f 6963 6528 613d 612c  AULT.choice(a=a,
+0000e100: 2073 697a 653d 7369 7a65 2c20 7265 706c   size=size, repl
+0000e110: 6163 653d 7265 706c 6163 652c 2070 3d70  ace=replace, p=p
+0000e120: 2c20 6b65 793d 6b65 7929 0d0a 0d0a 0d0a  , key=key)......
+0000e130: 6465 6620 7065 726d 7574 6174 696f 6e28  def permutation(
+0000e140: 782c 0d0a 2020 2020 2020 2020 2020 2020  x,..            
+0000e150: 2020 2020 6178 6973 3a20 696e 7420 3d20      axis: int = 
+0000e160: 302c 0d0a 2020 2020 2020 2020 2020 2020  0,..            
+0000e170: 2020 2020 696e 6465 7065 6e64 656e 743a      independent:
+0000e180: 2062 6f6f 6c20 3d20 4661 6c73 652c 0d0a   bool = False,..
+0000e190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e1a0: 6b65 793a 204f 7074 696f 6e61 6c5b 5365  key: Optional[Se
+0000e1b0: 6564 4f72 4b65 795d 203d 204e 6f6e 6529  edOrKey] = None)
+0000e1c0: 3a0d 0a20 2072 2222 220d 0a20 2052 616e  :..  r"""..  Ran
+0000e1d0: 646f 6d6c 7920 7065 726d 7574 6520 6120  domly permute a 
+0000e1e0: 7365 7175 656e 6365 2c20 6f72 2072 6574  sequence, or ret
+0000e1f0: 7572 6e20 6120 7065 726d 7574 6564 2072  urn a permuted r
+0000e200: 616e 6765 2e0d 0a0d 0a20 2049 6620 6078  ange.....  If `x
+0000e210: 6020 6973 2061 206d 756c 7469 2d64 696d  ` is a multi-dim
+0000e220: 656e 7369 6f6e 616c 2061 7272 6179 2c20  ensional array, 
+0000e230: 6974 2069 7320 6f6e 6c79 2073 6875 6666  it is only shuff
+0000e240: 6c65 6420 616c 6f6e 6720 6974 730d 0a20  led along its.. 
+0000e250: 2066 6972 7374 2069 6e64 6578 2e0d 0a0d   first index....
+0000e260: 0a20 2050 6172 616d 6574 6572 730d 0a20  .  Parameters.. 
+0000e270: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2078   ----------..  x
+0000e280: 203a 2069 6e74 206f 7220 6172 7261 795f   : int or array_
+0000e290: 6c69 6b65 0d0a 2020 2020 2020 4966 2060  like..      If `
+0000e2a0: 7860 2069 7320 616e 2069 6e74 6567 6572  x` is an integer
+0000e2b0: 2c20 7261 6e64 6f6d 6c79 2070 6572 6d75  , randomly permu
+0000e2c0: 7465 2060 606e 702e 6172 616e 6765 2878  te ``np.arange(x
+0000e2d0: 2960 602e 0d0a 2020 2020 2020 4966 2060  )``...      If `
+0000e2e0: 7860 2069 7320 616e 2061 7272 6179 2c20  x` is an array, 
+0000e2f0: 6d61 6b65 2061 2063 6f70 7920 616e 6420  make a copy and 
+0000e300: 7368 7566 666c 6520 7468 6520 656c 656d  shuffle the elem
+0000e310: 656e 7473 0d0a 2020 2020 2020 7261 6e64  ents..      rand
+0000e320: 6f6d 6c79 2e0d 0a20 2061 7869 7320 3a20  omly...  axis : 
+0000e330: 696e 742c 206f 7074 696f 6e61 6c0d 0a20  int, optional.. 
+0000e340: 2020 2020 2054 6865 2061 7869 7320 7768       The axis wh
+0000e350: 6963 6820 6078 6020 6973 2073 6875 6666  ich `x` is shuff
+0000e360: 6c65 6420 616c 6f6e 672e 2044 6566 6175  led along. Defau
+0000e370: 6c74 2069 7320 302e 0d0a 2020 696e 6465  lt is 0...  inde
+0000e380: 7065 6e64 656e 7420 3a20 626f 6f6c 2c20  pendent : bool, 
+0000e390: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+0000e3a0: 5768 6574 6865 7220 746f 2075 7365 2069  Whether to use i
+0000e3b0: 6e64 6570 656e 6465 6e74 2072 616e 646f  ndependent rando
+0000e3c0: 6d20 7065 726d 7574 6174 696f 6e73 2066  m permutations f
+0000e3d0: 6f72 2065 6163 680d 0a20 2020 2020 2062  or each..      b
+0000e3e0: 6174 6368 2e20 4966 2060 6046 616c 7365  atch. If ``False
+0000e3f0: 6060 2028 6465 6661 756c 7429 2c20 7468  `` (default), th
+0000e400: 6520 7361 6d65 2072 616e 646f 6d20 7065  e same random pe
+0000e410: 726d 7574 6174 696f 6e20 6973 0d0a 2020  rmutation is..  
+0000e420: 2020 2020 7573 6564 2066 6f72 2061 6c6c      used for all
+0000e430: 2062 6174 6368 6573 2e20 4966 2060 6054   batches. If ``T
+0000e440: 7275 6560 602c 2065 6163 6820 6261 7463  rue``, each batc
+0000e450: 6820 6973 2073 6875 6666 6c65 640d 0a20  h is shuffled.. 
+0000e460: 2020 2020 2069 6e64 6570 656e 6465 6e74       independent
+0000e470: 6c79 2e20 4967 6e6f 7265 6420 6966 2060  ly. Ignored if `
+0000e480: 7860 2069 7320 616e 2069 6e74 6567 6572  x` is an integer
+0000e490: 2e0d 0a20 206b 6579 203a 2050 524e 474b  ...  key : PRNGK
+0000e4a0: 6579 2c20 6f70 7469 6f6e 616c 0d0a 2020  ey, optional..  
+0000e4b0: 2020 2020 5468 6520 6b65 7920 666f 7220      The key for 
+0000e4c0: 7468 6520 7261 6e64 6f6d 206e 756d 6265  the random numbe
+0000e4d0: 7220 6765 6e65 7261 746f 722e 2049 6620  r generator. If 
+0000e4e0: 6e6f 7420 6769 7665 6e2c 2074 6865 0d0a  not given, the..
+0000e4f0: 2020 2020 2020 6465 6661 756c 7420 7261        default ra
+0000e500: 6e64 6f6d 206e 756d 6265 7220 6765 6e65  ndom number gene
+0000e510: 7261 746f 7220 6973 2075 7365 642e 0d0a  rator is used...
+0000e520: 0d0a 2020 5265 7475 726e 730d 0a20 202d  ..  Returns..  -
+0000e530: 2d2d 2d2d 2d2d 0d0a 2020 6f75 7420 3a20  ------..  out : 
+0000e540: 6e64 6172 7261 790d 0a20 2020 2020 2050  ndarray..      P
+0000e550: 6572 6d75 7465 6420 7365 7175 656e 6365  ermuted sequence
+0000e560: 206f 7220 6172 7261 7920 7261 6e67 652e   or array range.
+0000e570: 0d0a 0d0a 2020 4578 616d 706c 6573 0d0a  ....  Examples..
+0000e580: 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020 3e3e    --------..  >>
+0000e590: 3e20 696d 706f 7274 2062 7261 696e 636f  > import brainco
+0000e5a0: 7265 2061 7320 6263 0d0a 2020 3e3e 3e20  re as bc..  >>> 
+0000e5b0: 6263 2e72 616e 646f 6d2e 7065 726d 7574  bc.random.permut
+0000e5c0: 6174 696f 6e28 3130 290d 0a20 2061 7272  ation(10)..  arr
+0000e5d0: 6179 285b 312c 2037 2c20 342c 2033 2c20  ay([1, 7, 4, 3, 
+0000e5e0: 302c 2039 2c20 322c 2035 2c20 382c 2036  0, 9, 2, 5, 8, 6
+0000e5f0: 5d29 2023 2072 616e 646f 6d0d 0a0d 0a20  ]) # random.... 
+0000e600: 203e 3e3e 2062 632e 7261 6e64 6f6d 2e70   >>> bc.random.p
+0000e610: 6572 6d75 7461 7469 6f6e 285b 312c 2034  ermutation([1, 4
+0000e620: 2c20 392c 2031 322c 2031 355d 290d 0a20  , 9, 12, 15]).. 
+0000e630: 2061 7272 6179 285b 3135 2c20 2031 2c20   array([15,  1, 
+0000e640: 2039 2c20 2034 2c20 3132 5d29 2023 2072   9,  4, 12]) # r
+0000e650: 616e 646f 6d0d 0a0d 0a20 203e 3e3e 2061  andom....  >>> a
+0000e660: 7272 203d 206e 702e 6172 616e 6765 2839  rr = np.arange(9
+0000e670: 292e 7265 7368 6170 6528 2833 2c20 3329  ).reshape((3, 3)
+0000e680: 290d 0a20 203e 3e3e 2062 632e 7261 6e64  )..  >>> bc.rand
+0000e690: 6f6d 2e70 6572 6d75 7461 7469 6f6e 2861  om.permutation(a
+0000e6a0: 7272 290d 0a20 2061 7272 6179 285b 5b36  rr)..  array([[6
+0000e6b0: 2c20 372c 2038 5d2c 2023 2072 616e 646f  , 7, 8], # rando
+0000e6c0: 6d0d 0a20 2020 2020 2020 2020 5b30 2c20  m..         [0, 
+0000e6d0: 312c 2032 5d2c 0d0a 2020 2020 2020 2020  1, 2],..        
+0000e6e0: 205b 332c 2034 2c20 355d 5d29 0d0a 2020   [3, 4, 5]])..  
+0000e6f0: 2222 220d 0a20 2072 6574 7572 6e20 4445  """..  return DE
+0000e700: 4641 554c 542e 7065 726d 7574 6174 696f  FAULT.permutatio
+0000e710: 6e28 782c 2061 7869 733d 6178 6973 2c20  n(x, axis=axis, 
+0000e720: 696e 6465 7065 6e64 656e 743d 696e 6465  independent=inde
+0000e730: 7065 6e64 656e 742c 206b 6579 3d6b 6579  pendent, key=key
+0000e740: 290d 0a0d 0a0d 0a64 6566 2073 6875 6666  )......def shuff
+0000e750: 6c65 2878 2c20 6178 6973 3d30 2c20 6b65  le(x, axis=0, ke
+0000e760: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
+0000e770: 4f72 4b65 795d 203d 204e 6f6e 6529 3a0d  OrKey] = None):.
+0000e780: 0a20 2072 2222 220d 0a20 204d 6f64 6966  .  r"""..  Modif
+0000e790: 7920 6120 7365 7175 656e 6365 2069 6e2d  y a sequence in-
+0000e7a0: 706c 6163 6520 6279 2073 6875 6666 6c69  place by shuffli
+0000e7b0: 6e67 2069 7473 2063 6f6e 7465 6e74 732e  ng its contents.
+0000e7c0: 0d0a 0d0a 2020 5468 6973 2066 756e 6374  ....  This funct
+0000e7d0: 696f 6e20 6f6e 6c79 2073 6875 6666 6c65  ion only shuffle
+0000e7e0: 7320 7468 6520 6172 7261 7920 616c 6f6e  s the array alon
+0000e7f0: 6720 7468 6520 6669 7273 7420 6178 6973  g the first axis
+0000e800: 206f 6620 610d 0a20 206d 756c 7469 2d64   of a..  multi-d
+0000e810: 696d 656e 7369 6f6e 616c 2061 7272 6179  imensional array
+0000e820: 2e20 5468 6520 6f72 6465 7220 6f66 2073  . The order of s
+0000e830: 7562 2d61 7272 6179 7320 6973 2063 6861  ub-arrays is cha
+0000e840: 6e67 6564 2062 7574 0d0a 2020 7468 6569  nged but..  thei
+0000e850: 7220 636f 6e74 656e 7473 2072 656d 6169  r contents remai
+0000e860: 6e73 2074 6865 2073 616d 652e 0d0a 0d0a  ns the same.....
+0000e870: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+0000e880: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 7820  ----------..  x 
+0000e890: 3a20 6e64 6172 7261 7920 6f72 204d 7574  : ndarray or Mut
+0000e8a0: 6162 6c65 5365 7175 656e 6365 0d0a 2020  ableSequence..  
+0000e8b0: 2020 2020 5468 6520 6172 7261 792c 206c      The array, l
+0000e8c0: 6973 7420 6f72 206d 7574 6162 6c65 2073  ist or mutable s
+0000e8d0: 6571 7565 6e63 6520 746f 2062 6520 7368  equence to be sh
+0000e8e0: 7566 666c 6564 2e0d 0a20 206b 6579 203a  uffled...  key :
+0000e8f0: 2050 524e 474b 6579 2c20 6f70 7469 6f6e   PRNGKey, option
+0000e900: 616c 0d0a 2020 2020 2020 5468 6520 6b65  al..      The ke
+0000e910: 7920 666f 7220 7468 6520 7261 6e64 6f6d  y for the random
+0000e920: 206e 756d 6265 7220 6765 6e65 7261 746f   number generato
+0000e930: 722e 2049 6620 6e6f 7420 6769 7665 6e2c  r. If not given,
+0000e940: 2074 6865 0d0a 2020 2020 2020 6465 6661   the..      defa
+0000e950: 756c 7420 7261 6e64 6f6d 206e 756d 6265  ult random numbe
+0000e960: 7220 6765 6e65 7261 746f 7220 6973 2075  r generator is u
+0000e970: 7365 642e 0d0a 0d0a 2020 5265 7475 726e  sed.....  Return
+0000e980: 730d 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020  s..  -------..  
+0000e990: 4e6f 6e65 0d0a 0d0a 2020 4578 616d 706c  None....  Exampl
+0000e9a0: 6573 0d0a 2020 2d2d 2d2d 2d2d 2d2d 0d0a  es..  --------..
+0000e9b0: 2020 3e3e 3e20 696d 706f 7274 2062 7261    >>> import bra
+0000e9c0: 696e 636f 7265 2061 7320 6263 0d0a 2020  incore as bc..  
+0000e9d0: 3e3e 3e20 6172 7220 3d20 6e70 2e61 7261  >>> arr = np.ara
+0000e9e0: 6e67 6528 3130 290d 0a20 203e 3e3e 2062  nge(10)..  >>> b
+0000e9f0: 632e 7261 6e64 6f6d 2e73 6875 6666 6c65  c.random.shuffle
+0000ea00: 2861 7272 290d 0a20 203e 3e3e 2061 7272  (arr)..  >>> arr
+0000ea10: 0d0a 2020 5b31 2037 2035 2032 2039 2034  ..  [1 7 5 2 9 4
+0000ea20: 2033 2036 2030 2038 5d20 2320 7261 6e64   3 6 0 8] # rand
+0000ea30: 6f6d 0d0a 0d0a 2020 4d75 6c74 692d 6469  om....  Multi-di
+0000ea40: 6d65 6e73 696f 6e61 6c20 6172 7261 7973  mensional arrays
+0000ea50: 2061 7265 206f 6e6c 7920 7368 7566 666c   are only shuffl
+0000ea60: 6564 2061 6c6f 6e67 2074 6865 2066 6972  ed along the fir
+0000ea70: 7374 2061 7869 733a 0d0a 0d0a 2020 3e3e  st axis:....  >>
+0000ea80: 3e20 6172 7220 3d20 6e70 2e61 7261 6e67  > arr = np.arang
+0000ea90: 6528 3929 2e72 6573 6861 7065 2828 332c  e(9).reshape((3,
+0000eaa0: 2033 2929 0d0a 2020 3e3e 3e20 6263 2e72   3))..  >>> bc.r
+0000eab0: 616e 646f 6d2e 7368 7566 666c 6528 6172  andom.shuffle(ar
+0000eac0: 7229 0d0a 2020 3e3e 3e20 6172 720d 0a20  r)..  >>> arr.. 
+0000ead0: 2061 7272 6179 285b 5b33 2c20 342c 2035   array([[3, 4, 5
+0000eae0: 5d2c 2023 2072 616e 646f 6d0d 0a20 2020  ], # random..   
+0000eaf0: 2020 2020 2020 5b36 2c20 372c 2038 5d2c        [6, 7, 8],
+0000eb00: 0d0a 2020 2020 2020 2020 205b 302c 2031  ..         [0, 1
+0000eb10: 2c20 325d 5d29 0d0a 2020 2222 220d 0a20  , 2]])..  """.. 
+0000eb20: 2044 4546 4155 4c54 2e73 6875 6666 6c65   DEFAULT.shuffle
+0000eb30: 2878 2c20 6178 6973 2c20 6b65 793d 6b65  (x, axis, key=ke
+0000eb40: 7929 0d0a 0d0a 0d0a 6465 6620 6265 7461  y)......def beta
+0000eb50: 2861 2c20 622c 2073 697a 653a 204f 7074  (a, b, size: Opt
+0000eb60: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
+0000eb70: 6e65 2c20 6b65 793a 204f 7074 696f 6e61  ne, key: Optiona
+0000eb80: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
+0000eb90: 6f6e 652c 2064 7479 7065 3a20 4454 7970  one, dtype: DTyp
+0000eba0: 654c 696b 6520 3d20 4e6f 6e65 293a 0d0a  eLike = None):..
+0000ebb0: 2020 7222 2222 0d0a 2020 4472 6177 2073    r"""..  Draw s
+0000ebc0: 616d 706c 6573 2066 726f 6d20 6120 4265  amples from a Be
+0000ebd0: 7461 2064 6973 7472 6962 7574 696f 6e2e  ta distribution.
+0000ebe0: 0d0a 0d0a 2020 5468 6520 4265 7461 2064  ....  The Beta d
+0000ebf0: 6973 7472 6962 7574 696f 6e20 6973 2061  istribution is a
+0000ec00: 2073 7065 6369 616c 2063 6173 6520 6f66   special case of
+0000ec10: 2074 6865 2044 6972 6963 686c 6574 2064   the Dirichlet d
+0000ec20: 6973 7472 6962 7574 696f 6e2c 0d0a 2020  istribution,..  
+0000ec30: 616e 6420 6973 2072 656c 6174 6564 2074  and is related t
+0000ec40: 6f20 7468 6520 4761 6d6d 6120 6469 7374  o the Gamma dist
+0000ec50: 7269 6275 7469 6f6e 2e20 2049 7420 6861  ribution.  It ha
+0000ec60: 7320 7468 6520 7072 6f62 6162 696c 6974  s the probabilit
+0000ec70: 790d 0a20 2064 6973 7472 6962 7574 696f  y..  distributio
+0000ec80: 6e20 6675 6e63 7469 6f6e 0d0a 0d0a 2020  n function....  
+0000ec90: 2e2e 206d 6174 683a 3a20 6628 783b 2061  .. math:: f(x; a
+0000eca0: 2c62 2920 3d20 5c66 7261 637b 317d 7b42  ,b) = \frac{1}{B
+0000ecb0: 285c 616c 7068 612c 205c 6265 7461 297d  (\alpha, \beta)}
+0000ecc0: 2078 5e7b 5c61 6c70 6861 202d 2031 7d0d   x^{\alpha - 1}.
+0000ecd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ece0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ecf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ed00: 2020 2020 2831 202d 2078 295e 7b5c 6265      (1 - x)^{\be
+0000ed10: 7461 202d 2031 7d2c 0d0a 0d0a 2020 7768  ta - 1},....  wh
+0000ed20: 6572 6520 7468 6520 6e6f 726d 616c 697a  ere the normaliz
+0000ed30: 6174 696f 6e2c 2042 2c20 6973 2074 6865  ation, B, is the
+0000ed40: 2062 6574 6120 6675 6e63 7469 6f6e 2c0d   beta function,.
+0000ed50: 0a0d 0a20 202e 2e20 6d61 7468 3a3a 2042  ...  .. math:: B
+0000ed60: 285c 616c 7068 612c 205c 6265 7461 2920  (\alpha, \beta) 
+0000ed70: 3d20 5c69 6e74 5f30 5e31 2074 5e7b 5c61  = \int_0^1 t^{\a
+0000ed80: 6c70 6861 202d 2031 7d0d 0a20 2020 2020  lpha - 1}..     
+0000ed90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eda0: 2020 2020 2020 2020 2020 2831 202d 2074            (1 - t
+0000edb0: 295e 7b5c 6265 7461 202d 2031 7d20 6474  )^{\beta - 1} dt
+0000edc0: 2e0d 0a0d 0a20 2049 7420 6973 206f 6674  .....  It is oft
+0000edd0: 656e 2073 6565 6e20 696e 2042 6179 6573  en seen in Bayes
+0000ede0: 6961 6e20 696e 6665 7265 6e63 6520 616e  ian inference an
+0000edf0: 6420 6f72 6465 7220 7374 6174 6973 7469  d order statisti
+0000ee00: 6373 2e0d 0a0d 0a20 2050 6172 616d 6574  cs.....  Paramet
+0000ee10: 6572 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d  ers..  ---------
+0000ee20: 2d0d 0a20 2061 203a 2066 6c6f 6174 206f  -..  a : float o
+0000ee30: 7220 6172 7261 795f 6c69 6b65 206f 6620  r array_like of 
+0000ee40: 666c 6f61 7473 0d0a 2020 2020 2020 416c  floats..      Al
+0000ee50: 7068 612c 2070 6f73 6974 6976 6520 283e  pha, positive (>
+0000ee60: 3029 2e0d 0a20 2062 203a 2066 6c6f 6174  0)...  b : float
+0000ee70: 206f 7220 6172 7261 795f 6c69 6b65 206f   or array_like o
+0000ee80: 6620 666c 6f61 7473 0d0a 2020 2020 2020  f floats..      
+0000ee90: 4265 7461 2c20 706f 7369 7469 7665 2028  Beta, positive (
+0000eea0: 3e30 292e 0d0a 2020 7369 7a65 203a 2069  >0)...  size : i
+0000eeb0: 6e74 206f 7220 7475 706c 6520 6f66 2069  nt or tuple of i
+0000eec0: 6e74 732c 206f 7074 696f 6e61 6c0d 0a20  nts, optional.. 
+0000eed0: 2020 2020 204f 7574 7075 7420 7368 6170       Output shap
+0000eee0: 652e 2020 4966 2074 6865 2067 6976 656e  e.  If the given
+0000eef0: 2073 6861 7065 2069 732c 2065 2e67 2e2c   shape is, e.g.,
+0000ef00: 2060 6028 6d2c 206e 2c20 6b29 6060 2c20   ``(m, n, k)``, 
+0000ef10: 7468 656e 0d0a 2020 2020 2020 6060 6d20  then..      ``m 
+0000ef20: 2a20 6e20 2a20 6b60 6020 7361 6d70 6c65  * n * k`` sample
+0000ef30: 7320 6172 6520 6472 6177 6e2e 2020 4966  s are drawn.  If
+0000ef40: 2073 697a 6520 6973 2060 604e 6f6e 6560   size is ``None`
+0000ef50: 6020 2864 6566 6175 6c74 292c 0d0a 2020  ` (default),..  
+0000ef60: 2020 2020 6120 7369 6e67 6c65 2076 616c      a single val
+0000ef70: 7565 2069 7320 7265 7475 726e 6564 2069  ue is returned i
+0000ef80: 6620 6060 6160 6020 616e 6420 6060 6260  f ``a`` and ``b`
+0000ef90: 6020 6172 6520 626f 7468 2073 6361 6c61  ` are both scala
+0000efa0: 7273 2e0d 0a20 2020 2020 204f 7468 6572  rs...      Other
+0000efb0: 7769 7365 2c20 6060 6e70 2e62 726f 6164  wise, ``np.broad
+0000efc0: 6361 7374 2861 2c20 6229 2e73 697a 6560  cast(a, b).size`
+0000efd0: 6020 7361 6d70 6c65 7320 6172 6520 6472  ` samples are dr
+0000efe0: 6177 6e2e 0d0a 2020 6b65 7920 3a20 5052  awn...  key : PR
+0000eff0: 4e47 4b65 792c 206f 7074 696f 6e61 6c0d  NGKey, optional.
+0000f000: 0a20 2020 2020 2054 6865 206b 6579 2066  .      The key f
+0000f010: 6f72 2074 6865 2072 616e 646f 6d20 6e75  or the random nu
+0000f020: 6d62 6572 2067 656e 6572 6174 6f72 2e20  mber generator. 
+0000f030: 4966 206e 6f74 2067 6976 656e 2c20 7468  If not given, th
+0000f040: 650d 0a20 2020 2020 2064 6566 6175 6c74  e..      default
+0000f050: 2072 616e 646f 6d20 6e75 6d62 6572 2067   random number g
+0000f060: 656e 6572 6174 6f72 2069 7320 7573 6564  enerator is used
+0000f070: 2e0d 0a0d 0a20 2052 6574 7572 6e73 0d0a  .....  Returns..
+0000f080: 2020 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574    -------..  out
+0000f090: 203a 206e 6461 7272 6179 206f 7220 7363   : ndarray or sc
+0000f0a0: 616c 6172 0d0a 2020 2020 2020 4472 6177  alar..      Draw
+0000f0b0: 6e20 7361 6d70 6c65 7320 6672 6f6d 2074  n samples from t
+0000f0c0: 6865 2070 6172 616d 6574 6572 697a 6564  he parameterized
+0000f0d0: 2062 6574 6120 6469 7374 7269 6275 7469   beta distributi
+0000f0e0: 6f6e 2e0d 0a20 2022 2222 0d0a 2020 7265  on...  """..  re
+0000f0f0: 7475 726e 2044 4546 4155 4c54 2e62 6574  turn DEFAULT.bet
+0000f100: 6128 612c 2062 2c20 7369 7a65 3d73 697a  a(a, b, size=siz
+0000f110: 652c 206b 6579 3d6b 6579 2c20 6474 7970  e, key=key, dtyp
+0000f120: 653d 6474 7970 6529 0d0a 0d0a 0d0a 6465  e=dtype)......de
+0000f130: 6620 6578 706f 6e65 6e74 6961 6c28 7363  f exponential(sc
+0000f140: 616c 653d 4e6f 6e65 2c20 7369 7a65 3a20  ale=None, size: 
+0000f150: 4f70 7469 6f6e 616c 5b53 697a 655d 203d  Optional[Size] =
+0000f160: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
+0000f170: 2020 2020 2020 2020 6b65 793a 204f 7074          key: Opt
+0000f180: 696f 6e61 6c5b 5365 6564 4f72 4b65 795d  ional[SeedOrKey]
+0000f190: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
+0000f1a0: 2020 2020 2020 2020 2020 6474 7970 653a            dtype:
+0000f1b0: 2044 5479 7065 4c69 6b65 203d 204e 6f6e   DTypeLike = Non
+0000f1c0: 6529 3a0d 0a20 2072 2222 220d 0a20 2044  e):..  r"""..  D
+0000f1d0: 7261 7720 7361 6d70 6c65 7320 6672 6f6d  raw samples from
+0000f1e0: 2061 6e20 6578 706f 6e65 6e74 6961 6c20   an exponential 
+0000f1f0: 6469 7374 7269 6275 7469 6f6e 2e0d 0a0d  distribution....
+0000f200: 0a20 2049 7473 2070 726f 6261 6269 6c69  .  Its probabili
+0000f210: 7479 2064 656e 7369 7479 2066 756e 6374  ty density funct
+0000f220: 696f 6e20 6973 0d0a 0d0a 2020 2e2e 206d  ion is....  .. m
+0000f230: 6174 683a 3a20 6628 783b 205c 6672 6163  ath:: f(x; \frac
+0000f240: 7b31 7d7b 5c62 6574 617d 2920 3d20 5c66  {1}{\beta}) = \f
+0000f250: 7261 637b 317d 7b5c 6265 7461 7d20 5c65  rac{1}{\beta} \e
+0000f260: 7870 282d 5c66 7261 637b 787d 7b5c 6265  xp(-\frac{x}{\be
+0000f270: 7461 7d29 2c0d 0a0d 0a20 2066 6f72 2060  ta}),....  for `
+0000f280: 6078 203e 2030 6060 2061 6e64 2030 2065  `x > 0`` and 0 e
+0000f290: 6c73 6577 6865 7265 2e20 3a6d 6174 683a  lsewhere. :math:
+0000f2a0: 605c 6265 7461 6020 6973 2074 6865 2073  `\beta` is the s
+0000f2b0: 6361 6c65 2070 6172 616d 6574 6572 2c0d  cale parameter,.
+0000f2c0: 0a20 2077 6869 6368 2069 7320 7468 6520  .  which is the 
+0000f2d0: 696e 7665 7273 6520 6f66 2074 6865 2072  inverse of the r
+0000f2e0: 6174 6520 7061 7261 6d65 7465 7220 3a6d  ate parameter :m
+0000f2f0: 6174 683a 605c 6c61 6d62 6461 203d 2031  ath:`\lambda = 1
+0000f300: 2f5c 6265 7461 602e 0d0a 2020 5468 6520  /\beta`...  The 
+0000f310: 7261 7465 2070 6172 616d 6574 6572 2069  rate parameter i
+0000f320: 7320 616e 2061 6c74 6572 6e61 7469 7665  s an alternative
+0000f330: 2c20 7769 6465 6c79 2075 7365 6420 7061  , widely used pa
+0000f340: 7261 6d65 7465 7269 7a61 7469 6f6e 0d0a  rameterization..
+0000f350: 2020 6f66 2074 6865 2065 7870 6f6e 656e    of the exponen
+0000f360: 7469 616c 2064 6973 7472 6962 7574 696f  tial distributio
+0000f370: 6e20 5b33 5d5f 2e0d 0a0d 0a20 2054 6865  n [3]_.....  The
+0000f380: 2065 7870 6f6e 656e 7469 616c 2064 6973   exponential dis
+0000f390: 7472 6962 7574 696f 6e20 6973 2061 2063  tribution is a c
+0000f3a0: 6f6e 7469 6e75 6f75 7320 616e 616c 6f67  ontinuous analog
+0000f3b0: 7565 206f 6620 7468 650d 0a20 2067 656f  ue of the..  geo
+0000f3c0: 6d65 7472 6963 2064 6973 7472 6962 7574  metric distribut
+0000f3d0: 696f 6e2e 2020 4974 2064 6573 6372 6962  ion.  It describ
+0000f3e0: 6573 206d 616e 7920 636f 6d6d 6f6e 2073  es many common s
+0000f3f0: 6974 7561 7469 6f6e 732c 2073 7563 6820  ituations, such 
+0000f400: 6173 0d0a 2020 7468 6520 7369 7a65 206f  as..  the size o
+0000f410: 6620 7261 696e 6472 6f70 7320 6d65 6173  f raindrops meas
+0000f420: 7572 6564 206f 7665 7220 6d61 6e79 2072  ured over many r
+0000f430: 6169 6e73 746f 726d 7320 5b31 5d5f 2c20  ainstorms [1]_, 
+0000f440: 6f72 2074 6865 2074 696d 650d 0a20 2062  or the time..  b
+0000f450: 6574 7765 656e 2070 6167 6520 7265 7175  etween page requ
+0000f460: 6573 7473 2074 6f20 5769 6b69 7065 6469  ests to Wikipedi
+0000f470: 6120 5b32 5d5f 2e0d 0a0d 0a20 2050 6172  a [2]_.....  Par
+0000f480: 616d 6574 6572 730d 0a20 202d 2d2d 2d2d  ameters..  -----
+0000f490: 2d2d 2d2d 2d0d 0a20 2073 6361 6c65 203a  -----..  scale :
+0000f4a0: 2066 6c6f 6174 206f 7220 6172 7261 795f   float or array_
+0000f4b0: 6c69 6b65 206f 6620 666c 6f61 7473 0d0a  like of floats..
+0000f4c0: 2020 2020 2020 5468 6520 7363 616c 6520        The scale 
+0000f4d0: 7061 7261 6d65 7465 722c 203a 6d61 7468  parameter, :math
+0000f4e0: 3a60 5c62 6574 6120 3d20 312f 5c6c 616d  :`\beta = 1/\lam
+0000f4f0: 6264 6160 2e20 4d75 7374 2062 650d 0a20  bda`. Must be.. 
+0000f500: 2020 2020 206e 6f6e 2d6e 6567 6174 6976       non-negativ
+0000f510: 652e 0d0a 2020 7369 7a65 203a 2069 6e74  e...  size : int
+0000f520: 206f 7220 7475 706c 6520 6f66 2069 6e74   or tuple of int
+0000f530: 732c 206f 7074 696f 6e61 6c0d 0a20 2020  s, optional..   
+0000f540: 2020 204f 7574 7075 7420 7368 6170 652e     Output shape.
+0000f550: 2020 4966 2074 6865 2067 6976 656e 2073    If the given s
+0000f560: 6861 7065 2069 732c 2065 2e67 2e2c 2060  hape is, e.g., `
+0000f570: 6028 6d2c 206e 2c20 6b29 6060 2c20 7468  `(m, n, k)``, th
+0000f580: 656e 0d0a 2020 2020 2020 6060 6d20 2a20  en..      ``m * 
+0000f590: 6e20 2a20 6b60 6020 7361 6d70 6c65 7320  n * k`` samples 
+0000f5a0: 6172 6520 6472 6177 6e2e 2020 4966 2073  are drawn.  If s
+0000f5b0: 697a 6520 6973 2060 604e 6f6e 6560 6020  ize is ``None`` 
+0000f5c0: 2864 6566 6175 6c74 292c 0d0a 2020 2020  (default),..    
+0000f5d0: 2020 6120 7369 6e67 6c65 2076 616c 7565    a single value
+0000f5e0: 2069 7320 7265 7475 726e 6564 2069 6620   is returned if 
+0000f5f0: 6060 7363 616c 6560 6020 6973 2061 2073  ``scale`` is a s
+0000f600: 6361 6c61 722e 2020 4f74 6865 7277 6973  calar.  Otherwis
+0000f610: 652c 0d0a 2020 2020 2020 6060 6e70 2e61  e,..      ``np.a
+0000f620: 7272 6179 2873 6361 6c65 292e 7369 7a65  rray(scale).size
+0000f630: 6060 2073 616d 706c 6573 2061 7265 2064  `` samples are d
+0000f640: 7261 776e 2e0d 0a20 206b 6579 203a 2050  rawn...  key : P
+0000f650: 524e 474b 6579 2c20 6f70 7469 6f6e 616c  RNGKey, optional
+0000f660: 0d0a 2020 2020 2020 5468 6520 6b65 7920  ..      The key 
+0000f670: 666f 7220 7468 6520 7261 6e64 6f6d 206e  for the random n
+0000f680: 756d 6265 7220 6765 6e65 7261 746f 722e  umber generator.
+0000f690: 2049 6620 6e6f 7420 6769 7665 6e2c 2074   If not given, t
+0000f6a0: 6865 0d0a 2020 2020 2020 6465 6661 756c  he..      defaul
+0000f6b0: 7420 7261 6e64 6f6d 206e 756d 6265 7220  t random number 
+0000f6c0: 6765 6e65 7261 746f 7220 6973 2075 7365  generator is use
+0000f6d0: 642e 0d0a 0d0a 2020 5265 7475 726e 730d  d.....  Returns.
+0000f6e0: 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020 6f75  .  -------..  ou
+0000f6f0: 7420 3a20 6e64 6172 7261 7920 6f72 2073  t : ndarray or s
+0000f700: 6361 6c61 720d 0a20 2020 2020 2044 7261  calar..      Dra
+0000f710: 776e 2073 616d 706c 6573 2066 726f 6d20  wn samples from 
+0000f720: 7468 6520 7061 7261 6d65 7465 7269 7a65  the parameterize
+0000f730: 6420 6578 706f 6e65 6e74 6961 6c20 6469  d exponential di
+0000f740: 7374 7269 6275 7469 6f6e 2e0d 0a0d 0a20  stribution..... 
+0000f750: 2052 6566 6572 656e 6365 730d 0a20 202d   References..  -
+0000f760: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 202e 2e20  ---------..  .. 
+0000f770: 5b31 5d20 5065 7974 6f6e 205a 2e20 5065  [1] Peyton Z. Pe
+0000f780: 6562 6c65 7320 4a72 2e2c 2022 5072 6f62  ebles Jr., "Prob
+0000f790: 6162 696c 6974 792c 2052 616e 646f 6d20  ability, Random 
+0000f7a0: 5661 7269 6162 6c65 7320 616e 640d 0a20  Variables and.. 
+0000f7b0: 2020 2020 2020 2020 5261 6e64 6f6d 2053          Random S
+0000f7c0: 6967 6e61 6c20 5072 696e 6369 706c 6573  ignal Principles
+0000f7d0: 222c 2034 7468 2065 642c 2032 3030 312c  ", 4th ed, 2001,
+0000f7e0: 2070 2e20 3537 2e0d 0a20 202e 2e20 5b32   p. 57...  .. [2
+0000f7f0: 5d20 5769 6b69 7065 6469 612c 2022 506f  ] Wikipedia, "Po
+0000f800: 6973 736f 6e20 7072 6f63 6573 7322 2c0d  isson process",.
+0000f810: 0a20 2020 2020 2020 2020 6874 7470 733a  .         https:
+0000f820: 2f2f 656e 2e77 696b 6970 6564 6961 2e6f  //en.wikipedia.o
+0000f830: 7267 2f77 696b 692f 506f 6973 736f 6e5f  rg/wiki/Poisson_
+0000f840: 7072 6f63 6573 730d 0a20 202e 2e20 5b33  process..  .. [3
+0000f850: 5d20 5769 6b69 7065 6469 612c 2022 4578  ] Wikipedia, "Ex
+0000f860: 706f 6e65 6e74 6961 6c20 6469 7374 7269  ponential distri
+0000f870: 6275 7469 6f6e 222c 0d0a 2020 2020 2020  bution",..      
+0000f880: 2020 2068 7474 7073 3a2f 2f65 6e2e 7769     https://en.wi
+0000f890: 6b69 7065 6469 612e 6f72 672f 7769 6b69  kipedia.org/wiki
+0000f8a0: 2f45 7870 6f6e 656e 7469 616c 5f64 6973  /Exponential_dis
+0000f8b0: 7472 6962 7574 696f 6e0d 0a20 2022 2222  tribution..  """
+0000f8c0: 0d0a 2020 7265 7475 726e 2044 4546 4155  ..  return DEFAU
+0000f8d0: 4c54 2e65 7870 6f6e 656e 7469 616c 2873  LT.exponential(s
+0000f8e0: 6361 6c65 2c20 7369 7a65 2c20 6b65 793d  cale, size, key=
+0000f8f0: 6b65 792c 2064 7479 7065 3d64 7479 7065  key, dtype=dtype
+0000f900: 290d 0a0d 0a0d 0a64 6566 2067 616d 6d61  )......def gamma
+0000f910: 2873 6861 7065 2c20 7363 616c 653d 4e6f  (shape, scale=No
+0000f920: 6e65 2c20 7369 7a65 3a20 4f70 7469 6f6e  ne, size: Option
+0000f930: 616c 5b53 697a 655d 203d 204e 6f6e 652c  al[Size] = None,
+0000f940: 0d0a 2020 2020 2020 2020 2020 6b65 793a  ..          key:
+0000f950: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
+0000f960: 4b65 795d 203d 204e 6f6e 652c 0d0a 2020  Key] = None,..  
+0000f970: 2020 2020 2020 2020 6474 7970 653a 2044          dtype: D
+0000f980: 5479 7065 4c69 6b65 203d 204e 6f6e 6529  TypeLike = None)
+0000f990: 3a0d 0a20 2072 2222 220d 0a20 2044 7261  :..  r"""..  Dra
+0000f9a0: 7720 7361 6d70 6c65 7320 6672 6f6d 2061  w samples from a
+0000f9b0: 2047 616d 6d61 2064 6973 7472 6962 7574   Gamma distribut
+0000f9c0: 696f 6e2e 0d0a 0d0a 2020 5361 6d70 6c65  ion.....  Sample
+0000f9d0: 7320 6172 6520 6472 6177 6e20 6672 6f6d  s are drawn from
+0000f9e0: 2061 2047 616d 6d61 2064 6973 7472 6962   a Gamma distrib
+0000f9f0: 7574 696f 6e20 7769 7468 2073 7065 6369  ution with speci
+0000fa00: 6669 6564 2070 6172 616d 6574 6572 732c  fied parameters,
+0000fa10: 0d0a 2020 6073 6861 7065 6020 2873 6f6d  ..  `shape` (som
+0000fa20: 6574 696d 6573 2064 6573 6967 6e61 7465  etimes designate
+0000fa30: 6420 226b 2229 2061 6e64 2060 7363 616c  d "k") and `scal
+0000fa40: 6560 2028 736f 6d65 7469 6d65 7320 6465  e` (sometimes de
+0000fa50: 7369 676e 6174 6564 0d0a 2020 2274 6865  signated..  "the
+0000fa60: 7461 2229 2c20 7768 6572 6520 626f 7468  ta"), where both
+0000fa70: 2070 6172 616d 6574 6572 7320 6172 6520   parameters are 
+0000fa80: 3e20 302e 0d0a 0d0a 2020 5061 7261 6d65  > 0.....  Parame
+0000fa90: 7465 7273 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ters..  --------
+0000faa0: 2d2d 0d0a 2020 7368 6170 6520 3a20 666c  --..  shape : fl
+0000fab0: 6f61 7420 6f72 2061 7272 6179 5f6c 696b  oat or array_lik
+0000fac0: 6520 6f66 2066 6c6f 6174 730d 0a20 2020  e of floats..   
+0000fad0: 2020 2054 6865 2073 6861 7065 206f 6620     The shape of 
+0000fae0: 7468 6520 6761 6d6d 6120 6469 7374 7269  the gamma distri
+0000faf0: 6275 7469 6f6e 2e20 4d75 7374 2062 6520  bution. Must be 
+0000fb00: 6e6f 6e2d 6e65 6761 7469 7665 2e0d 0a20  non-negative... 
+0000fb10: 2073 6361 6c65 203a 2066 6c6f 6174 206f   scale : float o
+0000fb20: 7220 6172 7261 795f 6c69 6b65 206f 6620  r array_like of 
+0000fb30: 666c 6f61 7473 2c20 6f70 7469 6f6e 616c  floats, optional
+0000fb40: 0d0a 2020 2020 2020 5468 6520 7363 616c  ..      The scal
+0000fb50: 6520 6f66 2074 6865 2067 616d 6d61 2064  e of the gamma d
+0000fb60: 6973 7472 6962 7574 696f 6e2e 204d 7573  istribution. Mus
+0000fb70: 7420 6265 206e 6f6e 2d6e 6567 6174 6976  t be non-negativ
+0000fb80: 652e 0d0a 2020 2020 2020 4465 6661 756c  e...      Defaul
+0000fb90: 7420 6973 2065 7175 616c 2074 6f20 312e  t is equal to 1.
+0000fba0: 0d0a 2020 7369 7a65 203a 2069 6e74 206f  ..  size : int o
+0000fbb0: 7220 7475 706c 6520 6f66 2069 6e74 732c  r tuple of ints,
+0000fbc0: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
+0000fbd0: 204f 7574 7075 7420 7368 6170 652e 2020   Output shape.  
+0000fbe0: 4966 2074 6865 2067 6976 656e 2073 6861  If the given sha
+0000fbf0: 7065 2069 732c 2065 2e67 2e2c 2060 6028  pe is, e.g., ``(
+0000fc00: 6d2c 206e 2c20 6b29 6060 2c20 7468 656e  m, n, k)``, then
+0000fc10: 0d0a 2020 2020 2020 6060 6d20 2a20 6e20  ..      ``m * n 
+0000fc20: 2a20 6b60 6020 7361 6d70 6c65 7320 6172  * k`` samples ar
+0000fc30: 6520 6472 6177 6e2e 2020 4966 2073 697a  e drawn.  If siz
+0000fc40: 6520 6973 2060 604e 6f6e 6560 6020 2864  e is ``None`` (d
+0000fc50: 6566 6175 6c74 292c 0d0a 2020 2020 2020  efault),..      
+0000fc60: 6120 7369 6e67 6c65 2076 616c 7565 2069  a single value i
+0000fc70: 7320 7265 7475 726e 6564 2069 6620 6060  s returned if ``
+0000fc80: 7368 6170 6560 6020 616e 6420 6060 7363  shape`` and ``sc
+0000fc90: 616c 6560 6020 6172 6520 626f 7468 2073  ale`` are both s
+0000fca0: 6361 6c61 7273 2e0d 0a20 2020 2020 204f  calars...      O
+0000fcb0: 7468 6572 7769 7365 2c20 6060 6e70 2e62  therwise, ``np.b
+0000fcc0: 726f 6164 6361 7374 2873 6861 7065 2c20  roadcast(shape, 
+0000fcd0: 7363 616c 6529 2e73 697a 6560 6020 7361  scale).size`` sa
+0000fce0: 6d70 6c65 7320 6172 6520 6472 6177 6e2e  mples are drawn.
+0000fcf0: 0d0a 2020 6b65 7920 3a20 5052 4e47 4b65  ..  key : PRNGKe
+0000fd00: 792c 206f 7074 696f 6e61 6c0d 0a20 2020  y, optional..   
+0000fd10: 2020 2054 6865 206b 6579 2066 6f72 2074     The key for t
+0000fd20: 6865 2072 616e 646f 6d20 6e75 6d62 6572  he random number
+0000fd30: 2067 656e 6572 6174 6f72 2e20 4966 206e   generator. If n
+0000fd40: 6f74 2067 6976 656e 2c20 7468 650d 0a20  ot given, the.. 
+0000fd50: 2020 2020 2064 6566 6175 6c74 2072 616e       default ran
+0000fd60: 646f 6d20 6e75 6d62 6572 2067 656e 6572  dom number gener
+0000fd70: 6174 6f72 2069 7320 7573 6564 2e0d 0a0d  ator is used....
+0000fd80: 0a20 2052 6574 7572 6e73 0d0a 2020 2d2d  .  Returns..  --
+0000fd90: 2d2d 2d2d 2d0d 0a20 206f 7574 203a 206e  -----..  out : n
+0000fda0: 6461 7272 6179 206f 7220 7363 616c 6172  darray or scalar
+0000fdb0: 0d0a 2020 2020 2020 4472 6177 6e20 7361  ..      Drawn sa
+0000fdc0: 6d70 6c65 7320 6672 6f6d 2074 6865 2070  mples from the p
+0000fdd0: 6172 616d 6574 6572 697a 6564 2067 616d  arameterized gam
+0000fde0: 6d61 2064 6973 7472 6962 7574 696f 6e2e  ma distribution.
+0000fdf0: 0d0a 0d0a 0d0a 2020 4e6f 7465 730d 0a20  ......  Notes.. 
+0000fe00: 202d 2d2d 2d2d 0d0a 2020 5468 6520 7072   -----..  The pr
+0000fe10: 6f62 6162 696c 6974 7920 6465 6e73 6974  obability densit
+0000fe20: 7920 666f 7220 7468 6520 4761 6d6d 6120  y for the Gamma 
+0000fe30: 6469 7374 7269 6275 7469 6f6e 2069 730d  distribution is.
+0000fe40: 0a0d 0a20 202e 2e20 6d61 7468 3a3a 2070  ...  .. math:: p
+0000fe50: 2878 2920 3d20 785e 7b6b 2d31 7d5c 6672  (x) = x^{k-1}\fr
+0000fe60: 6163 7b65 5e7b 2d78 2f5c 7468 6574 617d  ac{e^{-x/\theta}
+0000fe70: 7d7b 5c74 6865 7461 5e6b 5c47 616d 6d61  }{\theta^k\Gamma
+0000fe80: 286b 297d 2c0d 0a0d 0a20 2077 6865 7265  (k)},....  where
+0000fe90: 203a 6d61 7468 3a60 6b60 2069 7320 7468   :math:`k` is th
+0000fea0: 6520 7368 6170 6520 616e 6420 3a6d 6174  e shape and :mat
+0000feb0: 683a 605c 7468 6574 6160 2074 6865 2073  h:`\theta` the s
+0000fec0: 6361 6c65 2c0d 0a20 2061 6e64 203a 6d61  cale,..  and :ma
+0000fed0: 7468 3a60 5c47 616d 6d61 6020 6973 2074  th:`\Gamma` is t
+0000fee0: 6865 2047 616d 6d61 2066 756e 6374 696f  he Gamma functio
+0000fef0: 6e2e 0d0a 0d0a 2020 5468 6520 4761 6d6d  n.....  The Gamm
+0000ff00: 6120 6469 7374 7269 6275 7469 6f6e 2069  a distribution i
+0000ff10: 7320 6f66 7465 6e20 7573 6564 2074 6f20  s often used to 
+0000ff20: 6d6f 6465 6c20 7468 6520 7469 6d65 7320  model the times 
+0000ff30: 746f 2066 6169 6c75 7265 206f 660d 0a20  to failure of.. 
+0000ff40: 2065 6c65 6374 726f 6e69 6320 636f 6d70   electronic comp
+0000ff50: 6f6e 656e 7473 2c20 616e 6420 6172 6973  onents, and aris
+0000ff60: 6573 206e 6174 7572 616c 6c79 2069 6e20  es naturally in 
+0000ff70: 7072 6f63 6573 7365 7320 666f 7220 7768  processes for wh
+0000ff80: 6963 6820 7468 650d 0a20 2077 6169 7469  ich the..  waiti
+0000ff90: 6e67 2074 696d 6573 2062 6574 7765 656e  ng times between
+0000ffa0: 2050 6f69 7373 6f6e 2064 6973 7472 6962   Poisson distrib
+0000ffb0: 7574 6564 2065 7665 6e74 7320 6172 6520  uted events are 
+0000ffc0: 7265 6c65 7661 6e74 2e0d 0a0d 0a20 2052  relevant.....  R
+0000ffd0: 6566 6572 656e 6365 730d 0a20 202d 2d2d  eferences..  ---
+0000ffe0: 2d2d 2d2d 2d2d 2d0d 0a20 202e 2e20 5b31  -------..  .. [1
+0000fff0: 5d20 5765 6973 7374 6569 6e2c 2045 7269  ] Weisstein, Eri
+00010000: 6320 572e 2022 4761 6d6d 6120 4469 7374  c W. "Gamma Dist
+00010010: 7269 6275 7469 6f6e 2e22 2046 726f 6d20  ribution." From 
+00010020: 4d61 7468 576f 726c 642d 2d41 0d0a 2020  MathWorld--A..  
+00010030: 2020 2020 2020 2057 6f6c 6672 616d 2057         Wolfram W
+00010040: 6562 2052 6573 6f75 7263 652e 0d0a 2020  eb Resource...  
+00010050: 2020 2020 2020 2068 7474 703a 2f2f 6d61         http://ma
+00010060: 7468 776f 726c 642e 776f 6c66 7261 6d2e  thworld.wolfram.
+00010070: 636f 6d2f 4761 6d6d 6144 6973 7472 6962  com/GammaDistrib
+00010080: 7574 696f 6e2e 6874 6d6c 0d0a 2020 2e2e  ution.html..  ..
+00010090: 205b 325d 2057 696b 6970 6564 6961 2c20   [2] Wikipedia, 
+000100a0: 2247 616d 6d61 2064 6973 7472 6962 7574  "Gamma distribut
+000100b0: 696f 6e22 2c0d 0a20 2020 2020 2020 2020  ion",..         
+000100c0: 6874 7470 733a 2f2f 656e 2e77 696b 6970  https://en.wikip
+000100d0: 6564 6961 2e6f 7267 2f77 696b 692f 4761  edia.org/wiki/Ga
+000100e0: 6d6d 615f 6469 7374 7269 6275 7469 6f6e  mma_distribution
+000100f0: 0d0a 0d0a 2020 2222 220d 0a20 2072 6574  ....  """..  ret
+00010100: 7572 6e20 4445 4641 554c 542e 6761 6d6d  urn DEFAULT.gamm
+00010110: 6128 7368 6170 652c 2073 6361 6c65 2c20  a(shape, scale, 
+00010120: 7369 7a65 3d73 697a 652c 206b 6579 3d6b  size=size, key=k
+00010130: 6579 2c20 6474 7970 653d 6474 7970 6529  ey, dtype=dtype)
+00010140: 0d0a 0d0a 0d0a 6465 6620 6775 6d62 656c  ......def gumbel
+00010150: 286c 6f63 3d4e 6f6e 652c 2073 6361 6c65  (loc=None, scale
+00010160: 3d4e 6f6e 652c 2073 697a 653a 204f 7074  =None, size: Opt
+00010170: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
+00010180: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
+00010190: 6b65 793a 204f 7074 696f 6e61 6c5b 5365  key: Optional[Se
+000101a0: 6564 4f72 4b65 795d 203d 204e 6f6e 652c  edOrKey] = None,
+000101b0: 0d0a 2020 2020 2020 2020 2020 2064 7479  ..           dty
+000101c0: 7065 3a20 4454 7970 654c 696b 6520 3d20  pe: DTypeLike = 
+000101d0: 4e6f 6e65 293a 0d0a 2020 7222 2222 0d0a  None):..  r"""..
+000101e0: 2020 4472 6177 2073 616d 706c 6573 2066    Draw samples f
+000101f0: 726f 6d20 6120 4775 6d62 656c 2064 6973  rom a Gumbel dis
+00010200: 7472 6962 7574 696f 6e2e 0d0a 0d0a 2020  tribution.....  
+00010210: 4472 6177 2073 616d 706c 6573 2066 726f  Draw samples fro
+00010220: 6d20 6120 4775 6d62 656c 2064 6973 7472  m a Gumbel distr
+00010230: 6962 7574 696f 6e20 7769 7468 2073 7065  ibution with spe
+00010240: 6369 6669 6564 206c 6f63 6174 696f 6e20  cified location 
+00010250: 616e 640d 0a20 2073 6361 6c65 2e20 2046  and..  scale.  F
+00010260: 6f72 206d 6f72 6520 696e 666f 726d 6174  or more informat
+00010270: 696f 6e20 6f6e 2074 6865 2047 756d 6265  ion on the Gumbe
+00010280: 6c20 6469 7374 7269 6275 7469 6f6e 2c20  l distribution, 
+00010290: 7365 650d 0a20 204e 6f74 6573 2061 6e64  see..  Notes and
+000102a0: 2052 6566 6572 656e 6365 7320 6265 6c6f   References belo
+000102b0: 772e 0d0a 0d0a 2020 5061 7261 6d65 7465  w.....  Paramete
+000102c0: 7273 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d  rs..  ----------
+000102d0: 0d0a 2020 6c6f 6320 3a20 666c 6f61 7420  ..  loc : float 
+000102e0: 6f72 2061 7272 6179 5f6c 696b 6520 6f66  or array_like of
+000102f0: 2066 6c6f 6174 732c 206f 7074 696f 6e61   floats, optiona
+00010300: 6c0d 0a20 2020 2020 2054 6865 206c 6f63  l..      The loc
+00010310: 6174 696f 6e20 6f66 2074 6865 206d 6f64  ation of the mod
+00010320: 6520 6f66 2074 6865 2064 6973 7472 6962  e of the distrib
+00010330: 7574 696f 6e2e 2044 6566 6175 6c74 2069  ution. Default i
+00010340: 7320 302e 0d0a 2020 7363 616c 6520 3a20  s 0...  scale : 
+00010350: 666c 6f61 7420 6f72 2061 7272 6179 5f6c  float or array_l
+00010360: 696b 6520 6f66 2066 6c6f 6174 732c 206f  ike of floats, o
+00010370: 7074 696f 6e61 6c0d 0a20 2020 2020 2054  ptional..      T
+00010380: 6865 2073 6361 6c65 2070 6172 616d 6574  he scale paramet
+00010390: 6572 206f 6620 7468 6520 6469 7374 7269  er of the distri
+000103a0: 6275 7469 6f6e 2e20 4465 6661 756c 7420  bution. Default 
+000103b0: 6973 2031 2e20 4d75 7374 2062 6520 6e6f  is 1. Must be no
+000103c0: 6e2d 0d0a 2020 2020 2020 6e65 6761 7469  n-..      negati
+000103d0: 7665 2e0d 0a20 2073 697a 6520 3a20 696e  ve...  size : in
+000103e0: 7420 6f72 2074 7570 6c65 206f 6620 696e  t or tuple of in
+000103f0: 7473 2c20 6f70 7469 6f6e 616c 0d0a 2020  ts, optional..  
+00010400: 2020 2020 4f75 7470 7574 2073 6861 7065      Output shape
+00010410: 2e20 2049 6620 7468 6520 6769 7665 6e20  .  If the given 
+00010420: 7368 6170 6520 6973 2c20 652e 672e 2c20  shape is, e.g., 
+00010430: 6060 286d 2c20 6e2c 206b 2960 602c 2074  ``(m, n, k)``, t
+00010440: 6865 6e0d 0a20 2020 2020 2060 606d 202a  hen..      ``m *
+00010450: 206e 202a 206b 6060 2073 616d 706c 6573   n * k`` samples
+00010460: 2061 7265 2064 7261 776e 2e20 2049 6620   are drawn.  If 
+00010470: 7369 7a65 2069 7320 6060 4e6f 6e65 6060  size is ``None``
+00010480: 2028 6465 6661 756c 7429 2c0d 0a20 2020   (default),..   
+00010490: 2020 2061 2073 696e 676c 6520 7661 6c75     a single valu
+000104a0: 6520 6973 2072 6574 7572 6e65 6420 6966  e is returned if
+000104b0: 2060 606c 6f63 6060 2061 6e64 2060 6073   ``loc`` and ``s
+000104c0: 6361 6c65 6060 2061 7265 2062 6f74 6820  cale`` are both 
+000104d0: 7363 616c 6172 732e 0d0a 2020 2020 2020  scalars...      
+000104e0: 4f74 6865 7277 6973 652c 2060 606e 702e  Otherwise, ``np.
+000104f0: 6272 6f61 6463 6173 7428 6c6f 632c 2073  broadcast(loc, s
+00010500: 6361 6c65 292e 7369 7a65 6060 2073 616d  cale).size`` sam
+00010510: 706c 6573 2061 7265 2064 7261 776e 2e0d  ples are drawn..
+00010520: 0a20 206b 6579 203a 2050 524e 474b 6579  .  key : PRNGKey
+00010530: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+00010540: 2020 5468 6520 6b65 7920 666f 7220 7468    The key for th
+00010550: 6520 7261 6e64 6f6d 206e 756d 6265 7220  e random number 
+00010560: 6765 6e65 7261 746f 722e 2049 6620 6e6f  generator. If no
+00010570: 7420 6769 7665 6e2c 2074 6865 0d0a 2020  t given, the..  
+00010580: 2020 2020 6465 6661 756c 7420 7261 6e64      default rand
+00010590: 6f6d 206e 756d 6265 7220 6765 6e65 7261  om number genera
+000105a0: 746f 7220 6973 2075 7365 642e 0d0a 0d0a  tor is used.....
+000105b0: 2020 5265 7475 726e 730d 0a20 202d 2d2d    Returns..  ---
+000105c0: 2d2d 2d2d 0d0a 2020 6f75 7420 3a20 6e64  ----..  out : nd
+000105d0: 6172 7261 7920 6f72 2073 6361 6c61 720d  array or scalar.
+000105e0: 0a20 2020 2020 2044 7261 776e 2073 616d  .      Drawn sam
+000105f0: 706c 6573 2066 726f 6d20 7468 6520 7061  ples from the pa
+00010600: 7261 6d65 7465 7269 7a65 6420 4775 6d62  rameterized Gumb
+00010610: 656c 2064 6973 7472 6962 7574 696f 6e2e  el distribution.
+00010620: 0d0a 0d0a 2020 4e6f 7465 730d 0a20 202d  ....  Notes..  -
+00010630: 2d2d 2d2d 0d0a 2020 5468 6520 4775 6d62  ----..  The Gumb
+00010640: 656c 2028 6f72 2053 6d61 6c6c 6573 7420  el (or Smallest 
+00010650: 4578 7472 656d 6520 5661 6c75 6520 2853  Extreme Value (S
+00010660: 4556 2920 6f72 2074 6865 2053 6d61 6c6c  EV) or the Small
+00010670: 6573 7420 4578 7472 656d 650d 0a20 2056  est Extreme..  V
+00010680: 616c 7565 2054 7970 6520 4929 2064 6973  alue Type I) dis
+00010690: 7472 6962 7574 696f 6e20 6973 206f 6e65  tribution is one
+000106a0: 206f 6620 6120 636c 6173 7320 6f66 2047   of a class of G
+000106b0: 656e 6572 616c 697a 6564 2045 7874 7265  eneralized Extre
+000106c0: 6d65 0d0a 2020 5661 6c75 6520 2847 4556  me..  Value (GEV
+000106d0: 2920 6469 7374 7269 6275 7469 6f6e 7320  ) distributions 
+000106e0: 7573 6564 2069 6e20 6d6f 6465 6c69 6e67  used in modeling
+000106f0: 2065 7874 7265 6d65 2076 616c 7565 2070   extreme value p
+00010700: 726f 626c 656d 732e 0d0a 2020 5468 6520  roblems...  The 
+00010710: 4775 6d62 656c 2069 7320 6120 7370 6563  Gumbel is a spec
+00010720: 6961 6c20 6361 7365 206f 6620 7468 6520  ial case of the 
+00010730: 4578 7472 656d 6520 5661 6c75 6520 5479  Extreme Value Ty
+00010740: 7065 2049 2064 6973 7472 6962 7574 696f  pe I distributio
+00010750: 6e0d 0a20 2066 6f72 206d 6178 696d 756d  n..  for maximum
+00010760: 7320 6672 6f6d 2064 6973 7472 6962 7574  s from distribut
+00010770: 696f 6e73 2077 6974 6820 2265 7870 6f6e  ions with "expon
+00010780: 656e 7469 616c 2d6c 696b 6522 2074 6169  ential-like" tai
+00010790: 6c73 2e0d 0a0d 0a20 2054 6865 2070 726f  ls.....  The pro
+000107a0: 6261 6269 6c69 7479 2064 656e 7369 7479  bability density
+000107b0: 2066 6f72 2074 6865 2047 756d 6265 6c20   for the Gumbel 
+000107c0: 6469 7374 7269 6275 7469 6f6e 2069 730d  distribution is.
+000107d0: 0a0d 0a20 202e 2e20 6d61 7468 3a3a 2070  ...  .. math:: p
+000107e0: 2878 2920 3d20 5c66 7261 637b 655e 7b2d  (x) = \frac{e^{-
+000107f0: 2878 202d 205c 6d75 292f 205c 6265 7461  (x - \mu)/ \beta
+00010800: 7d7d 7b5c 6265 7461 7d20 655e 7b20 2d65  }}{\beta} e^{ -e
+00010810: 5e7b 2d28 7820 2d20 5c6d 7529 2f0d 0a20  ^{-(x - \mu)/.. 
+00010820: 2020 2020 2020 2020 2020 205c 6265 7461             \beta
+00010830: 7d7d 2c0d 0a0d 0a20 2077 6865 7265 203a  }},....  where :
+00010840: 6d61 7468 3a60 5c6d 7560 2069 7320 7468  math:`\mu` is th
+00010850: 6520 6d6f 6465 2c20 6120 6c6f 6361 7469  e mode, a locati
+00010860: 6f6e 2070 6172 616d 6574 6572 2c20 616e  on parameter, an
+00010870: 640d 0a20 203a 6d61 7468 3a60 5c62 6574  d..  :math:`\bet
+00010880: 6160 2069 7320 7468 6520 7363 616c 6520  a` is the scale 
+00010890: 7061 7261 6d65 7465 722e 0d0a 0d0a 2020  parameter.....  
+000108a0: 5468 6520 4775 6d62 656c 2028 6e61 6d65  The Gumbel (name
+000108b0: 6420 666f 7220 4765 726d 616e 206d 6174  d for German mat
+000108c0: 6865 6d61 7469 6369 616e 2045 6d69 6c20  hematician Emil 
+000108d0: 4a75 6c69 7573 2047 756d 6265 6c29 2077  Julius Gumbel) w
+000108e0: 6173 2075 7365 640d 0a20 2076 6572 7920  as used..  very 
+000108f0: 6561 726c 7920 696e 2074 6865 2068 7964  early in the hyd
+00010900: 726f 6c6f 6779 206c 6974 6572 6174 7572  rology literatur
+00010910: 652c 2066 6f72 206d 6f64 656c 696e 6720  e, for modeling 
+00010920: 7468 6520 6f63 6375 7272 656e 6365 206f  the occurrence o
+00010930: 660d 0a20 2066 6c6f 6f64 2065 7665 6e74  f..  flood event
+00010940: 732e 2049 7420 6973 2061 6c73 6f20 7573  s. It is also us
+00010950: 6564 2066 6f72 206d 6f64 656c 696e 6720  ed for modeling 
+00010960: 6d61 7869 6d75 6d20 7769 6e64 2073 7065  maximum wind spe
+00010970: 6564 2061 6e64 0d0a 2020 7261 696e 6661  ed and..  rainfa
+00010980: 6c6c 2072 6174 6573 2e20 2049 7420 6973  ll rates.  It is
+00010990: 2061 2022 6661 742d 7461 696c 6564 2220   a "fat-tailed" 
+000109a0: 6469 7374 7269 6275 7469 6f6e 202d 2074  distribution - t
+000109b0: 6865 2070 726f 6261 6269 6c69 7479 206f  he probability o
+000109c0: 660d 0a20 2061 6e20 6576 656e 7420 696e  f..  an event in
+000109d0: 2074 6865 2074 6169 6c20 6f66 2074 6865   the tail of the
+000109e0: 2064 6973 7472 6962 7574 696f 6e20 6973   distribution is
+000109f0: 206c 6172 6765 7220 7468 616e 2069 6620   larger than if 
+00010a00: 6f6e 6520 7573 6564 2061 0d0a 2020 4761  one used a..  Ga
+00010a10: 7573 7369 616e 2c20 6865 6e63 6520 7468  ussian, hence th
+00010a20: 6520 7375 7270 7269 7369 6e67 6c79 2066  e surprisingly f
+00010a30: 7265 7175 656e 7420 6f63 6375 7272 656e  requent occurren
+00010a40: 6365 206f 6620 3130 302d 7965 6172 0d0a  ce of 100-year..
+00010a50: 2020 666c 6f6f 6473 2e20 466c 6f6f 6473    floods. Floods
+00010a60: 2077 6572 6520 696e 6974 6961 6c6c 7920   were initially 
+00010a70: 6d6f 6465 6c65 6420 6173 2061 2047 6175  modeled as a Gau
+00010a80: 7373 6961 6e20 7072 6f63 6573 732c 2077  ssian process, w
+00010a90: 6869 6368 0d0a 2020 756e 6465 7265 7374  hich..  underest
+00010aa0: 696d 6174 6564 2074 6865 2066 7265 7175  imated the frequ
+00010ab0: 656e 6379 206f 6620 6578 7472 656d 6520  ency of extreme 
+00010ac0: 6576 656e 7473 2e0d 0a0d 0a20 2049 7420  events.....  It 
+00010ad0: 6973 206f 6e65 206f 6620 6120 636c 6173  is one of a clas
+00010ae0: 7320 6f66 2065 7874 7265 6d65 2076 616c  s of extreme val
+00010af0: 7565 2064 6973 7472 6962 7574 696f 6e73  ue distributions
+00010b00: 2c20 7468 6520 4765 6e65 7261 6c69 7a65  , the Generalize
+00010b10: 640d 0a20 2045 7874 7265 6d65 2056 616c  d..  Extreme Val
+00010b20: 7565 2028 4745 5629 2064 6973 7472 6962  ue (GEV) distrib
+00010b30: 7574 696f 6e73 2c20 7768 6963 6820 616c  utions, which al
+00010b40: 736f 2069 6e63 6c75 6465 7320 7468 6520  so includes the 
+00010b50: 5765 6962 756c 6c20 616e 640d 0a20 2046  Weibull and..  F
+00010b60: 7265 6368 6574 2e0d 0a0d 0a20 2054 6865  rechet.....  The
+00010b70: 2066 756e 6374 696f 6e20 6861 7320 6120   function has a 
+00010b80: 6d65 616e 206f 6620 3a6d 6174 683a 605c  mean of :math:`\
+00010b90: 6d75 202b 2030 2e35 3737 3231 5c62 6574  mu + 0.57721\bet
+00010ba0: 6160 2061 6e64 2061 2076 6172 6961 6e63  a` and a varianc
+00010bb0: 650d 0a20 206f 6620 3a6d 6174 683a 605c  e..  of :math:`\
+00010bc0: 6672 6163 7b5c 7069 5e32 7d7b 367d 5c62  frac{\pi^2}{6}\b
+00010bd0: 6574 615e 3260 2e0d 0a0d 0a20 2052 6566  eta^2`.....  Ref
+00010be0: 6572 656e 6365 730d 0a20 202d 2d2d 2d2d  erences..  -----
+00010bf0: 2d2d 2d2d 2d0d 0a20 202e 2e20 5b31 5d20  -----..  .. [1] 
+00010c00: 4775 6d62 656c 2c20 452e 204a 2e2c 2022  Gumbel, E. J., "
+00010c10: 5374 6174 6973 7469 6373 206f 6620 4578  Statistics of Ex
+00010c20: 7472 656d 6573 2c22 0d0a 2020 2020 2020  tremes,"..      
+00010c30: 2020 204e 6577 2059 6f72 6b3a 2043 6f6c     New York: Col
+00010c40: 756d 6269 6120 556e 6976 6572 7369 7479  umbia University
+00010c50: 2050 7265 7373 2c20 3139 3538 2e0d 0a20   Press, 1958... 
+00010c60: 202e 2e20 5b32 5d20 5265 6973 732c 2052   .. [2] Reiss, R
+00010c70: 2e2d 442e 2061 6e64 2054 686f 6d61 732c  .-D. and Thomas,
+00010c80: 204d 2e2c 2022 5374 6174 6973 7469 6361   M., "Statistica
+00010c90: 6c20 416e 616c 7973 6973 206f 6620 4578  l Analysis of Ex
+00010ca0: 7472 656d 650d 0a20 2020 2020 2020 2020  treme..         
+00010cb0: 5661 6c75 6573 2066 726f 6d20 496e 7375  Values from Insu
+00010cc0: 7261 6e63 652c 2046 696e 616e 6365 2c20  rance, Finance, 
+00010cd0: 4879 6472 6f6c 6f67 7920 616e 6420 4f74  Hydrology and Ot
+00010ce0: 6865 7220 4669 656c 6473 2c22 0d0a 2020  her Fields,"..  
+00010cf0: 2020 2020 2020 2042 6173 656c 3a20 4269         Basel: Bi
+00010d00: 726b 6861 7573 6572 2056 6572 6c61 672c  rkhauser Verlag,
+00010d10: 2032 3030 312e 0d0a 2020 2222 220d 0a20   2001...  """.. 
+00010d20: 2072 6574 7572 6e20 4445 4641 554c 542e   return DEFAULT.
+00010d30: 6775 6d62 656c 286c 6f63 2c20 7363 616c  gumbel(loc, scal
+00010d40: 652c 2073 697a 653d 7369 7a65 2c20 6b65  e, size=size, ke
+00010d50: 793d 6b65 792c 2064 7479 7065 3d64 7479  y=key, dtype=dty
+00010d60: 7065 290d 0a0d 0a0d 0a64 6566 206c 6170  pe)......def lap
+00010d70: 6c61 6365 286c 6f63 3d4e 6f6e 652c 2073  lace(loc=None, s
+00010d80: 6361 6c65 3d4e 6f6e 652c 2073 697a 653a  cale=None, size:
+00010d90: 204f 7074 696f 6e61 6c5b 5369 7a65 5d20   Optional[Size] 
+00010da0: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 2020  = None,..       
+00010db0: 2020 2020 206b 6579 3a20 4f70 7469 6f6e       key: Option
+00010dc0: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
+00010dd0: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+00010de0: 2020 2064 7479 7065 3a20 4454 7970 654c     dtype: DTypeL
+00010df0: 696b 6520 3d20 4e6f 6e65 293a 0d0a 2020  ike = None):..  
+00010e00: 7222 2222 0d0a 2020 4472 6177 2073 616d  r"""..  Draw sam
+00010e10: 706c 6573 2066 726f 6d20 7468 6520 4c61  ples from the La
+00010e20: 706c 6163 6520 6f72 2064 6f75 626c 6520  place or double 
+00010e30: 6578 706f 6e65 6e74 6961 6c20 6469 7374  exponential dist
+00010e40: 7269 6275 7469 6f6e 2077 6974 680d 0a20  ribution with.. 
+00010e50: 2073 7065 6369 6669 6564 206c 6f63 6174   specified locat
+00010e60: 696f 6e20 286f 7220 6d65 616e 2920 616e  ion (or mean) an
+00010e70: 6420 7363 616c 6520 2864 6563 6179 292e  d scale (decay).
+00010e80: 0d0a 0d0a 2020 5468 6520 4c61 706c 6163  ....  The Laplac
+00010e90: 6520 6469 7374 7269 6275 7469 6f6e 2069  e distribution i
+00010ea0: 7320 7369 6d69 6c61 7220 746f 2074 6865  s similar to the
+00010eb0: 2047 6175 7373 6961 6e2f 6e6f 726d 616c   Gaussian/normal
+00010ec0: 2064 6973 7472 6962 7574 696f 6e2c 0d0a   distribution,..
+00010ed0: 2020 6275 7420 6973 2073 6861 7270 6572    but is sharper
+00010ee0: 2061 7420 7468 6520 7065 616b 2061 6e64   at the peak and
+00010ef0: 2068 6173 2066 6174 7465 7220 7461 696c   has fatter tail
+00010f00: 732e 2049 7420 7265 7072 6573 656e 7473  s. It represents
+00010f10: 2074 6865 0d0a 2020 6469 6666 6572 656e   the..  differen
+00010f20: 6365 2062 6574 7765 656e 2074 776f 2069  ce between two i
+00010f30: 6e64 6570 656e 6465 6e74 2c20 6964 656e  ndependent, iden
+00010f40: 7469 6361 6c6c 7920 6469 7374 7269 6275  tically distribu
+00010f50: 7465 6420 6578 706f 6e65 6e74 6961 6c0d  ted exponential.
+00010f60: 0a20 2072 616e 646f 6d20 7661 7269 6162  .  random variab
+00010f70: 6c65 732e 0d0a 0d0a 2020 5061 7261 6d65  les.....  Parame
+00010f80: 7465 7273 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ters..  --------
+00010f90: 2d2d 0d0a 2020 6c6f 6320 3a20 666c 6f61  --..  loc : floa
+00010fa0: 7420 6f72 2061 7272 6179 5f6c 696b 6520  t or array_like 
+00010fb0: 6f66 2066 6c6f 6174 732c 206f 7074 696f  of floats, optio
+00010fc0: 6e61 6c0d 0a20 2020 2020 2054 6865 2070  nal..      The p
+00010fd0: 6f73 6974 696f 6e2c 203a 6d61 7468 3a60  osition, :math:`
+00010fe0: 5c6d 7560 2c20 6f66 2074 6865 2064 6973  \mu`, of the dis
+00010ff0: 7472 6962 7574 696f 6e20 7065 616b 2e20  tribution peak. 
+00011000: 4465 6661 756c 7420 6973 2030 2e0d 0a20  Default is 0... 
+00011010: 2073 6361 6c65 203a 2066 6c6f 6174 206f   scale : float o
+00011020: 7220 6172 7261 795f 6c69 6b65 206f 6620  r array_like of 
+00011030: 666c 6f61 7473 2c20 6f70 7469 6f6e 616c  floats, optional
+00011040: 0d0a 2020 2020 2020 3a6d 6174 683a 605c  ..      :math:`\
+00011050: 6c61 6d62 6461 602c 2074 6865 2065 7870  lambda`, the exp
+00011060: 6f6e 656e 7469 616c 2064 6563 6179 2e20  onential decay. 
+00011070: 4465 6661 756c 7420 6973 2031 2e20 4d75  Default is 1. Mu
+00011080: 7374 2062 6520 6e6f 6e2d 0d0a 2020 2020  st be non-..    
+00011090: 2020 6e65 6761 7469 7665 2e0d 0a20 2073    negative...  s
+000110a0: 697a 6520 3a20 696e 7420 6f72 2074 7570  ize : int or tup
+000110b0: 6c65 206f 6620 696e 7473 2c20 6f70 7469  le of ints, opti
+000110c0: 6f6e 616c 0d0a 2020 2020 2020 4f75 7470  onal..      Outp
+000110d0: 7574 2073 6861 7065 2e20 2049 6620 7468  ut shape.  If th
+000110e0: 6520 6769 7665 6e20 7368 6170 6520 6973  e given shape is
+000110f0: 2c20 652e 672e 2c20 6060 286d 2c20 6e2c  , e.g., ``(m, n,
+00011100: 206b 2960 602c 2074 6865 6e0d 0a20 2020   k)``, then..   
+00011110: 2020 2060 606d 202a 206e 202a 206b 6060     ``m * n * k``
+00011120: 2073 616d 706c 6573 2061 7265 2064 7261   samples are dra
+00011130: 776e 2e20 2049 6620 7369 7a65 2069 7320  wn.  If size is 
+00011140: 6060 4e6f 6e65 6060 2028 6465 6661 756c  ``None`` (defaul
+00011150: 7429 2c0d 0a20 2020 2020 2061 2073 696e  t),..      a sin
+00011160: 676c 6520 7661 6c75 6520 6973 2072 6574  gle value is ret
+00011170: 7572 6e65 6420 6966 2060 606c 6f63 6060  urned if ``loc``
+00011180: 2061 6e64 2060 6073 6361 6c65 6060 2061   and ``scale`` a
+00011190: 7265 2062 6f74 6820 7363 616c 6172 732e  re both scalars.
+000111a0: 0d0a 2020 2020 2020 4f74 6865 7277 6973  ..      Otherwis
+000111b0: 652c 2060 606e 702e 6272 6f61 6463 6173  e, ``np.broadcas
+000111c0: 7428 6c6f 632c 2073 6361 6c65 292e 7369  t(loc, scale).si
+000111d0: 7a65 6060 2073 616d 706c 6573 2061 7265  ze`` samples are
+000111e0: 2064 7261 776e 2e0d 0a20 206b 6579 203a   drawn...  key :
+000111f0: 2050 524e 474b 6579 2c20 6f70 7469 6f6e   PRNGKey, option
+00011200: 616c 0d0a 2020 2020 2020 5468 6520 6b65  al..      The ke
+00011210: 7920 666f 7220 7468 6520 7261 6e64 6f6d  y for the random
+00011220: 206e 756d 6265 7220 6765 6e65 7261 746f   number generato
+00011230: 722e 2049 6620 6e6f 7420 6769 7665 6e2c  r. If not given,
+00011240: 2074 6865 0d0a 2020 2020 2020 6465 6661   the..      defa
+00011250: 756c 7420 7261 6e64 6f6d 206e 756d 6265  ult random numbe
+00011260: 7220 6765 6e65 7261 746f 7220 6973 2075  r generator is u
+00011270: 7365 642e 0d0a 0d0a 2020 5265 7475 726e  sed.....  Return
+00011280: 730d 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020  s..  -------..  
+00011290: 6f75 7420 3a20 6e64 6172 7261 7920 6f72  out : ndarray or
+000112a0: 2073 6361 6c61 720d 0a20 2020 2020 2044   scalar..      D
+000112b0: 7261 776e 2073 616d 706c 6573 2066 726f  rawn samples fro
+000112c0: 6d20 7468 6520 7061 7261 6d65 7465 7269  m the parameteri
+000112d0: 7a65 6420 4c61 706c 6163 6520 6469 7374  zed Laplace dist
+000112e0: 7269 6275 7469 6f6e 2e0d 0a0d 0a20 204e  ribution.....  N
+000112f0: 6f74 6573 0d0a 2020 2d2d 2d2d 2d0d 0a20  otes..  -----.. 
+00011300: 2049 7420 6861 7320 7468 6520 7072 6f62   It has the prob
+00011310: 6162 696c 6974 7920 6465 6e73 6974 7920  ability density 
+00011320: 6675 6e63 7469 6f6e 0d0a 0d0a 2020 2e2e  function....  ..
+00011330: 206d 6174 683a 3a20 6628 783b 205c 6d75   math:: f(x; \mu
+00011340: 2c20 5c6c 616d 6264 6129 203d 205c 6672  , \lambda) = \fr
+00011350: 6163 7b31 7d7b 325c 6c61 6d62 6461 7d0d  ac{1}{2\lambda}.
+00011360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011380: 2020 5c65 7870 5c6c 6566 7428 2d5c 6672    \exp\left(-\fr
+00011390: 6163 7b7c 7820 2d20 5c6d 757c 7d7b 5c6c  ac{|x - \mu|}{\l
+000113a0: 616d 6264 617d 5c72 6967 6874 292e 0d0a  ambda}\right)...
+000113b0: 0d0a 2020 5468 6520 6669 7273 7420 6c61  ..  The first la
+000113c0: 7720 6f66 204c 6170 6c61 6365 2c20 6672  w of Laplace, fr
+000113d0: 6f6d 2031 3737 342c 2073 7461 7465 7320  om 1774, states 
+000113e0: 7468 6174 2074 6865 2066 7265 7175 656e  that the frequen
+000113f0: 6379 0d0a 2020 6f66 2061 6e20 6572 726f  cy..  of an erro
+00011400: 7220 6361 6e20 6265 2065 7870 7265 7373  r can be express
+00011410: 6564 2061 7320 616e 2065 7870 6f6e 656e  ed as an exponen
+00011420: 7469 616c 2066 756e 6374 696f 6e20 6f66  tial function of
+00011430: 2074 6865 0d0a 2020 6162 736f 6c75 7465   the..  absolute
+00011440: 206d 6167 6e69 7475 6465 206f 6620 7468   magnitude of th
+00011450: 6520 6572 726f 722c 2077 6869 6368 206c  e error, which l
+00011460: 6561 6473 2074 6f20 7468 6520 4c61 706c  eads to the Lapl
+00011470: 6163 650d 0a20 2064 6973 7472 6962 7574  ace..  distribut
+00011480: 696f 6e2e 2046 6f72 206d 616e 7920 7072  ion. For many pr
+00011490: 6f62 6c65 6d73 2069 6e20 6563 6f6e 6f6d  oblems in econom
+000114a0: 6963 7320 616e 6420 6865 616c 7468 0d0a  ics and health..
+000114b0: 2020 7363 6965 6e63 6573 2c20 7468 6973    sciences, this
+000114c0: 2064 6973 7472 6962 7574 696f 6e20 7365   distribution se
+000114d0: 656d 7320 746f 206d 6f64 656c 2074 6865  ems to model the
+000114e0: 2064 6174 6120 6265 7474 6572 0d0a 2020   data better..  
+000114f0: 7468 616e 2074 6865 2073 7461 6e64 6172  than the standar
+00011500: 6420 4761 7573 7369 616e 2064 6973 7472  d Gaussian distr
+00011510: 6962 7574 696f 6e2e 0d0a 0d0a 2020 5265  ibution.....  Re
+00011520: 6665 7265 6e63 6573 0d0a 2020 2d2d 2d2d  ferences..  ----
+00011530: 2d2d 2d2d 2d2d 0d0a 2020 2e2e 205b 315d  ------..  .. [1]
+00011540: 2041 6272 616d 6f77 6974 7a2c 204d 2e20   Abramowitz, M. 
+00011550: 616e 6420 5374 6567 756e 2c20 492e 2041  and Stegun, I. A
+00011560: 2e20 2845 6473 2e29 2e20 2248 616e 6462  . (Eds.). "Handb
+00011570: 6f6f 6b20 6f66 0d0a 2020 2020 2020 2020  ook of..        
+00011580: 204d 6174 6865 6d61 7469 6361 6c20 4675   Mathematical Fu
+00011590: 6e63 7469 6f6e 7320 7769 7468 2046 6f72  nctions with For
+000115a0: 6d75 6c61 732c 2047 7261 7068 732c 2061  mulas, Graphs, a
+000115b0: 6e64 204d 6174 6865 6d61 7469 6361 6c0d  nd Mathematical.
+000115c0: 0a20 2020 2020 2020 2020 5461 626c 6573  .         Tables
+000115d0: 2c20 3974 6820 7072 696e 7469 6e67 2c22  , 9th printing,"
+000115e0: 204e 6577 2059 6f72 6b3a 2044 6f76 6572   New York: Dover
+000115f0: 2c20 3139 3732 2e0d 0a20 202e 2e20 5b32  , 1972...  .. [2
+00011600: 5d20 4b6f 747a 2c20 5361 6d75 656c 2c20  ] Kotz, Samuel, 
+00011610: 6574 2e20 616c 2e20 2254 6865 204c 6170  et. al. "The Lap
+00011620: 6c61 6365 2044 6973 7472 6962 7574 696f  lace Distributio
+00011630: 6e20 616e 640d 0a20 2020 2020 2020 2020  n and..         
+00011640: 4765 6e65 7261 6c69 7a61 7469 6f6e 732c  Generalizations,
+00011650: 2022 2042 6972 6b68 6175 7365 722c 2032   " Birkhauser, 2
+00011660: 3030 312e 0d0a 2020 2e2e 205b 335d 2057  001...  .. [3] W
+00011670: 6569 7373 7465 696e 2c20 4572 6963 2057  eisstein, Eric W
+00011680: 2e20 224c 6170 6c61 6365 2044 6973 7472  . "Laplace Distr
+00011690: 6962 7574 696f 6e2e 220d 0a20 2020 2020  ibution."..     
+000116a0: 2020 2020 4672 6f6d 204d 6174 6857 6f72      From MathWor
+000116b0: 6c64 2d2d 4120 576f 6c66 7261 6d20 5765  ld--A Wolfram We
+000116c0: 6220 5265 736f 7572 6365 2e0d 0a20 2020  b Resource...   
+000116d0: 2020 2020 2020 6874 7470 3a2f 2f6d 6174        http://mat
+000116e0: 6877 6f72 6c64 2e77 6f6c 6672 616d 2e63  hworld.wolfram.c
+000116f0: 6f6d 2f4c 6170 6c61 6365 4469 7374 7269  om/LaplaceDistri
+00011700: 6275 7469 6f6e 2e68 746d 6c0d 0a20 202e  bution.html..  .
+00011710: 2e20 5b34 5d20 5769 6b69 7065 6469 612c  . [4] Wikipedia,
+00011720: 2022 4c61 706c 6163 6520 6469 7374 7269   "Laplace distri
+00011730: 6275 7469 6f6e 222c 0d0a 2020 2020 2020  bution",..      
+00011740: 2020 2068 7474 7073 3a2f 2f65 6e2e 7769     https://en.wi
+00011750: 6b69 7065 6469 612e 6f72 672f 7769 6b69  kipedia.org/wiki
+00011760: 2f4c 6170 6c61 6365 5f64 6973 7472 6962  /Laplace_distrib
+00011770: 7574 696f 6e0d 0a0d 0a20 2045 7861 6d70  ution....  Examp
+00011780: 6c65 730d 0a20 202d 2d2d 2d2d 2d2d 2d0d  les..  --------.
+00011790: 0a20 2044 7261 7720 7361 6d70 6c65 7320  .  Draw samples 
+000117a0: 6672 6f6d 2074 6865 2064 6973 7472 6962  from the distrib
+000117b0: 7574 696f 6e0d 0a0d 0a20 203e 3e3e 206c  ution....  >>> l
+000117c0: 6f63 2c20 7363 616c 6520 3d20 302e 2c20  oc, scale = 0., 
+000117d0: 312e 0d0a 2020 3e3e 3e20 7320 3d20 6272  1...  >>> s = br
+000117e0: 6169 6e63 6f72 652e 7261 6e64 6f6d 2e6c  aincore.random.l
+000117f0: 6170 6c61 6365 286c 6f63 2c20 7363 616c  aplace(loc, scal
+00011800: 652c 2031 3030 3029 0d0a 0d0a 2020 4469  e, 1000)....  Di
+00011810: 7370 6c61 7920 7468 6520 6869 7374 6f67  splay the histog
+00011820: 7261 6d20 6f66 2074 6865 2073 616d 706c  ram of the sampl
+00011830: 6573 2c20 616c 6f6e 6720 7769 7468 0d0a  es, along with..
+00011840: 2020 7468 6520 7072 6f62 6162 696c 6974    the probabilit
+00011850: 7920 6465 6e73 6974 7920 6675 6e63 7469  y density functi
+00011860: 6f6e 3a0d 0a0d 0a20 203e 3e3e 2069 6d70  on:....  >>> imp
+00011870: 6f72 7420 6d61 7470 6c6f 746c 6962 2e70  ort matplotlib.p
+00011880: 7970 6c6f 7420 6173 2070 6c74 2020 2320  yplot as plt  # 
+00011890: 6e6f 7161 2020 2320 6e6f 7161 0d0a 2020  noqa  # noqa..  
+000118a0: 3e3e 3e20 636f 756e 742c 2062 696e 732c  >>> count, bins,
+000118b0: 2069 676e 6f72 6564 203d 2070 6c74 2e68   ignored = plt.h
+000118c0: 6973 7428 732c 2033 302c 2064 656e 7369  ist(s, 30, densi
+000118d0: 7479 3d54 7275 6529 0d0a 2020 3e3e 3e20  ty=True)..  >>> 
+000118e0: 7820 3d20 6e70 2e61 7261 6e67 6528 2d38  x = np.arange(-8
+000118f0: 2e2c 2038 2e2c 202e 3031 290d 0a20 203e  ., 8., .01)..  >
+00011900: 3e3e 2070 6466 203d 206e 702e 6578 7028  >> pdf = np.exp(
+00011910: 2d61 6273 2878 2d6c 6f63 292f 7363 616c  -abs(x-loc)/scal
+00011920: 6529 2f28 322e 2a73 6361 6c65 290d 0a20  e)/(2.*scale).. 
+00011930: 203e 3e3e 2070 6c74 2e70 6c6f 7428 782c   >>> plt.plot(x,
+00011940: 2070 6466 290d 0a0d 0a20 2050 6c6f 7420   pdf)....  Plot 
+00011950: 4761 7573 7369 616e 2066 6f72 2063 6f6d  Gaussian for com
+00011960: 7061 7269 736f 6e3a 0d0a 0d0a 2020 3e3e  parison:....  >>
+00011970: 3e20 6720 3d20 2831 2f28 7363 616c 6520  > g = (1/(scale 
+00011980: 2a20 6e70 2e73 7172 7428 3220 2a20 6e70  * np.sqrt(2 * np
+00011990: 2e70 6929 2920 2a0d 0a20 202e 2e2e 2020  .pi)) *..  ...  
+000119a0: 2020 2020 6e70 2e65 7870 282d 2878 202d      np.exp(-(x -
+000119b0: 206c 6f63 292a 2a32 202f 2028 3220 2a20   loc)**2 / (2 * 
+000119c0: 7363 616c 652a 2a32 2929 290d 0a20 203e  scale**2)))..  >
+000119d0: 3e3e 2070 6c74 2e70 6c6f 7428 782c 6729  >> plt.plot(x,g)
+000119e0: 0d0a 2020 2222 220d 0a20 2072 6574 7572  ..  """..  retur
+000119f0: 6e20 4445 4641 554c 542e 6c61 706c 6163  n DEFAULT.laplac
+00011a00: 6528 6c6f 632c 2073 6361 6c65 2c20 7369  e(loc, scale, si
+00011a10: 7a65 2c20 6b65 793d 6b65 792c 2064 7479  ze, key=key, dty
+00011a20: 7065 3d64 7479 7065 290d 0a0d 0a0d 0a64  pe=dtype)......d
+00011a30: 6566 206c 6f67 6973 7469 6328 6c6f 633d  ef logistic(loc=
+00011a40: 4e6f 6e65 2c20 7363 616c 653d 4e6f 6e65  None, scale=None
+00011a50: 2c20 7369 7a65 3a20 4f70 7469 6f6e 616c  , size: Optional
+00011a60: 5b53 697a 655d 203d 204e 6f6e 652c 0d0a  [Size] = None,..
+00011a70: 2020 2020 2020 2020 2020 2020 206b 6579               key
+00011a80: 3a20 4f70 7469 6f6e 616c 5b53 6565 644f  : Optional[SeedO
+00011a90: 724b 6579 5d20 3d20 4e6f 6e65 2c0d 0a20  rKey] = None,.. 
+00011aa0: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
+00011ab0: 653a 2044 5479 7065 4c69 6b65 203d 204e  e: DTypeLike = N
+00011ac0: 6f6e 6529 3a0d 0a20 2072 2222 220d 0a20  one):..  r""".. 
+00011ad0: 2044 7261 7720 7361 6d70 6c65 7320 6672   Draw samples fr
+00011ae0: 6f6d 2061 206c 6f67 6973 7469 6320 6469  om a logistic di
+00011af0: 7374 7269 6275 7469 6f6e 2e0d 0a0d 0a20  stribution..... 
+00011b00: 2053 616d 706c 6573 2061 7265 2064 7261   Samples are dra
+00011b10: 776e 2066 726f 6d20 6120 6c6f 6769 7374  wn from a logist
+00011b20: 6963 2064 6973 7472 6962 7574 696f 6e20  ic distribution 
+00011b30: 7769 7468 2073 7065 6369 6669 6564 0d0a  with specified..
+00011b40: 2020 7061 7261 6d65 7465 7273 2c20 6c6f    parameters, lo
+00011b50: 6320 286c 6f63 6174 696f 6e20 6f72 206d  c (location or m
+00011b60: 6561 6e2c 2061 6c73 6f20 6d65 6469 616e  ean, also median
+00011b70: 292c 2061 6e64 2073 6361 6c65 2028 3e30  ), and scale (>0
+00011b80: 292e 0d0a 0d0a 2020 5061 7261 6d65 7465  ).....  Paramete
+00011b90: 7273 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d  rs..  ----------
+00011ba0: 0d0a 2020 6c6f 6320 3a20 666c 6f61 7420  ..  loc : float 
+00011bb0: 6f72 2061 7272 6179 5f6c 696b 6520 6f66  or array_like of
+00011bc0: 2066 6c6f 6174 732c 206f 7074 696f 6e61   floats, optiona
+00011bd0: 6c0d 0a20 2020 2020 2050 6172 616d 6574  l..      Paramet
+00011be0: 6572 206f 6620 7468 6520 6469 7374 7269  er of the distri
+00011bf0: 6275 7469 6f6e 2e20 4465 6661 756c 7420  bution. Default 
+00011c00: 6973 2030 2e0d 0a20 2073 6361 6c65 203a  is 0...  scale :
+00011c10: 2066 6c6f 6174 206f 7220 6172 7261 795f   float or array_
+00011c20: 6c69 6b65 206f 6620 666c 6f61 7473 2c20  like of floats, 
+00011c30: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+00011c40: 5061 7261 6d65 7465 7220 6f66 2074 6865  Parameter of the
+00011c50: 2064 6973 7472 6962 7574 696f 6e2e 204d   distribution. M
+00011c60: 7573 7420 6265 206e 6f6e 2d6e 6567 6174  ust be non-negat
+00011c70: 6976 652e 0d0a 2020 2020 2020 4465 6661  ive...      Defa
+00011c80: 756c 7420 6973 2031 2e0d 0a20 2073 697a  ult is 1...  siz
+00011c90: 6520 3a20 696e 7420 6f72 2074 7570 6c65  e : int or tuple
+00011ca0: 206f 6620 696e 7473 2c20 6f70 7469 6f6e   of ints, option
+00011cb0: 616c 0d0a 2020 2020 2020 4f75 7470 7574  al..      Output
+00011cc0: 2073 6861 7065 2e20 2049 6620 7468 6520   shape.  If the 
+00011cd0: 6769 7665 6e20 7368 6170 6520 6973 2c20  given shape is, 
+00011ce0: 652e 672e 2c20 6060 286d 2c20 6e2c 206b  e.g., ``(m, n, k
+00011cf0: 2960 602c 2074 6865 6e0d 0a20 2020 2020  )``, then..     
+00011d00: 2060 606d 202a 206e 202a 206b 6060 2073   ``m * n * k`` s
+00011d10: 616d 706c 6573 2061 7265 2064 7261 776e  amples are drawn
+00011d20: 2e20 2049 6620 7369 7a65 2069 7320 6060  .  If size is ``
+00011d30: 4e6f 6e65 6060 2028 6465 6661 756c 7429  None`` (default)
+00011d40: 2c0d 0a20 2020 2020 2061 2073 696e 676c  ,..      a singl
+00011d50: 6520 7661 6c75 6520 6973 2072 6574 7572  e value is retur
+00011d60: 6e65 6420 6966 2060 606c 6f63 6060 2061  ned if ``loc`` a
+00011d70: 6e64 2060 6073 6361 6c65 6060 2061 7265  nd ``scale`` are
+00011d80: 2062 6f74 6820 7363 616c 6172 732e 0d0a   both scalars...
+00011d90: 2020 2020 2020 4f74 6865 7277 6973 652c        Otherwise,
+00011da0: 2060 606e 702e 6272 6f61 6463 6173 7428   ``np.broadcast(
+00011db0: 6c6f 632c 2073 6361 6c65 292e 7369 7a65  loc, scale).size
+00011dc0: 6060 2073 616d 706c 6573 2061 7265 2064  `` samples are d
+00011dd0: 7261 776e 2e0d 0a20 206b 6579 203a 2050  rawn...  key : P
+00011de0: 524e 474b 6579 2c20 6f70 7469 6f6e 616c  RNGKey, optional
+00011df0: 0d0a 2020 2020 2020 5468 6520 6b65 7920  ..      The key 
+00011e00: 666f 7220 7468 6520 7261 6e64 6f6d 206e  for the random n
+00011e10: 756d 6265 7220 6765 6e65 7261 746f 722e  umber generator.
+00011e20: 2049 6620 6e6f 7420 6769 7665 6e2c 2074   If not given, t
+00011e30: 6865 0d0a 2020 2020 2020 6465 6661 756c  he..      defaul
+00011e40: 7420 7261 6e64 6f6d 206e 756d 6265 7220  t random number 
+00011e50: 6765 6e65 7261 746f 7220 6973 2075 7365  generator is use
+00011e60: 642e 0d0a 0d0a 2020 5265 7475 726e 730d  d.....  Returns.
+00011e70: 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020 6f75  .  -------..  ou
+00011e80: 7420 3a20 6e64 6172 7261 7920 6f72 2073  t : ndarray or s
+00011e90: 6361 6c61 720d 0a20 2020 2020 2044 7261  calar..      Dra
+00011ea0: 776e 2073 616d 706c 6573 2066 726f 6d20  wn samples from 
+00011eb0: 7468 6520 7061 7261 6d65 7465 7269 7a65  the parameterize
+00011ec0: 6420 6c6f 6769 7374 6963 2064 6973 7472  d logistic distr
+00011ed0: 6962 7574 696f 6e2e 0d0a 0d0a 2020 4e6f  ibution.....  No
+00011ee0: 7465 730d 0a20 202d 2d2d 2d2d 0d0a 2020  tes..  -----..  
+00011ef0: 5468 6520 7072 6f62 6162 696c 6974 7920  The probability 
+00011f00: 6465 6e73 6974 7920 666f 7220 7468 6520  density for the 
+00011f10: 4c6f 6769 7374 6963 2064 6973 7472 6962  Logistic distrib
+00011f20: 7574 696f 6e20 6973 0d0a 0d0a 2020 2e2e  ution is....  ..
+00011f30: 206d 6174 683a 3a20 5028 7829 203d 2050   math:: P(x) = P
+00011f40: 2878 2920 3d20 5c66 7261 637b 655e 7b2d  (x) = \frac{e^{-
+00011f50: 2878 2d5c 6d75 292f 737d 7d7b 7328 312b  (x-\mu)/s}}{s(1+
+00011f60: 655e 7b2d 2878 2d5c 6d75 292f 737d 295e  e^{-(x-\mu)/s})^
+00011f70: 327d 2c0d 0a0d 0a20 2077 6865 7265 203a  2},....  where :
+00011f80: 6d61 7468 3a60 5c6d 7560 203d 206c 6f63  math:`\mu` = loc
+00011f90: 6174 696f 6e20 616e 6420 3a6d 6174 683a  ation and :math:
+00011fa0: 6073 6020 3d20 7363 616c 652e 0d0a 0d0a  `s` = scale.....
+00011fb0: 2020 5468 6520 4c6f 6769 7374 6963 2064    The Logistic d
+00011fc0: 6973 7472 6962 7574 696f 6e20 6973 2075  istribution is u
+00011fd0: 7365 6420 696e 2045 7874 7265 6d65 2056  sed in Extreme V
+00011fe0: 616c 7565 2070 726f 626c 656d 7320 7768  alue problems wh
+00011ff0: 6572 6520 6974 0d0a 2020 6361 6e20 6163  ere it..  can ac
+00012000: 7420 6173 2061 206d 6978 7475 7265 206f  t as a mixture o
+00012010: 6620 4775 6d62 656c 2064 6973 7472 6962  f Gumbel distrib
+00012020: 7574 696f 6e73 2c20 696e 2045 7069 6465  utions, in Epide
+00012030: 6d69 6f6c 6f67 792c 2061 6e64 2062 790d  miology, and by.
+00012040: 0a20 2074 6865 2057 6f72 6c64 2043 6865  .  the World Che
+00012050: 7373 2046 6564 6572 6174 696f 6e20 2846  ss Federation (F
+00012060: 4944 4529 2077 6865 7265 2069 7420 6973  IDE) where it is
+00012070: 2075 7365 6420 696e 2074 6865 2045 6c6f   used in the Elo
+00012080: 2072 616e 6b69 6e67 0d0a 2020 7379 7374   ranking..  syst
+00012090: 656d 2c20 6173 7375 6d69 6e67 2074 6865  em, assuming the
+000120a0: 2070 6572 666f 726d 616e 6365 206f 6620   performance of 
+000120b0: 6561 6368 2070 6c61 7965 7220 6973 2061  each player is a
+000120c0: 206c 6f67 6973 7469 6361 6c6c 790d 0a20   logistically.. 
+000120d0: 2064 6973 7472 6962 7574 6564 2072 616e   distributed ran
+000120e0: 646f 6d20 7661 7269 6162 6c65 2e0d 0a0d  dom variable....
+000120f0: 0a20 2052 6566 6572 656e 6365 730d 0a20  .  References.. 
+00012100: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 202e   ----------..  .
+00012110: 2e20 5b31 5d20 5265 6973 732c 2052 2e2d  . [1] Reiss, R.-
+00012120: 442e 2061 6e64 2054 686f 6d61 7320 4d2e  D. and Thomas M.
+00012130: 2028 3230 3031 292c 2022 5374 6174 6973   (2001), "Statis
+00012140: 7469 6361 6c20 416e 616c 7973 6973 206f  tical Analysis o
+00012150: 660d 0a20 2020 2020 2020 2020 4578 7472  f..         Extr
+00012160: 656d 6520 5661 6c75 6573 2c20 6672 6f6d  eme Values, from
+00012170: 2049 6e73 7572 616e 6365 2c20 4669 6e61   Insurance, Fina
+00012180: 6e63 652c 2048 7964 726f 6c6f 6779 2061  nce, Hydrology a
+00012190: 6e64 204f 7468 6572 0d0a 2020 2020 2020  nd Other..      
+000121a0: 2020 2046 6965 6c64 732c 2220 4269 726b     Fields," Birk
+000121b0: 6861 7573 6572 2056 6572 6c61 672c 2042  hauser Verlag, B
+000121c0: 6173 656c 2c20 7070 2031 3332 2d31 3333  asel, pp 132-133
+000121d0: 2e0d 0a20 202e 2e20 5b32 5d20 5765 6973  ...  .. [2] Weis
+000121e0: 7374 6569 6e2c 2045 7269 6320 572e 2022  stein, Eric W. "
+000121f0: 4c6f 6769 7374 6963 2044 6973 7472 6962  Logistic Distrib
+00012200: 7574 696f 6e2e 2220 4672 6f6d 0d0a 2020  ution." From..  
+00012210: 2020 2020 2020 204d 6174 6857 6f72 6c64         MathWorld
+00012220: 2d2d 4120 576f 6c66 7261 6d20 5765 6220  --A Wolfram Web 
+00012230: 5265 736f 7572 6365 2e0d 0a20 2020 2020  Resource...     
+00012240: 2020 2020 6874 7470 3a2f 2f6d 6174 6877      http://mathw
+00012250: 6f72 6c64 2e77 6f6c 6672 616d 2e63 6f6d  orld.wolfram.com
+00012260: 2f4c 6f67 6973 7469 6344 6973 7472 6962  /LogisticDistrib
+00012270: 7574 696f 6e2e 6874 6d6c 0d0a 2020 2e2e  ution.html..  ..
+00012280: 205b 335d 2057 696b 6970 6564 6961 2c20   [3] Wikipedia, 
+00012290: 224c 6f67 6973 7469 632d 6469 7374 7269  "Logistic-distri
+000122a0: 6275 7469 6f6e 222c 0d0a 2020 2020 2020  bution",..      
+000122b0: 2020 2068 7474 7073 3a2f 2f65 6e2e 7769     https://en.wi
+000122c0: 6b69 7065 6469 612e 6f72 672f 7769 6b69  kipedia.org/wiki
+000122d0: 2f4c 6f67 6973 7469 635f 6469 7374 7269  /Logistic_distri
+000122e0: 6275 7469 6f6e 0d0a 0d0a 2020 4578 616d  bution....  Exam
+000122f0: 706c 6573 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ples..  --------
+00012300: 0d0a 2020 4472 6177 2073 616d 706c 6573  ..  Draw samples
+00012310: 2066 726f 6d20 7468 6520 6469 7374 7269   from the distri
+00012320: 6275 7469 6f6e 3a0d 0a0d 0a20 203e 3e3e  bution:....  >>>
+00012330: 206c 6f63 2c20 7363 616c 6520 3d20 3130   loc, scale = 10
+00012340: 2c20 310d 0a20 203e 3e3e 2073 203d 2062  , 1..  >>> s = b
+00012350: 7261 696e 636f 7265 2e72 616e 646f 6d2e  raincore.random.
+00012360: 6c6f 6769 7374 6963 286c 6f63 2c20 7363  logistic(loc, sc
+00012370: 616c 652c 2031 3030 3030 290d 0a20 203e  ale, 10000)..  >
+00012380: 3e3e 2069 6d70 6f72 7420 6d61 7470 6c6f  >> import matplo
+00012390: 746c 6962 2e70 7970 6c6f 7420 6173 2070  tlib.pyplot as p
+000123a0: 6c74 2020 2320 6e6f 7161 0d0a 2020 3e3e  lt  # noqa..  >>
+000123b0: 3e20 636f 756e 742c 2062 696e 732c 2069  > count, bins, i
+000123c0: 676e 6f72 6564 203d 2070 6c74 2e68 6973  gnored = plt.his
+000123d0: 7428 732c 2062 696e 733d 3530 290d 0a0d  t(s, bins=50)...
+000123e0: 0a20 2023 2020 2070 6c6f 7420 6167 6169  .  #   plot agai
+000123f0: 6e73 7420 6469 7374 7269 6275 7469 6f6e  nst distribution
+00012400: 0d0a 0d0a 2020 3e3e 3e20 6465 6620 6c6f  ....  >>> def lo
+00012410: 6769 7374 2878 2c20 6c6f 632c 2073 6361  gist(x, loc, sca
+00012420: 6c65 293a 0d0a 2020 2e2e 2e20 2020 2020  le):..  ...     
+00012430: 7265 7475 726e 206e 702e 6578 7028 286c  return np.exp((l
+00012440: 6f63 2d78 292f 7363 616c 6529 2f28 7363  oc-x)/scale)/(sc
+00012450: 616c 652a 2831 2b6e 702e 6578 7028 286c  ale*(1+np.exp((l
+00012460: 6f63 2d78 292f 7363 616c 6529 292a 2a32  oc-x)/scale))**2
+00012470: 290d 0a20 203e 3e3e 206c 6773 745f 7661  )..  >>> lgst_va
+00012480: 6c20 3d20 6c6f 6769 7374 2862 696e 732c  l = logist(bins,
+00012490: 206c 6f63 2c20 7363 616c 6529 0d0a 2020   loc, scale)..  
+000124a0: 3e3e 3e20 706c 742e 706c 6f74 2862 696e  >>> plt.plot(bin
+000124b0: 732c 206c 6773 745f 7661 6c20 2a20 636f  s, lgst_val * co
+000124c0: 756e 742e 6d61 7828 2920 2f20 6c67 7374  unt.max() / lgst
+000124d0: 5f76 616c 2e6d 6178 2829 290d 0a20 203e  _val.max())..  >
+000124e0: 3e3e 2070 6c74 2e73 686f 7728 290d 0a20  >> plt.show().. 
+000124f0: 2022 2222 0d0a 2020 7265 7475 726e 2044   """..  return D
+00012500: 4546 4155 4c54 2e6c 6f67 6973 7469 6328  EFAULT.logistic(
+00012510: 6c6f 632c 2073 6361 6c65 2c20 7369 7a65  loc, scale, size
+00012520: 2c20 6b65 793d 6b65 792c 2064 7479 7065  , key=key, dtype
+00012530: 3d64 7479 7065 290d 0a0d 0a0d 0a64 6566  =dtype)......def
+00012540: 206e 6f72 6d61 6c28 6c6f 633d 4e6f 6e65   normal(loc=None
+00012550: 2c20 7363 616c 653d 4e6f 6e65 2c20 7369  , scale=None, si
+00012560: 7a65 3a20 4f70 7469 6f6e 616c 5b53 697a  ze: Optional[Siz
+00012570: 655d 203d 204e 6f6e 652c 0d0a 2020 2020  e] = None,..    
+00012580: 2020 2020 2020 206b 6579 3a20 4f70 7469         key: Opti
+00012590: 6f6e 616c 5b53 6565 644f 724b 6579 5d20  onal[SeedOrKey] 
+000125a0: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 2020  = None,..       
+000125b0: 2020 2020 6474 7970 653a 2044 5479 7065      dtype: DType
+000125c0: 4c69 6b65 203d 204e 6f6e 6529 3a0d 0a20  Like = None):.. 
+000125d0: 2072 2222 220d 0a20 2044 7261 7720 7261   r"""..  Draw ra
+000125e0: 6e64 6f6d 2073 616d 706c 6573 2066 726f  ndom samples fro
+000125f0: 6d20 6120 6e6f 726d 616c 2028 4761 7573  m a normal (Gaus
+00012600: 7369 616e 2920 6469 7374 7269 6275 7469  sian) distributi
+00012610: 6f6e 2e0d 0a0d 0a20 2054 6865 2070 726f  on.....  The pro
+00012620: 6261 6269 6c69 7479 2064 656e 7369 7479  bability density
+00012630: 2066 756e 6374 696f 6e20 6f66 2074 6865   function of the
+00012640: 206e 6f72 6d61 6c20 6469 7374 7269 6275   normal distribu
+00012650: 7469 6f6e 2c20 6669 7273 740d 0a20 2064  tion, first..  d
+00012660: 6572 6976 6564 2062 7920 4465 204d 6f69  erived by De Moi
+00012670: 7672 6520 616e 6420 3230 3020 7965 6172  vre and 200 year
+00012680: 7320 6c61 7465 7220 6279 2062 6f74 6820  s later by both 
+00012690: 4761 7573 7320 616e 6420 4c61 706c 6163  Gauss and Laplac
+000126a0: 650d 0a20 2069 6e64 6570 656e 6465 6e74  e..  independent
+000126b0: 6c79 205b 325d 5f2c 2069 7320 6f66 7465  ly [2]_, is ofte
+000126c0: 6e20 6361 6c6c 6564 2074 6865 2062 656c  n called the bel
+000126d0: 6c20 6375 7276 6520 6265 6361 7573 6520  l curve because 
+000126e0: 6f66 0d0a 2020 6974 7320 6368 6172 6163  of..  its charac
+000126f0: 7465 7269 7374 6963 2073 6861 7065 2028  teristic shape (
+00012700: 7365 6520 7468 6520 6578 616d 706c 6520  see the example 
+00012710: 6265 6c6f 7729 2e0d 0a0d 0a20 2054 6865  below).....  The
+00012720: 206e 6f72 6d61 6c20 6469 7374 7269 6275   normal distribu
+00012730: 7469 6f6e 7320 6f63 6375 7273 206f 6674  tions occurs oft
+00012740: 656e 2069 6e20 6e61 7475 7265 2e20 2046  en in nature.  F
+00012750: 6f72 2065 7861 6d70 6c65 2c20 6974 0d0a  or example, it..
+00012760: 2020 6465 7363 7269 6265 7320 7468 6520    describes the 
+00012770: 636f 6d6d 6f6e 6c79 206f 6363 7572 7269  commonly occurri
+00012780: 6e67 2064 6973 7472 6962 7574 696f 6e20  ng distribution 
+00012790: 6f66 2073 616d 706c 6573 2069 6e66 6c75  of samples influ
+000127a0: 656e 6365 640d 0a20 2062 7920 6120 6c61  enced..  by a la
+000127b0: 7267 6520 6e75 6d62 6572 206f 6620 7469  rge number of ti
+000127c0: 6e79 2c20 7261 6e64 6f6d 2064 6973 7475  ny, random distu
+000127d0: 7262 616e 6365 732c 2065 6163 6820 7769  rbances, each wi
+000127e0: 7468 2069 7473 206f 776e 0d0a 2020 756e  th its own..  un
+000127f0: 6971 7565 2064 6973 7472 6962 7574 696f  ique distributio
+00012800: 6e20 5b32 5d5f 2e0d 0a0d 0a20 2050 6172  n [2]_.....  Par
+00012810: 616d 6574 6572 730d 0a20 202d 2d2d 2d2d  ameters..  -----
+00012820: 2d2d 2d2d 2d0d 0a20 206c 6f63 203a 2066  -----..  loc : f
+00012830: 6c6f 6174 206f 7220 6172 7261 795f 6c69  loat or array_li
+00012840: 6b65 206f 6620 666c 6f61 7473 0d0a 2020  ke of floats..  
+00012850: 2020 2020 4d65 616e 2028 2263 656e 7472      Mean ("centr
+00012860: 6522 2920 6f66 2074 6865 2064 6973 7472  e") of the distr
+00012870: 6962 7574 696f 6e2e 0d0a 2020 7363 616c  ibution...  scal
+00012880: 6520 3a20 666c 6f61 7420 6f72 2061 7272  e : float or arr
+00012890: 6179 5f6c 696b 6520 6f66 2066 6c6f 6174  ay_like of float
+000128a0: 730d 0a20 2020 2020 2053 7461 6e64 6172  s..      Standar
+000128b0: 6420 6465 7669 6174 696f 6e20 2873 7072  d deviation (spr
+000128c0: 6561 6420 6f72 2022 7769 6474 6822 2920  ead or "width") 
+000128d0: 6f66 2074 6865 2064 6973 7472 6962 7574  of the distribut
+000128e0: 696f 6e2e 204d 7573 7420 6265 0d0a 2020  ion. Must be..  
+000128f0: 2020 2020 6e6f 6e2d 6e65 6761 7469 7665      non-negative
+00012900: 2e0d 0a20 2073 697a 6520 3a20 696e 7420  ...  size : int 
+00012910: 6f72 2074 7570 6c65 206f 6620 696e 7473  or tuple of ints
+00012920: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+00012930: 2020 4f75 7470 7574 2073 6861 7065 2e20    Output shape. 
+00012940: 2049 6620 7468 6520 6769 7665 6e20 7368   If the given sh
+00012950: 6170 6520 6973 2c20 652e 672e 2c20 6060  ape is, e.g., ``
+00012960: 286d 2c20 6e2c 206b 2960 602c 2074 6865  (m, n, k)``, the
+00012970: 6e0d 0a20 2020 2020 2060 606d 202a 206e  n..      ``m * n
+00012980: 202a 206b 6060 2073 616d 706c 6573 2061   * k`` samples a
+00012990: 7265 2064 7261 776e 2e20 2049 6620 7369  re drawn.  If si
+000129a0: 7a65 2069 7320 6060 4e6f 6e65 6060 2028  ze is ``None`` (
+000129b0: 6465 6661 756c 7429 2c0d 0a20 2020 2020  default),..     
+000129c0: 2061 2073 696e 676c 6520 7661 6c75 6520   a single value 
+000129d0: 6973 2072 6574 7572 6e65 6420 6966 2060  is returned if `
+000129e0: 606c 6f63 6060 2061 6e64 2060 6073 6361  `loc`` and ``sca
+000129f0: 6c65 6060 2061 7265 2062 6f74 6820 7363  le`` are both sc
+00012a00: 616c 6172 732e 0d0a 2020 2020 2020 4f74  alars...      Ot
+00012a10: 6865 7277 6973 652c 2060 606e 702e 6272  herwise, ``np.br
+00012a20: 6f61 6463 6173 7428 6c6f 632c 2073 6361  oadcast(loc, sca
+00012a30: 6c65 292e 7369 7a65 6060 2073 616d 706c  le).size`` sampl
+00012a40: 6573 2061 7265 2064 7261 776e 2e0d 0a20  es are drawn... 
+00012a50: 206b 6579 203a 2050 524e 474b 6579 2c20   key : PRNGKey, 
+00012a60: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+00012a70: 5468 6520 6b65 7920 666f 7220 7468 6520  The key for the 
+00012a80: 7261 6e64 6f6d 206e 756d 6265 7220 6765  random number ge
+00012a90: 6e65 7261 746f 722e 2049 6620 6e6f 7420  nerator. If not 
+00012aa0: 6769 7665 6e2c 2074 6865 0d0a 2020 2020  given, the..    
+00012ab0: 2020 6465 6661 756c 7420 7261 6e64 6f6d    default random
+00012ac0: 206e 756d 6265 7220 6765 6e65 7261 746f   number generato
+00012ad0: 7220 6973 2075 7365 642e 0d0a 0d0a 2020  r is used.....  
+00012ae0: 5265 7475 726e 730d 0a20 202d 2d2d 2d2d  Returns..  -----
+00012af0: 2d2d 0d0a 2020 6f75 7420 3a20 6e64 6172  --..  out : ndar
+00012b00: 7261 7920 6f72 2073 6361 6c61 720d 0a20  ray or scalar.. 
+00012b10: 2020 2020 2044 7261 776e 2073 616d 706c       Drawn sampl
+00012b20: 6573 2066 726f 6d20 7468 6520 7061 7261  es from the para
+00012b30: 6d65 7465 7269 7a65 6420 6e6f 726d 616c  meterized normal
+00012b40: 2064 6973 7472 6962 7574 696f 6e2e 0d0a   distribution...
+00012b50: 0d0a 2020 4e6f 7465 730d 0a20 202d 2d2d  ..  Notes..  ---
+00012b60: 2d2d 0d0a 2020 5468 6520 7072 6f62 6162  --..  The probab
+00012b70: 696c 6974 7920 6465 6e73 6974 7920 666f  ility density fo
+00012b80: 7220 7468 6520 4761 7573 7369 616e 2064  r the Gaussian d
+00012b90: 6973 7472 6962 7574 696f 6e20 6973 0d0a  istribution is..
+00012ba0: 0d0a 2020 2e2e 206d 6174 683a 3a20 7028  ..  .. math:: p(
+00012bb0: 7829 203d 205c 6672 6163 7b31 7d7b 5c73  x) = \frac{1}{\s
+00012bc0: 7172 747b 2032 205c 7069 205c 7369 676d  qrt{ 2 \pi \sigm
+00012bd0: 615e 3220 7d7d 0d0a 2020 2020 2020 2020  a^2 }}..        
+00012be0: 2020 2020 2020 2020 2020 2065 5e7b 202d             e^{ -
+00012bf0: 205c 6672 6163 7b20 2878 202d 205c 6d75   \frac{ (x - \mu
+00012c00: 295e 3220 7d20 7b32 205c 7369 676d 615e  )^2 } {2 \sigma^
+00012c10: 327d 207d 2c0d 0a0d 0a20 2077 6865 7265  2} },....  where
+00012c20: 203a 6d61 7468 3a60 5c6d 7560 2069 7320   :math:`\mu` is 
+00012c30: 7468 6520 6d65 616e 2061 6e64 203a 6d61  the mean and :ma
+00012c40: 7468 3a60 5c73 6967 6d61 6020 7468 6520  th:`\sigma` the 
+00012c50: 7374 616e 6461 7264 0d0a 2020 6465 7669  standard..  devi
+00012c60: 6174 696f 6e2e 2054 6865 2073 7175 6172  ation. The squar
+00012c70: 6520 6f66 2074 6865 2073 7461 6e64 6172  e of the standar
+00012c80: 6420 6465 7669 6174 696f 6e2c 203a 6d61  d deviation, :ma
+00012c90: 7468 3a60 5c73 6967 6d61 5e32 602c 0d0a  th:`\sigma^2`,..
+00012ca0: 2020 6973 2063 616c 6c65 6420 7468 6520    is called the 
+00012cb0: 7661 7269 616e 6365 2e0d 0a0d 0a20 2054  variance.....  T
+00012cc0: 6865 2066 756e 6374 696f 6e20 6861 7320  he function has 
+00012cd0: 6974 7320 7065 616b 2061 7420 7468 6520  its peak at the 
+00012ce0: 6d65 616e 2c20 616e 6420 6974 7320 2273  mean, and its "s
+00012cf0: 7072 6561 6422 2069 6e63 7265 6173 6573  pread" increases
+00012d00: 2077 6974 680d 0a20 2074 6865 2073 7461   with..  the sta
+00012d10: 6e64 6172 6420 6465 7669 6174 696f 6e20  ndard deviation 
+00012d20: 2874 6865 2066 756e 6374 696f 6e20 7265  (the function re
+00012d30: 6163 6865 7320 302e 3630 3720 7469 6d65  aches 0.607 time
+00012d40: 7320 6974 7320 6d61 7869 6d75 6d20 6174  s its maximum at
+00012d50: 0d0a 2020 3a6d 6174 683a 6078 202b 205c  ..  :math:`x + \
+00012d60: 7369 676d 6160 2061 6e64 203a 6d61 7468  sigma` and :math
+00012d70: 3a60 7820 2d20 5c73 6967 6d61 6020 5b32  :`x - \sigma` [2
+00012d80: 5d5f 292e 2020 5468 6973 2069 6d70 6c69  ]_).  This impli
+00012d90: 6573 2074 6861 740d 0a20 206e 6f72 6d61  es that..  norma
+00012da0: 6c20 6973 206d 6f72 6520 6c69 6b65 6c79  l is more likely
+00012db0: 2074 6f20 7265 7475 726e 2073 616d 706c   to return sampl
+00012dc0: 6573 206c 7969 6e67 2063 6c6f 7365 2074  es lying close t
+00012dd0: 6f20 7468 6520 6d65 616e 2c20 7261 7468  o the mean, rath
+00012de0: 6572 0d0a 2020 7468 616e 2074 686f 7365  er..  than those
+00012df0: 2066 6172 2061 7761 792e 0d0a 0d0a 2020   far away.....  
+00012e00: 5265 6665 7265 6e63 6573 0d0a 2020 2d2d  References..  --
+00012e10: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2e2e 205b  --------..  .. [
+00012e20: 315d 2057 696b 6970 6564 6961 2c20 224e  1] Wikipedia, "N
+00012e30: 6f72 6d61 6c20 6469 7374 7269 6275 7469  ormal distributi
+00012e40: 6f6e 222c 0d0a 2020 2020 2020 2020 2068  on",..         h
+00012e50: 7474 7073 3a2f 2f65 6e2e 7769 6b69 7065  ttps://en.wikipe
+00012e60: 6469 612e 6f72 672f 7769 6b69 2f4e 6f72  dia.org/wiki/Nor
+00012e70: 6d61 6c5f 6469 7374 7269 6275 7469 6f6e  mal_distribution
+00012e80: 0d0a 2020 2e2e 205b 325d 2050 2e20 522e  ..  .. [2] P. R.
+00012e90: 2050 6565 626c 6573 204a 722e 2c20 2243   Peebles Jr., "C
+00012ea0: 656e 7472 616c 204c 696d 6974 2054 6865  entral Limit The
+00012eb0: 6f72 656d 2220 696e 2022 5072 6f62 6162  orem" in "Probab
+00012ec0: 696c 6974 792c 0d0a 2020 2020 2020 2020  ility,..        
+00012ed0: 2052 616e 646f 6d20 5661 7269 6162 6c65   Random Variable
+00012ee0: 7320 616e 6420 5261 6e64 6f6d 2053 6967  s and Random Sig
+00012ef0: 6e61 6c20 5072 696e 6369 706c 6573 222c  nal Principles",
+00012f00: 2034 7468 2065 642e 2c20 3230 3031 2c0d   4th ed., 2001,.
+00012f10: 0a20 2020 2020 2020 2020 7070 2e20 3531  .         pp. 51
+00012f20: 2c20 3531 2c20 3132 352e 0d0a 0d0a 2020  , 51, 125.....  
+00012f30: 4578 616d 706c 6573 0d0a 2020 2d2d 2d2d  Examples..  ----
+00012f40: 2d2d 2d2d 0d0a 2020 4472 6177 2073 616d  ----..  Draw sam
+00012f50: 706c 6573 2066 726f 6d20 7468 6520 6469  ples from the di
+00012f60: 7374 7269 6275 7469 6f6e 3a0d 0a0d 0a20  stribution:.... 
+00012f70: 203e 3e3e 206d 752c 2073 6967 6d61 203d   >>> mu, sigma =
+00012f80: 2030 2c20 302e 3120 2320 6d65 616e 2061   0, 0.1 # mean a
+00012f90: 6e64 2073 7461 6e64 6172 6420 6465 7669  nd standard devi
+00012fa0: 6174 696f 6e0d 0a20 203e 3e3e 2073 203d  ation..  >>> s =
+00012fb0: 2062 7261 696e 636f 7265 2e72 616e 646f   braincore.rando
+00012fc0: 6d2e 6e6f 726d 616c 286d 752c 2073 6967  m.normal(mu, sig
+00012fd0: 6d61 2c20 3130 3030 290d 0a0d 0a20 2056  ma, 1000)....  V
+00012fe0: 6572 6966 7920 7468 6520 6d65 616e 2061  erify the mean a
+00012ff0: 6e64 2074 6865 2076 6172 6961 6e63 653a  nd the variance:
+00013000: 0d0a 0d0a 2020 3e3e 3e20 6162 7328 6d75  ....  >>> abs(mu
+00013010: 202d 206e 702e 6d65 616e 2873 2929 0d0a   - np.mean(s))..
+00013020: 2020 302e 3020 2023 206d 6179 2076 6172    0.0  # may var
+00013030: 790d 0a0d 0a20 203e 3e3e 2061 6273 2873  y....  >>> abs(s
+00013040: 6967 6d61 202d 206e 702e 7374 6428 732c  igma - np.std(s,
+00013050: 2064 646f 663d 3129 290d 0a20 2030 2e31   ddof=1))..  0.1
+00013060: 2020 2320 6d61 7920 7661 7279 0d0a 0d0a    # may vary....
+00013070: 2020 4469 7370 6c61 7920 7468 6520 6869    Display the hi
+00013080: 7374 6f67 7261 6d20 6f66 2074 6865 2073  stogram of the s
+00013090: 616d 706c 6573 2c20 616c 6f6e 6720 7769  amples, along wi
+000130a0: 7468 0d0a 2020 7468 6520 7072 6f62 6162  th..  the probab
+000130b0: 696c 6974 7920 6465 6e73 6974 7920 6675  ility density fu
+000130c0: 6e63 7469 6f6e 3a0d 0a0d 0a20 203e 3e3e  nction:....  >>>
+000130d0: 2069 6d70 6f72 7420 6d61 7470 6c6f 746c   import matplotl
+000130e0: 6962 2e70 7970 6c6f 7420 6173 2070 6c74  ib.pyplot as plt
+000130f0: 2020 2320 6e6f 7161 0d0a 2020 3e3e 3e20    # noqa..  >>> 
+00013100: 636f 756e 742c 2062 696e 732c 2069 676e  count, bins, ign
+00013110: 6f72 6564 203d 2070 6c74 2e68 6973 7428  ored = plt.hist(
+00013120: 732c 2033 302c 2064 656e 7369 7479 3d54  s, 30, density=T
+00013130: 7275 6529 0d0a 2020 3e3e 3e20 706c 742e  rue)..  >>> plt.
+00013140: 706c 6f74 2862 696e 732c 2031 2f28 7369  plot(bins, 1/(si
+00013150: 676d 6120 2a20 6e70 2e73 7172 7428 3220  gma * np.sqrt(2 
+00013160: 2a20 6e70 2e70 6929 2920 2a0d 0a20 202e  * np.pi)) *..  .
+00013170: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
+00013180: 2020 6e70 2e65 7870 2820 2d20 2862 696e    np.exp( - (bin
+00013190: 7320 2d20 6d75 292a 2a32 202f 2028 3220  s - mu)**2 / (2 
+000131a0: 2a20 7369 676d 612a 2a32 2920 292c 0d0a  * sigma**2) ),..
+000131b0: 2020 2e2e 2e20 2020 2020 2020 2020 206c    ...          l
+000131c0: 696e 6577 6964 7468 3d32 2c20 636f 6c6f  inewidth=2, colo
+000131d0: 723d 2772 2729 0d0a 2020 3e3e 3e20 706c  r='r')..  >>> pl
+000131e0: 742e 7368 6f77 2829 0d0a 0d0a 2020 5477  t.show()....  Tw
+000131f0: 6f2d 6279 2d66 6f75 7220 6172 7261 7920  o-by-four array 
+00013200: 6f66 2073 616d 706c 6573 2066 726f 6d20  of samples from 
+00013210: 7468 6520 6e6f 726d 616c 2064 6973 7472  the normal distr
+00013220: 6962 7574 696f 6e20 7769 7468 0d0a 2020  ibution with..  
+00013230: 6d65 616e 2033 2061 6e64 2073 7461 6e64  mean 3 and stand
+00013240: 6172 6420 6465 7669 6174 696f 6e20 322e  ard deviation 2.
+00013250: 353a 0d0a 0d0a 2020 3e3e 3e20 6272 6169  5:....  >>> brai
+00013260: 6e63 6f72 652e 7261 6e64 6f6d 2e6e 6f72  ncore.random.nor
+00013270: 6d61 6c28 332c 2032 2e35 2c20 7369 7a65  mal(3, 2.5, size
+00013280: 3d28 322c 2034 2929 0d0a 2020 6172 7261  =(2, 4))..  arra
+00013290: 7928 5b5b 2d34 2e34 3934 3031 3530 312c  y([[-4.49401501,
+000132a0: 2020 342e 3030 3935 3030 3334 2c20 2d31    4.00950034, -1
+000132b0: 2e38 3138 3134 3836 372c 2020 372e 3239  .81814867,  7.29
+000132c0: 3731 3836 3737 5d2c 2020 2023 2072 616e  718677],   # ran
+000132d0: 646f 6d0d 0a20 2020 2020 2020 2020 5b20  dom..         [ 
+000132e0: 302e 3339 3932 3438 3034 2c20 2034 2e36  0.39924804,  4.6
+000132f0: 3834 3536 3331 362c 2020 342e 3939 3339  8456316,  4.9939
+00013300: 3435 3239 2c20 2034 2e38 3430 3537 3235  4529,  4.8405725
+00013310: 345d 5d29 2020 2320 7261 6e64 6f6d 0d0a  4]])  # random..
+00013320: 2020 2222 220d 0a20 2072 6574 7572 6e20    """..  return 
+00013330: 4445 4641 554c 542e 6e6f 726d 616c 286c  DEFAULT.normal(l
+00013340: 6f63 2c20 7363 616c 652c 2073 697a 652c  oc, scale, size,
+00013350: 206b 6579 3d6b 6579 2c20 6474 7970 653d   key=key, dtype=
+00013360: 6474 7970 6529 0d0a 0d0a 0d0a 6465 6620  dtype)......def 
+00013370: 7061 7265 746f 2861 2c20 7369 7a65 3a20  pareto(a, size: 
+00013380: 4f70 7469 6f6e 616c 5b53 697a 655d 203d  Optional[Size] =
+00013390: 204e 6f6e 652c 206b 6579 3a20 4f70 7469   None, key: Opti
+000133a0: 6f6e 616c 5b53 6565 644f 724b 6579 5d20  onal[SeedOrKey] 
+000133b0: 3d20 4e6f 6e65 2c20 6474 7970 653a 2044  = None, dtype: D
+000133c0: 5479 7065 4c69 6b65 203d 204e 6f6e 6529  TypeLike = None)
+000133d0: 3a0d 0a20 2072 2222 220d 0a20 2044 7261  :..  r"""..  Dra
+000133e0: 7720 7361 6d70 6c65 7320 6672 6f6d 2061  w samples from a
+000133f0: 2050 6172 6574 6f20 4949 206f 7220 4c6f   Pareto II or Lo
+00013400: 6d61 7820 6469 7374 7269 6275 7469 6f6e  max distribution
+00013410: 2077 6974 680d 0a20 2073 7065 6369 6669   with..  specifi
+00013420: 6564 2073 6861 7065 2e0d 0a0d 0a20 2054  ed shape.....  T
+00013430: 6865 204c 6f6d 6178 206f 7220 5061 7265  he Lomax or Pare
+00013440: 746f 2049 4920 6469 7374 7269 6275 7469  to II distributi
+00013450: 6f6e 2069 7320 6120 7368 6966 7465 6420  on is a shifted 
+00013460: 5061 7265 746f 0d0a 2020 6469 7374 7269  Pareto..  distri
+00013470: 6275 7469 6f6e 2e20 5468 6520 636c 6173  bution. The clas
+00013480: 7369 6361 6c20 5061 7265 746f 2064 6973  sical Pareto dis
+00013490: 7472 6962 7574 696f 6e20 6361 6e20 6265  tribution can be
+000134a0: 0d0a 2020 6f62 7461 696e 6564 2066 726f  ..  obtained fro
+000134b0: 6d20 7468 6520 4c6f 6d61 7820 6469 7374  m the Lomax dist
+000134c0: 7269 6275 7469 6f6e 2062 7920 6164 6469  ribution by addi
+000134d0: 6e67 2031 2061 6e64 0d0a 2020 6d75 6c74  ng 1 and..  mult
+000134e0: 6970 6c79 696e 6720 6279 2074 6865 2073  iplying by the s
+000134f0: 6361 6c65 2070 6172 616d 6574 6572 2060  cale parameter `
+00013500: 606d 6060 2028 7365 6520 4e6f 7465 7329  `m`` (see Notes)
+00013510: 2e20 2054 6865 0d0a 2020 736d 616c 6c65  .  The..  smalle
+00013520: 7374 2076 616c 7565 206f 6620 7468 6520  st value of the 
+00013530: 4c6f 6d61 7820 6469 7374 7269 6275 7469  Lomax distributi
+00013540: 6f6e 2069 7320 7a65 726f 2077 6869 6c65  on is zero while
+00013550: 2066 6f72 2074 6865 0d0a 2020 636c 6173   for the..  clas
+00013560: 7369 6361 6c20 5061 7265 746f 2064 6973  sical Pareto dis
+00013570: 7472 6962 7574 696f 6e20 6974 2069 7320  tribution it is 
+00013580: 6060 6d75 6060 2c20 7768 6572 6520 7468  ``mu``, where th
+00013590: 6520 7374 616e 6461 7264 0d0a 2020 5061  e standard..  Pa
+000135a0: 7265 746f 2064 6973 7472 6962 7574 696f  reto distributio
+000135b0: 6e20 6861 7320 6c6f 6361 7469 6f6e 2060  n has location `
+000135c0: 606d 7520 3d20 3160 602e 2020 4c6f 6d61  `mu = 1``.  Loma
+000135d0: 7820 6361 6e20 616c 736f 0d0a 2020 6265  x can also..  be
+000135e0: 2063 6f6e 7369 6465 7265 6420 6173 2061   considered as a
+000135f0: 2073 696d 706c 6966 6965 6420 7665 7273   simplified vers
+00013600: 696f 6e20 6f66 2074 6865 2047 656e 6572  ion of the Gener
+00013610: 616c 697a 6564 0d0a 2020 5061 7265 746f  alized..  Pareto
+00013620: 2064 6973 7472 6962 7574 696f 6e20 2861   distribution (a
+00013630: 7661 696c 6162 6c65 2069 6e20 5363 6950  vailable in SciP
+00013640: 7929 2c20 7769 7468 2074 6865 2073 6361  y), with the sca
+00013650: 6c65 2073 6574 0d0a 2020 746f 206f 6e65  le set..  to one
+00013660: 2061 6e64 2074 6865 206c 6f63 6174 696f   and the locatio
+00013670: 6e20 7365 7420 746f 207a 6572 6f2e 0d0a  n set to zero...
+00013680: 0d0a 2020 5468 6520 5061 7265 746f 2064  ..  The Pareto d
+00013690: 6973 7472 6962 7574 696f 6e20 6d75 7374  istribution must
+000136a0: 2062 6520 6772 6561 7465 7220 7468 616e   be greater than
+000136b0: 207a 6572 6f2c 2061 6e64 2069 730d 0a20   zero, and is.. 
+000136c0: 2075 6e62 6f75 6e64 6564 2061 626f 7665   unbounded above
+000136d0: 2e20 2049 7420 6973 2061 6c73 6f20 6b6e  .  It is also kn
+000136e0: 6f77 6e20 6173 2074 6865 2022 3830 2d32  own as the "80-2
+000136f0: 3020 7275 6c65 222e 2020 496e 0d0a 2020  0 rule".  In..  
+00013700: 7468 6973 2064 6973 7472 6962 7574 696f  this distributio
+00013710: 6e2c 2038 3020 7065 7263 656e 7420 6f66  n, 80 percent of
+00013720: 2074 6865 2077 6569 6768 7473 2061 7265   the weights are
+00013730: 2069 6e20 7468 6520 6c6f 7765 7374 0d0a   in the lowest..
+00013740: 2020 3230 2070 6572 6365 6e74 206f 6620    20 percent of 
+00013750: 7468 6520 7261 6e67 652c 2077 6869 6c65  the range, while
+00013760: 2074 6865 206f 7468 6572 2032 3020 7065   the other 20 pe
+00013770: 7263 656e 7420 6669 6c6c 2074 6865 0d0a  rcent fill the..
+00013780: 2020 7265 6d61 696e 696e 6720 3830 2070    remaining 80 p
+00013790: 6572 6365 6e74 206f 6620 7468 6520 7261  ercent of the ra
+000137a0: 6e67 652e 0d0a 0d0a 2020 5061 7261 6d65  nge.....  Parame
+000137b0: 7465 7273 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ters..  --------
+000137c0: 2d2d 0d0a 2020 6120 3a20 666c 6f61 7420  --..  a : float 
+000137d0: 6f72 2061 7272 6179 5f6c 696b 6520 6f66  or array_like of
+000137e0: 2066 6c6f 6174 730d 0a20 2020 2020 2053   floats..      S
+000137f0: 6861 7065 206f 6620 7468 6520 6469 7374  hape of the dist
+00013800: 7269 6275 7469 6f6e 2e20 4d75 7374 2062  ribution. Must b
+00013810: 6520 706f 7369 7469 7665 2e0d 0a20 2073  e positive...  s
+00013820: 697a 6520 3a20 696e 7420 6f72 2074 7570  ize : int or tup
+00013830: 6c65 206f 6620 696e 7473 2c20 6f70 7469  le of ints, opti
+00013840: 6f6e 616c 0d0a 2020 2020 2020 4f75 7470  onal..      Outp
+00013850: 7574 2073 6861 7065 2e20 2049 6620 7468  ut shape.  If th
+00013860: 6520 6769 7665 6e20 7368 6170 6520 6973  e given shape is
+00013870: 2c20 652e 672e 2c20 6060 286d 2c20 6e2c  , e.g., ``(m, n,
+00013880: 206b 2960 602c 2074 6865 6e0d 0a20 2020   k)``, then..   
+00013890: 2020 2060 606d 202a 206e 202a 206b 6060     ``m * n * k``
+000138a0: 2073 616d 706c 6573 2061 7265 2064 7261   samples are dra
+000138b0: 776e 2e20 2049 6620 7369 7a65 2069 7320  wn.  If size is 
+000138c0: 6060 4e6f 6e65 6060 2028 6465 6661 756c  ``None`` (defaul
+000138d0: 7429 2c0d 0a20 2020 2020 2061 2073 696e  t),..      a sin
+000138e0: 676c 6520 7661 6c75 6520 6973 2072 6574  gle value is ret
+000138f0: 7572 6e65 6420 6966 2060 6061 6060 2069  urned if ``a`` i
+00013900: 7320 6120 7363 616c 6172 2e20 204f 7468  s a scalar.  Oth
+00013910: 6572 7769 7365 2c0d 0a20 2020 2020 2060  erwise,..      `
+00013920: 606e 702e 6172 7261 7928 6129 2e73 697a  `np.array(a).siz
+00013930: 6560 6020 7361 6d70 6c65 7320 6172 6520  e`` samples are 
+00013940: 6472 6177 6e2e 0d0a 2020 6b65 7920 3a20  drawn...  key : 
+00013950: 5052 4e47 4b65 792c 206f 7074 696f 6e61  PRNGKey, optiona
+00013960: 6c0d 0a20 2020 2020 2054 6865 206b 6579  l..      The key
+00013970: 2066 6f72 2074 6865 2072 616e 646f 6d20   for the random 
+00013980: 6e75 6d62 6572 2067 656e 6572 6174 6f72  number generator
+00013990: 2e20 4966 206e 6f74 2067 6976 656e 2c20  . If not given, 
+000139a0: 7468 650d 0a20 2020 2020 2064 6566 6175  the..      defau
+000139b0: 6c74 2072 616e 646f 6d20 6e75 6d62 6572  lt random number
+000139c0: 2067 656e 6572 6174 6f72 2069 7320 7573   generator is us
+000139d0: 6564 2e0d 0a0d 0a20 2052 6574 7572 6e73  ed.....  Returns
+000139e0: 0d0a 2020 2d2d 2d2d 2d2d 2d0d 0a20 206f  ..  -------..  o
+000139f0: 7574 203a 206e 6461 7272 6179 206f 7220  ut : ndarray or 
+00013a00: 7363 616c 6172 0d0a 2020 2020 2020 4472  scalar..      Dr
+00013a10: 6177 6e20 7361 6d70 6c65 7320 6672 6f6d  awn samples from
+00013a20: 2074 6865 2070 6172 616d 6574 6572 697a   the parameteriz
+00013a30: 6564 2050 6172 6574 6f20 6469 7374 7269  ed Pareto distri
+00013a40: 6275 7469 6f6e 2e0d 0a0d 0a20 2053 6565  bution.....  See
+00013a50: 2041 6c73 6f0d 0a20 202d 2d2d 2d2d 2d2d   Also..  -------
+00013a60: 2d0d 0a20 2073 6369 7079 2e73 7461 7473  -..  scipy.stats
+00013a70: 2e6c 6f6d 6178 203a 2070 726f 6261 6269  .lomax : probabi
+00013a80: 6c69 7479 2064 656e 7369 7479 2066 756e  lity density fun
+00013a90: 6374 696f 6e2c 2064 6973 7472 6962 7574  ction, distribut
+00013aa0: 696f 6e20 6f72 0d0a 2020 2020 2020 6375  ion or..      cu
+00013ab0: 6d75 6c61 7469 7665 2064 656e 7369 7479  mulative density
+00013ac0: 2066 756e 6374 696f 6e2c 2065 7463 2e0d   function, etc..
+00013ad0: 0a20 2073 6369 7079 2e73 7461 7473 2e67  .  scipy.stats.g
+00013ae0: 656e 7061 7265 746f 203a 2070 726f 6261  enpareto : proba
+00013af0: 6269 6c69 7479 2064 656e 7369 7479 2066  bility density f
+00013b00: 756e 6374 696f 6e2c 2064 6973 7472 6962  unction, distrib
+00013b10: 7574 696f 6e20 6f72 0d0a 2020 2020 2020  ution or..      
+00013b20: 6375 6d75 6c61 7469 7665 2064 656e 7369  cumulative densi
+00013b30: 7479 2066 756e 6374 696f 6e2c 2065 7463  ty function, etc
+00013b40: 2e0d 0a0d 0a20 204e 6f74 6573 0d0a 2020  .....  Notes..  
+00013b50: 2d2d 2d2d 2d0d 0a20 2054 6865 2070 726f  -----..  The pro
+00013b60: 6261 6269 6c69 7479 2064 656e 7369 7479  bability density
+00013b70: 2066 6f72 2074 6865 2050 6172 6574 6f20   for the Pareto 
+00013b80: 6469 7374 7269 6275 7469 6f6e 2069 730d  distribution is.
+00013b90: 0a0d 0a20 202e 2e20 6d61 7468 3a3a 2070  ...  .. math:: p
+00013ba0: 2878 2920 3d20 5c66 7261 637b 616d 5e61  (x) = \frac{am^a
+00013bb0: 7d7b 785e 7b61 2b31 7d7d 0d0a 0d0a 2020  }{x^{a+1}}....  
+00013bc0: 7768 6572 6520 3a6d 6174 683a 6061 6020  where :math:`a` 
+00013bd0: 6973 2074 6865 2073 6861 7065 2061 6e64  is the shape and
+00013be0: 203a 6d61 7468 3a60 6d60 2074 6865 2073   :math:`m` the s
+00013bf0: 6361 6c65 2e0d 0a0d 0a20 2054 6865 2050  cale.....  The P
+00013c00: 6172 6574 6f20 6469 7374 7269 6275 7469  areto distributi
+00013c10: 6f6e 2c20 6e61 6d65 6420 6166 7465 7220  on, named after 
+00013c20: 7468 6520 4974 616c 6961 6e20 6563 6f6e  the Italian econ
+00013c30: 6f6d 6973 740d 0a20 2056 696c 6672 6564  omist..  Vilfred
+00013c40: 6f20 5061 7265 746f 2c20 6973 2061 2070  o Pareto, is a p
+00013c50: 6f77 6572 206c 6177 2070 726f 6261 6269  ower law probabi
+00013c60: 6c69 7479 2064 6973 7472 6962 7574 696f  lity distributio
+00013c70: 6e0d 0a20 2075 7365 6675 6c20 696e 206d  n..  useful in m
+00013c80: 616e 7920 7265 616c 2077 6f72 6c64 2070  any real world p
+00013c90: 726f 626c 656d 732e 2020 4f75 7473 6964  roblems.  Outsid
+00013ca0: 6520 7468 6520 6669 656c 6420 6f66 0d0a  e the field of..
+00013cb0: 2020 6563 6f6e 6f6d 6963 7320 6974 2069    economics it i
+00013cc0: 7320 6765 6e65 7261 6c6c 7920 7265 6665  s generally refe
+00013cd0: 7272 6564 2074 6f20 6173 2074 6865 2042  rred to as the B
+00013ce0: 7261 6466 6f72 640d 0a20 2064 6973 7472  radford..  distr
+00013cf0: 6962 7574 696f 6e2e 2050 6172 6574 6f20  ibution. Pareto 
+00013d00: 6465 7665 6c6f 7065 6420 7468 6520 6469  developed the di
+00013d10: 7374 7269 6275 7469 6f6e 2074 6f20 6465  stribution to de
+00013d20: 7363 7269 6265 0d0a 2020 7468 6520 6469  scribe..  the di
+00013d30: 7374 7269 6275 7469 6f6e 206f 6620 7765  stribution of we
+00013d40: 616c 7468 2069 6e20 616e 2065 636f 6e6f  alth in an econo
+00013d50: 6d79 2e20 2049 7420 6861 7320 616c 736f  my.  It has also
+00013d60: 2066 6f75 6e64 0d0a 2020 7573 6520 696e   found..  use in
+00013d70: 2069 6e73 7572 616e 6365 2c20 7765 6220   insurance, web 
+00013d80: 7061 6765 2061 6363 6573 7320 7374 6174  page access stat
+00013d90: 6973 7469 6373 2c20 6f69 6c20 6669 656c  istics, oil fiel
+00013da0: 6420 7369 7a65 732c 0d0a 2020 616e 6420  d sizes,..  and 
+00013db0: 6d61 6e79 206f 7468 6572 2070 726f 626c  many other probl
+00013dc0: 656d 732c 2069 6e63 6c75 6469 6e67 2074  ems, including t
+00013dd0: 6865 2064 6f77 6e6c 6f61 6420 6672 6571  he download freq
+00013de0: 7565 6e63 7920 666f 720d 0a20 2070 726f  uency for..  pro
+00013df0: 6a65 6374 7320 696e 2053 6f75 7263 6566  jects in Sourcef
+00013e00: 6f72 6765 205b 315d 5f2e 2020 4974 2069  orge [1]_.  It i
+00013e10: 7320 6f6e 6520 6f66 2074 6865 2073 6f2d  s one of the so-
+00013e20: 6361 6c6c 6564 0d0a 2020 2266 6174 2d74  called..  "fat-t
+00013e30: 6169 6c65 6422 2064 6973 7472 6962 7574  ailed" distribut
+00013e40: 696f 6e73 2e0d 0a0d 0a20 2052 6566 6572  ions.....  Refer
+00013e50: 656e 6365 730d 0a20 202d 2d2d 2d2d 2d2d  ences..  -------
+00013e60: 2d2d 2d0d 0a20 202e 2e20 5b31 5d20 4672  ---..  .. [1] Fr
+00013e70: 616e 6369 7320 4875 6e74 2061 6e64 2050  ancis Hunt and P
+00013e80: 6175 6c20 4a6f 686e 736f 6e2c 204f 6e20  aul Johnson, On 
+00013e90: 7468 6520 5061 7265 746f 2044 6973 7472  the Pareto Distr
+00013ea0: 6962 7574 696f 6e20 6f66 0d0a 2020 2020  ibution of..    
+00013eb0: 2020 2020 2053 6f75 7263 6566 6f72 6765       Sourceforge
+00013ec0: 2070 726f 6a65 6374 732e 0d0a 2020 2e2e   projects...  ..
+00013ed0: 205b 325d 2050 6172 6574 6f2c 2056 2e20   [2] Pareto, V. 
+00013ee0: 2831 3839 3629 2e20 436f 7572 7365 206f  (1896). Course o
+00013ef0: 6620 506f 6c69 7469 6361 6c20 4563 6f6e  f Political Econ
+00013f00: 6f6d 792e 204c 6175 7361 6e6e 652e 0d0a  omy. Lausanne...
+00013f10: 2020 2e2e 205b 335d 2052 6569 7373 2c20    .. [3] Reiss, 
+00013f20: 522e 442e 2c20 5468 6f6d 6173 2c20 4d2e  R.D., Thomas, M.
+00013f30: 2832 3030 3129 2c20 5374 6174 6973 7469  (2001), Statisti
+00013f40: 6361 6c20 416e 616c 7973 6973 206f 6620  cal Analysis of 
+00013f50: 4578 7472 656d 650d 0a20 2020 2020 2020  Extreme..       
+00013f60: 2020 5661 6c75 6573 2c20 4269 726b 6861    Values, Birkha
+00013f70: 7573 6572 2056 6572 6c61 672c 2042 6173  user Verlag, Bas
+00013f80: 656c 2c20 7070 2032 332d 3330 2e0d 0a20  el, pp 23-30... 
+00013f90: 202e 2e20 5b34 5d20 5769 6b69 7065 6469   .. [4] Wikipedi
+00013fa0: 612c 2022 5061 7265 746f 2064 6973 7472  a, "Pareto distr
+00013fb0: 6962 7574 696f 6e22 2c0d 0a20 2020 2020  ibution",..     
+00013fc0: 2020 2020 6874 7470 733a 2f2f 656e 2e77      https://en.w
+00013fd0: 696b 6970 6564 6961 2e6f 7267 2f77 696b  ikipedia.org/wik
+00013fe0: 692f 5061 7265 746f 5f64 6973 7472 6962  i/Pareto_distrib
+00013ff0: 7574 696f 6e0d 0a0d 0a20 2045 7861 6d70  ution....  Examp
+00014000: 6c65 730d 0a20 202d 2d2d 2d2d 2d2d 2d0d  les..  --------.
+00014010: 0a20 2044 7261 7720 7361 6d70 6c65 7320  .  Draw samples 
+00014020: 6672 6f6d 2074 6865 2064 6973 7472 6962  from the distrib
+00014030: 7574 696f 6e3a 0d0a 0d0a 2020 3e3e 3e20  ution:....  >>> 
+00014040: 612c 206d 203d 2033 2e2c 2032 2e20 2023  a, m = 3., 2.  #
+00014050: 2073 6861 7065 2061 6e64 206d 6f64 650d   shape and mode.
+00014060: 0a20 203e 3e3e 2073 203d 2028 6272 6169  .  >>> s = (brai
+00014070: 6e63 6f72 652e 7261 6e64 6f6d 2e70 6172  ncore.random.par
+00014080: 6574 6f28 612c 2031 3030 3029 202b 2031  eto(a, 1000) + 1
+00014090: 2920 2a20 6d0d 0a0d 0a20 2044 6973 706c  ) * m....  Displ
+000140a0: 6179 2074 6865 2068 6973 746f 6772 616d  ay the histogram
+000140b0: 206f 6620 7468 6520 7361 6d70 6c65 732c   of the samples,
+000140c0: 2061 6c6f 6e67 2077 6974 6820 7468 6520   along with the 
+000140d0: 7072 6f62 6162 696c 6974 790d 0a20 2064  probability..  d
+000140e0: 656e 7369 7479 2066 756e 6374 696f 6e3a  ensity function:
+000140f0: 0d0a 0d0a 2020 3e3e 3e20 696d 706f 7274  ....  >>> import
+00014100: 206d 6174 706c 6f74 6c69 622e 7079 706c   matplotlib.pypl
+00014110: 6f74 2061 7320 706c 7420 2023 206e 6f71  ot as plt  # noq
+00014120: 610d 0a20 203e 3e3e 2063 6f75 6e74 2c20  a..  >>> count, 
+00014130: 6269 6e73 2c20 5f20 3d20 706c 742e 6869  bins, _ = plt.hi
+00014140: 7374 2873 2c20 3130 302c 2064 656e 7369  st(s, 100, densi
+00014150: 7479 3d54 7275 6529 0d0a 2020 3e3e 3e20  ty=True)..  >>> 
+00014160: 6669 7420 3d20 612a 6d2a 2a61 202f 2062  fit = a*m**a / b
+00014170: 696e 732a 2a28 612b 3129 0d0a 2020 3e3e  ins**(a+1)..  >>
+00014180: 3e20 706c 742e 706c 6f74 2862 696e 732c  > plt.plot(bins,
+00014190: 206d 6178 2863 6f75 6e74 292a 6669 742f   max(count)*fit/
+000141a0: 6d61 7828 6669 7429 2c20 6c69 6e65 7769  max(fit), linewi
+000141b0: 6474 683d 322c 2063 6f6c 6f72 3d27 7227  dth=2, color='r'
+000141c0: 290d 0a20 203e 3e3e 2070 6c74 2e73 686f  )..  >>> plt.sho
+000141d0: 7728 290d 0a20 2022 2222 0d0a 2020 7265  w()..  """..  re
+000141e0: 7475 726e 2044 4546 4155 4c54 2e70 6172  turn DEFAULT.par
+000141f0: 6574 6f28 612c 2073 697a 652c 206b 6579  eto(a, size, key
+00014200: 3d6b 6579 2c20 6474 7970 653d 6474 7970  =key, dtype=dtyp
+00014210: 6529 0d0a 0d0a 0d0a 6465 6620 706f 6973  e)......def pois
+00014220: 736f 6e28 6c61 6d3d 312e 302c 2073 697a  son(lam=1.0, siz
+00014230: 653a 204f 7074 696f 6e61 6c5b 5369 7a65  e: Optional[Size
+00014240: 5d20 3d20 4e6f 6e65 2c20 6b65 793a 204f  ] = None, key: O
+00014250: 7074 696f 6e61 6c5b 5365 6564 4f72 4b65  ptional[SeedOrKe
+00014260: 795d 203d 204e 6f6e 652c 2064 7479 7065  y] = None, dtype
+00014270: 3a20 4454 7970 654c 696b 6520 3d20 4e6f  : DTypeLike = No
+00014280: 6e65 293a 0d0a 2020 7222 2222 0d0a 2020  ne):..  r"""..  
+00014290: 4472 6177 2073 616d 706c 6573 2066 726f  Draw samples fro
+000142a0: 6d20 6120 506f 6973 736f 6e20 6469 7374  m a Poisson dist
+000142b0: 7269 6275 7469 6f6e 2e0d 0a0d 0a20 2054  ribution.....  T
+000142c0: 6865 2050 6f69 7373 6f6e 2064 6973 7472  he Poisson distr
+000142d0: 6962 7574 696f 6e20 6973 2074 6865 206c  ibution is the l
+000142e0: 696d 6974 206f 6620 7468 6520 6269 6e6f  imit of the bino
+000142f0: 6d69 616c 2064 6973 7472 6962 7574 696f  mial distributio
+00014300: 6e0d 0a20 2066 6f72 206c 6172 6765 204e  n..  for large N
+00014310: 2e0d 0a0d 0a20 2050 6172 616d 6574 6572  .....  Parameter
+00014320: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
+00014330: 0a20 206c 616d 203a 2066 6c6f 6174 206f  .  lam : float o
+00014340: 7220 6172 7261 795f 6c69 6b65 206f 6620  r array_like of 
+00014350: 666c 6f61 7473 0d0a 2020 2020 2020 4578  floats..      Ex
+00014360: 7065 6374 6564 206e 756d 6265 7220 6f66  pected number of
+00014370: 2065 7665 6e74 7320 6f63 6375 7272 696e   events occurrin
+00014380: 6720 696e 2061 2066 6978 6564 2d74 696d  g in a fixed-tim
+00014390: 6520 696e 7465 7276 616c 2c0d 0a20 2020  e interval,..   
+000143a0: 2020 206d 7573 7420 6265 203e 3d20 302e     must be >= 0.
+000143b0: 2041 2073 6571 7565 6e63 6520 6d75 7374   A sequence must
+000143c0: 2062 6520 6272 6f61 6463 6173 7461 626c   be broadcastabl
+000143d0: 6520 6f76 6572 2074 6865 2072 6571 7565  e over the reque
+000143e0: 7374 6564 0d0a 2020 2020 2020 7369 7a65  sted..      size
+000143f0: 2e0d 0a20 2073 697a 6520 3a20 696e 7420  ...  size : int 
+00014400: 6f72 2074 7570 6c65 206f 6620 696e 7473  or tuple of ints
+00014410: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+00014420: 2020 4f75 7470 7574 2073 6861 7065 2e20    Output shape. 
+00014430: 2049 6620 7468 6520 6769 7665 6e20 7368   If the given sh
+00014440: 6170 6520 6973 2c20 652e 672e 2c20 6060  ape is, e.g., ``
+00014450: 286d 2c20 6e2c 206b 2960 602c 2074 6865  (m, n, k)``, the
+00014460: 6e0d 0a20 2020 2020 2060 606d 202a 206e  n..      ``m * n
+00014470: 202a 206b 6060 2073 616d 706c 6573 2061   * k`` samples a
+00014480: 7265 2064 7261 776e 2e20 2049 6620 7369  re drawn.  If si
+00014490: 7a65 2069 7320 6060 4e6f 6e65 6060 2028  ze is ``None`` (
+000144a0: 6465 6661 756c 7429 2c0d 0a20 2020 2020  default),..     
+000144b0: 2061 2073 696e 676c 6520 7661 6c75 6520   a single value 
+000144c0: 6973 2072 6574 7572 6e65 6420 6966 2060  is returned if `
+000144d0: 606c 616d 6060 2069 7320 6120 7363 616c  `lam`` is a scal
+000144e0: 6172 2e20 4f74 6865 7277 6973 652c 0d0a  ar. Otherwise,..
+000144f0: 2020 2020 2020 6060 6e70 2e61 7272 6179        ``np.array
+00014500: 286c 616d 292e 7369 7a65 6060 2073 616d  (lam).size`` sam
+00014510: 706c 6573 2061 7265 2064 7261 776e 2e0d  ples are drawn..
+00014520: 0a20 206b 6579 203a 2050 524e 474b 6579  .  key : PRNGKey
+00014530: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+00014540: 2020 5468 6520 6b65 7920 666f 7220 7468    The key for th
+00014550: 6520 7261 6e64 6f6d 206e 756d 6265 7220  e random number 
+00014560: 6765 6e65 7261 746f 722e 2049 6620 6e6f  generator. If no
+00014570: 7420 6769 7665 6e2c 2074 6865 0d0a 2020  t given, the..  
+00014580: 2020 2020 6465 6661 756c 7420 7261 6e64      default rand
+00014590: 6f6d 206e 756d 6265 7220 6765 6e65 7261  om number genera
+000145a0: 746f 7220 6973 2075 7365 642e 0d0a 0d0a  tor is used.....
+000145b0: 2020 5265 7475 726e 730d 0a20 202d 2d2d    Returns..  ---
+000145c0: 2d2d 2d2d 0d0a 2020 6f75 7420 3a20 6e64  ----..  out : nd
+000145d0: 6172 7261 7920 6f72 2073 6361 6c61 720d  array or scalar.
+000145e0: 0a20 2020 2020 2044 7261 776e 2073 616d  .      Drawn sam
+000145f0: 706c 6573 2066 726f 6d20 7468 6520 7061  ples from the pa
+00014600: 7261 6d65 7465 7269 7a65 6420 506f 6973  rameterized Pois
+00014610: 736f 6e20 6469 7374 7269 6275 7469 6f6e  son distribution
+00014620: 2e0d 0a0d 0a20 204e 6f74 6573 0d0a 2020  .....  Notes..  
+00014630: 2d2d 2d2d 2d0d 0a20 2054 6865 2050 6f69  -----..  The Poi
+00014640: 7373 6f6e 2064 6973 7472 6962 7574 696f  sson distributio
+00014650: 6e0d 0a0d 0a20 202e 2e20 6d61 7468 3a3a  n....  .. math::
+00014660: 2066 286b 3b20 5c6c 616d 6264 6129 3d5c   f(k; \lambda)=\
+00014670: 6672 6163 7b5c 6c61 6d62 6461 5e6b 2065  frac{\lambda^k e
+00014680: 5e7b 2d5c 6c61 6d62 6461 7d7d 7b6b 217d  ^{-\lambda}}{k!}
+00014690: 0d0a 0d0a 2020 466f 7220 6576 656e 7473  ....  For events
+000146a0: 2077 6974 6820 616e 2065 7870 6563 7465   with an expecte
+000146b0: 6420 7365 7061 7261 7469 6f6e 203a 6d61  d separation :ma
+000146c0: 7468 3a60 5c6c 616d 6264 6160 2074 6865  th:`\lambda` the
+000146d0: 2050 6f69 7373 6f6e 0d0a 2020 6469 7374   Poisson..  dist
+000146e0: 7269 6275 7469 6f6e 203a 6d61 7468 3a60  ribution :math:`
+000146f0: 6628 6b3b 205c 6c61 6d62 6461 2960 2064  f(k; \lambda)` d
+00014700: 6573 6372 6962 6573 2074 6865 2070 726f  escribes the pro
+00014710: 6261 6269 6c69 7479 206f 660d 0a20 203a  bability of..  :
+00014720: 6d61 7468 3a60 6b60 2065 7665 6e74 7320  math:`k` events 
+00014730: 6f63 6375 7272 696e 6720 7769 7468 696e  occurring within
+00014740: 2074 6865 206f 6273 6572 7665 640d 0a20   the observed.. 
+00014750: 2069 6e74 6572 7661 6c20 3a6d 6174 683a   interval :math:
+00014760: 605c 6c61 6d62 6461 602e 0d0a 0d0a 2020  `\lambda`.....  
+00014770: 4265 6361 7573 6520 7468 6520 6f75 7470  Because the outp
+00014780: 7574 2069 7320 6c69 6d69 7465 6420 746f  ut is limited to
+00014790: 2074 6865 2072 616e 6765 206f 6620 7468   the range of th
+000147a0: 6520 4320 696e 7436 3420 7479 7065 2c20  e C int64 type, 
+000147b0: 610d 0a20 2056 616c 7565 4572 726f 7220  a..  ValueError 
+000147c0: 6973 2072 6169 7365 6420 7768 656e 2060  is raised when `
+000147d0: 6c61 6d60 2069 7320 7769 7468 696e 2031  lam` is within 1
+000147e0: 3020 7369 676d 6120 6f66 2074 6865 206d  0 sigma of the m
+000147f0: 6178 696d 756d 0d0a 2020 7265 7072 6573  aximum..  repres
+00014800: 656e 7461 626c 6520 7661 6c75 652e 0d0a  entable value...
+00014810: 0d0a 2020 5265 6665 7265 6e63 6573 0d0a  ..  References..
+00014820: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+00014830: 2e2e 205b 315d 2057 6569 7373 7465 696e  .. [1] Weisstein
+00014840: 2c20 4572 6963 2057 2e20 2250 6f69 7373  , Eric W. "Poiss
+00014850: 6f6e 2044 6973 7472 6962 7574 696f 6e2e  on Distribution.
+00014860: 220d 0a20 2020 2020 2020 2020 4672 6f6d  "..         From
+00014870: 204d 6174 6857 6f72 6c64 2d2d 4120 576f   MathWorld--A Wo
+00014880: 6c66 7261 6d20 5765 6220 5265 736f 7572  lfram Web Resour
+00014890: 6365 2e0d 0a20 2020 2020 2020 2020 6874  ce...         ht
+000148a0: 7470 3a2f 2f6d 6174 6877 6f72 6c64 2e77  tp://mathworld.w
+000148b0: 6f6c 6672 616d 2e63 6f6d 2f50 6f69 7373  olfram.com/Poiss
+000148c0: 6f6e 4469 7374 7269 6275 7469 6f6e 2e68  onDistribution.h
+000148d0: 746d 6c0d 0a20 202e 2e20 5b32 5d20 5769  tml..  .. [2] Wi
+000148e0: 6b69 7065 6469 612c 2022 506f 6973 736f  kipedia, "Poisso
+000148f0: 6e20 6469 7374 7269 6275 7469 6f6e 222c  n distribution",
+00014900: 0d0a 2020 2020 2020 2020 2068 7474 7073  ..         https
+00014910: 3a2f 2f65 6e2e 7769 6b69 7065 6469 612e  ://en.wikipedia.
+00014920: 6f72 672f 7769 6b69 2f50 6f69 7373 6f6e  org/wiki/Poisson
+00014930: 5f64 6973 7472 6962 7574 696f 6e0d 0a0d  _distribution...
+00014940: 0a20 2045 7861 6d70 6c65 730d 0a20 202d  .  Examples..  -
+00014950: 2d2d 2d2d 2d2d 2d0d 0a20 2044 7261 7720  -------..  Draw 
+00014960: 7361 6d70 6c65 7320 6672 6f6d 2074 6865  samples from the
+00014970: 2064 6973 7472 6962 7574 696f 6e3a 0d0a   distribution:..
+00014980: 0d0a 2020 3e3e 3e20 696d 706f 7274 206e  ..  >>> import n
+00014990: 756d 7079 2061 7320 6e70 0d0a 2020 3e3e  umpy as np..  >>
+000149a0: 3e20 7320 3d20 6272 6169 6e63 6f72 652e  > s = braincore.
+000149b0: 7261 6e64 6f6d 2e70 6f69 7373 6f6e 2835  random.poisson(5
+000149c0: 2c20 3130 3030 3029 0d0a 0d0a 2020 4469  , 10000)....  Di
+000149d0: 7370 6c61 7920 6869 7374 6f67 7261 6d20  splay histogram 
+000149e0: 6f66 2074 6865 2073 616d 706c 653a 0d0a  of the sample:..
+000149f0: 0d0a 2020 3e3e 3e20 696d 706f 7274 206d  ..  >>> import m
+00014a00: 6174 706c 6f74 6c69 622e 7079 706c 6f74  atplotlib.pyplot
+00014a10: 2061 7320 706c 7420 2023 206e 6f71 610d   as plt  # noqa.
+00014a20: 0a20 203e 3e3e 2063 6f75 6e74 2c20 6269  .  >>> count, bi
+00014a30: 6e73 2c20 6967 6e6f 7265 6420 3d20 706c  ns, ignored = pl
+00014a40: 742e 6869 7374 2873 2c20 3134 2c20 6465  t.hist(s, 14, de
+00014a50: 6e73 6974 793d 5472 7565 290d 0a20 203e  nsity=True)..  >
+00014a60: 3e3e 2070 6c74 2e73 686f 7728 290d 0a0d  >> plt.show()...
+00014a70: 0a20 2044 7261 7720 6561 6368 2031 3030  .  Draw each 100
+00014a80: 2076 616c 7565 7320 666f 7220 6c61 6d62   values for lamb
+00014a90: 6461 2031 3030 2061 6e64 2035 3030 3a0d  da 100 and 500:.
+00014aa0: 0a0d 0a20 203e 3e3e 2073 203d 2062 7261  ...  >>> s = bra
+00014ab0: 696e 636f 7265 2e72 616e 646f 6d2e 706f  incore.random.po
+00014ac0: 6973 736f 6e28 6c61 6d3d 2831 3030 2e2c  isson(lam=(100.,
+00014ad0: 2035 3030 2e29 2c20 7369 7a65 3d28 3130   500.), size=(10
+00014ae0: 302c 2032 2929 0d0a 2020 2222 220d 0a20  0, 2))..  """.. 
+00014af0: 2072 6574 7572 6e20 4445 4641 554c 542e   return DEFAULT.
+00014b00: 706f 6973 736f 6e28 6c61 6d2c 2073 697a  poisson(lam, siz
+00014b10: 652c 206b 6579 3d6b 6579 2c20 6474 7970  e, key=key, dtyp
+00014b20: 653d 6474 7970 6529 0d0a 0d0a 0d0a 6465  e=dtype)......de
+00014b30: 6620 7374 616e 6461 7264 5f63 6175 6368  f standard_cauch
+00014b40: 7928 7369 7a65 3a20 4f70 7469 6f6e 616c  y(size: Optional
+00014b50: 5b53 697a 655d 203d 204e 6f6e 652c 206b  [Size] = None, k
+00014b60: 6579 3a20 4f70 7469 6f6e 616c 5b53 6565  ey: Optional[See
+00014b70: 644f 724b 6579 5d20 3d20 4e6f 6e65 2c20  dOrKey] = None, 
+00014b80: 6474 7970 653a 2044 5479 7065 4c69 6b65  dtype: DTypeLike
+00014b90: 203d 204e 6f6e 6529 3a0d 0a20 2072 2222   = None):..  r""
+00014ba0: 220d 0a20 2044 7261 7720 7361 6d70 6c65  "..  Draw sample
+00014bb0: 7320 6672 6f6d 2061 2073 7461 6e64 6172  s from a standar
+00014bc0: 6420 4361 7563 6879 2064 6973 7472 6962  d Cauchy distrib
+00014bd0: 7574 696f 6e20 7769 7468 206d 6f64 6520  ution with mode 
+00014be0: 3d20 302e 0d0a 0d0a 2020 416c 736f 206b  = 0.....  Also k
+00014bf0: 6e6f 776e 2061 7320 7468 6520 4c6f 7265  nown as the Lore
+00014c00: 6e74 7a20 6469 7374 7269 6275 7469 6f6e  ntz distribution
+00014c10: 2e0d 0a0d 0a20 2050 6172 616d 6574 6572  .....  Parameter
+00014c20: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
+00014c30: 0a20 2073 697a 6520 3a20 696e 7420 6f72  .  size : int or
+00014c40: 2074 7570 6c65 206f 6620 696e 7473 2c20   tuple of ints, 
+00014c50: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+00014c60: 4f75 7470 7574 2073 6861 7065 2e20 2049  Output shape.  I
+00014c70: 6620 7468 6520 6769 7665 6e20 7368 6170  f the given shap
+00014c80: 6520 6973 2c20 652e 672e 2c20 6060 286d  e is, e.g., ``(m
+00014c90: 2c20 6e2c 206b 2960 602c 2074 6865 6e0d  , n, k)``, then.
+00014ca0: 0a20 2020 2020 2060 606d 202a 206e 202a  .      ``m * n *
+00014cb0: 206b 6060 2073 616d 706c 6573 2061 7265   k`` samples are
+00014cc0: 2064 7261 776e 2e20 2044 6566 6175 6c74   drawn.  Default
+00014cd0: 2069 7320 4e6f 6e65 2c20 696e 2077 6869   is None, in whi
+00014ce0: 6368 2063 6173 6520 610d 0a20 2020 2020  ch case a..     
+00014cf0: 2073 696e 676c 6520 7661 6c75 6520 6973   single value is
+00014d00: 2072 6574 7572 6e65 642e 0d0a 2020 6b65   returned...  ke
+00014d10: 7920 3a20 5052 4e47 4b65 792c 206f 7074  y : PRNGKey, opt
+00014d20: 696f 6e61 6c0d 0a20 2020 2020 2054 6865  ional..      The
+00014d30: 206b 6579 2066 6f72 2074 6865 2072 616e   key for the ran
+00014d40: 646f 6d20 6e75 6d62 6572 2067 656e 6572  dom number gener
+00014d50: 6174 6f72 2e20 4966 206e 6f74 2067 6976  ator. If not giv
+00014d60: 656e 2c20 7468 650d 0a20 2020 2020 2064  en, the..      d
+00014d70: 6566 6175 6c74 2072 616e 646f 6d20 6e75  efault random nu
+00014d80: 6d62 6572 2067 656e 6572 6174 6f72 2069  mber generator i
+00014d90: 7320 7573 6564 2e0d 0a0d 0a20 2052 6574  s used.....  Ret
+00014da0: 7572 6e73 0d0a 2020 2d2d 2d2d 2d2d 2d0d  urns..  -------.
+00014db0: 0a20 2073 616d 706c 6573 203a 206e 6461  .  samples : nda
+00014dc0: 7272 6179 206f 7220 7363 616c 6172 0d0a  rray or scalar..
+00014dd0: 2020 2020 2020 5468 6520 6472 6177 6e20        The drawn 
+00014de0: 7361 6d70 6c65 732e 0d0a 0d0a 2020 4e6f  samples.....  No
+00014df0: 7465 730d 0a20 202d 2d2d 2d2d 0d0a 2020  tes..  -----..  
+00014e00: 5468 6520 7072 6f62 6162 696c 6974 7920  The probability 
+00014e10: 6465 6e73 6974 7920 6675 6e63 7469 6f6e  density function
+00014e20: 2066 6f72 2074 6865 2066 756c 6c20 4361   for the full Ca
+00014e30: 7563 6879 2064 6973 7472 6962 7574 696f  uchy distributio
+00014e40: 6e20 6973 0d0a 0d0a 2020 2e2e 206d 6174  n is....  .. mat
+00014e50: 683a 3a20 5028 783b 2078 5f30 2c20 5c67  h:: P(x; x_0, \g
+00014e60: 616d 6d61 2920 3d20 5c66 7261 637b 317d  amma) = \frac{1}
+00014e70: 7b5c 7069 205c 6761 6d6d 6120 5c62 6967  {\pi \gamma \big
+00014e80: 6c5b 2031 2b0d 0a20 2020 2020 2020 2020  l[ 1+..         
+00014e90: 2020 2028 5c66 7261 637b 782d 785f 307d     (\frac{x-x_0}
+00014ea0: 7b5c 6761 6d6d 617d 295e 3220 5c62 6967  {\gamma})^2 \big
+00014eb0: 725d 207d 0d0a 0d0a 2020 616e 6420 7468  r] }....  and th
+00014ec0: 6520 5374 616e 6461 7264 2043 6175 6368  e Standard Cauch
+00014ed0: 7920 6469 7374 7269 6275 7469 6f6e 206a  y distribution j
+00014ee0: 7573 7420 7365 7473 203a 6d61 7468 3a60  ust sets :math:`
+00014ef0: 785f 303d 3060 2061 6e64 0d0a 2020 3a6d  x_0=0` and..  :m
+00014f00: 6174 683a 605c 6761 6d6d 613d 3160 0d0a  ath:`\gamma=1`..
+00014f10: 0d0a 2020 5468 6520 4361 7563 6879 2064  ..  The Cauchy d
+00014f20: 6973 7472 6962 7574 696f 6e20 6172 6973  istribution aris
+00014f30: 6573 2069 6e20 7468 6520 736f 6c75 7469  es in the soluti
+00014f40: 6f6e 2074 6f20 7468 6520 6472 6976 656e  on to the driven
+00014f50: 2068 6172 6d6f 6e69 630d 0a20 206f 7363   harmonic..  osc
+00014f60: 696c 6c61 746f 7220 7072 6f62 6c65 6d2c  illator problem,
+00014f70: 2061 6e64 2061 6c73 6f20 6465 7363 7269   and also descri
+00014f80: 6265 7320 7370 6563 7472 616c 206c 696e  bes spectral lin
+00014f90: 6520 6272 6f61 6465 6e69 6e67 2e20 4974  e broadening. It
+00014fa0: 0d0a 2020 616c 736f 2064 6573 6372 6962  ..  also describ
+00014fb0: 6573 2074 6865 2064 6973 7472 6962 7574  es the distribut
+00014fc0: 696f 6e20 6f66 2076 616c 7565 7320 6174  ion of values at
+00014fd0: 2077 6869 6368 2061 206c 696e 6520 7469   which a line ti
+00014fe0: 6c74 6564 2061 740d 0a20 2061 2072 616e  lted at..  a ran
+00014ff0: 646f 6d20 616e 676c 6520 7769 6c6c 2063  dom angle will c
+00015000: 7574 2074 6865 2078 2061 7869 732e 0d0a  ut the x axis...
+00015010: 0d0a 2020 5768 656e 2073 7475 6479 696e  ..  When studyin
+00015020: 6720 6879 706f 7468 6573 6973 2074 6573  g hypothesis tes
+00015030: 7473 2074 6861 7420 6173 7375 6d65 206e  ts that assume n
+00015040: 6f72 6d61 6c69 7479 2c20 7365 6569 6e67  ormality, seeing
+00015050: 2068 6f77 2074 6865 0d0a 2020 7465 7374   how the..  test
+00015060: 7320 7065 7266 6f72 6d20 6f6e 2064 6174  s perform on dat
+00015070: 6120 6672 6f6d 2061 2043 6175 6368 7920  a from a Cauchy 
+00015080: 6469 7374 7269 6275 7469 6f6e 2069 7320  distribution is 
+00015090: 6120 676f 6f64 2069 6e64 6963 6174 6f72  a good indicator
+000150a0: 206f 660d 0a20 2074 6865 6972 2073 656e   of..  their sen
+000150b0: 7369 7469 7669 7479 2074 6f20 6120 6865  sitivity to a he
+000150c0: 6176 792d 7461 696c 6564 2064 6973 7472  avy-tailed distr
+000150d0: 6962 7574 696f 6e2c 2073 696e 6365 2074  ibution, since t
+000150e0: 6865 2043 6175 6368 7920 6c6f 6f6b 730d  he Cauchy looks.
+000150f0: 0a20 2076 6572 7920 6d75 6368 206c 696b  .  very much lik
+00015100: 6520 6120 4761 7573 7369 616e 2064 6973  e a Gaussian dis
+00015110: 7472 6962 7574 696f 6e2c 2062 7574 2077  tribution, but w
+00015120: 6974 6820 6865 6176 6965 7220 7461 696c  ith heavier tail
+00015130: 732e 0d0a 0d0a 2020 5265 6665 7265 6e63  s.....  Referenc
+00015140: 6573 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d  es..  ----------
+00015150: 0d0a 2020 2e2e 205b 315d 204e 4953 542f  ..  .. [1] NIST/
+00015160: 5345 4d41 5445 4348 2065 2d48 616e 6462  SEMATECH e-Handb
+00015170: 6f6f 6b20 6f66 2053 7461 7469 7374 6963  ook of Statistic
+00015180: 616c 204d 6574 686f 6473 2c20 2243 6175  al Methods, "Cau
+00015190: 6368 790d 0a20 2020 2020 2020 2044 6973  chy..        Dis
+000151a0: 7472 6962 7574 696f 6e22 2c0d 0a20 2020  tribution",..   
+000151b0: 2020 2020 2068 7474 7073 3a2f 2f77 7777       https://www
+000151c0: 2e69 746c 2e6e 6973 742e 676f 762f 6469  .itl.nist.gov/di
+000151d0: 7638 3938 2f68 616e 6462 6f6f 6b2f 6564  v898/handbook/ed
+000151e0: 612f 7365 6374 696f 6e33 2f65 6461 3336  a/section3/eda36
+000151f0: 3633 2e68 746d 0d0a 2020 2e2e 205b 325d  63.htm..  .. [2]
+00015200: 2057 6569 7373 7465 696e 2c20 4572 6963   Weisstein, Eric
+00015210: 2057 2e20 2243 6175 6368 7920 4469 7374   W. "Cauchy Dist
+00015220: 7269 6275 7469 6f6e 2e22 2046 726f 6d20  ribution." From 
+00015230: 4d61 7468 576f 726c 642d 2d41 0d0a 2020  MathWorld--A..  
+00015240: 2020 2020 2020 576f 6c66 7261 6d20 5765        Wolfram We
+00015250: 6220 5265 736f 7572 6365 2e0d 0a20 2020  b Resource...   
+00015260: 2020 2020 2068 7474 703a 2f2f 6d61 7468       http://math
+00015270: 776f 726c 642e 776f 6c66 7261 6d2e 636f  world.wolfram.co
+00015280: 6d2f 4361 7563 6879 4469 7374 7269 6275  m/CauchyDistribu
+00015290: 7469 6f6e 2e68 746d 6c0d 0a20 202e 2e20  tion.html..  .. 
+000152a0: 5b33 5d20 5769 6b69 7065 6469 612c 2022  [3] Wikipedia, "
+000152b0: 4361 7563 6879 2064 6973 7472 6962 7574  Cauchy distribut
+000152c0: 696f 6e22 0d0a 2020 2020 2020 2020 6874  ion"..        ht
+000152d0: 7470 733a 2f2f 656e 2e77 696b 6970 6564  tps://en.wikiped
+000152e0: 6961 2e6f 7267 2f77 696b 692f 4361 7563  ia.org/wiki/Cauc
+000152f0: 6879 5f64 6973 7472 6962 7574 696f 6e0d  hy_distribution.
+00015300: 0a0d 0a20 2045 7861 6d70 6c65 730d 0a20  ...  Examples.. 
+00015310: 202d 2d2d 2d2d 2d2d 2d0d 0a20 2044 7261   --------..  Dra
+00015320: 7720 7361 6d70 6c65 7320 616e 6420 706c  w samples and pl
+00015330: 6f74 2074 6865 2064 6973 7472 6962 7574  ot the distribut
+00015340: 696f 6e3a 0d0a 0d0a 2020 3e3e 3e20 696d  ion:....  >>> im
+00015350: 706f 7274 206d 6174 706c 6f74 6c69 622e  port matplotlib.
+00015360: 7079 706c 6f74 2061 7320 706c 7420 2023  pyplot as plt  #
+00015370: 206e 6f71 610d 0a20 203e 3e3e 2073 203d   noqa..  >>> s =
+00015380: 2062 7261 696e 636f 7265 2e72 616e 646f   braincore.rando
+00015390: 6d2e 7374 616e 6461 7264 5f63 6175 6368  m.standard_cauch
+000153a0: 7928 3130 3030 3030 3029 0d0a 2020 3e3e  y(1000000)..  >>
+000153b0: 3e20 7320 3d20 735b 2873 3e2d 3235 2920  > s = s[(s>-25) 
+000153c0: 2620 2873 3c32 3529 5d20 2023 2074 7275  & (s<25)]  # tru
+000153d0: 6e63 6174 6520 6469 7374 7269 6275 7469  ncate distributi
+000153e0: 6f6e 2073 6f20 6974 2070 6c6f 7473 2077  on so it plots w
+000153f0: 656c 6c0d 0a20 203e 3e3e 2070 6c74 2e68  ell..  >>> plt.h
+00015400: 6973 7428 732c 2062 696e 733d 3130 3029  ist(s, bins=100)
+00015410: 0d0a 2020 3e3e 3e20 706c 742e 7368 6f77  ..  >>> plt.show
+00015420: 2829 0d0a 2020 2222 220d 0a20 2072 6574  ()..  """..  ret
+00015430: 7572 6e20 4445 4641 554c 542e 7374 616e  urn DEFAULT.stan
+00015440: 6461 7264 5f63 6175 6368 7928 7369 7a65  dard_cauchy(size
+00015450: 2c20 6b65 793d 6b65 792c 2064 7479 7065  , key=key, dtype
+00015460: 3d64 7479 7065 290d 0a0d 0a0d 0a64 6566  =dtype)......def
+00015470: 2073 7461 6e64 6172 645f 6578 706f 6e65   standard_expone
+00015480: 6e74 6961 6c28 7369 7a65 3a20 4f70 7469  ntial(size: Opti
+00015490: 6f6e 616c 5b53 697a 655d 203d 204e 6f6e  onal[Size] = Non
+000154a0: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+000154b0: 2020 2020 2020 2020 2020 2020 206b 6579               key
+000154c0: 3a20 4f70 7469 6f6e 616c 5b53 6565 644f  : Optional[SeedO
+000154d0: 724b 6579 5d20 3d20 4e6f 6e65 2c0d 0a20  rKey] = None,.. 
+000154e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000154f0: 2020 2020 2020 2020 6474 7970 653a 2044          dtype: D
+00015500: 5479 7065 4c69 6b65 203d 204e 6f6e 6529  TypeLike = None)
+00015510: 3a0d 0a20 2072 2222 220d 0a20 2044 7261  :..  r"""..  Dra
+00015520: 7720 7361 6d70 6c65 7320 6672 6f6d 2074  w samples from t
+00015530: 6865 2073 7461 6e64 6172 6420 6578 706f  he standard expo
+00015540: 6e65 6e74 6961 6c20 6469 7374 7269 6275  nential distribu
+00015550: 7469 6f6e 2e0d 0a0d 0a20 2060 7374 616e  tion.....  `stan
+00015560: 6461 7264 5f65 7870 6f6e 656e 7469 616c  dard_exponential
+00015570: 6020 6973 2069 6465 6e74 6963 616c 2074  ` is identical t
+00015580: 6f20 7468 6520 6578 706f 6e65 6e74 6961  o the exponentia
+00015590: 6c20 6469 7374 7269 6275 7469 6f6e 0d0a  l distribution..
+000155a0: 2020 7769 7468 2061 2073 6361 6c65 2070    with a scale p
+000155b0: 6172 616d 6574 6572 206f 6620 312e 0d0a  arameter of 1...
+000155c0: 0d0a 2020 5061 7261 6d65 7465 7273 0d0a  ..  Parameters..
+000155d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+000155e0: 7369 7a65 203a 2069 6e74 206f 7220 7475  size : int or tu
+000155f0: 706c 6520 6f66 2069 6e74 732c 206f 7074  ple of ints, opt
+00015600: 696f 6e61 6c0d 0a20 2020 2020 204f 7574  ional..      Out
+00015610: 7075 7420 7368 6170 652e 2020 4966 2074  put shape.  If t
+00015620: 6865 2067 6976 656e 2073 6861 7065 2069  he given shape i
+00015630: 732c 2065 2e67 2e2c 2060 6028 6d2c 206e  s, e.g., ``(m, n
+00015640: 2c20 6b29 6060 2c20 7468 656e 0d0a 2020  , k)``, then..  
+00015650: 2020 2020 6060 6d20 2a20 6e20 2a20 6b60      ``m * n * k`
+00015660: 6020 7361 6d70 6c65 7320 6172 6520 6472  ` samples are dr
+00015670: 6177 6e2e 2020 4465 6661 756c 7420 6973  awn.  Default is
+00015680: 204e 6f6e 652c 2069 6e20 7768 6963 6820   None, in which 
+00015690: 6361 7365 2061 0d0a 2020 2020 2020 7369  case a..      si
+000156a0: 6e67 6c65 2076 616c 7565 2069 7320 7265  ngle value is re
+000156b0: 7475 726e 6564 2e0d 0a20 206b 6579 203a  turned...  key :
+000156c0: 2050 524e 474b 6579 2c20 6f70 7469 6f6e   PRNGKey, option
+000156d0: 616c 0d0a 2020 2020 2020 5468 6520 6b65  al..      The ke
+000156e0: 7920 666f 7220 7468 6520 7261 6e64 6f6d  y for the random
+000156f0: 206e 756d 6265 7220 6765 6e65 7261 746f   number generato
+00015700: 722e 2049 6620 6e6f 7420 6769 7665 6e2c  r. If not given,
+00015710: 2074 6865 0d0a 2020 2020 2020 6465 6661   the..      defa
+00015720: 756c 7420 7261 6e64 6f6d 206e 756d 6265  ult random numbe
+00015730: 7220 6765 6e65 7261 746f 7220 6973 2075  r generator is u
+00015740: 7365 642e 0d0a 0d0a 2020 5265 7475 726e  sed.....  Return
+00015750: 730d 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020  s..  -------..  
+00015760: 6f75 7420 3a20 666c 6f61 7420 6f72 206e  out : float or n
+00015770: 6461 7272 6179 0d0a 2020 2020 2020 4472  darray..      Dr
+00015780: 6177 6e20 7361 6d70 6c65 732e 0d0a 0d0a  awn samples.....
+00015790: 2020 4578 616d 706c 6573 0d0a 2020 2d2d    Examples..  --
+000157a0: 2d2d 2d2d 2d2d 0d0a 2020 4f75 7470 7574  ------..  Output
+000157b0: 2061 2033 7838 3030 3020 6172 7261 793a   a 3x8000 array:
+000157c0: 0d0a 0d0a 2020 3e3e 3e20 6e20 3d20 6272  ....  >>> n = br
+000157d0: 6169 6e63 6f72 652e 7261 6e64 6f6d 2e73  aincore.random.s
+000157e0: 7461 6e64 6172 645f 6578 706f 6e65 6e74  tandard_exponent
+000157f0: 6961 6c28 2833 2c20 3830 3030 2929 0d0a  ial((3, 8000))..
+00015800: 2020 2222 220d 0a20 2072 6574 7572 6e20    """..  return 
+00015810: 4445 4641 554c 542e 7374 616e 6461 7264  DEFAULT.standard
+00015820: 5f65 7870 6f6e 656e 7469 616c 2873 697a  _exponential(siz
+00015830: 652c 206b 6579 3d6b 6579 2c20 6474 7970  e, key=key, dtyp
+00015840: 653d 6474 7970 6529 0d0a 0d0a 0d0a 6465  e=dtype)......de
+00015850: 6620 7374 616e 6461 7264 5f67 616d 6d61  f standard_gamma
+00015860: 2873 6861 7065 2c20 7369 7a65 3a20 4f70  (shape, size: Op
+00015870: 7469 6f6e 616c 5b53 697a 655d 203d 204e  tional[Size] = N
+00015880: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+00015890: 2020 2020 2020 2020 206b 6579 3a20 4f70           key: Op
+000158a0: 7469 6f6e 616c 5b53 6565 644f 724b 6579  tional[SeedOrKey
+000158b0: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2020  ] = None,..     
+000158c0: 2020 2020 2020 2020 2020 2020 2020 6474                dt
+000158d0: 7970 653a 2044 5479 7065 4c69 6b65 203d  ype: DTypeLike =
+000158e0: 204e 6f6e 6529 3a0d 0a20 2072 2222 220d   None):..  r""".
+000158f0: 0a20 2044 7261 7720 7361 6d70 6c65 7320  .  Draw samples 
+00015900: 6672 6f6d 2061 2073 7461 6e64 6172 6420  from a standard 
+00015910: 4761 6d6d 6120 6469 7374 7269 6275 7469  Gamma distributi
+00015920: 6f6e 2e0d 0a0d 0a20 2053 616d 706c 6573  on.....  Samples
+00015930: 2061 7265 2064 7261 776e 2066 726f 6d20   are drawn from 
+00015940: 6120 4761 6d6d 6120 6469 7374 7269 6275  a Gamma distribu
+00015950: 7469 6f6e 2077 6974 6820 7370 6563 6966  tion with specif
+00015960: 6965 6420 7061 7261 6d65 7465 7273 2c0d  ied parameters,.
+00015970: 0a20 2073 6861 7065 2028 736f 6d65 7469  .  shape (someti
+00015980: 6d65 7320 6465 7369 676e 6174 6564 2022  mes designated "
+00015990: 6b22 2920 616e 6420 7363 616c 653d 312e  k") and scale=1.
+000159a0: 0d0a 0d0a 2020 5061 7261 6d65 7465 7273  ....  Parameters
+000159b0: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  ..  ----------..
+000159c0: 2020 7368 6170 6520 3a20 666c 6f61 7420    shape : float 
+000159d0: 6f72 2061 7272 6179 5f6c 696b 6520 6f66  or array_like of
+000159e0: 2066 6c6f 6174 730d 0a20 2020 2020 2050   floats..      P
+000159f0: 6172 616d 6574 6572 2c20 6d75 7374 2062  arameter, must b
+00015a00: 6520 6e6f 6e2d 6e65 6761 7469 7665 2e0d  e non-negative..
+00015a10: 0a20 2073 697a 6520 3a20 696e 7420 6f72  .  size : int or
+00015a20: 2074 7570 6c65 206f 6620 696e 7473 2c20   tuple of ints, 
+00015a30: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+00015a40: 4f75 7470 7574 2073 6861 7065 2e20 2049  Output shape.  I
+00015a50: 6620 7468 6520 6769 7665 6e20 7368 6170  f the given shap
+00015a60: 6520 6973 2c20 652e 672e 2c20 6060 286d  e is, e.g., ``(m
+00015a70: 2c20 6e2c 206b 2960 602c 2074 6865 6e0d  , n, k)``, then.
+00015a80: 0a20 2020 2020 2060 606d 202a 206e 202a  .      ``m * n *
+00015a90: 206b 6060 2073 616d 706c 6573 2061 7265   k`` samples are
+00015aa0: 2064 7261 776e 2e20 2049 6620 7369 7a65   drawn.  If size
+00015ab0: 2069 7320 6060 4e6f 6e65 6060 2028 6465   is ``None`` (de
+00015ac0: 6661 756c 7429 2c0d 0a20 2020 2020 2061  fault),..      a
+00015ad0: 2073 696e 676c 6520 7661 6c75 6520 6973   single value is
+00015ae0: 2072 6574 7572 6e65 6420 6966 2060 6073   returned if ``s
+00015af0: 6861 7065 6060 2069 7320 6120 7363 616c  hape`` is a scal
+00015b00: 6172 2e20 204f 7468 6572 7769 7365 2c0d  ar.  Otherwise,.
+00015b10: 0a20 2020 2020 2060 606e 702e 6172 7261  .      ``np.arra
+00015b20: 7928 7368 6170 6529 2e73 697a 6560 6020  y(shape).size`` 
+00015b30: 7361 6d70 6c65 7320 6172 6520 6472 6177  samples are draw
+00015b40: 6e2e 0d0a 2020 6b65 7920 3a20 5052 4e47  n...  key : PRNG
+00015b50: 4b65 792c 206f 7074 696f 6e61 6c0d 0a20  Key, optional.. 
+00015b60: 2020 2020 2054 6865 206b 6579 2066 6f72       The key for
+00015b70: 2074 6865 2072 616e 646f 6d20 6e75 6d62   the random numb
+00015b80: 6572 2067 656e 6572 6174 6f72 2e20 4966  er generator. If
+00015b90: 206e 6f74 2067 6976 656e 2c20 7468 650d   not given, the.
+00015ba0: 0a20 2020 2020 2064 6566 6175 6c74 2072  .      default r
+00015bb0: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
+00015bc0: 6572 6174 6f72 2069 7320 7573 6564 2e0d  erator is used..
+00015bd0: 0a0d 0a20 2052 6574 7572 6e73 0d0a 2020  ...  Returns..  
+00015be0: 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574 203a  -------..  out :
+00015bf0: 206e 6461 7272 6179 206f 7220 7363 616c   ndarray or scal
+00015c00: 6172 0d0a 2020 2020 2020 4472 6177 6e20  ar..      Drawn 
+00015c10: 7361 6d70 6c65 7320 6672 6f6d 2074 6865  samples from the
+00015c20: 2070 6172 616d 6574 6572 697a 6564 2073   parameterized s
+00015c30: 7461 6e64 6172 6420 6761 6d6d 6120 6469  tandard gamma di
+00015c40: 7374 7269 6275 7469 6f6e 2e0d 0a0d 0a20  stribution..... 
+00015c50: 2053 6565 2041 6c73 6f0d 0a20 202d 2d2d   See Also..  ---
+00015c60: 2d2d 2d2d 2d0d 0a20 2073 6369 7079 2e73  -----..  scipy.s
+00015c70: 7461 7473 2e67 616d 6d61 203a 2070 726f  tats.gamma : pro
+00015c80: 6261 6269 6c69 7479 2064 656e 7369 7479  bability density
+00015c90: 2066 756e 6374 696f 6e2c 2064 6973 7472   function, distr
+00015ca0: 6962 7574 696f 6e20 6f72 0d0a 2020 2020  ibution or..    
+00015cb0: 2020 6375 6d75 6c61 7469 7665 2064 656e    cumulative den
+00015cc0: 7369 7479 2066 756e 6374 696f 6e2c 2065  sity function, e
+00015cd0: 7463 2e0d 0a0d 0a20 204e 6f74 6573 0d0a  tc.....  Notes..
+00015ce0: 2020 2d2d 2d2d 2d0d 0a20 2054 6865 2070    -----..  The p
+00015cf0: 726f 6261 6269 6c69 7479 2064 656e 7369  robability densi
+00015d00: 7479 2066 6f72 2074 6865 2047 616d 6d61  ty for the Gamma
+00015d10: 2064 6973 7472 6962 7574 696f 6e20 6973   distribution is
+00015d20: 0d0a 0d0a 2020 2e2e 206d 6174 683a 3a20  ....  .. math:: 
+00015d30: 7028 7829 203d 2078 5e7b 6b2d 317d 5c66  p(x) = x^{k-1}\f
+00015d40: 7261 637b 655e 7b2d 782f 5c74 6865 7461  rac{e^{-x/\theta
+00015d50: 7d7d 7b5c 7468 6574 615e 6b5c 4761 6d6d  }}{\theta^k\Gamm
+00015d60: 6128 6b29 7d2c 0d0a 0d0a 2020 7768 6572  a(k)},....  wher
+00015d70: 6520 3a6d 6174 683a 606b 6020 6973 2074  e :math:`k` is t
+00015d80: 6865 2073 6861 7065 2061 6e64 203a 6d61  he shape and :ma
+00015d90: 7468 3a60 5c74 6865 7461 6020 7468 6520  th:`\theta` the 
+00015da0: 7363 616c 652c 0d0a 2020 616e 6420 3a6d  scale,..  and :m
+00015db0: 6174 683a 605c 4761 6d6d 6160 2069 7320  ath:`\Gamma` is 
+00015dc0: 7468 6520 4761 6d6d 6120 6675 6e63 7469  the Gamma functi
+00015dd0: 6f6e 2e0d 0a0d 0a20 2054 6865 2047 616d  on.....  The Gam
+00015de0: 6d61 2064 6973 7472 6962 7574 696f 6e20  ma distribution 
+00015df0: 6973 206f 6674 656e 2075 7365 6420 746f  is often used to
+00015e00: 206d 6f64 656c 2074 6865 2074 696d 6573   model the times
+00015e10: 2074 6f20 6661 696c 7572 6520 6f66 0d0a   to failure of..
+00015e20: 2020 656c 6563 7472 6f6e 6963 2063 6f6d    electronic com
+00015e30: 706f 6e65 6e74 732c 2061 6e64 2061 7269  ponents, and ari
+00015e40: 7365 7320 6e61 7475 7261 6c6c 7920 696e  ses naturally in
+00015e50: 2070 726f 6365 7373 6573 2066 6f72 2077   processes for w
+00015e60: 6869 6368 2074 6865 0d0a 2020 7761 6974  hich the..  wait
+00015e70: 696e 6720 7469 6d65 7320 6265 7477 6565  ing times betwee
+00015e80: 6e20 506f 6973 736f 6e20 6469 7374 7269  n Poisson distri
+00015e90: 6275 7465 6420 6576 656e 7473 2061 7265  buted events are
+00015ea0: 2072 656c 6576 616e 742e 0d0a 0d0a 2020   relevant.....  
+00015eb0: 5265 6665 7265 6e63 6573 0d0a 2020 2d2d  References..  --
+00015ec0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2e2e 205b  --------..  .. [
+00015ed0: 315d 2057 6569 7373 7465 696e 2c20 4572  1] Weisstein, Er
+00015ee0: 6963 2057 2e20 2247 616d 6d61 2044 6973  ic W. "Gamma Dis
+00015ef0: 7472 6962 7574 696f 6e2e 2220 4672 6f6d  tribution." From
+00015f00: 204d 6174 6857 6f72 6c64 2d2d 410d 0a20   MathWorld--A.. 
+00015f10: 2020 2020 2020 2020 576f 6c66 7261 6d20          Wolfram 
+00015f20: 5765 6220 5265 736f 7572 6365 2e0d 0a20  Web Resource... 
+00015f30: 2020 2020 2020 2020 6874 7470 3a2f 2f6d          http://m
+00015f40: 6174 6877 6f72 6c64 2e77 6f6c 6672 616d  athworld.wolfram
+00015f50: 2e63 6f6d 2f47 616d 6d61 4469 7374 7269  .com/GammaDistri
+00015f60: 6275 7469 6f6e 2e68 746d 6c0d 0a20 202e  bution.html..  .
+00015f70: 2e20 5b32 5d20 5769 6b69 7065 6469 612c  . [2] Wikipedia,
+00015f80: 2022 4761 6d6d 6120 6469 7374 7269 6275   "Gamma distribu
+00015f90: 7469 6f6e 222c 0d0a 2020 2020 2020 2020  tion",..        
+00015fa0: 2068 7474 7073 3a2f 2f65 6e2e 7769 6b69   https://en.wiki
+00015fb0: 7065 6469 612e 6f72 672f 7769 6b69 2f47  pedia.org/wiki/G
+00015fc0: 616d 6d61 5f64 6973 7472 6962 7574 696f  amma_distributio
+00015fd0: 6e0d 0a0d 0a20 2045 7861 6d70 6c65 730d  n....  Examples.
+00015fe0: 0a20 202d 2d2d 2d2d 2d2d 2d0d 0a20 2044  .  --------..  D
+00015ff0: 7261 7720 7361 6d70 6c65 7320 6672 6f6d  raw samples from
+00016000: 2074 6865 2064 6973 7472 6962 7574 696f   the distributio
+00016010: 6e3a 0d0a 0d0a 2020 3e3e 3e20 7368 6170  n:....  >>> shap
+00016020: 652c 2073 6361 6c65 203d 2032 2e2c 2031  e, scale = 2., 1
+00016030: 2e20 2320 6d65 616e 2061 6e64 2077 6964  . # mean and wid
+00016040: 7468 0d0a 2020 3e3e 3e20 7320 3d20 6272  th..  >>> s = br
+00016050: 6169 6e63 6f72 652e 7261 6e64 6f6d 2e73  aincore.random.s
+00016060: 7461 6e64 6172 645f 6761 6d6d 6128 7368  tandard_gamma(sh
+00016070: 6170 652c 2031 3030 3030 3030 290d 0a0d  ape, 1000000)...
+00016080: 0a20 2044 6973 706c 6179 2074 6865 2068  .  Display the h
+00016090: 6973 746f 6772 616d 206f 6620 7468 6520  istogram of the 
+000160a0: 7361 6d70 6c65 732c 2061 6c6f 6e67 2077  samples, along w
+000160b0: 6974 680d 0a20 2074 6865 2070 726f 6261  ith..  the proba
+000160c0: 6269 6c69 7479 2064 656e 7369 7479 2066  bility density f
+000160d0: 756e 6374 696f 6e3a 0d0a 0d0a 2020 3e3e  unction:....  >>
+000160e0: 3e20 696d 706f 7274 206d 6174 706c 6f74  > import matplot
+000160f0: 6c69 622e 7079 706c 6f74 2061 7320 706c  lib.pyplot as pl
+00016100: 7420 2023 206e 6f71 610d 0a20 203e 3e3e  t  # noqa..  >>>
+00016110: 2069 6d70 6f72 7420 7363 6970 792e 7370   import scipy.sp
+00016120: 6563 6961 6c20 6173 2073 7073 2020 2320  ecial as sps  # 
+00016130: 646f 6374 6573 743a 202b 534b 4950 0d0a  doctest: +SKIP..
+00016140: 2020 3e3e 3e20 636f 756e 742c 2062 696e    >>> count, bin
+00016150: 732c 2069 676e 6f72 6564 203d 2070 6c74  s, ignored = plt
+00016160: 2e68 6973 7428 732c 2035 302c 2064 656e  .hist(s, 50, den
+00016170: 7369 7479 3d54 7275 6529 0d0a 2020 3e3e  sity=True)..  >>
+00016180: 3e20 7920 3d20 6269 6e73 2a2a 2873 6861  > y = bins**(sha
+00016190: 7065 2d31 2920 2a20 2828 6e70 2e65 7870  pe-1) * ((np.exp
+000161a0: 282d 6269 6e73 2f73 6361 6c65 2929 2f20  (-bins/scale))/ 
+000161b0: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+000161c0: 500d 0a20 202e 2e2e 2020 2020 2020 2020  P..  ...        
+000161d0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+000161e0: 7370 732e 6761 6d6d 6128 7368 6170 6529  sps.gamma(shape)
+000161f0: 202a 2073 6361 6c65 2a2a 7368 6170 6529   * scale**shape)
+00016200: 290d 0a20 203e 3e3e 2070 6c74 2e70 6c6f  )..  >>> plt.plo
+00016210: 7428 6269 6e73 2c20 792c 206c 696e 6577  t(bins, y, linew
+00016220: 6964 7468 3d32 2c20 636f 6c6f 723d 2772  idth=2, color='r
+00016230: 2729 2020 2320 646f 6374 6573 743a 202b  ')  # doctest: +
+00016240: 534b 4950 0d0a 2020 3e3e 3e20 706c 742e  SKIP..  >>> plt.
+00016250: 7368 6f77 2829 0d0a 2020 2222 220d 0a20  show()..  """.. 
+00016260: 2072 6574 7572 6e20 4445 4641 554c 542e   return DEFAULT.
+00016270: 7374 616e 6461 7264 5f67 616d 6d61 2873  standard_gamma(s
+00016280: 6861 7065 2c20 7369 7a65 2c20 6b65 793d  hape, size, key=
+00016290: 6b65 792c 2064 7479 7065 3d64 7479 7065  key, dtype=dtype
+000162a0: 290d 0a0d 0a0d 0a64 6566 2073 7461 6e64  )......def stand
+000162b0: 6172 645f 6e6f 726d 616c 2873 697a 653a  ard_normal(size:
+000162c0: 204f 7074 696f 6e61 6c5b 5369 7a65 5d20   Optional[Size] 
+000162d0: 3d20 4e6f 6e65 2c20 6b65 793a 204f 7074  = None, key: Opt
+000162e0: 696f 6e61 6c5b 5365 6564 4f72 4b65 795d  ional[SeedOrKey]
+000162f0: 203d 204e 6f6e 652c 2064 7479 7065 3a20   = None, dtype: 
+00016300: 4454 7970 654c 696b 6520 3d20 4e6f 6e65  DTypeLike = None
+00016310: 293a 0d0a 2020 7222 2222 0d0a 2020 4472  ):..  r"""..  Dr
+00016320: 6177 2073 616d 706c 6573 2066 726f 6d20  aw samples from 
+00016330: 6120 7374 616e 6461 7264 204e 6f72 6d61  a standard Norma
+00016340: 6c20 6469 7374 7269 6275 7469 6f6e 2028  l distribution (
+00016350: 6d65 616e 3d30 2c20 7374 6465 763d 3129  mean=0, stdev=1)
+00016360: 2e0d 0a0d 0a20 2050 6172 616d 6574 6572  .....  Parameter
+00016370: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
+00016380: 0a20 2073 697a 6520 3a20 696e 7420 6f72  .  size : int or
+00016390: 2074 7570 6c65 206f 6620 696e 7473 2c20   tuple of ints, 
+000163a0: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+000163b0: 4f75 7470 7574 2073 6861 7065 2e20 2049  Output shape.  I
+000163c0: 6620 7468 6520 6769 7665 6e20 7368 6170  f the given shap
+000163d0: 6520 6973 2c20 652e 672e 2c20 6060 286d  e is, e.g., ``(m
+000163e0: 2c20 6e2c 206b 2960 602c 2074 6865 6e0d  , n, k)``, then.
+000163f0: 0a20 2020 2020 2060 606d 202a 206e 202a  .      ``m * n *
+00016400: 206b 6060 2073 616d 706c 6573 2061 7265   k`` samples are
+00016410: 2064 7261 776e 2e20 2044 6566 6175 6c74   drawn.  Default
+00016420: 2069 7320 4e6f 6e65 2c20 696e 2077 6869   is None, in whi
+00016430: 6368 2063 6173 6520 610d 0a20 2020 2020  ch case a..     
+00016440: 2073 696e 676c 6520 7661 6c75 6520 6973   single value is
+00016450: 2072 6574 7572 6e65 642e 0d0a 2020 6b65   returned...  ke
+00016460: 7920 3a20 5052 4e47 4b65 792c 206f 7074  y : PRNGKey, opt
+00016470: 696f 6e61 6c0d 0a20 2020 2020 2054 6865  ional..      The
+00016480: 206b 6579 2066 6f72 2074 6865 2072 616e   key for the ran
+00016490: 646f 6d20 6e75 6d62 6572 2067 656e 6572  dom number gener
+000164a0: 6174 6f72 2e20 4966 206e 6f74 2067 6976  ator. If not giv
+000164b0: 656e 2c20 7468 650d 0a20 2020 2020 2064  en, the..      d
+000164c0: 6566 6175 6c74 2072 616e 646f 6d20 6e75  efault random nu
+000164d0: 6d62 6572 2067 656e 6572 6174 6f72 2069  mber generator i
+000164e0: 7320 7573 6564 2e0d 0a0d 0a20 2052 6574  s used.....  Ret
+000164f0: 7572 6e73 0d0a 2020 2d2d 2d2d 2d2d 2d0d  urns..  -------.
+00016500: 0a20 206f 7574 203a 2066 6c6f 6174 206f  .  out : float o
+00016510: 7220 6e64 6172 7261 790d 0a20 2020 2020  r ndarray..     
+00016520: 2041 2066 6c6f 6174 696e 672d 706f 696e   A floating-poin
+00016530: 7420 6172 7261 7920 6f66 2073 6861 7065  t array of shape
+00016540: 2060 6073 697a 6560 6020 6f66 2064 7261   ``size`` of dra
+00016550: 776e 2073 616d 706c 6573 2c20 6f72 2061  wn samples, or a
+00016560: 0d0a 2020 2020 2020 7369 6e67 6c65 2073  ..      single s
+00016570: 616d 706c 6520 6966 2060 6073 697a 6560  ample if ``size`
+00016580: 6020 7761 7320 6e6f 7420 7370 6563 6966  ` was not specif
+00016590: 6965 642e 0d0a 0d0a 2020 5365 6520 416c  ied.....  See Al
+000165a0: 736f 0d0a 2020 2d2d 2d2d 2d2d 2d2d 0d0a  so..  --------..
+000165b0: 2020 6e6f 726d 616c 203a 0d0a 2020 2020    normal :..    
+000165c0: 2020 4571 7569 7661 6c65 6e74 2066 756e    Equivalent fun
+000165d0: 6374 696f 6e20 7769 7468 2061 6464 6974  ction with addit
+000165e0: 696f 6e61 6c20 6060 6c6f 6360 6020 616e  ional ``loc`` an
+000165f0: 6420 6060 7363 616c 6560 6020 6172 6775  d ``scale`` argu
+00016600: 6d65 6e74 730d 0a20 2020 2020 2066 6f72  ments..      for
+00016610: 2073 6574 7469 6e67 2074 6865 206d 6561   setting the mea
+00016620: 6e20 616e 6420 7374 616e 6461 7264 2064  n and standard d
+00016630: 6576 6961 7469 6f6e 2e0d 0a0d 0a20 204e  eviation.....  N
+00016640: 6f74 6573 0d0a 2020 2d2d 2d2d 2d0d 0a20  otes..  -----.. 
+00016650: 2046 6f72 2072 616e 646f 6d20 7361 6d70   For random samp
+00016660: 6c65 7320 6672 6f6d 2074 6865 206e 6f72  les from the nor
+00016670: 6d61 6c20 6469 7374 7269 6275 7469 6f6e  mal distribution
+00016680: 2077 6974 6820 6d65 616e 2060 606d 7560   with mean ``mu`
+00016690: 6020 616e 640d 0a20 2073 7461 6e64 6172  ` and..  standar
+000166a0: 6420 6465 7669 6174 696f 6e20 6060 7369  d deviation ``si
+000166b0: 676d 6160 602c 2075 7365 206f 6e65 206f  gma``, use one o
+000166c0: 663a 3a0d 0a0d 0a20 2020 2020 206d 7520  f::....      mu 
+000166d0: 2b20 7369 676d 6120 2a20 6272 6169 6e63  + sigma * brainc
+000166e0: 6f72 652e 7261 6e64 6f6d 2e73 7461 6e64  ore.random.stand
+000166f0: 6172 645f 6e6f 726d 616c 2873 697a 653d  ard_normal(size=
+00016700: 2e2e 2e29 0d0a 2020 2020 2020 6272 6169  ...)..      brai
+00016710: 6e63 6f72 652e 7261 6e64 6f6d 2e6e 6f72  ncore.random.nor
+00016720: 6d61 6c28 6d75 2c20 7369 676d 612c 2073  mal(mu, sigma, s
+00016730: 697a 653d 2e2e 2e29 0d0a 0d0a 2020 4578  ize=...)....  Ex
+00016740: 616d 706c 6573 0d0a 2020 2d2d 2d2d 2d2d  amples..  ------
+00016750: 2d2d 0d0a 2020 3e3e 3e20 6272 6169 6e63  --..  >>> brainc
+00016760: 6f72 652e 7261 6e64 6f6d 2e73 7461 6e64  ore.random.stand
+00016770: 6172 645f 6e6f 726d 616c 2829 0d0a 2020  ard_normal()..  
+00016780: 322e 3139 3233 3837 3533 3335 3533 3733  2.19238753355373
+00016790: 3135 2023 7261 6e64 6f6d 0d0a 0d0a 2020  15 #random....  
+000167a0: 3e3e 3e20 7320 3d20 6272 6169 6e63 6f72  >>> s = braincor
+000167b0: 652e 7261 6e64 6f6d 2e73 7461 6e64 6172  e.random.standar
+000167c0: 645f 6e6f 726d 616c 2838 3030 3029 0d0a  d_normal(8000)..
+000167d0: 2020 3e3e 3e20 730d 0a20 2061 7272 6179    >>> s..  array
+000167e0: 285b 2030 2e36 3838 3838 3933 202c 2020  ([ 0.6888893 ,  
+000167f0: 302e 3738 3039 3632 3632 2c20 2d30 2e38  0.78096262, -0.8
+00016800: 3930 3836 3530 352c 202e 2e2e 2c20 2030  9086505, ...,  0
+00016810: 2e34 3938 3736 3331 312c 2020 2320 7261  .49876311,  # ra
+00016820: 6e64 6f6d 0d0a 2020 2020 2020 2020 202d  ndom..         -
+00016830: 302e 3338 3637 3236 3936 2c20 2d30 2e34  0.38672696, -0.4
+00016840: 3638 3530 3036 205d 2920 2020 2020 2020  685006 ])       
+00016850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016860: 2020 2020 2020 2020 2023 2072 616e 646f           # rando
+00016870: 6d0d 0a20 203e 3e3e 2073 2e73 6861 7065  m..  >>> s.shape
+00016880: 0d0a 2020 2838 3030 302c 290d 0a20 203e  ..  (8000,)..  >
+00016890: 3e3e 2073 203d 2062 7261 696e 636f 7265  >> s = braincore
+000168a0: 2e72 616e 646f 6d2e 7374 616e 6461 7264  .random.standard
+000168b0: 5f6e 6f72 6d61 6c28 7369 7a65 3d28 332c  _normal(size=(3,
+000168c0: 2034 2c20 3229 290d 0a20 203e 3e3e 2073   4, 2))..  >>> s
+000168d0: 2e73 6861 7065 0d0a 2020 2833 2c20 342c  .shape..  (3, 4,
+000168e0: 2032 290d 0a0d 0a20 2054 776f 2d62 792d   2)....  Two-by-
+000168f0: 666f 7572 2061 7272 6179 206f 6620 7361  four array of sa
+00016900: 6d70 6c65 7320 6672 6f6d 2074 6865 206e  mples from the n
+00016910: 6f72 6d61 6c20 6469 7374 7269 6275 7469  ormal distributi
+00016920: 6f6e 2077 6974 680d 0a20 206d 6561 6e20  on with..  mean 
+00016930: 3320 616e 6420 7374 616e 6461 7264 2064  3 and standard d
+00016940: 6576 6961 7469 6f6e 2032 2e35 3a0d 0a0d  eviation 2.5:...
+00016950: 0a20 203e 3e3e 2033 202b 2032 2e35 202a  .  >>> 3 + 2.5 *
+00016960: 2062 7261 696e 636f 7265 2e72 616e 646f   braincore.rando
+00016970: 6d2e 7374 616e 6461 7264 5f6e 6f72 6d61  m.standard_norma
+00016980: 6c28 7369 7a65 3d28 322c 2034 2929 0d0a  l(size=(2, 4))..
+00016990: 2020 6172 7261 7928 5b5b 2d34 2e34 3934    array([[-4.494
+000169a0: 3031 3530 312c 2020 342e 3030 3935 3030  01501,  4.009500
+000169b0: 3334 2c20 2d31 2e38 3138 3134 3836 372c  34, -1.81814867,
+000169c0: 2020 372e 3239 3731 3836 3737 5d2c 2020    7.29718677],  
+000169d0: 2023 2072 616e 646f 6d0d 0a20 2020 2020   # random..     
+000169e0: 2020 2020 5b20 302e 3339 3932 3438 3034      [ 0.39924804
+000169f0: 2c20 2034 2e36 3834 3536 3331 362c 2020  ,  4.68456316,  
+00016a00: 342e 3939 3339 3435 3239 2c20 2034 2e38  4.99394529,  4.8
+00016a10: 3430 3537 3235 345d 5d29 2020 2320 7261  4057254]])  # ra
+00016a20: 6e64 6f6d 0d0a 2020 2222 220d 0a20 2072  ndom..  """..  r
+00016a30: 6574 7572 6e20 4445 4641 554c 542e 7374  eturn DEFAULT.st
+00016a40: 616e 6461 7264 5f6e 6f72 6d61 6c28 7369  andard_normal(si
+00016a50: 7a65 2c20 6b65 793d 6b65 792c 2064 7479  ze, key=key, dty
+00016a60: 7065 3d64 7479 7065 290d 0a0d 0a0d 0a64  pe=dtype)......d
+00016a70: 6566 2073 7461 6e64 6172 645f 7428 6466  ef standard_t(df
+00016a80: 2c20 7369 7a65 3a20 4f70 7469 6f6e 616c  , size: Optional
+00016a90: 5b53 697a 655d 203d 204e 6f6e 652c 206b  [Size] = None, k
+00016aa0: 6579 3a20 4f70 7469 6f6e 616c 5b53 6565  ey: Optional[See
+00016ab0: 644f 724b 6579 5d20 3d20 4e6f 6e65 2c20  dOrKey] = None, 
+00016ac0: 6474 7970 653a 2044 5479 7065 4c69 6b65  dtype: DTypeLike
+00016ad0: 203d 204e 6f6e 6529 3a0d 0a20 2072 2222   = None):..  r""
+00016ae0: 220d 0a20 2044 7261 7720 7361 6d70 6c65  "..  Draw sample
+00016af0: 7320 6672 6f6d 2061 2073 7461 6e64 6172  s from a standar
+00016b00: 6420 5374 7564 656e 7427 7320 7420 6469  d Student's t di
+00016b10: 7374 7269 6275 7469 6f6e 2077 6974 6820  stribution with 
+00016b20: 6064 6660 2064 6567 7265 6573 0d0a 2020  `df` degrees..  
+00016b30: 6f66 2066 7265 6564 6f6d 2e0d 0a0d 0a20  of freedom..... 
+00016b40: 2041 2073 7065 6369 616c 2063 6173 6520   A special case 
+00016b50: 6f66 2074 6865 2068 7970 6572 626f 6c69  of the hyperboli
+00016b60: 6320 6469 7374 7269 6275 7469 6f6e 2e20  c distribution. 
+00016b70: 2041 7320 6064 6660 2067 6574 730d 0a20   As `df` gets.. 
+00016b80: 206c 6172 6765 2c20 7468 6520 7265 7375   large, the resu
+00016b90: 6c74 2072 6573 656d 626c 6573 2074 6861  lt resembles tha
+00016ba0: 7420 6f66 2074 6865 2073 7461 6e64 6172  t of the standar
+00016bb0: 6420 6e6f 726d 616c 0d0a 2020 6469 7374  d normal..  dist
+00016bc0: 7269 6275 7469 6f6e 2028 6073 7461 6e64  ribution (`stand
+00016bd0: 6172 645f 6e6f 726d 616c 6029 2e0d 0a0d  ard_normal`)....
+00016be0: 0a20 2050 6172 616d 6574 6572 730d 0a20  .  Parameters.. 
+00016bf0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2064   ----------..  d
+00016c00: 6620 3a20 666c 6f61 7420 6f72 2061 7272  f : float or arr
+00016c10: 6179 5f6c 696b 6520 6f66 2066 6c6f 6174  ay_like of float
+00016c20: 730d 0a20 2020 2020 2044 6567 7265 6573  s..      Degrees
+00016c30: 206f 6620 6672 6565 646f 6d2c 206d 7573   of freedom, mus
+00016c40: 7420 6265 203e 2030 2e0d 0a20 2073 697a  t be > 0...  siz
+00016c50: 6520 3a20 696e 7420 6f72 2074 7570 6c65  e : int or tuple
+00016c60: 206f 6620 696e 7473 2c20 6f70 7469 6f6e   of ints, option
+00016c70: 616c 0d0a 2020 2020 2020 4f75 7470 7574  al..      Output
+00016c80: 2073 6861 7065 2e20 2049 6620 7468 6520   shape.  If the 
+00016c90: 6769 7665 6e20 7368 6170 6520 6973 2c20  given shape is, 
+00016ca0: 652e 672e 2c20 6060 286d 2c20 6e2c 206b  e.g., ``(m, n, k
+00016cb0: 2960 602c 2074 6865 6e0d 0a20 2020 2020  )``, then..     
+00016cc0: 2060 606d 202a 206e 202a 206b 6060 2073   ``m * n * k`` s
+00016cd0: 616d 706c 6573 2061 7265 2064 7261 776e  amples are drawn
+00016ce0: 2e20 2049 6620 7369 7a65 2069 7320 6060  .  If size is ``
+00016cf0: 4e6f 6e65 6060 2028 6465 6661 756c 7429  None`` (default)
+00016d00: 2c0d 0a20 2020 2020 2061 2073 696e 676c  ,..      a singl
+00016d10: 6520 7661 6c75 6520 6973 2072 6574 7572  e value is retur
+00016d20: 6e65 6420 6966 2060 6064 6660 6020 6973  ned if ``df`` is
+00016d30: 2061 2073 6361 6c61 722e 2020 4f74 6865   a scalar.  Othe
+00016d40: 7277 6973 652c 0d0a 2020 2020 2020 6060  rwise,..      ``
+00016d50: 6e70 2e61 7272 6179 2864 6629 2e73 697a  np.array(df).siz
+00016d60: 6560 6020 7361 6d70 6c65 7320 6172 6520  e`` samples are 
+00016d70: 6472 6177 6e2e 0d0a 2020 6b65 7920 3a20  drawn...  key : 
+00016d80: 5052 4e47 4b65 792c 206f 7074 696f 6e61  PRNGKey, optiona
+00016d90: 6c0d 0a20 2020 2020 2054 6865 206b 6579  l..      The key
+00016da0: 2066 6f72 2074 6865 2072 616e 646f 6d20   for the random 
+00016db0: 6e75 6d62 6572 2067 656e 6572 6174 6f72  number generator
+00016dc0: 2e20 4966 206e 6f74 2067 6976 656e 2c20  . If not given, 
+00016dd0: 7468 650d 0a20 2020 2020 2064 6566 6175  the..      defau
+00016de0: 6c74 2072 616e 646f 6d20 6e75 6d62 6572  lt random number
+00016df0: 2067 656e 6572 6174 6f72 2069 7320 7573   generator is us
+00016e00: 6564 2e0d 0a0d 0a20 2052 6574 7572 6e73  ed.....  Returns
+00016e10: 0d0a 2020 2d2d 2d2d 2d2d 2d0d 0a20 206f  ..  -------..  o
+00016e20: 7574 203a 206e 6461 7272 6179 206f 7220  ut : ndarray or 
+00016e30: 7363 616c 6172 0d0a 2020 2020 2020 4472  scalar..      Dr
+00016e40: 6177 6e20 7361 6d70 6c65 7320 6672 6f6d  awn samples from
+00016e50: 2074 6865 2070 6172 616d 6574 6572 697a   the parameteriz
+00016e60: 6564 2073 7461 6e64 6172 6420 5374 7564  ed standard Stud
+00016e70: 656e 7427 7320 7420 6469 7374 7269 6275  ent's t distribu
+00016e80: 7469 6f6e 2e0d 0a0d 0a20 204e 6f74 6573  tion.....  Notes
+00016e90: 0d0a 2020 2d2d 2d2d 2d0d 0a20 2054 6865  ..  -----..  The
+00016ea0: 2070 726f 6261 6269 6c69 7479 2064 656e   probability den
+00016eb0: 7369 7479 2066 756e 6374 696f 6e20 666f  sity function fo
+00016ec0: 7220 7468 6520 7420 6469 7374 7269 6275  r the t distribu
+00016ed0: 7469 6f6e 2069 730d 0a0d 0a20 202e 2e20  tion is....  .. 
+00016ee0: 6d61 7468 3a3a 2050 2878 2c20 6466 2920  math:: P(x, df) 
+00016ef0: 3d20 5c66 7261 637b 5c47 616d 6d61 285c  = \frac{\Gamma(\
+00016f00: 6672 6163 7b64 662b 317d 7b32 7d29 7d7b  frac{df+1}{2})}{
+00016f10: 5c73 7172 747b 5c70 6920 6466 7d0d 0a20  \sqrt{\pi df}.. 
+00016f20: 2020 2020 2020 2020 2020 205c 4761 6d6d             \Gamm
+00016f30: 6128 5c66 7261 637b 6466 7d7b 327d 297d  a(\frac{df}{2})}
+00016f40: 5c42 6967 6c28 2031 2b5c 6672 6163 7b78  \Bigl( 1+\frac{x
+00016f50: 5e32 7d7b 6466 7d20 5c42 6967 7229 5e7b  ^2}{df} \Bigr)^{
+00016f60: 2d28 6466 2b31 292f 327d 0d0a 0d0a 2020  -(df+1)/2}....  
+00016f70: 5468 6520 7420 7465 7374 2069 7320 6261  The t test is ba
+00016f80: 7365 6420 6f6e 2061 6e20 6173 7375 6d70  sed on an assump
+00016f90: 7469 6f6e 2074 6861 7420 7468 6520 6461  tion that the da
+00016fa0: 7461 2063 6f6d 6520 6672 6f6d 2061 0d0a  ta come from a..
+00016fb0: 2020 4e6f 726d 616c 2064 6973 7472 6962    Normal distrib
+00016fc0: 7574 696f 6e2e 2054 6865 2074 2074 6573  ution. The t tes
+00016fd0: 7420 7072 6f76 6964 6573 2061 2077 6179  t provides a way
+00016fe0: 2074 6f20 7465 7374 2077 6865 7468 6572   to test whether
+00016ff0: 0d0a 2020 7468 6520 7361 6d70 6c65 206d  ..  the sample m
+00017000: 6561 6e20 2874 6861 7420 6973 2074 6865  ean (that is the
+00017010: 206d 6561 6e20 6361 6c63 756c 6174 6564   mean calculated
+00017020: 2066 726f 6d20 7468 6520 6461 7461 2920   from the data) 
+00017030: 6973 0d0a 2020 6120 676f 6f64 2065 7374  is..  a good est
+00017040: 696d 6174 6520 6f66 2074 6865 2074 7275  imate of the tru
+00017050: 6520 6d65 616e 2e0d 0a0d 0a20 2054 6865  e mean.....  The
+00017060: 2064 6572 6976 6174 696f 6e20 6f66 2074   derivation of t
+00017070: 6865 2074 2d64 6973 7472 6962 7574 696f  he t-distributio
+00017080: 6e20 7761 7320 6669 7273 7420 7075 626c  n was first publ
+00017090: 6973 6865 6420 696e 0d0a 2020 3139 3038  ished in..  1908
+000170a0: 2062 7920 5769 6c6c 6961 6d20 476f 7373   by William Goss
+000170b0: 6574 2077 6869 6c65 2077 6f72 6b69 6e67  et while working
+000170c0: 2066 6f72 2074 6865 2047 7569 6e6e 6573   for the Guinnes
+000170d0: 7320 4272 6577 6572 790d 0a20 2069 6e20  s Brewery..  in 
+000170e0: 4475 626c 696e 2e20 4475 6520 746f 2070  Dublin. Due to p
+000170f0: 726f 7072 6965 7461 7279 2069 7373 7565  roprietary issue
+00017100: 732c 2068 6520 6861 6420 746f 2070 7562  s, he had to pub
+00017110: 6c69 7368 2075 6e64 6572 0d0a 2020 6120  lish under..  a 
+00017120: 7073 6575 646f 6e79 6d2c 2061 6e64 2073  pseudonym, and s
+00017130: 6f20 6865 2075 7365 6420 7468 6520 6e61  o he used the na
+00017140: 6d65 2053 7475 6465 6e74 2e0d 0a0d 0a20  me Student..... 
+00017150: 2052 6566 6572 656e 6365 730d 0a20 202d   References..  -
+00017160: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 202e 2e20  ---------..  .. 
+00017170: 5b31 5d20 4461 6c67 6161 7264 2c20 5065  [1] Dalgaard, Pe
+00017180: 7465 722c 2022 496e 7472 6f64 7563 746f  ter, "Introducto
+00017190: 7279 2053 7461 7469 7374 6963 7320 5769  ry Statistics Wi
+000171a0: 7468 2052 222c 0d0a 2020 2020 2020 2020  th R",..        
+000171b0: 2053 7072 696e 6765 722c 2032 3030 322e   Springer, 2002.
+000171c0: 0d0a 2020 2e2e 205b 325d 2057 696b 6970  ..  .. [2] Wikip
+000171d0: 6564 6961 2c20 2253 7475 6465 6e74 2773  edia, "Student's
+000171e0: 2074 2d64 6973 7472 6962 7574 696f 6e22   t-distribution"
+000171f0: 0d0a 2020 2020 2020 2020 2068 7474 7073  ..         https
+00017200: 3a2f 2f65 6e2e 7769 6b69 7065 6469 612e  ://en.wikipedia.
+00017210: 6f72 672f 7769 6b69 2f53 7475 6465 6e74  org/wiki/Student
+00017220: 2773 5f74 2d64 6973 7472 6962 7574 696f  's_t-distributio
+00017230: 6e0d 0a0d 0a20 2045 7861 6d70 6c65 730d  n....  Examples.
+00017240: 0a20 202d 2d2d 2d2d 2d2d 2d0d 0a20 2046  .  --------..  F
+00017250: 726f 6d20 4461 6c67 6161 7264 2070 6167  rom Dalgaard pag
+00017260: 6520 3833 205b 315d 5f2c 2073 7570 706f  e 83 [1]_, suppo
+00017270: 7365 2074 6865 2064 6169 6c79 2065 6e65  se the daily ene
+00017280: 7267 7920 696e 7461 6b65 2066 6f72 2031  rgy intake for 1
+00017290: 310d 0a20 2077 6f6d 656e 2069 6e20 6b69  1..  women in ki
+000172a0: 6c6f 6a6f 756c 6573 2028 6b4a 2920 6973  lojoules (kJ) is
+000172b0: 3a0d 0a0d 0a20 203e 3e3e 2069 6e74 616b  :....  >>> intak
+000172c0: 6520 3d20 6e70 2e61 7272 6179 285b 3532  e = np.array([52
+000172d0: 3630 2e2c 2035 3437 302c 2035 3634 302c  60., 5470, 5640,
+000172e0: 2036 3138 302c 2036 3339 302c 2036 3531   6180, 6390, 651
+000172f0: 352c 2036 3830 352c 2037 3531 352c 205c  5, 6805, 7515, \
+00017300: 0d0a 2020 2e2e 2e20 2020 2020 2020 2020  ..  ...         
+00017310: 2020 2020 2020 2020 2020 2037 3531 352c             7515,
+00017320: 2038 3233 302c 2038 3737 305d 290d 0a0d   8230, 8770])...
+00017330: 0a20 2044 6f65 7320 7468 6569 7220 656e  .  Does their en
+00017340: 6572 6779 2069 6e74 616b 6520 6465 7669  ergy intake devi
+00017350: 6174 6520 7379 7374 656d 6174 6963 616c  ate systematical
+00017360: 6c79 2066 726f 6d20 7468 6520 7265 636f  ly from the reco
+00017370: 6d6d 656e 6465 640d 0a20 2076 616c 7565  mmended..  value
+00017380: 206f 6620 3737 3235 206b 4a3f 204f 7572   of 7725 kJ? Our
+00017390: 206e 756c 6c20 6879 706f 7468 6573 6973   null hypothesis
+000173a0: 2077 696c 6c20 6265 2074 6865 2061 6273   will be the abs
+000173b0: 656e 6365 206f 6620 6465 7669 6174 696f  ence of deviatio
+000173c0: 6e2c 0d0a 2020 616e 6420 7468 6520 616c  n,..  and the al
+000173d0: 7465 726e 6174 6520 6879 706f 7468 6573  ternate hypothes
+000173e0: 6973 2077 696c 6c20 6265 2074 6865 2070  is will be the p
+000173f0: 7265 7365 6e63 6520 6f66 2061 6e20 6566  resence of an ef
+00017400: 6665 6374 2074 6861 7420 636f 756c 6420  fect that could 
+00017410: 6265 0d0a 2020 6569 7468 6572 2070 6f73  be..  either pos
+00017420: 6974 6976 6520 6f72 206e 6567 6174 6976  itive or negativ
+00017430: 652c 2068 656e 6365 206d 616b 696e 6720  e, hence making 
+00017440: 6f75 7220 7465 7374 2032 2d74 6169 6c65  our test 2-taile
+00017450: 642e 0d0a 0d0a 2020 4265 6361 7573 6520  d.....  Because 
+00017460: 7765 2061 7265 2065 7374 696d 6174 696e  we are estimatin
+00017470: 6720 7468 6520 6d65 616e 2061 6e64 2077  g the mean and w
+00017480: 6520 6861 7665 204e 3d31 3120 7661 6c75  e have N=11 valu
+00017490: 6573 2069 6e20 6f75 7220 7361 6d70 6c65  es in our sample
+000174a0: 2c0d 0a20 2077 6520 6861 7665 204e 2d31  ,..  we have N-1
+000174b0: 3d31 3020 6465 6772 6565 7320 6f66 2066  =10 degrees of f
+000174c0: 7265 6564 6f6d 2e20 5765 2073 6574 206f  reedom. We set o
+000174d0: 7572 2073 6967 6e69 6669 6361 6e63 6520  ur significance 
+000174e0: 6c65 7665 6c20 746f 2039 3525 2061 6e64  level to 95% and
+000174f0: 0d0a 2020 636f 6d70 7574 6520 7468 6520  ..  compute the 
+00017500: 7420 7374 6174 6973 7469 6320 7573 696e  t statistic usin
+00017510: 6720 7468 6520 656d 7069 7269 6361 6c20  g the empirical 
+00017520: 6d65 616e 2061 6e64 2065 6d70 6972 6963  mean and empiric
+00017530: 616c 2073 7461 6e64 6172 640d 0a20 2064  al standard..  d
+00017540: 6576 6961 7469 6f6e 206f 6620 6f75 7220  eviation of our 
+00017550: 696e 7461 6b65 2e20 5765 2075 7365 2061  intake. We use a
+00017560: 2064 646f 6620 6f66 2031 2074 6f20 6261   ddof of 1 to ba
+00017570: 7365 2074 6865 2063 6f6d 7075 7461 7469  se the computati
+00017580: 6f6e 206f 6620 6f75 720d 0a20 2065 6d70  on of our..  emp
+00017590: 6972 6963 616c 2073 7461 6e64 6172 6420  irical standard 
+000175a0: 6465 7669 6174 696f 6e20 6f6e 2061 6e20  deviation on an 
+000175b0: 756e 6269 6173 6564 2065 7374 696d 6174  unbiased estimat
+000175c0: 6520 6f66 2074 6865 2076 6172 6961 6e63  e of the varianc
+000175d0: 6520 286e 6f74 653a 0d0a 2020 7468 6520  e (note:..  the 
+000175e0: 6669 6e61 6c20 6573 7469 6d61 7465 2069  final estimate i
+000175f0: 7320 6e6f 7420 756e 6269 6173 6564 2064  s not unbiased d
+00017600: 7565 2074 6f20 7468 6520 636f 6e63 6176  ue to the concav
+00017610: 6520 6e61 7475 7265 206f 6620 7468 6520  e nature of the 
+00017620: 7371 7561 7265 0d0a 2020 726f 6f74 292e  square..  root).
+00017630: 0d0a 0d0a 2020 3e3e 3e20 6e70 2e6d 6561  ....  >>> np.mea
+00017640: 6e28 696e 7461 6b65 290d 0a20 2036 3735  n(intake)..  675
+00017650: 332e 3633 3633 3633 3633 3633 3634 0d0a  3.636363636364..
+00017660: 2020 3e3e 3e20 696e 7461 6b65 2e73 7464    >>> intake.std
+00017670: 2864 646f 663d 3129 0d0a 2020 3131 3432  (ddof=1)..  1142
+00017680: 2e31 3233 3232 3231 3337 3337 3237 0d0a  .1232221373727..
+00017690: 2020 3e3e 3e20 7420 3d20 286e 702e 6d65    >>> t = (np.me
+000176a0: 616e 2869 6e74 616b 6529 2d37 3732 3529  an(intake)-7725)
+000176b0: 2f28 696e 7461 6b65 2e73 7464 2864 646f  /(intake.std(ddo
+000176c0: 663d 3129 2f6e 702e 7371 7274 286c 656e  f=1)/np.sqrt(len
+000176d0: 2869 6e74 616b 6529 2929 0d0a 2020 3e3e  (intake)))..  >>
+000176e0: 3e20 740d 0a20 202d 322e 3832 3037 3534  > t..  -2.820754
+000176f0: 3036 3038 3331 3031 3938 0d0a 0d0a 2020  0608310198....  
+00017700: 5765 2064 7261 7720 3130 3030 3030 3020  We draw 1000000 
+00017710: 7361 6d70 6c65 7320 6672 6f6d 2053 7475  samples from Stu
+00017720: 6465 6e74 2773 2074 2064 6973 7472 6962  dent's t distrib
+00017730: 7574 696f 6e20 7769 7468 2074 6865 2061  ution with the a
+00017740: 6465 7175 6174 650d 0a20 2064 6567 7265  dequate..  degre
+00017750: 6573 206f 6620 6672 6565 646f 6d2e 0d0a  es of freedom...
+00017760: 0d0a 2020 3e3e 3e20 696d 706f 7274 206d  ..  >>> import m
+00017770: 6174 706c 6f74 6c69 622e 7079 706c 6f74  atplotlib.pyplot
+00017780: 2061 7320 706c 7420 2023 206e 6f71 610d   as plt  # noqa.
+00017790: 0a20 203e 3e3e 2073 203d 2062 7261 696e  .  >>> s = brain
+000177a0: 636f 7265 2e72 616e 646f 6d2e 7374 616e  core.random.stan
+000177b0: 6461 7264 5f74 2831 302c 2073 697a 653d  dard_t(10, size=
+000177c0: 3130 3030 3030 3029 0d0a 2020 3e3e 3e20  1000000)..  >>> 
+000177d0: 6820 3d20 706c 742e 6869 7374 2873 2c20  h = plt.hist(s, 
+000177e0: 6269 6e73 3d31 3030 2c20 6465 6e73 6974  bins=100, densit
+000177f0: 793d 5472 7565 290d 0a0d 0a20 2044 6f65  y=True)....  Doe
+00017800: 7320 6f75 7220 7420 7374 6174 6973 7469  s our t statisti
+00017810: 6320 6c61 6e64 2069 6e20 6f6e 6520 6f66  c land in one of
+00017820: 2074 6865 2074 776f 2063 7269 7469 6361   the two critica
+00017830: 6c20 7265 6769 6f6e 7320 666f 756e 6420  l regions found 
+00017840: 6174 0d0a 2020 626f 7468 2074 6169 6c73  at..  both tails
+00017850: 206f 6620 7468 6520 6469 7374 7269 6275   of the distribu
+00017860: 7469 6f6e 3f0d 0a0d 0a20 203e 3e3e 206e  tion?....  >>> n
+00017870: 702e 7375 6d28 6e70 2e61 6273 2874 2920  p.sum(np.abs(t) 
+00017880: 3c20 6e70 2e61 6273 2873 2929 202f 2066  < np.abs(s)) / f
+00017890: 6c6f 6174 286c 656e 2873 2929 0d0a 2020  loat(len(s))..  
+000178a0: 302e 3031 3833 3138 2020 2372 616e 646f  0.018318  #rando
+000178b0: 6d20 3c20 302e 3035 2c20 7374 6174 6973  m < 0.05, statis
+000178c0: 7469 6320 6973 2069 6e20 6372 6974 6963  tic is in critic
+000178d0: 616c 2072 6567 696f 6e0d 0a0d 0a20 2054  al region....  T
+000178e0: 6865 2070 726f 6261 6269 6c69 7479 2076  he probability v
+000178f0: 616c 7565 2066 6f72 2074 6869 7320 322d  alue for this 2-
+00017900: 7461 696c 6564 2074 6573 7420 6973 2061  tailed test is a
+00017910: 626f 7574 2031 2e38 3325 2c20 7768 6963  bout 1.83%, whic
+00017920: 6820 6973 0d0a 2020 6c6f 7765 7220 7468  h is..  lower th
+00017930: 616e 2074 6865 2035 2520 7072 652d 6465  an the 5% pre-de
+00017940: 7465 726d 696e 6564 2073 6967 6e69 6669  termined signifi
+00017950: 6361 6e63 6520 7468 7265 7368 6f6c 642e  cance threshold.
+00017960: 0d0a 0d0a 2020 5468 6572 6566 6f72 652c  ....  Therefore,
+00017970: 2074 6865 2070 726f 6261 6269 6c69 7479   the probability
+00017980: 206f 6620 6f62 7365 7276 696e 6720 7661   of observing va
+00017990: 6c75 6573 2061 7320 6578 7472 656d 6520  lues as extreme 
+000179a0: 6173 206f 7572 2069 6e74 616b 650d 0a20  as our intake.. 
+000179b0: 2063 6f6e 6469 7469 6f6e 616c 6c79 206f   conditionally o
+000179c0: 6e20 7468 6520 6e75 6c6c 2068 7970 6f74  n the null hypot
+000179d0: 6865 7369 7320 6265 696e 6720 7472 7565  hesis being true
+000179e0: 2069 7320 746f 6f20 6c6f 772c 2061 6e64   is too low, and
+000179f0: 2077 6520 7265 6a65 6374 0d0a 2020 7468   we reject..  th
+00017a00: 6520 6e75 6c6c 2068 7970 6f74 6865 7369  e null hypothesi
+00017a10: 7320 6f66 206e 6f20 6465 7669 6174 696f  s of no deviatio
+00017a20: 6e2e 0d0a 2020 2222 220d 0a20 2072 6574  n...  """..  ret
+00017a30: 7572 6e20 4445 4641 554c 542e 7374 616e  urn DEFAULT.stan
+00017a40: 6461 7264 5f74 2864 662c 2073 697a 652c  dard_t(df, size,
+00017a50: 206b 6579 3d6b 6579 2c20 6474 7970 653d   key=key, dtype=
+00017a60: 6474 7970 6529 0d0a 0d0a 0d0a 6465 6620  dtype)......def 
+00017a70: 756e 6966 6f72 6d28 6c6f 773d 302e 302c  uniform(low=0.0,
+00017a80: 2068 6967 683d 312e 302c 2073 697a 653a   high=1.0, size:
+00017a90: 204f 7074 696f 6e61 6c5b 5369 7a65 5d20   Optional[Size] 
+00017aa0: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 2020  = None,..       
+00017ab0: 2020 2020 206b 6579 3a20 4f70 7469 6f6e       key: Option
+00017ac0: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
+00017ad0: 4e6f 6e65 2c20 6474 7970 653a 2044 5479  None, dtype: DTy
+00017ae0: 7065 4c69 6b65 203d 204e 6f6e 6529 3a0d  peLike = None):.
+00017af0: 0a20 2072 2222 220d 0a20 2044 7261 7720  .  r"""..  Draw 
+00017b00: 7361 6d70 6c65 7320 6672 6f6d 2061 2075  samples from a u
+00017b10: 6e69 666f 726d 2064 6973 7472 6962 7574  niform distribut
+00017b20: 696f 6e2e 0d0a 0d0a 2020 5361 6d70 6c65  ion.....  Sample
+00017b30: 7320 6172 6520 756e 6966 6f72 6d6c 7920  s are uniformly 
+00017b40: 6469 7374 7269 6275 7465 6420 6f76 6572  distributed over
+00017b50: 2074 6865 2068 616c 662d 6f70 656e 2069   the half-open i
+00017b60: 6e74 6572 7661 6c0d 0a20 2060 605b 6c6f  nterval..  ``[lo
+00017b70: 772c 2068 6967 6829 6060 2028 696e 636c  w, high)`` (incl
+00017b80: 7564 6573 206c 6f77 2c20 6275 7420 6578  udes low, but ex
+00017b90: 636c 7564 6573 2068 6967 6829 2e20 2049  cludes high).  I
+00017ba0: 6e20 6f74 6865 7220 776f 7264 732c 0d0a  n other words,..
+00017bb0: 2020 616e 7920 7661 6c75 6520 7769 7468    any value with
+00017bc0: 696e 2074 6865 2067 6976 656e 2069 6e74  in the given int
+00017bd0: 6572 7661 6c20 6973 2065 7175 616c 6c79  erval is equally
+00017be0: 206c 696b 656c 7920 746f 2062 6520 6472   likely to be dr
+00017bf0: 6177 6e0d 0a20 2062 7920 6075 6e69 666f  awn..  by `unifo
+00017c00: 726d 602e 0d0a 0d0a 2020 5061 7261 6d65  rm`.....  Parame
+00017c10: 7465 7273 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ters..  --------
+00017c20: 2d2d 0d0a 2020 6c6f 7720 3a20 666c 6f61  --..  low : floa
+00017c30: 7420 6f72 2061 7272 6179 5f6c 696b 6520  t or array_like 
+00017c40: 6f66 2066 6c6f 6174 732c 206f 7074 696f  of floats, optio
+00017c50: 6e61 6c0d 0a20 2020 2020 204c 6f77 6572  nal..      Lower
+00017c60: 2062 6f75 6e64 6172 7920 6f66 2074 6865   boundary of the
+00017c70: 206f 7574 7075 7420 696e 7465 7276 616c   output interval
+00017c80: 2e20 2041 6c6c 2076 616c 7565 7320 6765  .  All values ge
+00017c90: 6e65 7261 7465 6420 7769 6c6c 2062 650d  nerated will be.
+00017ca0: 0a20 2020 2020 2067 7265 6174 6572 2074  .      greater t
+00017cb0: 6861 6e20 6f72 2065 7175 616c 2074 6f20  han or equal to 
+00017cc0: 6c6f 772e 2020 5468 6520 6465 6661 756c  low.  The defaul
+00017cd0: 7420 7661 6c75 6520 6973 2030 2e0d 0a20  t value is 0... 
+00017ce0: 2068 6967 6820 3a20 666c 6f61 7420 6f72   high : float or
+00017cf0: 2061 7272 6179 5f6c 696b 6520 6f66 2066   array_like of f
+00017d00: 6c6f 6174 730d 0a20 2020 2020 2055 7070  loats..      Upp
+00017d10: 6572 2062 6f75 6e64 6172 7920 6f66 2074  er boundary of t
+00017d20: 6865 206f 7574 7075 7420 696e 7465 7276  he output interv
+00017d30: 616c 2e20 2041 6c6c 2076 616c 7565 7320  al.  All values 
+00017d40: 6765 6e65 7261 7465 6420 7769 6c6c 2062  generated will b
+00017d50: 650d 0a20 2020 2020 206c 6573 7320 7468  e..      less th
+00017d60: 616e 206f 7220 6571 7561 6c20 746f 2068  an or equal to h
+00017d70: 6967 682e 2020 5468 6520 6869 6768 206c  igh.  The high l
+00017d80: 696d 6974 206d 6179 2062 6520 696e 636c  imit may be incl
+00017d90: 7564 6564 2069 6e20 7468 650d 0a20 2020  uded in the..   
+00017da0: 2020 2072 6574 7572 6e65 6420 6172 7261     returned arra
+00017db0: 7920 6f66 2066 6c6f 6174 7320 6475 6520  y of floats due 
+00017dc0: 746f 2066 6c6f 6174 696e 672d 706f 696e  to floating-poin
+00017dd0: 7420 726f 756e 6469 6e67 2069 6e20 7468  t rounding in th
+00017de0: 650d 0a20 2020 2020 2065 7175 6174 696f  e..      equatio
+00017df0: 6e20 6060 6c6f 7720 2b20 2868 6967 682d  n ``low + (high-
+00017e00: 6c6f 7729 202a 2072 616e 646f 6d5f 7361  low) * random_sa
+00017e10: 6d70 6c65 2829 6060 2e20 2054 6865 2064  mple()``.  The d
+00017e20: 6566 6175 6c74 2076 616c 7565 0d0a 2020  efault value..  
+00017e30: 2020 2020 6973 2031 2e30 2e0d 0a20 2073      is 1.0...  s
+00017e40: 697a 6520 3a20 696e 7420 6f72 2074 7570  ize : int or tup
+00017e50: 6c65 206f 6620 696e 7473 2c20 6f70 7469  le of ints, opti
+00017e60: 6f6e 616c 0d0a 2020 2020 2020 4f75 7470  onal..      Outp
+00017e70: 7574 2073 6861 7065 2e20 2049 6620 7468  ut shape.  If th
+00017e80: 6520 6769 7665 6e20 7368 6170 6520 6973  e given shape is
+00017e90: 2c20 652e 672e 2c20 6060 286d 2c20 6e2c  , e.g., ``(m, n,
+00017ea0: 206b 2960 602c 2074 6865 6e0d 0a20 2020   k)``, then..   
+00017eb0: 2020 2060 606d 202a 206e 202a 206b 6060     ``m * n * k``
+00017ec0: 2073 616d 706c 6573 2061 7265 2064 7261   samples are dra
+00017ed0: 776e 2e20 2049 6620 7369 7a65 2069 7320  wn.  If size is 
+00017ee0: 6060 4e6f 6e65 6060 2028 6465 6661 756c  ``None`` (defaul
+00017ef0: 7429 2c0d 0a20 2020 2020 2061 2073 696e  t),..      a sin
+00017f00: 676c 6520 7661 6c75 6520 6973 2072 6574  gle value is ret
+00017f10: 7572 6e65 6420 6966 2060 606c 6f77 6060  urned if ``low``
+00017f20: 2061 6e64 2060 6068 6967 6860 6020 6172   and ``high`` ar
+00017f30: 6520 626f 7468 2073 6361 6c61 7273 2e0d  e both scalars..
+00017f40: 0a20 2020 2020 204f 7468 6572 7769 7365  .      Otherwise
+00017f50: 2c20 6060 6e70 2e62 726f 6164 6361 7374  , ``np.broadcast
+00017f60: 286c 6f77 2c20 6869 6768 292e 7369 7a65  (low, high).size
+00017f70: 6060 2073 616d 706c 6573 2061 7265 2064  `` samples are d
+00017f80: 7261 776e 2e0d 0a20 206b 6579 203a 2050  rawn...  key : P
+00017f90: 524e 474b 6579 2c20 6f70 7469 6f6e 616c  RNGKey, optional
+00017fa0: 0d0a 2020 2020 2020 5468 6520 6b65 7920  ..      The key 
+00017fb0: 666f 7220 7468 6520 7261 6e64 6f6d 206e  for the random n
+00017fc0: 756d 6265 7220 6765 6e65 7261 746f 722e  umber generator.
+00017fd0: 2049 6620 6e6f 7420 6769 7665 6e2c 2074   If not given, t
+00017fe0: 6865 0d0a 2020 2020 2020 6465 6661 756c  he..      defaul
+00017ff0: 7420 7261 6e64 6f6d 206e 756d 6265 7220  t random number 
+00018000: 6765 6e65 7261 746f 7220 6973 2075 7365  generator is use
+00018010: 642e 0d0a 0d0a 2020 5265 7475 726e 730d  d.....  Returns.
+00018020: 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020 6f75  .  -------..  ou
+00018030: 7420 3a20 6e64 6172 7261 7920 6f72 2073  t : ndarray or s
+00018040: 6361 6c61 720d 0a20 2020 2020 2044 7261  calar..      Dra
+00018050: 776e 2073 616d 706c 6573 2066 726f 6d20  wn samples from 
+00018060: 7468 6520 7061 7261 6d65 7465 7269 7a65  the parameterize
+00018070: 6420 756e 6966 6f72 6d20 6469 7374 7269  d uniform distri
+00018080: 6275 7469 6f6e 2e0d 0a0d 0a20 2053 6565  bution.....  See
+00018090: 2041 6c73 6f0d 0a20 202d 2d2d 2d2d 2d2d   Also..  -------
+000180a0: 2d0d 0a20 2072 616e 6469 6e74 203a 2044  -..  randint : D
+000180b0: 6973 6372 6574 6520 756e 6966 6f72 6d20  iscrete uniform 
+000180c0: 6469 7374 7269 6275 7469 6f6e 2c20 7969  distribution, yi
+000180d0: 656c 6469 6e67 2069 6e74 6567 6572 732e  elding integers.
+000180e0: 0d0a 2020 7261 6e64 6f6d 5f69 6e74 6567  ..  random_integ
+000180f0: 6572 7320 3a20 4469 7363 7265 7465 2075  ers : Discrete u
+00018100: 6e69 666f 726d 2064 6973 7472 6962 7574  niform distribut
+00018110: 696f 6e20 6f76 6572 2074 6865 2063 6c6f  ion over the clo
+00018120: 7365 640d 0a20 2020 2020 2020 2020 2020  sed..           
+00018130: 2020 2020 2020 2020 2069 6e74 6572 7661           interva
+00018140: 6c20 6060 5b6c 6f77 2c20 6869 6768 5d60  l ``[low, high]`
+00018150: 602e 0d0a 2020 7261 6e64 6f6d 5f73 616d  `...  random_sam
+00018160: 706c 6520 3a20 466c 6f61 7473 2075 6e69  ple : Floats uni
+00018170: 666f 726d 6c79 2064 6973 7472 6962 7574  formly distribut
+00018180: 6564 206f 7665 7220 6060 5b30 2c20 3129  ed over ``[0, 1)
+00018190: 6060 2e0d 0a20 2072 616e 646f 6d20 3a20  ``...  random : 
+000181a0: 416c 6961 7320 666f 7220 6072 616e 646f  Alias for `rando
+000181b0: 6d5f 7361 6d70 6c65 602e 0d0a 2020 7261  m_sample`...  ra
+000181c0: 6e64 203a 2043 6f6e 7665 6e69 656e 6365  nd : Convenience
+000181d0: 2066 756e 6374 696f 6e20 7468 6174 2061   function that a
+000181e0: 6363 6570 7473 2064 696d 656e 7369 6f6e  ccepts dimension
+000181f0: 7320 6173 2069 6e70 7574 2c20 652e 672e  s as input, e.g.
+00018200: 2c0d 0a20 2020 2020 2020 2020 6060 7261  ,..         ``ra
+00018210: 6e64 2832 2c32 2960 6020 776f 756c 6420  nd(2,2)`` would 
+00018220: 6765 6e65 7261 7465 2061 2032 2d62 792d  generate a 2-by-
+00018230: 3220 6172 7261 7920 6f66 2066 6c6f 6174  2 array of float
+00018240: 732c 0d0a 2020 2020 2020 2020 2075 6e69  s,..         uni
+00018250: 666f 726d 6c79 2064 6973 7472 6962 7574  formly distribut
+00018260: 6564 206f 7665 7220 6060 5b30 2c20 3129  ed over ``[0, 1)
+00018270: 6060 2e0d 0a0d 0a20 204e 6f74 6573 0d0a  ``.....  Notes..
+00018280: 2020 2d2d 2d2d 2d0d 0a20 2054 6865 2070    -----..  The p
+00018290: 726f 6261 6269 6c69 7479 2064 656e 7369  robability densi
+000182a0: 7479 2066 756e 6374 696f 6e20 6f66 2074  ty function of t
+000182b0: 6865 2075 6e69 666f 726d 2064 6973 7472  he uniform distr
+000182c0: 6962 7574 696f 6e20 6973 0d0a 0d0a 2020  ibution is....  
+000182d0: 2e2e 206d 6174 683a 3a20 7028 7829 203d  .. math:: p(x) =
+000182e0: 205c 6672 6163 7b31 7d7b 6220 2d20 617d   \frac{1}{b - a}
+000182f0: 0d0a 0d0a 2020 616e 7977 6865 7265 2077  ....  anywhere w
+00018300: 6974 6869 6e20 7468 6520 696e 7465 7276  ithin the interv
+00018310: 616c 2060 605b 612c 2062 2960 602c 2061  al ``[a, b)``, a
+00018320: 6e64 207a 6572 6f20 656c 7365 7768 6572  nd zero elsewher
+00018330: 652e 0d0a 0d0a 2020 5768 656e 2060 6068  e.....  When ``h
+00018340: 6967 6860 6020 3d3d 2060 606c 6f77 6060  igh`` == ``low``
+00018350: 2c20 7661 6c75 6573 206f 6620 6060 6c6f  , values of ``lo
+00018360: 7760 6020 7769 6c6c 2062 6520 7265 7475  w`` will be retu
+00018370: 726e 6564 2e0d 0a20 2049 6620 6060 6869  rned...  If ``hi
+00018380: 6768 6060 203c 2060 606c 6f77 6060 2c20  gh`` < ``low``, 
+00018390: 7468 6520 7265 7375 6c74 7320 6172 6520  the results are 
+000183a0: 6f66 6669 6369 616c 6c79 2075 6e64 6566  officially undef
+000183b0: 696e 6564 0d0a 2020 616e 6420 6d61 7920  ined..  and may 
+000183c0: 6576 656e 7475 616c 6c79 2072 6169 7365  eventually raise
+000183d0: 2061 6e20 6572 726f 722c 2069 2e65 2e20   an error, i.e. 
+000183e0: 646f 206e 6f74 2072 656c 7920 6f6e 2074  do not rely on t
+000183f0: 6869 730d 0a20 2066 756e 6374 696f 6e20  his..  function 
+00018400: 746f 2062 6568 6176 6520 7768 656e 2070  to behave when p
+00018410: 6173 7365 6420 6172 6775 6d65 6e74 7320  assed arguments 
+00018420: 7361 7469 7366 7969 6e67 2074 6861 740d  satisfying that.
+00018430: 0a20 2069 6e65 7175 616c 6974 7920 636f  .  inequality co
+00018440: 6e64 6974 696f 6e2e 2054 6865 2060 6068  ndition. The ``h
+00018450: 6967 6860 6020 6c69 6d69 7420 6d61 7920  igh`` limit may 
+00018460: 6265 2069 6e63 6c75 6465 6420 696e 2074  be included in t
+00018470: 6865 0d0a 2020 7265 7475 726e 6564 2061  he..  returned a
+00018480: 7272 6179 206f 6620 666c 6f61 7473 2064  rray of floats d
+00018490: 7565 2074 6f20 666c 6f61 7469 6e67 2d70  ue to floating-p
+000184a0: 6f69 6e74 2072 6f75 6e64 696e 6720 696e  oint rounding in
+000184b0: 2074 6865 0d0a 2020 6571 7561 7469 6f6e   the..  equation
+000184c0: 2060 606c 6f77 202b 2028 6869 6768 2d6c   ``low + (high-l
+000184d0: 6f77 2920 2a20 7261 6e64 6f6d 5f73 616d  ow) * random_sam
+000184e0: 706c 6528 2960 602e 2046 6f72 2065 7861  ple()``. For exa
+000184f0: 6d70 6c65 3a0d 0a0d 0a20 203e 3e3e 2078  mple:....  >>> x
+00018500: 203d 206e 702e 666c 6f61 7433 3228 352a   = np.float32(5*
+00018510: 302e 3939 3939 3939 3939 290d 0a20 203e  0.99999999)..  >
+00018520: 3e3e 2078 0d0a 2020 352e 300d 0a0d 0a0d  >> x..  5.0.....
+00018530: 0a20 2045 7861 6d70 6c65 730d 0a20 202d  .  Examples..  -
+00018540: 2d2d 2d2d 2d2d 2d0d 0a20 2044 7261 7720  -------..  Draw 
+00018550: 7361 6d70 6c65 7320 6672 6f6d 2074 6865  samples from the
+00018560: 2064 6973 7472 6962 7574 696f 6e3a 0d0a   distribution:..
+00018570: 0d0a 2020 3e3e 3e20 7320 3d20 6272 6169  ..  >>> s = brai
+00018580: 6e63 6f72 652e 7261 6e64 6f6d 2e75 6e69  ncore.random.uni
+00018590: 666f 726d 282d 312c 302c 3130 3030 290d  form(-1,0,1000).
+000185a0: 0a0d 0a20 2041 6c6c 2076 616c 7565 7320  ...  All values 
+000185b0: 6172 6520 7769 7468 696e 2074 6865 2067  are within the g
+000185c0: 6976 656e 2069 6e74 6572 7661 6c3a 0d0a  iven interval:..
+000185d0: 0d0a 2020 3e3e 3e20 6e70 2e61 6c6c 2873  ..  >>> np.all(s
+000185e0: 203e 3d20 2d31 290d 0a20 2054 7275 650d   >= -1)..  True.
+000185f0: 0a20 203e 3e3e 206e 702e 616c 6c28 7320  .  >>> np.all(s 
+00018600: 3c20 3029 0d0a 2020 5472 7565 0d0a 0d0a  < 0)..  True....
+00018610: 2020 4469 7370 6c61 7920 7468 6520 6869    Display the hi
+00018620: 7374 6f67 7261 6d20 6f66 2074 6865 2073  stogram of the s
+00018630: 616d 706c 6573 2c20 616c 6f6e 6720 7769  amples, along wi
+00018640: 7468 2074 6865 0d0a 2020 7072 6f62 6162  th the..  probab
+00018650: 696c 6974 7920 6465 6e73 6974 7920 6675  ility density fu
+00018660: 6e63 7469 6f6e 3a0d 0a0d 0a20 203e 3e3e  nction:....  >>>
+00018670: 2069 6d70 6f72 7420 6d61 7470 6c6f 746c   import matplotl
+00018680: 6962 2e70 7970 6c6f 7420 6173 2070 6c74  ib.pyplot as plt
+00018690: 2020 2320 6e6f 7161 0d0a 2020 3e3e 3e20    # noqa..  >>> 
+000186a0: 636f 756e 742c 2062 696e 732c 2069 676e  count, bins, ign
+000186b0: 6f72 6564 203d 2070 6c74 2e68 6973 7428  ored = plt.hist(
+000186c0: 732c 2031 352c 2064 656e 7369 7479 3d54  s, 15, density=T
+000186d0: 7275 6529 0d0a 2020 3e3e 3e20 706c 742e  rue)..  >>> plt.
+000186e0: 706c 6f74 2862 696e 732c 206e 702e 6f6e  plot(bins, np.on
+000186f0: 6573 5f6c 696b 6528 6269 6e73 292c 206c  es_like(bins), l
+00018700: 696e 6577 6964 7468 3d32 2c20 636f 6c6f  inewidth=2, colo
+00018710: 723d 2772 2729 0d0a 2020 3e3e 3e20 706c  r='r')..  >>> pl
+00018720: 742e 7368 6f77 2829 0d0a 2020 2222 220d  t.show()..  """.
+00018730: 0a20 2072 6574 7572 6e20 4445 4641 554c  .  return DEFAUL
+00018740: 542e 756e 6966 6f72 6d28 6c6f 772c 2068  T.uniform(low, h
+00018750: 6967 682c 2073 697a 652c 206b 6579 3d6b  igh, size, key=k
+00018760: 6579 2c20 6474 7970 653d 6474 7970 6529  ey, dtype=dtype)
+00018770: 0d0a 0d0a 0d0a 6465 6620 7472 756e 6361  ......def trunca
+00018780: 7465 645f 6e6f 726d 616c 286c 6f77 6572  ted_normal(lower
+00018790: 2c20 7570 7065 722c 2073 697a 653a 204f  , upper, size: O
+000187a0: 7074 696f 6e61 6c5b 5369 7a65 5d20 3d20  ptional[Size] = 
+000187b0: 4e6f 6e65 2c20 6c6f 633d 302e 2c20 7363  None, loc=0., sc
+000187c0: 616c 653d 312e 2c0d 0a20 2020 2020 2020  ale=1.,..       
+000187d0: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
+000187e0: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
+000187f0: 4f72 4b65 795d 203d 204e 6f6e 652c 2064  OrKey] = None, d
+00018800: 7479 7065 3a20 4454 7970 654c 696b 6520  type: DTypeLike 
+00018810: 3d20 4e6f 6e65 293a 0d0a 2020 7222 2222  = None):..  r"""
+00018820: 5361 6d70 6c65 2074 7275 6e63 6174 6564  Sample truncated
+00018830: 2073 7461 6e64 6172 6420 6e6f 726d 616c   standard normal
+00018840: 2072 616e 646f 6d20 7661 6c75 6573 2077   random values w
+00018850: 6974 6820 6769 7665 6e20 7368 6170 6520  ith given shape 
+00018860: 616e 6420 6474 7970 652e 0d0a 0d0a 2020  and dtype.....  
+00018870: 4d65 7468 6f64 2062 6173 6564 206f 6e20  Method based on 
+00018880: 6874 7470 733a 2f2f 7065 6f70 6c65 2e73  https://people.s
+00018890: 632e 6673 752e 6564 752f 7e6a 6275 726b  c.fsu.edu/~jburk
+000188a0: 6172 6474 2f70 7265 7365 6e74 6174 696f  ardt/presentatio
+000188b0: 6e73 2f74 7275 6e63 6174 6564 5f6e 6f72  ns/truncated_nor
+000188c0: 6d61 6c2e 7064 660d 0a0d 0a0d 0a20 204e  mal.pdf......  N
+000188d0: 6f74 6573 0d0a 2020 2d2d 2d2d 2d0d 0a20  otes..  -----.. 
+000188e0: 2054 6869 7320 6469 7374 7269 6275 7469   This distributi
+000188f0: 6f6e 2069 7320 7468 6520 6e6f 726d 616c  on is the normal
+00018900: 2064 6973 7472 6962 7574 696f 6e20 6365   distribution ce
+00018910: 6e74 6572 6564 206f 6e20 6060 6c6f 6360  ntered on ``loc`
+00018920: 6020 2864 6566 6175 6c74 0d0a 2020 3029  ` (default..  0)
+00018930: 2c20 7769 7468 2073 7461 6e64 6172 6420  , with standard 
+00018940: 6465 7669 6174 696f 6e20 6060 7363 616c  deviation ``scal
+00018950: 6560 6020 2864 6566 6175 6c74 2031 292c  e`` (default 1),
+00018960: 2061 6e64 2063 6c69 7070 6564 2061 7420   and clipped at 
+00018970: 6060 6160 602c 0d0a 2020 6060 6260 6020  ``a``,..  ``b`` 
+00018980: 7374 616e 6461 7264 2064 6576 6961 7469  standard deviati
+00018990: 6f6e 7320 746f 2074 6865 206c 6566 742c  ons to the left,
+000189a0: 2072 6967 6874 2028 7265 7370 6563 7469   right (respecti
+000189b0: 7665 6c79 2920 6672 6f6d 2060 606c 6f63  vely) from ``loc
+000189c0: 6060 2e0d 0a20 2049 6620 6060 6d79 636c  ``...  If ``mycl
+000189d0: 6970 5f61 6060 2061 6e64 2060 606d 7963  ip_a`` and ``myc
+000189e0: 6c69 705f 6260 6020 6172 6520 636c 6970  lip_b`` are clip
+000189f0: 2076 616c 7565 7320 696e 2074 6865 2073   values in the s
+00018a00: 616d 706c 6520 7370 6163 6520 2861 730d  ample space (as.
+00018a10: 0a20 206f 7070 6f73 6564 2074 6f20 7468  .  opposed to th
+00018a20: 6520 6e75 6d62 6572 206f 6620 7374 616e  e number of stan
+00018a30: 6461 7264 2064 6576 6961 7469 6f6e 7329  dard deviations)
+00018a40: 2074 6865 6e20 7468 6579 2063 616e 2062   then they can b
+00018a50: 6520 636f 6e76 6572 7465 640d 0a20 2074  e converted..  t
+00018a60: 6f20 7468 6520 7265 7175 6972 6564 2066  o the required f
+00018a70: 6f72 6d20 6163 636f 7264 696e 6720 746f  orm according to
+00018a80: 3a3a 0d0a 0d0a 2020 2020 2020 612c 2062  ::....      a, b
+00018a90: 203d 2028 6d79 636c 6970 5f61 202d 206c   = (myclip_a - l
+00018aa0: 6f63 2920 2f20 7363 616c 652c 2028 6d79  oc) / scale, (my
+00018ab0: 636c 6970 5f62 202d 206c 6f63 2920 2f20  clip_b - loc) / 
+00018ac0: 7363 616c 650d 0a0d 0a0d 0a20 2050 6172  scale......  Par
+00018ad0: 616d 6574 6572 730d 0a20 202d 2d2d 2d2d  ameters..  -----
+00018ae0: 2d2d 2d2d 2d0d 0a20 206c 6f77 6572 203a  -----..  lower :
+00018af0: 2066 6c6f 6174 2c20 6e64 6172 7261 790d   float, ndarray.
+00018b00: 0a20 2020 2041 2066 6c6f 6174 206f 7220  .    A float or 
+00018b10: 6172 7261 7920 6f66 2066 6c6f 6174 7320  array of floats 
+00018b20: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
+00018b30: 206c 6f77 6572 2062 6f75 6e64 2066 6f72   lower bound for
+00018b40: 0d0a 2020 2020 7472 756e 6361 7469 6f6e  ..    truncation
+00018b50: 2e20 4d75 7374 2062 6520 6272 6f61 6463  . Must be broadc
+00018b60: 6173 742d 636f 6d70 6174 6962 6c65 2077  ast-compatible w
+00018b70: 6974 6820 6060 7570 7065 7260 602e 0d0a  ith ``upper``...
+00018b80: 2020 7570 7065 7220 3a20 666c 6f61 742c    upper : float,
+00018b90: 206e 6461 7272 6179 0d0a 2020 2020 4120   ndarray..    A 
+00018ba0: 666c 6f61 7420 6f72 2061 7272 6179 206f  float or array o
+00018bb0: 6620 666c 6f61 7473 2072 6570 7265 7365  f floats represe
+00018bc0: 6e74 696e 6720 7468 6520 2075 7070 6572  nting the  upper
+00018bd0: 2062 6f75 6e64 2066 6f72 0d0a 2020 2020   bound for..    
+00018be0: 7472 756e 6361 7469 6f6e 2e20 4d75 7374  truncation. Must
+00018bf0: 2062 6520 6272 6f61 6463 6173 742d 636f   be broadcast-co
+00018c00: 6d70 6174 6962 6c65 2077 6974 6820 6060  mpatible with ``
+00018c10: 6c6f 7765 7260 602e 0d0a 2020 6c6f 6320  lower``...  loc 
+00018c20: 3a20 666c 6f61 742c 206e 6461 7272 6179  : float, ndarray
+00018c30: 0d0a 2020 2020 4d65 616e 2028 2263 656e  ..    Mean ("cen
+00018c40: 7472 6522 2920 6f66 2074 6865 2064 6973  tre") of the dis
+00018c50: 7472 6962 7574 696f 6e20 6265 666f 7265  tribution before
+00018c60: 2074 7275 6e63 6174 696e 672e 204e 6f74   truncating. Not
+00018c70: 6520 7468 6174 200d 0a20 2020 2074 6865  e that ..    the
+00018c80: 206d 6561 6e20 6f66 2074 6865 2074 7275   mean of the tru
+00018c90: 6e63 6174 6564 2064 6973 7472 6962 7574  ncated distribut
+00018ca0: 696f 6e20 7769 6c6c 206e 6f74 2062 6520  ion will not be 
+00018cb0: 6578 6163 746c 7920 6571 7561 6c20 0d0a  exactly equal ..
+00018cc0: 2020 2020 746f 2060 606c 6f63 6060 2e0d      to ``loc``..
+00018cd0: 0a20 2073 697a 6520 3a20 6f70 7469 6f6e  .  size : option
+00018ce0: 616c 2c20 6c69 7374 206f 6620 696e 742c  al, list of int,
+00018cf0: 2074 7570 6c65 206f 6620 696e 740d 0a20   tuple of int.. 
+00018d00: 2020 2041 2074 7570 6c65 206f 6620 6e6f     A tuple of no
+00018d10: 6e6e 6567 6174 6976 6520 696e 7465 6765  nnegative intege
+00018d20: 7273 2073 7065 6369 6679 696e 6720 7468  rs specifying th
+00018d30: 6520 7265 7375 6c74 0d0a 2020 2020 7368  e result..    sh
+00018d40: 6170 652e 204d 7573 7420 6265 2062 726f  ape. Must be bro
+00018d50: 6164 6361 7374 2d63 6f6d 7061 7469 626c  adcast-compatibl
+00018d60: 6520 7769 7468 2060 606c 6f77 6572 6060  e with ``lower``
+00018d70: 2061 6e64 2060 6075 7070 6572 6060 2e20   and ``upper``. 
+00018d80: 5468 650d 0a20 2020 2064 6566 6175 6c74  The..    default
+00018d90: 2028 4e6f 6e65 2920 7072 6f64 7563 6573   (None) produces
+00018da0: 2061 2072 6573 756c 7420 7368 6170 6520   a result shape 
+00018db0: 6279 2062 726f 6164 6361 7374 696e 6720  by broadcasting 
+00018dc0: 6060 6c6f 7765 7260 6020 616e 640d 0a20  ``lower`` and.. 
+00018dd0: 2020 2060 6075 7070 6572 6060 2e0d 0a20     ``upper``... 
+00018de0: 206c 6f63 3a20 6f70 7469 6f6e 616c 2c20   loc: optional, 
+00018df0: 666c 6f61 742c 206e 6461 7272 6179 0d0a  float, ndarray..
+00018e00: 2020 2020 4120 666c 6f61 7420 6f72 2061      A float or a
+00018e10: 7272 6179 206f 6620 666c 6f61 7473 2072  rray of floats r
+00018e20: 6570 7265 7365 6e74 696e 6720 7468 6520  epresenting the 
+00018e30: 6d65 616e 206f 6620 7468 650d 0a20 2020  mean of the..   
+00018e40: 2064 6973 7472 6962 7574 696f 6e2e 2044   distribution. D
+00018e50: 6566 6175 6c74 2069 7320 302e 0d0a 2020  efault is 0...  
+00018e60: 7363 616c 6520 3a20 666c 6f61 742c 206e  scale : float, n
+00018e70: 6461 7272 6179 0d0a 2020 2020 5374 616e  darray..    Stan
+00018e80: 6461 7264 2064 6576 6961 7469 6f6e 2028  dard deviation (
+00018e90: 7370 7265 6164 206f 7220 2277 6964 7468  spread or "width
+00018ea0: 2229 206f 6620 7468 6520 6469 7374 7269  ") of the distri
+00018eb0: 6275 7469 6f6e 2e20 4d75 7374 2062 650d  bution. Must be.
+00018ec0: 0a20 2020 206e 6f6e 2d6e 6567 6174 6976  .    non-negativ
+00018ed0: 652e 2044 6566 6175 6c74 2069 7320 312e  e. Default is 1.
+00018ee0: 0d0a 2020 6474 7970 653a 206f 7074 696f  ..  dtype: optio
+00018ef0: 6e61 6c0d 0a20 2020 2054 6865 2066 6c6f  nal..    The flo
+00018f00: 6174 2064 7479 7065 2066 6f72 2074 6865  at dtype for the
+00018f10: 2072 6574 7572 6e65 6420 7661 6c75 6573   returned values
+00018f20: 2028 6465 6661 756c 7420 666c 6f61 7436   (default float6
+00018f30: 3420 6966 0d0a 2020 2020 6a61 785f 656e  4 if..    jax_en
+00018f40: 6162 6c65 5f78 3634 2069 7320 7472 7565  able_x64 is true
+00018f50: 2c20 6f74 6865 7277 6973 6520 666c 6f61  , otherwise floa
+00018f60: 7433 3229 2e0d 0a20 206b 6579 203a 2050  t32)...  key : P
+00018f70: 524e 474b 6579 2c20 6f70 7469 6f6e 616c  RNGKey, optional
+00018f80: 0d0a 2020 2020 2020 5468 6520 6b65 7920  ..      The key 
+00018f90: 666f 7220 7468 6520 7261 6e64 6f6d 206e  for the random n
+00018fa0: 756d 6265 7220 6765 6e65 7261 746f 722e  umber generator.
+00018fb0: 2049 6620 6e6f 7420 6769 7665 6e2c 2074   If not given, t
+00018fc0: 6865 0d0a 2020 2020 2020 6465 6661 756c  he..      defaul
+00018fd0: 7420 7261 6e64 6f6d 206e 756d 6265 7220  t random number 
+00018fe0: 6765 6e65 7261 746f 7220 6973 2075 7365  generator is use
+00018ff0: 642e 0d0a 0d0a 0d0a 2020 5265 7475 726e  d.......  Return
+00019000: 730d 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020  s..  -------..  
+00019010: 6f75 7420 3a20 4172 7261 790d 0a20 2020  out : Array..   
+00019020: 2041 2072 616e 646f 6d20 6172 7261 7920   A random array 
+00019030: 7769 7468 2074 6865 2073 7065 6369 6669  with the specifi
+00019040: 6564 2064 7479 7065 2061 6e64 2073 6861  ed dtype and sha
+00019050: 7065 2067 6976 656e 2062 7920 6060 7368  pe given by ``sh
+00019060: 6170 6560 6020 6966 0d0a 2020 2020 6060  ape`` if..    ``
+00019070: 7368 6170 6560 6020 6973 206e 6f74 204e  shape`` is not N
+00019080: 6f6e 652c 206f 7220 656c 7365 2062 7920  one, or else by 
+00019090: 6272 6f61 6463 6173 7469 6e67 2060 606c  broadcasting ``l
+000190a0: 6f77 6572 6060 2061 6e64 2060 6075 7070  ower`` and ``upp
+000190b0: 6572 6060 2e0d 0a20 2020 2052 6574 7572  er``...    Retur
+000190c0: 6e73 2076 616c 7565 7320 696e 2074 6865  ns values in the
+000190d0: 206f 7065 6e20 696e 7465 7276 616c 2060   open interval `
+000190e0: 6028 6c6f 7765 722c 2075 7070 6572 2960  `(lower, upper)`
+000190f0: 602e 0d0a 2020 2222 220d 0a20 2072 6574  `...  """..  ret
+00019100: 7572 6e20 4445 4641 554c 542e 7472 756e  urn DEFAULT.trun
+00019110: 6361 7465 645f 6e6f 726d 616c 286c 6f77  cated_normal(low
+00019120: 6572 2c20 7570 7065 722c 2073 697a 652c  er, upper, size,
+00019130: 206c 6f63 2c20 7363 616c 652c 206b 6579   loc, scale, key
+00019140: 3d6b 6579 2c20 6474 7970 653d 6474 7970  =key, dtype=dtyp
+00019150: 6529 0d0a 0d0a 0d0a 5261 6e64 6f6d 5374  e)......RandomSt
+00019160: 6174 652e 7472 756e 6361 7465 645f 6e6f  ate.truncated_no
+00019170: 726d 616c 2e5f 5f64 6f63 5f5f 203d 2074  rmal.__doc__ = t
+00019180: 7275 6e63 6174 6564 5f6e 6f72 6d61 6c2e  runcated_normal.
+00019190: 5f5f 646f 635f 5f0d 0a0d 0a0d 0a64 6566  __doc__......def
+000191a0: 2062 6572 6e6f 756c 6c69 2870 3d30 2e35   bernoulli(p=0.5
+000191b0: 2c20 7369 7a65 3a20 4f70 7469 6f6e 616c  , size: Optional
+000191c0: 5b53 697a 655d 203d 204e 6f6e 652c 206b  [Size] = None, k
+000191d0: 6579 3a20 4f70 7469 6f6e 616c 5b53 6565  ey: Optional[See
+000191e0: 644f 724b 6579 5d20 3d20 4e6f 6e65 293a  dOrKey] = None):
+000191f0: 0d0a 2020 7222 2222 5361 6d70 6c65 2042  ..  r"""Sample B
+00019200: 6572 6e6f 756c 6c69 2072 616e 646f 6d20  ernoulli random 
+00019210: 7661 6c75 6573 2077 6974 6820 6769 7665  values with give
+00019220: 6e20 7368 6170 6520 616e 6420 6d65 616e  n shape and mean
+00019230: 2e0d 0a0d 0a20 2050 6172 616d 6574 6572  .....  Parameter
+00019240: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
+00019250: 0a20 2070 3a20 666c 6f61 742c 2061 7272  .  p: float, arr
+00019260: 6179 5f6c 696b 652c 206f 7074 696f 6e61  ay_like, optiona
+00019270: 6c0d 0a20 2020 2041 2066 6c6f 6174 206f  l..    A float o
+00019280: 7220 6172 7261 7920 6f66 2066 6c6f 6174  r array of float
+00019290: 7320 666f 7220 7468 6520 6d65 616e 206f  s for the mean o
+000192a0: 6620 7468 6520 7261 6e64 6f6d 0d0a 2020  f the random..  
+000192b0: 2020 7661 7269 6162 6c65 732e 204d 7573    variables. Mus
+000192c0: 7420 6265 2062 726f 6164 6361 7374 2d63  t be broadcast-c
+000192d0: 6f6d 7061 7469 626c 6520 7769 7468 2060  ompatible with `
+000192e0: 6073 6861 7065 6060 2061 6e64 2074 6865  `shape`` and the
+000192f0: 2076 616c 7565 730d 0a20 2020 2073 686f   values..    sho
+00019300: 756c 6420 6265 2077 6974 6869 6e20 5b30  uld be within [0
+00019310: 2c20 315d 2e20 4465 6661 756c 7420 302e  , 1]. Default 0.
+00019320: 352e 0d0a 2020 7369 7a65 3a20 6f70 7469  5...  size: opti
+00019330: 6f6e 616c 2c20 7475 706c 6520 6f66 2069  onal, tuple of i
+00019340: 6e74 2c20 696e 740d 0a20 2020 2041 2074  nt, int..    A t
+00019350: 7570 6c65 206f 6620 6e6f 6e6e 6567 6174  uple of nonnegat
+00019360: 6976 6520 696e 7465 6765 7273 2072 6570  ive integers rep
+00019370: 7265 7365 6e74 696e 6720 7468 6520 7265  resenting the re
+00019380: 7375 6c74 0d0a 2020 2020 7368 6170 652e  sult..    shape.
+00019390: 204d 7573 7420 6265 2062 726f 6164 6361   Must be broadca
+000193a0: 7374 2d63 6f6d 7061 7469 626c 6520 7769  st-compatible wi
+000193b0: 7468 2060 6070 2e73 6861 7065 6060 2e20  th ``p.shape``. 
+000193c0: 5468 6520 6465 6661 756c 7420 284e 6f6e  The default (Non
+000193d0: 6529 0d0a 2020 2020 7072 6f64 7563 6573  e)..    produces
+000193e0: 2061 2072 6573 756c 7420 7368 6170 6520   a result shape 
+000193f0: 6571 7561 6c20 746f 2060 6070 2e73 6861  equal to ``p.sha
+00019400: 7065 6060 2e0d 0a20 206b 6579 203a 2050  pe``...  key : P
+00019410: 524e 474b 6579 2c20 6f70 7469 6f6e 616c  RNGKey, optional
+00019420: 0d0a 2020 2020 2020 5468 6520 6b65 7920  ..      The key 
+00019430: 666f 7220 7468 6520 7261 6e64 6f6d 206e  for the random n
+00019440: 756d 6265 7220 6765 6e65 7261 746f 722e  umber generator.
+00019450: 2049 6620 6e6f 7420 6769 7665 6e2c 2074   If not given, t
+00019460: 6865 0d0a 2020 2020 2020 6465 6661 756c  he..      defaul
+00019470: 7420 7261 6e64 6f6d 206e 756d 6265 7220  t random number 
+00019480: 6765 6e65 7261 746f 7220 6973 2075 7365  generator is use
+00019490: 642e 0d0a 0d0a 2020 5265 7475 726e 730d  d.....  Returns.
+000194a0: 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020 6f75  .  -------..  ou
+000194b0: 743a 2061 7272 6179 5f6c 696b 650d 0a20  t: array_like.. 
+000194c0: 2020 2041 2072 616e 646f 6d20 6172 7261     A random arra
+000194d0: 7920 7769 7468 2062 6f6f 6c65 616e 2064  y with boolean d
+000194e0: 7479 7065 2061 6e64 2073 6861 7065 2067  type and shape g
+000194f0: 6976 656e 2062 7920 6060 7368 6170 6560  iven by ``shape`
+00019500: 6020 6966 2060 6073 6861 7065 6060 0d0a  ` if ``shape``..
+00019510: 2020 2020 6973 206e 6f74 204e 6f6e 652c      is not None,
+00019520: 206f 7220 656c 7365 2060 6070 2e73 6861   or else ``p.sha
+00019530: 7065 6060 2e0d 0a20 2022 2222 0d0a 2020  pe``...  """..  
+00019540: 7265 7475 726e 2044 4546 4155 4c54 2e62  return DEFAULT.b
+00019550: 6572 6e6f 756c 6c69 2870 2c20 7369 7a65  ernoulli(p, size
+00019560: 2c20 6b65 793d 6b65 7929 0d0a 0d0a 0d0a  , key=key)......
+00019570: 6465 6620 6c6f 676e 6f72 6d61 6c28 6d65  def lognormal(me
+00019580: 616e 3d4e 6f6e 652c 2073 6967 6d61 3d4e  an=None, sigma=N
+00019590: 6f6e 652c 2073 697a 653a 204f 7074 696f  one, size: Optio
+000195a0: 6e61 6c5b 5369 7a65 5d20 3d20 4e6f 6e65  nal[Size] = None
+000195b0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000195c0: 206b 6579 3a20 4f70 7469 6f6e 616c 5b53   key: Optional[S
+000195d0: 6565 644f 724b 6579 5d20 3d20 4e6f 6e65  eedOrKey] = None
+000195e0: 2c20 6474 7970 653a 2044 5479 7065 4c69  , dtype: DTypeLi
+000195f0: 6b65 203d 204e 6f6e 6529 3a0d 0a20 2072  ke = None):..  r
+00019600: 2222 220d 0a20 2044 7261 7720 7361 6d70  """..  Draw samp
+00019610: 6c65 7320 6672 6f6d 2061 206c 6f67 2d6e  les from a log-n
+00019620: 6f72 6d61 6c20 6469 7374 7269 6275 7469  ormal distributi
+00019630: 6f6e 2e0d 0a0d 0a20 2044 7261 7720 7361  on.....  Draw sa
+00019640: 6d70 6c65 7320 6672 6f6d 2061 206c 6f67  mples from a log
+00019650: 2d6e 6f72 6d61 6c20 6469 7374 7269 6275  -normal distribu
+00019660: 7469 6f6e 2077 6974 6820 7370 6563 6966  tion with specif
+00019670: 6965 6420 6d65 616e 2c0d 0a20 2073 7461  ied mean,..  sta
+00019680: 6e64 6172 6420 6465 7669 6174 696f 6e2c  ndard deviation,
+00019690: 2061 6e64 2061 7272 6179 2073 6861 7065   and array shape
+000196a0: 2e20 204e 6f74 6520 7468 6174 2074 6865  .  Note that the
+000196b0: 206d 6561 6e20 616e 6420 7374 616e 6461   mean and standa
+000196c0: 7264 0d0a 2020 6465 7669 6174 696f 6e20  rd..  deviation 
+000196d0: 6172 6520 6e6f 7420 7468 6520 7661 6c75  are not the valu
+000196e0: 6573 2066 6f72 2074 6865 2064 6973 7472  es for the distr
+000196f0: 6962 7574 696f 6e20 6974 7365 6c66 2c20  ibution itself, 
+00019700: 6275 7420 6f66 2074 6865 0d0a 2020 756e  but of the..  un
+00019710: 6465 726c 7969 6e67 206e 6f72 6d61 6c20  derlying normal 
+00019720: 6469 7374 7269 6275 7469 6f6e 2069 7420  distribution it 
+00019730: 6973 2064 6572 6976 6564 2066 726f 6d2e  is derived from.
+00019740: 0d0a 0d0a 2020 5061 7261 6d65 7465 7273  ....  Parameters
+00019750: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  ..  ----------..
+00019760: 2020 6d65 616e 203a 2066 6c6f 6174 206f    mean : float o
+00019770: 7220 6172 7261 795f 6c69 6b65 206f 6620  r array_like of 
+00019780: 666c 6f61 7473 2c20 6f70 7469 6f6e 616c  floats, optional
+00019790: 0d0a 2020 2020 2020 4d65 616e 2076 616c  ..      Mean val
+000197a0: 7565 206f 6620 7468 6520 756e 6465 726c  ue of the underl
+000197b0: 7969 6e67 206e 6f72 6d61 6c20 6469 7374  ying normal dist
+000197c0: 7269 6275 7469 6f6e 2e20 4465 6661 756c  ribution. Defaul
+000197d0: 7420 6973 2030 2e0d 0a20 2073 6967 6d61  t is 0...  sigma
+000197e0: 203a 2066 6c6f 6174 206f 7220 6172 7261   : float or arra
+000197f0: 795f 6c69 6b65 206f 6620 666c 6f61 7473  y_like of floats
+00019800: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+00019810: 2020 5374 616e 6461 7264 2064 6576 6961    Standard devia
+00019820: 7469 6f6e 206f 6620 7468 6520 756e 6465  tion of the unde
+00019830: 726c 7969 6e67 206e 6f72 6d61 6c20 6469  rlying normal di
+00019840: 7374 7269 6275 7469 6f6e 2e20 4d75 7374  stribution. Must
+00019850: 2062 650d 0a20 2020 2020 206e 6f6e 2d6e   be..      non-n
+00019860: 6567 6174 6976 652e 2044 6566 6175 6c74  egative. Default
+00019870: 2069 7320 312e 0d0a 2020 7369 7a65 203a   is 1...  size :
+00019880: 2069 6e74 206f 7220 7475 706c 6520 6f66   int or tuple of
+00019890: 2069 6e74 732c 206f 7074 696f 6e61 6c0d   ints, optional.
+000198a0: 0a20 2020 2020 204f 7574 7075 7420 7368  .      Output sh
+000198b0: 6170 652e 2020 4966 2074 6865 2067 6976  ape.  If the giv
+000198c0: 656e 2073 6861 7065 2069 732c 2065 2e67  en shape is, e.g
+000198d0: 2e2c 2060 6028 6d2c 206e 2c20 6b29 6060  ., ``(m, n, k)``
+000198e0: 2c20 7468 656e 0d0a 2020 2020 2020 6060  , then..      ``
+000198f0: 6d20 2a20 6e20 2a20 6b60 6020 7361 6d70  m * n * k`` samp
+00019900: 6c65 7320 6172 6520 6472 6177 6e2e 2020  les are drawn.  
+00019910: 4966 2073 697a 6520 6973 2060 604e 6f6e  If size is ``Non
+00019920: 6560 6020 2864 6566 6175 6c74 292c 0d0a  e`` (default),..
+00019930: 2020 2020 2020 6120 7369 6e67 6c65 2076        a single v
+00019940: 616c 7565 2069 7320 7265 7475 726e 6564  alue is returned
+00019950: 2069 6620 6060 6d65 616e 6060 2061 6e64   if ``mean`` and
+00019960: 2060 6073 6967 6d61 6060 2061 7265 2062   ``sigma`` are b
+00019970: 6f74 6820 7363 616c 6172 732e 0d0a 2020  oth scalars...  
+00019980: 2020 2020 4f74 6865 7277 6973 652c 2060      Otherwise, `
+00019990: 606e 702e 6272 6f61 6463 6173 7428 6d65  `np.broadcast(me
+000199a0: 616e 2c20 7369 676d 6129 2e73 697a 6560  an, sigma).size`
+000199b0: 6020 7361 6d70 6c65 7320 6172 6520 6472  ` samples are dr
+000199c0: 6177 6e2e 0d0a 2020 6b65 7920 3a20 5052  awn...  key : PR
+000199d0: 4e47 4b65 792c 206f 7074 696f 6e61 6c0d  NGKey, optional.
+000199e0: 0a20 2020 2020 2054 6865 206b 6579 2066  .      The key f
+000199f0: 6f72 2074 6865 2072 616e 646f 6d20 6e75  or the random nu
+00019a00: 6d62 6572 2067 656e 6572 6174 6f72 2e20  mber generator. 
+00019a10: 4966 206e 6f74 2067 6976 656e 2c20 7468  If not given, th
+00019a20: 650d 0a20 2020 2020 2064 6566 6175 6c74  e..      default
+00019a30: 2072 616e 646f 6d20 6e75 6d62 6572 2067   random number g
+00019a40: 656e 6572 6174 6f72 2069 7320 7573 6564  enerator is used
+00019a50: 2e0d 0a0d 0a20 2052 6574 7572 6e73 0d0a  .....  Returns..
+00019a60: 2020 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574    -------..  out
+00019a70: 203a 206e 6461 7272 6179 206f 7220 7363   : ndarray or sc
+00019a80: 616c 6172 0d0a 2020 2020 2020 4472 6177  alar..      Draw
+00019a90: 6e20 7361 6d70 6c65 7320 6672 6f6d 2074  n samples from t
+00019aa0: 6865 2070 6172 616d 6574 6572 697a 6564  he parameterized
+00019ab0: 206c 6f67 2d6e 6f72 6d61 6c20 6469 7374   log-normal dist
+00019ac0: 7269 6275 7469 6f6e 2e0d 0a0d 0a20 2053  ribution.....  S
+00019ad0: 6565 2041 6c73 6f0d 0a20 202d 2d2d 2d2d  ee Also..  -----
+00019ae0: 2d2d 2d0d 0a20 2073 6369 7079 2e73 7461  ---..  scipy.sta
+00019af0: 7473 2e6c 6f67 6e6f 726d 203a 2070 726f  ts.lognorm : pro
+00019b00: 6261 6269 6c69 7479 2064 656e 7369 7479  bability density
+00019b10: 2066 756e 6374 696f 6e2c 2064 6973 7472   function, distr
+00019b20: 6962 7574 696f 6e2c 0d0a 2020 2020 2020  ibution,..      
+00019b30: 6375 6d75 6c61 7469 7665 2064 656e 7369  cumulative densi
+00019b40: 7479 2066 756e 6374 696f 6e2c 2065 7463  ty function, etc
+00019b50: 2e0d 0a0d 0a20 204e 6f74 6573 0d0a 2020  .....  Notes..  
+00019b60: 2d2d 2d2d 2d0d 0a20 2041 2076 6172 6961  -----..  A varia
+00019b70: 626c 6520 6078 6020 6861 7320 6120 6c6f  ble `x` has a lo
+00019b80: 672d 6e6f 726d 616c 2064 6973 7472 6962  g-normal distrib
+00019b90: 7574 696f 6e20 6966 2060 6c6f 6728 7829  ution if `log(x)
+00019ba0: 6020 6973 206e 6f72 6d61 6c6c 790d 0a20  ` is normally.. 
+00019bb0: 2064 6973 7472 6962 7574 6564 2e20 2054   distributed.  T
+00019bc0: 6865 2070 726f 6261 6269 6c69 7479 2064  he probability d
+00019bd0: 656e 7369 7479 2066 756e 6374 696f 6e20  ensity function 
+00019be0: 666f 7220 7468 6520 6c6f 672d 6e6f 726d  for the log-norm
+00019bf0: 616c 0d0a 2020 6469 7374 7269 6275 7469  al..  distributi
+00019c00: 6f6e 2069 733a 0d0a 0d0a 2020 2e2e 206d  on is:....  .. m
+00019c10: 6174 683a 3a20 7028 7829 203d 205c 6672  ath:: p(x) = \fr
+00019c20: 6163 7b31 7d7b 5c73 6967 6d61 2078 205c  ac{1}{\sigma x \
+00019c30: 7371 7274 7b32 5c70 697d 7d0d 0a20 2020  sqrt{2\pi}}..   
+00019c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c50: 655e 7b28 2d5c 6672 6163 7b28 6c6e 2878  e^{(-\frac{(ln(x
+00019c60: 292d 5c6d 7529 5e32 7d7b 325c 7369 676d  )-\mu)^2}{2\sigm
+00019c70: 615e 327d 297d 0d0a 0d0a 2020 7768 6572  a^2})}....  wher
+00019c80: 6520 3a6d 6174 683a 605c 6d75 6020 6973  e :math:`\mu` is
+00019c90: 2074 6865 206d 6561 6e20 616e 6420 3a6d   the mean and :m
+00019ca0: 6174 683a 605c 7369 676d 6160 2069 7320  ath:`\sigma` is 
+00019cb0: 7468 6520 7374 616e 6461 7264 0d0a 2020  the standard..  
+00019cc0: 6465 7669 6174 696f 6e20 6f66 2074 6865  deviation of the
+00019cd0: 206e 6f72 6d61 6c6c 7920 6469 7374 7269   normally distri
+00019ce0: 6275 7465 6420 6c6f 6761 7269 7468 6d20  buted logarithm 
+00019cf0: 6f66 2074 6865 2076 6172 6961 626c 652e  of the variable.
+00019d00: 0d0a 2020 4120 6c6f 672d 6e6f 726d 616c  ..  A log-normal
+00019d10: 2064 6973 7472 6962 7574 696f 6e20 7265   distribution re
+00019d20: 7375 6c74 7320 6966 2061 2072 616e 646f  sults if a rando
+00019d30: 6d20 7661 7269 6162 6c65 2069 7320 7468  m variable is th
+00019d40: 6520 2a70 726f 6475 6374 2a0d 0a20 206f  e *product*..  o
+00019d50: 6620 6120 6c61 7267 6520 6e75 6d62 6572  f a large number
+00019d60: 206f 6620 696e 6465 7065 6e64 656e 742c   of independent,
+00019d70: 2069 6465 6e74 6963 616c 6c79 2d64 6973   identically-dis
+00019d80: 7472 6962 7574 6564 2076 6172 6961 626c  tributed variabl
+00019d90: 6573 2069 6e0d 0a20 2074 6865 2073 616d  es in..  the sam
+00019da0: 6520 7761 7920 7468 6174 2061 206e 6f72  e way that a nor
+00019db0: 6d61 6c20 6469 7374 7269 6275 7469 6f6e  mal distribution
+00019dc0: 2072 6573 756c 7473 2069 6620 7468 6520   results if the 
+00019dd0: 7661 7269 6162 6c65 2069 7320 7468 650d  variable is the.
+00019de0: 0a20 202a 7375 6d2a 206f 6620 6120 6c61  .  *sum* of a la
+00019df0: 7267 6520 6e75 6d62 6572 206f 6620 696e  rge number of in
+00019e00: 6465 7065 6e64 656e 742c 2069 6465 6e74  dependent, ident
+00019e10: 6963 616c 6c79 2d64 6973 7472 6962 7574  ically-distribut
+00019e20: 6564 0d0a 2020 7661 7269 6162 6c65 732e  ed..  variables.
+00019e30: 0d0a 0d0a 2020 5265 6665 7265 6e63 6573  ....  References
+00019e40: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  ..  ----------..
+00019e50: 2020 2e2e 205b 315d 204c 696d 7065 7274    .. [1] Limpert
+00019e60: 2c20 452e 2c20 5374 6168 656c 2c20 572e  , E., Stahel, W.
+00019e70: 2041 2e2c 2061 6e64 2041 6262 742c 204d   A., and Abbt, M
+00019e80: 2e2c 2022 4c6f 672d 6e6f 726d 616c 0d0a  ., "Log-normal..
+00019e90: 2020 2020 2020 2020 2044 6973 7472 6962           Distrib
+00019ea0: 7574 696f 6e73 2061 6372 6f73 7320 7468  utions across th
+00019eb0: 6520 5363 6965 6e63 6573 3a20 4b65 7973  e Sciences: Keys
+00019ec0: 2061 6e64 2043 6c75 6573 2c22 0d0a 2020   and Clues,"..  
+00019ed0: 2020 2020 2020 2042 696f 5363 6965 6e63         BioScienc
+00019ee0: 652c 2056 6f6c 2e20 3531 2c20 4e6f 2e20  e, Vol. 51, No. 
+00019ef0: 352c 204d 6179 2c20 3230 3031 2e0d 0a20  5, May, 2001... 
+00019f00: 2020 2020 2020 2020 6874 7470 733a 2f2f          https://
+00019f10: 7374 6174 2e65 7468 7a2e 6368 2f7e 7374  stat.ethz.ch/~st
+00019f20: 6168 656c 2f6c 6f67 6e6f 726d 616c 2f62  ahel/lognormal/b
+00019f30: 696f 7363 6965 6e63 652e 7064 660d 0a20  ioscience.pdf.. 
+00019f40: 202e 2e20 5b32 5d20 5265 6973 732c 2052   .. [2] Reiss, R
+00019f50: 2e44 2e20 616e 6420 5468 6f6d 6173 2c20  .D. and Thomas, 
+00019f60: 4d2e 2c20 2253 7461 7469 7374 6963 616c  M., "Statistical
+00019f70: 2041 6e61 6c79 7369 7320 6f66 2045 7874   Analysis of Ext
+00019f80: 7265 6d65 0d0a 2020 2020 2020 2020 2056  reme..         V
+00019f90: 616c 7565 732c 2220 4261 7365 6c3a 2042  alues," Basel: B
+00019fa0: 6972 6b68 6175 7365 7220 5665 726c 6167  irkhauser Verlag
+00019fb0: 2c20 3230 3031 2c20 7070 2e20 3331 2d33  , 2001, pp. 31-3
+00019fc0: 322e 0d0a 0d0a 2020 4578 616d 706c 6573  2.....  Examples
+00019fd0: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ..  --------..  
+00019fe0: 4472 6177 2073 616d 706c 6573 2066 726f  Draw samples fro
+00019ff0: 6d20 7468 6520 6469 7374 7269 6275 7469  m the distributi
+0001a000: 6f6e 3a0d 0a0d 0a20 203e 3e3e 206d 752c  on:....  >>> mu,
+0001a010: 2073 6967 6d61 203d 2033 2e2c 2031 2e20   sigma = 3., 1. 
+0001a020: 2320 6d65 616e 2061 6e64 2073 7461 6e64  # mean and stand
+0001a030: 6172 6420 6465 7669 6174 696f 6e0d 0a20  ard deviation.. 
+0001a040: 203e 3e3e 2073 203d 2062 7261 696e 636f   >>> s = brainco
+0001a050: 7265 2e72 616e 646f 6d2e 6c6f 676e 6f72  re.random.lognor
+0001a060: 6d61 6c28 6d75 2c20 7369 676d 612c 2031  mal(mu, sigma, 1
+0001a070: 3030 3029 0d0a 0d0a 2020 4469 7370 6c61  000)....  Displa
+0001a080: 7920 7468 6520 6869 7374 6f67 7261 6d20  y the histogram 
+0001a090: 6f66 2074 6865 2073 616d 706c 6573 2c20  of the samples, 
+0001a0a0: 616c 6f6e 6720 7769 7468 0d0a 2020 7468  along with..  th
+0001a0b0: 6520 7072 6f62 6162 696c 6974 7920 6465  e probability de
+0001a0c0: 6e73 6974 7920 6675 6e63 7469 6f6e 3a0d  nsity function:.
+0001a0d0: 0a0d 0a20 203e 3e3e 2069 6d70 6f72 7420  ...  >>> import 
+0001a0e0: 6d61 7470 6c6f 746c 6962 2e70 7970 6c6f  matplotlib.pyplo
+0001a0f0: 7420 6173 2070 6c74 2020 2320 6e6f 7161  t as plt  # noqa
+0001a100: 0d0a 2020 3e3e 3e20 636f 756e 742c 2062  ..  >>> count, b
+0001a110: 696e 732c 2069 676e 6f72 6564 203d 2070  ins, ignored = p
+0001a120: 6c74 2e68 6973 7428 732c 2031 3030 2c20  lt.hist(s, 100, 
+0001a130: 6465 6e73 6974 793d 5472 7565 2c20 616c  density=True, al
+0001a140: 6967 6e3d 276d 6964 2729 0d0a 0d0a 2020  ign='mid')....  
+0001a150: 3e3e 3e20 7820 3d20 6e70 2e6c 696e 7370  >>> x = np.linsp
+0001a160: 6163 6528 6d69 6e28 6269 6e73 292c 206d  ace(min(bins), m
+0001a170: 6178 2862 696e 7329 2c20 3130 3030 3029  ax(bins), 10000)
+0001a180: 0d0a 2020 3e3e 3e20 7064 6620 3d20 286e  ..  >>> pdf = (n
+0001a190: 702e 6578 7028 2d28 6e70 2e6c 6f67 2878  p.exp(-(np.log(x
+0001a1a0: 2920 2d20 6d75 292a 2a32 202f 2028 3220  ) - mu)**2 / (2 
+0001a1b0: 2a20 7369 676d 612a 2a32 2929 0d0a 2020  * sigma**2))..  
+0001a1c0: 2e2e 2e20 2020 2020 2020 202f 2028 7820  ...        / (x 
+0001a1d0: 2a20 7369 676d 6120 2a20 6e70 2e73 7172  * sigma * np.sqr
+0001a1e0: 7428 3220 2a20 6e70 2e70 6929 2929 0d0a  t(2 * np.pi)))..
+0001a1f0: 0d0a 2020 3e3e 3e20 706c 742e 706c 6f74  ..  >>> plt.plot
+0001a200: 2878 2c20 7064 662c 206c 696e 6577 6964  (x, pdf, linewid
+0001a210: 7468 3d32 2c20 636f 6c6f 723d 2772 2729  th=2, color='r')
+0001a220: 0d0a 2020 3e3e 3e20 706c 742e 6178 6973  ..  >>> plt.axis
+0001a230: 2827 7469 6768 7427 290d 0a20 203e 3e3e  ('tight')..  >>>
+0001a240: 2070 6c74 2e73 686f 7728 290d 0a0d 0a20   plt.show().... 
+0001a250: 2044 656d 6f6e 7374 7261 7465 2074 6861   Demonstrate tha
+0001a260: 7420 7461 6b69 6e67 2074 6865 2070 726f  t taking the pro
+0001a270: 6475 6374 7320 6f66 2072 616e 646f 6d20  ducts of random 
+0001a280: 7361 6d70 6c65 7320 6672 6f6d 2061 2075  samples from a u
+0001a290: 6e69 666f 726d 0d0a 2020 6469 7374 7269  niform..  distri
+0001a2a0: 6275 7469 6f6e 2063 616e 2062 6520 6669  bution can be fi
+0001a2b0: 7420 7765 6c6c 2062 7920 6120 6c6f 672d  t well by a log-
+0001a2c0: 6e6f 726d 616c 2070 726f 6261 6269 6c69  normal probabili
+0001a2d0: 7479 2064 656e 7369 7479 0d0a 2020 6675  ty density..  fu
+0001a2e0: 6e63 7469 6f6e 2e0d 0a0d 0a20 203e 3e3e  nction.....  >>>
+0001a2f0: 2023 2047 656e 6572 6174 6520 6120 7468   # Generate a th
+0001a300: 6f75 7361 6e64 2073 616d 706c 6573 3a20  ousand samples: 
+0001a310: 6561 6368 2069 7320 7468 6520 7072 6f64  each is the prod
+0001a320: 7563 7420 6f66 2031 3030 2072 616e 646f  uct of 100 rando
+0001a330: 6d0d 0a20 203e 3e3e 2023 2076 616c 7565  m..  >>> # value
+0001a340: 732c 2064 7261 776e 2066 726f 6d20 6120  s, drawn from a 
+0001a350: 6e6f 726d 616c 2064 6973 7472 6962 7574  normal distribut
+0001a360: 696f 6e2e 0d0a 2020 3e3e 3e20 6220 3d20  ion...  >>> b = 
+0001a370: 5b5d 0d0a 2020 3e3e 3e20 666f 7220 6920  []..  >>> for i 
+0001a380: 696e 2072 616e 6765 2831 3030 3029 3a0d  in range(1000):.
+0001a390: 0a20 202e 2e2e 2020 2020 6120 3d20 3130  .  ...    a = 10
+0001a3a0: 2e20 2b20 6272 6169 6e63 6f72 652e 7261  . + braincore.ra
+0001a3b0: 6e64 6f6d 2e73 7461 6e64 6172 645f 6e6f  ndom.standard_no
+0001a3c0: 726d 616c 2831 3030 290d 0a20 202e 2e2e  rmal(100)..  ...
+0001a3d0: 2020 2020 622e 6170 7065 6e64 286e 702e      b.append(np.
+0001a3e0: 7072 6f64 7563 7428 6129 290d 0a0d 0a20  product(a)).... 
+0001a3f0: 203e 3e3e 2062 203d 206e 702e 6172 7261   >>> b = np.arra
+0001a400: 7928 6229 202f 206e 702e 6d69 6e28 6229  y(b) / np.min(b)
+0001a410: 2023 2073 6361 6c65 2076 616c 7565 7320   # scale values 
+0001a420: 746f 2062 6520 706f 7369 7469 7665 0d0a  to be positive..
+0001a430: 2020 3e3e 3e20 636f 756e 742c 2062 696e    >>> count, bin
+0001a440: 732c 2069 676e 6f72 6564 203d 2070 6c74  s, ignored = plt
+0001a450: 2e68 6973 7428 622c 2031 3030 2c20 6465  .hist(b, 100, de
+0001a460: 6e73 6974 793d 5472 7565 2c20 616c 6967  nsity=True, alig
+0001a470: 6e3d 276d 6964 2729 0d0a 2020 3e3e 3e20  n='mid')..  >>> 
+0001a480: 7369 676d 6120 3d20 6e70 2e73 7464 286e  sigma = np.std(n
+0001a490: 702e 6c6f 6728 6229 290d 0a20 203e 3e3e  p.log(b))..  >>>
+0001a4a0: 206d 7520 3d20 6e70 2e6d 6561 6e28 6e70   mu = np.mean(np
+0001a4b0: 2e6c 6f67 2862 2929 0d0a 0d0a 2020 3e3e  .log(b))....  >>
+0001a4c0: 3e20 7820 3d20 6e70 2e6c 696e 7370 6163  > x = np.linspac
+0001a4d0: 6528 6d69 6e28 6269 6e73 292c 206d 6178  e(min(bins), max
+0001a4e0: 2862 696e 7329 2c20 3130 3030 3029 0d0a  (bins), 10000)..
+0001a4f0: 2020 3e3e 3e20 7064 6620 3d20 286e 702e    >>> pdf = (np.
+0001a500: 6578 7028 2d28 6e70 2e6c 6f67 2878 2920  exp(-(np.log(x) 
+0001a510: 2d20 6d75 292a 2a32 202f 2028 3220 2a20  - mu)**2 / (2 * 
+0001a520: 7369 676d 612a 2a32 2929 0d0a 2020 2e2e  sigma**2))..  ..
+0001a530: 2e20 2020 2020 2020 202f 2028 7820 2a20  .        / (x * 
+0001a540: 7369 676d 6120 2a20 6e70 2e73 7172 7428  sigma * np.sqrt(
+0001a550: 3220 2a20 6e70 2e70 6929 2929 0d0a 0d0a  2 * np.pi)))....
+0001a560: 2020 3e3e 3e20 706c 742e 706c 6f74 2878    >>> plt.plot(x
+0001a570: 2c20 7064 662c 2063 6f6c 6f72 3d27 7227  , pdf, color='r'
+0001a580: 2c20 6c69 6e65 7769 6474 683d 3229 0d0a  , linewidth=2)..
+0001a590: 2020 3e3e 3e20 706c 742e 7368 6f77 2829    >>> plt.show()
+0001a5a0: 0d0a 2020 2222 220d 0a20 2072 6574 7572  ..  """..  retur
+0001a5b0: 6e20 4445 4641 554c 542e 6c6f 676e 6f72  n DEFAULT.lognor
+0001a5c0: 6d61 6c28 6d65 616e 2c20 7369 676d 612c  mal(mean, sigma,
+0001a5d0: 2073 697a 652c 206b 6579 3d6b 6579 2c20   size, key=key, 
+0001a5e0: 6474 7970 653d 6474 7970 6529 0d0a 0d0a  dtype=dtype)....
+0001a5f0: 0d0a 6465 6620 6269 6e6f 6d69 616c 286e  ..def binomial(n
+0001a600: 2c20 702c 2073 697a 653a 204f 7074 696f  , p, size: Optio
+0001a610: 6e61 6c5b 5369 7a65 5d20 3d20 4e6f 6e65  nal[Size] = None
+0001a620: 2c20 6b65 793a 204f 7074 696f 6e61 6c5b  , key: Optional[
+0001a630: 5365 6564 4f72 4b65 795d 203d 204e 6f6e  SeedOrKey] = Non
+0001a640: 652c 2064 7479 7065 3a20 4454 7970 654c  e, dtype: DTypeL
+0001a650: 696b 6520 3d20 4e6f 6e65 293a 0d0a 2020  ike = None):..  
+0001a660: 7222 2222 0d0a 2020 4472 6177 2073 616d  r"""..  Draw sam
+0001a670: 706c 6573 2066 726f 6d20 6120 6269 6e6f  ples from a bino
+0001a680: 6d69 616c 2064 6973 7472 6962 7574 696f  mial distributio
+0001a690: 6e2e 0d0a 0d0a 2020 5361 6d70 6c65 7320  n.....  Samples 
+0001a6a0: 6172 6520 6472 6177 6e20 6672 6f6d 2061  are drawn from a
+0001a6b0: 2062 696e 6f6d 6961 6c20 6469 7374 7269   binomial distri
+0001a6c0: 6275 7469 6f6e 2077 6974 6820 7370 6563  bution with spec
+0001a6d0: 6966 6965 640d 0a20 2070 6172 616d 6574  ified..  paramet
+0001a6e0: 6572 732c 206e 2074 7269 616c 7320 616e  ers, n trials an
+0001a6f0: 6420 7020 7072 6f62 6162 696c 6974 7920  d p probability 
+0001a700: 6f66 2073 7563 6365 7373 2077 6865 7265  of success where
+0001a710: 0d0a 2020 6e20 616e 2069 6e74 6567 6572  ..  n an integer
+0001a720: 203e 3d20 3020 616e 6420 7020 6973 2069   >= 0 and p is i
+0001a730: 6e20 7468 6520 696e 7465 7276 616c 205b  n the interval [
+0001a740: 302c 315d 2e20 286e 206d 6179 2062 650d  0,1]. (n may be.
+0001a750: 0a20 2069 6e70 7574 2061 7320 6120 666c  .  input as a fl
+0001a760: 6f61 742c 2062 7574 2069 7420 6973 2074  oat, but it is t
+0001a770: 7275 6e63 6174 6564 2074 6f20 616e 2069  runcated to an i
+0001a780: 6e74 6567 6572 2069 6e20 7573 6529 0d0a  nteger in use)..
+0001a790: 0d0a 2020 5061 7261 6d65 7465 7273 0d0a  ..  Parameters..
+0001a7a0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+0001a7b0: 6e20 3a20 696e 7420 6f72 2061 7272 6179  n : int or array
+0001a7c0: 5f6c 696b 6520 6f66 2069 6e74 730d 0a20  _like of ints.. 
+0001a7d0: 2020 2020 2050 6172 616d 6574 6572 206f       Parameter o
+0001a7e0: 6620 7468 6520 6469 7374 7269 6275 7469  f the distributi
+0001a7f0: 6f6e 2c20 3e3d 2030 2e20 466c 6f61 7473  on, >= 0. Floats
+0001a800: 2061 7265 2061 6c73 6f20 6163 6365 7074   are also accept
+0001a810: 6564 2c0d 0a20 2020 2020 2062 7574 2074  ed,..      but t
+0001a820: 6865 7920 7769 6c6c 2062 6520 7472 756e  hey will be trun
+0001a830: 6361 7465 6420 746f 2069 6e74 6567 6572  cated to integer
+0001a840: 732e 0d0a 2020 7020 3a20 666c 6f61 7420  s...  p : float 
+0001a850: 6f72 2061 7272 6179 5f6c 696b 6520 6f66  or array_like of
+0001a860: 2066 6c6f 6174 730d 0a20 2020 2020 2050   floats..      P
+0001a870: 6172 616d 6574 6572 206f 6620 7468 6520  arameter of the 
+0001a880: 6469 7374 7269 6275 7469 6f6e 2c20 3e3d  distribution, >=
+0001a890: 2030 2061 6e64 203c 3d31 2e0d 0a20 2073   0 and <=1...  s
+0001a8a0: 697a 6520 3a20 696e 7420 6f72 2074 7570  ize : int or tup
+0001a8b0: 6c65 206f 6620 696e 7473 2c20 6f70 7469  le of ints, opti
+0001a8c0: 6f6e 616c 0d0a 2020 2020 2020 4f75 7470  onal..      Outp
+0001a8d0: 7574 2073 6861 7065 2e20 2049 6620 7468  ut shape.  If th
+0001a8e0: 6520 6769 7665 6e20 7368 6170 6520 6973  e given shape is
+0001a8f0: 2c20 652e 672e 2c20 6060 286d 2c20 6e2c  , e.g., ``(m, n,
+0001a900: 206b 2960 602c 2074 6865 6e0d 0a20 2020   k)``, then..   
+0001a910: 2020 2060 606d 202a 206e 202a 206b 6060     ``m * n * k``
+0001a920: 2073 616d 706c 6573 2061 7265 2064 7261   samples are dra
+0001a930: 776e 2e20 2049 6620 7369 7a65 2069 7320  wn.  If size is 
+0001a940: 6060 4e6f 6e65 6060 2028 6465 6661 756c  ``None`` (defaul
+0001a950: 7429 2c0d 0a20 2020 2020 2061 2073 696e  t),..      a sin
+0001a960: 676c 6520 7661 6c75 6520 6973 2072 6574  gle value is ret
+0001a970: 7572 6e65 6420 6966 2060 606e 6060 2061  urned if ``n`` a
+0001a980: 6e64 2060 6070 6060 2061 7265 2062 6f74  nd ``p`` are bot
+0001a990: 6820 7363 616c 6172 732e 0d0a 2020 2020  h scalars...    
+0001a9a0: 2020 4f74 6865 7277 6973 652c 2060 606e    Otherwise, ``n
+0001a9b0: 702e 6272 6f61 6463 6173 7428 6e2c 2070  p.broadcast(n, p
+0001a9c0: 292e 7369 7a65 6060 2073 616d 706c 6573  ).size`` samples
+0001a9d0: 2061 7265 2064 7261 776e 2e0d 0a20 206b   are drawn...  k
+0001a9e0: 6579 203a 2050 524e 474b 6579 2c20 6f70  ey : PRNGKey, op
+0001a9f0: 7469 6f6e 616c 0d0a 2020 2020 2020 5468  tional..      Th
+0001aa00: 6520 6b65 7920 666f 7220 7468 6520 7261  e key for the ra
+0001aa10: 6e64 6f6d 206e 756d 6265 7220 6765 6e65  ndom number gene
+0001aa20: 7261 746f 722e 2049 6620 6e6f 7420 6769  rator. If not gi
+0001aa30: 7665 6e2c 2074 6865 0d0a 2020 2020 2020  ven, the..      
+0001aa40: 6465 6661 756c 7420 7261 6e64 6f6d 206e  default random n
+0001aa50: 756d 6265 7220 6765 6e65 7261 746f 7220  umber generator 
+0001aa60: 6973 2075 7365 642e 0d0a 0d0a 2020 5265  is used.....  Re
+0001aa70: 7475 726e 730d 0a20 202d 2d2d 2d2d 2d2d  turns..  -------
+0001aa80: 0d0a 2020 6f75 7420 3a20 6e64 6172 7261  ..  out : ndarra
+0001aa90: 7920 6f72 2073 6361 6c61 720d 0a20 2020  y or scalar..   
+0001aaa0: 2020 2044 7261 776e 2073 616d 706c 6573     Drawn samples
+0001aab0: 2066 726f 6d20 7468 6520 7061 7261 6d65   from the parame
+0001aac0: 7465 7269 7a65 6420 6269 6e6f 6d69 616c  terized binomial
+0001aad0: 2064 6973 7472 6962 7574 696f 6e2c 2077   distribution, w
+0001aae0: 6865 7265 0d0a 2020 2020 2020 6561 6368  here..      each
+0001aaf0: 2073 616d 706c 6520 6973 2065 7175 616c   sample is equal
+0001ab00: 2074 6f20 7468 6520 6e75 6d62 6572 206f   to the number o
+0001ab10: 6620 7375 6363 6573 7365 7320 6f76 6572  f successes over
+0001ab20: 2074 6865 206e 2074 7269 616c 732e 0d0a   the n trials...
+0001ab30: 0d0a 2020 5365 6520 416c 736f 0d0a 2020  ..  See Also..  
+0001ab40: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 7363 6970  --------..  scip
+0001ab50: 792e 7374 6174 732e 6269 6e6f 6d20 3a20  y.stats.binom : 
+0001ab60: 7072 6f62 6162 696c 6974 7920 6465 6e73  probability dens
+0001ab70: 6974 7920 6675 6e63 7469 6f6e 2c20 6469  ity function, di
+0001ab80: 7374 7269 6275 7469 6f6e 206f 720d 0a20  stribution or.. 
+0001ab90: 2020 2020 2063 756d 756c 6174 6976 6520       cumulative 
+0001aba0: 6465 6e73 6974 7920 6675 6e63 7469 6f6e  density function
+0001abb0: 2c20 6574 632e 0d0a 0d0a 2020 4e6f 7465  , etc.....  Note
+0001abc0: 730d 0a20 202d 2d2d 2d2d 0d0a 2020 5468  s..  -----..  Th
+0001abd0: 6520 7072 6f62 6162 696c 6974 7920 6465  e probability de
+0001abe0: 6e73 6974 7920 666f 7220 7468 6520 6269  nsity for the bi
+0001abf0: 6e6f 6d69 616c 2064 6973 7472 6962 7574  nomial distribut
+0001ac00: 696f 6e20 6973 0d0a 0d0a 2020 2e2e 206d  ion is....  .. m
+0001ac10: 6174 683a 3a20 5028 4e29 203d 205c 6269  ath:: P(N) = \bi
+0001ac20: 6e6f 6d7b 6e7d 7b4e 7d70 5e4e 2831 2d70  nom{n}{N}p^N(1-p
+0001ac30: 295e 7b6e 2d4e 7d2c 0d0a 0d0a 2020 7768  )^{n-N},....  wh
+0001ac40: 6572 6520 3a6d 6174 683a 606e 6020 6973  ere :math:`n` is
+0001ac50: 2074 6865 206e 756d 6265 7220 6f66 2074   the number of t
+0001ac60: 7269 616c 732c 203a 6d61 7468 3a60 7060  rials, :math:`p`
+0001ac70: 2069 7320 7468 6520 7072 6f62 6162 696c   is the probabil
+0001ac80: 6974 790d 0a20 206f 6620 7375 6363 6573  ity..  of succes
+0001ac90: 732c 2061 6e64 203a 6d61 7468 3a60 4e60  s, and :math:`N`
+0001aca0: 2069 7320 7468 6520 6e75 6d62 6572 206f   is the number o
+0001acb0: 6620 7375 6363 6573 7365 732e 0d0a 0d0a  f successes.....
+0001acc0: 2020 5768 656e 2065 7374 696d 6174 696e    When estimatin
+0001acd0: 6720 7468 6520 7374 616e 6461 7264 2065  g the standard e
+0001ace0: 7272 6f72 206f 6620 6120 7072 6f70 6f72  rror of a propor
+0001acf0: 7469 6f6e 2069 6e20 6120 706f 7075 6c61  tion in a popula
+0001ad00: 7469 6f6e 2062 790d 0a20 2075 7369 6e67  tion by..  using
+0001ad10: 2061 2072 616e 646f 6d20 7361 6d70 6c65   a random sample
+0001ad20: 2c20 7468 6520 6e6f 726d 616c 2064 6973  , the normal dis
+0001ad30: 7472 6962 7574 696f 6e20 776f 726b 7320  tribution works 
+0001ad40: 7765 6c6c 2075 6e6c 6573 7320 7468 650d  well unless the.
+0001ad50: 0a20 2070 726f 6475 6374 2070 2a6e 203c  .  product p*n <
+0001ad60: 3d35 2c20 7768 6572 6520 7020 3d20 706f  =5, where p = po
+0001ad70: 7075 6c61 7469 6f6e 2070 726f 706f 7274  pulation proport
+0001ad80: 696f 6e20 6573 7469 6d61 7465 2c20 616e  ion estimate, an
+0001ad90: 6420 6e20 3d0d 0a20 206e 756d 6265 7220  d n =..  number 
+0001ada0: 6f66 2073 616d 706c 6573 2c20 696e 2077  of samples, in w
+0001adb0: 6869 6368 2063 6173 6520 7468 6520 6269  hich case the bi
+0001adc0: 6e6f 6d69 616c 2064 6973 7472 6962 7574  nomial distribut
+0001add0: 696f 6e20 6973 2075 7365 640d 0a20 2069  ion is used..  i
+0001ade0: 6e73 7465 6164 2e20 466f 7220 6578 616d  nstead. For exam
+0001adf0: 706c 652c 2061 2073 616d 706c 6520 6f66  ple, a sample of
+0001ae00: 2031 3520 7065 6f70 6c65 2073 686f 7773   15 people shows
+0001ae10: 2034 2077 686f 2061 7265 206c 6566 740d   4 who are left.
+0001ae20: 0a20 2068 616e 6465 642c 2061 6e64 2031  .  handed, and 1
+0001ae30: 3120 7768 6f20 6172 6520 7269 6768 7420  1 who are right 
+0001ae40: 6861 6e64 6564 2e20 5468 656e 2070 203d  handed. Then p =
+0001ae50: 2034 2f31 3520 3d20 3237 252e 2030 2e32   4/15 = 27%. 0.2
+0001ae60: 372a 3135 203d 2034 2c0d 0a20 2073 6f20  7*15 = 4,..  so 
+0001ae70: 7468 6520 6269 6e6f 6d69 616c 2064 6973  the binomial dis
+0001ae80: 7472 6962 7574 696f 6e20 7368 6f75 6c64  tribution should
+0001ae90: 2062 6520 7573 6564 2069 6e20 7468 6973   be used in this
+0001aea0: 2063 6173 652e 0d0a 0d0a 2020 5265 6665   case.....  Refe
+0001aeb0: 7265 6e63 6573 0d0a 2020 2d2d 2d2d 2d2d  rences..  ------
+0001aec0: 2d2d 2d2d 0d0a 2020 2e2e 205b 315d 2044  ----..  .. [1] D
+0001aed0: 616c 6761 6172 642c 2050 6574 6572 2c20  algaard, Peter, 
+0001aee0: 2249 6e74 726f 6475 6374 6f72 7920 5374  "Introductory St
+0001aef0: 6174 6973 7469 6373 2077 6974 6820 5222  atistics with R"
+0001af00: 2c0d 0a20 2020 2020 2020 2020 5370 7269  ,..         Spri
+0001af10: 6e67 6572 2d56 6572 6c61 672c 2032 3030  nger-Verlag, 200
+0001af20: 322e 0d0a 2020 2e2e 205b 325d 2047 6c61  2...  .. [2] Gla
+0001af30: 6e74 7a2c 2053 7461 6e74 6f6e 2041 2e20  ntz, Stanton A. 
+0001af40: 2250 7269 6d65 7220 6f66 2042 696f 7374  "Primer of Biost
+0001af50: 6174 6973 7469 6373 2e22 2c20 4d63 4772  atistics.", McGr
+0001af60: 6177 2d48 696c 6c2c 0d0a 2020 2020 2020  aw-Hill,..      
+0001af70: 2020 2046 6966 7468 2045 6469 7469 6f6e     Fifth Edition
+0001af80: 2c20 3230 3032 2e0d 0a20 202e 2e20 5b33  , 2002...  .. [3
+0001af90: 5d20 4c65 6e74 6e65 722c 204d 6172 7669  ] Lentner, Marvi
+0001afa0: 6e2c 2022 456c 656d 656e 7461 7279 2041  n, "Elementary A
+0001afb0: 7070 6c69 6564 2053 7461 7469 7374 6963  pplied Statistic
+0001afc0: 7322 2c20 426f 6764 656e 0d0a 2020 2020  s", Bogden..    
+0001afd0: 2020 2020 2061 6e64 2051 7569 676c 6579       and Quigley
+0001afe0: 2c20 3139 3732 2e0d 0a20 202e 2e20 5b34  , 1972...  .. [4
+0001aff0: 5d20 5765 6973 7374 6569 6e2c 2045 7269  ] Weisstein, Eri
+0001b000: 6320 572e 2022 4269 6e6f 6d69 616c 2044  c W. "Binomial D
+0001b010: 6973 7472 6962 7574 696f 6e2e 2220 4672  istribution." Fr
+0001b020: 6f6d 204d 6174 6857 6f72 6c64 2d2d 410d  om MathWorld--A.
+0001b030: 0a20 2020 2020 2020 2020 576f 6c66 7261  .         Wolfra
+0001b040: 6d20 5765 6220 5265 736f 7572 6365 2e0d  m Web Resource..
+0001b050: 0a20 2020 2020 2020 2020 6874 7470 3a2f  .         http:/
+0001b060: 2f6d 6174 6877 6f72 6c64 2e77 6f6c 6672  /mathworld.wolfr
+0001b070: 616d 2e63 6f6d 2f42 696e 6f6d 6961 6c44  am.com/BinomialD
+0001b080: 6973 7472 6962 7574 696f 6e2e 6874 6d6c  istribution.html
+0001b090: 0d0a 2020 2e2e 205b 355d 2057 696b 6970  ..  .. [5] Wikip
+0001b0a0: 6564 6961 2c20 2242 696e 6f6d 6961 6c20  edia, "Binomial 
+0001b0b0: 6469 7374 7269 6275 7469 6f6e 222c 0d0a  distribution",..
+0001b0c0: 2020 2020 2020 2020 2068 7474 7073 3a2f           https:/
+0001b0d0: 2f65 6e2e 7769 6b69 7065 6469 612e 6f72  /en.wikipedia.or
+0001b0e0: 672f 7769 6b69 2f42 696e 6f6d 6961 6c5f  g/wiki/Binomial_
+0001b0f0: 6469 7374 7269 6275 7469 6f6e 0d0a 0d0a  distribution....
+0001b100: 2020 4578 616d 706c 6573 0d0a 2020 2d2d    Examples..  --
+0001b110: 2d2d 2d2d 2d2d 0d0a 2020 4472 6177 2073  ------..  Draw s
+0001b120: 616d 706c 6573 2066 726f 6d20 7468 6520  amples from the 
+0001b130: 6469 7374 7269 6275 7469 6f6e 3a0d 0a0d  distribution:...
+0001b140: 0a20 203e 3e3e 206e 2c20 7020 3d20 3130  .  >>> n, p = 10
+0001b150: 2c20 2e35 2020 2320 6e75 6d62 6572 206f  , .5  # number o
+0001b160: 6620 7472 6961 6c73 2c20 7072 6f62 6162  f trials, probab
+0001b170: 696c 6974 7920 6f66 2065 6163 6820 7472  ility of each tr
+0001b180: 6961 6c0d 0a20 203e 3e3e 2073 203d 2062  ial..  >>> s = b
+0001b190: 7261 696e 636f 7265 2e72 616e 646f 6d2e  raincore.random.
+0001b1a0: 6269 6e6f 6d69 616c 286e 2c20 702c 2031  binomial(n, p, 1
+0001b1b0: 3030 3029 0d0a 2020 2320 7265 7375 6c74  000)..  # result
+0001b1c0: 206f 6620 666c 6970 7069 6e67 2061 2063   of flipping a c
+0001b1d0: 6f69 6e20 3130 2074 696d 6573 2c20 7465  oin 10 times, te
+0001b1e0: 7374 6564 2031 3030 3020 7469 6d65 732e  sted 1000 times.
+0001b1f0: 0d0a 0d0a 2020 4120 7265 616c 2077 6f72  ....  A real wor
+0001b200: 6c64 2065 7861 6d70 6c65 2e20 4120 636f  ld example. A co
+0001b210: 6d70 616e 7920 6472 696c 6c73 2039 2077  mpany drills 9 w
+0001b220: 696c 642d 6361 7420 6f69 6c20 6578 706c  ild-cat oil expl
+0001b230: 6f72 6174 696f 6e0d 0a20 2077 656c 6c73  oration..  wells
+0001b240: 2c20 6561 6368 2077 6974 6820 616e 2065  , each with an e
+0001b250: 7374 696d 6174 6564 2070 726f 6261 6269  stimated probabi
+0001b260: 6c69 7479 206f 6620 7375 6363 6573 7320  lity of success 
+0001b270: 6f66 2030 2e31 2e20 416c 6c20 6e69 6e65  of 0.1. All nine
+0001b280: 0d0a 2020 7765 6c6c 7320 6661 696c 2e20  ..  wells fail. 
+0001b290: 5768 6174 2069 7320 7468 6520 7072 6f62  What is the prob
+0001b2a0: 6162 696c 6974 7920 6f66 2074 6861 7420  ability of that 
+0001b2b0: 6861 7070 656e 696e 673f 0d0a 0d0a 2020  happening?....  
+0001b2c0: 4c65 7427 7320 646f 2032 302c 3030 3020  Let's do 20,000 
+0001b2d0: 7472 6961 6c73 206f 6620 7468 6520 6d6f  trials of the mo
+0001b2e0: 6465 6c2c 2061 6e64 2063 6f75 6e74 2074  del, and count t
+0001b2f0: 6865 206e 756d 6265 7220 7468 6174 0d0a  he number that..
+0001b300: 2020 6765 6e65 7261 7465 207a 6572 6f20    generate zero 
+0001b310: 706f 7369 7469 7665 2072 6573 756c 7473  positive results
+0001b320: 2e0d 0a0d 0a20 203e 3e3e 2073 756d 2862  .....  >>> sum(b
+0001b330: 7261 696e 636f 7265 2e72 616e 646f 6d2e  raincore.random.
+0001b340: 6269 6e6f 6d69 616c 2839 2c20 302e 312c  binomial(9, 0.1,
+0001b350: 2032 3030 3030 2920 3d3d 2030 292f 3230   20000) == 0)/20
+0001b360: 3030 302e 0d0a 2020 2320 616e 7377 6572  000...  # answer
+0001b370: 203d 2030 2e33 3838 3835 2c20 6f72 2033   = 0.38885, or 3
+0001b380: 3825 2e0d 0a20 2022 2222 0d0a 2020 7265  8%...  """..  re
+0001b390: 7475 726e 2044 4546 4155 4c54 2e62 696e  turn DEFAULT.bin
+0001b3a0: 6f6d 6961 6c28 6e2c 2070 2c20 7369 7a65  omial(n, p, size
+0001b3b0: 2c20 6b65 793d 6b65 792c 2064 7479 7065  , key=key, dtype
+0001b3c0: 3d64 7479 7065 290d 0a0d 0a0d 0a64 6566  =dtype)......def
+0001b3d0: 2063 6869 7371 7561 7265 2864 662c 2073   chisquare(df, s
+0001b3e0: 697a 653a 204f 7074 696f 6e61 6c5b 5369  ize: Optional[Si
+0001b3f0: 7a65 5d20 3d20 4e6f 6e65 2c20 6b65 793a  ze] = None, key:
+0001b400: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
+0001b410: 4b65 795d 203d 204e 6f6e 652c 2064 7479  Key] = None, dty
+0001b420: 7065 3a20 4454 7970 654c 696b 6520 3d20  pe: DTypeLike = 
+0001b430: 4e6f 6e65 293a 0d0a 2020 7222 2222 0d0a  None):..  r"""..
+0001b440: 2020 4472 6177 2073 616d 706c 6573 2066    Draw samples f
+0001b450: 726f 6d20 6120 6368 692d 7371 7561 7265  rom a chi-square
+0001b460: 2064 6973 7472 6962 7574 696f 6e2e 0d0a   distribution...
+0001b470: 0d0a 2020 5768 656e 2060 6466 6020 696e  ..  When `df` in
+0001b480: 6465 7065 6e64 656e 7420 7261 6e64 6f6d  dependent random
+0001b490: 2076 6172 6961 626c 6573 2c20 6561 6368   variables, each
+0001b4a0: 2077 6974 6820 7374 616e 6461 7264 206e   with standard n
+0001b4b0: 6f72 6d61 6c0d 0a20 2064 6973 7472 6962  ormal..  distrib
+0001b4c0: 7574 696f 6e73 2028 6d65 616e 2030 2c20  utions (mean 0, 
+0001b4d0: 7661 7269 616e 6365 2031 292c 2061 7265  variance 1), are
+0001b4e0: 2073 7175 6172 6564 2061 6e64 2073 756d   squared and sum
+0001b4f0: 6d65 642c 2074 6865 0d0a 2020 7265 7375  med, the..  resu
+0001b500: 6c74 696e 6720 6469 7374 7269 6275 7469  lting distributi
+0001b510: 6f6e 2069 7320 6368 692d 7371 7561 7265  on is chi-square
+0001b520: 2028 7365 6520 4e6f 7465 7329 2e20 2054   (see Notes).  T
+0001b530: 6869 7320 6469 7374 7269 6275 7469 6f6e  his distribution
+0001b540: 0d0a 2020 6973 206f 6674 656e 2075 7365  ..  is often use
+0001b550: 6420 696e 2068 7970 6f74 6865 7369 7320  d in hypothesis 
+0001b560: 7465 7374 696e 672e 0d0a 0d0a 2020 5061  testing.....  Pa
+0001b570: 7261 6d65 7465 7273 0d0a 2020 2d2d 2d2d  rameters..  ----
+0001b580: 2d2d 2d2d 2d2d 0d0a 2020 6466 203a 2066  ------..  df : f
+0001b590: 6c6f 6174 206f 7220 6172 7261 795f 6c69  loat or array_li
+0001b5a0: 6b65 206f 6620 666c 6f61 7473 0d0a 2020  ke of floats..  
+0001b5b0: 2020 2020 204e 756d 6265 7220 6f66 2064       Number of d
+0001b5c0: 6567 7265 6573 206f 6620 6672 6565 646f  egrees of freedo
+0001b5d0: 6d2c 206d 7573 7420 6265 203e 2030 2e0d  m, must be > 0..
+0001b5e0: 0a20 2073 697a 6520 3a20 696e 7420 6f72  .  size : int or
+0001b5f0: 2074 7570 6c65 206f 6620 696e 7473 2c20   tuple of ints, 
+0001b600: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+0001b610: 4f75 7470 7574 2073 6861 7065 2e20 2049  Output shape.  I
+0001b620: 6620 7468 6520 6769 7665 6e20 7368 6170  f the given shap
+0001b630: 6520 6973 2c20 652e 672e 2c20 6060 286d  e is, e.g., ``(m
+0001b640: 2c20 6e2c 206b 2960 602c 2074 6865 6e0d  , n, k)``, then.
+0001b650: 0a20 2020 2020 2060 606d 202a 206e 202a  .      ``m * n *
+0001b660: 206b 6060 2073 616d 706c 6573 2061 7265   k`` samples are
+0001b670: 2064 7261 776e 2e20 2049 6620 7369 7a65   drawn.  If size
+0001b680: 2069 7320 6060 4e6f 6e65 6060 2028 6465   is ``None`` (de
+0001b690: 6661 756c 7429 2c0d 0a20 2020 2020 2061  fault),..      a
+0001b6a0: 2073 696e 676c 6520 7661 6c75 6520 6973   single value is
+0001b6b0: 2072 6574 7572 6e65 6420 6966 2060 6064   returned if ``d
+0001b6c0: 6660 6020 6973 2061 2073 6361 6c61 722e  f`` is a scalar.
+0001b6d0: 2020 4f74 6865 7277 6973 652c 0d0a 2020    Otherwise,..  
+0001b6e0: 2020 2020 6060 6e70 2e61 7272 6179 2864      ``np.array(d
+0001b6f0: 6629 2e73 697a 6560 6020 7361 6d70 6c65  f).size`` sample
+0001b700: 7320 6172 6520 6472 6177 6e2e 0d0a 2020  s are drawn...  
+0001b710: 6b65 7920 3a20 5052 4e47 4b65 792c 206f  key : PRNGKey, o
+0001b720: 7074 696f 6e61 6c0d 0a20 2020 2020 2054  ptional..      T
+0001b730: 6865 206b 6579 2066 6f72 2074 6865 2072  he key for the r
+0001b740: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
+0001b750: 6572 6174 6f72 2e20 4966 206e 6f74 2067  erator. If not g
+0001b760: 6976 656e 2c20 7468 650d 0a20 2020 2020  iven, the..     
+0001b770: 2064 6566 6175 6c74 2072 616e 646f 6d20   default random 
+0001b780: 6e75 6d62 6572 2067 656e 6572 6174 6f72  number generator
+0001b790: 2069 7320 7573 6564 2e0d 0a0d 0a20 2052   is used.....  R
+0001b7a0: 6574 7572 6e73 0d0a 2020 2d2d 2d2d 2d2d  eturns..  ------
+0001b7b0: 2d0d 0a20 206f 7574 203a 206e 6461 7272  -..  out : ndarr
+0001b7c0: 6179 206f 7220 7363 616c 6172 0d0a 2020  ay or scalar..  
+0001b7d0: 2020 2020 4472 6177 6e20 7361 6d70 6c65      Drawn sample
+0001b7e0: 7320 6672 6f6d 2074 6865 2070 6172 616d  s from the param
+0001b7f0: 6574 6572 697a 6564 2063 6869 2d73 7175  eterized chi-squ
+0001b800: 6172 6520 6469 7374 7269 6275 7469 6f6e  are distribution
+0001b810: 2e0d 0a0d 0a20 2052 6169 7365 730d 0a20  .....  Raises.. 
+0001b820: 202d 2d2d 2d2d 2d0d 0a20 2056 616c 7565   ------..  Value
+0001b830: 4572 726f 720d 0a20 2020 2020 2057 6865  Error..      Whe
+0001b840: 6e20 6064 6660 203c 3d20 3020 6f72 2077  n `df` <= 0 or w
+0001b850: 6865 6e20 616e 2069 6e61 7070 726f 7072  hen an inappropr
+0001b860: 6961 7465 2060 7369 7a65 6020 2865 2e67  iate `size` (e.g
+0001b870: 2e20 6060 7369 7a65 3d2d 3160 6029 0d0a  . ``size=-1``)..
+0001b880: 2020 2020 2020 6973 2067 6976 656e 2e0d        is given..
+0001b890: 0a0d 0a20 204e 6f74 6573 0d0a 2020 2d2d  ...  Notes..  --
+0001b8a0: 2d2d 2d0d 0a20 2054 6865 2076 6172 6961  ---..  The varia
+0001b8b0: 626c 6520 6f62 7461 696e 6564 2062 7920  ble obtained by 
+0001b8c0: 7375 6d6d 696e 6720 7468 6520 7371 7561  summing the squa
+0001b8d0: 7265 7320 6f66 2060 6466 6020 696e 6465  res of `df` inde
+0001b8e0: 7065 6e64 656e 742c 0d0a 2020 7374 616e  pendent,..  stan
+0001b8f0: 6461 7264 206e 6f72 6d61 6c6c 7920 6469  dard normally di
 0001b900: 7374 7269 6275 7465 6420 7261 6e64 6f6d  stributed random
-0001b910: 2076 6172 6961 626c 6520 6361 6e20 6265   variable can be
-0001b920: 2073 6565 6e20 6173 2061 206d 756c 7469   seen as a multi
-0001b930: 7661 7269 6174 650d 0a20 2067 656e 6572  variate..  gener
-0001b940: 616c 697a 6174 696f 6e20 6f66 2061 2042  alization of a B
-0001b950: 6574 6120 6469 7374 7269 6275 7469 6f6e  eta distribution
-0001b960: 2e20 5468 6520 4469 7269 6368 6c65 7420  . The Dirichlet 
-0001b970: 6469 7374 7269 6275 7469 6f6e 0d0a 2020  distribution..  
-0001b980: 6973 2061 2063 6f6e 6a75 6761 7465 2070  is a conjugate p
-0001b990: 7269 6f72 206f 6620 6120 6d75 6c74 696e  rior of a multin
-0001b9a0: 6f6d 6961 6c20 6469 7374 7269 6275 7469  omial distributi
-0001b9b0: 6f6e 2069 6e20 4261 7965 7369 616e 0d0a  on in Bayesian..
-0001b9c0: 2020 696e 6665 7265 6e63 652e 0d0a 0d0a    inference.....
-0001b9d0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-0001b9e0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 616c  ----------..  al
-0001b9f0: 7068 6120 3a20 7365 7175 656e 6365 206f  pha : sequence o
-0001ba00: 6620 666c 6f61 7473 2c20 6c65 6e67 7468  f floats, length
-0001ba10: 206b 0d0a 2020 2020 2020 5061 7261 6d65   k..      Parame
-0001ba20: 7465 7220 6f66 2074 6865 2064 6973 7472  ter of the distr
-0001ba30: 6962 7574 696f 6e20 286c 656e 6774 6820  ibution (length 
-0001ba40: 6060 6b60 6020 666f 7220 7361 6d70 6c65  ``k`` for sample
-0001ba50: 206f 660d 0a20 2020 2020 206c 656e 6774   of..      lengt
-0001ba60: 6820 6060 6b60 6029 2e0d 0a20 2073 697a  h ``k``)...  siz
-0001ba70: 6520 3a20 696e 7420 6f72 2074 7570 6c65  e : int or tuple
-0001ba80: 206f 6620 696e 7473 2c20 6f70 7469 6f6e   of ints, option
-0001ba90: 616c 0d0a 2020 2020 2020 4f75 7470 7574  al..      Output
-0001baa0: 2073 6861 7065 2e20 2049 6620 7468 6520   shape.  If the 
-0001bab0: 6769 7665 6e20 7368 6170 6520 6973 2c20  given shape is, 
-0001bac0: 652e 672e 2c20 6060 286d 2c20 6e29 6060  e.g., ``(m, n)``
-0001bad0: 2c20 7468 656e 0d0a 2020 2020 2020 6060  , then..      ``
-0001bae0: 6d20 2a20 6e20 2a20 6b60 6020 7361 6d70  m * n * k`` samp
-0001baf0: 6c65 7320 6172 6520 6472 6177 6e2e 2020  les are drawn.  
-0001bb00: 4465 6661 756c 7420 6973 204e 6f6e 652c  Default is None,
-0001bb10: 2069 6e20 7768 6963 6820 6361 7365 2061   in which case a
-0001bb20: 0d0a 2020 2020 2020 7665 6374 6f72 206f  ..      vector o
-0001bb30: 6620 6c65 6e67 7468 2060 606b 6060 2069  f length ``k`` i
-0001bb40: 7320 7265 7475 726e 6564 2e0d 0a20 206b  s returned...  k
-0001bb50: 6579 203a 2050 524e 474b 6579 2c20 6f70  ey : PRNGKey, op
-0001bb60: 7469 6f6e 616c 0d0a 2020 2020 2020 5468  tional..      Th
-0001bb70: 6520 6b65 7920 666f 7220 7468 6520 7261  e key for the ra
-0001bb80: 6e64 6f6d 206e 756d 6265 7220 6765 6e65  ndom number gene
-0001bb90: 7261 746f 722e 2049 6620 6e6f 7420 6769  rator. If not gi
-0001bba0: 7665 6e2c 2074 6865 0d0a 2020 2020 2020  ven, the..      
-0001bbb0: 6465 6661 756c 7420 7261 6e64 6f6d 206e  default random n
-0001bbc0: 756d 6265 7220 6765 6e65 7261 746f 7220  umber generator 
-0001bbd0: 6973 2075 7365 642e 0d0a 0d0a 2020 5265  is used.....  Re
-0001bbe0: 7475 726e 730d 0a20 202d 2d2d 2d2d 2d2d  turns..  -------
-0001bbf0: 0d0a 2020 7361 6d70 6c65 7320 3a20 6e64  ..  samples : nd
-0001bc00: 6172 7261 792c 0d0a 2020 2020 2020 5468  array,..      Th
-0001bc10: 6520 6472 6177 6e20 7361 6d70 6c65 732c  e drawn samples,
-0001bc20: 206f 6620 7368 6170 6520 6060 2873 697a   of shape ``(siz
-0001bc30: 652c 206b 2960 602e 0d0a 0d0a 2020 5261  e, k)``.....  Ra
-0001bc40: 6973 6573 0d0a 2020 2d2d 2d2d 2d2d 0d0a  ises..  ------..
-0001bc50: 2020 5661 6c75 6545 7272 6f72 0d0a 2020    ValueError..  
-0001bc60: 2020 2020 4966 2061 6e79 2076 616c 7565      If any value
-0001bc70: 2069 6e20 6060 616c 7068 6160 6020 6973   in ``alpha`` is
-0001bc80: 206c 6573 7320 7468 616e 206f 7220 6571   less than or eq
-0001bc90: 7561 6c20 746f 207a 6572 6f0d 0a0d 0a20  ual to zero.... 
-0001bca0: 204e 6f74 6573 0d0a 2020 2d2d 2d2d 2d0d   Notes..  -----.
-0001bcb0: 0a20 2054 6865 2044 6972 6963 686c 6574  .  The Dirichlet
-0001bcc0: 2064 6973 7472 6962 7574 696f 6e20 6973   distribution is
-0001bcd0: 2061 2064 6973 7472 6962 7574 696f 6e20   a distribution 
-0001bce0: 6f76 6572 2076 6563 746f 7273 0d0a 2020  over vectors..  
-0001bcf0: 3a6d 6174 683a 6078 6020 7468 6174 2066  :math:`x` that f
-0001bd00: 756c 6669 6c20 7468 6520 636f 6e64 6974  ulfil the condit
-0001bd10: 696f 6e73 203a 6d61 7468 3a60 785f 693e  ions :math:`x_i>
-0001bd20: 3060 2061 6e64 0d0a 2020 3a6d 6174 683a  0` and..  :math:
-0001bd30: 605c 7375 6d5f 7b69 3d31 7d5e 6b20 785f  `\sum_{i=1}^k x_
-0001bd40: 6920 3d20 3160 2e0d 0a0d 0a20 2054 6865  i = 1`.....  The
-0001bd50: 2070 726f 6261 6269 6c69 7479 2064 656e   probability den
-0001bd60: 7369 7479 2066 756e 6374 696f 6e20 3a6d  sity function :m
-0001bd70: 6174 683a 6070 6020 6f66 2061 0d0a 2020  ath:`p` of a..  
-0001bd80: 4469 7269 6368 6c65 742d 6469 7374 7269  Dirichlet-distri
-0001bd90: 6275 7465 6420 7261 6e64 6f6d 2076 6563  buted random vec
-0001bda0: 746f 7220 3a6d 6174 683a 6058 6020 6973  tor :math:`X` is
-0001bdb0: 0d0a 2020 7072 6f70 6f72 7469 6f6e 616c  ..  proportional
-0001bdc0: 2074 6f0d 0a0d 0a20 202e 2e20 6d61 7468   to....  .. math
-0001bdd0: 3a3a 2070 2878 2920 5c70 726f 7074 6f20  :: p(x) \propto 
-0001bde0: 5c70 726f 645f 7b69 3d31 7d5e 7b6b 7d7b  \prod_{i=1}^{k}{
-0001bdf0: 785e 7b5c 616c 7068 615f 692d 317d 5f69  x^{\alpha_i-1}_i
-0001be00: 7d2c 0d0a 0d0a 2020 7768 6572 6520 3a6d  },....  where :m
-0001be10: 6174 683a 605c 616c 7068 6160 2069 7320  ath:`\alpha` is 
-0001be20: 6120 7665 6374 6f72 2063 6f6e 7461 696e  a vector contain
-0001be30: 696e 6720 7468 6520 706f 7369 7469 7665  ing the positive
-0001be40: 0d0a 2020 636f 6e63 656e 7472 6174 696f  ..  concentratio
-0001be50: 6e20 7061 7261 6d65 7465 7273 2e0d 0a0d  n parameters....
-0001be60: 0a20 2054 6865 206d 6574 686f 6420 7573  .  The method us
-0001be70: 6573 2074 6865 2066 6f6c 6c6f 7769 6e67  es the following
-0001be80: 2070 726f 7065 7274 7920 666f 7220 636f   property for co
-0001be90: 6d70 7574 6174 696f 6e3a 206c 6574 203a  mputation: let :
-0001bea0: 6d61 7468 3a60 5960 0d0a 2020 6265 2061  math:`Y`..  be a
-0001beb0: 2072 616e 646f 6d20 7665 6374 6f72 2077   random vector w
-0001bec0: 6869 6368 2068 6173 2063 6f6d 706f 6e65  hich has compone
-0001bed0: 6e74 7320 7468 6174 2066 6f6c 6c6f 7720  nts that follow 
-0001bee0: 6120 7374 616e 6461 7264 2067 616d 6d61  a standard gamma
-0001bef0: 0d0a 2020 6469 7374 7269 6275 7469 6f6e  ..  distribution
-0001bf00: 2c20 7468 656e 203a 6d61 7468 3a60 5820  , then :math:`X 
-0001bf10: 3d20 5c66 7261 637b 317d 7b5c 7375 6d5f  = \frac{1}{\sum_
-0001bf20: 7b69 3d31 7d5e 6b7b 595f 697d 7d20 5960  {i=1}^k{Y_i}} Y`
-0001bf30: 0d0a 2020 6973 2044 6972 6963 686c 6574  ..  is Dirichlet
-0001bf40: 2d64 6973 7472 6962 7574 6564 0d0a 0d0a  -distributed....
-0001bf50: 2020 5265 6665 7265 6e63 6573 0d0a 2020    References..  
-0001bf60: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2e2e  ----------..  ..
-0001bf70: 205b 315d 2044 6176 6964 204d 634b 6179   [1] David McKay
-0001bf80: 2c20 2249 6e66 6f72 6d61 7469 6f6e 2054  , "Information T
-0001bf90: 6865 6f72 792c 2049 6e66 6572 656e 6365  heory, Inference
-0001bfa0: 2061 6e64 204c 6561 726e 696e 670d 0a20   and Learning.. 
-0001bfb0: 2020 2020 2020 2020 416c 676f 7269 7468          Algorith
-0001bfc0: 6d73 2c22 2063 6861 7074 6572 2032 332c  ms," chapter 23,
-0001bfd0: 0d0a 2020 2020 2020 2020 2068 7474 703a  ..         http:
-0001bfe0: 2f2f 7777 772e 696e 6665 7265 6e63 652e  //www.inference.
-0001bff0: 6f72 672e 756b 2f6d 6163 6b61 792f 6974  org.uk/mackay/it
-0001c000: 696c 612f 0d0a 2020 2e2e 205b 325d 2057  ila/..  .. [2] W
-0001c010: 696b 6970 6564 6961 2c20 2244 6972 6963  ikipedia, "Diric
-0001c020: 686c 6574 2064 6973 7472 6962 7574 696f  hlet distributio
-0001c030: 6e22 2c0d 0a20 2020 2020 2020 2020 6874  n",..         ht
-0001c040: 7470 733a 2f2f 656e 2e77 696b 6970 6564  tps://en.wikiped
-0001c050: 6961 2e6f 7267 2f77 696b 692f 4469 7269  ia.org/wiki/Diri
-0001c060: 6368 6c65 745f 6469 7374 7269 6275 7469  chlet_distributi
-0001c070: 6f6e 0d0a 0d0a 2020 4578 616d 706c 6573  on....  Examples
-0001c080: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ..  --------..  
-0001c090: 5461 6b69 6e67 2061 6e20 6578 616d 706c  Taking an exampl
-0001c0a0: 6520 6369 7465 6420 696e 2057 696b 6970  e cited in Wikip
-0001c0b0: 6564 6961 2c20 7468 6973 2064 6973 7472  edia, this distr
-0001c0c0: 6962 7574 696f 6e20 6361 6e20 6265 2075  ibution can be u
-0001c0d0: 7365 6420 6966 0d0a 2020 6f6e 6520 7761  sed if..  one wa
-0001c0e0: 6e74 6564 2074 6f20 6375 7420 7374 7269  nted to cut stri
-0001c0f0: 6e67 7320 2865 6163 6820 6f66 2069 6e69  ngs (each of ini
-0001c100: 7469 616c 206c 656e 6774 6820 312e 3029  tial length 1.0)
-0001c110: 2069 6e74 6f20 4b20 7069 6563 6573 0d0a   into K pieces..
-0001c120: 2020 7769 7468 2064 6966 6665 7265 6e74    with different
-0001c130: 206c 656e 6774 6873 2c20 7768 6572 6520   lengths, where 
-0001c140: 6561 6368 2070 6965 6365 2068 6164 2c20  each piece had, 
-0001c150: 6f6e 2061 7665 7261 6765 2c20 6120 6465  on average, a de
-0001c160: 7369 676e 6174 6564 0d0a 2020 6176 6572  signated..  aver
-0001c170: 6167 6520 6c65 6e67 7468 2c20 6275 7420  age length, but 
-0001c180: 616c 6c6f 7769 6e67 2073 6f6d 6520 7661  allowing some va
-0001c190: 7269 6174 696f 6e20 696e 2074 6865 2072  riation in the r
-0001c1a0: 656c 6174 6976 6520 7369 7a65 7320 6f66  elative sizes of
-0001c1b0: 0d0a 2020 7468 6520 7069 6563 6573 2e0d  ..  the pieces..
-0001c1c0: 0a0d 0a20 203e 3e3e 2073 203d 2062 632e  ...  >>> s = bc.
-0001c1d0: 7261 6e64 6f6d 2e64 6972 6963 686c 6574  random.dirichlet
-0001c1e0: 2828 3130 2c20 352c 2033 292c 2032 3029  ((10, 5, 3), 20)
-0001c1f0: 2e74 7261 6e73 706f 7365 2829 0d0a 0d0a  .transpose()....
-0001c200: 2020 3e3e 3e20 696d 706f 7274 206d 6174    >>> import mat
-0001c210: 706c 6f74 6c69 622e 7079 706c 6f74 2061  plotlib.pyplot a
-0001c220: 7320 706c 7420 2023 206e 6f71 610d 0a20  s plt  # noqa.. 
-0001c230: 203e 3e3e 2070 6c74 2e62 6172 6828 7261   >>> plt.barh(ra
-0001c240: 6e67 6528 3230 292c 2073 5b30 5d29 0d0a  nge(20), s[0])..
-0001c250: 2020 3e3e 3e20 706c 742e 6261 7268 2872    >>> plt.barh(r
-0001c260: 616e 6765 2832 3029 2c20 735b 315d 2c20  ange(20), s[1], 
-0001c270: 6c65 6674 3d73 5b30 5d2c 2063 6f6c 6f72  left=s[0], color
-0001c280: 3d27 6727 290d 0a20 203e 3e3e 2070 6c74  ='g')..  >>> plt
-0001c290: 2e62 6172 6828 7261 6e67 6528 3230 292c  .barh(range(20),
-0001c2a0: 2073 5b32 5d2c 206c 6566 743d 735b 305d   s[2], left=s[0]
-0001c2b0: 2b73 5b31 5d2c 2063 6f6c 6f72 3d27 7227  +s[1], color='r'
-0001c2c0: 290d 0a20 203e 3e3e 2070 6c74 2e74 6974  )..  >>> plt.tit
-0001c2d0: 6c65 2822 4c65 6e67 7468 7320 6f66 2053  le("Lengths of S
-0001c2e0: 7472 696e 6773 2229 0d0a 2020 2222 220d  trings")..  """.
-0001c2f0: 0a20 2072 6574 7572 6e20 4445 4641 554c  .  return DEFAUL
-0001c300: 542e 6469 7269 6368 6c65 7428 616c 7068  T.dirichlet(alph
-0001c310: 612c 2073 697a 652c 206b 6579 3d6b 6579  a, size, key=key
-0001c320: 2c20 6474 7970 653d 6474 7970 6529 0d0a  , dtype=dtype)..
-0001c330: 0d0a 0d0a 6465 6620 6765 6f6d 6574 7269  ....def geometri
-0001c340: 6328 702c 2073 697a 653a 204f 7074 696f  c(p, size: Optio
-0001c350: 6e61 6c5b 5369 7a65 5d20 3d20 4e6f 6e65  nal[Size] = None
-0001c360: 2c20 6b65 793a 204f 7074 696f 6e61 6c5b  , key: Optional[
-0001c370: 5365 6564 4f72 4b65 795d 203d 204e 6f6e  SeedOrKey] = Non
-0001c380: 652c 2064 7479 7065 3a20 4454 7970 654c  e, dtype: DTypeL
-0001c390: 696b 6520 3d20 4e6f 6e65 293a 0d0a 2020  ike = None):..  
-0001c3a0: 7222 2222 0d0a 2020 4472 6177 2073 616d  r"""..  Draw sam
-0001c3b0: 706c 6573 2066 726f 6d20 7468 6520 6765  ples from the ge
-0001c3c0: 6f6d 6574 7269 6320 6469 7374 7269 6275  ometric distribu
-0001c3d0: 7469 6f6e 2e0d 0a0d 0a20 2042 6572 6e6f  tion.....  Berno
-0001c3e0: 756c 6c69 2074 7269 616c 7320 6172 6520  ulli trials are 
-0001c3f0: 6578 7065 7269 6d65 6e74 7320 7769 7468  experiments with
-0001c400: 206f 6e65 206f 6620 7477 6f20 6f75 7463   one of two outc
-0001c410: 6f6d 6573 3a0d 0a20 2073 7563 6365 7373  omes:..  success
-0001c420: 206f 7220 6661 696c 7572 6520 2861 6e20   or failure (an 
-0001c430: 6578 616d 706c 6520 6f66 2073 7563 6820  example of such 
-0001c440: 616e 2065 7870 6572 696d 656e 7420 6973  an experiment is
-0001c450: 2066 6c69 7070 696e 670d 0a20 2061 2063   flipping..  a c
-0001c460: 6f69 6e29 2e20 2054 6865 2067 656f 6d65  oin).  The geome
-0001c470: 7472 6963 2064 6973 7472 6962 7574 696f  tric distributio
-0001c480: 6e20 6d6f 6465 6c73 2074 6865 206e 756d  n models the num
-0001c490: 6265 7220 6f66 2074 7269 616c 730d 0a20  ber of trials.. 
-0001c4a0: 2074 6861 7420 6d75 7374 2062 6520 7275   that must be ru
-0001c4b0: 6e20 696e 206f 7264 6572 2074 6f20 6163  n in order to ac
-0001c4c0: 6869 6576 6520 7375 6363 6573 732e 2020  hieve success.  
-0001c4d0: 4974 2069 7320 7468 6572 6566 6f72 650d  It is therefore.
-0001c4e0: 0a20 2073 7570 706f 7274 6564 206f 6e20  .  supported on 
-0001c4f0: 7468 6520 706f 7369 7469 7665 2069 6e74  the positive int
-0001c500: 6567 6572 732c 2060 606b 203d 2031 2c20  egers, ``k = 1, 
-0001c510: 322c 202e 2e2e 6060 2e0d 0a0d 0a20 2054  2, ...``.....  T
-0001c520: 6865 2070 726f 6261 6269 6c69 7479 206d  he probability m
-0001c530: 6173 7320 6675 6e63 7469 6f6e 206f 6620  ass function of 
-0001c540: 7468 6520 6765 6f6d 6574 7269 6320 6469  the geometric di
-0001c550: 7374 7269 6275 7469 6f6e 2069 730d 0a0d  stribution is...
-0001c560: 0a20 202e 2e20 6d61 7468 3a3a 2066 286b  .  .. math:: f(k
-0001c570: 2920 3d20 2831 202d 2070 295e 7b6b 202d  ) = (1 - p)^{k -
-0001c580: 2031 7d20 700d 0a0d 0a20 2077 6865 7265   1} p....  where
-0001c590: 2060 7060 2069 7320 7468 6520 7072 6f62   `p` is the prob
-0001c5a0: 6162 696c 6974 7920 6f66 2073 7563 6365  ability of succe
-0001c5b0: 7373 206f 6620 616e 2069 6e64 6976 6964  ss of an individ
-0001c5c0: 7561 6c20 7472 6961 6c2e 0d0a 0d0a 2020  ual trial.....  
-0001c5d0: 5061 7261 6d65 7465 7273 0d0a 2020 2d2d  Parameters..  --
-0001c5e0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 7020 3a20  --------..  p : 
-0001c5f0: 666c 6f61 7420 6f72 2061 7272 6179 5f6c  float or array_l
-0001c600: 696b 6520 6f66 2066 6c6f 6174 730d 0a20  ike of floats.. 
-0001c610: 2020 2020 2054 6865 2070 726f 6261 6269       The probabi
-0001c620: 6c69 7479 206f 6620 7375 6363 6573 7320  lity of success 
-0001c630: 6f66 2061 6e20 696e 6469 7669 6475 616c  of an individual
-0001c640: 2074 7269 616c 2e0d 0a20 2073 697a 6520   trial...  size 
-0001c650: 3a20 696e 7420 6f72 2074 7570 6c65 206f  : int or tuple o
-0001c660: 6620 696e 7473 2c20 6f70 7469 6f6e 616c  f ints, optional
-0001c670: 0d0a 2020 2020 2020 4f75 7470 7574 2073  ..      Output s
-0001c680: 6861 7065 2e20 2049 6620 7468 6520 6769  hape.  If the gi
-0001c690: 7665 6e20 7368 6170 6520 6973 2c20 652e  ven shape is, e.
-0001c6a0: 672e 2c20 6060 286d 2c20 6e2c 206b 2960  g., ``(m, n, k)`
-0001c6b0: 602c 2074 6865 6e0d 0a20 2020 2020 2060  `, then..      `
-0001c6c0: 606d 202a 206e 202a 206b 6060 2073 616d  `m * n * k`` sam
-0001c6d0: 706c 6573 2061 7265 2064 7261 776e 2e20  ples are drawn. 
-0001c6e0: 2049 6620 7369 7a65 2069 7320 6060 4e6f   If size is ``No
-0001c6f0: 6e65 6060 2028 6465 6661 756c 7429 2c0d  ne`` (default),.
-0001c700: 0a20 2020 2020 2061 2073 696e 676c 6520  .      a single 
-0001c710: 7661 6c75 6520 6973 2072 6574 7572 6e65  value is returne
-0001c720: 6420 6966 2060 6070 6060 2069 7320 6120  d if ``p`` is a 
-0001c730: 7363 616c 6172 2e20 204f 7468 6572 7769  scalar.  Otherwi
-0001c740: 7365 2c0d 0a20 2020 2020 2060 606e 702e  se,..      ``np.
-0001c750: 6172 7261 7928 7029 2e73 697a 6560 6020  array(p).size`` 
-0001c760: 7361 6d70 6c65 7320 6172 6520 6472 6177  samples are draw
-0001c770: 6e2e 0d0a 2020 6b65 7920 3a20 5052 4e47  n...  key : PRNG
-0001c780: 4b65 792c 206f 7074 696f 6e61 6c0d 0a20  Key, optional.. 
-0001c790: 2020 2020 2054 6865 206b 6579 2066 6f72       The key for
-0001c7a0: 2074 6865 2072 616e 646f 6d20 6e75 6d62   the random numb
-0001c7b0: 6572 2067 656e 6572 6174 6f72 2e20 4966  er generator. If
-0001c7c0: 206e 6f74 2067 6976 656e 2c20 7468 650d   not given, the.
-0001c7d0: 0a20 2020 2020 2064 6566 6175 6c74 2072  .      default r
-0001c7e0: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
-0001c7f0: 6572 6174 6f72 2069 7320 7573 6564 2e0d  erator is used..
-0001c800: 0a0d 0a20 2052 6574 7572 6e73 0d0a 2020  ...  Returns..  
-0001c810: 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574 203a  -------..  out :
-0001c820: 206e 6461 7272 6179 206f 7220 7363 616c   ndarray or scal
-0001c830: 6172 0d0a 2020 2020 2020 4472 6177 6e20  ar..      Drawn 
-0001c840: 7361 6d70 6c65 7320 6672 6f6d 2074 6865  samples from the
-0001c850: 2070 6172 616d 6574 6572 697a 6564 2067   parameterized g
-0001c860: 656f 6d65 7472 6963 2064 6973 7472 6962  eometric distrib
-0001c870: 7574 696f 6e2e 0d0a 0d0a 2020 4578 616d  ution.....  Exam
-0001c880: 706c 6573 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ples..  --------
-0001c890: 0d0a 2020 4472 6177 2074 656e 2074 686f  ..  Draw ten tho
-0001c8a0: 7573 616e 6420 7661 6c75 6573 2066 726f  usand values fro
-0001c8b0: 6d20 7468 6520 6765 6f6d 6574 7269 6320  m the geometric 
-0001c8c0: 6469 7374 7269 6275 7469 6f6e 2c0d 0a20  distribution,.. 
-0001c8d0: 2077 6974 6820 7468 6520 7072 6f62 6162   with the probab
-0001c8e0: 696c 6974 7920 6f66 2061 6e20 696e 6469  ility of an indi
-0001c8f0: 7669 6475 616c 2073 7563 6365 7373 2065  vidual success e
-0001c900: 7175 616c 2074 6f20 302e 3335 3a0d 0a0d  qual to 0.35:...
-0001c910: 0a20 203e 3e3e 207a 203d 2062 632e 7261  .  >>> z = bc.ra
-0001c920: 6e64 6f6d 2e67 656f 6d65 7472 6963 2870  ndom.geometric(p
-0001c930: 3d30 2e33 352c 2073 697a 653d 3130 3030  =0.35, size=1000
-0001c940: 3029 0d0a 0d0a 2020 486f 7720 6d61 6e79  0)....  How many
-0001c950: 2074 7269 616c 7320 7375 6363 6565 6465   trials succeede
-0001c960: 6420 6166 7465 7220 6120 7369 6e67 6c65  d after a single
-0001c970: 2072 756e 3f0d 0a0d 0a20 203e 3e3e 2028   run?....  >>> (
-0001c980: 7a20 3d3d 2031 292e 7375 6d28 2920 2f20  z == 1).sum() / 
-0001c990: 3130 3030 302e 0d0a 2020 302e 3334 3838  10000...  0.3488
-0001c9a0: 3939 3939 3939 3939 3939 3939 3920 2372  9999999999999 #r
-0001c9b0: 616e 646f 6d0d 0a20 2022 2222 0d0a 2020  andom..  """..  
-0001c9c0: 7265 7475 726e 2044 4546 4155 4c54 2e67  return DEFAULT.g
-0001c9d0: 656f 6d65 7472 6963 2870 2c20 7369 7a65  eometric(p, size
-0001c9e0: 2c20 6b65 793d 6b65 792c 2064 7479 7065  , key=key, dtype
-0001c9f0: 3d64 7479 7065 290d 0a0d 0a0d 0a64 6566  =dtype)......def
-0001ca00: 2066 2864 666e 756d 2c20 6466 6465 6e2c   f(dfnum, dfden,
-0001ca10: 2073 697a 653a 204f 7074 696f 6e61 6c5b   size: Optional[
-0001ca20: 5369 7a65 5d20 3d20 4e6f 6e65 2c20 6b65  Size] = None, ke
-0001ca30: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
-0001ca40: 4f72 4b65 795d 203d 204e 6f6e 652c 2064  OrKey] = None, d
-0001ca50: 7479 7065 3a20 4454 7970 654c 696b 6520  type: DTypeLike 
-0001ca60: 3d20 4e6f 6e65 293a 0d0a 2020 7222 2222  = None):..  r"""
-0001ca70: 0d0a 2020 4472 6177 2073 616d 706c 6573  ..  Draw samples
-0001ca80: 2066 726f 6d20 616e 2046 2064 6973 7472   from an F distr
-0001ca90: 6962 7574 696f 6e2e 0d0a 0d0a 2020 5361  ibution.....  Sa
-0001caa0: 6d70 6c65 7320 6172 6520 6472 6177 6e20  mples are drawn 
-0001cab0: 6672 6f6d 2061 6e20 4620 6469 7374 7269  from an F distri
-0001cac0: 6275 7469 6f6e 2077 6974 6820 7370 6563  bution with spec
-0001cad0: 6966 6965 6420 7061 7261 6d65 7465 7273  ified parameters
-0001cae0: 2c0d 0a20 2060 6466 6e75 6d60 2028 6465  ,..  `dfnum` (de
-0001caf0: 6772 6565 7320 6f66 2066 7265 6564 6f6d  grees of freedom
-0001cb00: 2069 6e20 6e75 6d65 7261 746f 7229 2061   in numerator) a
-0001cb10: 6e64 2060 6466 6465 6e60 2028 6465 6772  nd `dfden` (degr
-0001cb20: 6565 7320 6f66 0d0a 2020 6672 6565 646f  ees of..  freedo
-0001cb30: 6d20 696e 2064 656e 6f6d 696e 6174 6f72  m in denominator
-0001cb40: 292c 2077 6865 7265 2062 6f74 6820 7061  ), where both pa
-0001cb50: 7261 6d65 7465 7273 206d 7573 7420 6265  rameters must be
-0001cb60: 2067 7265 6174 6572 2074 6861 6e0d 0a20   greater than.. 
-0001cb70: 207a 6572 6f2e 0d0a 0d0a 2020 5468 6520   zero.....  The 
-0001cb80: 7261 6e64 6f6d 2076 6172 6961 7465 206f  random variate o
-0001cb90: 6620 7468 6520 4620 6469 7374 7269 6275  f the F distribu
-0001cba0: 7469 6f6e 2028 616c 736f 206b 6e6f 776e  tion (also known
-0001cbb0: 2061 7320 7468 650d 0a20 2046 6973 6865   as the..  Fishe
-0001cbc0: 7220 6469 7374 7269 6275 7469 6f6e 2920  r distribution) 
-0001cbd0: 6973 2061 2063 6f6e 7469 6e75 6f75 7320  is a continuous 
-0001cbe0: 7072 6f62 6162 696c 6974 7920 6469 7374  probability dist
-0001cbf0: 7269 6275 7469 6f6e 0d0a 2020 7468 6174  ribution..  that
-0001cc00: 2061 7269 7365 7320 696e 2041 4e4f 5641   arises in ANOVA
-0001cc10: 2074 6573 7473 2c20 616e 6420 6973 2074   tests, and is t
-0001cc20: 6865 2072 6174 696f 206f 6620 7477 6f20  he ratio of two 
-0001cc30: 6368 692d 7371 7561 7265 0d0a 2020 7661  chi-square..  va
-0001cc40: 7269 6174 6573 2e0d 0a0d 0a20 2050 6172  riates.....  Par
-0001cc50: 616d 6574 6572 730d 0a20 202d 2d2d 2d2d  ameters..  -----
-0001cc60: 2d2d 2d2d 2d0d 0a20 2064 666e 756d 203a  -----..  dfnum :
-0001cc70: 2066 6c6f 6174 206f 7220 6172 7261 795f   float or array_
-0001cc80: 6c69 6b65 206f 6620 666c 6f61 7473 0d0a  like of floats..
-0001cc90: 2020 2020 2020 4465 6772 6565 7320 6f66        Degrees of
-0001cca0: 2066 7265 6564 6f6d 2069 6e20 6e75 6d65   freedom in nume
-0001ccb0: 7261 746f 722c 206d 7573 7420 6265 203e  rator, must be >
-0001ccc0: 2030 2e0d 0a20 2064 6664 656e 203a 2066   0...  dfden : f
-0001ccd0: 6c6f 6174 206f 7220 6172 7261 795f 6c69  loat or array_li
-0001cce0: 6b65 206f 6620 666c 6f61 740d 0a20 2020  ke of float..   
-0001ccf0: 2020 2044 6567 7265 6573 206f 6620 6672     Degrees of fr
-0001cd00: 6565 646f 6d20 696e 2064 656e 6f6d 696e  eedom in denomin
-0001cd10: 6174 6f72 2c20 6d75 7374 2062 6520 3e20  ator, must be > 
-0001cd20: 302e 0d0a 2020 7369 7a65 203a 2069 6e74  0...  size : int
-0001cd30: 206f 7220 7475 706c 6520 6f66 2069 6e74   or tuple of int
-0001cd40: 732c 206f 7074 696f 6e61 6c0d 0a20 2020  s, optional..   
-0001cd50: 2020 204f 7574 7075 7420 7368 6170 652e     Output shape.
-0001cd60: 2020 4966 2074 6865 2067 6976 656e 2073    If the given s
-0001cd70: 6861 7065 2069 732c 2065 2e67 2e2c 2060  hape is, e.g., `
-0001cd80: 6028 6d2c 206e 2c20 6b29 6060 2c20 7468  `(m, n, k)``, th
-0001cd90: 656e 0d0a 2020 2020 2020 6060 6d20 2a20  en..      ``m * 
-0001cda0: 6e20 2a20 6b60 6020 7361 6d70 6c65 7320  n * k`` samples 
-0001cdb0: 6172 6520 6472 6177 6e2e 2020 4966 2073  are drawn.  If s
-0001cdc0: 697a 6520 6973 2060 604e 6f6e 6560 6020  ize is ``None`` 
-0001cdd0: 2864 6566 6175 6c74 292c 0d0a 2020 2020  (default),..    
-0001cde0: 2020 6120 7369 6e67 6c65 2076 616c 7565    a single value
-0001cdf0: 2069 7320 7265 7475 726e 6564 2069 6620   is returned if 
-0001ce00: 6060 6466 6e75 6d60 6020 616e 6420 6060  ``dfnum`` and ``
-0001ce10: 6466 6465 6e60 6020 6172 6520 626f 7468  dfden`` are both
-0001ce20: 2073 6361 6c61 7273 2e0d 0a20 2020 2020   scalars...     
-0001ce30: 204f 7468 6572 7769 7365 2c20 6060 6e70   Otherwise, ``np
-0001ce40: 2e62 726f 6164 6361 7374 2864 666e 756d  .broadcast(dfnum
-0001ce50: 2c20 6466 6465 6e29 2e73 697a 6560 6020  , dfden).size`` 
-0001ce60: 7361 6d70 6c65 7320 6172 6520 6472 6177  samples are draw
-0001ce70: 6e2e 0d0a 2020 6b65 7920 3a20 5052 4e47  n...  key : PRNG
-0001ce80: 4b65 792c 206f 7074 696f 6e61 6c0d 0a20  Key, optional.. 
-0001ce90: 2020 2020 2054 6865 206b 6579 2066 6f72       The key for
-0001cea0: 2074 6865 2072 616e 646f 6d20 6e75 6d62   the random numb
-0001ceb0: 6572 2067 656e 6572 6174 6f72 2e20 4966  er generator. If
-0001cec0: 206e 6f74 2067 6976 656e 2c20 7468 650d   not given, the.
-0001ced0: 0a20 2020 2020 2064 6566 6175 6c74 2072  .      default r
-0001cee0: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
-0001cef0: 6572 6174 6f72 2069 7320 7573 6564 2e0d  erator is used..
-0001cf00: 0a0d 0a20 2052 6574 7572 6e73 0d0a 2020  ...  Returns..  
-0001cf10: 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574 203a  -------..  out :
-0001cf20: 206e 6461 7272 6179 206f 7220 7363 616c   ndarray or scal
-0001cf30: 6172 0d0a 2020 2020 2020 4472 6177 6e20  ar..      Drawn 
-0001cf40: 7361 6d70 6c65 7320 6672 6f6d 2074 6865  samples from the
-0001cf50: 2070 6172 616d 6574 6572 697a 6564 2046   parameterized F
-0001cf60: 6973 6865 7220 6469 7374 7269 6275 7469  isher distributi
-0001cf70: 6f6e 2e0d 0a0d 0a20 2053 6565 2041 6c73  on.....  See Als
-0001cf80: 6f0d 0a20 202d 2d2d 2d2d 2d2d 2d0d 0a20  o..  --------.. 
-0001cf90: 2073 6369 7079 2e73 7461 7473 2e66 203a   scipy.stats.f :
-0001cfa0: 2070 726f 6261 6269 6c69 7479 2064 656e   probability den
-0001cfb0: 7369 7479 2066 756e 6374 696f 6e2c 2064  sity function, d
-0001cfc0: 6973 7472 6962 7574 696f 6e20 6f72 0d0a  istribution or..
-0001cfd0: 2020 2020 2020 6375 6d75 6c61 7469 7665        cumulative
-0001cfe0: 2064 656e 7369 7479 2066 756e 6374 696f   density functio
-0001cff0: 6e2c 2065 7463 2e0d 0a0d 0a20 204e 6f74  n, etc.....  Not
-0001d000: 6573 0d0a 2020 2d2d 2d2d 2d0d 0a20 2054  es..  -----..  T
-0001d010: 6865 2046 2073 7461 7469 7374 6963 2069  he F statistic i
-0001d020: 7320 7573 6564 2074 6f20 636f 6d70 6172  s used to compar
-0001d030: 6520 696e 2d67 726f 7570 2076 6172 6961  e in-group varia
-0001d040: 6e63 6573 2074 6f20 6265 7477 6565 6e2d  nces to between-
-0001d050: 6772 6f75 700d 0a20 2076 6172 6961 6e63  group..  varianc
-0001d060: 6573 2e20 4361 6c63 756c 6174 696e 6720  es. Calculating 
-0001d070: 7468 6520 6469 7374 7269 6275 7469 6f6e  the distribution
-0001d080: 2064 6570 656e 6473 206f 6e20 7468 6520   depends on the 
-0001d090: 7361 6d70 6c69 6e67 2c20 616e 640d 0a20  sampling, and.. 
-0001d0a0: 2073 6f20 6974 2069 7320 6120 6675 6e63   so it is a func
-0001d0b0: 7469 6f6e 206f 6620 7468 6520 7265 7370  tion of the resp
-0001d0c0: 6563 7469 7665 2064 6567 7265 6573 206f  ective degrees o
-0001d0d0: 6620 6672 6565 646f 6d20 696e 2074 6865  f freedom in the
-0001d0e0: 0d0a 2020 7072 6f62 6c65 6d2e 2020 5468  ..  problem.  Th
-0001d0f0: 6520 7661 7269 6162 6c65 2060 6466 6e75  e variable `dfnu
-0001d100: 6d60 2069 7320 7468 6520 6e75 6d62 6572  m` is the number
-0001d110: 206f 6620 7361 6d70 6c65 7320 6d69 6e75   of samples minu
-0001d120: 7320 6f6e 652c 2074 6865 0d0a 2020 6265  s one, the..  be
-0001d130: 7477 6565 6e2d 6772 6f75 7073 2064 6567  tween-groups deg
-0001d140: 7265 6573 206f 6620 6672 6565 646f 6d2c  rees of freedom,
-0001d150: 2077 6869 6c65 2060 6466 6465 6e60 2069   while `dfden` i
-0001d160: 7320 7468 6520 7769 7468 696e 2d67 726f  s the within-gro
-0001d170: 7570 730d 0a20 2064 6567 7265 6573 206f  ups..  degrees o
-0001d180: 6620 6672 6565 646f 6d2c 2074 6865 2073  f freedom, the s
-0001d190: 756d 206f 6620 7468 6520 6e75 6d62 6572  um of the number
-0001d1a0: 206f 6620 7361 6d70 6c65 7320 696e 2065   of samples in e
-0001d1b0: 6163 6820 6772 6f75 700d 0a20 206d 696e  ach group..  min
-0001d1c0: 7573 2074 6865 206e 756d 6265 7220 6f66  us the number of
-0001d1d0: 2067 726f 7570 732e 0d0a 0d0a 2020 5265   groups.....  Re
-0001d1e0: 6665 7265 6e63 6573 0d0a 2020 2d2d 2d2d  ferences..  ----
-0001d1f0: 2d2d 2d2d 2d2d 0d0a 2020 2e2e 205b 315d  ------..  .. [1]
-0001d200: 2047 6c61 6e74 7a2c 2053 7461 6e74 6f6e   Glantz, Stanton
-0001d210: 2041 2e20 2250 7269 6d65 7220 6f66 2042   A. "Primer of B
-0001d220: 696f 7374 6174 6973 7469 6373 2e22 2c20  iostatistics.", 
-0001d230: 4d63 4772 6177 2d48 696c 6c2c 0d0a 2020  McGraw-Hill,..  
-0001d240: 2020 2020 2020 2046 6966 7468 2045 6469         Fifth Edi
-0001d250: 7469 6f6e 2c20 3230 3032 2e0d 0a20 202e  tion, 2002...  .
-0001d260: 2e20 5b32 5d20 5769 6b69 7065 6469 612c  . [2] Wikipedia,
-0001d270: 2022 462d 6469 7374 7269 6275 7469 6f6e   "F-distribution
-0001d280: 222c 0d0a 2020 2020 2020 2020 2068 7474  ",..         htt
-0001d290: 7073 3a2f 2f65 6e2e 7769 6b69 7065 6469  ps://en.wikipedi
-0001d2a0: 612e 6f72 672f 7769 6b69 2f46 2d64 6973  a.org/wiki/F-dis
-0001d2b0: 7472 6962 7574 696f 6e0d 0a0d 0a20 2045  tribution....  E
-0001d2c0: 7861 6d70 6c65 730d 0a20 202d 2d2d 2d2d  xamples..  -----
-0001d2d0: 2d2d 2d0d 0a20 2041 6e20 6578 616d 706c  ---..  An exampl
-0001d2e0: 6520 6672 6f6d 2047 6c61 6e74 7a5b 315d  e from Glantz[1]
-0001d2f0: 2c20 7070 2034 372d 3430 3a0d 0a0d 0a20  , pp 47-40:.... 
-0001d300: 2054 776f 2067 726f 7570 732c 2063 6869   Two groups, chi
-0001d310: 6c64 7265 6e20 6f66 2064 6961 6265 7469  ldren of diabeti
-0001d320: 6373 2028 3235 2070 656f 706c 6529 2061  cs (25 people) a
-0001d330: 6e64 2063 6869 6c64 7265 6e20 6672 6f6d  nd children from
-0001d340: 2070 656f 706c 650d 0a20 2077 6974 686f   people..  witho
-0001d350: 7574 2064 6961 6265 7465 7320 2832 3520  ut diabetes (25 
-0001d360: 636f 6e74 726f 6c73 292e 2046 6173 7469  controls). Fasti
-0001d370: 6e67 2062 6c6f 6f64 2067 6c75 636f 7365  ng blood glucose
-0001d380: 2077 6173 206d 6561 7375 7265 642c 0d0a   was measured,..
-0001d390: 2020 6361 7365 2067 726f 7570 2068 6164    case group had
-0001d3a0: 2061 206d 6561 6e20 7661 6c75 6520 6f66   a mean value of
-0001d3b0: 2038 362e 312c 2063 6f6e 7472 6f6c 7320   86.1, controls 
-0001d3c0: 6861 6420 6120 6d65 616e 2076 616c 7565  had a mean value
-0001d3d0: 206f 660d 0a20 2038 322e 322e 2053 7461   of..  82.2. Sta
-0001d3e0: 6e64 6172 6420 6465 7669 6174 696f 6e73  ndard deviations
-0001d3f0: 2077 6572 6520 322e 3039 2061 6e64 2032   were 2.09 and 2
-0001d400: 2e34 3920 7265 7370 6563 7469 7665 6c79  .49 respectively
-0001d410: 2e20 4172 6520 7468 6573 650d 0a20 2064  . Are these..  d
-0001d420: 6174 6120 636f 6e73 6973 7465 6e74 2077  ata consistent w
-0001d430: 6974 6820 7468 6520 6e75 6c6c 2068 7970  ith the null hyp
-0001d440: 6f74 6865 7369 7320 7468 6174 2074 6865  othesis that the
-0001d450: 2070 6172 656e 7473 2064 6961 6265 7469   parents diabeti
-0001d460: 630d 0a20 2073 7461 7475 7320 646f 6573  c..  status does
-0001d470: 206e 6f74 2061 6666 6563 7420 7468 6569   not affect thei
-0001d480: 7220 6368 696c 6472 656e 2773 2062 6c6f  r children's blo
-0001d490: 6f64 2067 6c75 636f 7365 206c 6576 656c  od glucose level
-0001d4a0: 733f 0d0a 2020 4361 6c63 756c 6174 696e  s?..  Calculatin
-0001d4b0: 6720 7468 6520 4620 7374 6174 6973 7469  g the F statisti
-0001d4c0: 6320 6672 6f6d 2074 6865 2064 6174 6120  c from the data 
-0001d4d0: 6769 7665 7320 6120 7661 6c75 6520 6f66  gives a value of
-0001d4e0: 2033 362e 3031 2e0d 0a0d 0a20 2044 7261   36.01.....  Dra
-0001d4f0: 7720 7361 6d70 6c65 7320 6672 6f6d 2074  w samples from t
-0001d500: 6865 2064 6973 7472 6962 7574 696f 6e3a  he distribution:
-0001d510: 0d0a 0d0a 2020 3e3e 3e20 6466 6e75 6d20  ....  >>> dfnum 
-0001d520: 3d20 312e 2023 2062 6574 7765 656e 2067  = 1. # between g
-0001d530: 726f 7570 2064 6567 7265 6573 206f 6620  roup degrees of 
-0001d540: 6672 6565 646f 6d0d 0a20 203e 3e3e 2064  freedom..  >>> d
-0001d550: 6664 656e 203d 2034 382e 2023 2077 6974  fden = 48. # wit
-0001d560: 6869 6e20 6772 6f75 7073 2064 6567 7265  hin groups degre
-0001d570: 6573 206f 6620 6672 6565 646f 6d0d 0a20  es of freedom.. 
-0001d580: 203e 3e3e 2073 203d 2062 632e 7261 6e64   >>> s = bc.rand
-0001d590: 6f6d 2e66 2864 666e 756d 2c20 6466 6465  om.f(dfnum, dfde
-0001d5a0: 6e2c 2031 3030 3029 0d0a 0d0a 2020 5468  n, 1000)....  Th
-0001d5b0: 6520 6c6f 7765 7220 626f 756e 6420 666f  e lower bound fo
-0001d5c0: 7220 7468 6520 746f 7020 3125 206f 6620  r the top 1% of 
-0001d5d0: 7468 6520 7361 6d70 6c65 7320 6973 203a  the samples is :
-0001d5e0: 0d0a 0d0a 2020 3e3e 3e20 6e70 2e73 6f72  ....  >>> np.sor
-0001d5f0: 7428 7329 5b2d 3130 5d0d 0a20 2037 2e36  t(s)[-10]..  7.6
-0001d600: 3139 3838 3132 3039 3835 2023 2072 616e  1988120985 # ran
-0001d610: 646f 6d0d 0a0d 0a20 2053 6f20 7468 6572  dom....  So ther
-0001d620: 6520 6973 2061 626f 7574 2061 2031 2520  e is about a 1% 
-0001d630: 6368 616e 6365 2074 6861 7420 7468 6520  chance that the 
-0001d640: 4620 7374 6174 6973 7469 6320 7769 6c6c  F statistic will
-0001d650: 2065 7863 6565 6420 372e 3632 2c0d 0a20   exceed 7.62,.. 
-0001d660: 2074 6865 206d 6561 7375 7265 6420 7661   the measured va
-0001d670: 6c75 6520 6973 2033 362c 2073 6f20 7468  lue is 36, so th
-0001d680: 6520 6e75 6c6c 2068 7970 6f74 6865 7369  e null hypothesi
-0001d690: 7320 6973 2072 656a 6563 7465 6420 6174  s is rejected at
-0001d6a0: 2074 6865 2031 250d 0a20 206c 6576 656c   the 1%..  level
-0001d6b0: 2e0d 0a20 2022 2222 0d0a 2020 7265 7475  ...  """..  retu
-0001d6c0: 726e 2044 4546 4155 4c54 2e66 2864 666e  rn DEFAULT.f(dfn
-0001d6d0: 756d 2c20 6466 6465 6e2c 2073 697a 652c  um, dfden, size,
-0001d6e0: 206b 6579 3d6b 6579 2c20 6474 7970 653d   key=key, dtype=
-0001d6f0: 6474 7970 6529 0d0a 0d0a 0d0a 6465 6620  dtype)......def 
-0001d700: 6879 7065 7267 656f 6d65 7472 6963 286e  hypergeometric(n
-0001d710: 676f 6f64 2c20 6e62 6164 2c20 6e73 616d  good, nbad, nsam
-0001d720: 706c 652c 2073 697a 653a 204f 7074 696f  ple, size: Optio
-0001d730: 6e61 6c5b 5369 7a65 5d20 3d20 4e6f 6e65  nal[Size] = None
-0001d740: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0001d750: 2020 2020 2020 6b65 793a 204f 7074 696f        key: Optio
-0001d760: 6e61 6c5b 5365 6564 4f72 4b65 795d 203d  nal[SeedOrKey] =
-0001d770: 204e 6f6e 652c 2064 7479 7065 3a20 4454   None, dtype: DT
-0001d780: 7970 654c 696b 6520 3d20 4e6f 6e65 293a  ypeLike = None):
-0001d790: 0d0a 2020 7222 2222 0d0a 2020 4472 6177  ..  r"""..  Draw
-0001d7a0: 2073 616d 706c 6573 2066 726f 6d20 6120   samples from a 
-0001d7b0: 4879 7065 7267 656f 6d65 7472 6963 2064  Hypergeometric d
-0001d7c0: 6973 7472 6962 7574 696f 6e2e 0d0a 0d0a  istribution.....
-0001d7d0: 2020 5361 6d70 6c65 7320 6172 6520 6472    Samples are dr
-0001d7e0: 6177 6e20 6672 6f6d 2061 2068 7970 6572  awn from a hyper
-0001d7f0: 6765 6f6d 6574 7269 6320 6469 7374 7269  geometric distri
-0001d800: 6275 7469 6f6e 2077 6974 6820 7370 6563  bution with spec
-0001d810: 6966 6965 640d 0a20 2070 6172 616d 6574  ified..  paramet
-0001d820: 6572 732c 2060 6e67 6f6f 6460 2028 7761  ers, `ngood` (wa
-0001d830: 7973 2074 6f20 6d61 6b65 2061 2067 6f6f  ys to make a goo
-0001d840: 6420 7365 6c65 6374 696f 6e29 2c20 606e  d selection), `n
-0001d850: 6261 6460 2028 7761 7973 2074 6f20 6d61  bad` (ways to ma
-0001d860: 6b65 0d0a 2020 6120 6261 6420 7365 6c65  ke..  a bad sele
-0001d870: 6374 696f 6e29 2c20 616e 6420 606e 7361  ction), and `nsa
-0001d880: 6d70 6c65 6020 286e 756d 6265 7220 6f66  mple` (number of
-0001d890: 2069 7465 6d73 2073 616d 706c 6564 2c20   items sampled, 
-0001d8a0: 7768 6963 6820 6973 206c 6573 730d 0a20  which is less.. 
-0001d8b0: 2074 6861 6e20 6f72 2065 7175 616c 2074   than or equal t
-0001d8c0: 6f20 7468 6520 7375 6d20 6060 6e67 6f6f  o the sum ``ngoo
-0001d8d0: 6420 2b20 6e62 6164 6060 292e 0d0a 0d0a  d + nbad``).....
-0001d8e0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-0001d8f0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 6e67  ----------..  ng
-0001d900: 6f6f 6420 3a20 696e 7420 6f72 2061 7272  ood : int or arr
-0001d910: 6179 5f6c 696b 6520 6f66 2069 6e74 730d  ay_like of ints.
-0001d920: 0a20 2020 2020 204e 756d 6265 7220 6f66  .      Number of
-0001d930: 2077 6179 7320 746f 206d 616b 6520 6120   ways to make a 
-0001d940: 676f 6f64 2073 656c 6563 7469 6f6e 2e20  good selection. 
-0001d950: 204d 7573 7420 6265 206e 6f6e 6e65 6761   Must be nonnega
-0001d960: 7469 7665 2e0d 0a20 206e 6261 6420 3a20  tive...  nbad : 
-0001d970: 696e 7420 6f72 2061 7272 6179 5f6c 696b  int or array_lik
-0001d980: 6520 6f66 2069 6e74 730d 0a20 2020 2020  e of ints..     
-0001d990: 204e 756d 6265 7220 6f66 2077 6179 7320   Number of ways 
-0001d9a0: 746f 206d 616b 6520 6120 6261 6420 7365  to make a bad se
-0001d9b0: 6c65 6374 696f 6e2e 2020 4d75 7374 2062  lection.  Must b
-0001d9c0: 6520 6e6f 6e6e 6567 6174 6976 652e 0d0a  e nonnegative...
-0001d9d0: 2020 6e73 616d 706c 6520 3a20 696e 7420    nsample : int 
-0001d9e0: 6f72 2061 7272 6179 5f6c 696b 6520 6f66  or array_like of
-0001d9f0: 2069 6e74 730d 0a20 2020 2020 204e 756d   ints..      Num
-0001da00: 6265 7220 6f66 2069 7465 6d73 2073 616d  ber of items sam
-0001da10: 706c 6564 2e20 204d 7573 7420 6265 2061  pled.  Must be a
-0001da20: 7420 6c65 6173 7420 3120 616e 6420 6174  t least 1 and at
-0001da30: 206d 6f73 740d 0a20 2020 2020 2060 606e   most..      ``n
-0001da40: 676f 6f64 202b 206e 6261 6460 602e 0d0a  good + nbad``...
-0001da50: 2020 7369 7a65 203a 2069 6e74 206f 7220    size : int or 
-0001da60: 7475 706c 6520 6f66 2069 6e74 732c 206f  tuple of ints, o
-0001da70: 7074 696f 6e61 6c0d 0a20 2020 2020 204f  ptional..      O
-0001da80: 7574 7075 7420 7368 6170 652e 2020 4966  utput shape.  If
-0001da90: 2074 6865 2067 6976 656e 2073 6861 7065   the given shape
-0001daa0: 2069 732c 2065 2e67 2e2c 2060 6028 6d2c   is, e.g., ``(m,
-0001dab0: 206e 2c20 6b29 6060 2c20 7468 656e 0d0a   n, k)``, then..
-0001dac0: 2020 2020 2020 6060 6d20 2a20 6e20 2a20        ``m * n * 
-0001dad0: 6b60 6020 7361 6d70 6c65 7320 6172 6520  k`` samples are 
-0001dae0: 6472 6177 6e2e 2020 4966 2073 697a 6520  drawn.  If size 
-0001daf0: 6973 2060 604e 6f6e 6560 6020 2864 6566  is ``None`` (def
-0001db00: 6175 6c74 292c 0d0a 2020 2020 2020 6120  ault),..      a 
-0001db10: 7369 6e67 6c65 2076 616c 7565 2069 7320  single value is 
-0001db20: 7265 7475 726e 6564 2069 6620 606e 676f  returned if `ngo
-0001db30: 6f64 602c 2060 6e62 6164 602c 2061 6e64  od`, `nbad`, and
-0001db40: 2060 6e73 616d 706c 6560 0d0a 2020 2020   `nsample`..    
-0001db50: 2020 6172 6520 616c 6c20 7363 616c 6172    are all scalar
-0001db60: 732e 2020 4f74 6865 7277 6973 652c 2060  s.  Otherwise, `
-0001db70: 606e 702e 6272 6f61 6463 6173 7428 6e67  `np.broadcast(ng
-0001db80: 6f6f 642c 206e 6261 642c 206e 7361 6d70  ood, nbad, nsamp
-0001db90: 6c65 292e 7369 7a65 6060 0d0a 2020 2020  le).size``..    
-0001dba0: 2020 7361 6d70 6c65 7320 6172 6520 6472    samples are dr
-0001dbb0: 6177 6e2e 0d0a 2020 6b65 7920 3a20 5052  awn...  key : PR
-0001dbc0: 4e47 4b65 792c 206f 7074 696f 6e61 6c0d  NGKey, optional.
-0001dbd0: 0a20 2020 2020 2054 6865 206b 6579 2066  .      The key f
-0001dbe0: 6f72 2074 6865 2072 616e 646f 6d20 6e75  or the random nu
-0001dbf0: 6d62 6572 2067 656e 6572 6174 6f72 2e20  mber generator. 
-0001dc00: 4966 206e 6f74 2067 6976 656e 2c20 7468  If not given, th
-0001dc10: 650d 0a20 2020 2020 2064 6566 6175 6c74  e..      default
-0001dc20: 2072 616e 646f 6d20 6e75 6d62 6572 2067   random number g
-0001dc30: 656e 6572 6174 6f72 2069 7320 7573 6564  enerator is used
-0001dc40: 2e0d 0a0d 0a20 2052 6574 7572 6e73 0d0a  .....  Returns..
-0001dc50: 2020 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574    -------..  out
-0001dc60: 203a 206e 6461 7272 6179 206f 7220 7363   : ndarray or sc
-0001dc70: 616c 6172 0d0a 2020 2020 2020 4472 6177  alar..      Draw
-0001dc80: 6e20 7361 6d70 6c65 7320 6672 6f6d 2074  n samples from t
-0001dc90: 6865 2070 6172 616d 6574 6572 697a 6564  he parameterized
-0001dca0: 2068 7970 6572 6765 6f6d 6574 7269 6320   hypergeometric 
-0001dcb0: 6469 7374 7269 6275 7469 6f6e 2e20 4561  distribution. Ea
-0001dcc0: 6368 0d0a 2020 2020 2020 7361 6d70 6c65  ch..      sample
-0001dcd0: 2069 7320 7468 6520 6e75 6d62 6572 206f   is the number o
-0001dce0: 6620 676f 6f64 2069 7465 6d73 2077 6974  f good items wit
-0001dcf0: 6869 6e20 6120 7261 6e64 6f6d 6c79 2073  hin a randomly s
-0001dd00: 656c 6563 7465 6420 7375 6273 6574 206f  elected subset o
-0001dd10: 660d 0a20 2020 2020 2073 697a 6520 606e  f..      size `n
-0001dd20: 7361 6d70 6c65 6020 7461 6b65 6e20 6672  sample` taken fr
-0001dd30: 6f6d 2061 2073 6574 206f 6620 606e 676f  om a set of `ngo
-0001dd40: 6f64 6020 676f 6f64 2069 7465 6d73 2061  od` good items a
-0001dd50: 6e64 2060 6e62 6164 6020 6261 6420 6974  nd `nbad` bad it
-0001dd60: 656d 732e 0d0a 0d0a 2020 5365 6520 416c  ems.....  See Al
-0001dd70: 736f 0d0a 2020 2d2d 2d2d 2d2d 2d2d 0d0a  so..  --------..
-0001dd80: 2020 7363 6970 792e 7374 6174 732e 6879    scipy.stats.hy
-0001dd90: 7065 7267 656f 6d20 3a20 7072 6f62 6162  pergeom : probab
-0001dda0: 696c 6974 7920 6465 6e73 6974 7920 6675  ility density fu
-0001ddb0: 6e63 7469 6f6e 2c20 6469 7374 7269 6275  nction, distribu
-0001ddc0: 7469 6f6e 206f 720d 0a20 2020 2020 2063  tion or..      c
-0001ddd0: 756d 756c 6174 6976 6520 6465 6e73 6974  umulative densit
-0001dde0: 7920 6675 6e63 7469 6f6e 2c20 6574 632e  y function, etc.
-0001ddf0: 0d0a 0d0a 2020 4e6f 7465 730d 0a20 202d  ....  Notes..  -
-0001de00: 2d2d 2d2d 0d0a 2020 5468 6520 7072 6f62  ----..  The prob
-0001de10: 6162 696c 6974 7920 6465 6e73 6974 7920  ability density 
-0001de20: 666f 7220 7468 6520 4879 7065 7267 656f  for the Hypergeo
-0001de30: 6d65 7472 6963 2064 6973 7472 6962 7574  metric distribut
-0001de40: 696f 6e20 6973 0d0a 0d0a 2020 2e2e 206d  ion is....  .. m
-0001de50: 6174 683a 3a20 5028 7829 203d 205c 6672  ath:: P(x) = \fr
-0001de60: 6163 7b5c 6269 6e6f 6d7b 677d 7b78 7d5c  ac{\binom{g}{x}\
-0001de70: 6269 6e6f 6d7b 627d 7b6e 2d78 7d7d 7b5c  binom{b}{n-x}}{\
-0001de80: 6269 6e6f 6d7b 672b 627d 7b6e 7d7d 2c0d  binom{g+b}{n}},.
-0001de90: 0a0d 0a20 2077 6865 7265 203a 6d61 7468  ...  where :math
-0001dea0: 3a60 3020 5c6c 6520 7820 5c6c 6520 6e60  :`0 \le x \le n`
-0001deb0: 2061 6e64 203a 6d61 7468 3a60 6e2d 6220   and :math:`n-b 
-0001dec0: 5c6c 6520 7820 5c6c 6520 6760 0d0a 0d0a  \le x \le g`....
-0001ded0: 2020 666f 7220 5028 7829 2074 6865 2070    for P(x) the p
-0001dee0: 726f 6261 6269 6c69 7479 206f 6620 6060  robability of ``
-0001def0: 7860 6020 676f 6f64 2072 6573 756c 7473  x`` good results
-0001df00: 2069 6e20 7468 6520 6472 6177 6e20 7361   in the drawn sa
-0001df10: 6d70 6c65 2c0d 0a20 2067 203d 2060 6e67  mple,..  g = `ng
-0001df20: 6f6f 6460 2c20 6220 3d20 606e 6261 6460  ood`, b = `nbad`
-0001df30: 2c20 616e 6420 6e20 3d20 606e 7361 6d70  , and n = `nsamp
-0001df40: 6c65 602e 0d0a 0d0a 2020 436f 6e73 6964  le`.....  Consid
-0001df50: 6572 2061 6e20 7572 6e20 7769 7468 2062  er an urn with b
-0001df60: 6c61 636b 2061 6e64 2077 6869 7465 206d  lack and white m
-0001df70: 6172 626c 6573 2069 6e20 6974 2c20 606e  arbles in it, `n
-0001df80: 676f 6f64 6020 6f66 2074 6865 6d0d 0a20  good` of them.. 
-0001df90: 2061 7265 2062 6c61 636b 2061 6e64 2060   are black and `
-0001dfa0: 6e62 6164 6020 6172 6520 7768 6974 652e  nbad` are white.
-0001dfb0: 2049 6620 796f 7520 6472 6177 2060 6e73   If you draw `ns
-0001dfc0: 616d 706c 6560 2062 616c 6c73 2077 6974  ample` balls wit
-0001dfd0: 686f 7574 0d0a 2020 7265 706c 6163 656d  hout..  replacem
-0001dfe0: 656e 742c 2074 6865 6e20 7468 6520 6879  ent, then the hy
-0001dff0: 7065 7267 656f 6d65 7472 6963 2064 6973  pergeometric dis
-0001e000: 7472 6962 7574 696f 6e20 6465 7363 7269  tribution descri
-0001e010: 6265 7320 7468 650d 0a20 2064 6973 7472  bes the..  distr
-0001e020: 6962 7574 696f 6e20 6f66 2062 6c61 636b  ibution of black
-0001e030: 2062 616c 6c73 2069 6e20 7468 6520 6472   balls in the dr
-0001e040: 6177 6e20 7361 6d70 6c65 2e0d 0a0d 0a20  awn sample..... 
-0001e050: 204e 6f74 6520 7468 6174 2074 6869 7320   Note that this 
-0001e060: 6469 7374 7269 6275 7469 6f6e 2069 7320  distribution is 
-0001e070: 7665 7279 2073 696d 696c 6172 2074 6f20  very similar to 
-0001e080: 7468 6520 6269 6e6f 6d69 616c 0d0a 2020  the binomial..  
-0001e090: 6469 7374 7269 6275 7469 6f6e 2c20 6578  distribution, ex
-0001e0a0: 6365 7074 2074 6861 7420 696e 2074 6869  cept that in thi
-0001e0b0: 7320 6361 7365 2c20 7361 6d70 6c65 7320  s case, samples 
-0001e0c0: 6172 6520 6472 6177 6e20 7769 7468 6f75  are drawn withou
-0001e0d0: 740d 0a20 2072 6570 6c61 6365 6d65 6e74  t..  replacement
-0001e0e0: 2c20 7768 6572 6561 7320 696e 2074 6865  , whereas in the
-0001e0f0: 2042 696e 6f6d 6961 6c20 6361 7365 2073   Binomial case s
-0001e100: 616d 706c 6573 2061 7265 2064 7261 776e  amples are drawn
-0001e110: 2077 6974 680d 0a20 2072 6570 6c61 6365   with..  replace
-0001e120: 6d65 6e74 2028 6f72 2074 6865 2073 616d  ment (or the sam
-0001e130: 706c 6520 7370 6163 6520 6973 2069 6e66  ple space is inf
-0001e140: 696e 6974 6529 2e20 4173 2074 6865 2073  inite). As the s
-0001e150: 616d 706c 6520 7370 6163 650d 0a20 2062  ample space..  b
-0001e160: 6563 6f6d 6573 206c 6172 6765 2c20 7468  ecomes large, th
-0001e170: 6973 2064 6973 7472 6962 7574 696f 6e20  is distribution 
-0001e180: 6170 7072 6f61 6368 6573 2074 6865 2062  approaches the b
-0001e190: 696e 6f6d 6961 6c2e 0d0a 0d0a 2020 5265  inomial.....  Re
-0001e1a0: 6665 7265 6e63 6573 0d0a 2020 2d2d 2d2d  ferences..  ----
-0001e1b0: 2d2d 2d2d 2d2d 0d0a 2020 2e2e 205b 315d  ------..  .. [1]
-0001e1c0: 204c 656e 746e 6572 2c20 4d61 7276 696e   Lentner, Marvin
-0001e1d0: 2c20 2245 6c65 6d65 6e74 6172 7920 4170  , "Elementary Ap
-0001e1e0: 706c 6965 6420 5374 6174 6973 7469 6373  plied Statistics
-0001e1f0: 222c 2042 6f67 6465 6e0d 0a20 2020 2020  ", Bogden..     
-0001e200: 2020 2020 616e 6420 5175 6967 6c65 792c      and Quigley,
-0001e210: 2031 3937 322e 0d0a 2020 2e2e 205b 325d   1972...  .. [2]
-0001e220: 2057 6569 7373 7465 696e 2c20 4572 6963   Weisstein, Eric
-0001e230: 2057 2e20 2248 7970 6572 6765 6f6d 6574   W. "Hypergeomet
-0001e240: 7269 6320 4469 7374 7269 6275 7469 6f6e  ric Distribution
-0001e250: 2e22 2046 726f 6d0d 0a20 2020 2020 2020  ." From..       
-0001e260: 2020 4d61 7468 576f 726c 642d 2d41 2057    MathWorld--A W
-0001e270: 6f6c 6672 616d 2057 6562 2052 6573 6f75  olfram Web Resou
-0001e280: 7263 652e 0d0a 2020 2020 2020 2020 2068  rce...         h
-0001e290: 7474 703a 2f2f 6d61 7468 776f 726c 642e  ttp://mathworld.
-0001e2a0: 776f 6c66 7261 6d2e 636f 6d2f 4879 7065  wolfram.com/Hype
-0001e2b0: 7267 656f 6d65 7472 6963 4469 7374 7269  rgeometricDistri
-0001e2c0: 6275 7469 6f6e 2e68 746d 6c0d 0a20 202e  bution.html..  .
-0001e2d0: 2e20 5b33 5d20 5769 6b69 7065 6469 612c  . [3] Wikipedia,
-0001e2e0: 2022 4879 7065 7267 656f 6d65 7472 6963   "Hypergeometric
-0001e2f0: 2064 6973 7472 6962 7574 696f 6e22 2c0d   distribution",.
-0001e300: 0a20 2020 2020 2020 2020 6874 7470 733a  .         https:
-0001e310: 2f2f 656e 2e77 696b 6970 6564 6961 2e6f  //en.wikipedia.o
-0001e320: 7267 2f77 696b 692f 4879 7065 7267 656f  rg/wiki/Hypergeo
-0001e330: 6d65 7472 6963 5f64 6973 7472 6962 7574  metric_distribut
-0001e340: 696f 6e0d 0a0d 0a20 2045 7861 6d70 6c65  ion....  Example
-0001e350: 730d 0a20 202d 2d2d 2d2d 2d2d 2d0d 0a20  s..  --------.. 
-0001e360: 2044 7261 7720 7361 6d70 6c65 7320 6672   Draw samples fr
-0001e370: 6f6d 2074 6865 2064 6973 7472 6962 7574  om the distribut
-0001e380: 696f 6e3a 0d0a 0d0a 2020 3e3e 3e20 6e67  ion:....  >>> ng
-0001e390: 6f6f 642c 206e 6261 642c 206e 7361 6d70  ood, nbad, nsamp
-0001e3a0: 203d 2031 3030 2c20 322c 2031 300d 0a20   = 100, 2, 10.. 
-0001e3b0: 2023 206e 756d 6265 7220 6f66 2067 6f6f   # number of goo
-0001e3c0: 642c 206e 756d 6265 7220 6f66 2062 6164  d, number of bad
-0001e3d0: 2c20 616e 6420 6e75 6d62 6572 206f 6620  , and number of 
-0001e3e0: 7361 6d70 6c65 730d 0a20 203e 3e3e 2073  samples..  >>> s
-0001e3f0: 203d 2062 632e 7261 6e64 6f6d 2e68 7970   = bc.random.hyp
-0001e400: 6572 6765 6f6d 6574 7269 6328 6e67 6f6f  ergeometric(ngoo
-0001e410: 642c 206e 6261 642c 206e 7361 6d70 2c20  d, nbad, nsamp, 
-0001e420: 3130 3030 290d 0a20 203e 3e3e 2066 726f  1000)..  >>> fro
-0001e430: 6d20 6d61 7470 6c6f 746c 6962 2e70 7970  m matplotlib.pyp
-0001e440: 6c6f 7420 696d 706f 7274 2068 6973 7420  lot import hist 
-0001e450: 2023 206e 6f71 610d 0a20 203e 3e3e 2068   # noqa..  >>> h
-0001e460: 6973 7428 7329 0d0a 2020 2320 2020 6e6f  ist(s)..  #   no
-0001e470: 7465 2074 6861 7420 6974 2069 7320 7665  te that it is ve
-0001e480: 7279 2075 6e6c 696b 656c 7920 746f 2067  ry unlikely to g
-0001e490: 7261 6220 626f 7468 2062 6164 2069 7465  rab both bad ite
-0001e4a0: 6d73 0d0a 0d0a 2020 5375 7070 6f73 6520  ms....  Suppose 
-0001e4b0: 796f 7520 6861 7665 2061 6e20 7572 6e20  you have an urn 
-0001e4c0: 7769 7468 2031 3520 7768 6974 6520 616e  with 15 white an
-0001e4d0: 6420 3135 2062 6c61 636b 206d 6172 626c  d 15 black marbl
-0001e4e0: 6573 2e0d 0a20 2049 6620 796f 7520 7075  es...  If you pu
-0001e4f0: 6c6c 2031 3520 6d61 7262 6c65 7320 6174  ll 15 marbles at
-0001e500: 2072 616e 646f 6d2c 2068 6f77 206c 696b   random, how lik
-0001e510: 656c 7920 6973 2069 7420 7468 6174 0d0a  ely is it that..
-0001e520: 2020 3132 206f 7220 6d6f 7265 206f 6620    12 or more of 
-0001e530: 7468 656d 2061 7265 206f 6e65 2063 6f6c  them are one col
-0001e540: 6f72 3f0d 0a0d 0a20 203e 3e3e 2073 203d  or?....  >>> s =
-0001e550: 2062 632e 7261 6e64 6f6d 2e68 7970 6572   bc.random.hyper
-0001e560: 6765 6f6d 6574 7269 6328 3135 2c20 3135  geometric(15, 15
-0001e570: 2c20 3135 2c20 3130 3030 3030 290d 0a20  , 15, 100000).. 
-0001e580: 203e 3e3e 2073 756d 2873 3e3d 3132 292f   >>> sum(s>=12)/
-0001e590: 3130 3030 3030 2e20 2b20 7375 6d28 733c  100000. + sum(s<
-0001e5a0: 3d33 292f 3130 3030 3030 2e0d 0a20 2023  =3)/100000...  #
-0001e5b0: 2020 2061 6e73 7765 7220 3d20 302e 3030     answer = 0.00
-0001e5c0: 3320 2e2e 2e20 7072 6574 7479 2075 6e6c  3 ... pretty unl
-0001e5d0: 696b 656c 7921 0d0a 2020 2222 220d 0a20  ikely!..  """.. 
-0001e5e0: 2072 6574 7572 6e20 4445 4641 554c 542e   return DEFAULT.
-0001e5f0: 6879 7065 7267 656f 6d65 7472 6963 286e  hypergeometric(n
-0001e600: 676f 6f64 2c20 6e62 6164 2c20 6e73 616d  good, nbad, nsam
-0001e610: 706c 652c 2073 697a 652c 206b 6579 3d6b  ple, size, key=k
-0001e620: 6579 2c20 6474 7970 653d 6474 7970 6529  ey, dtype=dtype)
-0001e630: 0d0a 0d0a 0d0a 6465 6620 6c6f 6773 6572  ......def logser
-0001e640: 6965 7328 702c 2073 697a 653a 204f 7074  ies(p, size: Opt
-0001e650: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
-0001e660: 6e65 2c20 6b65 793a 204f 7074 696f 6e61  ne, key: Optiona
-0001e670: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
-0001e680: 6f6e 652c 2064 7479 7065 3a20 4454 7970  one, dtype: DTyp
-0001e690: 654c 696b 6520 3d20 4e6f 6e65 293a 0d0a  eLike = None):..
-0001e6a0: 2020 7222 2222 0d0a 2020 4472 6177 2073    r"""..  Draw s
-0001e6b0: 616d 706c 6573 2066 726f 6d20 6120 6c6f  amples from a lo
-0001e6c0: 6761 7269 7468 6d69 6320 7365 7269 6573  garithmic series
-0001e6d0: 2064 6973 7472 6962 7574 696f 6e2e 0d0a   distribution...
-0001e6e0: 0d0a 2020 5361 6d70 6c65 7320 6172 6520  ..  Samples are 
-0001e6f0: 6472 6177 6e20 6672 6f6d 2061 206c 6f67  drawn from a log
-0001e700: 2073 6572 6965 7320 6469 7374 7269 6275   series distribu
-0001e710: 7469 6f6e 2077 6974 6820 7370 6563 6966  tion with specif
-0001e720: 6965 640d 0a20 2073 6861 7065 2070 6172  ied..  shape par
-0001e730: 616d 6574 6572 2c20 3020 3c3d 2060 6070  ameter, 0 <= ``p
-0001e740: 6060 203c 2031 2e0d 0a0d 0a20 2050 6172  `` < 1.....  Par
-0001e750: 616d 6574 6572 730d 0a20 202d 2d2d 2d2d  ameters..  -----
-0001e760: 2d2d 2d2d 2d0d 0a20 2070 203a 2066 6c6f  -----..  p : flo
-0001e770: 6174 206f 7220 6172 7261 795f 6c69 6b65  at or array_like
-0001e780: 206f 6620 666c 6f61 7473 0d0a 2020 2020   of floats..    
-0001e790: 2020 5368 6170 6520 7061 7261 6d65 7465    Shape paramete
-0001e7a0: 7220 666f 7220 7468 6520 6469 7374 7269  r for the distri
-0001e7b0: 6275 7469 6f6e 2e20 204d 7573 7420 6265  bution.  Must be
-0001e7c0: 2069 6e20 7468 6520 7261 6e67 6520 5b30   in the range [0
-0001e7d0: 2c20 3129 2e0d 0a20 2073 697a 6520 3a20  , 1)...  size : 
-0001e7e0: 696e 7420 6f72 2074 7570 6c65 206f 6620  int or tuple of 
-0001e7f0: 696e 7473 2c20 6f70 7469 6f6e 616c 0d0a  ints, optional..
-0001e800: 2020 2020 2020 4f75 7470 7574 2073 6861        Output sha
-0001e810: 7065 2e20 2049 6620 7468 6520 6769 7665  pe.  If the give
-0001e820: 6e20 7368 6170 6520 6973 2c20 652e 672e  n shape is, e.g.
-0001e830: 2c20 6060 286d 2c20 6e2c 206b 2960 602c  , ``(m, n, k)``,
-0001e840: 2074 6865 6e0d 0a20 2020 2020 2060 606d   then..      ``m
-0001e850: 202a 206e 202a 206b 6060 2073 616d 706c   * n * k`` sampl
-0001e860: 6573 2061 7265 2064 7261 776e 2e20 2049  es are drawn.  I
-0001e870: 6620 7369 7a65 2069 7320 6060 4e6f 6e65  f size is ``None
-0001e880: 6060 2028 6465 6661 756c 7429 2c0d 0a20  `` (default),.. 
-0001e890: 2020 2020 2061 2073 696e 676c 6520 7661       a single va
-0001e8a0: 6c75 6520 6973 2072 6574 7572 6e65 6420  lue is returned 
-0001e8b0: 6966 2060 6070 6060 2069 7320 6120 7363  if ``p`` is a sc
-0001e8c0: 616c 6172 2e20 204f 7468 6572 7769 7365  alar.  Otherwise
-0001e8d0: 2c0d 0a20 2020 2020 2060 606e 702e 6172  ,..      ``np.ar
-0001e8e0: 7261 7928 7029 2e73 697a 6560 6020 7361  ray(p).size`` sa
-0001e8f0: 6d70 6c65 7320 6172 6520 6472 6177 6e2e  mples are drawn.
-0001e900: 0d0a 2020 6b65 7920 3a20 5052 4e47 4b65  ..  key : PRNGKe
-0001e910: 792c 206f 7074 696f 6e61 6c0d 0a20 2020  y, optional..   
-0001e920: 2020 2054 6865 206b 6579 2066 6f72 2074     The key for t
-0001e930: 6865 2072 616e 646f 6d20 6e75 6d62 6572  he random number
-0001e940: 2067 656e 6572 6174 6f72 2e20 4966 206e   generator. If n
-0001e950: 6f74 2067 6976 656e 2c20 7468 650d 0a20  ot given, the.. 
-0001e960: 2020 2020 2064 6566 6175 6c74 2072 616e       default ran
-0001e970: 646f 6d20 6e75 6d62 6572 2067 656e 6572  dom number gener
-0001e980: 6174 6f72 2069 7320 7573 6564 2e0d 0a0d  ator is used....
-0001e990: 0a20 2052 6574 7572 6e73 0d0a 2020 2d2d  .  Returns..  --
-0001e9a0: 2d2d 2d2d 2d0d 0a20 206f 7574 203a 206e  -----..  out : n
-0001e9b0: 6461 7272 6179 206f 7220 7363 616c 6172  darray or scalar
-0001e9c0: 0d0a 2020 2020 2020 4472 6177 6e20 7361  ..      Drawn sa
-0001e9d0: 6d70 6c65 7320 6672 6f6d 2074 6865 2070  mples from the p
-0001e9e0: 6172 616d 6574 6572 697a 6564 206c 6f67  arameterized log
-0001e9f0: 6172 6974 686d 6963 2073 6572 6965 7320  arithmic series 
-0001ea00: 6469 7374 7269 6275 7469 6f6e 2e0d 0a0d  distribution....
-0001ea10: 0a20 2053 6565 2041 6c73 6f0d 0a20 202d  .  See Also..  -
-0001ea20: 2d2d 2d2d 2d2d 2d0d 0a20 2073 6369 7079  -------..  scipy
-0001ea30: 2e73 7461 7473 2e6c 6f67 7365 7220 3a20  .stats.logser : 
-0001ea40: 7072 6f62 6162 696c 6974 7920 6465 6e73  probability dens
-0001ea50: 6974 7920 6675 6e63 7469 6f6e 2c20 6469  ity function, di
-0001ea60: 7374 7269 6275 7469 6f6e 206f 720d 0a20  stribution or.. 
-0001ea70: 2020 2020 2063 756d 756c 6174 6976 6520       cumulative 
-0001ea80: 6465 6e73 6974 7920 6675 6e63 7469 6f6e  density function
-0001ea90: 2c20 6574 632e 0d0a 0d0a 2020 4e6f 7465  , etc.....  Note
-0001eaa0: 730d 0a20 202d 2d2d 2d2d 0d0a 2020 5468  s..  -----..  Th
-0001eab0: 6520 7072 6f62 6162 696c 6974 7920 6465  e probability de
-0001eac0: 6e73 6974 7920 666f 7220 7468 6520 4c6f  nsity for the Lo
-0001ead0: 6720 5365 7269 6573 2064 6973 7472 6962  g Series distrib
-0001eae0: 7574 696f 6e20 6973 0d0a 0d0a 2020 2e2e  ution is....  ..
-0001eaf0: 206d 6174 683a 3a20 5028 6b29 203d 205c   math:: P(k) = \
-0001eb00: 6672 6163 7b2d 705e 6b7d 7b6b 205c 6c6e  frac{-p^k}{k \ln
-0001eb10: 2831 2d70 297d 2c0d 0a0d 0a20 2077 6865  (1-p)},....  whe
-0001eb20: 7265 2070 203d 2070 726f 6261 6269 6c69  re p = probabili
-0001eb30: 7479 2e0d 0a0d 0a20 2054 6865 206c 6f67  ty.....  The log
-0001eb40: 2073 6572 6965 7320 6469 7374 7269 6275   series distribu
-0001eb50: 7469 6f6e 2069 7320 6672 6571 7565 6e74  tion is frequent
-0001eb60: 6c79 2075 7365 6420 746f 2072 6570 7265  ly used to repre
-0001eb70: 7365 6e74 2073 7065 6369 6573 0d0a 2020  sent species..  
-0001eb80: 7269 6368 6e65 7373 2061 6e64 206f 6363  richness and occ
-0001eb90: 7572 7265 6e63 652c 2066 6972 7374 2070  urrence, first p
-0001eba0: 726f 706f 7365 6420 6279 2046 6973 6865  roposed by Fishe
-0001ebb0: 722c 2043 6f72 6265 742c 2061 6e64 0d0a  r, Corbet, and..
-0001ebc0: 2020 5769 6c6c 6961 6d73 2069 6e20 3139    Williams in 19
-0001ebd0: 3433 205b 325d 2e20 2049 7420 6d61 7920  43 [2].  It may 
-0001ebe0: 616c 736f 2062 6520 7573 6564 2074 6f20  also be used to 
-0001ebf0: 6d6f 6465 6c20 7468 6520 6e75 6d62 6572  model the number
-0001ec00: 7320 6f66 0d0a 2020 6f63 6375 7061 6e74  s of..  occupant
-0001ec10: 7320 7365 656e 2069 6e20 6361 7273 205b  s seen in cars [
-0001ec20: 335d 2e0d 0a0d 0a20 2052 6566 6572 656e  3].....  Referen
-0001ec30: 6365 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d  ces..  ---------
-0001ec40: 2d0d 0a20 202e 2e20 5b31 5d20 4275 7a61  -..  .. [1] Buza
-0001ec50: 732c 204d 6172 7469 6e20 412e 3b20 4375  s, Martin A.; Cu
-0001ec60: 6c76 6572 2c20 5374 6570 6865 6e20 4a2e  lver, Stephen J.
-0001ec70: 2c20 2055 6e64 6572 7374 616e 6469 6e67  ,  Understanding
-0001ec80: 2072 6567 696f 6e61 6c0d 0a20 2020 2020   regional..     
-0001ec90: 2020 2020 7370 6563 6965 7320 6469 7665      species dive
-0001eca0: 7273 6974 7920 7468 726f 7567 6820 7468  rsity through th
-0001ecb0: 6520 6c6f 6720 7365 7269 6573 2064 6973  e log series dis
-0001ecc0: 7472 6962 7574 696f 6e20 6f66 0d0a 2020  tribution of..  
-0001ecd0: 2020 2020 2020 206f 6363 7572 7265 6e63         occurrenc
-0001ece0: 6573 3a20 4249 4f44 4956 4552 5349 5459  es: BIODIVERSITY
-0001ecf0: 2052 4553 4541 5243 4820 4469 7665 7273   RESEARCH Divers
-0001ed00: 6974 7920 2620 4469 7374 7269 6275 7469  ity & Distributi
-0001ed10: 6f6e 732c 0d0a 2020 2020 2020 2020 2056  ons,..         V
-0001ed20: 6f6c 756d 6520 352c 204e 756d 6265 7220  olume 5, Number 
-0001ed30: 352c 2053 6570 7465 6d62 6572 2031 3939  5, September 199
-0001ed40: 3920 2c20 7070 2e20 3138 372d 3139 3528  9 , pp. 187-195(
-0001ed50: 3929 2e0d 0a20 202e 2e20 5b32 5d20 4669  9)...  .. [2] Fi
-0001ed60: 7368 6572 2c20 522e 412c 2c20 412e 532e  sher, R.A,, A.S.
-0001ed70: 2043 6f72 6265 742c 2061 6e64 2043 2e42   Corbet, and C.B
-0001ed80: 2e20 5769 6c6c 6961 6d73 2e20 3139 3433  . Williams. 1943
-0001ed90: 2e20 5468 650d 0a20 2020 2020 2020 2020  . The..         
-0001eda0: 7265 6c61 7469 6f6e 2062 6574 7765 656e  relation between
-0001edb0: 2074 6865 206e 756d 6265 7220 6f66 2073   the number of s
-0001edc0: 7065 6369 6573 2061 6e64 2074 6865 206e  pecies and the n
-0001edd0: 756d 6265 7220 6f66 0d0a 2020 2020 2020  umber of..      
-0001ede0: 2020 2069 6e64 6976 6964 7561 6c73 2069     individuals i
-0001edf0: 6e20 6120 7261 6e64 6f6d 2073 616d 706c  n a random sampl
-0001ee00: 6520 6f66 2061 6e20 616e 696d 616c 2070  e of an animal p
-0001ee10: 6f70 756c 6174 696f 6e2e 0d0a 2020 2020  opulation...    
-0001ee20: 2020 2020 204a 6f75 726e 616c 206f 6620       Journal of 
-0001ee30: 416e 696d 616c 2045 636f 6c6f 6779 2c20  Animal Ecology, 
-0001ee40: 3132 3a34 322d 3538 2e0d 0a20 202e 2e20  12:42-58...  .. 
-0001ee50: 5b33 5d20 442e 204a 2e20 4861 6e64 2c20  [3] D. J. Hand, 
-0001ee60: 462e 2044 616c 792c 2044 2e20 4c75 6e6e  F. Daly, D. Lunn
-0001ee70: 2c20 452e 204f 7374 726f 7773 6b69 2c20  , E. Ostrowski, 
-0001ee80: 4120 4861 6e64 626f 6f6b 206f 6620 536d  A Handbook of Sm
-0001ee90: 616c 6c0d 0a20 2020 2020 2020 2020 4461  all..         Da
-0001eea0: 7461 2053 6574 732c 2043 5243 2050 7265  ta Sets, CRC Pre
-0001eeb0: 7373 2c20 3139 3934 2e0d 0a20 202e 2e20  ss, 1994...  .. 
-0001eec0: 5b34 5d20 5769 6b69 7065 6469 612c 2022  [4] Wikipedia, "
-0001eed0: 4c6f 6761 7269 7468 6d69 6320 6469 7374  Logarithmic dist
-0001eee0: 7269 6275 7469 6f6e 222c 0d0a 2020 2020  ribution",..    
-0001eef0: 2020 2020 2068 7474 7073 3a2f 2f65 6e2e       https://en.
-0001ef00: 7769 6b69 7065 6469 612e 6f72 672f 7769  wikipedia.org/wi
-0001ef10: 6b69 2f4c 6f67 6172 6974 686d 6963 5f64  ki/Logarithmic_d
-0001ef20: 6973 7472 6962 7574 696f 6e0d 0a0d 0a20  istribution.... 
-0001ef30: 2045 7861 6d70 6c65 730d 0a20 202d 2d2d   Examples..  ---
-0001ef40: 2d2d 2d2d 2d0d 0a20 2044 7261 7720 7361  -----..  Draw sa
-0001ef50: 6d70 6c65 7320 6672 6f6d 2074 6865 2064  mples from the d
-0001ef60: 6973 7472 6962 7574 696f 6e3a 0d0a 0d0a  istribution:....
-0001ef70: 2020 3e3e 3e20 6120 3d20 2e36 0d0a 2020    >>> a = .6..  
-0001ef80: 3e3e 3e20 7320 3d20 6263 2e72 616e 646f  >>> s = bc.rando
-0001ef90: 6d2e 6c6f 6773 6572 6965 7328 612c 2031  m.logseries(a, 1
-0001efa0: 3030 3030 290d 0a20 203e 3e3e 2069 6d70  0000)..  >>> imp
-0001efb0: 6f72 7420 6d61 7470 6c6f 746c 6962 2e70  ort matplotlib.p
-0001efc0: 7970 6c6f 7420 6173 2070 6c74 2020 2320  yplot as plt  # 
-0001efd0: 6e6f 7161 0d0a 2020 3e3e 3e20 636f 756e  noqa..  >>> coun
-0001efe0: 742c 2062 696e 732c 2069 676e 6f72 6564  t, bins, ignored
-0001eff0: 203d 2070 6c74 2e68 6973 7428 7329 0d0a   = plt.hist(s)..
-0001f000: 0d0a 2020 2320 2020 706c 6f74 2061 6761  ..  #   plot aga
-0001f010: 696e 7374 2064 6973 7472 6962 7574 696f  inst distributio
-0001f020: 6e0d 0a0d 0a20 203e 3e3e 2064 6566 206c  n....  >>> def l
-0001f030: 6f67 7365 7269 6573 286b 2c20 7029 3a0d  ogseries(k, p):.
-0001f040: 0a20 202e 2e2e 2020 2020 2072 6574 7572  .  ...     retur
-0001f050: 6e20 2d70 2a2a 6b2f 286b 2a6e 702e 6c6f  n -p**k/(k*np.lo
-0001f060: 6728 312d 7029 290d 0a20 203e 3e3e 2070  g(1-p))..  >>> p
-0001f070: 6c74 2e70 6c6f 7428 6269 6e73 2c20 6c6f  lt.plot(bins, lo
-0001f080: 6773 6572 6965 7328 6269 6e73 2c20 6129  gseries(bins, a)
-0001f090: 2a63 6f75 6e74 2e6d 6178 2829 2f0d 0a20  *count.max()/.. 
-0001f0a0: 202e 2e2e 2020 2020 2020 2020 2020 6c6f   ...          lo
-0001f0b0: 6773 6572 6965 7328 6269 6e73 2c20 6129  gseries(bins, a)
-0001f0c0: 2e6d 6178 2829 2c20 2772 2729 0d0a 2020  .max(), 'r')..  
-0001f0d0: 3e3e 3e20 706c 742e 7368 6f77 2829 0d0a  >>> plt.show()..
-0001f0e0: 2020 2222 220d 0a20 2072 6574 7572 6e20    """..  return 
-0001f0f0: 4445 4641 554c 542e 6c6f 6773 6572 6965  DEFAULT.logserie
-0001f100: 7328 702c 2073 697a 652c 206b 6579 3d6b  s(p, size, key=k
-0001f110: 6579 2c20 6474 7970 653d 6474 7970 6529  ey, dtype=dtype)
-0001f120: 0d0a 0d0a 0d0a 6465 6620 6d75 6c74 696e  ......def multin
-0001f130: 6f6d 6961 6c28 6e2c 2070 7661 6c73 2c20  omial(n, pvals, 
-0001f140: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b53  size: Optional[S
-0001f150: 697a 655d 203d 204e 6f6e 652c 0d0a 2020  ize] = None,..  
-0001f160: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
-0001f170: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
-0001f180: 4f72 4b65 795d 203d 204e 6f6e 652c 2064  OrKey] = None, d
-0001f190: 7479 7065 3a20 4454 7970 654c 696b 6520  type: DTypeLike 
-0001f1a0: 3d20 4e6f 6e65 293a 0d0a 2020 7222 2222  = None):..  r"""
-0001f1b0: 0d0a 2020 4472 6177 2073 616d 706c 6573  ..  Draw samples
-0001f1c0: 2066 726f 6d20 6120 6d75 6c74 696e 6f6d   from a multinom
-0001f1d0: 6961 6c20 6469 7374 7269 6275 7469 6f6e  ial distribution
-0001f1e0: 2e0d 0a0d 0a20 2054 6865 206d 756c 7469  .....  The multi
-0001f1f0: 6e6f 6d69 616c 2064 6973 7472 6962 7574  nomial distribut
-0001f200: 696f 6e20 6973 2061 206d 756c 7469 7661  ion is a multiva
-0001f210: 7269 6174 6520 6765 6e65 7261 6c69 7a61  riate generaliza
-0001f220: 7469 6f6e 206f 6620 7468 650d 0a20 2062  tion of the..  b
-0001f230: 696e 6f6d 6961 6c20 6469 7374 7269 6275  inomial distribu
-0001f240: 7469 6f6e 2e20 2054 616b 6520 616e 2065  tion.  Take an e
-0001f250: 7870 6572 696d 656e 7420 7769 7468 206f  xperiment with o
-0001f260: 6e65 206f 6620 6060 7060 600d 0a20 2070  ne of ``p``..  p
-0001f270: 6f73 7369 626c 6520 6f75 7463 6f6d 6573  ossible outcomes
-0001f280: 2e20 2041 6e20 6578 616d 706c 6520 6f66  .  An example of
-0001f290: 2073 7563 6820 616e 2065 7870 6572 696d   such an experim
-0001f2a0: 656e 7420 6973 2074 6872 6f77 696e 6720  ent is throwing 
-0001f2b0: 6120 6469 6365 2c0d 0a20 2077 6865 7265  a dice,..  where
-0001f2c0: 2074 6865 206f 7574 636f 6d65 2063 616e   the outcome can
-0001f2d0: 2062 6520 3120 7468 726f 7567 6820 362e   be 1 through 6.
-0001f2e0: 2020 4561 6368 2073 616d 706c 6520 6472    Each sample dr
-0001f2f0: 6177 6e20 6672 6f6d 2074 6865 0d0a 2020  awn from the..  
-0001f300: 6469 7374 7269 6275 7469 6f6e 2072 6570  distribution rep
-0001f310: 7265 7365 6e74 7320 606e 6020 7375 6368  resents `n` such
-0001f320: 2065 7870 6572 696d 656e 7473 2e20 2049   experiments.  I
-0001f330: 7473 2076 616c 7565 732c 0d0a 2020 6060  ts values,..  ``
-0001f340: 585f 6920 3d20 5b58 5f30 2c20 585f 312c  X_i = [X_0, X_1,
-0001f350: 202e 2e2e 2c20 585f 705d 6060 2c20 7265   ..., X_p]``, re
-0001f360: 7072 6573 656e 7420 7468 6520 6e75 6d62  present the numb
-0001f370: 6572 206f 6620 7469 6d65 7320 7468 650d  er of times the.
-0001f380: 0a20 206f 7574 636f 6d65 2077 6173 2060  .  outcome was `
-0001f390: 6069 6060 2e0d 0a0d 0a20 2050 6172 616d  `i``.....  Param
-0001f3a0: 6574 6572 730d 0a20 202d 2d2d 2d2d 2d2d  eters..  -------
-0001f3b0: 2d2d 2d0d 0a20 206e 203a 2069 6e74 0d0a  ---..  n : int..
-0001f3c0: 2020 2020 2020 4e75 6d62 6572 206f 6620        Number of 
-0001f3d0: 6578 7065 7269 6d65 6e74 732e 0d0a 2020  experiments...  
-0001f3e0: 7076 616c 7320 3a20 7365 7175 656e 6365  pvals : sequence
-0001f3f0: 206f 6620 666c 6f61 7473 2c20 6c65 6e67   of floats, leng
-0001f400: 7468 2070 0d0a 2020 2020 2020 5072 6f62  th p..      Prob
-0001f410: 6162 696c 6974 6965 7320 6f66 2065 6163  abilities of eac
-0001f420: 6820 6f66 2074 6865 2060 6070 6060 2064  h of the ``p`` d
-0001f430: 6966 6665 7265 6e74 206f 7574 636f 6d65  ifferent outcome
-0001f440: 732e 2020 5468 6573 650d 0a20 2020 2020  s.  These..     
-0001f450: 206d 7573 7420 7375 6d20 746f 2031 2028   must sum to 1 (
-0001f460: 686f 7765 7665 722c 2074 6865 206c 6173  however, the las
-0001f470: 7420 656c 656d 656e 7420 6973 2061 6c77  t element is alw
-0001f480: 6179 7320 6173 7375 6d65 6420 746f 0d0a  ays assumed to..
-0001f490: 2020 2020 2020 6163 636f 756e 7420 666f        account fo
-0001f4a0: 7220 7468 6520 7265 6d61 696e 696e 6720  r the remaining 
-0001f4b0: 7072 6f62 6162 696c 6974 792c 2061 7320  probability, as 
-0001f4c0: 6c6f 6e67 2061 730d 0a20 2020 2020 2060  long as..      `
-0001f4d0: 6073 756d 2870 7661 6c73 5b3a 2d31 5d29  `sum(pvals[:-1])
-0001f4e0: 203c 3d20 3129 6060 2e0d 0a20 2073 697a   <= 1)``...  siz
-0001f4f0: 6520 3a20 696e 7420 6f72 2074 7570 6c65  e : int or tuple
-0001f500: 206f 6620 696e 7473 2c20 6f70 7469 6f6e   of ints, option
-0001f510: 616c 0d0a 2020 2020 2020 4f75 7470 7574  al..      Output
-0001f520: 2073 6861 7065 2e20 2049 6620 7468 6520   shape.  If the 
-0001f530: 6769 7665 6e20 7368 6170 6520 6973 2c20  given shape is, 
-0001f540: 652e 672e 2c20 6060 286d 2c20 6e2c 206b  e.g., ``(m, n, k
-0001f550: 2960 602c 2074 6865 6e0d 0a20 2020 2020  )``, then..     
-0001f560: 2060 606d 202a 206e 202a 206b 6060 2073   ``m * n * k`` s
-0001f570: 616d 706c 6573 2061 7265 2064 7261 776e  amples are drawn
-0001f580: 2e20 2044 6566 6175 6c74 2069 7320 4e6f  .  Default is No
-0001f590: 6e65 2c20 696e 2077 6869 6368 2063 6173  ne, in which cas
-0001f5a0: 6520 610d 0a20 2020 2020 2073 696e 676c  e a..      singl
-0001f5b0: 6520 7661 6c75 6520 6973 2072 6574 7572  e value is retur
-0001f5c0: 6e65 642e 0d0a 2020 6b65 7920 3a20 5052  ned...  key : PR
-0001f5d0: 4e47 4b65 792c 206f 7074 696f 6e61 6c0d  NGKey, optional.
-0001f5e0: 0a20 2020 2020 2054 6865 206b 6579 2066  .      The key f
-0001f5f0: 6f72 2074 6865 2072 616e 646f 6d20 6e75  or the random nu
-0001f600: 6d62 6572 2067 656e 6572 6174 6f72 2e20  mber generator. 
-0001f610: 4966 206e 6f74 2067 6976 656e 2c20 7468  If not given, th
-0001f620: 650d 0a20 2020 2020 2064 6566 6175 6c74  e..      default
-0001f630: 2072 616e 646f 6d20 6e75 6d62 6572 2067   random number g
-0001f640: 656e 6572 6174 6f72 2069 7320 7573 6564  enerator is used
-0001f650: 2e0d 0a0d 0a20 2052 6574 7572 6e73 0d0a  .....  Returns..
-0001f660: 2020 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574    -------..  out
-0001f670: 203a 206e 6461 7272 6179 0d0a 2020 2020   : ndarray..    
-0001f680: 2020 5468 6520 6472 6177 6e20 7361 6d70    The drawn samp
-0001f690: 6c65 732c 206f 6620 7368 6170 6520 2a73  les, of shape *s
-0001f6a0: 697a 652a 2c20 6966 2074 6861 7420 7761  ize*, if that wa
-0001f6b0: 7320 7072 6f76 6964 6564 2e20 2049 6620  s provided.  If 
-0001f6c0: 6e6f 742c 0d0a 2020 2020 2020 7468 6520  not,..      the 
-0001f6d0: 7368 6170 6520 6973 2060 6028 4e2c 2960  shape is ``(N,)`
-0001f6e0: 602e 0d0a 0d0a 2020 2020 2020 496e 206f  `.....      In o
-0001f6f0: 7468 6572 2077 6f72 6473 2c20 6561 6368  ther words, each
-0001f700: 2065 6e74 7279 2060 606f 7574 5b69 2c6a   entry ``out[i,j
-0001f710: 2c2e 2e2e 2c3a 5d60 6020 6973 2061 6e20  ,...,:]`` is an 
-0001f720: 4e2d 6469 6d65 6e73 696f 6e61 6c0d 0a20  N-dimensional.. 
-0001f730: 2020 2020 2076 616c 7565 2064 7261 776e       value drawn
-0001f740: 2066 726f 6d20 7468 6520 6469 7374 7269   from the distri
-0001f750: 6275 7469 6f6e 2e0d 0a0d 0a20 2045 7861  bution.....  Exa
-0001f760: 6d70 6c65 730d 0a20 202d 2d2d 2d2d 2d2d  mples..  -------
-0001f770: 2d0d 0a20 2054 6872 6f77 2061 2064 6963  -..  Throw a dic
-0001f780: 6520 3230 2074 696d 6573 3a0d 0a0d 0a20  e 20 times:.... 
-0001f790: 203e 3e3e 2062 632e 7261 6e64 6f6d 2e6d   >>> bc.random.m
-0001f7a0: 756c 7469 6e6f 6d69 616c 2832 302c 205b  ultinomial(20, [
-0001f7b0: 312f 362e 5d2a 362c 2073 697a 653d 3129  1/6.]*6, size=1)
-0001f7c0: 0d0a 2020 6172 7261 7928 5b5b 342c 2031  ..  array([[4, 1
-0001f7d0: 2c20 372c 2035 2c20 322c 2031 5d5d 2920  , 7, 5, 2, 1]]) 
-0001f7e0: 2320 7261 6e64 6f6d 0d0a 0d0a 2020 4974  # random....  It
-0001f7f0: 206c 616e 6465 6420 3420 7469 6d65 7320   landed 4 times 
-0001f800: 6f6e 2031 2c20 6f6e 6365 206f 6e20 322c  on 1, once on 2,
-0001f810: 2065 7463 2e0d 0a0d 0a20 204e 6f77 2c20   etc.....  Now, 
-0001f820: 7468 726f 7720 7468 6520 6469 6365 2032  throw the dice 2
-0001f830: 3020 7469 6d65 732c 2061 6e64 2032 3020  0 times, and 20 
-0001f840: 7469 6d65 7320 6167 6169 6e3a 0d0a 0d0a  times again:....
-0001f850: 2020 3e3e 3e20 6263 2e72 616e 646f 6d2e    >>> bc.random.
-0001f860: 6d75 6c74 696e 6f6d 6961 6c28 3230 2c20  multinomial(20, 
-0001f870: 5b31 2f36 2e5d 2a36 2c20 7369 7a65 3d32  [1/6.]*6, size=2
-0001f880: 290d 0a20 2061 7272 6179 285b 5b33 2c20  )..  array([[3, 
-0001f890: 342c 2033 2c20 332c 2034 2c20 335d 2c20  4, 3, 3, 4, 3], 
-0001f8a0: 2320 7261 6e64 6f6d 0d0a 2020 2020 2020  # random..      
-0001f8b0: 2020 205b 322c 2034 2c20 332c 2034 2c20     [2, 4, 3, 4, 
-0001f8c0: 302c 2037 5d5d 290d 0a0d 0a20 2046 6f72  0, 7]])....  For
-0001f8d0: 2074 6865 2066 6972 7374 2072 756e 2c20   the first run, 
-0001f8e0: 7765 2074 6872 6577 2033 2074 696d 6573  we threw 3 times
-0001f8f0: 2031 2c20 3420 7469 6d65 7320 322c 2065   1, 4 times 2, e
-0001f900: 7463 2e20 2046 6f72 2074 6865 2073 6563  tc.  For the sec
-0001f910: 6f6e 642c 0d0a 2020 7765 2074 6872 6577  ond,..  we threw
-0001f920: 2032 2074 696d 6573 2031 2c20 3420 7469   2 times 1, 4 ti
-0001f930: 6d65 7320 322c 2065 7463 2e0d 0a0d 0a20  mes 2, etc..... 
-0001f940: 2041 206c 6f61 6465 6420 6469 6520 6973   A loaded die is
-0001f950: 206d 6f72 6520 6c69 6b65 6c79 2074 6f20   more likely to 
-0001f960: 6c61 6e64 206f 6e20 6e75 6d62 6572 2036  land on number 6
-0001f970: 3a0d 0a0d 0a20 203e 3e3e 2062 632e 7261  :....  >>> bc.ra
-0001f980: 6e64 6f6d 2e6d 756c 7469 6e6f 6d69 616c  ndom.multinomial
-0001f990: 2831 3030 2c20 5b31 2f37 2e5d 2a35 202b  (100, [1/7.]*5 +
-0001f9a0: 205b 322f 372e 5d29 0d0a 2020 6172 7261   [2/7.])..  arra
-0001f9b0: 7928 5b31 312c 2031 362c 2031 342c 2031  y([11, 16, 14, 1
-0001f9c0: 372c 2031 362c 2032 365d 2920 2320 7261  7, 16, 26]) # ra
-0001f9d0: 6e64 6f6d 0d0a 0d0a 2020 5468 6520 7072  ndom....  The pr
-0001f9e0: 6f62 6162 696c 6974 7920 696e 7075 7473  obability inputs
-0001f9f0: 2073 686f 756c 6420 6265 206e 6f72 6d61   should be norma
-0001fa00: 6c69 7a65 642e 2041 7320 616e 2069 6d70  lized. As an imp
-0001fa10: 6c65 6d65 6e74 6174 696f 6e0d 0a20 2064  lementation..  d
-0001fa20: 6574 6169 6c2c 2074 6865 2076 616c 7565  etail, the value
-0001fa30: 206f 6620 7468 6520 6c61 7374 2065 6e74   of the last ent
-0001fa40: 7279 2069 7320 6967 6e6f 7265 6420 616e  ry is ignored an
-0001fa50: 6420 6173 7375 6d65 6420 746f 2074 616b  d assumed to tak
-0001fa60: 650d 0a20 2075 7020 616e 7920 6c65 6674  e..  up any left
-0001fa70: 6f76 6572 2070 726f 6261 6269 6c69 7479  over probability
-0001fa80: 206d 6173 732c 2062 7574 2074 6869 7320   mass, but this 
-0001fa90: 7368 6f75 6c64 206e 6f74 2062 6520 7265  should not be re
-0001faa0: 6c69 6564 206f 6e2e 0d0a 2020 4120 6269  lied on...  A bi
-0001fab0: 6173 6564 2063 6f69 6e20 7768 6963 6820  ased coin which 
-0001fac0: 6861 7320 7477 6963 6520 6173 206d 7563  has twice as muc
-0001fad0: 6820 7765 6967 6874 206f 6e20 6f6e 6520  h weight on one 
-0001fae0: 7369 6465 2061 7320 6f6e 2074 6865 0d0a  side as on the..
-0001faf0: 2020 6f74 6865 7220 7368 6f75 6c64 2062    other should b
-0001fb00: 6520 7361 6d70 6c65 6420 6c69 6b65 2073  e sampled like s
-0001fb10: 6f3a 0d0a 0d0a 2020 3e3e 3e20 6263 2e72  o:....  >>> bc.r
-0001fb20: 616e 646f 6d2e 6d75 6c74 696e 6f6d 6961  andom.multinomia
-0001fb30: 6c28 3130 302c 205b 312e 3020 2f20 332c  l(100, [1.0 / 3,
-0001fb40: 2032 2e30 202f 2033 5d29 2020 2320 5249   2.0 / 3])  # RI
-0001fb50: 4748 540d 0a20 2061 7272 6179 285b 3338  GHT..  array([38
-0001fb60: 2c20 3632 5d29 2023 2072 616e 646f 6d0d  , 62]) # random.
-0001fb70: 0a0d 0a20 206e 6f74 206c 696b 653a 0d0a  ...  not like:..
-0001fb80: 0d0a 2020 3e3e 3e20 6263 2e72 616e 646f  ..  >>> bc.rando
-0001fb90: 6d2e 6d75 6c74 696e 6f6d 6961 6c28 3130  m.multinomial(10
-0001fba0: 302c 205b 312e 302c 2032 2e30 5d29 2020  0, [1.0, 2.0])  
-0001fbb0: 2320 5752 4f4e 470d 0a20 2054 7261 6365  # WRONG..  Trace
-0001fbc0: 6261 636b 2028 6d6f 7374 2072 6563 656e  back (most recen
-0001fbd0: 7420 6361 6c6c 206c 6173 7429 3a0d 0a20  t call last):.. 
-0001fbe0: 2056 616c 7565 4572 726f 723a 2070 7661   ValueError: pva
-0001fbf0: 6c73 203c 2030 2c20 7076 616c 7320 3e20  ls < 0, pvals > 
-0001fc00: 3120 6f72 2070 7661 6c73 2063 6f6e 7461  1 or pvals conta
-0001fc10: 696e 7320 4e61 4e73 0d0a 2020 2222 220d  ins NaNs..  """.
-0001fc20: 0a20 2072 6574 7572 6e20 4445 4641 554c  .  return DEFAUL
-0001fc30: 542e 6d75 6c74 696e 6f6d 6961 6c28 6e2c  T.multinomial(n,
-0001fc40: 2070 7661 6c73 2c20 7369 7a65 2c20 6b65   pvals, size, ke
-0001fc50: 793d 6b65 792c 2064 7479 7065 3d64 7479  y=key, dtype=dty
-0001fc60: 7065 290d 0a0d 0a0d 0a64 6566 206d 756c  pe)......def mul
-0001fc70: 7469 7661 7269 6174 655f 6e6f 726d 616c  tivariate_normal
-0001fc80: 286d 6561 6e2c 2063 6f76 2c20 7369 7a65  (mean, cov, size
-0001fc90: 3a20 4f70 7469 6f6e 616c 5b53 697a 655d  : Optional[Size]
-0001fca0: 203d 204e 6f6e 652c 206d 6574 686f 643a   = None, method:
-0001fcb0: 2073 7472 203d 2027 6368 6f6c 6573 6b79   str = 'cholesky
-0001fcc0: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
-0001fcd0: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
-0001fce0: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
-0001fcf0: 4b65 795d 203d 204e 6f6e 652c 2064 7479  Key] = None, dty
-0001fd00: 7065 3a20 4454 7970 654c 696b 6520 3d20  pe: DTypeLike = 
-0001fd10: 4e6f 6e65 293a 0d0a 2020 7222 2222 0d0a  None):..  r"""..
-0001fd20: 2020 4472 6177 2072 616e 646f 6d20 7361    Draw random sa
-0001fd30: 6d70 6c65 7320 6672 6f6d 2061 206d 756c  mples from a mul
-0001fd40: 7469 7661 7269 6174 6520 6e6f 726d 616c  tivariate normal
-0001fd50: 2064 6973 7472 6962 7574 696f 6e2e 0d0a   distribution...
-0001fd60: 0d0a 2020 5468 6520 6d75 6c74 6976 6172  ..  The multivar
-0001fd70: 6961 7465 206e 6f72 6d61 6c2c 206d 756c  iate normal, mul
-0001fd80: 7469 6e6f 726d 616c 206f 7220 4761 7573  tinormal or Gaus
-0001fd90: 7369 616e 2064 6973 7472 6962 7574 696f  sian distributio
-0001fda0: 6e20 6973 2061 0d0a 2020 6765 6e65 7261  n is a..  genera
-0001fdb0: 6c69 7a61 7469 6f6e 206f 6620 7468 6520  lization of the 
-0001fdc0: 6f6e 652d 6469 6d65 6e73 696f 6e61 6c20  one-dimensional 
-0001fdd0: 6e6f 726d 616c 2064 6973 7472 6962 7574  normal distribut
-0001fde0: 696f 6e20 746f 2068 6967 6865 720d 0a20  ion to higher.. 
-0001fdf0: 2064 696d 656e 7369 6f6e 732e 2020 5375   dimensions.  Su
-0001fe00: 6368 2061 2064 6973 7472 6962 7574 696f  ch a distributio
-0001fe10: 6e20 6973 2073 7065 6369 6669 6564 2062  n is specified b
-0001fe20: 7920 6974 7320 6d65 616e 2061 6e64 0d0a  y its mean and..
-0001fe30: 2020 636f 7661 7269 616e 6365 206d 6174    covariance mat
-0001fe40: 7269 782e 2020 5468 6573 6520 7061 7261  rix.  These para
-0001fe50: 6d65 7465 7273 2061 7265 2061 6e61 6c6f  meters are analo
-0001fe60: 676f 7573 2074 6f20 7468 6520 6d65 616e  gous to the mean
-0001fe70: 0d0a 2020 2861 7665 7261 6765 206f 7220  ..  (average or 
-0001fe80: 2263 656e 7465 7222 2920 616e 6420 7661  "center") and va
-0001fe90: 7269 616e 6365 2028 7374 616e 6461 7264  riance (standard
-0001fea0: 2064 6576 6961 7469 6f6e 2c20 6f72 2022   deviation, or "
-0001feb0: 7769 6474 682c 220d 0a20 2073 7175 6172  width,"..  squar
-0001fec0: 6564 2920 6f66 2074 6865 206f 6e65 2d64  ed) of the one-d
-0001fed0: 696d 656e 7369 6f6e 616c 206e 6f72 6d61  imensional norma
-0001fee0: 6c20 6469 7374 7269 6275 7469 6f6e 2e0d  l distribution..
-0001fef0: 0a0d 0a20 2050 6172 616d 6574 6572 730d  ...  Parameters.
-0001ff00: 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  .  ----------.. 
-0001ff10: 206d 6561 6e20 3a20 312d 4420 6172 7261   mean : 1-D arra
-0001ff20: 795f 6c69 6b65 2c20 6f66 206c 656e 6774  y_like, of lengt
-0001ff30: 6820 4e0d 0a20 2020 2020 204d 6561 6e20  h N..      Mean 
-0001ff40: 6f66 2074 6865 204e 2d64 696d 656e 7369  of the N-dimensi
-0001ff50: 6f6e 616c 2064 6973 7472 6962 7574 696f  onal distributio
-0001ff60: 6e2e 0d0a 2020 636f 7620 3a20 322d 4420  n...  cov : 2-D 
-0001ff70: 6172 7261 795f 6c69 6b65 2c20 6f66 2073  array_like, of s
-0001ff80: 6861 7065 2028 4e2c 204e 290d 0a20 2020  hape (N, N)..   
-0001ff90: 2020 2043 6f76 6172 6961 6e63 6520 6d61     Covariance ma
-0001ffa0: 7472 6978 206f 6620 7468 6520 6469 7374  trix of the dist
-0001ffb0: 7269 6275 7469 6f6e 2e20 4974 206d 7573  ribution. It mus
-0001ffc0: 7420 6265 2073 796d 6d65 7472 6963 2061  t be symmetric a
-0001ffd0: 6e64 0d0a 2020 2020 2020 706f 7369 7469  nd..      positi
-0001ffe0: 7665 2d73 656d 6964 6566 696e 6974 6520  ve-semidefinite 
-0001fff0: 666f 7220 7072 6f70 6572 2073 616d 706c  for proper sampl
-00020000: 696e 672e 0d0a 2020 7369 7a65 203a 2069  ing...  size : i
-00020010: 6e74 206f 7220 7475 706c 6520 6f66 2069  nt or tuple of i
-00020020: 6e74 732c 206f 7074 696f 6e61 6c0d 0a20  nts, optional.. 
-00020030: 2020 2020 2047 6976 656e 2061 2073 6861       Given a sha
-00020040: 7065 206f 662c 2066 6f72 2065 7861 6d70  pe of, for examp
-00020050: 6c65 2c20 6060 286d 2c6e 2c6b 2960 602c  le, ``(m,n,k)``,
-00020060: 2060 606d 2a6e 2a6b 6060 2073 616d 706c   ``m*n*k`` sampl
-00020070: 6573 2061 7265 0d0a 2020 2020 2020 6765  es are..      ge
-00020080: 6e65 7261 7465 642c 2061 6e64 2070 6163  nerated, and pac
-00020090: 6b65 6420 696e 2061 6e20 606d 602d 6279  ked in an `m`-by
-000200a0: 2d60 6e60 2d62 792d 606b 6020 6172 7261  -`n`-by-`k` arra
-000200b0: 6e67 656d 656e 742e 2020 4265 6361 7573  ngement.  Becaus
-000200c0: 650d 0a20 2020 2020 2065 6163 6820 7361  e..      each sa
-000200d0: 6d70 6c65 2069 7320 604e 602d 6469 6d65  mple is `N`-dime
-000200e0: 6e73 696f 6e61 6c2c 2074 6865 206f 7574  nsional, the out
-000200f0: 7075 7420 7368 6170 6520 6973 2060 6028  put shape is ``(
-00020100: 6d2c 6e2c 6b2c 4e29 6060 2e0d 0a20 2020  m,n,k,N)``...   
-00020110: 2020 2049 6620 6e6f 2073 6861 7065 2069     If no shape i
-00020120: 7320 7370 6563 6966 6965 642c 2061 2073  s specified, a s
-00020130: 696e 676c 6520 2860 4e60 2d44 2920 7361  ingle (`N`-D) sa
-00020140: 6d70 6c65 2069 7320 7265 7475 726e 6564  mple is returned
-00020150: 2e0d 0a20 206d 6574 686f 6420 3a20 7b27  ...  method : {'
-00020160: 6368 6f6c 6573 6b79 272c 2027 6569 6727  cholesky', 'eig'
-00020170: 7d2c 206f 7074 696f 6e61 6c0d 0a20 2020  }, optional..   
-00020180: 2020 2054 6865 206d 6574 686f 6420 7573     The method us
-00020190: 6564 2074 6f20 6765 6e65 7261 7465 2074  ed to generate t
-000201a0: 6865 2072 616e 646f 6d20 7361 6d70 6c65  he random sample
-000201b0: 732e 2020 5468 6520 6465 6661 756c 7420  s.  The default 
-000201c0: 6973 2027 6368 6f6c 6573 6b79 272e 0d0a  is 'cholesky'...
-000201d0: 2020 6b65 7920 3a20 5052 4e47 4b65 792c    key : PRNGKey,
-000201e0: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-000201f0: 2054 6865 206b 6579 2066 6f72 2074 6865   The key for the
-00020200: 2072 616e 646f 6d20 6e75 6d62 6572 2067   random number g
-00020210: 656e 6572 6174 6f72 2e20 4966 206e 6f74  enerator. If not
-00020220: 2067 6976 656e 2c20 7468 650d 0a20 2020   given, the..   
-00020230: 2020 2064 6566 6175 6c74 2072 616e 646f     default rando
-00020240: 6d20 6e75 6d62 6572 2067 656e 6572 6174  m number generat
-00020250: 6f72 2069 7320 7573 6564 2e0d 0a0d 0a20  or is used..... 
-00020260: 2052 6574 7572 6e73 0d0a 2020 2d2d 2d2d   Returns..  ----
-00020270: 2d2d 2d0d 0a20 206f 7574 203a 206e 6461  ---..  out : nda
-00020280: 7272 6179 0d0a 2020 2020 2020 5468 6520  rray..      The 
-00020290: 6472 6177 6e20 7361 6d70 6c65 732c 206f  drawn samples, o
-000202a0: 6620 7368 6170 6520 2a73 697a 652a 2c20  f shape *size*, 
-000202b0: 6966 2074 6861 7420 7761 7320 7072 6f76  if that was prov
-000202c0: 6964 6564 2e20 2049 6620 6e6f 742c 0d0a  ided.  If not,..
-000202d0: 2020 2020 2020 7468 6520 7368 6170 6520        the shape 
-000202e0: 6973 2060 6028 4e2c 2960 602e 0d0a 0d0a  is ``(N,)``.....
-000202f0: 2020 2020 2020 496e 206f 7468 6572 2077        In other w
-00020300: 6f72 6473 2c20 6561 6368 2065 6e74 7279  ords, each entry
-00020310: 2060 606f 7574 5b69 2c6a 2c2e 2e2e 2c3a   ``out[i,j,...,:
-00020320: 5d60 6020 6973 2061 6e20 4e2d 6469 6d65  ]`` is an N-dime
-00020330: 6e73 696f 6e61 6c0d 0a20 2020 2020 2076  nsional..      v
-00020340: 616c 7565 2064 7261 776e 2066 726f 6d20  alue drawn from 
-00020350: 7468 6520 6469 7374 7269 6275 7469 6f6e  the distribution
-00020360: 2e0d 0a0d 0a20 204e 6f74 6573 0d0a 2020  .....  Notes..  
-00020370: 2d2d 2d2d 2d0d 0a20 2054 6865 206d 6561  -----..  The mea
-00020380: 6e20 6973 2061 2063 6f6f 7264 696e 6174  n is a coordinat
-00020390: 6520 696e 204e 2d64 696d 656e 7369 6f6e  e in N-dimension
-000203a0: 616c 2073 7061 6365 2c20 7768 6963 6820  al space, which 
-000203b0: 7265 7072 6573 656e 7473 2074 6865 0d0a  represents the..
-000203c0: 2020 6c6f 6361 7469 6f6e 2077 6865 7265    location where
-000203d0: 2073 616d 706c 6573 2061 7265 206d 6f73   samples are mos
-000203e0: 7420 6c69 6b65 6c79 2074 6f20 6265 2067  t likely to be g
-000203f0: 656e 6572 6174 6564 2e20 2054 6869 7320  enerated.  This 
-00020400: 6973 0d0a 2020 616e 616c 6f67 6f75 7320  is..  analogous 
-00020410: 746f 2074 6865 2070 6561 6b20 6f66 2074  to the peak of t
-00020420: 6865 2062 656c 6c20 6375 7276 6520 666f  he bell curve fo
-00020430: 7220 7468 6520 6f6e 652d 6469 6d65 6e73  r the one-dimens
-00020440: 696f 6e61 6c20 6f72 0d0a 2020 756e 6976  ional or..  univ
-00020450: 6172 6961 7465 206e 6f72 6d61 6c20 6469  ariate normal di
-00020460: 7374 7269 6275 7469 6f6e 2e0d 0a0d 0a20  stribution..... 
-00020470: 2043 6f76 6172 6961 6e63 6520 696e 6469   Covariance indi
-00020480: 6361 7465 7320 7468 6520 6c65 7665 6c20  cates the level 
-00020490: 746f 2077 6869 6368 2074 776f 2076 6172  to which two var
-000204a0: 6961 626c 6573 2076 6172 7920 746f 6765  iables vary toge
-000204b0: 7468 6572 2e0d 0a20 2046 726f 6d20 7468  ther...  From th
-000204c0: 6520 6d75 6c74 6976 6172 6961 7465 206e  e multivariate n
-000204d0: 6f72 6d61 6c20 6469 7374 7269 6275 7469  ormal distributi
-000204e0: 6f6e 2c20 7765 2064 7261 7720 4e2d 6469  on, we draw N-di
-000204f0: 6d65 6e73 696f 6e61 6c0d 0a20 2073 616d  mensional..  sam
-00020500: 706c 6573 2c20 3a6d 6174 683a 6058 203d  ples, :math:`X =
-00020510: 205b 785f 312c 2078 5f32 2c20 2e2e 2e20   [x_1, x_2, ... 
-00020520: 785f 4e5d 602e 2020 5468 6520 636f 7661  x_N]`.  The cova
-00020530: 7269 616e 6365 206d 6174 7269 780d 0a20  riance matrix.. 
-00020540: 2065 6c65 6d65 6e74 203a 6d61 7468 3a60   element :math:`
-00020550: 435f 7b69 6a7d 6020 6973 2074 6865 2063  C_{ij}` is the c
-00020560: 6f76 6172 6961 6e63 6520 6f66 203a 6d61  ovariance of :ma
-00020570: 7468 3a60 785f 6960 2061 6e64 203a 6d61  th:`x_i` and :ma
-00020580: 7468 3a60 785f 6a60 2e0d 0a20 2054 6865  th:`x_j`...  The
-00020590: 2065 6c65 6d65 6e74 203a 6d61 7468 3a60   element :math:`
-000205a0: 435f 7b69 697d 6020 6973 2074 6865 2076  C_{ii}` is the v
-000205b0: 6172 6961 6e63 6520 6f66 203a 6d61 7468  ariance of :math
-000205c0: 3a60 785f 6960 2028 692e 652e 2069 7473  :`x_i` (i.e. its
-000205d0: 0d0a 2020 2273 7072 6561 6422 292e 0d0a  ..  "spread")...
-000205e0: 0d0a 2020 496e 7374 6561 6420 6f66 2073  ..  Instead of s
-000205f0: 7065 6369 6679 696e 6720 7468 6520 6675  pecifying the fu
-00020600: 6c6c 2063 6f76 6172 6961 6e63 6520 6d61  ll covariance ma
-00020610: 7472 6978 2c20 706f 7075 6c61 720d 0a20  trix, popular.. 
-00020620: 2061 7070 726f 7869 6d61 7469 6f6e 7320   approximations 
-00020630: 696e 636c 7564 653a 0d0a 0d0a 2020 2020  include:....    
-00020640: 2d20 5370 6865 7269 6361 6c20 636f 7661  - Spherical cova
-00020650: 7269 616e 6365 2028 6063 6f76 6020 6973  riance (`cov` is
-00020660: 2061 206d 756c 7469 706c 6520 6f66 2074   a multiple of t
-00020670: 6865 2069 6465 6e74 6974 7920 6d61 7472  he identity matr
-00020680: 6978 290d 0a20 2020 202d 2044 6961 676f  ix)..    - Diago
-00020690: 6e61 6c20 636f 7661 7269 616e 6365 2028  nal covariance (
-000206a0: 6063 6f76 6020 6861 7320 6e6f 6e2d 6e65  `cov` has non-ne
-000206b0: 6761 7469 7665 2065 6c65 6d65 6e74 732c  gative elements,
-000206c0: 2061 6e64 206f 6e6c 7920 6f6e 0d0a 2020   and only on..  
-000206d0: 2020 2020 7468 6520 6469 6167 6f6e 616c      the diagonal
-000206e0: 290d 0a0d 0a20 2054 6869 7320 6765 6f6d  )....  This geom
-000206f0: 6574 7269 6361 6c20 7072 6f70 6572 7479  etrical property
-00020700: 2063 616e 2062 6520 7365 656e 2069 6e20   can be seen in 
-00020710: 7477 6f20 6469 6d65 6e73 696f 6e73 2062  two dimensions b
-00020720: 7920 706c 6f74 7469 6e67 0d0a 2020 6765  y plotting..  ge
-00020730: 6e65 7261 7465 6420 6461 7461 2d70 6f69  nerated data-poi
-00020740: 6e74 733a 0d0a 0d0a 2020 3e3e 3e20 6d65  nts:....  >>> me
-00020750: 616e 203d 205b 302c 2030 5d0d 0a20 203e  an = [0, 0]..  >
-00020760: 3e3e 2063 6f76 203d 205b 5b31 2c20 305d  >> cov = [[1, 0]
-00020770: 2c20 5b30 2c20 3130 305d 5d20 2023 2064  , [0, 100]]  # d
-00020780: 6961 676f 6e61 6c20 636f 7661 7269 616e  iagonal covarian
-00020790: 6365 0d0a 0d0a 2020 4469 6167 6f6e 616c  ce....  Diagonal
-000207a0: 2063 6f76 6172 6961 6e63 6520 6d65 616e   covariance mean
-000207b0: 7320 7468 6174 2070 6f69 6e74 7320 6172  s that points ar
-000207c0: 6520 6f72 6965 6e74 6564 2061 6c6f 6e67  e oriented along
-000207d0: 2078 206f 7220 792d 6178 6973 3a0d 0a0d   x or y-axis:...
-000207e0: 0a20 203e 3e3e 2069 6d70 6f72 7420 6d61  .  >>> import ma
-000207f0: 7470 6c6f 746c 6962 2e70 7970 6c6f 7420  tplotlib.pyplot 
-00020800: 6173 2070 6c74 2020 2320 6e6f 7161 0d0a  as plt  # noqa..
-00020810: 2020 3e3e 3e20 782c 2079 203d 2062 632e    >>> x, y = bc.
-00020820: 7261 6e64 6f6d 2e6d 756c 7469 7661 7269  random.multivari
-00020830: 6174 655f 6e6f 726d 616c 286d 6561 6e2c  ate_normal(mean,
-00020840: 2063 6f76 2c20 3530 3030 292e 540d 0a20   cov, 5000).T.. 
-00020850: 203e 3e3e 2070 6c74 2e70 6c6f 7428 782c   >>> plt.plot(x,
-00020860: 2079 2c20 2778 2729 0d0a 2020 3e3e 3e20   y, 'x')..  >>> 
-00020870: 706c 742e 6178 6973 2827 6571 7561 6c27  plt.axis('equal'
-00020880: 290d 0a20 203e 3e3e 2070 6c74 2e73 686f  )..  >>> plt.sho
-00020890: 7728 290d 0a0d 0a20 204e 6f74 6520 7468  w()....  Note th
-000208a0: 6174 2074 6865 2063 6f76 6172 6961 6e63  at the covarianc
-000208b0: 6520 6d61 7472 6978 206d 7573 7420 6265  e matrix must be
-000208c0: 2070 6f73 6974 6976 6520 7365 6d69 6465   positive semide
-000208d0: 6669 6e69 7465 2028 612e 6b2e 612e 0d0a  finite (a.k.a...
-000208e0: 2020 6e6f 6e6e 6567 6174 6976 652d 6465    nonnegative-de
-000208f0: 6669 6e69 7465 292e 204f 7468 6572 7769  finite). Otherwi
-00020900: 7365 2c20 7468 6520 6265 6861 7669 6f72  se, the behavior
-00020910: 206f 6620 7468 6973 206d 6574 686f 6420   of this method 
-00020920: 6973 0d0a 2020 756e 6465 6669 6e65 6420  is..  undefined 
-00020930: 616e 6420 6261 636b 7761 7264 7320 636f  and backwards co
-00020940: 6d70 6174 6962 696c 6974 7920 6973 206e  mpatibility is n
-00020950: 6f74 2067 7561 7261 6e74 6565 642e 0d0a  ot guaranteed...
-00020960: 0d0a 2020 5265 6665 7265 6e63 6573 0d0a  ..  References..
-00020970: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00020980: 2e2e 205b 315d 2050 6170 6f75 6c69 732c  .. [1] Papoulis,
-00020990: 2041 2e2c 2022 5072 6f62 6162 696c 6974   A., "Probabilit
-000209a0: 792c 2052 616e 646f 6d20 5661 7269 6162  y, Random Variab
-000209b0: 6c65 732c 2061 6e64 2053 746f 6368 6173  les, and Stochas
-000209c0: 7469 630d 0a20 2020 2020 2020 2020 5072  tic..         Pr
-000209d0: 6f63 6573 7365 732c 2220 3372 6420 6564  ocesses," 3rd ed
-000209e0: 2e2c 204e 6577 2059 6f72 6b3a 204d 6347  ., New York: McG
-000209f0: 7261 772d 4869 6c6c 2c20 3139 3931 2e0d  raw-Hill, 1991..
-00020a00: 0a20 202e 2e20 5b32 5d20 4475 6461 2c20  .  .. [2] Duda, 
-00020a10: 522e 204f 2e2c 2048 6172 742c 2050 2e20  R. O., Hart, P. 
-00020a20: 452e 2c20 616e 6420 5374 6f72 6b2c 2044  E., and Stork, D
-00020a30: 2e20 472e 2c20 2250 6174 7465 726e 0d0a  . G., "Pattern..
-00020a40: 2020 2020 2020 2020 2043 6c61 7373 6966           Classif
-00020a50: 6963 6174 696f 6e2c 2220 326e 6420 6564  ication," 2nd ed
-00020a60: 2e2c 204e 6577 2059 6f72 6b3a 2057 696c  ., New York: Wil
-00020a70: 6579 2c20 3230 3031 2e0d 0a0d 0a20 2045  ey, 2001.....  E
-00020a80: 7861 6d70 6c65 730d 0a20 202d 2d2d 2d2d  xamples..  -----
-00020a90: 2d2d 2d0d 0a20 203e 3e3e 206d 6561 6e20  ---..  >>> mean 
-00020aa0: 3d20 2831 2c20 3229 0d0a 2020 3e3e 3e20  = (1, 2)..  >>> 
-00020ab0: 636f 7620 3d20 5b5b 312c 2030 5d2c 205b  cov = [[1, 0], [
-00020ac0: 302c 2031 5d5d 0d0a 2020 3e3e 3e20 7820  0, 1]]..  >>> x 
-00020ad0: 3d20 6263 2e72 616e 646f 6d2e 6d75 6c74  = bc.random.mult
-00020ae0: 6976 6172 6961 7465 5f6e 6f72 6d61 6c28  ivariate_normal(
-00020af0: 6d65 616e 2c20 636f 762c 2028 332c 2033  mean, cov, (3, 3
-00020b00: 2929 0d0a 2020 3e3e 3e20 782e 7368 6170  ))..  >>> x.shap
-00020b10: 650d 0a20 2028 332c 2033 2c20 3229 0d0a  e..  (3, 3, 2)..
-00020b20: 0d0a 2020 4865 7265 2077 6520 6765 6e65  ..  Here we gene
-00020b30: 7261 7465 2038 3030 2073 616d 706c 6573  rate 800 samples
-00020b40: 2066 726f 6d20 7468 6520 6269 7661 7269   from the bivari
-00020b50: 6174 6520 6e6f 726d 616c 2064 6973 7472  ate normal distr
-00020b60: 6962 7574 696f 6e0d 0a20 2077 6974 6820  ibution..  with 
-00020b70: 6d65 616e 205b 302c 2030 5d20 616e 6420  mean [0, 0] and 
-00020b80: 636f 7661 7269 616e 6365 206d 6174 7269  covariance matri
-00020b90: 7820 5b5b 362c 202d 335d 2c20 5b2d 332c  x [[6, -3], [-3,
-00020ba0: 2033 2e35 5d5d 2e20 2054 6865 0d0a 2020   3.5]].  The..  
-00020bb0: 6578 7065 6374 6564 2076 6172 6961 6e63  expected varianc
-00020bc0: 6573 206f 6620 7468 6520 6669 7273 7420  es of the first 
-00020bd0: 616e 6420 7365 636f 6e64 2063 6f6d 706f  and second compo
-00020be0: 6e65 6e74 7320 6f66 2074 6865 2073 616d  nents of the sam
-00020bf0: 706c 650d 0a20 2061 7265 2036 2061 6e64  ple..  are 6 and
-00020c00: 2033 2e35 2c20 7265 7370 6563 7469 7665   3.5, respective
-00020c10: 6c79 2c20 616e 6420 7468 6520 6578 7065  ly, and the expe
-00020c20: 6374 6564 2063 6f72 7265 6c61 7469 6f6e  cted correlation
-00020c30: 0d0a 2020 636f 6566 6669 6369 656e 7420  ..  coefficient 
-00020c40: 6973 202d 332f 7371 7274 2836 2a33 2e35  is -3/sqrt(6*3.5
-00020c50: 2920 e289 8820 2d30 2e36 3534 3635 2e0d  ) ... -0.65465..
-00020c60: 0a0d 0a20 203e 3e3e 2063 6f76 203d 206e  ...  >>> cov = n
-00020c70: 702e 6172 7261 7928 5b5b 362c 202d 335d  p.array([[6, -3]
-00020c80: 2c20 5b2d 332c 2033 2e35 5d5d 290d 0a20  , [-3, 3.5]]).. 
-00020c90: 203e 3e3e 2070 7473 203d 2062 632e 7261   >>> pts = bc.ra
-00020ca0: 6e64 6f6d 2e6d 756c 7469 7661 7269 6174  ndom.multivariat
-00020cb0: 655f 6e6f 726d 616c 285b 302c 2030 5d2c  e_normal([0, 0],
-00020cc0: 2063 6f76 2c20 7369 7a65 3d38 3030 290d   cov, size=800).
-00020cd0: 0a0d 0a20 2043 6865 636b 2074 6861 7420  ...  Check that 
-00020ce0: 7468 6520 6d65 616e 2c20 636f 7661 7269  the mean, covari
-00020cf0: 616e 6365 2c20 616e 6420 636f 7272 656c  ance, and correl
-00020d00: 6174 696f 6e20 636f 6566 6669 6369 656e  ation coefficien
-00020d10: 7420 6f66 2074 6865 0d0a 2020 7361 6d70  t of the..  samp
-00020d20: 6c65 2061 7265 2063 6c6f 7365 2074 6f20  le are close to 
-00020d30: 7468 6520 6578 7065 6374 6564 2076 616c  the expected val
-00020d40: 7565 733a 0d0a 0d0a 2020 3e3e 3e20 7074  ues:....  >>> pt
-00020d50: 732e 6d65 616e 2861 7869 733d 3029 0d0a  s.mean(axis=0)..
-00020d60: 2020 6172 7261 7928 5b20 302e 3033 3236    array([ 0.0326
-00020d70: 3931 3120 2c20 2d30 2e30 3132 3830 3738  911 , -0.0128078
-00020d80: 325d 2920 2023 206d 6179 2076 6172 790d  2])  # may vary.
-00020d90: 0a20 203e 3e3e 206e 702e 636f 7628 7074  .  >>> np.cov(pt
-00020da0: 732e 5429 0d0a 2020 6172 7261 7928 5b5b  s.T)..  array([[
-00020db0: 2035 2e39 3632 3032 3339 372c 202d 322e   5.96202397, -2.
-00020dc0: 3835 3630 3232 3837 5d2c 0d0a 2020 2020  85602287],..    
-00020dd0: 2020 2020 205b 2d32 2e38 3536 3032 3238       [-2.8560228
-00020de0: 372c 2020 332e 3437 3631 3339 3439 5d5d  7,  3.47613949]]
-00020df0: 2920 2023 206d 6179 2076 6172 790d 0a20  )  # may vary.. 
-00020e00: 203e 3e3e 206e 702e 636f 7272 636f 6566   >>> np.corrcoef
-00020e10: 2870 7473 2e54 295b 302c 2031 5d0d 0a20  (pts.T)[0, 1].. 
-00020e20: 202d 302e 3632 3733 3539 3133 3134 3630   -0.627359131460
-00020e30: 3339 3439 2020 2320 6d61 7920 7661 7279  3949  # may vary
-00020e40: 0d0a 0d0a 2020 5765 2063 616e 2076 6973  ....  We can vis
-00020e50: 7561 6c69 7a65 2074 6869 7320 6461 7461  ualize this data
-00020e60: 2077 6974 6820 6120 7363 6174 7465 7220   with a scatter 
-00020e70: 706c 6f74 2e20 2054 6865 206f 7269 656e  plot.  The orien
-00020e80: 7461 7469 6f6e 0d0a 2020 6f66 2074 6865  tation..  of the
-00020e90: 2070 6f69 6e74 2063 6c6f 7564 2069 6c6c   point cloud ill
-00020ea0: 7573 7472 6174 6573 2074 6865 206e 6567  ustrates the neg
-00020eb0: 6174 6976 6520 636f 7272 656c 6174 696f  ative correlatio
-00020ec0: 6e20 6f66 2074 6865 0d0a 2020 636f 6d70  n of the..  comp
-00020ed0: 6f6e 656e 7473 206f 6620 7468 6973 2073  onents of this s
-00020ee0: 616d 706c 652e 0d0a 0d0a 2020 3e3e 3e20  ample.....  >>> 
-00020ef0: 696d 706f 7274 206d 6174 706c 6f74 6c69  import matplotli
-00020f00: 622e 7079 706c 6f74 2061 7320 706c 7420  b.pyplot as plt 
-00020f10: 2023 206e 6f71 610d 0a20 203e 3e3e 2070   # noqa..  >>> p
-00020f20: 6c74 2e70 6c6f 7428 7074 735b 3a2c 2030  lt.plot(pts[:, 0
-00020f30: 5d2c 2070 7473 5b3a 2c20 315d 2c20 272e  ], pts[:, 1], '.
-00020f40: 272c 2061 6c70 6861 3d30 2e35 290d 0a20  ', alpha=0.5).. 
-00020f50: 203e 3e3e 2070 6c74 2e61 7869 7328 2765   >>> plt.axis('e
-00020f60: 7175 616c 2729 0d0a 2020 3e3e 3e20 706c  qual')..  >>> pl
-00020f70: 742e 6772 6964 2829 0d0a 2020 3e3e 3e20  t.grid()..  >>> 
-00020f80: 706c 742e 7368 6f77 2829 0d0a 2020 2222  plt.show()..  ""
-00020f90: 220d 0a20 2072 6574 7572 6e20 4445 4641  "..  return DEFA
-00020fa0: 554c 542e 6d75 6c74 6976 6172 6961 7465  ULT.multivariate
-00020fb0: 5f6e 6f72 6d61 6c28 6d65 616e 2c20 636f  _normal(mean, co
-00020fc0: 762c 2073 697a 652c 206d 6574 686f 642c  v, size, method,
-00020fd0: 206b 6579 3d6b 6579 2c20 6474 7970 653d   key=key, dtype=
-00020fe0: 6474 7970 6529 0d0a 0d0a 0d0a 6465 6620  dtype)......def 
-00020ff0: 6e65 6761 7469 7665 5f62 696e 6f6d 6961  negative_binomia
-00021000: 6c28 6e2c 2070 2c20 7369 7a65 3a20 4f70  l(n, p, size: Op
-00021010: 7469 6f6e 616c 5b53 697a 655d 203d 204e  tional[Size] = N
-00021020: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
-00021030: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
-00021040: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
-00021050: 4b65 795d 203d 204e 6f6e 652c 2064 7479  Key] = None, dty
-00021060: 7065 3a20 4454 7970 654c 696b 6520 3d20  pe: DTypeLike = 
-00021070: 4e6f 6e65 293a 0d0a 2020 7222 2222 0d0a  None):..  r"""..
-00021080: 2020 4472 6177 2073 616d 706c 6573 2066    Draw samples f
-00021090: 726f 6d20 6120 6e65 6761 7469 7665 2062  rom a negative b
-000210a0: 696e 6f6d 6961 6c20 6469 7374 7269 6275  inomial distribu
-000210b0: 7469 6f6e 2e0d 0a0d 0a20 2053 616d 706c  tion.....  Sampl
-000210c0: 6573 2061 7265 2064 7261 776e 2066 726f  es are drawn fro
-000210d0: 6d20 6120 6e65 6761 7469 7665 2062 696e  m a negative bin
-000210e0: 6f6d 6961 6c20 6469 7374 7269 6275 7469  omial distributi
-000210f0: 6f6e 2077 6974 6820 7370 6563 6966 6965  on with specifie
-00021100: 640d 0a20 2070 6172 616d 6574 6572 732c  d..  parameters,
-00021110: 2060 6e60 2073 7563 6365 7373 6573 2061   `n` successes a
-00021120: 6e64 2060 7060 2070 726f 6261 6269 6c69  nd `p` probabili
-00021130: 7479 206f 6620 7375 6363 6573 7320 7768  ty of success wh
-00021140: 6572 6520 606e 600d 0a20 2069 7320 3e20  ere `n`..  is > 
-00021150: 3020 616e 6420 6070 6020 6973 2069 6e20  0 and `p` is in 
-00021160: 7468 6520 696e 7465 7276 616c 205b 302c  the interval [0,
-00021170: 2031 5d2e 0d0a 0d0a 2020 5061 7261 6d65   1].....  Parame
-00021180: 7465 7273 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ters..  --------
-00021190: 2d2d 0d0a 2020 6e20 3a20 666c 6f61 7420  --..  n : float 
-000211a0: 6f72 2061 7272 6179 5f6c 696b 6520 6f66  or array_like of
-000211b0: 2066 6c6f 6174 730d 0a20 2020 2020 2050   floats..      P
-000211c0: 6172 616d 6574 6572 206f 6620 7468 6520  arameter of the 
-000211d0: 6469 7374 7269 6275 7469 6f6e 2c20 3e20  distribution, > 
-000211e0: 302e 0d0a 2020 7020 3a20 666c 6f61 7420  0...  p : float 
-000211f0: 6f72 2061 7272 6179 5f6c 696b 6520 6f66  or array_like of
-00021200: 2066 6c6f 6174 730d 0a20 2020 2020 2050   floats..      P
-00021210: 6172 616d 6574 6572 206f 6620 7468 6520  arameter of the 
-00021220: 6469 7374 7269 6275 7469 6f6e 2c20 3e3d  distribution, >=
-00021230: 2030 2061 6e64 203c 3d31 2e0d 0a20 2073   0 and <=1...  s
-00021240: 697a 6520 3a20 696e 7420 6f72 2074 7570  ize : int or tup
-00021250: 6c65 206f 6620 696e 7473 2c20 6f70 7469  le of ints, opti
-00021260: 6f6e 616c 0d0a 2020 2020 2020 4f75 7470  onal..      Outp
-00021270: 7574 2073 6861 7065 2e20 2049 6620 7468  ut shape.  If th
-00021280: 6520 6769 7665 6e20 7368 6170 6520 6973  e given shape is
-00021290: 2c20 652e 672e 2c20 6060 286d 2c20 6e2c  , e.g., ``(m, n,
-000212a0: 206b 2960 602c 2074 6865 6e0d 0a20 2020   k)``, then..   
-000212b0: 2020 2060 606d 202a 206e 202a 206b 6060     ``m * n * k``
-000212c0: 2073 616d 706c 6573 2061 7265 2064 7261   samples are dra
-000212d0: 776e 2e20 2049 6620 7369 7a65 2069 7320  wn.  If size is 
-000212e0: 6060 4e6f 6e65 6060 2028 6465 6661 756c  ``None`` (defaul
-000212f0: 7429 2c0d 0a20 2020 2020 2061 2073 696e  t),..      a sin
-00021300: 676c 6520 7661 6c75 6520 6973 2072 6574  gle value is ret
-00021310: 7572 6e65 6420 6966 2060 606e 6060 2061  urned if ``n`` a
-00021320: 6e64 2060 6070 6060 2061 7265 2062 6f74  nd ``p`` are bot
-00021330: 6820 7363 616c 6172 732e 0d0a 2020 2020  h scalars...    
-00021340: 2020 4f74 6865 7277 6973 652c 2060 606e    Otherwise, ``n
-00021350: 702e 6272 6f61 6463 6173 7428 6e2c 2070  p.broadcast(n, p
-00021360: 292e 7369 7a65 6060 2073 616d 706c 6573  ).size`` samples
-00021370: 2061 7265 2064 7261 776e 2e0d 0a20 206b   are drawn...  k
-00021380: 6579 203a 2050 524e 474b 6579 2c20 6f70  ey : PRNGKey, op
-00021390: 7469 6f6e 616c 0d0a 2020 2020 2020 5468  tional..      Th
-000213a0: 6520 6b65 7920 666f 7220 7468 6520 7261  e key for the ra
-000213b0: 6e64 6f6d 206e 756d 6265 7220 6765 6e65  ndom number gene
-000213c0: 7261 746f 722e 2049 6620 6e6f 7420 6769  rator. If not gi
-000213d0: 7665 6e2c 2074 6865 0d0a 2020 2020 2020  ven, the..      
-000213e0: 6465 6661 756c 7420 7261 6e64 6f6d 206e  default random n
-000213f0: 756d 6265 7220 6765 6e65 7261 746f 7220  umber generator 
-00021400: 6973 2075 7365 642e 0d0a 0d0a 2020 5265  is used.....  Re
-00021410: 7475 726e 730d 0a20 202d 2d2d 2d2d 2d2d  turns..  -------
-00021420: 0d0a 2020 6f75 7420 3a20 6e64 6172 7261  ..  out : ndarra
-00021430: 7920 6f72 2073 6361 6c61 720d 0a20 2020  y or scalar..   
-00021440: 2020 2044 7261 776e 2073 616d 706c 6573     Drawn samples
-00021450: 2066 726f 6d20 7468 6520 7061 7261 6d65   from the parame
-00021460: 7465 7269 7a65 6420 6e65 6761 7469 7665  terized negative
-00021470: 2062 696e 6f6d 6961 6c20 6469 7374 7269   binomial distri
-00021480: 6275 7469 6f6e 2c0d 0a20 2020 2020 2077  bution,..      w
-00021490: 6865 7265 2065 6163 6820 7361 6d70 6c65  here each sample
-000214a0: 2069 7320 6571 7561 6c20 746f 204e 2c20   is equal to N, 
-000214b0: 7468 6520 6e75 6d62 6572 206f 6620 6661  the number of fa
-000214c0: 696c 7572 6573 2074 6861 740d 0a20 2020  ilures that..   
-000214d0: 2020 206f 6363 7572 7265 6420 6265 666f     occurred befo
-000214e0: 7265 2061 2074 6f74 616c 206f 6620 6e20  re a total of n 
-000214f0: 7375 6363 6573 7365 7320 7761 7320 7265  successes was re
-00021500: 6163 6865 642e 0d0a 0d0a 2020 4e6f 7465  ached.....  Note
-00021510: 730d 0a20 202d 2d2d 2d2d 0d0a 2020 5468  s..  -----..  Th
-00021520: 6520 7072 6f62 6162 696c 6974 7920 6d61  e probability ma
-00021530: 7373 2066 756e 6374 696f 6e20 6f66 2074  ss function of t
-00021540: 6865 206e 6567 6174 6976 6520 6269 6e6f  he negative bino
-00021550: 6d69 616c 2064 6973 7472 6962 7574 696f  mial distributio
-00021560: 6e20 6973 0d0a 0d0a 2020 2e2e 206d 6174  n is....  .. mat
-00021570: 683a 3a20 5028 4e3b 6e2c 7029 203d 205c  h:: P(N;n,p) = \
-00021580: 6672 6163 7b5c 4761 6d6d 6128 4e2b 6e29  frac{\Gamma(N+n)
-00021590: 7d7b 4e21 5c47 616d 6d61 286e 297d 705e  }{N!\Gamma(n)}p^
-000215a0: 7b6e 7d28 312d 7029 5e7b 4e7d 2c0d 0a0d  {n}(1-p)^{N},...
-000215b0: 0a20 2077 6865 7265 203a 6d61 7468 3a60  .  where :math:`
-000215c0: 6e60 2069 7320 7468 6520 6e75 6d62 6572  n` is the number
-000215d0: 206f 6620 7375 6363 6573 7365 732c 203a   of successes, :
-000215e0: 6d61 7468 3a60 7060 2069 7320 7468 650d  math:`p` is the.
-000215f0: 0a20 2070 726f 6261 6269 6c69 7479 206f  .  probability o
-00021600: 6620 7375 6363 6573 732c 203a 6d61 7468  f success, :math
-00021610: 3a60 4e2b 6e60 2069 7320 7468 6520 6e75  :`N+n` is the nu
-00021620: 6d62 6572 206f 6620 7472 6961 6c73 2c20  mber of trials, 
-00021630: 616e 640d 0a20 203a 6d61 7468 3a60 5c47  and..  :math:`\G
-00021640: 616d 6d61 6020 6973 2074 6865 2067 616d  amma` is the gam
-00021650: 6d61 2066 756e 6374 696f 6e2e 2057 6865  ma function. Whe
-00021660: 6e20 3a6d 6174 683a 606e 6020 6973 2061  n :math:`n` is a
-00021670: 6e20 696e 7465 6765 722c 0d0a 2020 3a6d  n integer,..  :m
-00021680: 6174 683a 605c 6672 6163 7b5c 4761 6d6d  ath:`\frac{\Gamm
-00021690: 6128 4e2b 6e29 7d7b 4e21 5c47 616d 6d61  a(N+n)}{N!\Gamma
-000216a0: 286e 297d 203d 205c 6269 6e6f 6d7b 4e2b  (n)} = \binom{N+
-000216b0: 6e2d 317d 7b4e 7d60 2c20 7768 6963 6820  n-1}{N}`, which 
-000216c0: 6973 0d0a 2020 7468 6520 6d6f 7265 2063  is..  the more c
-000216d0: 6f6d 6d6f 6e20 666f 726d 206f 6620 7468  ommon form of th
-000216e0: 6973 2074 6572 6d20 696e 2074 6865 2070  is term in the p
-000216f0: 6d66 2e20 5468 6520 6e65 6761 7469 7665  mf. The negative
-00021700: 0d0a 2020 6269 6e6f 6d69 616c 2064 6973  ..  binomial dis
-00021710: 7472 6962 7574 696f 6e20 6769 7665 7320  tribution gives 
-00021720: 7468 6520 7072 6f62 6162 696c 6974 7920  the probability 
-00021730: 6f66 204e 2066 6169 6c75 7265 7320 6769  of N failures gi
-00021740: 7665 6e20 6e0d 0a20 2073 7563 6365 7373  ven n..  success
-00021750: 6573 2c20 7769 7468 2061 2073 7563 6365  es, with a succe
-00021760: 7373 206f 6e20 7468 6520 6c61 7374 2074  ss on the last t
-00021770: 7269 616c 2e0d 0a0d 0a20 2049 6620 6f6e  rial.....  If on
-00021780: 6520 7468 726f 7773 2061 2064 6965 2072  e throws a die r
-00021790: 6570 6561 7465 646c 7920 756e 7469 6c20  epeatedly until 
-000217a0: 7468 6520 7468 6972 6420 7469 6d65 2061  the third time a
-000217b0: 2022 3122 2061 7070 6561 7273 2c0d 0a20   "1" appears,.. 
-000217c0: 2074 6865 6e20 7468 6520 7072 6f62 6162   then the probab
-000217d0: 696c 6974 7920 6469 7374 7269 6275 7469  ility distributi
-000217e0: 6f6e 206f 6620 7468 6520 6e75 6d62 6572  on of the number
-000217f0: 206f 6620 6e6f 6e2d 2231 2273 2074 6861   of non-"1"s tha
-00021800: 740d 0a20 2061 7070 6561 7220 6265 666f  t..  appear befo
-00021810: 7265 2074 6865 2074 6869 7264 2022 3122  re the third "1"
-00021820: 2069 7320 6120 6e65 6761 7469 7665 2062   is a negative b
-00021830: 696e 6f6d 6961 6c20 6469 7374 7269 6275  inomial distribu
-00021840: 7469 6f6e 2e0d 0a0d 0a20 2052 6566 6572  tion.....  Refer
-00021850: 656e 6365 730d 0a20 202d 2d2d 2d2d 2d2d  ences..  -------
-00021860: 2d2d 2d0d 0a20 202e 2e20 5b31 5d20 5765  ---..  .. [1] We
-00021870: 6973 7374 6569 6e2c 2045 7269 6320 572e  isstein, Eric W.
-00021880: 2022 4e65 6761 7469 7665 2042 696e 6f6d   "Negative Binom
-00021890: 6961 6c20 4469 7374 7269 6275 7469 6f6e  ial Distribution
-000218a0: 2e22 2046 726f 6d0d 0a20 2020 2020 2020  ." From..       
-000218b0: 2020 4d61 7468 576f 726c 642d 2d41 2057    MathWorld--A W
-000218c0: 6f6c 6672 616d 2057 6562 2052 6573 6f75  olfram Web Resou
-000218d0: 7263 652e 0d0a 2020 2020 2020 2020 2068  rce...         h
-000218e0: 7474 703a 2f2f 6d61 7468 776f 726c 642e  ttp://mathworld.
-000218f0: 776f 6c66 7261 6d2e 636f 6d2f 4e65 6761  wolfram.com/Nega
-00021900: 7469 7665 4269 6e6f 6d69 616c 4469 7374  tiveBinomialDist
-00021910: 7269 6275 7469 6f6e 2e68 746d 6c0d 0a20  ribution.html.. 
-00021920: 202e 2e20 5b32 5d20 5769 6b69 7065 6469   .. [2] Wikipedi
-00021930: 612c 2022 4e65 6761 7469 7665 2062 696e  a, "Negative bin
-00021940: 6f6d 6961 6c20 6469 7374 7269 6275 7469  omial distributi
-00021950: 6f6e 222c 0d0a 2020 2020 2020 2020 2068  on",..         h
-00021960: 7474 7073 3a2f 2f65 6e2e 7769 6b69 7065  ttps://en.wikipe
-00021970: 6469 612e 6f72 672f 7769 6b69 2f4e 6567  dia.org/wiki/Neg
-00021980: 6174 6976 655f 6269 6e6f 6d69 616c 5f64  ative_binomial_d
-00021990: 6973 7472 6962 7574 696f 6e0d 0a0d 0a20  istribution.... 
-000219a0: 2045 7861 6d70 6c65 730d 0a20 202d 2d2d   Examples..  ---
-000219b0: 2d2d 2d2d 2d0d 0a20 2044 7261 7720 7361  -----..  Draw sa
-000219c0: 6d70 6c65 7320 6672 6f6d 2074 6865 2064  mples from the d
-000219d0: 6973 7472 6962 7574 696f 6e3a 0d0a 0d0a  istribution:....
-000219e0: 2020 4120 7265 616c 2077 6f72 6c64 2065    A real world e
-000219f0: 7861 6d70 6c65 2e20 4120 636f 6d70 616e  xample. A compan
-00021a00: 7920 6472 696c 6c73 2077 696c 642d 6361  y drills wild-ca
-00021a10: 7420 6f69 6c0d 0a20 2065 7870 6c6f 7261  t oil..  explora
-00021a20: 7469 6f6e 2077 656c 6c73 2c20 6561 6368  tion wells, each
-00021a30: 2077 6974 6820 616e 2065 7374 696d 6174   with an estimat
-00021a40: 6564 2070 726f 6261 6269 6c69 7479 206f  ed probability o
-00021a50: 660d 0a20 2073 7563 6365 7373 206f 6620  f..  success of 
-00021a60: 302e 312e 2020 5768 6174 2069 7320 7468  0.1.  What is th
-00021a70: 6520 7072 6f62 6162 696c 6974 7920 6f66  e probability of
-00021a80: 2068 6176 696e 6720 6f6e 6520 7375 6363   having one succ
-00021a90: 6573 730d 0a20 2066 6f72 2065 6163 6820  ess..  for each 
-00021aa0: 7375 6363 6573 7369 7665 2077 656c 6c2c  successive well,
-00021ab0: 2074 6861 7420 6973 2077 6861 7420 6973   that is what is
-00021ac0: 2074 6865 2070 726f 6261 6269 6c69 7479   the probability
-00021ad0: 206f 6620 610d 0a20 2073 696e 676c 6520   of a..  single 
-00021ae0: 7375 6363 6573 7320 6166 7465 7220 6472  success after dr
-00021af0: 696c 6c69 6e67 2035 2077 656c 6c73 2c20  illing 5 wells, 
-00021b00: 6166 7465 7220 3620 7765 6c6c 732c 2065  after 6 wells, e
-00021b10: 7463 2e3f 0d0a 0d0a 2020 3e3e 3e20 7320  tc.?....  >>> s 
-00021b20: 3d20 6263 2e72 616e 646f 6d2e 6e65 6761  = bc.random.nega
-00021b30: 7469 7665 5f62 696e 6f6d 6961 6c28 312c  tive_binomial(1,
-00021b40: 2030 2e31 2c20 3130 3030 3030 290d 0a20   0.1, 100000).. 
-00021b50: 203e 3e3e 2066 6f72 2069 2069 6e20 7261   >>> for i in ra
-00021b60: 6e67 6528 312c 2031 3129 3a20 2320 646f  nge(1, 11): # do
-00021b70: 6374 6573 743a 202b 534b 4950 0d0a 2020  ctest: +SKIP..  
-00021b80: 2e2e 2e20 2020 2070 726f 6261 6269 6c69  ...    probabili
-00021b90: 7479 203d 2073 756d 2873 3c69 2920 2f20  ty = sum(s<i) / 
-00021ba0: 3130 3030 3030 2e0d 0a20 202e 2e2e 2020  100000...  ...  
-00021bb0: 2020 7072 696e 7428 692c 2022 7765 6c6c    print(i, "well
-00021bc0: 7320 6472 696c 6c65 642c 2070 726f 6261  s drilled, proba
-00021bd0: 6269 6c69 7479 206f 6620 6f6e 6520 7375  bility of one su
-00021be0: 6363 6573 7320 3d22 2c20 7072 6f62 6162  ccess =", probab
-00021bf0: 696c 6974 7929 0d0a 2020 2222 220d 0a20  ility)..  """.. 
-00021c00: 2072 6574 7572 6e20 4445 4641 554c 542e   return DEFAULT.
-00021c10: 6e65 6761 7469 7665 5f62 696e 6f6d 6961  negative_binomia
-00021c20: 6c28 6e2c 2070 2c20 7369 7a65 2c20 6b65  l(n, p, size, ke
-00021c30: 793d 6b65 792c 2064 7479 7065 3d64 7479  y=key, dtype=dty
-00021c40: 7065 290d 0a0d 0a0d 0a64 6566 206e 6f6e  pe)......def non
-00021c50: 6365 6e74 7261 6c5f 6368 6973 7175 6172  central_chisquar
-00021c60: 6528 6466 2c20 6e6f 6e63 2c20 7369 7a65  e(df, nonc, size
-00021c70: 3a20 4f70 7469 6f6e 616c 5b53 697a 655d  : Optional[Size]
-00021c80: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
-00021c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ca0: 2020 206b 6579 3a20 4f70 7469 6f6e 616c     key: Optional
-00021cb0: 5b53 6565 644f 724b 6579 5d20 3d20 4e6f  [SeedOrKey] = No
-00021cc0: 6e65 2c20 6474 7970 653a 2044 5479 7065  ne, dtype: DType
-00021cd0: 4c69 6b65 203d 204e 6f6e 6529 3a0d 0a20  Like = None):.. 
-00021ce0: 2072 2222 220d 0a20 2044 7261 7720 7361   r"""..  Draw sa
-00021cf0: 6d70 6c65 7320 6672 6f6d 2061 206e 6f6e  mples from a non
-00021d00: 6365 6e74 7261 6c20 6368 692d 7371 7561  central chi-squa
-00021d10: 7265 2064 6973 7472 6962 7574 696f 6e2e  re distribution.
-00021d20: 0d0a 0d0a 2020 5468 6520 6e6f 6e63 656e  ....  The noncen
-00021d30: 7472 616c 203a 6d61 7468 3a60 5c63 6869  tral :math:`\chi
-00021d40: 5e32 6020 6469 7374 7269 6275 7469 6f6e  ^2` distribution
-00021d50: 2069 7320 6120 6765 6e65 7261 6c69 7a61   is a generaliza
-00021d60: 7469 6f6e 206f 660d 0a20 2074 6865 203a  tion of..  the :
-00021d70: 6d61 7468 3a60 5c63 6869 5e32 6020 6469  math:`\chi^2` di
-00021d80: 7374 7269 6275 7469 6f6e 2e0d 0a0d 0a20  stribution..... 
-00021d90: 2050 6172 616d 6574 6572 730d 0a20 202d   Parameters..  -
-00021da0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2064 6620  ---------..  df 
-00021db0: 3a20 666c 6f61 7420 6f72 2061 7272 6179  : float or array
-00021dc0: 5f6c 696b 6520 6f66 2066 6c6f 6174 730d  _like of floats.
-00021dd0: 0a20 2020 2020 2044 6567 7265 6573 206f  .      Degrees o
-00021de0: 6620 6672 6565 646f 6d2c 206d 7573 7420  f freedom, must 
-00021df0: 6265 203e 2030 2e0d 0a20 206e 6f6e 6320  be > 0...  nonc 
-00021e00: 3a20 666c 6f61 7420 6f72 2061 7272 6179  : float or array
-00021e10: 5f6c 696b 6520 6f66 2066 6c6f 6174 730d  _like of floats.
-00021e20: 0a20 2020 2020 204e 6f6e 2d63 656e 7472  .      Non-centr
-00021e30: 616c 6974 792c 206d 7573 7420 6265 206e  ality, must be n
-00021e40: 6f6e 2d6e 6567 6174 6976 652e 0d0a 2020  on-negative...  
-00021e50: 7369 7a65 203a 2069 6e74 206f 7220 7475  size : int or tu
-00021e60: 706c 6520 6f66 2069 6e74 732c 206f 7074  ple of ints, opt
-00021e70: 696f 6e61 6c0d 0a20 2020 2020 204f 7574  ional..      Out
-00021e80: 7075 7420 7368 6170 652e 2020 4966 2074  put shape.  If t
-00021e90: 6865 2067 6976 656e 2073 6861 7065 2069  he given shape i
-00021ea0: 732c 2065 2e67 2e2c 2060 6028 6d2c 206e  s, e.g., ``(m, n
-00021eb0: 2c20 6b29 6060 2c20 7468 656e 0d0a 2020  , k)``, then..  
-00021ec0: 2020 2020 6060 6d20 2a20 6e20 2a20 6b60      ``m * n * k`
-00021ed0: 6020 7361 6d70 6c65 7320 6172 6520 6472  ` samples are dr
-00021ee0: 6177 6e2e 2020 4966 2073 697a 6520 6973  awn.  If size is
-00021ef0: 2060 604e 6f6e 6560 6020 2864 6566 6175   ``None`` (defau
-00021f00: 6c74 292c 0d0a 2020 2020 2020 6120 7369  lt),..      a si
-00021f10: 6e67 6c65 2076 616c 7565 2069 7320 7265  ngle value is re
-00021f20: 7475 726e 6564 2069 6620 6060 6466 6060  turned if ``df``
-00021f30: 2061 6e64 2060 606e 6f6e 6360 6020 6172   and ``nonc`` ar
-00021f40: 6520 626f 7468 2073 6361 6c61 7273 2e0d  e both scalars..
-00021f50: 0a20 2020 2020 204f 7468 6572 7769 7365  .      Otherwise
-00021f60: 2c20 6060 6e70 2e62 726f 6164 6361 7374  , ``np.broadcast
-00021f70: 2864 662c 206e 6f6e 6329 2e73 697a 6560  (df, nonc).size`
-00021f80: 6020 7361 6d70 6c65 7320 6172 6520 6472  ` samples are dr
-00021f90: 6177 6e2e 0d0a 2020 6b65 7920 3a20 5052  awn...  key : PR
-00021fa0: 4e47 4b65 792c 206f 7074 696f 6e61 6c0d  NGKey, optional.
-00021fb0: 0a20 2020 2020 2054 6865 206b 6579 2066  .      The key f
-00021fc0: 6f72 2074 6865 2072 616e 646f 6d20 6e75  or the random nu
-00021fd0: 6d62 6572 2067 656e 6572 6174 6f72 2e20  mber generator. 
-00021fe0: 4966 206e 6f74 2067 6976 656e 2c20 7468  If not given, th
-00021ff0: 650d 0a20 2020 2020 2064 6566 6175 6c74  e..      default
-00022000: 2072 616e 646f 6d20 6e75 6d62 6572 2067   random number g
-00022010: 656e 6572 6174 6f72 2069 7320 7573 6564  enerator is used
-00022020: 2e0d 0a0d 0a20 2052 6574 7572 6e73 0d0a  .....  Returns..
-00022030: 2020 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574    -------..  out
-00022040: 203a 206e 6461 7272 6179 206f 7220 7363   : ndarray or sc
-00022050: 616c 6172 0d0a 2020 2020 2020 4472 6177  alar..      Draw
-00022060: 6e20 7361 6d70 6c65 7320 6672 6f6d 2074  n samples from t
-00022070: 6865 2070 6172 616d 6574 6572 697a 6564  he parameterized
-00022080: 206e 6f6e 6365 6e74 7261 6c20 6368 692d   noncentral chi-
-00022090: 7371 7561 7265 2064 6973 7472 6962 7574  square distribut
-000220a0: 696f 6e2e 0d0a 0d0a 2020 4e6f 7465 730d  ion.....  Notes.
-000220b0: 0a20 202d 2d2d 2d2d 0d0a 2020 5468 6520  .  -----..  The 
-000220c0: 7072 6f62 6162 696c 6974 7920 6465 6e73  probability dens
-000220d0: 6974 7920 6675 6e63 7469 6f6e 2066 6f72  ity function for
-000220e0: 2074 6865 206e 6f6e 6365 6e74 7261 6c20   the noncentral 
-000220f0: 4368 692d 7371 7561 7265 0d0a 2020 6469  Chi-square..  di
-00022100: 7374 7269 6275 7469 6f6e 2069 730d 0a0d  stribution is...
-00022110: 0a20 202e 2e20 6d61 7468 3a3a 2050 2878  .  .. math:: P(x
-00022120: 3b64 662c 6e6f 6e63 2920 3d20 5c73 756d  ;df,nonc) = \sum
-00022130: 5e7b 5c69 6e66 7479 7d5f 7b69 3d30 7d0d  ^{\infty}_{i=0}.
-00022140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022150: 2020 2020 2020 2020 2020 5c66 7261 637b            \frac{
-00022160: 655e 7b2d 6e6f 6e63 2f32 7d28 6e6f 6e63  e^{-nonc/2}(nonc
-00022170: 2f32 295e 7b69 7d7d 7b69 217d 0d0a 2020  /2)^{i}}{i!}..  
-00022180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022190: 2020 2020 2020 2050 5f7b 595f 7b64 662b         P_{Y_{df+
-000221a0: 3269 7d7d 2878 292c 0d0a 0d0a 2020 7768  2i}}(x),....  wh
-000221b0: 6572 6520 3a6d 6174 683a 6059 5f7b 717d  ere :math:`Y_{q}
-000221c0: 6020 6973 2074 6865 2043 6869 2d73 7175  ` is the Chi-squ
-000221d0: 6172 6520 7769 7468 2071 2064 6567 7265  are with q degre
-000221e0: 6573 206f 6620 6672 6565 646f 6d2e 0d0a  es of freedom...
-000221f0: 0d0a 2020 5265 6665 7265 6e63 6573 0d0a  ..  References..
-00022200: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00022210: 2e2e 205b 315d 2057 696b 6970 6564 6961  .. [1] Wikipedia
-00022220: 2c20 224e 6f6e 6365 6e74 7261 6c20 6368  , "Noncentral ch
-00022230: 692d 7371 7561 7265 6420 6469 7374 7269  i-squared distri
-00022240: 6275 7469 6f6e 220d 0a20 2020 2020 2020  bution"..       
-00022250: 2020 6874 7470 733a 2f2f 656e 2e77 696b    https://en.wik
-00022260: 6970 6564 6961 2e6f 7267 2f77 696b 692f  ipedia.org/wiki/
-00022270: 4e6f 6e63 656e 7472 616c 5f63 6869 2d73  Noncentral_chi-s
-00022280: 7175 6172 6564 5f64 6973 7472 6962 7574  quared_distribut
-00022290: 696f 6e0d 0a0d 0a20 2045 7861 6d70 6c65  ion....  Example
-000222a0: 730d 0a20 202d 2d2d 2d2d 2d2d 2d0d 0a20  s..  --------.. 
-000222b0: 2044 7261 7720 7661 6c75 6573 2066 726f   Draw values fro
-000222c0: 6d20 7468 6520 6469 7374 7269 6275 7469  m the distributi
-000222d0: 6f6e 2061 6e64 2070 6c6f 7420 7468 6520  on and plot the 
-000222e0: 6869 7374 6f67 7261 6d0d 0a0d 0a20 203e  histogram....  >
-000222f0: 3e3e 2069 6d70 6f72 7420 6d61 7470 6c6f  >> import matplo
-00022300: 746c 6962 2e70 7970 6c6f 7420 6173 2070  tlib.pyplot as p
-00022310: 6c74 2020 2320 6e6f 7161 0d0a 2020 3e3e  lt  # noqa..  >>
-00022320: 3e20 7661 6c75 6573 203d 2070 6c74 2e68  > values = plt.h
-00022330: 6973 7428 6263 2e72 616e 646f 6d2e 6e6f  ist(bc.random.no
-00022340: 6e63 656e 7472 616c 5f63 6869 7371 7561  ncentral_chisqua
-00022350: 7265 2833 2c20 3230 2c20 3130 3030 3030  re(3, 20, 100000
-00022360: 292c 0d0a 2020 2e2e 2e20 2020 2020 2020  ),..  ...       
-00022370: 2020 2020 2020 2020 2020 2020 6269 6e73              bins
-00022380: 3d32 3030 2c20 6465 6e73 6974 793d 5472  =200, density=Tr
-00022390: 7565 290d 0a20 203e 3e3e 2070 6c74 2e73  ue)..  >>> plt.s
-000223a0: 686f 7728 290d 0a0d 0a20 2044 7261 7720  how()....  Draw 
-000223b0: 7661 6c75 6573 2066 726f 6d20 6120 6e6f  values from a no
-000223c0: 6e63 656e 7472 616c 2063 6869 7371 7561  ncentral chisqua
-000223d0: 7265 2077 6974 6820 7665 7279 2073 6d61  re with very sma
-000223e0: 6c6c 206e 6f6e 6365 6e74 7261 6c69 7479  ll noncentrality
-000223f0: 2c0d 0a20 2061 6e64 2063 6f6d 7061 7265  ,..  and compare
-00022400: 2074 6f20 6120 6368 6973 7175 6172 652e   to a chisquare.
-00022410: 0d0a 0d0a 2020 3e3e 3e20 706c 742e 6669  ....  >>> plt.fi
-00022420: 6775 7265 2829 0d0a 2020 3e3e 3e20 7661  gure()..  >>> va
-00022430: 6c75 6573 203d 2070 6c74 2e68 6973 7428  lues = plt.hist(
-00022440: 6263 2e72 616e 646f 6d2e 6e6f 6e63 656e  bc.random.noncen
-00022450: 7472 616c 5f63 6869 7371 7561 7265 2833  tral_chisquare(3
-00022460: 2c20 2e30 3030 3030 3031 2c20 3130 3030  , .0000001, 1000
-00022470: 3030 292c 0d0a 2020 2e2e 2e20 2020 2020  00),..  ...     
-00022480: 2020 2020 2020 2020 2020 2020 2020 6269                bi
-00022490: 6e73 3d6e 702e 6172 616e 6765 2830 2e2c  ns=np.arange(0.,
-000224a0: 2032 352c 202e 3129 2c20 6465 6e73 6974   25, .1), densit
-000224b0: 793d 5472 7565 290d 0a20 203e 3e3e 2076  y=True)..  >>> v
-000224c0: 616c 7565 7332 203d 2070 6c74 2e68 6973  alues2 = plt.his
-000224d0: 7428 6263 2e72 616e 646f 6d2e 6368 6973  t(bc.random.chis
-000224e0: 7175 6172 6528 332c 2031 3030 3030 3029  quare(3, 100000)
-000224f0: 2c0d 0a20 202e 2e2e 2020 2020 2020 2020  ,..  ...        
-00022500: 2020 2020 2020 2020 2020 2020 6269 6e73              bins
-00022510: 3d6e 702e 6172 616e 6765 2830 2e2c 2032  =np.arange(0., 2
-00022520: 352c 202e 3129 2c20 6465 6e73 6974 793d  5, .1), density=
-00022530: 5472 7565 290d 0a20 203e 3e3e 2070 6c74  True)..  >>> plt
-00022540: 2e70 6c6f 7428 7661 6c75 6573 5b31 5d5b  .plot(values[1][
-00022550: 303a 2d31 5d2c 2076 616c 7565 735b 305d  0:-1], values[0]
-00022560: 2d76 616c 7565 7332 5b30 5d2c 2027 6f62  -values2[0], 'ob
-00022570: 2729 0d0a 2020 3e3e 3e20 706c 742e 7368  ')..  >>> plt.sh
-00022580: 6f77 2829 0d0a 0d0a 2020 4465 6d6f 6e73  ow()....  Demons
-00022590: 7472 6174 6520 686f 7720 6c61 7267 6520  trate how large 
-000225a0: 7661 6c75 6573 206f 6620 6e6f 6e2d 6365  values of non-ce
-000225b0: 6e74 7261 6c69 7479 206c 6561 6420 746f  ntrality lead to
-000225c0: 2061 206d 6f72 6520 7379 6d6d 6574 7269   a more symmetri
-000225d0: 630d 0a20 2064 6973 7472 6962 7574 696f  c..  distributio
-000225e0: 6e2e 0d0a 0d0a 2020 3e3e 3e20 706c 742e  n.....  >>> plt.
-000225f0: 6669 6775 7265 2829 0d0a 2020 3e3e 3e20  figure()..  >>> 
-00022600: 7661 6c75 6573 203d 2070 6c74 2e68 6973  values = plt.his
-00022610: 7428 6263 2e72 616e 646f 6d2e 6e6f 6e63  t(bc.random.nonc
-00022620: 656e 7472 616c 5f63 6869 7371 7561 7265  entral_chisquare
-00022630: 2833 2c20 3230 2c20 3130 3030 3030 292c  (3, 20, 100000),
-00022640: 0d0a 2020 2e2e 2e20 2020 2020 2020 2020  ..  ...         
-00022650: 2020 2020 2020 2020 2020 6269 6e73 3d32            bins=2
-00022660: 3030 2c20 6465 6e73 6974 793d 5472 7565  00, density=True
-00022670: 290d 0a20 203e 3e3e 2070 6c74 2e73 686f  )..  >>> plt.sho
-00022680: 7728 290d 0a20 2022 2222 0d0a 2020 7265  w()..  """..  re
-00022690: 7475 726e 2044 4546 4155 4c54 2e6e 6f6e  turn DEFAULT.non
-000226a0: 6365 6e74 7261 6c5f 6368 6973 7175 6172  central_chisquar
-000226b0: 6528 6466 2c20 6e6f 6e63 2c20 7369 7a65  e(df, nonc, size
-000226c0: 2c20 6b65 793d 6b65 792c 2064 7479 7065  , key=key, dtype
-000226d0: 3d64 7479 7065 290d 0a0d 0a0d 0a64 6566  =dtype)......def
-000226e0: 206e 6f6e 6365 6e74 7261 6c5f 6628 6466   noncentral_f(df
-000226f0: 6e75 6d2c 2064 6664 656e 2c20 6e6f 6e63  num, dfden, nonc
-00022700: 2c20 7369 7a65 3a20 4f70 7469 6f6e 616c  , size: Optional
-00022710: 5b53 697a 655d 203d 204e 6f6e 652c 0d0a  [Size] = None,..
-00022720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022730: 206b 6579 3a20 4f70 7469 6f6e 616c 5b53   key: Optional[S
-00022740: 6565 644f 724b 6579 5d20 3d20 4e6f 6e65  eedOrKey] = None
-00022750: 2c20 6474 7970 653a 2044 5479 7065 4c69  , dtype: DTypeLi
-00022760: 6b65 203d 204e 6f6e 6529 3a0d 0a20 2072  ke = None):..  r
-00022770: 2222 220d 0a20 2044 7261 7720 7361 6d70  """..  Draw samp
-00022780: 6c65 7320 6672 6f6d 2074 6865 206e 6f6e  les from the non
-00022790: 6365 6e74 7261 6c20 4620 6469 7374 7269  central F distri
-000227a0: 6275 7469 6f6e 2e0d 0a0d 0a20 2053 616d  bution.....  Sam
-000227b0: 706c 6573 2061 7265 2064 7261 776e 2066  ples are drawn f
-000227c0: 726f 6d20 616e 2046 2064 6973 7472 6962  rom an F distrib
-000227d0: 7574 696f 6e20 7769 7468 2073 7065 6369  ution with speci
-000227e0: 6669 6564 2070 6172 616d 6574 6572 732c  fied parameters,
-000227f0: 0d0a 2020 6064 666e 756d 6020 2864 6567  ..  `dfnum` (deg
-00022800: 7265 6573 206f 6620 6672 6565 646f 6d20  rees of freedom 
-00022810: 696e 206e 756d 6572 6174 6f72 2920 616e  in numerator) an
-00022820: 6420 6064 6664 656e 6020 2864 6567 7265  d `dfden` (degre
-00022830: 6573 206f 660d 0a20 2066 7265 6564 6f6d  es of..  freedom
-00022840: 2069 6e20 6465 6e6f 6d69 6e61 746f 7229   in denominator)
-00022850: 2c20 7768 6572 6520 626f 7468 2070 6172  , where both par
-00022860: 616d 6574 6572 7320 3e20 312e 0d0a 2020  ameters > 1...  
-00022870: 606e 6f6e 6360 2069 7320 7468 6520 6e6f  `nonc` is the no
-00022880: 6e2d 6365 6e74 7261 6c69 7479 2070 6172  n-centrality par
-00022890: 616d 6574 6572 2e0d 0a0d 0a20 2050 6172  ameter.....  Par
-000228a0: 616d 6574 6572 730d 0a20 202d 2d2d 2d2d  ameters..  -----
-000228b0: 2d2d 2d2d 2d0d 0a20 2064 666e 756d 203a  -----..  dfnum :
-000228c0: 2066 6c6f 6174 206f 7220 6172 7261 795f   float or array_
-000228d0: 6c69 6b65 206f 6620 666c 6f61 7473 0d0a  like of floats..
-000228e0: 2020 2020 2020 4e75 6d65 7261 746f 7220        Numerator 
-000228f0: 6465 6772 6565 7320 6f66 2066 7265 6564  degrees of freed
-00022900: 6f6d 2c20 6d75 7374 2062 6520 3e20 302e  om, must be > 0.
-00022910: 0d0a 2020 6466 6465 6e20 3a20 666c 6f61  ..  dfden : floa
-00022920: 7420 6f72 2061 7272 6179 5f6c 696b 6520  t or array_like 
-00022930: 6f66 2066 6c6f 6174 730d 0a20 2020 2020  of floats..     
-00022940: 2044 656e 6f6d 696e 6174 6f72 2064 6567   Denominator deg
-00022950: 7265 6573 206f 6620 6672 6565 646f 6d2c  rees of freedom,
-00022960: 206d 7573 7420 6265 203e 2030 2e0d 0a20   must be > 0... 
-00022970: 206e 6f6e 6320 3a20 666c 6f61 7420 6f72   nonc : float or
-00022980: 2061 7272 6179 5f6c 696b 6520 6f66 2066   array_like of f
-00022990: 6c6f 6174 730d 0a20 2020 2020 204e 6f6e  loats..      Non
-000229a0: 2d63 656e 7472 616c 6974 7920 7061 7261  -centrality para
-000229b0: 6d65 7465 722c 2074 6865 2073 756d 206f  meter, the sum o
-000229c0: 6620 7468 6520 7371 7561 7265 7320 6f66  f the squares of
-000229d0: 2074 6865 206e 756d 6572 6174 6f72 0d0a   the numerator..
-000229e0: 2020 2020 2020 6d65 616e 732c 206d 7573        means, mus
-000229f0: 7420 6265 203e 3d20 302e 0d0a 2020 7369  t be >= 0...  si
-00022a00: 7a65 203a 2069 6e74 206f 7220 7475 706c  ze : int or tupl
-00022a10: 6520 6f66 2069 6e74 732c 206f 7074 696f  e of ints, optio
-00022a20: 6e61 6c0d 0a20 2020 2020 204f 7574 7075  nal..      Outpu
-00022a30: 7420 7368 6170 652e 2020 4966 2074 6865  t shape.  If the
-00022a40: 2067 6976 656e 2073 6861 7065 2069 732c   given shape is,
-00022a50: 2065 2e67 2e2c 2060 6028 6d2c 206e 2c20   e.g., ``(m, n, 
-00022a60: 6b29 6060 2c20 7468 656e 0d0a 2020 2020  k)``, then..    
-00022a70: 2020 6060 6d20 2a20 6e20 2a20 6b60 6020    ``m * n * k`` 
-00022a80: 7361 6d70 6c65 7320 6172 6520 6472 6177  samples are draw
-00022a90: 6e2e 2020 4966 2073 697a 6520 6973 2060  n.  If size is `
-00022aa0: 604e 6f6e 6560 6020 2864 6566 6175 6c74  `None`` (default
-00022ab0: 292c 0d0a 2020 2020 2020 6120 7369 6e67  ),..      a sing
-00022ac0: 6c65 2076 616c 7565 2069 7320 7265 7475  le value is retu
-00022ad0: 726e 6564 2069 6620 6060 6466 6e75 6d60  rned if ``dfnum`
-00022ae0: 602c 2060 6064 6664 656e 6060 2c20 616e  `, ``dfden``, an
-00022af0: 6420 6060 6e6f 6e63 6060 0d0a 2020 2020  d ``nonc``..    
-00022b00: 2020 6172 6520 616c 6c20 7363 616c 6172    are all scalar
-00022b10: 732e 2020 4f74 6865 7277 6973 652c 2060  s.  Otherwise, `
-00022b20: 606e 702e 6272 6f61 6463 6173 7428 6466  `np.broadcast(df
-00022b30: 6e75 6d2c 2064 6664 656e 2c20 6e6f 6e63  num, dfden, nonc
-00022b40: 292e 7369 7a65 6060 0d0a 2020 2020 2020  ).size``..      
-00022b50: 7361 6d70 6c65 7320 6172 6520 6472 6177  samples are draw
-00022b60: 6e2e 0d0a 2020 6b65 7920 3a20 5052 4e47  n...  key : PRNG
-00022b70: 4b65 792c 206f 7074 696f 6e61 6c0d 0a20  Key, optional.. 
-00022b80: 2020 2020 2054 6865 206b 6579 2066 6f72       The key for
-00022b90: 2074 6865 2072 616e 646f 6d20 6e75 6d62   the random numb
-00022ba0: 6572 2067 656e 6572 6174 6f72 2e20 4966  er generator. If
-00022bb0: 206e 6f74 2067 6976 656e 2c20 7468 650d   not given, the.
-00022bc0: 0a20 2020 2020 2064 6566 6175 6c74 2072  .      default r
-00022bd0: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
-00022be0: 6572 6174 6f72 2069 7320 7573 6564 2e0d  erator is used..
-00022bf0: 0a0d 0a20 2052 6574 7572 6e73 0d0a 2020  ...  Returns..  
-00022c00: 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574 203a  -------..  out :
-00022c10: 206e 6461 7272 6179 206f 7220 7363 616c   ndarray or scal
-00022c20: 6172 0d0a 2020 2020 2020 4472 6177 6e20  ar..      Drawn 
-00022c30: 7361 6d70 6c65 7320 6672 6f6d 2074 6865  samples from the
-00022c40: 2070 6172 616d 6574 6572 697a 6564 206e   parameterized n
-00022c50: 6f6e 6365 6e74 7261 6c20 4669 7368 6572  oncentral Fisher
-00022c60: 2064 6973 7472 6962 7574 696f 6e2e 0d0a   distribution...
-00022c70: 0d0a 2020 4e6f 7465 730d 0a20 202d 2d2d  ..  Notes..  ---
-00022c80: 2d2d 0d0a 2020 5768 656e 2063 616c 6375  --..  When calcu
-00022c90: 6c61 7469 6e67 2074 6865 2070 6f77 6572  lating the power
-00022ca0: 206f 6620 616e 2065 7870 6572 696d 656e   of an experimen
-00022cb0: 7420 2870 6f77 6572 203d 2070 726f 6261  t (power = proba
-00022cc0: 6269 6c69 7479 206f 660d 0a20 2072 656a  bility of..  rej
-00022cd0: 6563 7469 6e67 2074 6865 206e 756c 6c20  ecting the null 
-00022ce0: 6879 706f 7468 6573 6973 2077 6865 6e20  hypothesis when 
-00022cf0: 6120 7370 6563 6966 6963 2061 6c74 6572  a specific alter
-00022d00: 6e61 7469 7665 2069 7320 7472 7565 2920  native is true) 
-00022d10: 7468 650d 0a20 206e 6f6e 2d63 656e 7472  the..  non-centr
-00022d20: 616c 2046 2073 7461 7469 7374 6963 2062  al F statistic b
-00022d30: 6563 6f6d 6573 2069 6d70 6f72 7461 6e74  ecomes important
-00022d40: 2e20 2057 6865 6e20 7468 6520 6e75 6c6c  .  When the null
-00022d50: 2068 7970 6f74 6865 7369 7320 6973 0d0a   hypothesis is..
-00022d60: 2020 7472 7565 2c20 7468 6520 4620 7374    true, the F st
-00022d70: 6174 6973 7469 6320 666f 6c6c 6f77 7320  atistic follows 
-00022d80: 6120 6365 6e74 7261 6c20 4620 6469 7374  a central F dist
-00022d90: 7269 6275 7469 6f6e 2e20 5768 656e 2074  ribution. When t
-00022da0: 6865 206e 756c 6c0d 0a20 2068 7970 6f74  he null..  hypot
-00022db0: 6865 7369 7320 6973 206e 6f74 2074 7275  hesis is not tru
-00022dc0: 652c 2074 6865 6e20 6974 2066 6f6c 6c6f  e, then it follo
-00022dd0: 7773 2061 206e 6f6e 2d63 656e 7472 616c  ws a non-central
-00022de0: 2046 2073 7461 7469 7374 6963 2e0d 0a0d   F statistic....
-00022df0: 0a20 2052 6566 6572 656e 6365 730d 0a20  .  References.. 
-00022e00: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 202e   ----------..  .
-00022e10: 2e20 5b31 5d20 5765 6973 7374 6569 6e2c  . [1] Weisstein,
-00022e20: 2045 7269 6320 572e 2022 4e6f 6e63 656e   Eric W. "Noncen
-00022e30: 7472 616c 2046 2d44 6973 7472 6962 7574  tral F-Distribut
-00022e40: 696f 6e2e 220d 0a20 2020 2020 2020 2020  ion."..         
-00022e50: 4672 6f6d 204d 6174 6857 6f72 6c64 2d2d  From MathWorld--
-00022e60: 4120 576f 6c66 7261 6d20 5765 6220 5265  A Wolfram Web Re
-00022e70: 736f 7572 6365 2e0d 0a20 2020 2020 2020  source...       
-00022e80: 2020 6874 7470 3a2f 2f6d 6174 6877 6f72    http://mathwor
-00022e90: 6c64 2e77 6f6c 6672 616d 2e63 6f6d 2f4e  ld.wolfram.com/N
-00022ea0: 6f6e 6365 6e74 7261 6c46 2d44 6973 7472  oncentralF-Distr
-00022eb0: 6962 7574 696f 6e2e 6874 6d6c 0d0a 2020  ibution.html..  
-00022ec0: 2e2e 205b 325d 2057 696b 6970 6564 6961  .. [2] Wikipedia
-00022ed0: 2c20 224e 6f6e 6365 6e74 7261 6c20 462d  , "Noncentral F-
-00022ee0: 6469 7374 7269 6275 7469 6f6e 222c 0d0a  distribution",..
-00022ef0: 2020 2020 2020 2020 2068 7474 7073 3a2f           https:/
-00022f00: 2f65 6e2e 7769 6b69 7065 6469 612e 6f72  /en.wikipedia.or
-00022f10: 672f 7769 6b69 2f4e 6f6e 6365 6e74 7261  g/wiki/Noncentra
-00022f20: 6c5f 462d 6469 7374 7269 6275 7469 6f6e  l_F-distribution
-00022f30: 0d0a 0d0a 2020 4578 616d 706c 6573 0d0a  ....  Examples..
-00022f40: 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020 496e    --------..  In
-00022f50: 2061 2073 7475 6479 2c20 7465 7374 696e   a study, testin
-00022f60: 6720 666f 7220 6120 7370 6563 6966 6963  g for a specific
-00022f70: 2061 6c74 6572 6e61 7469 7665 2074 6f20   alternative to 
-00022f80: 7468 6520 6e75 6c6c 2068 7970 6f74 6865  the null hypothe
-00022f90: 7369 730d 0a20 2072 6571 7569 7265 7320  sis..  requires 
-00022fa0: 7573 6520 6f66 2074 6865 204e 6f6e 6365  use of the Nonce
-00022fb0: 6e74 7261 6c20 4620 6469 7374 7269 6275  ntral F distribu
-00022fc0: 7469 6f6e 2e20 5765 206e 6565 6420 746f  tion. We need to
-00022fd0: 2063 616c 6375 6c61 7465 2074 6865 0d0a   calculate the..
-00022fe0: 2020 6172 6561 2069 6e20 7468 6520 7461    area in the ta
-00022ff0: 696c 206f 6620 7468 6520 6469 7374 7269  il of the distri
-00023000: 6275 7469 6f6e 2074 6861 7420 6578 6365  bution that exce
-00023010: 6564 7320 7468 6520 7661 6c75 6520 6f66  eds the value of
-00023020: 2074 6865 2046 0d0a 2020 6469 7374 7269   the F..  distri
-00023030: 6275 7469 6f6e 2066 6f72 2074 6865 206e  bution for the n
-00023040: 756c 6c20 6879 706f 7468 6573 6973 2e20  ull hypothesis. 
-00023050: 2057 6527 6c6c 2070 6c6f 7420 7468 6520   We'll plot the 
-00023060: 7477 6f20 7072 6f62 6162 696c 6974 790d  two probability.
-00023070: 0a20 2064 6973 7472 6962 7574 696f 6e73  .  distributions
-00023080: 2066 6f72 2063 6f6d 7061 7269 736f 6e2e   for comparison.
-00023090: 0d0a 0d0a 2020 3e3e 3e20 6466 6e75 6d20  ....  >>> dfnum 
-000230a0: 3d20 3320 2320 6265 7477 6565 6e20 6772  = 3 # between gr
-000230b0: 6f75 7020 6465 6720 6f66 2066 7265 6564  oup deg of freed
-000230c0: 6f6d 0d0a 2020 3e3e 3e20 6466 6465 6e20  om..  >>> dfden 
-000230d0: 3d20 3230 2023 2077 6974 6869 6e20 6772  = 20 # within gr
-000230e0: 6f75 7073 2064 6567 7265 6573 206f 6620  oups degrees of 
-000230f0: 6672 6565 646f 6d0d 0a20 203e 3e3e 206e  freedom..  >>> n
-00023100: 6f6e 6320 3d20 332e 300d 0a20 203e 3e3e  onc = 3.0..  >>>
-00023110: 206e 635f 7661 6c73 203d 2062 632e 7261   nc_vals = bc.ra
-00023120: 6e64 6f6d 2e6e 6f6e 6365 6e74 7261 6c5f  ndom.noncentral_
-00023130: 6628 6466 6e75 6d2c 2064 6664 656e 2c20  f(dfnum, dfden, 
-00023140: 6e6f 6e63 2c20 3130 3030 3030 3029 0d0a  nonc, 1000000)..
-00023150: 2020 3e3e 3e20 4e46 203d 206e 702e 6869    >>> NF = np.hi
-00023160: 7374 6f67 7261 6d28 6e63 5f76 616c 732c  stogram(nc_vals,
-00023170: 2062 696e 733d 3530 2c20 6465 6e73 6974   bins=50, densit
-00023180: 793d 5472 7565 290d 0a20 203e 3e3e 2063  y=True)..  >>> c
-00023190: 5f76 616c 7320 3d20 6263 2e72 616e 646f  _vals = bc.rando
-000231a0: 6d2e 6628 6466 6e75 6d2c 2064 6664 656e  m.f(dfnum, dfden
-000231b0: 2c20 3130 3030 3030 3029 0d0a 2020 3e3e  , 1000000)..  >>
-000231c0: 3e20 4620 3d20 6e70 2e68 6973 746f 6772  > F = np.histogr
-000231d0: 616d 2863 5f76 616c 732c 2062 696e 733d  am(c_vals, bins=
-000231e0: 3530 2c20 6465 6e73 6974 793d 5472 7565  50, density=True
-000231f0: 290d 0a20 203e 3e3e 2069 6d70 6f72 7420  )..  >>> import 
-00023200: 6d61 7470 6c6f 746c 6962 2e70 7970 6c6f  matplotlib.pyplo
-00023210: 7420 6173 2070 6c74 2020 2320 6e6f 7161  t as plt  # noqa
-00023220: 0d0a 2020 3e3e 3e20 706c 742e 706c 6f74  ..  >>> plt.plot
-00023230: 2846 5b31 5d5b 313a 5d2c 2046 5b30 5d29  (F[1][1:], F[0])
-00023240: 0d0a 2020 3e3e 3e20 706c 742e 706c 6f74  ..  >>> plt.plot
-00023250: 284e 465b 315d 5b31 3a5d 2c20 4e46 5b30  (NF[1][1:], NF[0
-00023260: 5d29 0d0a 2020 3e3e 3e20 706c 742e 7368  ])..  >>> plt.sh
-00023270: 6f77 2829 0d0a 2020 2222 220d 0a20 2072  ow()..  """..  r
-00023280: 6574 7572 6e20 4445 4641 554c 542e 6e6f  eturn DEFAULT.no
-00023290: 6e63 656e 7472 616c 5f66 2864 666e 756d  ncentral_f(dfnum
-000232a0: 2c20 6466 6465 6e2c 206e 6f6e 632c 2073  , dfden, nonc, s
-000232b0: 697a 652c 206b 6579 3d6b 6579 2c20 6474  ize, key=key, dt
-000232c0: 7970 653d 6474 7970 6529 0d0a 0d0a 0d0a  ype=dtype)......
-000232d0: 6465 6620 706f 7765 7228 612c 0d0a 2020  def power(a,..  
-000232e0: 2020 2020 2020 2020 7369 7a65 3a20 4f70          size: Op
-000232f0: 7469 6f6e 616c 5b53 697a 655d 203d 204e  tional[Size] = N
-00023300: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
-00023310: 6b65 793a 204f 7074 696f 6e61 6c5b 5365  key: Optional[Se
-00023320: 6564 4f72 4b65 795d 203d 204e 6f6e 652c  edOrKey] = None,
-00023330: 0d0a 2020 2020 2020 2020 2020 6474 7970  ..          dtyp
-00023340: 653a 2044 5479 7065 4c69 6b65 203d 204e  e: DTypeLike = N
-00023350: 6f6e 6529 3a0d 0a20 2072 2222 220d 0a20  one):..  r""".. 
-00023360: 2044 7261 7773 2073 616d 706c 6573 2069   Draws samples i
-00023370: 6e20 5b30 2c20 315d 2066 726f 6d20 6120  n [0, 1] from a 
-00023380: 706f 7765 7220 6469 7374 7269 6275 7469  power distributi
-00023390: 6f6e 2077 6974 6820 706f 7369 7469 7665  on with positive
-000233a0: 0d0a 2020 6578 706f 6e65 6e74 2061 202d  ..  exponent a -
-000233b0: 2031 2e0d 0a0d 0a20 2041 6c73 6f20 6b6e   1.....  Also kn
-000233c0: 6f77 6e20 6173 2074 6865 2070 6f77 6572  own as the power
-000233d0: 2066 756e 6374 696f 6e20 6469 7374 7269   function distri
-000233e0: 6275 7469 6f6e 2e0d 0a0d 0a20 2050 6172  bution.....  Par
-000233f0: 616d 6574 6572 730d 0a20 202d 2d2d 2d2d  ameters..  -----
-00023400: 2d2d 2d2d 2d0d 0a20 2061 203a 2066 6c6f  -----..  a : flo
-00023410: 6174 206f 7220 6172 7261 795f 6c69 6b65  at or array_like
-00023420: 206f 6620 666c 6f61 7473 0d0a 2020 2020   of floats..    
-00023430: 2020 5061 7261 6d65 7465 7220 6f66 2074    Parameter of t
-00023440: 6865 2064 6973 7472 6962 7574 696f 6e2e  he distribution.
-00023450: 204d 7573 7420 6265 206e 6f6e 2d6e 6567   Must be non-neg
-00023460: 6174 6976 652e 0d0a 2020 7369 7a65 203a  ative...  size :
-00023470: 2069 6e74 206f 7220 7475 706c 6520 6f66   int or tuple of
-00023480: 2069 6e74 732c 206f 7074 696f 6e61 6c0d   ints, optional.
-00023490: 0a20 2020 2020 204f 7574 7075 7420 7368  .      Output sh
-000234a0: 6170 652e 2020 4966 2074 6865 2067 6976  ape.  If the giv
-000234b0: 656e 2073 6861 7065 2069 732c 2065 2e67  en shape is, e.g
-000234c0: 2e2c 2060 6028 6d2c 206e 2c20 6b29 6060  ., ``(m, n, k)``
-000234d0: 2c20 7468 656e 0d0a 2020 2020 2020 6060  , then..      ``
-000234e0: 6d20 2a20 6e20 2a20 6b60 6020 7361 6d70  m * n * k`` samp
-000234f0: 6c65 7320 6172 6520 6472 6177 6e2e 2020  les are drawn.  
-00023500: 4966 2073 697a 6520 6973 2060 604e 6f6e  If size is ``Non
-00023510: 6560 6020 2864 6566 6175 6c74 292c 0d0a  e`` (default),..
-00023520: 2020 2020 2020 6120 7369 6e67 6c65 2076        a single v
-00023530: 616c 7565 2069 7320 7265 7475 726e 6564  alue is returned
-00023540: 2069 6620 6060 6160 6020 6973 2061 2073   if ``a`` is a s
-00023550: 6361 6c61 722e 2020 4f74 6865 7277 6973  calar.  Otherwis
-00023560: 652c 0d0a 2020 2020 2020 6060 6e70 2e61  e,..      ``np.a
-00023570: 7272 6179 2861 292e 7369 7a65 6060 2073  rray(a).size`` s
-00023580: 616d 706c 6573 2061 7265 2064 7261 776e  amples are drawn
-00023590: 2e0d 0a20 206b 6579 203a 2050 524e 474b  ...  key : PRNGK
-000235a0: 6579 2c20 6f70 7469 6f6e 616c 0d0a 2020  ey, optional..  
-000235b0: 2020 2020 5468 6520 6b65 7920 666f 7220      The key for 
-000235c0: 7468 6520 7261 6e64 6f6d 206e 756d 6265  the random numbe
-000235d0: 7220 6765 6e65 7261 746f 722e 2049 6620  r generator. If 
-000235e0: 6e6f 7420 6769 7665 6e2c 2074 6865 0d0a  not given, the..
-000235f0: 2020 2020 2020 6465 6661 756c 7420 7261        default ra
-00023600: 6e64 6f6d 206e 756d 6265 7220 6765 6e65  ndom number gene
-00023610: 7261 746f 7220 6973 2075 7365 642e 0d0a  rator is used...
-00023620: 0d0a 2020 5265 7475 726e 730d 0a20 202d  ..  Returns..  -
-00023630: 2d2d 2d2d 2d2d 0d0a 2020 6f75 7420 3a20  ------..  out : 
-00023640: 6e64 6172 7261 7920 6f72 2073 6361 6c61  ndarray or scala
-00023650: 720d 0a20 2020 2020 2044 7261 776e 2073  r..      Drawn s
-00023660: 616d 706c 6573 2066 726f 6d20 7468 6520  amples from the 
-00023670: 7061 7261 6d65 7465 7269 7a65 6420 706f  parameterized po
-00023680: 7765 7220 6469 7374 7269 6275 7469 6f6e  wer distribution
-00023690: 2e0d 0a0d 0a20 2052 6169 7365 730d 0a20  .....  Raises.. 
-000236a0: 202d 2d2d 2d2d 2d0d 0a20 2056 616c 7565   ------..  Value
-000236b0: 4572 726f 720d 0a20 2020 2020 2049 6620  Error..      If 
-000236c0: 6120 3c3d 2030 2e0d 0a0d 0a20 204e 6f74  a <= 0.....  Not
-000236d0: 6573 0d0a 2020 2d2d 2d2d 2d0d 0a20 2054  es..  -----..  T
-000236e0: 6865 2070 726f 6261 6269 6c69 7479 2064  he probability d
-000236f0: 656e 7369 7479 2066 756e 6374 696f 6e20  ensity function 
-00023700: 6973 0d0a 0d0a 2020 2e2e 206d 6174 683a  is....  .. math:
-00023710: 3a20 5028 783b 2061 2920 3d20 6178 5e7b  : P(x; a) = ax^{
-00023720: 612d 317d 2c20 3020 5c6c 6520 7820 5c6c  a-1}, 0 \le x \l
-00023730: 6520 312c 2061 3e30 2e0d 0a0d 0a20 2054  e 1, a>0.....  T
-00023740: 6865 2070 6f77 6572 2066 756e 6374 696f  he power functio
-00023750: 6e20 6469 7374 7269 6275 7469 6f6e 2069  n distribution i
-00023760: 7320 6a75 7374 2074 6865 2069 6e76 6572  s just the inver
-00023770: 7365 206f 6620 7468 6520 5061 7265 746f  se of the Pareto
-00023780: 0d0a 2020 6469 7374 7269 6275 7469 6f6e  ..  distribution
-00023790: 2e20 4974 206d 6179 2061 6c73 6f20 6265  . It may also be
-000237a0: 2073 6565 6e20 6173 2061 2073 7065 6369   seen as a speci
-000237b0: 616c 2063 6173 6520 6f66 2074 6865 2042  al case of the B
-000237c0: 6574 610d 0a20 2064 6973 7472 6962 7574  eta..  distribut
-000237d0: 696f 6e2e 0d0a 0d0a 2020 4974 2069 7320  ion.....  It is 
-000237e0: 7573 6564 2c20 666f 7220 6578 616d 706c  used, for exampl
-000237f0: 652c 2069 6e20 6d6f 6465 6c69 6e67 2074  e, in modeling t
-00023800: 6865 206f 7665 722d 7265 706f 7274 696e  he over-reportin
-00023810: 6720 6f66 2069 6e73 7572 616e 6365 0d0a  g of insurance..
-00023820: 2020 636c 6169 6d73 2e0d 0a0d 0a20 2052    claims.....  R
-00023830: 6566 6572 656e 6365 730d 0a20 202d 2d2d  eferences..  ---
-00023840: 2d2d 2d2d 2d2d 2d0d 0a20 202e 2e20 5b31  -------..  .. [1
-00023850: 5d20 4368 7269 7374 6961 6e20 4b6c 6569  ] Christian Klei
-00023860: 6265 722c 2053 616d 7565 6c20 4b6f 747a  ber, Samuel Kotz
-00023870: 2c20 2253 7461 7469 7374 6963 616c 2073  , "Statistical s
-00023880: 697a 6520 6469 7374 7269 6275 7469 6f6e  ize distribution
-00023890: 730d 0a20 2020 2020 2020 2020 696e 2065  s..         in e
-000238a0: 636f 6e6f 6d69 6373 2061 6e64 2061 6374  conomics and act
-000238b0: 7561 7269 616c 2073 6369 656e 6365 7322  uarial sciences"
-000238c0: 2c20 5769 6c65 792c 2032 3030 332e 0d0a  , Wiley, 2003...
-000238d0: 2020 2e2e 205b 325d 2048 6563 6b65 7274    .. [2] Heckert
-000238e0: 2c20 4e2e 2041 2e20 616e 6420 4669 6c6c  , N. A. and Fill
-000238f0: 6962 656e 2c20 4a61 6d65 7320 4a2e 2022  iben, James J. "
-00023900: 4e49 5354 2048 616e 6462 6f6f 6b20 3134  NIST Handbook 14
-00023910: 383a 0d0a 2020 2020 2020 2020 2044 6174  8:..         Dat
-00023920: 6170 6c6f 7420 5265 6665 7265 6e63 6520  aplot Reference 
-00023930: 4d61 6e75 616c 2c20 566f 6c75 6d65 2032  Manual, Volume 2
-00023940: 3a20 4c65 7420 5375 6263 6f6d 6d61 6e64  : Let Subcommand
-00023950: 7320 616e 6420 4c69 6272 6172 790d 0a20  s and Library.. 
-00023960: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
-00023970: 7322 2c20 4e61 7469 6f6e 616c 2049 6e73  s", National Ins
-00023980: 7469 7475 7465 206f 6620 5374 616e 6461  titute of Standa
-00023990: 7264 7320 616e 6420 5465 6368 6e6f 6c6f  rds and Technolo
-000239a0: 6779 0d0a 2020 2020 2020 2020 2048 616e  gy..         Han
-000239b0: 6462 6f6f 6b20 5365 7269 6573 2c20 4a75  dbook Series, Ju
-000239c0: 6e65 2032 3030 332e 0d0a 2020 2020 2020  ne 2003...      
-000239d0: 2020 2068 7474 7073 3a2f 2f77 7777 2e69     https://www.i
-000239e0: 746c 2e6e 6973 742e 676f 762f 6469 7638  tl.nist.gov/div8
-000239f0: 3938 2f73 6f66 7477 6172 652f 6461 7461  98/software/data
-00023a00: 706c 6f74 2f72 6566 6d61 6e32 2f61 7578  plot/refman2/aux
-00023a10: 696c 6c61 722f 706f 7770 6466 2e70 6466  illar/powpdf.pdf
-00023a20: 0d0a 0d0a 2020 4578 616d 706c 6573 0d0a  ....  Examples..
-00023a30: 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020 4472    --------..  Dr
-00023a40: 6177 2073 616d 706c 6573 2066 726f 6d20  aw samples from 
-00023a50: 7468 6520 6469 7374 7269 6275 7469 6f6e  the distribution
-00023a60: 3a0d 0a0d 0a20 203e 3e3e 2061 203d 2035  :....  >>> a = 5
-00023a70: 2e20 2320 7368 6170 650d 0a20 203e 3e3e  . # shape..  >>>
-00023a80: 2073 616d 706c 6573 203d 2031 3030 300d   samples = 1000.
-00023a90: 0a20 203e 3e3e 2073 203d 2062 632e 7261  .  >>> s = bc.ra
-00023aa0: 6e64 6f6d 2e70 6f77 6572 2861 2c20 7361  ndom.power(a, sa
-00023ab0: 6d70 6c65 7329 0d0a 0d0a 2020 4469 7370  mples)....  Disp
-00023ac0: 6c61 7920 7468 6520 6869 7374 6f67 7261  lay the histogra
-00023ad0: 6d20 6f66 2074 6865 2073 616d 706c 6573  m of the samples
-00023ae0: 2c20 616c 6f6e 6720 7769 7468 0d0a 2020  , along with..  
-00023af0: 7468 6520 7072 6f62 6162 696c 6974 7920  the probability 
-00023b00: 6465 6e73 6974 7920 6675 6e63 7469 6f6e  density function
-00023b10: 3a0d 0a0d 0a20 203e 3e3e 2069 6d70 6f72  :....  >>> impor
-00023b20: 7420 6d61 7470 6c6f 746c 6962 2e70 7970  t matplotlib.pyp
-00023b30: 6c6f 7420 6173 2070 6c74 2020 2320 6e6f  lot as plt  # no
-00023b40: 7161 0d0a 2020 3e3e 3e20 636f 756e 742c  qa..  >>> count,
-00023b50: 2062 696e 732c 2069 676e 6f72 6564 203d   bins, ignored =
-00023b60: 2070 6c74 2e68 6973 7428 732c 2062 696e   plt.hist(s, bin
-00023b70: 733d 3330 290d 0a20 203e 3e3e 2078 203d  s=30)..  >>> x =
-00023b80: 206e 702e 6c69 6e73 7061 6365 2830 2c20   np.linspace(0, 
-00023b90: 312c 2031 3030 290d 0a20 203e 3e3e 2079  1, 100)..  >>> y
-00023ba0: 203d 2061 2a78 2a2a 2861 2d31 2e29 0d0a   = a*x**(a-1.)..
-00023bb0: 2020 3e3e 3e20 6e6f 726d 6564 5f79 203d    >>> normed_y =
-00023bc0: 2073 616d 706c 6573 2a6e 702e 6469 6666   samples*np.diff
-00023bd0: 2862 696e 7329 5b30 5d2a 790d 0a20 203e  (bins)[0]*y..  >
-00023be0: 3e3e 2070 6c74 2e70 6c6f 7428 782c 206e  >> plt.plot(x, n
-00023bf0: 6f72 6d65 645f 7929 0d0a 2020 3e3e 3e20  ormed_y)..  >>> 
-00023c00: 706c 742e 7368 6f77 2829 0d0a 0d0a 2020  plt.show()....  
-00023c10: 436f 6d70 6172 6520 7468 6520 706f 7765  Compare the powe
-00023c20: 7220 6675 6e63 7469 6f6e 2064 6973 7472  r function distr
-00023c30: 6962 7574 696f 6e20 746f 2074 6865 2069  ibution to the i
-00023c40: 6e76 6572 7365 206f 6620 7468 6520 5061  nverse of the Pa
-00023c50: 7265 746f 2e0d 0a0d 0a20 203e 3e3e 2066  reto.....  >>> f
-00023c60: 726f 6d20 7363 6970 7920 696d 706f 7274  rom scipy import
-00023c70: 2073 7461 7473 2023 2064 6f63 7465 7374   stats # doctest
-00023c80: 3a20 2b53 4b49 500d 0a20 203e 3e3e 2072  : +SKIP..  >>> r
-00023c90: 7673 203d 2062 632e 7261 6e64 6f6d 2e70  vs = bc.random.p
-00023ca0: 6f77 6572 2835 2c20 3130 3030 3030 3029  ower(5, 1000000)
-00023cb0: 0d0a 2020 3e3e 3e20 7276 7370 203d 2062  ..  >>> rvsp = b
-00023cc0: 632e 7261 6e64 6f6d 2e70 6172 6574 6f28  c.random.pareto(
-00023cd0: 352c 2031 3030 3030 3030 290d 0a20 203e  5, 1000000)..  >
-00023ce0: 3e3e 2078 7820 3d20 6e70 2e6c 696e 7370  >> xx = np.linsp
-00023cf0: 6163 6528 302c 312c 3130 3029 0d0a 2020  ace(0,1,100)..  
-00023d00: 3e3e 3e20 706f 7770 6466 203d 2073 7461  >>> powpdf = sta
-00023d10: 7473 2e70 6f77 6572 6c61 772e 7064 6628  ts.powerlaw.pdf(
-00023d20: 7878 2c35 2920 2023 2064 6f63 7465 7374  xx,5)  # doctest
-00023d30: 3a20 2b53 4b49 500d 0a0d 0a20 203e 3e3e  : +SKIP....  >>>
-00023d40: 2070 6c74 2e66 6967 7572 6528 290d 0a20   plt.figure().. 
-00023d50: 203e 3e3e 2070 6c74 2e68 6973 7428 7276   >>> plt.hist(rv
-00023d60: 732c 2062 696e 733d 3530 2c20 6465 6e73  s, bins=50, dens
-00023d70: 6974 793d 5472 7565 290d 0a20 203e 3e3e  ity=True)..  >>>
-00023d80: 2070 6c74 2e70 6c6f 7428 7878 2c70 6f77   plt.plot(xx,pow
-00023d90: 7064 662c 2772 2d27 2920 2023 2064 6f63  pdf,'r-')  # doc
-00023da0: 7465 7374 3a20 2b53 4b49 500d 0a20 203e  test: +SKIP..  >
-00023db0: 3e3e 2070 6c74 2e74 6974 6c65 2827 6263  >> plt.title('bc
-00023dc0: 2e72 616e 646f 6d2e 706f 7765 7228 3529  .random.power(5)
-00023dd0: 2729 0d0a 0d0a 2020 3e3e 3e20 706c 742e  ')....  >>> plt.
-00023de0: 6669 6775 7265 2829 0d0a 2020 3e3e 3e20  figure()..  >>> 
-00023df0: 706c 742e 6869 7374 2831 2e2f 2831 2e2b  plt.hist(1./(1.+
-00023e00: 7276 7370 292c 2062 696e 733d 3530 2c20  rvsp), bins=50, 
-00023e10: 6465 6e73 6974 793d 5472 7565 290d 0a20  density=True).. 
-00023e20: 203e 3e3e 2070 6c74 2e70 6c6f 7428 7878   >>> plt.plot(xx
-00023e30: 2c70 6f77 7064 662c 2772 2d27 2920 2023  ,powpdf,'r-')  #
-00023e40: 2064 6f63 7465 7374 3a20 2b53 4b49 500d   doctest: +SKIP.
-00023e50: 0a20 203e 3e3e 2070 6c74 2e74 6974 6c65  .  >>> plt.title
-00023e60: 2827 696e 7665 7273 6520 6f66 2031 202b  ('inverse of 1 +
-00023e70: 2062 632e 7261 6e64 6f6d 2e70 6172 6574   bc.random.paret
-00023e80: 6f28 3529 2729 0d0a 0d0a 2020 3e3e 3e20  o(5)')....  >>> 
-00023e90: 706c 742e 6669 6775 7265 2829 0d0a 2020  plt.figure()..  
-00023ea0: 3e3e 3e20 706c 742e 6869 7374 2831 2e2f  >>> plt.hist(1./
-00023eb0: 2831 2e2b 7276 7370 292c 2062 696e 733d  (1.+rvsp), bins=
-00023ec0: 3530 2c20 6465 6e73 6974 793d 5472 7565  50, density=True
-00023ed0: 290d 0a20 203e 3e3e 2070 6c74 2e70 6c6f  )..  >>> plt.plo
-00023ee0: 7428 7878 2c70 6f77 7064 662c 2772 2d27  t(xx,powpdf,'r-'
-00023ef0: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
-00023f00: 4b49 500d 0a20 203e 3e3e 2070 6c74 2e74  KIP..  >>> plt.t
-00023f10: 6974 6c65 2827 696e 7665 7273 6520 6f66  itle('inverse of
-00023f20: 2073 7461 7473 2e70 6172 6574 6f28 3529   stats.pareto(5)
-00023f30: 2729 0d0a 2020 2222 220d 0a20 2072 6574  ')..  """..  ret
-00023f40: 7572 6e20 4445 4641 554c 542e 706f 7765  urn DEFAULT.powe
-00023f50: 7228 612c 2073 697a 652c 206b 6579 3d6b  r(a, size, key=k
-00023f60: 6579 2c20 6474 7970 653d 6474 7970 6529  ey, dtype=dtype)
-00023f70: 0d0a 0d0a 0d0a 6465 6620 7261 796c 6569  ......def raylei
-00023f80: 6768 2873 6361 6c65 3d31 2e30 2c0d 0a20  gh(scale=1.0,.. 
-00023f90: 2020 2020 2020 2020 2020 2020 7369 7a65              size
-00023fa0: 3a20 4f70 7469 6f6e 616c 5b53 697a 655d  : Optional[Size]
-00023fb0: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
-00023fc0: 2020 2020 2020 206b 6579 3a20 4f70 7469         key: Opti
-00023fd0: 6f6e 616c 5b53 6565 644f 724b 6579 5d20  onal[SeedOrKey] 
-00023fe0: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 2020  = None,..       
-00023ff0: 2020 2020 2020 6474 7970 653a 2044 5479        dtype: DTy
-00024000: 7065 4c69 6b65 203d 204e 6f6e 6529 3a0d  peLike = None):.
-00024010: 0a20 2072 2222 220d 0a20 2044 7261 7720  .  r"""..  Draw 
-00024020: 7361 6d70 6c65 7320 6672 6f6d 2061 2052  samples from a R
-00024030: 6179 6c65 6967 6820 6469 7374 7269 6275  ayleigh distribu
-00024040: 7469 6f6e 2e0d 0a0d 0a20 2054 6865 203a  tion.....  The :
-00024050: 6d61 7468 3a60 5c63 6869 6020 616e 6420  math:`\chi` and 
-00024060: 5765 6962 756c 6c20 6469 7374 7269 6275  Weibull distribu
-00024070: 7469 6f6e 7320 6172 6520 6765 6e65 7261  tions are genera
-00024080: 6c69 7a61 7469 6f6e 7320 6f66 2074 6865  lizations of the
-00024090: 0d0a 2020 5261 796c 6569 6768 2e0d 0a0d  ..  Rayleigh....
-000240a0: 0a20 2050 6172 616d 6574 6572 730d 0a20  .  Parameters.. 
-000240b0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2073   ----------..  s
-000240c0: 6361 6c65 203a 2066 6c6f 6174 206f 7220  cale : float or 
-000240d0: 6172 7261 795f 6c69 6b65 206f 6620 666c  array_like of fl
-000240e0: 6f61 7473 2c20 6f70 7469 6f6e 616c 0d0a  oats, optional..
-000240f0: 2020 2020 2020 5363 616c 652c 2061 6c73        Scale, als
-00024100: 6f20 6571 7561 6c73 2074 6865 206d 6f64  o equals the mod
-00024110: 652e 204d 7573 7420 6265 206e 6f6e 2d6e  e. Must be non-n
-00024120: 6567 6174 6976 652e 2044 6566 6175 6c74  egative. Default
-00024130: 2069 7320 312e 0d0a 2020 7369 7a65 203a   is 1...  size :
-00024140: 2069 6e74 206f 7220 7475 706c 6520 6f66   int or tuple of
-00024150: 2069 6e74 732c 206f 7074 696f 6e61 6c0d   ints, optional.
-00024160: 0a20 2020 2020 204f 7574 7075 7420 7368  .      Output sh
-00024170: 6170 652e 2020 4966 2074 6865 2067 6976  ape.  If the giv
-00024180: 656e 2073 6861 7065 2069 732c 2065 2e67  en shape is, e.g
-00024190: 2e2c 2060 6028 6d2c 206e 2c20 6b29 6060  ., ``(m, n, k)``
-000241a0: 2c20 7468 656e 0d0a 2020 2020 2020 6060  , then..      ``
-000241b0: 6d20 2a20 6e20 2a20 6b60 6020 7361 6d70  m * n * k`` samp
-000241c0: 6c65 7320 6172 6520 6472 6177 6e2e 2020  les are drawn.  
-000241d0: 4966 2073 697a 6520 6973 2060 604e 6f6e  If size is ``Non
-000241e0: 6560 6020 2864 6566 6175 6c74 292c 0d0a  e`` (default),..
-000241f0: 2020 2020 2020 6120 7369 6e67 6c65 2076        a single v
-00024200: 616c 7565 2069 7320 7265 7475 726e 6564  alue is returned
-00024210: 2069 6620 6060 7363 616c 6560 6020 6973   if ``scale`` is
-00024220: 2061 2073 6361 6c61 722e 2020 4f74 6865   a scalar.  Othe
-00024230: 7277 6973 652c 0d0a 2020 2020 2020 6060  rwise,..      ``
-00024240: 6e70 2e61 7272 6179 2873 6361 6c65 292e  np.array(scale).
-00024250: 7369 7a65 6060 2073 616d 706c 6573 2061  size`` samples a
-00024260: 7265 2064 7261 776e 2e0d 0a20 206b 6579  re drawn...  key
-00024270: 203a 2050 524e 474b 6579 2c20 6f70 7469   : PRNGKey, opti
-00024280: 6f6e 616c 0d0a 2020 2020 2020 5468 6520  onal..      The 
-00024290: 6b65 7920 666f 7220 7468 6520 7261 6e64  key for the rand
-000242a0: 6f6d 206e 756d 6265 7220 6765 6e65 7261  om number genera
-000242b0: 746f 722e 2049 6620 6e6f 7420 6769 7665  tor. If not give
-000242c0: 6e2c 2074 6865 0d0a 2020 2020 2020 6465  n, the..      de
-000242d0: 6661 756c 7420 7261 6e64 6f6d 206e 756d  fault random num
-000242e0: 6265 7220 6765 6e65 7261 746f 7220 6973  ber generator is
-000242f0: 2075 7365 642e 0d0a 0d0a 2020 5265 7475   used.....  Retu
-00024300: 726e 730d 0a20 202d 2d2d 2d2d 2d2d 0d0a  rns..  -------..
-00024310: 2020 6f75 7420 3a20 6e64 6172 7261 7920    out : ndarray 
-00024320: 6f72 2073 6361 6c61 720d 0a20 2020 2020  or scalar..     
-00024330: 2044 7261 776e 2073 616d 706c 6573 2066   Drawn samples f
-00024340: 726f 6d20 7468 6520 7061 7261 6d65 7465  rom the paramete
-00024350: 7269 7a65 6420 5261 796c 6569 6768 2064  rized Rayleigh d
-00024360: 6973 7472 6962 7574 696f 6e2e 0d0a 0d0a  istribution.....
-00024370: 2020 4e6f 7465 730d 0a20 202d 2d2d 2d2d    Notes..  -----
-00024380: 0d0a 2020 5468 6520 7072 6f62 6162 696c  ..  The probabil
-00024390: 6974 7920 6465 6e73 6974 7920 6675 6e63  ity density func
-000243a0: 7469 6f6e 2066 6f72 2074 6865 2052 6179  tion for the Ray
-000243b0: 6c65 6967 6820 6469 7374 7269 6275 7469  leigh distributi
-000243c0: 6f6e 2069 730d 0a0d 0a20 202e 2e20 6d61  on is....  .. ma
-000243d0: 7468 3a3a 2050 2878 3b73 6361 6c65 2920  th:: P(x;scale) 
-000243e0: 3d20 5c66 7261 637b 787d 7b73 6361 6c65  = \frac{x}{scale
-000243f0: 5e32 7d65 5e7b 5c66 7261 637b 2d78 5e32  ^2}e^{\frac{-x^2
-00024400: 7d7b 3220 5c63 646f 7470 2073 6361 6c65  }{2 \cdotp scale
-00024410: 5e32 7d7d 0d0a 0d0a 2020 5468 6520 5261  ^2}}....  The Ra
-00024420: 796c 6569 6768 2064 6973 7472 6962 7574  yleigh distribut
-00024430: 696f 6e20 776f 756c 6420 6172 6973 652c  ion would arise,
-00024440: 2066 6f72 2065 7861 6d70 6c65 2c20 6966   for example, if
-00024450: 2074 6865 2045 6173 740d 0a20 2061 6e64   the East..  and
-00024460: 204e 6f72 7468 2063 6f6d 706f 6e65 6e74   North component
-00024470: 7320 6f66 2074 6865 2077 696e 6420 7665  s of the wind ve
-00024480: 6c6f 6369 7479 2068 6164 2069 6465 6e74  locity had ident
-00024490: 6963 616c 207a 6572 6f2d 6d65 616e 0d0a  ical zero-mean..
-000244a0: 2020 4761 7573 7369 616e 2064 6973 7472    Gaussian distr
-000244b0: 6962 7574 696f 6e73 2e20 2054 6865 6e20  ibutions.  Then 
-000244c0: 7468 6520 7769 6e64 2073 7065 6564 2077  the wind speed w
-000244d0: 6f75 6c64 2068 6176 6520 6120 5261 796c  ould have a Rayl
-000244e0: 6569 6768 0d0a 2020 6469 7374 7269 6275  eigh..  distribu
-000244f0: 7469 6f6e 2e0d 0a0d 0a20 2052 6566 6572  tion.....  Refer
-00024500: 656e 6365 730d 0a20 202d 2d2d 2d2d 2d2d  ences..  -------
-00024510: 2d2d 2d0d 0a20 202e 2e20 5b31 5d20 4272  ---..  .. [1] Br
-00024520: 6967 6874 6f6e 2057 6562 7320 4c74 642e  ighton Webs Ltd.
-00024530: 2c20 2252 6179 6c65 6967 6820 4469 7374  , "Rayleigh Dist
-00024540: 7269 6275 7469 6f6e 2c22 0d0a 2020 2020  ribution,"..    
-00024550: 2020 2020 2068 7474 7073 3a2f 2f77 6562       https://web
-00024560: 2e61 7263 6869 7665 2e6f 7267 2f77 6562  .archive.org/web
-00024570: 2f32 3030 3930 3531 3430 3931 3432 342f  /20090514091424/
-00024580: 6874 7470 3a2f 2f62 7269 6768 746f 6e2d  http://brighton-
-00024590: 7765 6273 2e63 6f2e 756b 3a38 302f 6469  webs.co.uk:80/di
-000245a0: 7374 7269 6275 7469 6f6e 732f 7261 796c  stributions/rayl
-000245b0: 6569 6768 2e61 7370 0d0a 2020 2e2e 205b  eigh.asp..  .. [
-000245c0: 325d 2057 696b 6970 6564 6961 2c20 2252  2] Wikipedia, "R
-000245d0: 6179 6c65 6967 6820 6469 7374 7269 6275  ayleigh distribu
-000245e0: 7469 6f6e 220d 0a20 2020 2020 2020 2020  tion"..         
-000245f0: 6874 7470 733a 2f2f 656e 2e77 696b 6970  https://en.wikip
-00024600: 6564 6961 2e6f 7267 2f77 696b 692f 5261  edia.org/wiki/Ra
-00024610: 796c 6569 6768 5f64 6973 7472 6962 7574  yleigh_distribut
-00024620: 696f 6e0d 0a0d 0a20 2045 7861 6d70 6c65  ion....  Example
-00024630: 730d 0a20 202d 2d2d 2d2d 2d2d 2d0d 0a20  s..  --------.. 
-00024640: 2044 7261 7720 7661 6c75 6573 2066 726f   Draw values fro
-00024650: 6d20 7468 6520 6469 7374 7269 6275 7469  m the distributi
-00024660: 6f6e 2061 6e64 2070 6c6f 7420 7468 6520  on and plot the 
-00024670: 6869 7374 6f67 7261 6d0d 0a0d 0a20 203e  histogram....  >
-00024680: 3e3e 2066 726f 6d20 6d61 7470 6c6f 746c  >> from matplotl
-00024690: 6962 2e70 7970 6c6f 7420 696d 706f 7274  ib.pyplot import
-000246a0: 2068 6973 7420 2023 206e 6f71 610d 0a20   hist  # noqa.. 
-000246b0: 203e 3e3e 2076 616c 7565 7320 3d20 6869   >>> values = hi
-000246c0: 7374 2862 632e 7261 6e64 6f6d 2e72 6179  st(bc.random.ray
-000246d0: 6c65 6967 6828 332c 2031 3030 3030 3029  leigh(3, 100000)
-000246e0: 2c20 6269 6e73 3d32 3030 2c20 6465 6e73  , bins=200, dens
-000246f0: 6974 793d 5472 7565 290d 0a0d 0a20 2057  ity=True)....  W
-00024700: 6176 6520 6865 6967 6874 7320 7465 6e64  ave heights tend
-00024710: 2074 6f20 666f 6c6c 6f77 2061 2052 6179   to follow a Ray
-00024720: 6c65 6967 6820 6469 7374 7269 6275 7469  leigh distributi
-00024730: 6f6e 2e20 4966 2074 6865 206d 6561 6e20  on. If the mean 
-00024740: 7761 7665 0d0a 2020 6865 6967 6874 2069  wave..  height i
-00024750: 7320 3120 6d65 7465 722c 2077 6861 7420  s 1 meter, what 
-00024760: 6672 6163 7469 6f6e 206f 6620 7761 7665  fraction of wave
-00024770: 7320 6172 6520 6c69 6b65 6c79 2074 6f20  s are likely to 
-00024780: 6265 206c 6172 6765 7220 7468 616e 2033  be larger than 3
-00024790: 0d0a 2020 6d65 7465 7273 3f0d 0a0d 0a20  ..  meters?.... 
-000247a0: 203e 3e3e 206d 6561 6e76 616c 7565 203d   >>> meanvalue =
-000247b0: 2031 0d0a 2020 3e3e 3e20 6d6f 6465 7661   1..  >>> modeva
-000247c0: 6c75 6520 3d20 6e70 2e73 7172 7428 3220  lue = np.sqrt(2 
-000247d0: 2f20 6e70 2e70 6929 202a 206d 6561 6e76  / np.pi) * meanv
-000247e0: 616c 7565 0d0a 2020 3e3e 3e20 7320 3d20  alue..  >>> s = 
-000247f0: 6263 2e72 616e 646f 6d2e 7261 796c 6569  bc.random.raylei
-00024800: 6768 286d 6f64 6576 616c 7565 2c20 3130  gh(modevalue, 10
-00024810: 3030 3030 3029 0d0a 0d0a 2020 5468 6520  00000)....  The 
-00024820: 7065 7263 656e 7461 6765 206f 6620 7761  percentage of wa
-00024830: 7665 7320 6c61 7267 6572 2074 6861 6e20  ves larger than 
-00024840: 3320 6d65 7465 7273 2069 733a 0d0a 0d0a  3 meters is:....
-00024850: 2020 3e3e 3e20 3130 302e 2a73 756d 2873    >>> 100.*sum(s
-00024860: 3e33 292f 3130 3030 3030 302e 0d0a 2020  >3)/1000000...  
-00024870: 302e 3038 3733 3030 3030 3030 3030 3030  0.08730000000000
-00024880: 3030 3033 2023 2072 616e 646f 6d0d 0a20  0003 # random.. 
-00024890: 2022 2222 0d0a 2020 7265 7475 726e 2044   """..  return D
-000248a0: 4546 4155 4c54 2e72 6179 6c65 6967 6828  EFAULT.rayleigh(
-000248b0: 7363 616c 652c 2073 697a 652c 206b 6579  scale, size, key
-000248c0: 3d6b 6579 2c20 6474 7970 653d 6474 7970  =key, dtype=dtyp
-000248d0: 6529 0d0a 0d0a 0d0a 6465 6620 7472 6961  e)......def tria
-000248e0: 6e67 756c 6172 2873 697a 653a 204f 7074  ngular(size: Opt
-000248f0: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
-00024900: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
-00024910: 2020 2020 6b65 793a 204f 7074 696f 6e61      key: Optiona
-00024920: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
-00024930: 6f6e 6529 3a0d 0a20 2072 2222 220d 0a20  one):..  r""".. 
-00024940: 2044 7261 7720 7361 6d70 6c65 7320 6672   Draw samples fr
-00024950: 6f6d 2074 6865 2074 7269 616e 6775 6c61  om the triangula
-00024960: 7220 6469 7374 7269 6275 7469 6f6e 206f  r distribution o
-00024970: 7665 7220 7468 650d 0a20 2069 6e74 6572  ver the..  inter
-00024980: 7661 6c20 6060 5b6c 6566 742c 2072 6967  val ``[left, rig
-00024990: 6874 5d60 602e 0d0a 0d0a 2020 5468 6520  ht]``.....  The 
-000249a0: 7472 6961 6e67 756c 6172 2064 6973 7472  triangular distr
-000249b0: 6962 7574 696f 6e20 6973 2061 2063 6f6e  ibution is a con
-000249c0: 7469 6e75 6f75 7320 7072 6f62 6162 696c  tinuous probabil
-000249d0: 6974 790d 0a20 2064 6973 7472 6962 7574  ity..  distribut
-000249e0: 696f 6e20 7769 7468 206c 6f77 6572 206c  ion with lower l
-000249f0: 696d 6974 206c 6566 742c 2070 6561 6b20  imit left, peak 
-00024a00: 6174 206d 6f64 652c 2061 6e64 2075 7070  at mode, and upp
-00024a10: 6572 0d0a 2020 6c69 6d69 7420 7269 6768  er..  limit righ
-00024a20: 742e 2055 6e6c 696b 6520 7468 6520 6f74  t. Unlike the ot
-00024a30: 6865 7220 6469 7374 7269 6275 7469 6f6e  her distribution
-00024a40: 732c 2074 6865 7365 2070 6172 616d 6574  s, these paramet
-00024a50: 6572 730d 0a20 2064 6972 6563 746c 7920  ers..  directly 
-00024a60: 6465 6669 6e65 2074 6865 2073 6861 7065  define the shape
-00024a70: 206f 6620 7468 6520 7064 662e 0d0a 0d0a   of the pdf.....
-00024a80: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-00024a90: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 7369  ----------..  si
-00024aa0: 7a65 203a 2069 6e74 206f 7220 7475 706c  ze : int or tupl
-00024ab0: 6520 6f66 2069 6e74 732c 206f 7074 696f  e of ints, optio
-00024ac0: 6e61 6c0d 0a20 2020 2020 204f 7574 7075  nal..      Outpu
-00024ad0: 7420 7368 6170 652e 2020 4966 2074 6865  t shape.  If the
-00024ae0: 2067 6976 656e 2073 6861 7065 2069 732c   given shape is,
-00024af0: 2065 2e67 2e2c 2060 6028 6d2c 206e 2c20   e.g., ``(m, n, 
-00024b00: 6b29 6060 2c20 7468 656e 0d0a 2020 2020  k)``, then..    
-00024b10: 2020 6060 6d20 2a20 6e20 2a20 6b60 6020    ``m * n * k`` 
-00024b20: 7361 6d70 6c65 7320 6172 6520 6472 6177  samples are draw
-00024b30: 6e2e 2020 4966 2073 697a 6520 6973 2060  n.  If size is `
-00024b40: 604e 6f6e 6560 6020 2864 6566 6175 6c74  `None`` (default
-00024b50: 292c 0d0a 2020 2020 2020 6120 7369 6e67  ),..      a sing
-00024b60: 6c65 2076 616c 7565 2069 7320 7265 7475  le value is retu
-00024b70: 726e 6564 2069 6620 6060 6c65 6674 6060  rned if ``left``
-00024b80: 2c20 6060 6d6f 6465 6060 2c20 616e 6420  , ``mode``, and 
-00024b90: 6060 7269 6768 7460 600d 0a20 2020 2020  ``right``..     
-00024ba0: 2061 7265 2061 6c6c 2073 6361 6c61 7273   are all scalars
-00024bb0: 2e20 204f 7468 6572 7769 7365 2c20 6060  .  Otherwise, ``
-00024bc0: 6e70 2e62 726f 6164 6361 7374 286c 6566  np.broadcast(lef
-00024bd0: 742c 206d 6f64 652c 2072 6967 6874 292e  t, mode, right).
-00024be0: 7369 7a65 6060 0d0a 2020 2020 2020 7361  size``..      sa
-00024bf0: 6d70 6c65 7320 6172 6520 6472 6177 6e2e  mples are drawn.
-00024c00: 0d0a 2020 6b65 7920 3a20 5052 4e47 4b65  ..  key : PRNGKe
-00024c10: 792c 206f 7074 696f 6e61 6c0d 0a20 2020  y, optional..   
-00024c20: 2020 2054 6865 206b 6579 2066 6f72 2074     The key for t
-00024c30: 6865 2072 616e 646f 6d20 6e75 6d62 6572  he random number
-00024c40: 2067 656e 6572 6174 6f72 2e20 4966 206e   generator. If n
-00024c50: 6f74 2067 6976 656e 2c20 7468 650d 0a20  ot given, the.. 
-00024c60: 2020 2020 2064 6566 6175 6c74 2072 616e       default ran
-00024c70: 646f 6d20 6e75 6d62 6572 2067 656e 6572  dom number gener
-00024c80: 6174 6f72 2069 7320 7573 6564 2e0d 0a0d  ator is used....
-00024c90: 0a20 2052 6574 7572 6e73 0d0a 2020 2d2d  .  Returns..  --
-00024ca0: 2d2d 2d2d 2d0d 0a20 206f 7574 203a 206e  -----..  out : n
-00024cb0: 6461 7272 6179 206f 7220 7363 616c 6172  darray or scalar
-00024cc0: 0d0a 2020 2020 2020 4472 6177 6e20 7361  ..      Drawn sa
-00024cd0: 6d70 6c65 7320 6672 6f6d 2074 6865 2070  mples from the p
-00024ce0: 6172 616d 6574 6572 697a 6564 2074 7269  arameterized tri
-00024cf0: 616e 6775 6c61 7220 6469 7374 7269 6275  angular distribu
-00024d00: 7469 6f6e 2e0d 0a0d 0a20 204e 6f74 6573  tion.....  Notes
-00024d10: 0d0a 2020 2d2d 2d2d 2d0d 0a20 2054 6865  ..  -----..  The
-00024d20: 2070 726f 6261 6269 6c69 7479 2064 656e   probability den
-00024d30: 7369 7479 2066 756e 6374 696f 6e20 666f  sity function fo
-00024d40: 7220 7468 6520 7472 6961 6e67 756c 6172  r the triangular
-00024d50: 2064 6973 7472 6962 7574 696f 6e20 6973   distribution is
-00024d60: 0d0a 0d0a 2020 2e2e 206d 6174 683a 3a20  ....  .. math:: 
-00024d70: 5028 783b 6c2c 206d 2c20 7229 203d 205c  P(x;l, m, r) = \
-00024d80: 6265 6769 6e7b 6361 7365 737d 0d0a 2020  begin{cases}..  
-00024d90: 2020 2020 2020 2020 2020 5c66 7261 637b            \frac{
-00024da0: 3228 782d 6c29 7d7b 2872 2d6c 2928 6d2d  2(x-l)}{(r-l)(m-
-00024db0: 6c29 7d26 205c 7465 7874 7b66 6f72 2024  l)}& \text{for $
-00024dc0: 6c20 5c6c 6571 2078 205c 6c65 7120 6d24  l \leq x \leq m$
-00024dd0: 7d2c 5c5c 0d0a 2020 2020 2020 2020 2020  },\\..          
-00024de0: 2020 5c66 7261 637b 3228 722d 7829 7d7b    \frac{2(r-x)}{
-00024df0: 2872 2d6c 2928 722d 6d29 7d26 205c 7465  (r-l)(r-m)}& \te
-00024e00: 7874 7b66 6f72 2024 6d20 5c6c 6571 2078  xt{for $m \leq x
-00024e10: 205c 6c65 7120 7224 7d2c 5c5c 0d0a 2020   \leq r$},\\..  
-00024e20: 2020 2020 2020 2020 2020 3026 205c 7465            0& \te
-00024e30: 7874 7b6f 7468 6572 7769 7365 7d2e 0d0a  xt{otherwise}...
-00024e40: 2020 2020 2020 2020 2020 2020 5c65 6e64              \end
-00024e50: 7b63 6173 6573 7d0d 0a0d 0a20 2054 6865  {cases}....  The
-00024e60: 2074 7269 616e 6775 6c61 7220 6469 7374   triangular dist
-00024e70: 7269 6275 7469 6f6e 2069 7320 6f66 7465  ribution is ofte
-00024e80: 6e20 7573 6564 2069 6e20 696c 6c2d 6465  n used in ill-de
-00024e90: 6669 6e65 640d 0a20 2070 726f 626c 656d  fined..  problem
-00024ea0: 7320 7768 6572 6520 7468 6520 756e 6465  s where the unde
-00024eb0: 726c 7969 6e67 2064 6973 7472 6962 7574  rlying distribut
-00024ec0: 696f 6e20 6973 206e 6f74 206b 6e6f 776e  ion is not known
-00024ed0: 2c20 6275 740d 0a20 2073 6f6d 6520 6b6e  , but..  some kn
-00024ee0: 6f77 6c65 6467 6520 6f66 2074 6865 206c  owledge of the l
-00024ef0: 696d 6974 7320 616e 6420 6d6f 6465 2065  imits and mode e
-00024f00: 7869 7374 732e 204f 6674 656e 2069 7420  xists. Often it 
-00024f10: 6973 2075 7365 640d 0a20 2069 6e20 7369  is used..  in si
-00024f20: 6d75 6c61 7469 6f6e 732e 0d0a 0d0a 2020  mulations.....  
-00024f30: 5265 6665 7265 6e63 6573 0d0a 2020 2d2d  References..  --
-00024f40: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2e2e 205b  --------..  .. [
-00024f50: 315d 2057 696b 6970 6564 6961 2c20 2254  1] Wikipedia, "T
-00024f60: 7269 616e 6775 6c61 7220 6469 7374 7269  riangular distri
-00024f70: 6275 7469 6f6e 220d 0a20 2020 2020 2020  bution"..       
-00024f80: 2020 6874 7470 733a 2f2f 656e 2e77 696b    https://en.wik
-00024f90: 6970 6564 6961 2e6f 7267 2f77 696b 692f  ipedia.org/wiki/
-00024fa0: 5472 6961 6e67 756c 6172 5f64 6973 7472  Triangular_distr
-00024fb0: 6962 7574 696f 6e0d 0a0d 0a20 2045 7861  ibution....  Exa
-00024fc0: 6d70 6c65 730d 0a20 202d 2d2d 2d2d 2d2d  mples..  -------
-00024fd0: 2d0d 0a20 2044 7261 7720 7661 6c75 6573  -..  Draw values
-00024fe0: 2066 726f 6d20 7468 6520 6469 7374 7269   from the distri
-00024ff0: 6275 7469 6f6e 2061 6e64 2070 6c6f 7420  bution and plot 
-00025000: 7468 6520 6869 7374 6f67 7261 6d3a 0d0a  the histogram:..
-00025010: 0d0a 2020 3e3e 3e20 696d 706f 7274 206d  ..  >>> import m
-00025020: 6174 706c 6f74 6c69 622e 7079 706c 6f74  atplotlib.pyplot
-00025030: 2061 7320 706c 7420 2023 206e 6f71 610d   as plt  # noqa.
-00025040: 0a20 203e 3e3e 2068 203d 2070 6c74 2e68  .  >>> h = plt.h
-00025050: 6973 7428 6263 2e72 616e 646f 6d2e 7472  ist(bc.random.tr
-00025060: 6961 6e67 756c 6172 282d 332c 2030 2c20  iangular(-3, 0, 
-00025070: 382c 2031 3030 3030 3029 2c20 6269 6e73  8, 100000), bins
-00025080: 3d32 3030 2c0d 0a20 202e 2e2e 2020 2020  =200,..  ...    
-00025090: 2020 2020 2020 2020 2020 6465 6e73 6974            densit
-000250a0: 793d 5472 7565 290d 0a20 203e 3e3e 2070  y=True)..  >>> p
-000250b0: 6c74 2e73 686f 7728 290d 0a20 2022 2222  lt.show()..  """
-000250c0: 0d0a 2020 7265 7475 726e 2044 4546 4155  ..  return DEFAU
-000250d0: 4c54 2e74 7269 616e 6775 6c61 7228 7369  LT.triangular(si
-000250e0: 7a65 2c20 6b65 793d 6b65 7929 0d0a 0d0a  ze, key=key)....
-000250f0: 0d0a 6465 6620 766f 6e6d 6973 6573 286d  ..def vonmises(m
-00025100: 752c 0d0a 2020 2020 2020 2020 2020 2020  u,..            
-00025110: 206b 6170 7061 2c0d 0a20 2020 2020 2020   kappa,..       
-00025120: 2020 2020 2020 7369 7a65 3a20 4f70 7469        size: Opti
-00025130: 6f6e 616c 5b53 697a 655d 203d 204e 6f6e  onal[Size] = Non
-00025140: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
-00025150: 206b 6579 3a20 4f70 7469 6f6e 616c 5b53   key: Optional[S
-00025160: 6565 644f 724b 6579 5d20 3d20 4e6f 6e65  eedOrKey] = None
-00025170: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00025180: 6474 7970 653a 2044 5479 7065 4c69 6b65  dtype: DTypeLike
-00025190: 203d 204e 6f6e 6529 3a0d 0a20 2072 2222   = None):..  r""
-000251a0: 220d 0a20 2044 7261 7720 7361 6d70 6c65  "..  Draw sample
-000251b0: 7320 6672 6f6d 2061 2076 6f6e 204d 6973  s from a von Mis
-000251c0: 6573 2064 6973 7472 6962 7574 696f 6e2e  es distribution.
-000251d0: 0d0a 0d0a 2020 5361 6d70 6c65 7320 6172  ....  Samples ar
-000251e0: 6520 6472 6177 6e20 6672 6f6d 2061 2076  e drawn from a v
-000251f0: 6f6e 204d 6973 6573 2064 6973 7472 6962  on Mises distrib
-00025200: 7574 696f 6e20 7769 7468 2073 7065 6369  ution with speci
-00025210: 6669 6564 206d 6f64 650d 0a20 2028 6d75  fied mode..  (mu
-00025220: 2920 616e 6420 6469 7370 6572 7369 6f6e  ) and dispersion
-00025230: 2028 6b61 7070 6129 2c20 6f6e 2074 6865   (kappa), on the
-00025240: 2069 6e74 6572 7661 6c20 5b2d 7069 2c20   interval [-pi, 
-00025250: 7069 5d2e 0d0a 0d0a 2020 5468 6520 766f  pi].....  The vo
-00025260: 6e20 4d69 7365 7320 6469 7374 7269 6275  n Mises distribu
-00025270: 7469 6f6e 2028 616c 736f 206b 6e6f 776e  tion (also known
-00025280: 2061 7320 7468 6520 6369 7263 756c 6172   as the circular
-00025290: 206e 6f72 6d61 6c0d 0a20 2064 6973 7472   normal..  distr
-000252a0: 6962 7574 696f 6e29 2069 7320 6120 636f  ibution) is a co
-000252b0: 6e74 696e 756f 7573 2070 726f 6261 6269  ntinuous probabi
-000252c0: 6c69 7479 2064 6973 7472 6962 7574 696f  lity distributio
-000252d0: 6e20 6f6e 2074 6865 2075 6e69 740d 0a20  n on the unit.. 
-000252e0: 2063 6972 636c 652e 2020 4974 206d 6179   circle.  It may
-000252f0: 2062 6520 7468 6f75 6768 7420 6f66 2061   be thought of a
-00025300: 7320 7468 6520 6369 7263 756c 6172 2061  s the circular a
-00025310: 6e61 6c6f 6775 6520 6f66 2074 6865 206e  nalogue of the n
-00025320: 6f72 6d61 6c0d 0a20 2064 6973 7472 6962  ormal..  distrib
-00025330: 7574 696f 6e2e 0d0a 0d0a 2020 5061 7261  ution.....  Para
-00025340: 6d65 7465 7273 0d0a 2020 2d2d 2d2d 2d2d  meters..  ------
-00025350: 2d2d 2d2d 0d0a 2020 6d75 203a 2066 6c6f  ----..  mu : flo
-00025360: 6174 206f 7220 6172 7261 795f 6c69 6b65  at or array_like
-00025370: 206f 6620 666c 6f61 7473 0d0a 2020 2020   of floats..    
-00025380: 2020 4d6f 6465 2028 2263 656e 7465 7222    Mode ("center"
-00025390: 2920 6f66 2074 6865 2064 6973 7472 6962  ) of the distrib
-000253a0: 7574 696f 6e2e 0d0a 2020 6b61 7070 6120  ution...  kappa 
-000253b0: 3a20 666c 6f61 7420 6f72 2061 7272 6179  : float or array
-000253c0: 5f6c 696b 6520 6f66 2066 6c6f 6174 730d  _like of floats.
-000253d0: 0a20 2020 2020 2044 6973 7065 7273 696f  .      Dispersio
-000253e0: 6e20 6f66 2074 6865 2064 6973 7472 6962  n of the distrib
-000253f0: 7574 696f 6e2c 2068 6173 2074 6f20 6265  ution, has to be
-00025400: 203e 3d30 2e0d 0a20 2073 697a 6520 3a20   >=0...  size : 
-00025410: 696e 7420 6f72 2074 7570 6c65 206f 6620  int or tuple of 
-00025420: 696e 7473 2c20 6f70 7469 6f6e 616c 0d0a  ints, optional..
-00025430: 2020 2020 2020 4f75 7470 7574 2073 6861        Output sha
-00025440: 7065 2e20 2049 6620 7468 6520 6769 7665  pe.  If the give
-00025450: 6e20 7368 6170 6520 6973 2c20 652e 672e  n shape is, e.g.
-00025460: 2c20 6060 286d 2c20 6e2c 206b 2960 602c  , ``(m, n, k)``,
-00025470: 2074 6865 6e0d 0a20 2020 2020 2060 606d   then..      ``m
-00025480: 202a 206e 202a 206b 6060 2073 616d 706c   * n * k`` sampl
-00025490: 6573 2061 7265 2064 7261 776e 2e20 2049  es are drawn.  I
-000254a0: 6620 7369 7a65 2069 7320 6060 4e6f 6e65  f size is ``None
-000254b0: 6060 2028 6465 6661 756c 7429 2c0d 0a20  `` (default),.. 
-000254c0: 2020 2020 2061 2073 696e 676c 6520 7661       a single va
-000254d0: 6c75 6520 6973 2072 6574 7572 6e65 6420  lue is returned 
-000254e0: 6966 2060 606d 7560 6020 616e 6420 6060  if ``mu`` and ``
-000254f0: 6b61 7070 6160 6020 6172 6520 626f 7468  kappa`` are both
-00025500: 2073 6361 6c61 7273 2e0d 0a20 2020 2020   scalars...     
-00025510: 204f 7468 6572 7769 7365 2c20 6060 6e70   Otherwise, ``np
-00025520: 2e62 726f 6164 6361 7374 286d 752c 206b  .broadcast(mu, k
-00025530: 6170 7061 292e 7369 7a65 6060 2073 616d  appa).size`` sam
-00025540: 706c 6573 2061 7265 2064 7261 776e 2e0d  ples are drawn..
-00025550: 0a20 206b 6579 203a 2050 524e 474b 6579  .  key : PRNGKey
-00025560: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-00025570: 2020 5468 6520 6b65 7920 666f 7220 7468    The key for th
-00025580: 6520 7261 6e64 6f6d 206e 756d 6265 7220  e random number 
-00025590: 6765 6e65 7261 746f 722e 2049 6620 6e6f  generator. If no
-000255a0: 7420 6769 7665 6e2c 2074 6865 0d0a 2020  t given, the..  
-000255b0: 2020 2020 6465 6661 756c 7420 7261 6e64      default rand
-000255c0: 6f6d 206e 756d 6265 7220 6765 6e65 7261  om number genera
-000255d0: 746f 7220 6973 2075 7365 642e 0d0a 0d0a  tor is used.....
-000255e0: 2020 5265 7475 726e 730d 0a20 202d 2d2d    Returns..  ---
-000255f0: 2d2d 2d2d 0d0a 2020 6f75 7420 3a20 6e64  ----..  out : nd
-00025600: 6172 7261 7920 6f72 2073 6361 6c61 720d  array or scalar.
-00025610: 0a20 2020 2020 2044 7261 776e 2073 616d  .      Drawn sam
-00025620: 706c 6573 2066 726f 6d20 7468 6520 7061  ples from the pa
-00025630: 7261 6d65 7465 7269 7a65 6420 766f 6e20  rameterized von 
-00025640: 4d69 7365 7320 6469 7374 7269 6275 7469  Mises distributi
-00025650: 6f6e 2e0d 0a0d 0a20 2053 6565 2041 6c73  on.....  See Als
-00025660: 6f0d 0a20 202d 2d2d 2d2d 2d2d 2d0d 0a20  o..  --------.. 
-00025670: 2073 6369 7079 2e73 7461 7473 2e76 6f6e   scipy.stats.von
-00025680: 6d69 7365 7320 3a20 7072 6f62 6162 696c  mises : probabil
-00025690: 6974 7920 6465 6e73 6974 7920 6675 6e63  ity density func
-000256a0: 7469 6f6e 2c20 6469 7374 7269 6275 7469  tion, distributi
-000256b0: 6f6e 2c20 6f72 0d0a 2020 2020 2020 6375  on, or..      cu
-000256c0: 6d75 6c61 7469 7665 2064 656e 7369 7479  mulative density
-000256d0: 2066 756e 6374 696f 6e2c 2065 7463 2e0d   function, etc..
-000256e0: 0a0d 0a20 204e 6f74 6573 0d0a 2020 2d2d  ...  Notes..  --
-000256f0: 2d2d 2d0d 0a20 2054 6865 2070 726f 6261  ---..  The proba
-00025700: 6269 6c69 7479 2064 656e 7369 7479 2066  bility density f
-00025710: 6f72 2074 6865 2076 6f6e 204d 6973 6573  or the von Mises
-00025720: 2064 6973 7472 6962 7574 696f 6e20 6973   distribution is
-00025730: 0d0a 0d0a 2020 2e2e 206d 6174 683a 3a20  ....  .. math:: 
-00025740: 7028 7829 203d 205c 6672 6163 7b65 5e7b  p(x) = \frac{e^{
-00025750: 5c6b 6170 7061 2063 6f73 2878 2d5c 6d75  \kappa cos(x-\mu
-00025760: 297d 7d7b 325c 7069 2049 5f30 285c 6b61  )}}{2\pi I_0(\ka
-00025770: 7070 6129 7d2c 0d0a 0d0a 2020 7768 6572  ppa)},....  wher
-00025780: 6520 3a6d 6174 683a 605c 6d75 6020 6973  e :math:`\mu` is
-00025790: 2074 6865 206d 6f64 6520 616e 6420 3a6d   the mode and :m
-000257a0: 6174 683a 605c 6b61 7070 6160 2074 6865  ath:`\kappa` the
-000257b0: 2064 6973 7065 7273 696f 6e2c 0d0a 2020   dispersion,..  
-000257c0: 616e 6420 3a6d 6174 683a 6049 5f30 285c  and :math:`I_0(\
-000257d0: 6b61 7070 6129 6020 6973 2074 6865 206d  kappa)` is the m
-000257e0: 6f64 6966 6965 6420 4265 7373 656c 2066  odified Bessel f
-000257f0: 756e 6374 696f 6e20 6f66 206f 7264 6572  unction of order
-00025800: 2030 2e0d 0a0d 0a20 2054 6865 2076 6f6e   0.....  The von
-00025810: 204d 6973 6573 2069 7320 6e61 6d65 6420   Mises is named 
-00025820: 666f 7220 5269 6368 6172 6420 4564 6c65  for Richard Edle
-00025830: 7220 766f 6e20 4d69 7365 732c 2077 686f  r von Mises, who
-00025840: 2077 6173 2062 6f72 6e20 696e 0d0a 2020   was born in..  
-00025850: 4175 7374 7269 612d 4875 6e67 6172 792c  Austria-Hungary,
-00025860: 2069 6e20 7768 6174 2069 7320 6e6f 7720   in what is now 
-00025870: 7468 6520 556b 7261 696e 652e 2020 4865  the Ukraine.  He
-00025880: 2066 6c65 6420 746f 2074 6865 2055 6e69   fled to the Uni
-00025890: 7465 640d 0a20 2053 7461 7465 7320 696e  ted..  States in
-000258a0: 2031 3933 3920 616e 6420 6265 6361 6d65   1939 and became
-000258b0: 2061 2070 726f 6665 7373 6f72 2061 7420   a professor at 
-000258c0: 4861 7276 6172 642e 2020 4865 2077 6f72  Harvard.  He wor
-000258d0: 6b65 6420 696e 0d0a 2020 7072 6f62 6162  ked in..  probab
-000258e0: 696c 6974 7920 7468 656f 7279 2c20 6165  ility theory, ae
-000258f0: 726f 6479 6e61 6d69 6373 2c20 666c 7569  rodynamics, flui
-00025900: 6420 6d65 6368 616e 6963 732c 2061 6e64  d mechanics, and
-00025910: 2070 6869 6c6f 736f 7068 7920 6f66 0d0a   philosophy of..
-00025920: 2020 7363 6965 6e63 652e 0d0a 0d0a 2020    science.....  
-00025930: 5265 6665 7265 6e63 6573 0d0a 2020 2d2d  References..  --
-00025940: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2e2e 205b  --------..  .. [
-00025950: 315d 2041 6272 616d 6f77 6974 7a2c 204d  1] Abramowitz, M
-00025960: 2e20 616e 6420 5374 6567 756e 2c20 492e  . and Stegun, I.
-00025970: 2041 2e20 2845 6473 2e29 2e20 2248 616e   A. (Eds.). "Han
-00025980: 6462 6f6f 6b20 6f66 0d0a 2020 2020 2020  dbook of..      
-00025990: 2020 204d 6174 6865 6d61 7469 6361 6c20     Mathematical 
-000259a0: 4675 6e63 7469 6f6e 7320 7769 7468 2046  Functions with F
-000259b0: 6f72 6d75 6c61 732c 2047 7261 7068 732c  ormulas, Graphs,
-000259c0: 2061 6e64 204d 6174 6865 6d61 7469 6361   and Mathematica
-000259d0: 6c0d 0a20 2020 2020 2020 2020 5461 626c  l..         Tabl
-000259e0: 6573 2c20 3974 6820 7072 696e 7469 6e67  es, 9th printing
-000259f0: 2c22 204e 6577 2059 6f72 6b3a 2044 6f76  ," New York: Dov
-00025a00: 6572 2c20 3139 3732 2e0d 0a20 202e 2e20  er, 1972...  .. 
-00025a10: 5b32 5d20 766f 6e20 4d69 7365 732c 2052  [2] von Mises, R
-00025a20: 2e2c 2022 4d61 7468 656d 6174 6963 616c  ., "Mathematical
-00025a30: 2054 6865 6f72 7920 6f66 2050 726f 6261   Theory of Proba
-00025a40: 6269 6c69 7479 0d0a 2020 2020 2020 2020  bility..        
-00025a50: 2061 6e64 2053 7461 7469 7374 6963 7322   and Statistics"
-00025a60: 2c20 4e65 7720 596f 726b 3a20 4163 6164  , New York: Acad
-00025a70: 656d 6963 2050 7265 7373 2c20 3139 3634  emic Press, 1964
-00025a80: 2e0d 0a0d 0a20 2045 7861 6d70 6c65 730d  .....  Examples.
-00025a90: 0a20 202d 2d2d 2d2d 2d2d 2d0d 0a20 2044  .  --------..  D
-00025aa0: 7261 7720 7361 6d70 6c65 7320 6672 6f6d  raw samples from
-00025ab0: 2074 6865 2064 6973 7472 6962 7574 696f   the distributio
-00025ac0: 6e3a 0d0a 0d0a 2020 3e3e 3e20 6d75 2c20  n:....  >>> mu, 
-00025ad0: 6b61 7070 6120 3d20 302e 302c 2034 2e30  kappa = 0.0, 4.0
-00025ae0: 2023 206d 6561 6e20 616e 6420 6469 7370   # mean and disp
-00025af0: 6572 7369 6f6e 0d0a 2020 3e3e 3e20 7320  ersion..  >>> s 
-00025b00: 3d20 6263 2e72 616e 646f 6d2e 766f 6e6d  = bc.random.vonm
-00025b10: 6973 6573 286d 752c 206b 6170 7061 2c20  ises(mu, kappa, 
-00025b20: 3130 3030 290d 0a0d 0a20 2044 6973 706c  1000)....  Displ
-00025b30: 6179 2074 6865 2068 6973 746f 6772 616d  ay the histogram
-00025b40: 206f 6620 7468 6520 7361 6d70 6c65 732c   of the samples,
-00025b50: 2061 6c6f 6e67 2077 6974 680d 0a20 2074   along with..  t
-00025b60: 6865 2070 726f 6261 6269 6c69 7479 2064  he probability d
-00025b70: 656e 7369 7479 2066 756e 6374 696f 6e3a  ensity function:
-00025b80: 0d0a 0d0a 2020 3e3e 3e20 696d 706f 7274  ....  >>> import
-00025b90: 206d 6174 706c 6f74 6c69 622e 7079 706c   matplotlib.pypl
-00025ba0: 6f74 2061 7320 706c 7420 2023 206e 6f71  ot as plt  # noq
-00025bb0: 610d 0a20 203e 3e3e 2066 726f 6d20 7363  a..  >>> from sc
-00025bc0: 6970 792e 7370 6563 6961 6c20 696d 706f  ipy.special impo
-00025bd0: 7274 2069 3020 2023 2064 6f63 7465 7374  rt i0  # doctest
-00025be0: 3a20 2b53 4b49 500d 0a20 203e 3e3e 2070  : +SKIP..  >>> p
-00025bf0: 6c74 2e68 6973 7428 732c 2035 302c 2064  lt.hist(s, 50, d
-00025c00: 656e 7369 7479 3d54 7275 6529 0d0a 2020  ensity=True)..  
-00025c10: 3e3e 3e20 7820 3d20 6e70 2e6c 696e 7370  >>> x = np.linsp
-00025c20: 6163 6528 2d6e 702e 7069 2c20 6e70 2e70  ace(-np.pi, np.p
-00025c30: 692c 206e 756d 3d35 3129 0d0a 2020 3e3e  i, num=51)..  >>
-00025c40: 3e20 7920 3d20 6e70 2e65 7870 286b 6170  > y = np.exp(kap
-00025c50: 7061 2a6e 702e 636f 7328 782d 6d75 2929  pa*np.cos(x-mu))
-00025c60: 2f28 322a 6e70 2e70 692a 6930 286b 6170  /(2*np.pi*i0(kap
-00025c70: 7061 2929 2020 2320 646f 6374 6573 743a  pa))  # doctest:
-00025c80: 202b 534b 4950 0d0a 2020 3e3e 3e20 706c   +SKIP..  >>> pl
-00025c90: 742e 706c 6f74 2878 2c20 792c 206c 696e  t.plot(x, y, lin
-00025ca0: 6577 6964 7468 3d32 2c20 636f 6c6f 723d  ewidth=2, color=
-00025cb0: 2772 2729 2020 2320 646f 6374 6573 743a  'r')  # doctest:
-00025cc0: 202b 534b 4950 0d0a 2020 3e3e 3e20 706c   +SKIP..  >>> pl
-00025cd0: 742e 7368 6f77 2829 0d0a 2020 2222 220d  t.show()..  """.
-00025ce0: 0a20 2072 6574 7572 6e20 4445 4641 554c  .  return DEFAUL
-00025cf0: 542e 766f 6e6d 6973 6573 286d 752c 206b  T.vonmises(mu, k
-00025d00: 6170 7061 2c20 7369 7a65 2c20 6b65 793d  appa, size, key=
-00025d10: 6b65 792c 2064 7479 7065 3d64 7479 7065  key, dtype=dtype
-00025d20: 290d 0a0d 0a0d 0a64 6566 2077 616c 6428  )......def wald(
-00025d30: 6d65 616e 2c0d 0a20 2020 2020 2020 2020  mean,..         
-00025d40: 7363 616c 652c 0d0a 2020 2020 2020 2020  scale,..        
-00025d50: 2073 697a 653a 204f 7074 696f 6e61 6c5b   size: Optional[
-00025d60: 5369 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20  Size] = None,.. 
-00025d70: 2020 2020 2020 2020 6b65 793a 204f 7074          key: Opt
-00025d80: 696f 6e61 6c5b 5365 6564 4f72 4b65 795d  ional[SeedOrKey]
-00025d90: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
-00025da0: 2020 2064 7479 7065 3a20 4454 7970 654c     dtype: DTypeL
-00025db0: 696b 6520 3d20 4e6f 6e65 293a 0d0a 2020  ike = None):..  
-00025dc0: 7222 2222 0d0a 2020 4472 6177 2073 616d  r"""..  Draw sam
-00025dd0: 706c 6573 2066 726f 6d20 6120 5761 6c64  ples from a Wald
-00025de0: 2c20 6f72 2069 6e76 6572 7365 2047 6175  , or inverse Gau
-00025df0: 7373 6961 6e2c 2064 6973 7472 6962 7574  ssian, distribut
-00025e00: 696f 6e2e 0d0a 0d0a 2020 4173 2074 6865  ion.....  As the
-00025e10: 2073 6361 6c65 2061 7070 726f 6163 6865   scale approache
-00025e20: 7320 696e 6669 6e69 7479 2c20 7468 6520  s infinity, the 
-00025e30: 6469 7374 7269 6275 7469 6f6e 2062 6563  distribution bec
-00025e40: 6f6d 6573 206d 6f72 6520 6c69 6b65 2061  omes more like a
-00025e50: 0d0a 2020 4761 7573 7369 616e 2e20 536f  ..  Gaussian. So
-00025e60: 6d65 2072 6566 6572 656e 6365 7320 636c  me references cl
-00025e70: 6169 6d20 7468 6174 2074 6865 2057 616c  aim that the Wal
-00025e80: 6420 6973 2061 6e20 696e 7665 7273 6520  d is an inverse 
-00025e90: 4761 7573 7369 616e 0d0a 2020 7769 7468  Gaussian..  with
-00025ea0: 206d 6561 6e20 6571 7561 6c20 746f 2031   mean equal to 1
-00025eb0: 2c20 6275 7420 7468 6973 2069 7320 6279  , but this is by
-00025ec0: 206e 6f20 6d65 616e 7320 756e 6976 6572   no means univer
-00025ed0: 7361 6c2e 0d0a 0d0a 2020 5468 6520 696e  sal.....  The in
-00025ee0: 7665 7273 6520 4761 7573 7369 616e 2064  verse Gaussian d
-00025ef0: 6973 7472 6962 7574 696f 6e20 7761 7320  istribution was 
-00025f00: 6669 7273 7420 7374 7564 6965 6420 696e  first studied in
-00025f10: 2072 656c 6174 696f 6e73 6869 7020 746f   relationship to
-00025f20: 0d0a 2020 4272 6f77 6e69 616e 206d 6f74  ..  Brownian mot
-00025f30: 696f 6e2e 2049 6e20 3139 3536 204d 2e43  ion. In 1956 M.C
-00025f40: 2e4b 2e20 5477 6565 6469 6520 7573 6564  .K. Tweedie used
-00025f50: 2074 6865 206e 616d 6520 696e 7665 7273   the name invers
-00025f60: 6520 4761 7573 7369 616e 0d0a 2020 6265  e Gaussian..  be
-00025f70: 6361 7573 6520 7468 6572 6520 6973 2061  cause there is a
-00025f80: 6e20 696e 7665 7273 6520 7265 6c61 7469  n inverse relati
-00025f90: 6f6e 7368 6970 2062 6574 7765 656e 2074  onship between t
-00025fa0: 6865 2074 696d 6520 746f 2063 6f76 6572  he time to cover
-00025fb0: 2061 0d0a 2020 756e 6974 2064 6973 7461   a..  unit dista
-00025fc0: 6e63 6520 616e 6420 6469 7374 616e 6365  nce and distance
-00025fd0: 2063 6f76 6572 6564 2069 6e20 756e 6974   covered in unit
-00025fe0: 2074 696d 652e 0d0a 0d0a 2020 5061 7261   time.....  Para
-00025ff0: 6d65 7465 7273 0d0a 2020 2d2d 2d2d 2d2d  meters..  ------
-00026000: 2d2d 2d2d 0d0a 2020 6d65 616e 203a 2066  ----..  mean : f
-00026010: 6c6f 6174 206f 7220 6172 7261 795f 6c69  loat or array_li
-00026020: 6b65 206f 6620 666c 6f61 7473 0d0a 2020  ke of floats..  
-00026030: 2020 2020 4469 7374 7269 6275 7469 6f6e      Distribution
-00026040: 206d 6561 6e2c 206d 7573 7420 6265 203e   mean, must be >
-00026050: 2030 2e0d 0a20 2073 6361 6c65 203a 2066   0...  scale : f
-00026060: 6c6f 6174 206f 7220 6172 7261 795f 6c69  loat or array_li
-00026070: 6b65 206f 6620 666c 6f61 7473 0d0a 2020  ke of floats..  
-00026080: 2020 2020 5363 616c 6520 7061 7261 6d65      Scale parame
-00026090: 7465 722c 206d 7573 7420 6265 203e 2030  ter, must be > 0
-000260a0: 2e0d 0a20 2073 697a 6520 3a20 696e 7420  ...  size : int 
-000260b0: 6f72 2074 7570 6c65 206f 6620 696e 7473  or tuple of ints
-000260c0: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-000260d0: 2020 4f75 7470 7574 2073 6861 7065 2e20    Output shape. 
-000260e0: 2049 6620 7468 6520 6769 7665 6e20 7368   If the given sh
-000260f0: 6170 6520 6973 2c20 652e 672e 2c20 6060  ape is, e.g., ``
-00026100: 286d 2c20 6e2c 206b 2960 602c 2074 6865  (m, n, k)``, the
-00026110: 6e0d 0a20 2020 2020 2060 606d 202a 206e  n..      ``m * n
-00026120: 202a 206b 6060 2073 616d 706c 6573 2061   * k`` samples a
-00026130: 7265 2064 7261 776e 2e20 2049 6620 7369  re drawn.  If si
-00026140: 7a65 2069 7320 6060 4e6f 6e65 6060 2028  ze is ``None`` (
-00026150: 6465 6661 756c 7429 2c0d 0a20 2020 2020  default),..     
-00026160: 2061 2073 696e 676c 6520 7661 6c75 6520   a single value 
-00026170: 6973 2072 6574 7572 6e65 6420 6966 2060  is returned if `
-00026180: 606d 6561 6e60 6020 616e 6420 6060 7363  `mean`` and ``sc
-00026190: 616c 6560 6020 6172 6520 626f 7468 2073  ale`` are both s
-000261a0: 6361 6c61 7273 2e0d 0a20 2020 2020 204f  calars...      O
-000261b0: 7468 6572 7769 7365 2c20 6060 6e70 2e62  therwise, ``np.b
-000261c0: 726f 6164 6361 7374 286d 6561 6e2c 2073  roadcast(mean, s
-000261d0: 6361 6c65 292e 7369 7a65 6060 2073 616d  cale).size`` sam
-000261e0: 706c 6573 2061 7265 2064 7261 776e 2e0d  ples are drawn..
-000261f0: 0a20 206b 6579 203a 2050 524e 474b 6579  .  key : PRNGKey
-00026200: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-00026210: 2020 5468 6520 6b65 7920 666f 7220 7468    The key for th
-00026220: 6520 7261 6e64 6f6d 206e 756d 6265 7220  e random number 
-00026230: 6765 6e65 7261 746f 722e 2049 6620 6e6f  generator. If no
-00026240: 7420 6769 7665 6e2c 2074 6865 0d0a 2020  t given, the..  
-00026250: 2020 2020 6465 6661 756c 7420 7261 6e64      default rand
-00026260: 6f6d 206e 756d 6265 7220 6765 6e65 7261  om number genera
-00026270: 746f 7220 6973 2075 7365 642e 0d0a 0d0a  tor is used.....
-00026280: 2020 5265 7475 726e 730d 0a20 202d 2d2d    Returns..  ---
-00026290: 2d2d 2d2d 0d0a 2020 6f75 7420 3a20 6e64  ----..  out : nd
-000262a0: 6172 7261 7920 6f72 2073 6361 6c61 720d  array or scalar.
-000262b0: 0a20 2020 2020 2044 7261 776e 2073 616d  .      Drawn sam
-000262c0: 706c 6573 2066 726f 6d20 7468 6520 7061  ples from the pa
-000262d0: 7261 6d65 7465 7269 7a65 6420 5761 6c64  rameterized Wald
-000262e0: 2064 6973 7472 6962 7574 696f 6e2e 0d0a   distribution...
-000262f0: 0d0a 2020 4e6f 7465 730d 0a20 202d 2d2d  ..  Notes..  ---
-00026300: 2d2d 0d0a 2020 5468 6520 7072 6f62 6162  --..  The probab
-00026310: 696c 6974 7920 6465 6e73 6974 7920 6675  ility density fu
-00026320: 6e63 7469 6f6e 2066 6f72 2074 6865 2057  nction for the W
-00026330: 616c 6420 6469 7374 7269 6275 7469 6f6e  ald distribution
-00026340: 2069 730d 0a0d 0a20 202e 2e20 6d61 7468   is....  .. math
-00026350: 3a3a 2050 2878 3b6d 6561 6e2c 7363 616c  :: P(x;mean,scal
-00026360: 6529 203d 205c 7371 7274 7b5c 6672 6163  e) = \sqrt{\frac
-00026370: 7b73 6361 6c65 7d7b 325c 7069 2078 5e33  {scale}{2\pi x^3
-00026380: 7d7d 655e 0d0a 2020 2020 2020 2020 2020  }}e^..          
-00026390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000263a0: 2020 2020 5c66 7261 637b 2d73 6361 6c65      \frac{-scale
-000263b0: 2878 2d6d 6561 6e29 5e32 7d7b 325c 6364  (x-mean)^2}{2\cd
-000263c0: 6f74 7020 6d65 616e 5e32 787d 0d0a 0d0a  otp mean^2x}....
-000263d0: 2020 4173 206e 6f74 6564 2061 626f 7665    As noted above
-000263e0: 2074 6865 2069 6e76 6572 7365 2047 6175   the inverse Gau
-000263f0: 7373 6961 6e20 6469 7374 7269 6275 7469  ssian distributi
-00026400: 6f6e 2066 6972 7374 2061 7269 7365 0d0a  on first arise..
-00026410: 2020 6672 6f6d 2061 7474 656d 7074 7320    from attempts 
-00026420: 746f 206d 6f64 656c 2042 726f 776e 6961  to model Brownia
-00026430: 6e20 6d6f 7469 6f6e 2e20 4974 2069 7320  n motion. It is 
-00026440: 616c 736f 2061 0d0a 2020 636f 6d70 6574  also a..  compet
-00026450: 6974 6f72 2074 6f20 7468 6520 5765 6962  itor to the Weib
-00026460: 756c 6c20 666f 7220 7573 6520 696e 2072  ull for use in r
-00026470: 656c 6961 6269 6c69 7479 206d 6f64 656c  eliability model
-00026480: 696e 6720 616e 640d 0a20 206d 6f64 656c  ing and..  model
-00026490: 696e 6720 7374 6f63 6b20 7265 7475 726e  ing stock return
-000264a0: 7320 616e 6420 696e 7465 7265 7374 2072  s and interest r
-000264b0: 6174 6520 7072 6f63 6573 7365 732e 0d0a  ate processes...
-000264c0: 0d0a 2020 5265 6665 7265 6e63 6573 0d0a  ..  References..
-000264d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-000264e0: 2e2e 205b 315d 2042 7269 6768 746f 6e20  .. [1] Brighton 
-000264f0: 5765 6273 204c 7464 2e2c 2057 616c 6420  Webs Ltd., Wald 
-00026500: 4469 7374 7269 6275 7469 6f6e 2c0d 0a20  Distribution,.. 
-00026510: 2020 2020 2020 2020 6874 7470 733a 2f2f          https://
-00026520: 7765 622e 6172 6368 6976 652e 6f72 672f  web.archive.org/
-00026530: 7765 622f 3230 3039 3034 3233 3031 3430  web/200904230140
-00026540: 3130 2f68 7474 703a 2f2f 7777 772e 6272  10/http://www.br
-00026550: 6967 6874 6f6e 2d77 6562 732e 636f 2e75  ighton-webs.co.u
-00026560: 6b3a 3830 2f64 6973 7472 6962 7574 696f  k:80/distributio
-00026570: 6e73 2f77 616c 642e 6173 700d 0a20 202e  ns/wald.asp..  .
-00026580: 2e20 5b32 5d20 4368 6869 6b61 7261 2c20  . [2] Chhikara, 
-00026590: 5261 6a20 532e 2c20 616e 6420 466f 6c6b  Raj S., and Folk
-000265a0: 732c 204a 2e20 4c65 726f 792c 2022 5468  s, J. Leroy, "Th
-000265b0: 6520 496e 7665 7273 6520 4761 7573 7369  e Inverse Gaussi
-000265c0: 616e 0d0a 2020 2020 2020 2020 2044 6973  an..         Dis
-000265d0: 7472 6962 7574 696f 6e3a 2054 6865 6f72  tribution: Theor
-000265e0: 7920 3a20 4d65 7468 6f64 6f6c 6f67 792c  y : Methodology,
-000265f0: 2061 6e64 2041 7070 6c69 6361 7469 6f6e   and Application
-00026600: 7322 2c20 4352 4320 5072 6573 732c 0d0a  s", CRC Press,..
-00026610: 2020 2020 2020 2020 2031 3938 382e 0d0a           1988...
-00026620: 2020 2e2e 205b 335d 2057 696b 6970 6564    .. [3] Wikiped
-00026630: 6961 2c20 2249 6e76 6572 7365 2047 6175  ia, "Inverse Gau
-00026640: 7373 6961 6e20 6469 7374 7269 6275 7469  ssian distributi
-00026650: 6f6e 220d 0a20 2020 2020 2020 2020 6874  on"..         ht
-00026660: 7470 733a 2f2f 656e 2e77 696b 6970 6564  tps://en.wikiped
-00026670: 6961 2e6f 7267 2f77 696b 692f 496e 7665  ia.org/wiki/Inve
-00026680: 7273 655f 4761 7573 7369 616e 5f64 6973  rse_Gaussian_dis
-00026690: 7472 6962 7574 696f 6e0d 0a0d 0a20 2045  tribution....  E
-000266a0: 7861 6d70 6c65 730d 0a20 202d 2d2d 2d2d  xamples..  -----
-000266b0: 2d2d 2d0d 0a20 2044 7261 7720 7661 6c75  ---..  Draw valu
-000266c0: 6573 2066 726f 6d20 7468 6520 6469 7374  es from the dist
-000266d0: 7269 6275 7469 6f6e 2061 6e64 2070 6c6f  ribution and plo
-000266e0: 7420 7468 6520 6869 7374 6f67 7261 6d3a  t the histogram:
-000266f0: 0d0a 0d0a 2020 3e3e 3e20 696d 706f 7274  ....  >>> import
-00026700: 206d 6174 706c 6f74 6c69 622e 7079 706c   matplotlib.pypl
-00026710: 6f74 2061 7320 706c 7420 2023 206e 6f71  ot as plt  # noq
-00026720: 610d 0a20 203e 3e3e 2068 203d 2070 6c74  a..  >>> h = plt
-00026730: 2e68 6973 7428 6263 2e72 616e 646f 6d2e  .hist(bc.random.
-00026740: 7761 6c64 2833 2c20 322c 2031 3030 3030  wald(3, 2, 10000
-00026750: 3029 2c20 6269 6e73 3d32 3030 2c20 6465  0), bins=200, de
-00026760: 6e73 6974 793d 5472 7565 290d 0a20 203e  nsity=True)..  >
-00026770: 3e3e 2070 6c74 2e73 686f 7728 290d 0a20  >> plt.show().. 
-00026780: 2022 2222 0d0a 2020 7265 7475 726e 2044   """..  return D
-00026790: 4546 4155 4c54 2e77 616c 6428 6d65 616e  EFAULT.wald(mean
-000267a0: 2c20 7363 616c 652c 2073 697a 652c 206b  , scale, size, k
-000267b0: 6579 3d6b 6579 2c20 6474 7970 653d 6474  ey=key, dtype=dt
-000267c0: 7970 6529 0d0a 0d0a 0d0a 6465 6620 7765  ype)......def we
-000267d0: 6962 756c 6c28 612c 0d0a 2020 2020 2020  ibull(a,..      
-000267e0: 2020 2020 2020 7369 7a65 3a20 4f70 7469        size: Opti
-000267f0: 6f6e 616c 5b53 697a 655d 203d 204e 6f6e  onal[Size] = Non
-00026800: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
-00026810: 6b65 793a 204f 7074 696f 6e61 6c5b 5365  key: Optional[Se
-00026820: 6564 4f72 4b65 795d 203d 204e 6f6e 652c  edOrKey] = None,
-00026830: 0d0a 2020 2020 2020 2020 2020 2020 6474  ..            dt
-00026840: 7970 653a 2044 5479 7065 4c69 6b65 203d  ype: DTypeLike =
-00026850: 204e 6f6e 6529 3a0d 0a20 2072 2222 220d   None):..  r""".
-00026860: 0a20 2044 7261 7720 7361 6d70 6c65 7320  .  Draw samples 
-00026870: 6672 6f6d 2061 2057 6569 6275 6c6c 2064  from a Weibull d
-00026880: 6973 7472 6962 7574 696f 6e2e 0d0a 0d0a  istribution.....
-00026890: 2020 4472 6177 2073 616d 706c 6573 2066    Draw samples f
-000268a0: 726f 6d20 6120 312d 7061 7261 6d65 7465  rom a 1-paramete
-000268b0: 7220 5765 6962 756c 6c20 6469 7374 7269  r Weibull distri
-000268c0: 6275 7469 6f6e 2077 6974 6820 7468 6520  bution with the 
-000268d0: 6769 7665 6e0d 0a20 2073 6861 7065 2070  given..  shape p
-000268e0: 6172 616d 6574 6572 2060 6160 2e0d 0a0d  arameter `a`....
-000268f0: 0a20 202e 2e20 6d61 7468 3a3a 2058 203d  .  .. math:: X =
-00026900: 2028 2d6c 6e28 5529 295e 7b31 2f61 7d0d   (-ln(U))^{1/a}.
-00026910: 0a0d 0a20 2048 6572 652c 2055 2069 7320  ...  Here, U is 
-00026920: 6472 6177 6e20 6672 6f6d 2074 6865 2075  drawn from the u
-00026930: 6e69 666f 726d 2064 6973 7472 6962 7574  niform distribut
-00026940: 696f 6e20 6f76 6572 2028 302c 315d 2e0d  ion over (0,1]..
-00026950: 0a0d 0a20 2054 6865 206d 6f72 6520 636f  ...  The more co
-00026960: 6d6d 6f6e 2032 2d70 6172 616d 6574 6572  mmon 2-parameter
-00026970: 2057 6569 6275 6c6c 2c20 696e 636c 7564   Weibull, includ
-00026980: 696e 6720 6120 7363 616c 6520 7061 7261  ing a scale para
-00026990: 6d65 7465 720d 0a20 203a 6d61 7468 3a60  meter..  :math:`
-000269a0: 5c6c 616d 6264 6160 2069 7320 6a75 7374  \lambda` is just
-000269b0: 203a 6d61 7468 3a60 5820 3d20 5c6c 616d   :math:`X = \lam
-000269c0: 6264 6128 2d6c 6e28 5529 295e 7b31 2f61  bda(-ln(U))^{1/a
-000269d0: 7d60 2e0d 0a0d 0a20 202e 2e20 6e6f 7465  }`.....  .. note
-000269e0: 3a3a 0d0a 2020 2020 2020 4e65 7720 636f  ::..      New co
-000269f0: 6465 2073 686f 756c 6420 7573 6520 7468  de should use th
-00026a00: 6520 6060 7765 6962 756c 6c60 6020 6d65  e ``weibull`` me
-00026a10: 7468 6f64 206f 6620 6120 6060 6465 6661  thod of a ``defa
-00026a20: 756c 745f 726e 6728 2960 600d 0a20 2020  ult_rng()``..   
-00026a30: 2020 2069 6e73 7461 6e63 6520 696e 7374     instance inst
-00026a40: 6561 643b 2070 6c65 6173 6520 7365 6520  ead; please see 
-00026a50: 7468 6520 3a72 6566 3a60 7261 6e64 6f6d  the :ref:`random
-00026a60: 2d71 7569 636b 2d73 7461 7274 602e 0d0a  -quick-start`...
-00026a70: 0d0a 2020 5061 7261 6d65 7465 7273 0d0a  ..  Parameters..
-00026a80: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00026a90: 6120 3a20 666c 6f61 7420 6f72 2061 7272  a : float or arr
-00026aa0: 6179 5f6c 696b 6520 6f66 2066 6c6f 6174  ay_like of float
-00026ab0: 730d 0a20 2020 2020 2053 6861 7065 2070  s..      Shape p
-00026ac0: 6172 616d 6574 6572 206f 6620 7468 6520  arameter of the 
-00026ad0: 6469 7374 7269 6275 7469 6f6e 2e20 204d  distribution.  M
-00026ae0: 7573 7420 6265 206e 6f6e 6e65 6761 7469  ust be nonnegati
-00026af0: 7665 2e0d 0a20 2073 697a 6520 3a20 696e  ve...  size : in
-00026b00: 7420 6f72 2074 7570 6c65 206f 6620 696e  t or tuple of in
-00026b10: 7473 2c20 6f70 7469 6f6e 616c 0d0a 2020  ts, optional..  
-00026b20: 2020 2020 4f75 7470 7574 2073 6861 7065      Output shape
-00026b30: 2e20 2049 6620 7468 6520 6769 7665 6e20  .  If the given 
-00026b40: 7368 6170 6520 6973 2c20 652e 672e 2c20  shape is, e.g., 
-00026b50: 6060 286d 2c20 6e2c 206b 2960 602c 2074  ``(m, n, k)``, t
-00026b60: 6865 6e0d 0a20 2020 2020 2060 606d 202a  hen..      ``m *
-00026b70: 206e 202a 206b 6060 2073 616d 706c 6573   n * k`` samples
-00026b80: 2061 7265 2064 7261 776e 2e20 2049 6620   are drawn.  If 
-00026b90: 7369 7a65 2069 7320 6060 4e6f 6e65 6060  size is ``None``
-00026ba0: 2028 6465 6661 756c 7429 2c0d 0a20 2020   (default),..   
-00026bb0: 2020 2061 2073 696e 676c 6520 7661 6c75     a single valu
-00026bc0: 6520 6973 2072 6574 7572 6e65 6420 6966  e is returned if
-00026bd0: 2060 6061 6060 2069 7320 6120 7363 616c   ``a`` is a scal
-00026be0: 6172 2e20 204f 7468 6572 7769 7365 2c0d  ar.  Otherwise,.
-00026bf0: 0a20 2020 2020 2060 606e 702e 6172 7261  .      ``np.arra
-00026c00: 7928 6129 2e73 697a 6560 6020 7361 6d70  y(a).size`` samp
-00026c10: 6c65 7320 6172 6520 6472 6177 6e2e 0d0a  les are drawn...
-00026c20: 2020 6b65 7920 3a20 5052 4e47 4b65 792c    key : PRNGKey,
-00026c30: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-00026c40: 2054 6865 206b 6579 2066 6f72 2074 6865   The key for the
-00026c50: 2072 616e 646f 6d20 6e75 6d62 6572 2067   random number g
-00026c60: 656e 6572 6174 6f72 2e20 4966 206e 6f74  enerator. If not
-00026c70: 2067 6976 656e 2c20 7468 650d 0a20 2020   given, the..   
-00026c80: 2020 2064 6566 6175 6c74 2072 616e 646f     default rando
-00026c90: 6d20 6e75 6d62 6572 2067 656e 6572 6174  m number generat
-00026ca0: 6f72 2069 7320 7573 6564 2e0d 0a0d 0a20  or is used..... 
-00026cb0: 2052 6574 7572 6e73 0d0a 2020 2d2d 2d2d   Returns..  ----
-00026cc0: 2d2d 2d0d 0a20 206f 7574 203a 206e 6461  ---..  out : nda
-00026cd0: 7272 6179 206f 7220 7363 616c 6172 0d0a  rray or scalar..
-00026ce0: 2020 2020 2020 4472 6177 6e20 7361 6d70        Drawn samp
-00026cf0: 6c65 7320 6672 6f6d 2074 6865 2070 6172  les from the par
-00026d00: 616d 6574 6572 697a 6564 2057 6569 6275  ameterized Weibu
-00026d10: 6c6c 2064 6973 7472 6962 7574 696f 6e2e  ll distribution.
-00026d20: 0d0a 0d0a 2020 4e6f 7465 730d 0a20 202d  ....  Notes..  -
-00026d30: 2d2d 2d2d 0d0a 2020 5468 6520 5765 6962  ----..  The Weib
-00026d40: 756c 6c20 286f 7220 5479 7065 2049 4949  ull (or Type III
-00026d50: 2061 7379 6d70 746f 7469 6320 6578 7472   asymptotic extr
-00026d60: 656d 6520 7661 6c75 6520 6469 7374 7269  eme value distri
-00026d70: 6275 7469 6f6e 0d0a 2020 666f 7220 736d  bution..  for sm
-00026d80: 616c 6c65 7374 2076 616c 7565 732c 2053  allest values, S
-00026d90: 4556 2054 7970 6520 4949 492c 206f 7220  EV Type III, or 
-00026da0: 526f 7369 6e2d 5261 6d6d 6c65 720d 0a20  Rosin-Rammler.. 
-00026db0: 2064 6973 7472 6962 7574 696f 6e29 2069   distribution) i
-00026dc0: 7320 6f6e 6520 6f66 2061 2063 6c61 7373  s one of a class
-00026dd0: 206f 6620 4765 6e65 7261 6c69 7a65 6420   of Generalized 
-00026de0: 4578 7472 656d 6520 5661 6c75 650d 0a20  Extreme Value.. 
-00026df0: 2028 4745 5629 2064 6973 7472 6962 7574   (GEV) distribut
-00026e00: 696f 6e73 2075 7365 6420 696e 206d 6f64  ions used in mod
-00026e10: 656c 696e 6720 6578 7472 656d 6520 7661  eling extreme va
-00026e20: 6c75 6520 7072 6f62 6c65 6d73 2e0d 0a20  lue problems... 
-00026e30: 2054 6869 7320 636c 6173 7320 696e 636c   This class incl
-00026e40: 7564 6573 2074 6865 2047 756d 6265 6c20  udes the Gumbel 
-00026e50: 616e 6420 4672 6563 6865 7420 6469 7374  and Frechet dist
-00026e60: 7269 6275 7469 6f6e 732e 0d0a 0d0a 2020  ributions.....  
-00026e70: 5468 6520 7072 6f62 6162 696c 6974 7920  The probability 
-00026e80: 6465 6e73 6974 7920 666f 7220 7468 6520  density for the 
-00026e90: 5765 6962 756c 6c20 6469 7374 7269 6275  Weibull distribu
-00026ea0: 7469 6f6e 2069 730d 0a0d 0a20 202e 2e20  tion is....  .. 
-00026eb0: 6d61 7468 3a3a 2070 2878 2920 3d20 5c66  math:: p(x) = \f
-00026ec0: 7261 637b 617d 0d0a 2020 2020 2020 2020  rac{a}..        
-00026ed0: 2020 2020 2020 2020 2020 207b 5c6c 616d             {\lam
-00026ee0: 6264 617d 285c 6672 6163 7b78 7d7b 5c6c  bda}(\frac{x}{\l
-00026ef0: 616d 6264 617d 295e 7b61 2d31 7d65 5e7b  ambda})^{a-1}e^{
-00026f00: 2d28 782f 5c6c 616d 6264 6129 5e61 7d2c  -(x/\lambda)^a},
-00026f10: 0d0a 0d0a 2020 7768 6572 6520 3a6d 6174  ....  where :mat
-00026f20: 683a 6061 6020 6973 2074 6865 2073 6861  h:`a` is the sha
-00026f30: 7065 2061 6e64 203a 6d61 7468 3a60 5c6c  pe and :math:`\l
-00026f40: 616d 6264 6160 2074 6865 2073 6361 6c65  ambda` the scale
-00026f50: 2e0d 0a0d 0a20 2054 6865 2066 756e 6374  .....  The funct
-00026f60: 696f 6e20 6861 7320 6974 7320 7065 616b  ion has its peak
-00026f70: 2028 7468 6520 6d6f 6465 2920 6174 0d0a   (the mode) at..
-00026f80: 2020 3a6d 6174 683a 605c 6c61 6d62 6461    :math:`\lambda
-00026f90: 285c 6672 6163 7b61 2d31 7d7b 617d 295e  (\frac{a-1}{a})^
-00026fa0: 7b31 2f61 7d60 2e0d 0a0d 0a20 2057 6865  {1/a}`.....  Whe
-00026fb0: 6e20 6060 6120 3d20 3160 602c 2074 6865  n ``a = 1``, the
-00026fc0: 2057 6569 6275 6c6c 2064 6973 7472 6962   Weibull distrib
-00026fd0: 7574 696f 6e20 7265 6475 6365 7320 746f  ution reduces to
-00026fe0: 2074 6865 2065 7870 6f6e 656e 7469 616c   the exponential
-00026ff0: 0d0a 2020 6469 7374 7269 6275 7469 6f6e  ..  distribution
-00027000: 2e0d 0a0d 0a20 2052 6566 6572 656e 6365  .....  Reference
-00027010: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
-00027020: 0a20 202e 2e20 5b31 5d20 5761 6c6f 6464  .  .. [1] Walodd
-00027030: 6920 5765 6962 756c 6c2c 2052 6f79 616c  i Weibull, Royal
-00027040: 2054 6563 686e 6963 616c 2055 6e69 7665   Technical Unive
-00027050: 7273 6974 792c 2053 746f 636b 686f 6c6d  rsity, Stockholm
-00027060: 2c0d 0a20 2020 2020 2020 2020 3139 3339  ,..         1939
-00027070: 2022 4120 5374 6174 6973 7469 6361 6c20   "A Statistical 
-00027080: 5468 656f 7279 204f 6620 5468 6520 5374  Theory Of The St
-00027090: 7265 6e67 7468 204f 6620 4d61 7465 7269  rength Of Materi
-000270a0: 616c 7322 2c0d 0a20 2020 2020 2020 2020  als",..         
-000270b0: 496e 6765 6e69 6f72 7376 6574 656e 736b  Ingeniorsvetensk
-000270c0: 6170 7361 6b61 6465 6d69 656e 7320 4861  apsakademiens Ha
-000270d0: 6e64 6c69 6e67 6172 204e 7220 3135 312c  ndlingar Nr 151,
-000270e0: 2031 3933 392c 0d0a 2020 2020 2020 2020   1939,..        
-000270f0: 2047 656e 6572 616c 7374 6162 656e 7320   Generalstabens 
-00027100: 4c69 746f 6772 6166 6973 6b61 2041 6e73  Litografiska Ans
-00027110: 7461 6c74 7320 466f 726c 6167 2c20 5374  talts Forlag, St
-00027120: 6f63 6b68 6f6c 6d2e 0d0a 2020 2e2e 205b  ockholm...  .. [
-00027130: 325d 2057 616c 6f64 6469 2057 6569 6275  2] Waloddi Weibu
-00027140: 6c6c 2c20 2241 2053 7461 7469 7374 6963  ll, "A Statistic
-00027150: 616c 2044 6973 7472 6962 7574 696f 6e20  al Distribution 
-00027160: 4675 6e63 7469 6f6e 206f 660d 0a20 2020  Function of..   
-00027170: 2020 2020 2020 5769 6465 2041 7070 6c69        Wide Appli
-00027180: 6361 6269 6c69 7479 222c 204a 6f75 726e  cability", Journ
-00027190: 616c 204f 6620 4170 706c 6965 6420 4d65  al Of Applied Me
-000271a0: 6368 616e 6963 7320 4153 4d45 2050 6170  chanics ASME Pap
-000271b0: 6572 0d0a 2020 2020 2020 2020 2031 3935  er..         195
-000271c0: 312e 0d0a 2020 2e2e 205b 335d 2057 696b  1...  .. [3] Wik
-000271d0: 6970 6564 6961 2c20 2257 6569 6275 6c6c  ipedia, "Weibull
-000271e0: 2064 6973 7472 6962 7574 696f 6e22 2c0d   distribution",.
-000271f0: 0a20 2020 2020 2020 2020 6874 7470 733a  .         https:
-00027200: 2f2f 656e 2e77 696b 6970 6564 6961 2e6f  //en.wikipedia.o
-00027210: 7267 2f77 696b 692f 5765 6962 756c 6c5f  rg/wiki/Weibull_
-00027220: 6469 7374 7269 6275 7469 6f6e 0d0a 0d0a  distribution....
-00027230: 2020 4578 616d 706c 6573 0d0a 2020 2d2d    Examples..  --
-00027240: 2d2d 2d2d 2d2d 0d0a 2020 4472 6177 2073  ------..  Draw s
-00027250: 616d 706c 6573 2066 726f 6d20 7468 6520  amples from the 
-00027260: 6469 7374 7269 6275 7469 6f6e 3a0d 0a0d  distribution:...
-00027270: 0a20 203e 3e3e 2061 203d 2035 2e20 2320  .  >>> a = 5. # 
-00027280: 7368 6170 650d 0a20 203e 3e3e 2073 203d  shape..  >>> s =
-00027290: 2062 7261 696e 636f 7265 2e6d 6174 682e   braincore.math.
-000272a0: 7261 6e64 6f6d 2e77 6569 6275 6c6c 2861  random.weibull(a
-000272b0: 2c20 3130 3030 290d 0a0d 0a20 2044 6973  , 1000)....  Dis
-000272c0: 706c 6179 2074 6865 2068 6973 746f 6772  play the histogr
-000272d0: 616d 206f 6620 7468 6520 7361 6d70 6c65  am of the sample
-000272e0: 732c 2061 6c6f 6e67 2077 6974 680d 0a20  s, along with.. 
-000272f0: 2074 6865 2070 726f 6261 6269 6c69 7479   the probability
-00027300: 2064 656e 7369 7479 2066 756e 6374 696f   density functio
-00027310: 6e3a 0d0a 0d0a 2020 3e3e 3e20 696d 706f  n:....  >>> impo
-00027320: 7274 206d 6174 706c 6f74 6c69 622e 7079  rt matplotlib.py
-00027330: 706c 6f74 2061 7320 706c 7420 2023 206e  plot as plt  # n
-00027340: 6f71 610d 0a20 203e 3e3e 2078 203d 206e  oqa..  >>> x = n
-00027350: 702e 6172 616e 6765 2831 2c31 3030 2e29  p.arange(1,100.)
-00027360: 2f35 302e 0d0a 2020 3e3e 3e20 6465 6620  /50...  >>> def 
-00027370: 7765 6962 2878 2c6e 2c61 293a 0d0a 2020  weib(x,n,a):..  
-00027380: 2e2e 2e20 2020 2020 7265 7475 726e 2028  ...     return (
-00027390: 6120 2f20 6e29 202a 2028 7820 2f20 6e29  a / n) * (x / n)
-000273a0: 2a2a 2861 202d 2031 2920 2a20 6e70 2e65  **(a - 1) * np.e
-000273b0: 7870 282d 2878 202f 206e 292a 2a61 290d  xp(-(x / n)**a).
-000273c0: 0a0d 0a20 203e 3e3e 2063 6f75 6e74 2c20  ...  >>> count, 
-000273d0: 6269 6e73 2c20 6967 6e6f 7265 6420 3d20  bins, ignored = 
-000273e0: 706c 742e 6869 7374 2862 7261 696e 636f  plt.hist(brainco
-000273f0: 7265 2e6d 6174 682e 7261 6e64 6f6d 2e77  re.math.random.w
-00027400: 6569 6275 6c6c 2835 2e2c 3130 3030 2929  eibull(5.,1000))
-00027410: 0d0a 2020 3e3e 3e20 7820 3d20 6e70 2e61  ..  >>> x = np.a
-00027420: 7261 6e67 6528 312c 3130 302e 292f 3530  range(1,100.)/50
-00027430: 2e0d 0a20 203e 3e3e 2073 6361 6c65 203d  ...  >>> scale =
-00027440: 2063 6f75 6e74 2e6d 6178 2829 2f77 6569   count.max()/wei
-00027450: 6228 782c 2031 2e2c 2035 2e29 2e6d 6178  b(x, 1., 5.).max
-00027460: 2829 0d0a 2020 3e3e 3e20 706c 742e 706c  ()..  >>> plt.pl
-00027470: 6f74 2878 2c20 7765 6962 2878 2c20 312e  ot(x, weib(x, 1.
-00027480: 2c20 352e 292a 7363 616c 6529 0d0a 2020  , 5.)*scale)..  
-00027490: 3e3e 3e20 706c 742e 7368 6f77 2829 0d0a  >>> plt.show()..
-000274a0: 0d0a 2020 2222 220d 0a20 2072 6574 7572  ..  """..  retur
-000274b0: 6e20 4445 4641 554c 542e 7765 6962 756c  n DEFAULT.weibul
-000274c0: 6c28 612c 2073 697a 652c 206b 6579 3d6b  l(a, size, key=k
-000274d0: 6579 2c20 6474 7970 653d 6474 7970 6529  ey, dtype=dtype)
-000274e0: 0d0a 0d0a 0d0a 6465 6620 7765 6962 756c  ......def weibul
-000274f0: 6c5f 6d69 6e28 612c 0d0a 2020 2020 2020  l_min(a,..      
-00027500: 2020 2020 2020 2020 2020 7363 616c 653d            scale=
-00027510: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
-00027520: 2020 2020 2020 2073 697a 653a 204f 7074         size: Opt
-00027530: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
-00027540: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
-00027550: 2020 2020 206b 6579 3a20 4f70 7469 6f6e       key: Option
-00027560: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
-00027570: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
-00027580: 2020 2020 2020 2064 7479 7065 3a20 4454         dtype: DT
-00027590: 7970 654c 696b 6520 3d20 4e6f 6e65 293a  ypeLike = None):
-000275a0: 0d0a 2020 2222 2253 616d 706c 6520 6672  ..  """Sample fr
-000275b0: 6f6d 2061 2057 6569 6275 6c6c 2064 6973  om a Weibull dis
-000275c0: 7472 6962 7574 696f 6e2e 0d0a 0d0a 2020  tribution.....  
-000275d0: 5468 6520 7363 6970 7920 636f 756e 7465  The scipy counte
-000275e0: 7270 6172 7420 6973 2060 7363 6970 792e  rpart is `scipy.
-000275f0: 7374 6174 732e 7765 6962 756c 6c5f 6d69  stats.weibull_mi
-00027600: 6e60 2e0d 0a0d 0a20 2041 7267 733a 0d0a  n`.....  Args:..
-00027610: 2020 2020 7363 616c 653a 2054 6865 2073      scale: The s
-00027620: 6361 6c65 2070 6172 616d 6574 6572 206f  cale parameter o
-00027630: 6620 7468 6520 6469 7374 7269 6275 7469  f the distributi
-00027640: 6f6e 2e0d 0a20 2020 2063 6f6e 6365 6e74  on...    concent
-00027650: 7261 7469 6f6e 3a20 5468 6520 636f 6e63  ration: The conc
-00027660: 656e 7472 6174 696f 6e20 7061 7261 6d65  entration parame
-00027670: 7465 7220 6f66 2074 6865 2064 6973 7472  ter of the distr
-00027680: 6962 7574 696f 6e2e 0d0a 2020 2020 7368  ibution...    sh
-00027690: 6170 653a 2054 6865 2073 6861 7065 2061  ape: The shape a
-000276a0: 6464 6564 2074 6f20 7468 6520 7061 7261  dded to the para
-000276b0: 6d65 7465 7273 206c 6f63 2061 6e64 2073  meters loc and s
-000276c0: 6361 6c65 2062 726f 6164 6361 7374 6162  cale broadcastab
-000276d0: 6c65 2073 6861 7065 2e0d 0a20 2020 2064  le shape...    d
-000276e0: 7479 7065 3a20 5468 6520 7479 7065 2075  type: The type u
-000276f0: 7365 6420 666f 7220 7361 6d70 6c65 732e  sed for samples.
-00027700: 0d0a 2020 2020 6b65 793a 2061 2050 524e  ..    key: a PRN
-00027710: 4720 6b65 7920 6f72 2061 2073 6565 642e  G key or a seed.
-00027720: 0d0a 0d0a 2020 5265 7475 726e 733a 0d0a  ....  Returns:..
-00027730: 2020 2020 4120 6a6e 702e 6172 7261 7920      A jnp.array 
-00027740: 6f66 2073 616d 706c 6573 2e0d 0a0d 0a20  of samples..... 
-00027750: 2022 2222 0d0a 2020 7265 7475 726e 2044   """..  return D
-00027760: 4546 4155 4c54 2e77 6569 6275 6c6c 5f6d  EFAULT.weibull_m
-00027770: 696e 2861 2c20 7363 616c 652c 2073 697a  in(a, scale, siz
-00027780: 652c 206b 6579 3d6b 6579 2c20 6474 7970  e, key=key, dtyp
-00027790: 653d 6474 7970 6529 0d0a 0d0a 0d0a 6465  e=dtype)......de
-000277a0: 6620 7a69 7066 2861 2c0d 0a20 2020 2020  f zipf(a,..     
-000277b0: 2020 2020 7369 7a65 3a20 4f70 7469 6f6e      size: Option
-000277c0: 616c 5b53 697a 655d 203d 204e 6f6e 652c  al[Size] = None,
-000277d0: 0d0a 2020 2020 2020 2020 206b 6579 3a20  ..         key: 
-000277e0: 4f70 7469 6f6e 616c 5b53 6565 644f 724b  Optional[SeedOrK
-000277f0: 6579 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ey] = None,..   
-00027800: 2020 2020 2020 6474 7970 653a 2044 5479        dtype: DTy
-00027810: 7065 4c69 6b65 203d 204e 6f6e 6529 3a0d  peLike = None):.
-00027820: 0a20 2072 2222 220d 0a20 2044 7261 7720  .  r"""..  Draw 
-00027830: 7361 6d70 6c65 7320 6672 6f6d 2061 205a  samples from a Z
-00027840: 6970 6620 6469 7374 7269 6275 7469 6f6e  ipf distribution
-00027850: 2e0d 0a0d 0a20 2053 616d 706c 6573 2061  .....  Samples a
-00027860: 7265 2064 7261 776e 2066 726f 6d20 6120  re drawn from a 
-00027870: 5a69 7066 2064 6973 7472 6962 7574 696f  Zipf distributio
-00027880: 6e20 7769 7468 2073 7065 6369 6669 6564  n with specified
-00027890: 2070 6172 616d 6574 6572 0d0a 2020 6061   parameter..  `a
-000278a0: 6020 3e20 312e 0d0a 0d0a 2020 5468 6520  ` > 1.....  The 
-000278b0: 5a69 7066 2064 6973 7472 6962 7574 696f  Zipf distributio
-000278c0: 6e20 2861 6c73 6f20 6b6e 6f77 6e20 6173  n (also known as
-000278d0: 2074 6865 207a 6574 6120 6469 7374 7269   the zeta distri
-000278e0: 6275 7469 6f6e 2920 6973 2061 0d0a 2020  bution) is a..  
-000278f0: 6469 7363 7265 7465 2070 726f 6261 6269  discrete probabi
-00027900: 6c69 7479 2064 6973 7472 6962 7574 696f  lity distributio
-00027910: 6e20 7468 6174 2073 6174 6973 6669 6573  n that satisfies
-00027920: 205a 6970 6627 7320 6c61 773a 2074 6865   Zipf's law: the
-00027930: 0d0a 2020 6672 6571 7565 6e63 7920 6f66  ..  frequency of
-00027940: 2061 6e20 6974 656d 2069 7320 696e 7665   an item is inve
-00027950: 7273 656c 7920 7072 6f70 6f72 7469 6f6e  rsely proportion
-00027960: 616c 2074 6f20 6974 7320 7261 6e6b 2069  al to its rank i
-00027970: 6e20 610d 0a20 2066 7265 7175 656e 6379  n a..  frequency
-00027980: 2074 6162 6c65 2e0d 0a0d 0a20 202e 2e20   table.....  .. 
-00027990: 6e6f 7465 3a3a 0d0a 2020 2020 2020 4e65  note::..      Ne
-000279a0: 7720 636f 6465 2073 686f 756c 6420 7573  w code should us
-000279b0: 6520 7468 6520 6060 7a69 7066 6060 206d  e the ``zipf`` m
-000279c0: 6574 686f 6420 6f66 2061 2060 6064 6566  ethod of a ``def
-000279d0: 6175 6c74 5f72 6e67 2829 6060 0d0a 2020  ault_rng()``..  
-000279e0: 2020 2020 696e 7374 616e 6365 2069 6e73      instance ins
-000279f0: 7465 6164 3b20 706c 6561 7365 2073 6565  tead; please see
-00027a00: 2074 6865 203a 7265 663a 6072 616e 646f   the :ref:`rando
-00027a10: 6d2d 7175 6963 6b2d 7374 6172 7460 2e0d  m-quick-start`..
-00027a20: 0a0d 0a20 2050 6172 616d 6574 6572 730d  ...  Parameters.
-00027a30: 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  .  ----------.. 
-00027a40: 2061 203a 2066 6c6f 6174 206f 7220 6172   a : float or ar
-00027a50: 7261 795f 6c69 6b65 206f 6620 666c 6f61  ray_like of floa
-00027a60: 7473 0d0a 2020 2020 2020 4469 7374 7269  ts..      Distri
-00027a70: 6275 7469 6f6e 2070 6172 616d 6574 6572  bution parameter
-00027a80: 2e20 4d75 7374 2062 6520 6772 6561 7465  . Must be greate
-00027a90: 7220 7468 616e 2031 2e0d 0a20 2073 697a  r than 1...  siz
-00027aa0: 6520 3a20 696e 7420 6f72 2074 7570 6c65  e : int or tuple
-00027ab0: 206f 6620 696e 7473 2c20 6f70 7469 6f6e   of ints, option
-00027ac0: 616c 0d0a 2020 2020 2020 4f75 7470 7574  al..      Output
-00027ad0: 2073 6861 7065 2e20 2049 6620 7468 6520   shape.  If the 
-00027ae0: 6769 7665 6e20 7368 6170 6520 6973 2c20  given shape is, 
-00027af0: 652e 672e 2c20 6060 286d 2c20 6e2c 206b  e.g., ``(m, n, k
-00027b00: 2960 602c 2074 6865 6e0d 0a20 2020 2020  )``, then..     
-00027b10: 2060 606d 202a 206e 202a 206b 6060 2073   ``m * n * k`` s
-00027b20: 616d 706c 6573 2061 7265 2064 7261 776e  amples are drawn
-00027b30: 2e20 2049 6620 7369 7a65 2069 7320 6060  .  If size is ``
-00027b40: 4e6f 6e65 6060 2028 6465 6661 756c 7429  None`` (default)
-00027b50: 2c0d 0a20 2020 2020 2061 2073 696e 676c  ,..      a singl
-00027b60: 6520 7661 6c75 6520 6973 2072 6574 7572  e value is retur
-00027b70: 6e65 6420 6966 2060 6061 6060 2069 7320  ned if ``a`` is 
-00027b80: 6120 7363 616c 6172 2e20 4f74 6865 7277  a scalar. Otherw
-00027b90: 6973 652c 0d0a 2020 2020 2020 6060 6e70  ise,..      ``np
-00027ba0: 2e61 7272 6179 2861 292e 7369 7a65 6060  .array(a).size``
-00027bb0: 2073 616d 706c 6573 2061 7265 2064 7261   samples are dra
-00027bc0: 776e 2e0d 0a20 206b 6579 203a 2050 524e  wn...  key : PRN
-00027bd0: 474b 6579 2c20 6f70 7469 6f6e 616c 0d0a  GKey, optional..
-00027be0: 2020 2020 2020 5468 6520 6b65 7920 666f        The key fo
-00027bf0: 7220 7468 6520 7261 6e64 6f6d 206e 756d  r the random num
-00027c00: 6265 7220 6765 6e65 7261 746f 722e 2049  ber generator. I
-00027c10: 6620 6e6f 7420 6769 7665 6e2c 2074 6865  f not given, the
-00027c20: 0d0a 2020 2020 2020 6465 6661 756c 7420  ..      default 
-00027c30: 7261 6e64 6f6d 206e 756d 6265 7220 6765  random number ge
-00027c40: 6e65 7261 746f 7220 6973 2075 7365 642e  nerator is used.
-00027c50: 0d0a 0d0a 2020 5265 7475 726e 730d 0a20  ....  Returns.. 
-00027c60: 202d 2d2d 2d2d 2d2d 0d0a 2020 6f75 7420   -------..  out 
-00027c70: 3a20 6e64 6172 7261 7920 6f72 2073 6361  : ndarray or sca
-00027c80: 6c61 720d 0a20 2020 2020 2044 7261 776e  lar..      Drawn
-00027c90: 2073 616d 706c 6573 2066 726f 6d20 7468   samples from th
-00027ca0: 6520 7061 7261 6d65 7465 7269 7a65 6420  e parameterized 
-00027cb0: 5a69 7066 2064 6973 7472 6962 7574 696f  Zipf distributio
-00027cc0: 6e2e 0d0a 0d0a 2020 5365 6520 416c 736f  n.....  See Also
-00027cd0: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ..  --------..  
-00027ce0: 7363 6970 792e 7374 6174 732e 7a69 7066  scipy.stats.zipf
-00027cf0: 203a 2070 726f 6261 6269 6c69 7479 2064   : probability d
-00027d00: 656e 7369 7479 2066 756e 6374 696f 6e2c  ensity function,
-00027d10: 2064 6973 7472 6962 7574 696f 6e2c 206f   distribution, o
-00027d20: 720d 0a20 2020 2020 2063 756d 756c 6174  r..      cumulat
-00027d30: 6976 6520 6465 6e73 6974 7920 6675 6e63  ive density func
-00027d40: 7469 6f6e 2c20 6574 632e 0d0a 0d0a 2020  tion, etc.....  
-00027d50: 4e6f 7465 730d 0a20 202d 2d2d 2d2d 0d0a  Notes..  -----..
-00027d60: 2020 5468 6520 7072 6f62 6162 696c 6974    The probabilit
-00027d70: 7920 6465 6e73 6974 7920 666f 7220 7468  y density for th
-00027d80: 6520 5a69 7066 2064 6973 7472 6962 7574  e Zipf distribut
-00027d90: 696f 6e20 6973 0d0a 0d0a 2020 2e2e 206d  ion is....  .. m
-00027da0: 6174 683a 3a20 7028 6b29 203d 205c 6672  ath:: p(k) = \fr
-00027db0: 6163 7b6b 5e7b 2d61 7d7d 7b5c 7a65 7461  ac{k^{-a}}{\zeta
-00027dc0: 2861 297d 2c0d 0a0d 0a20 2066 6f72 2069  (a)},....  for i
-00027dd0: 6e74 6567 6572 7320 3a6d 6174 683a 606b  ntegers :math:`k
-00027de0: 205c 6765 7120 3160 2c20 7768 6572 6520   \geq 1`, where 
-00027df0: 3a6d 6174 683a 605c 7a65 7461 6020 6973  :math:`\zeta` is
-00027e00: 2074 6865 2052 6965 6d61 6e6e 205a 6574   the Riemann Zet
-00027e10: 610d 0a20 2066 756e 6374 696f 6e2e 0d0a  a..  function...
-00027e20: 0d0a 2020 4974 2069 7320 6e61 6d65 6420  ..  It is named 
-00027e30: 666f 7220 7468 6520 416d 6572 6963 616e  for the American
-00027e40: 206c 696e 6775 6973 7420 4765 6f72 6765   linguist George
-00027e50: 204b 696e 6773 6c65 7920 5a69 7066 2c20   Kingsley Zipf, 
-00027e60: 7768 6f20 6e6f 7465 640d 0a20 2074 6861  who noted..  tha
-00027e70: 7420 7468 6520 6672 6571 7565 6e63 7920  t the frequency 
-00027e80: 6f66 2061 6e79 2077 6f72 6420 696e 2061  of any word in a
-00027e90: 2073 616d 706c 6520 6f66 2061 206c 616e   sample of a lan
-00027ea0: 6775 6167 6520 6973 2069 6e76 6572 7365  guage is inverse
-00027eb0: 6c79 0d0a 2020 7072 6f70 6f72 7469 6f6e  ly..  proportion
-00027ec0: 616c 2074 6f20 6974 7320 7261 6e6b 2069  al to its rank i
-00027ed0: 6e20 7468 6520 6672 6571 7565 6e63 7920  n the frequency 
-00027ee0: 7461 626c 652e 0d0a 0d0a 2020 5265 6665  table.....  Refe
-00027ef0: 7265 6e63 6573 0d0a 2020 2d2d 2d2d 2d2d  rences..  ------
-00027f00: 2d2d 2d2d 0d0a 2020 2e2e 205b 315d 205a  ----..  .. [1] Z
-00027f10: 6970 662c 2047 2e20 4b2e 2c20 2253 656c  ipf, G. K., "Sel
-00027f20: 6563 7465 6420 5374 7564 6965 7320 6f66  ected Studies of
-00027f30: 2074 6865 2050 7269 6e63 6970 6c65 206f   the Principle o
-00027f40: 6620 5265 6c61 7469 7665 0d0a 2020 2020  f Relative..    
-00027f50: 2020 2020 2046 7265 7175 656e 6379 2069       Frequency i
-00027f60: 6e20 4c61 6e67 7561 6765 2c22 2043 616d  n Language," Cam
-00027f70: 6272 6964 6765 2c20 4d41 3a20 4861 7276  bridge, MA: Harv
-00027f80: 6172 6420 556e 6976 2e20 5072 6573 732c  ard Univ. Press,
-00027f90: 0d0a 2020 2020 2020 2020 2031 3933 322e  ..         1932.
-00027fa0: 0d0a 0d0a 2020 4578 616d 706c 6573 0d0a  ....  Examples..
-00027fb0: 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020 4472    --------..  Dr
-00027fc0: 6177 2073 616d 706c 6573 2066 726f 6d20  aw samples from 
-00027fd0: 7468 6520 6469 7374 7269 6275 7469 6f6e  the distribution
-00027fe0: 3a0d 0a0d 0a20 203e 3e3e 2061 203d 2034  :....  >>> a = 4
-00027ff0: 2e30 0d0a 2020 3e3e 3e20 6e20 3d20 3230  .0..  >>> n = 20
-00028000: 3030 300d 0a20 203e 3e3e 2073 203d 2062  000..  >>> s = b
-00028010: 7261 696e 636f 7265 2e6d 6174 682e 7261  raincore.math.ra
-00028020: 6e64 6f6d 2e7a 6970 6628 612c 206e 290d  ndom.zipf(a, n).
-00028030: 0a0d 0a20 2044 6973 706c 6179 2074 6865  ...  Display the
-00028040: 2068 6973 746f 6772 616d 206f 6620 7468   histogram of th
-00028050: 6520 7361 6d70 6c65 732c 2061 6c6f 6e67  e samples, along
-00028060: 2077 6974 680d 0a20 2074 6865 2065 7870   with..  the exp
-00028070: 6563 7465 6420 6869 7374 6f67 7261 6d20  ected histogram 
-00028080: 6261 7365 6420 6f6e 2074 6865 2070 726f  based on the pro
-00028090: 6261 6269 6c69 7479 0d0a 2020 6465 6e73  bability..  dens
-000280a0: 6974 7920 6675 6e63 7469 6f6e 3a0d 0a0d  ity function:...
-000280b0: 0a20 203e 3e3e 2069 6d70 6f72 7420 6d61  .  >>> import ma
-000280c0: 7470 6c6f 746c 6962 2e70 7970 6c6f 7420  tplotlib.pyplot 
-000280d0: 6173 2070 6c74 2020 2320 6e6f 7161 0d0a  as plt  # noqa..
-000280e0: 2020 3e3e 3e20 6672 6f6d 2073 6369 7079    >>> from scipy
-000280f0: 2e73 7065 6369 616c 2069 6d70 6f72 7420  .special import 
-00028100: 7a65 7461 2020 2320 646f 6374 6573 743a  zeta  # doctest:
-00028110: 202b 534b 4950 0d0a 0d0a 2020 6062 696e   +SKIP....  `bin
-00028120: 636f 756e 7460 2070 726f 7669 6465 7320  count` provides 
-00028130: 6120 6661 7374 2068 6973 746f 6772 616d  a fast histogram
-00028140: 2066 6f72 2073 6d61 6c6c 2069 6e74 6567   for small integ
-00028150: 6572 732e 0d0a 0d0a 2020 3e3e 3e20 636f  ers.....  >>> co
-00028160: 756e 7420 3d20 6e70 2e62 696e 636f 756e  unt = np.bincoun
-00028170: 7428 7329 0d0a 2020 3e3e 3e20 6b20 3d20  t(s)..  >>> k = 
-00028180: 6e70 2e61 7261 6e67 6528 312c 2073 2e6d  np.arange(1, s.m
-00028190: 6178 2829 202b 2031 290d 0a0d 0a20 203e  ax() + 1)....  >
-000281a0: 3e3e 2070 6c74 2e62 6172 286b 2c20 636f  >> plt.bar(k, co
-000281b0: 756e 745b 313a 5d2c 2061 6c70 6861 3d30  unt[1:], alpha=0
-000281c0: 2e35 2c20 6c61 6265 6c3d 2773 616d 706c  .5, label='sampl
-000281d0: 6520 636f 756e 7427 290d 0a20 203e 3e3e  e count')..  >>>
-000281e0: 2070 6c74 2e70 6c6f 7428 6b2c 206e 2a28   plt.plot(k, n*(
-000281f0: 6b2a 2a2d 6129 2f7a 6574 6128 6129 2c20  k**-a)/zeta(a), 
-00028200: 276b 2e2d 272c 2061 6c70 6861 3d30 2e35  'k.-', alpha=0.5
-00028210: 2c0d 0a20 202e 2e2e 2020 2020 2020 2020  ,..  ...        
-00028220: 2020 6c61 6265 6c3d 2765 7870 6563 7465    label='expecte
-00028230: 6420 636f 756e 7427 2920 2020 2320 646f  d count')   # do
-00028240: 6374 6573 743a 202b 534b 4950 0d0a 2020  ctest: +SKIP..  
-00028250: 3e3e 3e20 706c 742e 7365 6d69 6c6f 6779  >>> plt.semilogy
-00028260: 2829 0d0a 2020 3e3e 3e20 706c 742e 6772  ()..  >>> plt.gr
-00028270: 6964 2861 6c70 6861 3d30 2e34 290d 0a20  id(alpha=0.4).. 
-00028280: 203e 3e3e 2070 6c74 2e6c 6567 656e 6428   >>> plt.legend(
-00028290: 290d 0a20 203e 3e3e 2070 6c74 2e74 6974  )..  >>> plt.tit
-000282a0: 6c65 2866 275a 6970 6620 7361 6d70 6c65  le(f'Zipf sample
-000282b0: 2c20 613d 7b61 7d2c 2073 697a 653d 7b6e  , a={a}, size={n
-000282c0: 7d27 290d 0a20 203e 3e3e 2070 6c74 2e73  }')..  >>> plt.s
-000282d0: 686f 7728 290d 0a20 2022 2222 0d0a 2020  how()..  """..  
-000282e0: 7265 7475 726e 2044 4546 4155 4c54 2e7a  return DEFAULT.z
-000282f0: 6970 6628 612c 2073 697a 652c 206b 6579  ipf(a, size, key
-00028300: 3d6b 6579 2c20 6474 7970 653d 6474 7970  =key, dtype=dtyp
-00028310: 6529 0d0a 0d0a 0d0a 6465 6620 6d61 7877  e)......def maxw
-00028320: 656c 6c28 7369 7a65 3a20 4f70 7469 6f6e  ell(size: Option
-00028330: 616c 5b53 697a 655d 203d 204e 6f6e 652c  al[Size] = None,
-00028340: 0d0a 2020 2020 2020 2020 2020 2020 6b65  ..            ke
-00028350: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
-00028360: 4f72 4b65 795d 203d 204e 6f6e 652c 0d0a  OrKey] = None,..
-00028370: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
-00028380: 653a 2044 5479 7065 4c69 6b65 203d 204e  e: DTypeLike = N
-00028390: 6f6e 6529 3a0d 0a20 2022 2222 5361 6d70  one):..  """Samp
-000283a0: 6c65 2066 726f 6d20 6120 6f6e 6520 7369  le from a one si
-000283b0: 6465 6420 4d61 7877 656c 6c20 6469 7374  ded Maxwell dist
-000283c0: 7269 6275 7469 6f6e 2e0d 0a0d 0a20 2054  ribution.....  T
-000283d0: 6865 2073 6369 7079 2063 6f75 6e74 6572  he scipy counter
-000283e0: 7061 7274 2069 7320 6073 6369 7079 2e73  part is `scipy.s
-000283f0: 7461 7473 2e6d 6178 7765 6c6c 602e 0d0a  tats.maxwell`...
-00028400: 0d0a 2020 4172 6773 3a0d 0a20 2020 206b  ..  Args:..    k
-00028410: 6579 3a20 6120 5052 4e47 206b 6579 2e0d  ey: a PRNG key..
-00028420: 0a20 2020 2073 697a 653a 2054 6865 2073  .    size: The s
-00028430: 6861 7065 206f 6620 7468 6520 7265 7475  hape of the retu
-00028440: 726e 6564 2073 616d 706c 6573 2e0d 0a20  rned samples... 
-00028450: 2020 2064 7479 7065 3a20 5468 6520 7479     dtype: The ty
-00028460: 7065 2075 7365 6420 666f 7220 7361 6d70  pe used for samp
-00028470: 6c65 732e 0d0a 2020 2020 6b65 793a 2061  les...    key: a
-00028480: 2050 524e 4720 6b65 7920 6f72 2061 2073   PRNG key or a s
-00028490: 6565 642e 0d0a 0d0a 2020 5265 7475 726e  eed.....  Return
-000284a0: 733a 0d0a 2020 2020 4120 6a6e 702e 6172  s:..    A jnp.ar
-000284b0: 7261 7920 6f66 2073 616d 706c 6573 2c20  ray of samples, 
-000284c0: 6f66 2073 6861 7065 2060 7368 6170 6560  of shape `shape`
-000284d0: 2e0d 0a0d 0a20 2022 2222 0d0a 2020 7265  .....  """..  re
-000284e0: 7475 726e 2044 4546 4155 4c54 2e6d 6178  turn DEFAULT.max
-000284f0: 7765 6c6c 2873 697a 652c 206b 6579 3d6b  well(size, key=k
-00028500: 6579 2c20 6474 7970 653d 6474 7970 6529  ey, dtype=dtype)
-00028510: 0d0a 0d0a 0d0a 6465 6620 7428 6466 2c0d  ......def t(df,.
-00028520: 0a20 2020 2020 2073 697a 653a 204f 7074  .      size: Opt
-00028530: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
-00028540: 6e65 2c0d 0a20 2020 2020 206b 6579 3a20  ne,..      key: 
-00028550: 4f70 7469 6f6e 616c 5b53 6565 644f 724b  Optional[SeedOrK
-00028560: 6579 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ey] = None,..   
-00028570: 2020 2064 7479 7065 3a20 4454 7970 654c     dtype: DTypeL
-00028580: 696b 6520 3d20 4e6f 6e65 293a 0d0a 2020  ike = None):..  
-00028590: 2222 2253 616d 706c 6520 5374 7564 656e  """Sample Studen
-000285a0: 74e2 8099 7320 7420 7261 6e64 6f6d 2076  t...s t random v
-000285b0: 616c 7565 732e 0d0a 0d0a 2020 5061 7261  alues.....  Para
-000285c0: 6d65 7465 7273 0d0a 2020 2d2d 2d2d 2d2d  meters..  ------
-000285d0: 2d2d 2d2d 0d0a 2020 6466 3a20 666c 6f61  ----..  df: floa
-000285e0: 742c 2061 7272 6179 5f6c 696b 650d 0a20  t, array_like.. 
-000285f0: 2020 2041 2066 6c6f 6174 206f 7220 6172     A float or ar
-00028600: 7261 7920 6f66 2066 6c6f 6174 7320 6272  ray of floats br
-00028610: 6f61 6463 6173 742d 636f 6d70 6174 6962  oadcast-compatib
-00028620: 6c65 2077 6974 6820 7368 6170 6520 7265  le with shape re
-00028630: 7072 6573 656e 7469 6e67 2074 6865 2070  presenting the p
-00028640: 6172 616d 6574 6572 206f 6620 7468 6520  arameter of the 
-00028650: 6469 7374 7269 6275 7469 6f6e 2e0d 0a20  distribution... 
-00028660: 2073 697a 653a 206f 7074 696f 6e61 6c2c   size: optional,
-00028670: 2069 6e74 2c20 7475 706c 6520 6f66 2069   int, tuple of i
-00028680: 6e74 0d0a 2020 2020 4120 7475 706c 6520  nt..    A tuple 
-00028690: 6f66 206e 6f6e 2d6e 6567 6174 6976 6520  of non-negative 
-000286a0: 696e 7465 6765 7273 2073 7065 6369 6679  integers specify
-000286b0: 696e 6720 7468 6520 7265 7375 6c74 2073  ing the result s
-000286c0: 6861 7065 2e0d 0a20 2020 204d 7573 7420  hape...    Must 
-000286d0: 6265 2062 726f 6164 6361 7374 2d63 6f6d  be broadcast-com
-000286e0: 7061 7469 626c 6520 7769 7468 2060 6466  patible with `df
-000286f0: 602e 2054 6865 2064 6566 6175 6c74 2028  `. The default (
-00028700: 4e6f 6e65 2920 7072 6f64 7563 6573 2061  None) produces a
-00028710: 2072 6573 756c 7420 7368 6170 6520 6571   result shape eq
-00028720: 7561 6c20 746f 2060 6466 2e73 6861 7065  ual to `df.shape
-00028730: 602e 0d0a 2020 6b65 7920 3a20 5052 4e47  `...  key : PRNG
-00028740: 4b65 792c 206f 7074 696f 6e61 6c0d 0a20  Key, optional.. 
-00028750: 2020 2020 2054 6865 206b 6579 2066 6f72       The key for
-00028760: 2074 6865 2072 616e 646f 6d20 6e75 6d62   the random numb
-00028770: 6572 2067 656e 6572 6174 6f72 2e20 4966  er generator. If
-00028780: 206e 6f74 2067 6976 656e 2c20 7468 650d   not given, the.
-00028790: 0a20 2020 2020 2064 6566 6175 6c74 2072  .      default r
-000287a0: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
-000287b0: 6572 6174 6f72 2069 7320 7573 6564 2e0d  erator is used..
-000287c0: 0a0d 0a20 2052 6574 7572 6e73 0d0a 2020  ...  Returns..  
-000287d0: 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574 3a20  -------..  out: 
-000287e0: 6172 7261 795f 6c69 6b65 0d0a 2020 2020  array_like..    
-000287f0: 5468 6520 7361 6d70 6c65 6420 7661 6c75  The sampled valu
-00028800: 652e 0d0a 2020 2222 220d 0a20 2072 6574  e...  """..  ret
-00028810: 7572 6e20 4445 4641 554c 542e 7428 6466  urn DEFAULT.t(df
-00028820: 2c20 7369 7a65 2c20 6b65 793d 6b65 792c  , size, key=key,
-00028830: 2064 7479 7065 3d64 7479 7065 290d 0a0d   dtype=dtype)...
-00028840: 0a0d 0a64 6566 206f 7274 686f 676f 6e61  ...def orthogona
-00028850: 6c28 6e3a 2069 6e74 2c0d 0a20 2020 2020  l(n: int,..     
-00028860: 2020 2020 2020 2020 2020 7369 7a65 3a20            size: 
-00028870: 4f70 7469 6f6e 616c 5b53 697a 655d 203d  Optional[Size] =
-00028880: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
-00028890: 2020 2020 2020 206b 6579 3a20 4f70 7469         key: Opti
-000288a0: 6f6e 616c 5b53 6565 644f 724b 6579 5d20  onal[SeedOrKey] 
-000288b0: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 2020  = None,..       
-000288c0: 2020 2020 2020 2020 6474 7970 653a 2044          dtype: D
-000288d0: 5479 7065 4c69 6b65 203d 204e 6f6e 6529  TypeLike = None)
-000288e0: 3a0d 0a20 2022 2222 5361 6d70 6c65 2075  :..  """Sample u
-000288f0: 6e69 666f 726d 6c79 2066 726f 6d20 7468  niformly from th
-00028900: 6520 6f72 7468 6f67 6f6e 616c 2067 726f  e orthogonal gro
-00028910: 7570 2060 4f28 6e29 602e 0d0a 0d0a 2020  up `O(n)`.....  
-00028920: 5061 7261 6d65 7465 7273 0d0a 2020 2d2d  Parameters..  --
-00028930: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 6e3a 2069  --------..  n: i
-00028940: 6e74 0d0a 2020 2020 2041 6e20 696e 7465  nt..     An inte
-00028950: 6765 7220 696e 6469 6361 7469 6e67 2074  ger indicating t
-00028960: 6865 2072 6573 756c 7469 6e67 2064 696d  he resulting dim
-00028970: 656e 7369 6f6e 2e0d 0a20 2073 697a 653a  ension...  size:
-00028980: 206f 7074 696f 6e61 6c2c 2069 6e74 2c20   optional, int, 
-00028990: 7475 706c 6520 6f66 2069 6e74 0d0a 2020  tuple of int..  
-000289a0: 2020 5468 6520 6261 7463 6820 6469 6d65    The batch dime
-000289b0: 6e73 696f 6e73 206f 6620 7468 6520 7265  nsions of the re
-000289c0: 7375 6c74 2e0d 0a20 206b 6579 203a 2050  sult...  key : P
-000289d0: 524e 474b 6579 2c20 6f70 7469 6f6e 616c  RNGKey, optional
-000289e0: 0d0a 2020 2020 2020 5468 6520 6b65 7920  ..      The key 
-000289f0: 666f 7220 7468 6520 7261 6e64 6f6d 206e  for the random n
-00028a00: 756d 6265 7220 6765 6e65 7261 746f 722e  umber generator.
-00028a10: 2049 6620 6e6f 7420 6769 7665 6e2c 2074   If not given, t
-00028a20: 6865 0d0a 2020 2020 2020 6465 6661 756c  he..      defaul
-00028a30: 7420 7261 6e64 6f6d 206e 756d 6265 7220  t random number 
-00028a40: 6765 6e65 7261 746f 7220 6973 2075 7365  generator is use
-00028a50: 642e 0d0a 0d0a 2020 5265 7475 726e 730d  d.....  Returns.
-00028a60: 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020 6f75  .  -------..  ou
-00028a70: 743a 2041 7272 6179 0d0a 2020 2020 5468  t: Array..    Th
-00028a80: 6520 7361 6d70 6c65 6420 7265 7375 6c74  e sampled result
-00028a90: 732e 0d0a 2020 2222 220d 0a20 2072 6574  s...  """..  ret
-00028aa0: 7572 6e20 4445 4641 554c 542e 6f72 7468  urn DEFAULT.orth
-00028ab0: 6f67 6f6e 616c 286e 2c20 7369 7a65 2c20  ogonal(n, size, 
-00028ac0: 6b65 793d 6b65 792c 2064 7479 7065 3d64  key=key, dtype=d
-00028ad0: 7479 7065 290d 0a0d 0a0d 0a64 6566 206c  type)......def l
-00028ae0: 6f67 6761 6d6d 6128 612c 0d0a 2020 2020  oggamma(a,..    
-00028af0: 2020 2020 2020 2020 2073 697a 653a 204f           size: O
-00028b00: 7074 696f 6e61 6c5b 5369 7a65 5d20 3d20  ptional[Size] = 
-00028b10: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
-00028b20: 2020 2020 6b65 793a 204f 7074 696f 6e61      key: Optiona
-00028b30: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
-00028b40: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
-00028b50: 2020 2064 7479 7065 3a20 4454 7970 654c     dtype: DTypeL
-00028b60: 696b 6520 3d20 4e6f 6e65 293a 0d0a 2020  ike = None):..  
-00028b70: 2222 2253 616d 706c 6520 6c6f 672d 6761  """Sample log-ga
-00028b80: 6d6d 6120 7261 6e64 6f6d 2076 616c 7565  mma random value
-00028b90: 732e 0d0a 0d0a 2020 5061 7261 6d65 7465  s.....  Paramete
-00028ba0: 7273 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d  rs..  ----------
-00028bb0: 0d0a 2020 613a 2066 6c6f 6174 2c20 6172  ..  a: float, ar
-00028bc0: 7261 795f 6c69 6b65 0d0a 2020 2020 4120  ray_like..    A 
-00028bd0: 666c 6f61 7420 6f72 2061 7272 6179 206f  float or array o
-00028be0: 6620 666c 6f61 7473 2062 726f 6164 6361  f floats broadca
-00028bf0: 7374 2d63 6f6d 7061 7469 626c 6520 7769  st-compatible wi
-00028c00: 7468 2073 6861 7065 2072 6570 7265 7365  th shape represe
-00028c10: 6e74 696e 6720 7468 6520 7061 7261 6d65  nting the parame
-00028c20: 7465 7220 6f66 2074 6865 2064 6973 7472  ter of the distr
-00028c30: 6962 7574 696f 6e2e 0d0a 2020 7369 7a65  ibution...  size
-00028c40: 3a20 6f70 7469 6f6e 616c 2c20 696e 742c  : optional, int,
-00028c50: 2074 7570 6c65 206f 6620 696e 740d 0a20   tuple of int.. 
-00028c60: 2020 2041 2074 7570 6c65 206f 6620 6e6f     A tuple of no
-00028c70: 6e6e 6567 6174 6976 6520 696e 7465 6765  nnegative intege
-00028c80: 7273 2073 7065 6369 6679 696e 6720 7468  rs specifying th
-00028c90: 6520 7265 7375 6c74 2073 6861 7065 2e0d  e result shape..
-00028ca0: 0a20 2020 204d 7573 7420 6265 2062 726f  .    Must be bro
-00028cb0: 6164 6361 7374 2d63 6f6d 7061 7469 626c  adcast-compatibl
-00028cc0: 6520 7769 7468 2060 6160 2e20 5468 6520  e with `a`. The 
-00028cd0: 6465 6661 756c 7420 284e 6f6e 6529 2070  default (None) p
-00028ce0: 726f 6475 6365 7320 6120 7265 7375 6c74  roduces a result
-00028cf0: 2073 6861 7065 2065 7175 616c 2074 6f20   shape equal to 
-00028d00: 6061 2e73 6861 7065 602e 0d0a 2020 6b65  `a.shape`...  ke
-00028d10: 7920 3a20 5052 4e47 4b65 792c 206f 7074  y : PRNGKey, opt
-00028d20: 696f 6e61 6c0d 0a20 2020 2020 2054 6865  ional..      The
-00028d30: 206b 6579 2066 6f72 2074 6865 2072 616e   key for the ran
-00028d40: 646f 6d20 6e75 6d62 6572 2067 656e 6572  dom number gener
-00028d50: 6174 6f72 2e20 4966 206e 6f74 2067 6976  ator. If not giv
-00028d60: 656e 2c20 7468 650d 0a20 2020 2020 2064  en, the..      d
-00028d70: 6566 6175 6c74 2072 616e 646f 6d20 6e75  efault random nu
-00028d80: 6d62 6572 2067 656e 6572 6174 6f72 2069  mber generator i
-00028d90: 7320 7573 6564 2e0d 0a20 206b 6579 203a  s used...  key :
-00028da0: 2050 524e 474b 6579 2c20 6f70 7469 6f6e   PRNGKey, option
-00028db0: 616c 0d0a 2020 2020 2020 5468 6520 6b65  al..      The ke
-00028dc0: 7920 666f 7220 7468 6520 7261 6e64 6f6d  y for the random
-00028dd0: 206e 756d 6265 7220 6765 6e65 7261 746f   number generato
-00028de0: 722e 2049 6620 6e6f 7420 6769 7665 6e2c  r. If not given,
-00028df0: 2074 6865 0d0a 2020 2020 2020 6465 6661   the..      defa
-00028e00: 756c 7420 7261 6e64 6f6d 206e 756d 6265  ult random numbe
-00028e10: 7220 6765 6e65 7261 746f 7220 6973 2075  r generator is u
-00028e20: 7365 642e 0d0a 0d0a 2020 5265 7475 726e  sed.....  Return
-00028e30: 730d 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020  s..  -------..  
-00028e40: 6f75 743a 2061 7272 6179 5f6c 696b 650d  out: array_like.
-00028e50: 0a20 2020 2054 6865 2073 616d 706c 6564  .    The sampled
-00028e60: 2072 6573 756c 7473 2e0d 0a20 2022 2222   results...  """
-00028e70: 0d0a 2020 7265 7475 726e 2044 4546 4155  ..  return DEFAU
-00028e80: 4c54 2e6c 6f67 6761 6d6d 6128 612c 2073  LT.loggamma(a, s
-00028e90: 697a 652c 206b 6579 3d6b 6579 2c20 6474  ize, key=key, dt
-00028ea0: 7970 653d 6474 7970 6529 0d0a 0d0a 0d0a  ype=dtype)......
-00028eb0: 6465 6620 6361 7465 676f 7269 6361 6c28  def categorical(
-00028ec0: 6c6f 6769 7473 2c0d 0a20 2020 2020 2020  logits,..       
-00028ed0: 2020 2020 2020 2020 2061 7869 733a 2069           axis: i
-00028ee0: 6e74 203d 202d 312c 0d0a 2020 2020 2020  nt = -1,..      
-00028ef0: 2020 2020 2020 2020 2020 7369 7a65 3a20            size: 
-00028f00: 4f70 7469 6f6e 616c 5b53 697a 655d 203d  Optional[Size] =
-00028f10: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
-00028f20: 2020 2020 2020 2020 6b65 793a 204f 7074          key: Opt
-00028f30: 696f 6e61 6c5b 5365 6564 4f72 4b65 795d  ional[SeedOrKey]
-00028f40: 203d 204e 6f6e 6529 3a0d 0a20 2022 2222   = None):..  """
-00028f50: 5361 6d70 6c65 2072 616e 646f 6d20 7661  Sample random va
-00028f60: 6c75 6573 2066 726f 6d20 6361 7465 676f  lues from catego
-00028f70: 7269 6361 6c20 6469 7374 7269 6275 7469  rical distributi
-00028f80: 6f6e 732e 0d0a 0d0a 2020 4172 6773 3a0d  ons.....  Args:.
-00028f90: 0a20 2020 206c 6f67 6974 733a 2055 6e6e  .    logits: Unn
-00028fa0: 6f72 6d61 6c69 7a65 6420 6c6f 6720 7072  ormalized log pr
-00028fb0: 6f62 6162 696c 6974 6965 7320 6f66 2074  obabilities of t
-00028fc0: 6865 2063 6174 6567 6f72 6963 616c 2064  he categorical d
-00028fd0: 6973 7472 6962 7574 696f 6e28 7329 2074  istribution(s) t
-00028fe0: 6f20 7361 6d70 6c65 2066 726f 6d2c 0d0a  o sample from,..
-00028ff0: 2020 2020 2020 736f 2074 6861 7420 6073        so that `s
-00029000: 6f66 746d 6178 286c 6f67 6974 732c 2061  oftmax(logits, a
-00029010: 7869 7329 6020 6769 7665 7320 7468 6520  xis)` gives the 
-00029020: 636f 7272 6573 706f 6e64 696e 6720 7072  corresponding pr
-00029030: 6f62 6162 696c 6974 6965 732e 0d0a 2020  obabilities...  
-00029040: 2020 6178 6973 3a20 4178 6973 2061 6c6f    axis: Axis alo
-00029050: 6e67 2077 6869 6368 206c 6f67 6974 7320  ng which logits 
-00029060: 6265 6c6f 6e67 2074 6f20 7468 6520 7361  belong to the sa
-00029070: 6d65 2063 6174 6567 6f72 6963 616c 2064  me categorical d
-00029080: 6973 7472 6962 7574 696f 6e2e 0d0a 2020  istribution...  
-00029090: 2020 7368 6170 653a 204f 7074 696f 6e61    shape: Optiona
-000290a0: 6c2c 2061 2074 7570 6c65 206f 6620 6e6f  l, a tuple of no
-000290b0: 6e6e 6567 6174 6976 6520 696e 7465 6765  nnegative intege
-000290c0: 7273 2072 6570 7265 7365 6e74 696e 6720  rs representing 
-000290d0: 7468 6520 7265 7375 6c74 2073 6861 7065  the result shape
-000290e0: 2e0d 0a20 2020 2020 204d 7573 7420 6265  ...      Must be
-000290f0: 2062 726f 6164 6361 7374 2d63 6f6d 7061   broadcast-compa
-00029100: 7469 626c 6520 7769 7468 2060 606e 702e  tible with ``np.
-00029110: 6465 6c65 7465 286c 6f67 6974 732e 7368  delete(logits.sh
-00029120: 6170 652c 2061 7869 7329 6060 2e0d 0a20  ape, axis)``... 
-00029130: 2020 2020 2054 6865 2064 6566 6175 6c74       The default
-00029140: 2028 4e6f 6e65 2920 7072 6f64 7563 6573   (None) produces
-00029150: 2061 2072 6573 756c 7420 7368 6170 6520   a result shape 
-00029160: 6571 7561 6c20 746f 2060 606e 702e 6465  equal to ``np.de
-00029170: 6c65 7465 286c 6f67 6974 732e 7368 6170  lete(logits.shap
-00029180: 652c 2061 7869 7329 6060 2e0d 0a20 2020  e, axis)``...   
-00029190: 206b 6579 3a20 6120 5052 4e47 206b 6579   key: a PRNG key
-000291a0: 2075 7365 6420 6173 2074 6865 2072 616e   used as the ran
-000291b0: 646f 6d20 6b65 792e 0d0a 0d0a 2020 5265  dom key.....  Re
-000291c0: 7475 726e 733a 0d0a 2020 2020 4120 7261  turns:..    A ra
-000291d0: 6e64 6f6d 2061 7272 6179 2077 6974 6820  ndom array with 
-000291e0: 696e 7420 6474 7970 6520 616e 6420 7368  int dtype and sh
-000291f0: 6170 6520 6769 7665 6e20 6279 2060 6073  ape given by ``s
-00029200: 6861 7065 6060 2069 6620 6060 7368 6170  hape`` if ``shap
-00029210: 6560 600d 0a20 2020 2069 7320 6e6f 7420  e``..    is not 
-00029220: 4e6f 6e65 2c20 6f72 2065 6c73 6520 6060  None, or else ``
-00029230: 6e70 2e64 656c 6574 6528 6c6f 6769 7473  np.delete(logits
-00029240: 2e73 6861 7065 2c20 6178 6973 2960 602e  .shape, axis)``.
-00029250: 0d0a 2020 2222 220d 0a20 2072 6574 7572  ..  """..  retur
-00029260: 6e20 4445 4641 554c 542e 6361 7465 676f  n DEFAULT.catego
-00029270: 7269 6361 6c28 6c6f 6769 7473 2c20 6178  rical(logits, ax
-00029280: 6973 2c20 7369 7a65 2c20 6b65 793d 6b65  is, size, key=ke
-00029290: 7929 0d0a 0d0a 0d0a 6465 6620 7261 6e64  y)......def rand
-000292a0: 5f6c 696b 6528 696e 7075 742c 202a 2c20  _like(input, *, 
-000292b0: 6474 7970 653d 4e6f 6e65 2c20 6b65 793a  dtype=None, key:
-000292c0: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
-000292d0: 4b65 795d 203d 204e 6f6e 6529 3a0d 0a20  Key] = None):.. 
-000292e0: 2022 2222 5369 6d69 6c61 7220 746f 2060   """Similar to `
-000292f0: 6072 616e 645f 6c69 6b65 6060 2069 6e20  `rand_like`` in 
-00029300: 746f 7263 682e 0d0a 0d0a 2020 5265 7475  torch.....  Retu
-00029310: 726e 7320 6120 7465 6e73 6f72 2077 6974  rns a tensor wit
-00029320: 6820 7468 6520 7361 6d65 2073 697a 6520  h the same size 
-00029330: 6173 2069 6e70 7574 2074 6861 7420 6973  as input that is
-00029340: 2066 696c 6c65 6420 7769 7468 2072 616e   filled with ran
-00029350: 646f 6d0d 0a20 206e 756d 6265 7273 2066  dom..  numbers f
-00029360: 726f 6d20 6120 756e 6966 6f72 6d20 6469  rom a uniform di
-00029370: 7374 7269 6275 7469 6f6e 206f 6e20 7468  stribution on th
-00029380: 6520 696e 7465 7276 616c 2060 605b 302c  e interval ``[0,
-00029390: 2031 2960 602e 0d0a 0d0a 2020 4172 6773   1)``.....  Args
-000293a0: 3a0d 0a20 2020 2069 6e70 7574 3a20 2074  :..    input:  t
-000293b0: 6865 2060 6073 697a 6560 6020 6f66 2069  he ``size`` of i
-000293c0: 6e70 7574 2077 696c 6c20 6465 7465 726d  nput will determ
-000293d0: 696e 6520 7369 7a65 206f 6620 7468 6520  ine size of the 
-000293e0: 6f75 7470 7574 2074 656e 736f 722e 0d0a  output tensor...
-000293f0: 2020 2020 6474 7970 653a 2020 7468 6520      dtype:  the 
-00029400: 6465 7369 7265 6420 6461 7461 2074 7970  desired data typ
-00029410: 6520 6f66 2072 6574 7572 6e65 6420 5465  e of returned Te
-00029420: 6e73 6f72 2e20 4465 6661 756c 743a 2069  nsor. Default: i
-00029430: 6620 6060 4e6f 6e65 6060 2c20 6465 6661  f ``None``, defa
-00029440: 756c 7473 2074 6f20 7468 6520 6474 7970  ults to the dtyp
-00029450: 6520 6f66 2069 6e70 7574 2e0d 0a20 2020  e of input...   
-00029460: 206b 6579 3a20 7468 6520 7365 6564 206f   key: the seed o
-00029470: 7220 6b65 7920 666f 7220 7468 6520 7261  r key for the ra
-00029480: 6e64 6f6d 2e0d 0a0d 0a20 2052 6574 7572  ndom.....  Retur
-00029490: 6e73 3a0d 0a20 2020 2054 6865 2072 616e  ns:..    The ran
-000294a0: 646f 6d20 6461 7461 2e0d 0a20 2022 2222  dom data...  """
-000294b0: 0d0a 2020 7265 7475 726e 2044 4546 4155  ..  return DEFAU
-000294c0: 4c54 2e72 616e 645f 6c69 6b65 2869 6e70  LT.rand_like(inp
-000294d0: 7574 2c20 6474 7970 653d 6474 7970 652c  ut, dtype=dtype,
-000294e0: 206b 6579 3d6b 6579 290d 0a0d 0a0d 0a64   key=key)......d
-000294f0: 6566 2072 616e 646e 5f6c 696b 6528 696e  ef randn_like(in
-00029500: 7075 742c 202a 2c20 6474 7970 653d 4e6f  put, *, dtype=No
-00029510: 6e65 2c20 6b65 793a 204f 7074 696f 6e61  ne, key: Optiona
-00029520: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
-00029530: 6f6e 6529 3a0d 0a20 2022 2222 5369 6d69  one):..  """Simi
-00029540: 6c61 7220 746f 2060 6072 616e 646e 5f6c  lar to ``randn_l
-00029550: 696b 6560 6020 696e 2074 6f72 6368 2e0d  ike`` in torch..
-00029560: 0a0d 0a20 2052 6574 7572 6e73 2061 2074  ...  Returns a t
-00029570: 656e 736f 7220 7769 7468 2074 6865 2073  ensor with the s
-00029580: 616d 6520 7369 7a65 2061 7320 6060 696e  ame size as ``in
-00029590: 7075 7460 6020 7468 6174 2069 7320 6669  put`` that is fi
-000295a0: 6c6c 6564 2077 6974 680d 0a20 2072 616e  lled with..  ran
-000295b0: 646f 6d20 6e75 6d62 6572 7320 6672 6f6d  dom numbers from
-000295c0: 2061 206e 6f72 6d61 6c20 6469 7374 7269   a normal distri
-000295d0: 6275 7469 6f6e 2077 6974 6820 6d65 616e  bution with mean
-000295e0: 2030 2061 6e64 2076 6172 6961 6e63 6520   0 and variance 
-000295f0: 312e 0d0a 0d0a 2020 4172 6773 3a0d 0a20  1.....  Args:.. 
-00029600: 2020 2069 6e70 7574 3a20 2074 6865 2060     input:  the `
-00029610: 6073 697a 6560 6020 6f66 2069 6e70 7574  `size`` of input
-00029620: 2077 696c 6c20 6465 7465 726d 696e 6520   will determine 
-00029630: 7369 7a65 206f 6620 7468 6520 6f75 7470  size of the outp
-00029640: 7574 2074 656e 736f 722e 0d0a 2020 2020  ut tensor...    
-00029650: 6474 7970 653a 2020 7468 6520 6465 7369  dtype:  the desi
-00029660: 7265 6420 6461 7461 2074 7970 6520 6f66  red data type of
-00029670: 2072 6574 7572 6e65 6420 5465 6e73 6f72   returned Tensor
-00029680: 2e20 4465 6661 756c 743a 2069 6620 6060  . Default: if ``
-00029690: 4e6f 6e65 6060 2c20 6465 6661 756c 7473  None``, defaults
-000296a0: 2074 6f20 7468 6520 6474 7970 6520 6f66   to the dtype of
-000296b0: 2069 6e70 7574 2e0d 0a20 2020 206b 6579   input...    key
-000296c0: 3a20 7468 6520 7365 6564 206f 7220 6b65  : the seed or ke
-000296d0: 7920 666f 7220 7468 6520 7261 6e64 6f6d  y for the random
-000296e0: 2e0d 0a0d 0a20 2052 6574 7572 6e73 3a0d  .....  Returns:.
-000296f0: 0a20 2020 2054 6865 2072 616e 646f 6d20  .    The random 
-00029700: 6461 7461 2e0d 0a20 2022 2222 0d0a 2020  data...  """..  
-00029710: 7265 7475 726e 2044 4546 4155 4c54 2e72  return DEFAULT.r
-00029720: 616e 646e 5f6c 696b 6528 696e 7075 742c  andn_like(input,
-00029730: 2064 7479 7065 3d64 7479 7065 2c20 6b65   dtype=dtype, ke
-00029740: 793d 6b65 7929 0d0a 0d0a 0d0a 6465 6620  y=key)......def 
-00029750: 7261 6e64 696e 745f 6c69 6b65 2869 6e70  randint_like(inp
-00029760: 7574 2c20 6c6f 773d 302c 2068 6967 683d  ut, low=0, high=
-00029770: 4e6f 6e65 2c20 2a2c 2064 7479 7065 3d4e  None, *, dtype=N
-00029780: 6f6e 652c 206b 6579 3a20 4f70 7469 6f6e  one, key: Option
-00029790: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
-000297a0: 4e6f 6e65 293a 0d0a 2020 2222 2253 696d  None):..  """Sim
-000297b0: 696c 6172 2074 6f20 6060 7261 6e64 696e  ilar to ``randin
-000297c0: 745f 6c69 6b65 6060 2069 6e20 746f 7263  t_like`` in torc
-000297d0: 682e 0d0a 0d0a 2020 5265 7475 726e 7320  h.....  Returns 
-000297e0: 6120 7465 6e73 6f72 2077 6974 6820 7468  a tensor with th
-000297f0: 6520 7361 6d65 2073 6861 7065 2061 7320  e same shape as 
-00029800: 5465 6e73 6f72 2060 6069 6e70 7574 6060  Tensor ``input``
-00029810: 2066 696c 6c65 6420 7769 7468 0d0a 2020   filled with..  
-00029820: 7261 6e64 6f6d 2069 6e74 6567 6572 7320  random integers 
-00029830: 6765 6e65 7261 7465 6420 756e 6966 6f72  generated unifor
-00029840: 6d6c 7920 6265 7477 6565 6e20 6060 6c6f  mly between ``lo
-00029850: 7760 6020 2869 6e63 6c75 7369 7665 2920  w`` (inclusive) 
-00029860: 616e 6420 6060 6869 6768 6060 2028 6578  and ``high`` (ex
-00029870: 636c 7573 6976 6529 2e0d 0a0d 0a20 2041  clusive).....  A
-00029880: 7267 733a 0d0a 2020 2020 696e 7075 743a  rgs:..    input:
-00029890: 2020 7468 6520 6060 7369 7a65 6060 206f    the ``size`` o
-000298a0: 6620 696e 7075 7420 7769 6c6c 2064 6574  f input will det
-000298b0: 6572 6d69 6e65 2073 697a 6520 6f66 2074  ermine size of t
-000298c0: 6865 206f 7574 7075 7420 7465 6e73 6f72  he output tensor
-000298d0: 2e0d 0a20 2020 206c 6f77 3a20 4c6f 7765  ...    low: Lowe
-000298e0: 7374 2069 6e74 6567 6572 2074 6f20 6265  st integer to be
-000298f0: 2064 7261 776e 2066 726f 6d20 7468 6520   drawn from the 
-00029900: 6469 7374 7269 6275 7469 6f6e 2e20 4465  distribution. De
-00029910: 6661 756c 743a 2030 2e0d 0a20 2020 2068  fault: 0...    h
-00029920: 6967 683a 204f 6e65 2061 626f 7665 2074  igh: One above t
-00029930: 6865 2068 6967 6865 7374 2069 6e74 6567  he highest integ
-00029940: 6572 2074 6f20 6265 2064 7261 776e 2066  er to be drawn f
-00029950: 726f 6d20 7468 6520 6469 7374 7269 6275  rom the distribu
-00029960: 7469 6f6e 2e0d 0a20 2020 2064 7479 7065  tion...    dtype
-00029970: 3a20 7468 6520 6465 7369 7265 6420 6461  : the desired da
-00029980: 7461 2074 7970 6520 6f66 2072 6574 7572  ta type of retur
-00029990: 6e65 6420 5465 6e73 6f72 2e20 4465 6661  ned Tensor. Defa
-000299a0: 756c 743a 2069 6620 6060 4e6f 6e65 6060  ult: if ``None``
-000299b0: 2c20 6465 6661 756c 7473 2074 6f20 7468  , defaults to th
-000299c0: 6520 6474 7970 6520 6f66 2069 6e70 7574  e dtype of input
-000299d0: 2e0d 0a20 2020 206b 6579 3a20 7468 6520  ...    key: the 
-000299e0: 7365 6564 206f 7220 6b65 7920 666f 7220  seed or key for 
-000299f0: 7468 6520 7261 6e64 6f6d 2e0d 0a0d 0a20  the random..... 
-00029a00: 2052 6574 7572 6e73 3a0d 0a20 2020 2054   Returns:..    T
-00029a10: 6865 2072 616e 646f 6d20 6461 7461 2e0d  he random data..
-00029a20: 0a20 2022 2222 0d0a 2020 7265 7475 726e  .  """..  return
-00029a30: 2044 4546 4155 4c54 2e72 616e 6469 6e74   DEFAULT.randint
-00029a40: 5f6c 696b 6528 696e 7075 743d 696e 7075  _like(input=inpu
-00029a50: 742c 206c 6f77 3d6c 6f77 2c20 6869 6768  t, low=low, high
-00029a60: 3d68 6967 682c 2064 7479 7065 3d64 7479  =high, dtype=dty
-00029a70: 7065 2c20 6b65 793d 6b65 7929 0d0a 0d0a  pe, key=key)....
-00029a80: 0d0a 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ..# ------------
-00029a90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00029aa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00029ab0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00029ac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00029ad0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00029ae0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00029af0: 2d2d 2d0d 0a0d 0a0d 0a64 6566 205f 666f  ---......def _fo
-00029b00: 726d 616c 697a 655f 6b65 7928 6b65 7929  rmalize_key(key)
-00029b10: 3a0d 0a20 2069 6620 6973 696e 7374 616e  :..  if isinstan
-00029b20: 6365 286b 6579 2c20 696e 7429 3a0d 0a20  ce(key, int):.. 
-00029b30: 2020 2072 6574 7572 6e20 6a72 2e50 524e     return jr.PRN
-00029b40: 474b 6579 286b 6579 290d 0a20 2065 6c69  GKey(key)..  eli
-00029b50: 6620 6973 696e 7374 616e 6365 286b 6579  f isinstance(key
-00029b60: 2c20 286a 6178 2e41 7272 6179 2c20 6e70  , (jax.Array, np
-00029b70: 2e6e 6461 7272 6179 2929 3a0d 0a20 2020  .ndarray)):..   
-00029b80: 2069 6620 6b65 792e 6474 7970 6520 213d   if key.dtype !=
-00029b90: 206a 6e70 2e75 696e 7433 323a 0d0a 2020   jnp.uint32:..  
-00029ba0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-00029bb0: 726f 7228 276b 6579 206d 7573 7420 6265  ror('key must be
-00029bc0: 2061 2069 6e74 206f 7220 616e 2061 7272   a int or an arr
-00029bd0: 6179 2077 6974 6820 7477 6f20 7569 6e74  ay with two uint
-00029be0: 3332 2e27 290d 0a20 2020 2069 6620 6b65  32.')..    if ke
-00029bf0: 792e 7369 7a65 2021 3d20 323a 0d0a 2020  y.size != 2:..  
-00029c00: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-00029c10: 726f 7228 276b 6579 206d 7573 7420 6265  ror('key must be
-00029c20: 2061 2069 6e74 206f 7220 616e 2061 7272   a int or an arr
-00029c30: 6179 2077 6974 6820 7477 6f20 7569 6e74  ay with two uint
-00029c40: 3332 2e27 290d 0a20 2020 2072 6574 7572  32.')..    retur
-00029c50: 6e20 6a6e 702e 6173 6172 7261 7928 6b65  n jnp.asarray(ke
-00029c60: 792c 2064 7479 7065 3d6a 6e70 2e75 696e  y, dtype=jnp.uin
-00029c70: 7433 3229 0d0a 2020 656c 7365 3a0d 0a20  t32)..  else:.. 
-00029c80: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-00029c90: 6f72 2827 6b65 7920 6d75 7374 2062 6520  or('key must be 
-00029ca0: 6120 696e 7420 6f72 2061 6e20 6172 7261  a int or an arra
-00029cb0: 7920 7769 7468 2074 776f 2075 696e 7433  y with two uint3
-00029cc0: 322e 2729 0d0a 0d0a 0d0a 6465 6620 5f73  2.')......def _s
-00029cd0: 697a 6532 7368 6170 6528 7369 7a65 293a  ize2shape(size):
-00029ce0: 0d0a 2020 6966 2073 697a 6520 6973 204e  ..  if size is N
-00029cf0: 6f6e 653a 0d0a 2020 2020 7265 7475 726e  one:..    return
-00029d00: 2028 290d 0a20 2065 6c69 6620 6973 696e   ()..  elif isin
-00029d10: 7374 616e 6365 2873 697a 652c 2028 7475  stance(size, (tu
-00029d20: 706c 652c 206c 6973 7429 293a 0d0a 2020  ple, list)):..  
-00029d30: 2020 7265 7475 726e 2074 7570 6c65 2873    return tuple(s
-00029d40: 697a 6529 0d0a 2020 656c 7365 3a0d 0a20  ize)..  else:.. 
-00029d50: 2020 2072 6574 7572 6e20 2873 697a 652c     return (size,
-00029d60: 290d 0a0d 0a0d 0a64 6566 205f 6368 6563  )......def _chec
-00029d70: 6b5f 7368 6170 6528 6e61 6d65 2c20 7368  k_shape(name, sh
-00029d80: 6170 652c 202a 7061 7261 6d5f 7368 6170  ape, *param_shap
-00029d90: 6573 293a 0d0a 2020 7368 6170 6520 3d20  es):..  shape = 
-00029da0: 636f 7265 2e61 735f 6e61 6d65 645f 7368  core.as_named_sh
-00029db0: 6170 6528 7368 6170 6529 0d0a 2020 6966  ape(shape)..  if
-00029dc0: 2070 6172 616d 5f73 6861 7065 733a 0d0a   param_shapes:..
-00029dd0: 2020 2020 7368 6170 655f 203d 206c 6178      shape_ = lax
-00029de0: 2e62 726f 6164 6361 7374 5f73 6861 7065  .broadcast_shape
-00029df0: 7328 7368 6170 652e 706f 7369 7469 6f6e  s(shape.position
-00029e00: 616c 2c20 2a70 6172 616d 5f73 6861 7065  al, *param_shape
-00029e10: 7329 0d0a 2020 2020 6966 2073 6861 7065  s)..    if shape
-00029e20: 2e70 6f73 6974 696f 6e61 6c20 213d 2073  .positional != s
-00029e30: 6861 7065 5f3a 0d0a 2020 2020 2020 6d73  hape_:..      ms
-00029e40: 6720 3d20 2822 7b7d 2070 6172 616d 6574  g = ("{} paramet
-00029e50: 6572 2073 6861 7065 7320 6d75 7374 2062  er shapes must b
-00029e60: 6520 6272 6f61 6463 6173 742d 636f 6d70  e broadcast-comp
-00029e70: 6174 6962 6c65 2077 6974 6820 7368 6170  atible with shap
-00029e80: 6520 220d 0a20 2020 2020 2020 2020 2020  e "..           
-00029e90: 2020 2261 7267 756d 656e 742c 2061 6e64    "argument, and
-00029ea0: 2074 6865 2072 6573 756c 7420 6f66 2062   the result of b
-00029eb0: 726f 6164 6361 7374 696e 6720 7468 6520  roadcasting the 
-00029ec0: 7368 6170 6573 206d 7573 7420 6571 7561  shapes must equa
-00029ed0: 6c20 220d 0a20 2020 2020 2020 2020 2020  l "..           
-00029ee0: 2020 2274 6865 2073 6861 7065 2061 7267    "the shape arg
-00029ef0: 756d 656e 742c 2062 7574 2067 6f74 2072  ument, but got r
-00029f00: 6573 756c 7420 7b7d 2066 6f72 2073 6861  esult {} for sha
-00029f10: 7065 2061 7267 756d 656e 7420 7b7d 2e22  pe argument {}."
-00029f20: 290d 0a20 2020 2020 2072 6169 7365 2056  )..      raise V
-00029f30: 616c 7565 4572 726f 7228 6d73 672e 666f  alueError(msg.fo
-00029f40: 726d 6174 286e 616d 652c 2073 6861 7065  rmat(name, shape
-00029f50: 5f2c 2073 6861 7065 2929 0d0a 0d0a 0d0a  _, shape))......
-00029f60: 6465 6620 5f69 735f 7079 7468 6f6e 5f73  def _is_python_s
-00029f70: 6361 6c61 7228 7829 3a0d 0a20 2069 6620  calar(x):..  if 
-00029f80: 6861 7361 7474 7228 782c 2027 6176 616c  hasattr(x, 'aval
-00029f90: 2729 3a0d 0a20 2020 2072 6574 7572 6e20  '):..    return 
-00029fa0: 782e 6176 616c 2e77 6561 6b5f 7479 7065  x.aval.weak_type
-00029fb0: 0d0a 2020 656c 6966 206e 702e 6e64 696d  ..  elif np.ndim
-00029fc0: 2878 2920 3d3d 2030 3a0d 0a20 2020 2072  (x) == 0:..    r
-00029fd0: 6574 7572 6e20 5472 7565 0d0a 2020 656c  eturn True..  el
-00029fe0: 6966 2069 7369 6e73 7461 6e63 6528 782c  if isinstance(x,
-00029ff0: 2028 626f 6f6c 2c20 696e 742c 2066 6c6f   (bool, int, flo
-0002a000: 6174 2c20 636f 6d70 6c65 7829 293a 0d0a  at, complex)):..
-0002a010: 2020 2020 7265 7475 726e 2054 7275 650d      return True.
-0002a020: 0a20 2065 6c73 653a 0d0a 2020 2020 7265  .  else:..    re
-0002a030: 7475 726e 2046 616c 7365 0d0a 0d0a 0d0a  turn False......
-0002a040: 7079 7468 6f6e 5f73 6361 6c61 725f 6474  python_scalar_dt
-0002a050: 7970 6573 203d 207b 0d0a 2020 626f 6f6c  ypes = {..  bool
-0002a060: 3a20 6e70 2e64 7479 7065 2827 626f 6f6c  : np.dtype('bool
-0002a070: 2729 2c0d 0a20 2069 6e74 3a20 6e70 2e64  '),..  int: np.d
-0002a080: 7479 7065 2827 696e 7436 3427 292c 0d0a  type('int64'),..
-0002a090: 2020 666c 6f61 743a 206e 702e 6474 7970    float: np.dtyp
-0002a0a0: 6528 2766 6c6f 6174 3634 2729 2c0d 0a20  e('float64'),.. 
-0002a0b0: 2063 6f6d 706c 6578 3a20 6e70 2e64 7479   complex: np.dty
-0002a0c0: 7065 2827 636f 6d70 6c65 7831 3238 2729  pe('complex128')
-0002a0d0: 2c0d 0a7d 0d0a 0d0a 0d0a 6465 6620 5f64  ,..}......def _d
-0002a0e0: 7479 7065 2878 2c20 2a2c 2063 616e 6f6e  type(x, *, canon
-0002a0f0: 6963 616c 697a 653a 2062 6f6f 6c20 3d20  icalize: bool = 
-0002a100: 4661 6c73 6529 3a0d 0a20 2022 2222 5265  False):..  """Re
-0002a110: 7475 726e 2074 6865 2064 7479 7065 206f  turn the dtype o
-0002a120: 626a 6563 7420 666f 7220 6120 7661 6c75  bject for a valu
-0002a130: 6520 6f72 2074 7970 652c 206f 7074 696f  e or type, optio
-0002a140: 6e61 6c6c 7920 6361 6e6f 6e69 6361 6c69  nally canonicali
-0002a150: 7a65 6420 6261 7365 6420 6f6e 2058 3634  zed based on X64
-0002a160: 206d 6f64 652e 2222 220d 0a20 2069 6620   mode."""..  if 
-0002a170: 7820 6973 204e 6f6e 653a 0d0a 2020 2020  x is None:..    
-0002a180: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0002a190: 2866 2249 6e76 616c 6964 2061 7267 756d  (f"Invalid argum
-0002a1a0: 656e 7420 746f 2064 7479 7065 3a20 7b78  ent to dtype: {x
-0002a1b0: 7d2e 2229 0d0a 2020 656c 6966 2069 7369  }.")..  elif isi
-0002a1c0: 6e73 7461 6e63 6528 782c 2074 7970 6529  nstance(x, type)
-0002a1d0: 2061 6e64 2078 2069 6e20 7079 7468 6f6e   and x in python
-0002a1e0: 5f73 6361 6c61 725f 6474 7970 6573 3a0d  _scalar_dtypes:.
-0002a1f0: 0a20 2020 2064 7420 3d20 7079 7468 6f6e  .    dt = python
-0002a200: 5f73 6361 6c61 725f 6474 7970 6573 5b78  _scalar_dtypes[x
-0002a210: 5d0d 0a20 2065 6c69 6620 7479 7065 2878  ]..  elif type(x
-0002a220: 2920 696e 2070 7974 686f 6e5f 7363 616c  ) in python_scal
-0002a230: 6172 5f64 7479 7065 733a 0d0a 2020 2020  ar_dtypes:..    
-0002a240: 6474 203d 2070 7974 686f 6e5f 7363 616c  dt = python_scal
-0002a250: 6172 5f64 7479 7065 735b 7479 7065 2878  ar_dtypes[type(x
-0002a260: 295d 0d0a 2020 656c 6966 2068 6173 6174  )]..  elif hasat
-0002a270: 7472 2878 2c20 2764 7479 7065 2729 3a0d  tr(x, 'dtype'):.
-0002a280: 0a20 2020 2064 7420 3d20 782e 6474 7970  .    dt = x.dtyp
-0002a290: 650d 0a20 2065 6c73 653a 0d0a 2020 2020  e..  else:..    
-0002a2a0: 6474 203d 206e 702e 7265 7375 6c74 5f74  dt = np.result_t
-0002a2b0: 7970 6528 7829 0d0a 2020 7265 7475 726e  ype(x)..  return
-0002a2c0: 2064 7479 7065 732e 6361 6e6f 6e69 6361   dtypes.canonica
-0002a2d0: 6c69 7a65 5f64 7479 7065 2864 7429 2069  lize_dtype(dt) i
-0002a2e0: 6620 6361 6e6f 6e69 6361 6c69 7a65 2065  f canonicalize e
-0002a2f0: 6c73 6520 6474 0d0a 0d0a 0d0a 6465 6620  lse dt......def 
-0002a300: 5f63 6f6e 7374 2865 7861 6d70 6c65 2c20  _const(example, 
-0002a310: 7661 6c29 3a0d 0a20 2069 6620 5f69 735f  val):..  if _is_
-0002a320: 7079 7468 6f6e 5f73 6361 6c61 7228 6578  python_scalar(ex
-0002a330: 616d 706c 6529 3a0d 0a20 2020 2064 7479  ample):..    dty
-0002a340: 7065 203d 2064 7479 7065 732e 6361 6e6f  pe = dtypes.cano
-0002a350: 6e69 6361 6c69 7a65 5f64 7479 7065 2874  nicalize_dtype(t
-0002a360: 7970 6528 6578 616d 706c 6529 290d 0a20  ype(example)).. 
-0002a370: 2020 2076 616c 203d 2064 7479 7065 732e     val = dtypes.
-0002a380: 7363 616c 6172 5f74 7970 655f 6f66 2865  scalar_type_of(e
-0002a390: 7861 6d70 6c65 2928 7661 6c29 0d0a 2020  xample)(val)..  
-0002a3a0: 2020 7265 7475 726e 2076 616c 2069 6620    return val if 
-0002a3b0: 6474 7970 6520 3d3d 205f 6474 7970 6528  dtype == _dtype(
-0002a3c0: 7661 6c2c 2063 616e 6f6e 6963 616c 697a  val, canonicaliz
-0002a3d0: 653d 5472 7565 2920 656c 7365 206e 702e  e=True) else np.
-0002a3e0: 6172 7261 7928 7661 6c2c 2064 7479 7065  array(val, dtype
-0002a3f0: 290d 0a20 2065 6c73 653a 0d0a 2020 2020  )..  else:..    
-0002a400: 6474 7970 6520 3d20 6474 7970 6573 2e63  dtype = dtypes.c
-0002a410: 616e 6f6e 6963 616c 697a 655f 6474 7970  anonicalize_dtyp
-0002a420: 6528 6578 616d 706c 652e 6474 7970 6529  e(example.dtype)
-0002a430: 0d0a 2020 7265 7475 726e 206e 702e 6172  ..  return np.ar
-0002a440: 7261 7928 7661 6c2c 2064 7479 7065 290d  ray(val, dtype).
-0002a450: 0a0d 0a0d 0a5f 7472 5f70 6172 616d 7320  ....._tr_params 
-0002a460: 3d20 6e61 6d65 6474 7570 6c65 280d 0a20  = namedtuple(.. 
-0002a470: 2022 7472 5f70 6172 616d 7322 2c20 5b22   "tr_params", ["
-0002a480: 6322 2c20 2262 222c 2022 6122 2c20 2261  c", "b", "a", "a
-0002a490: 6c70 6861 222c 2022 755f 7222 2c20 2276  lpha", "u_r", "v
-0002a4a0: 5f72 222c 2022 6d22 2c20 226c 6f67 5f70  _r", "m", "log_p
-0002a4b0: 222c 2022 6c6f 6731 5f70 222c 2022 6c6f  ", "log1_p", "lo
-0002a4c0: 675f 6822 5d0d 0a29 0d0a 0d0a 0d0a 6465  g_h"]..)......de
-0002a4d0: 6620 5f67 6574 5f74 725f 7061 7261 6d73  f _get_tr_params
-0002a4e0: 286e 2c20 7029 3a0d 0a20 2023 2053 6565  (n, p):..  # See
-0002a4f0: 2054 6162 6c65 2031 2e20 4164 6469 7469   Table 1. Additi
-0002a500: 6f6e 616c 6c79 2c20 7765 2070 7265 2d63  onally, we pre-c
-0002a510: 6f6d 7075 7465 206c 6f67 2870 292c 206c  ompute log(p), l
-0002a520: 6f67 3128 2d70 2920 616e 6420 7468 650d  og1(-p) and the.
-0002a530: 0a20 2023 2063 6f6e 7374 616e 7420 7465  .  # constant te
-0002a540: 726d 732c 2074 6861 7420 6465 7065 6e64  rms, that depend
-0002a550: 206f 6e6c 7920 6f6e 2028 6e2c 2070 2c20   only on (n, p, 
-0002a560: 6d29 2069 6e20 6c6f 6728 6628 6b29 2920  m) in log(f(k)) 
-0002a570: 2862 6f74 746f 6d20 6f66 2070 6167 6520  (bottom of page 
-0002a580: 3529 2e0d 0a20 206d 7520 3d20 6e20 2a20  5)...  mu = n * 
-0002a590: 700d 0a20 2073 7071 203d 206a 6e70 2e73  p..  spq = jnp.s
-0002a5a0: 7172 7428 6d75 202a 2028 3120 2d20 7029  qrt(mu * (1 - p)
-0002a5b0: 290d 0a20 2063 203d 206d 7520 2b20 302e  )..  c = mu + 0.
-0002a5c0: 350d 0a20 2062 203d 2031 2e31 3520 2b20  5..  b = 1.15 + 
-0002a5d0: 322e 3533 202a 2073 7071 0d0a 2020 6120  2.53 * spq..  a 
-0002a5e0: 3d20 2d30 2e30 3837 3320 2b20 302e 3032  = -0.0873 + 0.02
-0002a5f0: 3438 202a 2062 202b 2030 2e30 3120 2a20  48 * b + 0.01 * 
-0002a600: 700d 0a20 2061 6c70 6861 203d 2028 322e  p..  alpha = (2.
-0002a610: 3833 202b 2035 2e31 202f 2062 2920 2a20  83 + 5.1 / b) * 
-0002a620: 7370 710d 0a20 2075 5f72 203d 2030 2e34  spq..  u_r = 0.4
-0002a630: 330d 0a20 2076 5f72 203d 2030 2e39 3220  3..  v_r = 0.92 
-0002a640: 2d20 342e 3220 2f20 620d 0a20 206d 203d  - 4.2 / b..  m =
-0002a650: 206a 6e70 2e66 6c6f 6f72 2828 6e20 2b20   jnp.floor((n + 
-0002a660: 3129 202a 2070 292e 6173 7479 7065 286e  1) * p).astype(n
-0002a670: 2e64 7479 7065 290d 0a20 206c 6f67 5f70  .dtype)..  log_p
-0002a680: 203d 206a 6e70 2e6c 6f67 2870 290d 0a20   = jnp.log(p).. 
-0002a690: 206c 6f67 315f 7020 3d20 6a6e 702e 6c6f   log1_p = jnp.lo
-0002a6a0: 6731 7028 2d70 290d 0a20 206c 6f67 5f68  g1p(-p)..  log_h
-0002a6b0: 203d 2028 286d 202b 2030 2e35 2920 2a20   = ((m + 0.5) * 
-0002a6c0: 286a 6e70 2e6c 6f67 2828 6d20 2b20 312e  (jnp.log((m + 1.
-0002a6d0: 3029 202f 2028 6e20 2d20 6d20 2b20 312e  0) / (n - m + 1.
-0002a6e0: 3029 2920 2b20 6c6f 6731 5f70 202d 206c  0)) + log1_p - l
-0002a6f0: 6f67 5f70 2920 2b0d 0a20 2020 2020 2020  og_p) +..       
-0002a700: 2020 2020 5f73 7469 726c 696e 675f 6170      _stirling_ap
-0002a710: 7072 6f78 5f74 6169 6c28 6d29 202b 205f  prox_tail(m) + _
-0002a720: 7374 6972 6c69 6e67 5f61 7070 726f 785f  stirling_approx_
-0002a730: 7461 696c 286e 202d 206d 2929 0d0a 2020  tail(n - m))..  
-0002a740: 7265 7475 726e 205f 7472 5f70 6172 616d  return _tr_param
-0002a750: 7328 632c 2062 2c20 612c 2061 6c70 6861  s(c, b, a, alpha
-0002a760: 2c20 755f 722c 2076 5f72 2c20 6d2c 206c  , u_r, v_r, m, l
-0002a770: 6f67 5f70 2c20 6c6f 6731 5f70 2c20 6c6f  og_p, log1_p, lo
-0002a780: 675f 6829 0d0a 0d0a 0d0a 6465 6620 5f73  g_h)......def _s
-0002a790: 7469 726c 696e 675f 6170 7072 6f78 5f74  tirling_approx_t
-0002a7a0: 6169 6c28 6b29 3a0d 0a20 2070 7265 636f  ail(k):..  preco
-0002a7b0: 6d70 7574 6564 203d 206a 6e70 2e61 7272  mputed = jnp.arr
-0002a7c0: 6179 285b 302e 3038 3130 3631 3436 3637  ay([0.0810614667
-0002a7d0: 3935 3332 3732 362c 0d0a 2020 2020 2020  9532726,..      
-0002a7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a7f0: 2020 2020 2030 2e30 3431 3334 3036 3935       0.041340695
-0002a800: 3935 3534 3039 3239 2c0d 0a20 2020 2020  95540929,..     
-0002a810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a820: 2020 2020 2020 302e 3032 3736 3737 3932        0.02767792
-0002a830: 3536 3834 3939 3833 342c 0d0a 2020 2020  568499834,..    
-0002a840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a850: 2020 2020 2020 2030 2e30 3230 3739 3036         0.0207906
-0002a860: 3732 3130 3337 3635 3039 2c0d 0a20 2020  7210376509,..   
-0002a870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a880: 2020 2020 2020 2020 302e 3031 3636 3434          0.016644
-0002a890: 3639 3131 3839 3832 3131 392c 0d0a 2020  69118982119,..  
-0002a8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a8b0: 2020 2020 2020 2020 2030 2e30 3133 3837           0.01387
-0002a8c0: 3631 3238 3832 3330 3730 3735 2c0d 0a20  612882307075,.. 
-0002a8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a8e0: 2020 2020 2020 2020 2020 302e 3031 3138            0.0118
-0002a8f0: 3936 3730 3939 3435 3839 3137 372c 0d0a  9670994589177,..
-0002a900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a910: 2020 2020 2020 2020 2020 2030 2e30 3130             0.010
-0002a920: 3431 3132 3635 3236 3139 3732 3039 2c0d  41126526197209,.
-0002a930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a940: 2020 2020 2020 2020 2020 2020 302e 3030              0.00
-0002a950: 3932 3535 3436 3231 3832 3731 3237 3333  9255462182712733
-0002a960: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0002a970: 2020 2020 2020 2020 2020 2020 2020 302e                0.
-0002a980: 3030 3833 3330 3536 3334 3333 3336 3238  0083305634333628
-0002a990: 3731 5d2c 0d0a 2020 2020 2020 2020 2020  71],..          
-0002a9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a9b0: 6474 7970 653d 656e 7669 726f 6e2e 6466  dtype=environ.df
-0002a9c0: 7479 7065 2829 290d 0a20 206b 7031 203d  type())..  kp1 =
-0002a9d0: 206b 202b 2031 0d0a 2020 6b70 3173 7120   k + 1..  kp1sq 
-0002a9e0: 3d20 286b 202b 2031 2920 2a2a 2032 0d0a  = (k + 1) ** 2..
-0002a9f0: 2020 7265 7475 726e 206a 6e70 2e77 6865    return jnp.whe
-0002aa00: 7265 286b 203c 2031 302c 0d0a 2020 2020  re(k < 10,..    
-0002aa10: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0002aa20: 7265 636f 6d70 7574 6564 5b6b 5d2c 0d0a  recomputed[k],..
-0002aa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aa40: 2020 2028 312e 3020 2f20 3132 202d 2028     (1.0 / 12 - (
-0002aa50: 312e 3020 2f20 3336 3020 2d20 2831 2e30  1.0 / 360 - (1.0
-0002aa60: 202f 2031 3236 3029 202f 206b 7031 7371   / 1260) / kp1sq
-0002aa70: 2920 2f20 6b70 3173 7129 202f 206b 7031  ) / kp1sq) / kp1
-0002aa80: 290d 0a0d 0a0d 0a64 6566 205f 6269 6e6f  )......def _bino
-0002aa90: 6d69 616c 5f62 7472 7328 6b65 792c 2070  mial_btrs(key, p
-0002aaa0: 2c20 6e29 3a0d 0a20 2022 2222 0d0a 2020  , n):..  """..  
-0002aab0: 4261 7365 6420 6f6e 2074 6865 2074 7261  Based on the tra
-0002aac0: 6e73 666f 726d 6564 2072 656a 6563 7469  nsformed rejecti
-0002aad0: 6f6e 2073 616d 706c 696e 6720 616c 676f  on sampling algo
-0002aae0: 7269 7468 6d20 2842 5452 5329 2066 726f  rithm (BTRS) fro
-0002aaf0: 6d20 7468 650d 0a20 2066 6f6c 6c6f 7769  m the..  followi
-0002ab00: 6e67 2072 6566 6572 656e 6365 3a0d 0a0d  ng reference:...
-0002ab10: 0a20 2048 6f72 6d61 6e6e 2c20 2254 6865  .  Hormann, "The
-0002ab20: 2047 656e 6572 6174 696f 6e20 6f66 2042   Generation of B
-0002ab30: 696e 6f6e 6d69 616c 2052 616e 646f 6d20  inonmial Random 
-0002ab40: 5661 7269 6174 6573 220d 0a20 2028 6874  Variates"..  (ht
-0002ab50: 7470 733a 2f2f 636f 7265 2e61 632e 756b  tps://core.ac.uk
-0002ab60: 2f64 6f77 6e6c 6f61 642f 7064 662f 3131  /download/pdf/11
-0002ab70: 3030 3732 3534 2e70 6466 290d 0a20 2022  007254.pdf)..  "
-0002ab80: 2222 0d0a 0d0a 2020 6465 6620 5f62 7472  ""....  def _btr
-0002ab90: 735f 626f 6479 5f66 6e28 7661 6c29 3a0d  s_body_fn(val):.
-0002aba0: 0a20 2020 205f 2c20 6b65 792c 205f 2c20  .    _, key, _, 
-0002abb0: 5f20 3d20 7661 6c0d 0a20 2020 206b 6579  _ = val..    key
-0002abc0: 2c20 6b65 795f 752c 206b 6579 5f76 203d  , key_u, key_v =
-0002abd0: 206a 722e 7370 6c69 7428 6b65 792c 2033   jr.split(key, 3
-0002abe0: 290d 0a20 2020 2075 203d 206a 722e 756e  )..    u = jr.un
-0002abf0: 6966 6f72 6d28 6b65 795f 7529 0d0a 2020  iform(key_u)..  
-0002ac00: 2020 7620 3d20 6a72 2e75 6e69 666f 726d    v = jr.uniform
-0002ac10: 286b 6579 5f76 290d 0a20 2020 2075 203d  (key_v)..    u =
-0002ac20: 2075 202d 2030 2e35 0d0a 2020 2020 6b20   u - 0.5..    k 
-0002ac30: 3d20 6a6e 702e 666c 6f6f 7228 0d0a 2020  = jnp.floor(..  
-0002ac40: 2020 2020 2832 202a 2074 725f 7061 7261      (2 * tr_para
-0002ac50: 6d73 2e61 202f 2028 302e 3520 2d20 6a6e  ms.a / (0.5 - jn
-0002ac60: 702e 6162 7328 7529 2920 2b20 7472 5f70  p.abs(u)) + tr_p
-0002ac70: 6172 616d 732e 6229 202a 2075 202b 2074  arams.b) * u + t
-0002ac80: 725f 7061 7261 6d73 2e63 0d0a 2020 2020  r_params.c..    
-0002ac90: 292e 6173 7479 7065 286e 2e64 7479 7065  ).astype(n.dtype
-0002aca0: 290d 0a20 2020 2072 6574 7572 6e20 6b2c  )..    return k,
-0002acb0: 206b 6579 2c20 752c 2076 0d0a 0d0a 2020   key, u, v....  
-0002acc0: 6465 6620 5f62 7472 735f 636f 6e64 5f66  def _btrs_cond_f
-0002acd0: 6e28 7661 6c29 3a0d 0a20 2020 2064 6566  n(val):..    def
-0002ace0: 2061 6363 6570 745f 666e 286b 2c20 752c   accept_fn(k, u,
-0002acf0: 2076 293a 0d0a 2020 2020 2020 2320 5365   v):..      # Se
-0002ad00: 6520 6163 6365 7074 616e 6365 2063 6f6e  e acceptance con
-0002ad10: 6469 7469 6f6e 2069 6e20 5374 6570 2033  dition in Step 3
-0002ad20: 2e20 2850 6167 6520 3329 206f 6620 5452  . (Page 3) of TR
-0002ad30: 5320 616c 676f 7269 7468 6d0d 0a20 2020  S algorithm..   
-0002ad40: 2020 2023 2076 203c 3d20 6628 6b29 202a     # v <= f(k) *
-0002ad50: 2067 5f67 7261 6428 7529 202f 2061 6c70   g_grad(u) / alp
-0002ad60: 6861 0d0a 0d0a 2020 2020 2020 6d20 3d20  ha....      m = 
-0002ad70: 7472 5f70 6172 616d 732e 6d0d 0a20 2020  tr_params.m..   
-0002ad80: 2020 206c 6f67 5f70 203d 2074 725f 7061     log_p = tr_pa
-0002ad90: 7261 6d73 2e6c 6f67 5f70 0d0a 2020 2020  rams.log_p..    
-0002ada0: 2020 6c6f 6731 5f70 203d 2074 725f 7061    log1_p = tr_pa
-0002adb0: 7261 6d73 2e6c 6f67 315f 700d 0a20 2020  rams.log1_p..   
-0002adc0: 2020 2023 2053 6565 3a20 666f 726d 756c     # See: formul
-0002add0: 6120 666f 7220 6c6f 6728 6628 6b29 2920  a for log(f(k)) 
-0002ade0: 6174 2062 6f74 746f 6d20 6f66 2050 6167  at bottom of Pag
-0002adf0: 6520 352e 0d0a 2020 2020 2020 6c6f 675f  e 5...      log_
-0002ae00: 6620 3d20 280d 0a20 2020 2020 2020 2020  f = (..         
-0002ae10: 2028 6e20 2b20 312e 3029 202a 206a 6e70   (n + 1.0) * jnp
-0002ae20: 2e6c 6f67 2828 6e20 2d20 6d20 2b20 312e  .log((n - m + 1.
-0002ae30: 3029 202f 2028 6e20 2d20 6b20 2b20 312e  0) / (n - k + 1.
-0002ae40: 3029 290d 0a20 2020 2020 2020 2020 202b  0))..          +
-0002ae50: 2028 6b20 2b20 302e 3529 202a 2028 6a6e   (k + 0.5) * (jn
-0002ae60: 702e 6c6f 6728 286e 202d 206b 202b 2031  p.log((n - k + 1
-0002ae70: 2e30 2920 2f20 286b 202b 2031 2e30 2929  .0) / (k + 1.0))
-0002ae80: 202b 206c 6f67 5f70 202d 206c 6f67 315f   + log_p - log1_
-0002ae90: 7029 0d0a 2020 2020 2020 2020 2020 2b20  p)..          + 
-0002aea0: 285f 7374 6972 6c69 6e67 5f61 7070 726f  (_stirling_appro
-0002aeb0: 785f 7461 696c 286b 2920 2d20 5f73 7469  x_tail(k) - _sti
-0002aec0: 726c 696e 675f 6170 7072 6f78 5f74 6169  rling_approx_tai
-0002aed0: 6c28 6e20 2d20 6b29 290d 0a20 2020 2020  l(n - k))..     
-0002aee0: 2020 2020 202b 2074 725f 7061 7261 6d73       + tr_params
-0002aef0: 2e6c 6f67 5f68 0d0a 2020 2020 2020 290d  .log_h..      ).
-0002af00: 0a20 2020 2020 2067 203d 2028 7472 5f70  .      g = (tr_p
-0002af10: 6172 616d 732e 6120 2f20 2830 2e35 202d  arams.a / (0.5 -
-0002af20: 206a 6e70 2e61 6273 2875 2929 202a 2a20   jnp.abs(u)) ** 
-0002af30: 3229 202b 2074 725f 7061 7261 6d73 2e62  2) + tr_params.b
-0002af40: 0d0a 2020 2020 2020 7265 7475 726e 206a  ..      return j
-0002af50: 6e70 2e6c 6f67 2828 7620 2a20 7472 5f70  np.log((v * tr_p
-0002af60: 6172 616d 732e 616c 7068 6129 202f 2067  arams.alpha) / g
-0002af70: 2920 3c3d 206c 6f67 5f66 0d0a 0d0a 2020  ) <= log_f....  
-0002af80: 2020 6b2c 206b 6579 2c20 752c 2076 203d    k, key, u, v =
-0002af90: 2076 616c 0d0a 2020 2020 6561 726c 795f   val..    early_
-0002afa0: 6163 6365 7074 203d 2028 6a6e 702e 6162  accept = (jnp.ab
-0002afb0: 7328 7529 203c 3d20 7472 5f70 6172 616d  s(u) <= tr_param
-0002afc0: 732e 755f 7229 2026 2028 7620 3c3d 2074  s.u_r) & (v <= t
-0002afd0: 725f 7061 7261 6d73 2e76 5f72 290d 0a20  r_params.v_r).. 
-0002afe0: 2020 2065 6172 6c79 5f72 656a 6563 7420     early_reject 
-0002aff0: 3d20 286b 203c 2030 2920 7c20 286b 203e  = (k < 0) | (k >
-0002b000: 206e 290d 0a20 2020 2072 6574 7572 6e20   n)..    return 
-0002b010: 6c61 782e 636f 6e64 280d 0a20 2020 2020  lax.cond(..     
-0002b020: 2065 6172 6c79 5f61 6363 6570 7420 7c20   early_accept | 
-0002b030: 6561 726c 795f 7265 6a65 6374 2c0d 0a20  early_reject,.. 
-0002b040: 2020 2020 2028 292c 0d0a 2020 2020 2020       (),..      
-0002b050: 6c61 6d62 6461 205f 3a20 7e65 6172 6c79  lambda _: ~early
-0002b060: 5f61 6363 6570 742c 0d0a 2020 2020 2020  _accept,..      
-0002b070: 286b 2c20 752c 2076 292c 0d0a 2020 2020  (k, u, v),..    
-0002b080: 2020 6c61 6d62 6461 2078 3a20 7e61 6363    lambda x: ~acc
-0002b090: 6570 745f 666e 282a 7829 2c0d 0a20 2020  ept_fn(*x),..   
-0002b0a0: 2029 0d0a 0d0a 2020 7472 5f70 6172 616d   )....  tr_param
-0002b0b0: 7320 3d20 5f67 6574 5f74 725f 7061 7261  s = _get_tr_para
-0002b0c0: 6d73 286e 2c20 7029 0d0a 2020 7265 7420  ms(n, p)..  ret 
-0002b0d0: 3d20 6c61 782e 7768 696c 655f 6c6f 6f70  = lax.while_loop
-0002b0e0: 280d 0a20 2020 205f 6274 7273 5f63 6f6e  (..    _btrs_con
-0002b0f0: 645f 666e 2c20 5f62 7472 735f 626f 6479  d_fn, _btrs_body
-0002b100: 5f66 6e2c 2028 2d31 2c20 6b65 792c 2031  _fn, (-1, key, 1
-0002b110: 2e30 2c20 312e 3029 0d0a 2020 2920 2023  .0, 1.0)..  )  #
-0002b120: 2075 7365 206b 3d2d 3120 696e 6974 6961   use k=-1 initia
-0002b130: 6c6c 7920 736f 2074 6861 7420 636f 6e64  lly so that cond
-0002b140: 5f66 6e20 7265 7475 726e 7320 5472 7565  _fn returns True
-0002b150: 0d0a 2020 7265 7475 726e 2072 6574 5b30  ..  return ret[0
-0002b160: 5d0d 0a0d 0a0d 0a64 6566 205f 6269 6e6f  ]......def _bino
-0002b170: 6d69 616c 5f69 6e76 6572 7369 6f6e 286b  mial_inversion(k
-0002b180: 6579 2c20 702c 206e 293a 0d0a 2020 6465  ey, p, n):..  de
-0002b190: 6620 5f62 696e 6f6d 5f69 6e76 5f62 6f64  f _binom_inv_bod
-0002b1a0: 795f 666e 2876 616c 293a 0d0a 2020 2020  y_fn(val):..    
-0002b1b0: 692c 206b 6579 2c20 6765 6f6d 5f61 6363  i, key, geom_acc
-0002b1c0: 203d 2076 616c 0d0a 2020 2020 6b65 792c   = val..    key,
-0002b1d0: 206b 6579 5f75 203d 206a 722e 7370 6c69   key_u = jr.spli
-0002b1e0: 7428 6b65 7929 0d0a 2020 2020 7520 3d20  t(key)..    u = 
-0002b1f0: 6a72 2e75 6e69 666f 726d 286b 6579 5f75  jr.uniform(key_u
-0002b200: 290d 0a20 2020 2067 656f 6d20 3d20 6a6e  )..    geom = jn
-0002b210: 702e 666c 6f6f 7228 6a6e 702e 6c6f 6731  p.floor(jnp.log1
-0002b220: 7028 2d75 2920 2f20 6c6f 6731 5f70 2920  p(-u) / log1_p) 
-0002b230: 2b20 310d 0a20 2020 2067 656f 6d5f 6163  + 1..    geom_ac
-0002b240: 6320 3d20 6765 6f6d 5f61 6363 202b 2067  c = geom_acc + g
-0002b250: 656f 6d0d 0a20 2020 2072 6574 7572 6e20  eom..    return 
-0002b260: 6920 2b20 312c 206b 6579 2c20 6765 6f6d  i + 1, key, geom
-0002b270: 5f61 6363 0d0a 0d0a 2020 6465 6620 5f62  _acc....  def _b
-0002b280: 696e 6f6d 5f69 6e76 5f63 6f6e 645f 666e  inom_inv_cond_fn
-0002b290: 2876 616c 293a 0d0a 2020 2020 692c 205f  (val):..    i, _
-0002b2a0: 2c20 6765 6f6d 5f61 6363 203d 2076 616c  , geom_acc = val
-0002b2b0: 0d0a 2020 2020 7265 7475 726e 2067 656f  ..    return geo
-0002b2c0: 6d5f 6163 6320 3c3d 206e 0d0a 0d0a 2020  m_acc <= n....  
-0002b2d0: 6c6f 6731 5f70 203d 206a 6e70 2e6c 6f67  log1_p = jnp.log
-0002b2e0: 3170 282d 7029 0d0a 2020 7265 7420 3d20  1p(-p)..  ret = 
-0002b2f0: 6c61 782e 7768 696c 655f 6c6f 6f70 285f  lax.while_loop(_
-0002b300: 6269 6e6f 6d5f 696e 765f 636f 6e64 5f66  binom_inv_cond_f
-0002b310: 6e2c 205f 6269 6e6f 6d5f 696e 765f 626f  n, _binom_inv_bo
-0002b320: 6479 5f66 6e2c 2028 2d31 2c20 6b65 792c  dy_fn, (-1, key,
-0002b330: 2030 2e30 2929 0d0a 2020 7265 7475 726e   0.0))..  return
-0002b340: 2072 6574 5b30 5d0d 0a0d 0a0d 0a64 6566   ret[0]......def
-0002b350: 205f 6269 6e6f 6d69 616c 5f64 6973 7061   _binomial_dispa
-0002b360: 7463 6828 6b65 792c 2070 2c20 6e29 3a0d  tch(key, p, n):.
-0002b370: 0a20 2064 6566 2064 6973 7061 7463 6828  .  def dispatch(
-0002b380: 6b65 792c 2070 2c20 6e29 3a0d 0a20 2020  key, p, n):..   
-0002b390: 2069 735f 6c65 5f6d 6964 203d 2070 203c   is_le_mid = p <
-0002b3a0: 3d20 302e 350d 0a20 2020 2070 7120 3d20  = 0.5..    pq = 
-0002b3b0: 6a6e 702e 7768 6572 6528 6973 5f6c 655f  jnp.where(is_le_
-0002b3c0: 6d69 642c 2070 2c20 3120 2d20 7029 0d0a  mid, p, 1 - p)..
-0002b3d0: 2020 2020 6d75 203d 206e 202a 2070 710d      mu = n * pq.
-0002b3e0: 0a20 2020 206b 203d 206c 6178 2e63 6f6e  .    k = lax.con
-0002b3f0: 6428 0d0a 2020 2020 2020 6d75 203c 2031  d(..      mu < 1
-0002b400: 302c 0d0a 2020 2020 2020 286b 6579 2c20  0,..      (key, 
-0002b410: 7071 2c20 6e29 2c0d 0a20 2020 2020 206c  pq, n),..      l
-0002b420: 616d 6264 6120 783a 205f 6269 6e6f 6d69  ambda x: _binomi
-0002b430: 616c 5f69 6e76 6572 7369 6f6e 282a 7829  al_inversion(*x)
-0002b440: 2c0d 0a20 2020 2020 2028 6b65 792c 2070  ,..      (key, p
-0002b450: 712c 206e 292c 0d0a 2020 2020 2020 6c61  q, n),..      la
-0002b460: 6d62 6461 2078 3a20 5f62 696e 6f6d 6961  mbda x: _binomia
-0002b470: 6c5f 6274 7273 282a 7829 2c0d 0a20 2020  l_btrs(*x),..   
-0002b480: 2029 0d0a 2020 2020 7265 7475 726e 206a   )..    return j
-0002b490: 6e70 2e77 6865 7265 2869 735f 6c65 5f6d  np.where(is_le_m
-0002b4a0: 6964 2c20 6b2c 206e 202d 206b 290d 0a0d  id, k, n - k)...
-0002b4b0: 0a20 2023 2052 6574 7572 6e20 3020 666f  .  # Return 0 fo
-0002b4c0: 7220 6e61 6e20 6070 6020 6f72 206e 6567  r nan `p` or neg
-0002b4d0: 6174 6976 6520 606e 602c 2073 696e 6365  ative `n`, since
-0002b4e0: 206e 616e 2076 616c 7565 7320 6172 6520   nan values are 
-0002b4f0: 6e6f 7420 616c 6c6f 7765 6420 666f 7220  not allowed for 
-0002b500: 696e 7465 6765 7220 7479 7065 730d 0a20  integer types.. 
-0002b510: 2063 6f6e 6430 203d 206a 6e70 2e69 7366   cond0 = jnp.isf
-0002b520: 696e 6974 6528 7029 2026 2028 6e20 3e20  inite(p) & (n > 
-0002b530: 3029 2026 2028 7020 3e20 3029 0d0a 2020  0) & (p > 0)..  
-0002b540: 7265 7475 726e 206c 6178 2e63 6f6e 6428  return lax.cond(
-0002b550: 0d0a 2020 2020 636f 6e64 3020 2620 2870  ..    cond0 & (p
-0002b560: 203c 2031 292c 0d0a 2020 2020 286b 6579   < 1),..    (key
-0002b570: 2c20 702c 206e 292c 0d0a 2020 2020 6c61  , p, n),..    la
-0002b580: 6d62 6461 2078 3a20 6469 7370 6174 6368  mbda x: dispatch
-0002b590: 282a 7829 2c0d 0a20 2020 2028 292c 0d0a  (*x),..    (),..
-0002b5a0: 2020 2020 6c61 6d62 6461 205f 3a20 6a6e      lambda _: jn
-0002b5b0: 702e 7768 6572 6528 636f 6e64 302c 206e  p.where(cond0, n
-0002b5c0: 2c20 3029 2c0d 0a20 2029 0d0a 0d0a 0d0a  , 0),..  )......
-0002b5d0: 4070 6172 7469 616c 286a 6974 2c20 7374  @partial(jit, st
-0002b5e0: 6174 6963 5f61 7267 6e75 6d73 3d28 332c  atic_argnums=(3,
-0002b5f0: 2929 0d0a 6465 6620 5f62 696e 6f6d 6961  ))..def _binomia
-0002b600: 6c28 6b65 792c 2070 2c20 6e2c 2073 6861  l(key, p, n, sha
-0002b610: 7065 293a 0d0a 2020 7368 6170 6520 3d20  pe):..  shape = 
-0002b620: 7368 6170 6520 6f72 206c 6178 2e62 726f  shape or lax.bro
-0002b630: 6164 6361 7374 5f73 6861 7065 7328 6a6e  adcast_shapes(jn
-0002b640: 702e 7368 6170 6528 7029 2c20 6a6e 702e  p.shape(p), jnp.
-0002b650: 7368 6170 6528 6e29 290d 0a20 2023 2072  shape(n))..  # r
-0002b660: 6573 6861 7065 2074 6f20 6d61 7020 6f76  eshape to map ov
-0002b670: 6572 2061 7869 7320 300d 0a20 2070 203d  er axis 0..  p =
-0002b680: 206a 6e70 2e72 6573 6861 7065 286a 6e70   jnp.reshape(jnp
-0002b690: 2e62 726f 6164 6361 7374 5f74 6f28 702c  .broadcast_to(p,
-0002b6a0: 2073 6861 7065 292c 202d 3129 0d0a 2020   shape), -1)..  
-0002b6b0: 6e20 3d20 6a6e 702e 7265 7368 6170 6528  n = jnp.reshape(
-0002b6c0: 6a6e 702e 6272 6f61 6463 6173 745f 746f  jnp.broadcast_to
-0002b6d0: 286e 2c20 7368 6170 6529 2c20 2d31 290d  (n, shape), -1).
-0002b6e0: 0a20 206b 6579 203d 206a 722e 7370 6c69  .  key = jr.spli
-0002b6f0: 7428 6b65 792c 206a 6e70 2e73 697a 6528  t(key, jnp.size(
-0002b700: 7029 290d 0a20 2069 6620 6a61 782e 6465  p))..  if jax.de
-0002b710: 6661 756c 745f 6261 636b 656e 6428 2920  fault_backend() 
-0002b720: 3d3d 2022 6370 7522 3a0d 0a20 2020 2072  == "cpu":..    r
-0002b730: 6574 203d 206c 6178 2e6d 6170 286c 616d  et = lax.map(lam
-0002b740: 6264 6120 783a 205f 6269 6e6f 6d69 616c  bda x: _binomial
-0002b750: 5f64 6973 7061 7463 6828 2a78 292c 2028  _dispatch(*x), (
-0002b760: 6b65 792c 2070 2c20 6e29 290d 0a20 2065  key, p, n))..  e
-0002b770: 6c73 653a 0d0a 2020 2020 7265 7420 3d20  lse:..    ret = 
-0002b780: 766d 6170 286c 616d 6264 6120 2a78 3a20  vmap(lambda *x: 
-0002b790: 5f62 696e 6f6d 6961 6c5f 6469 7370 6174  _binomial_dispat
-0002b7a0: 6368 282a 7829 2928 6b65 792c 2070 2c20  ch(*x))(key, p, 
-0002b7b0: 6e29 0d0a 2020 7265 7475 726e 206a 6e70  n)..  return jnp
-0002b7c0: 2e72 6573 6861 7065 2872 6574 2c20 7368  .reshape(ret, sh
-0002b7d0: 6170 6529 0d0a 0d0a 0d0a 4070 6172 7469  ape)......@parti
-0002b7e0: 616c 286a 6974 2c20 7374 6174 6963 5f61  al(jit, static_a
-0002b7f0: 7267 6e75 6d73 3d28 322c 2929 0d0a 6465  rgnums=(2,))..de
-0002b800: 6620 5f63 6174 6567 6f72 6963 616c 286b  f _categorical(k
-0002b810: 6579 2c20 702c 2073 6861 7065 293a 0d0a  ey, p, shape):..
-0002b820: 2020 2320 7468 6973 2069 6d70 6c65 6d65    # this impleme
-0002b830: 6e74 6174 696f 6e20 6973 2066 6173 7420  ntation is fast 
-0002b840: 7768 656e 2065 7665 6e74 2073 6861 7065  when event shape
-0002b850: 2069 7320 736d 616c 6c2c 2061 6e64 2073   is small, and s
-0002b860: 6c6f 7720 6f74 6865 7277 6973 650d 0a20  low otherwise.. 
-0002b870: 2023 2052 6566 3a20 6874 7470 733a 2f2f   # Ref: https://
-0002b880: 7374 6163 6b6f 7665 7266 6c6f 772e 636f  stackoverflow.co
-0002b890: 6d2f 612f 3334 3139 3030 3335 0d0a 2020  m/a/34190035..  
-0002b8a0: 7368 6170 6520 3d20 7368 6170 6520 6f72  shape = shape or
-0002b8b0: 2070 2e73 6861 7065 5b3a 2d31 5d0d 0a20   p.shape[:-1].. 
-0002b8c0: 2073 203d 206a 6e70 2e63 756d 7375 6d28   s = jnp.cumsum(
-0002b8d0: 702c 2061 7869 733d 2d31 290d 0a20 2072  p, axis=-1)..  r
-0002b8e0: 203d 206a 722e 756e 6966 6f72 6d28 6b65   = jr.uniform(ke
-0002b8f0: 792c 2073 6861 7065 3d73 6861 7065 202b  y, shape=shape +
-0002b900: 2028 312c 2929 0d0a 2020 7265 7475 726e   (1,))..  return
-0002b910: 206a 6e70 2e73 756d 2873 203c 2072 2c20   jnp.sum(s < r, 
-0002b920: 6178 6973 3d2d 3129 0d0a 0d0a 0d0a 6465  axis=-1)......de
-0002b930: 6620 5f73 6361 7474 6572 5f61 6464 5f6f  f _scatter_add_o
-0002b940: 6e65 286f 7065 7261 6e64 2c20 696e 6469  ne(operand, indi
-0002b950: 6365 732c 2075 7064 6174 6573 293a 0d0a  ces, updates):..
-0002b960: 2020 7265 7475 726e 206c 6178 2e73 6361    return lax.sca
-0002b970: 7474 6572 5f61 6464 280d 0a20 2020 206f  tter_add(..    o
-0002b980: 7065 7261 6e64 2c0d 0a20 2020 2069 6e64  perand,..    ind
-0002b990: 6963 6573 2c0d 0a20 2020 2075 7064 6174  ices,..    updat
-0002b9a0: 6573 2c0d 0a20 2020 206c 6178 2e53 6361  es,..    lax.Sca
-0002b9b0: 7474 6572 4469 6d65 6e73 696f 6e4e 756d  tterDimensionNum
-0002b9c0: 6265 7273 280d 0a20 2020 2020 2075 7064  bers(..      upd
-0002b9d0: 6174 655f 7769 6e64 6f77 5f64 696d 733d  ate_window_dims=
-0002b9e0: 2829 2c0d 0a20 2020 2020 2069 6e73 6572  (),..      inser
-0002b9f0: 7465 645f 7769 6e64 6f77 5f64 696d 733d  ted_window_dims=
-0002ba00: 2830 2c29 2c0d 0a20 2020 2020 2073 6361  (0,),..      sca
-0002ba10: 7474 6572 5f64 696d 735f 746f 5f6f 7065  tter_dims_to_ope
-0002ba20: 7261 6e64 5f64 696d 733d 2830 2c29 2c0d  rand_dims=(0,),.
-0002ba30: 0a20 2020 2029 2c0d 0a20 2029 0d0a 0d0a  .    ),..  )....
-0002ba40: 0d0a 6465 6620 5f72 6573 6861 7065 2878  ..def _reshape(x
-0002ba50: 2c20 7368 6170 6529 3a0d 0a20 2069 6620  , shape):..  if 
-0002ba60: 6973 696e 7374 616e 6365 2878 2c20 2869  isinstance(x, (i
-0002ba70: 6e74 2c20 666c 6f61 742c 206e 702e 6e64  nt, float, np.nd
-0002ba80: 6172 7261 792c 206e 702e 6765 6e65 7269  array, np.generi
-0002ba90: 6329 293a 0d0a 2020 2020 7265 7475 726e  c)):..    return
-0002baa0: 206e 702e 7265 7368 6170 6528 782c 2073   np.reshape(x, s
-0002bab0: 6861 7065 290d 0a20 2065 6c73 653a 0d0a  hape)..  else:..
-0002bac0: 2020 2020 7265 7475 726e 206a 6e70 2e72      return jnp.r
-0002bad0: 6573 6861 7065 2878 2c20 7368 6170 6529  eshape(x, shape)
-0002bae0: 0d0a 0d0a 0d0a 6465 6620 5f70 726f 6d6f  ......def _promo
-0002baf0: 7465 5f73 6861 7065 7328 2a61 7267 732c  te_shapes(*args,
-0002bb00: 2073 6861 7065 3d28 2929 3a0d 0a20 2023   shape=()):..  #
-0002bb10: 2061 6461 7074 6564 2066 726f 6d20 6c61   adapted from la
-0002bb20: 782e 6c61 785f 6e75 6d70 790d 0a20 2069  x.lax_numpy..  i
-0002bb30: 6620 6c65 6e28 6172 6773 2920 3c20 3220  f len(args) < 2 
-0002bb40: 616e 6420 6e6f 7420 7368 6170 653a 0d0a  and not shape:..
-0002bb50: 2020 2020 7265 7475 726e 2061 7267 730d      return args.
-0002bb60: 0a20 2065 6c73 653a 0d0a 2020 2020 7368  .  else:..    sh
-0002bb70: 6170 6573 203d 205b 6a6e 702e 7368 6170  apes = [jnp.shap
-0002bb80: 6528 6172 6729 2066 6f72 2061 7267 2069  e(arg) for arg i
-0002bb90: 6e20 6172 6773 5d0d 0a20 2020 206e 756d  n args]..    num
-0002bba0: 5f64 696d 7320 3d20 6c65 6e28 6c61 782e  _dims = len(lax.
-0002bbb0: 6272 6f61 6463 6173 745f 7368 6170 6573  broadcast_shapes
-0002bbc0: 2873 6861 7065 2c20 2a73 6861 7065 7329  (shape, *shapes)
-0002bbd0: 290d 0a20 2020 2072 6574 7572 6e20 5b0d  )..    return [.
-0002bbe0: 0a20 2020 2020 205f 7265 7368 6170 6528  .      _reshape(
-0002bbf0: 6172 672c 2028 312c 2920 2a20 286e 756d  arg, (1,) * (num
-0002bc00: 5f64 696d 7320 2d20 6c65 6e28 7329 2920  _dims - len(s)) 
-0002bc10: 2b20 7329 2069 6620 6c65 6e28 7329 203c  + s) if len(s) <
-0002bc20: 206e 756d 5f64 696d 7320 656c 7365 2061   num_dims else a
-0002bc30: 7267 0d0a 2020 2020 2020 666f 7220 6172  rg..      for ar
-0002bc40: 672c 2073 2069 6e20 7a69 7028 6172 6773  g, s in zip(args
-0002bc50: 2c20 7368 6170 6573 290d 0a20 2020 205d  , shapes)..    ]
-0002bc60: 0d0a 0d0a 0d0a 4070 6172 7469 616c 286a  ......@partial(j
-0002bc70: 6974 2c20 7374 6174 6963 5f61 7267 6e75  it, static_argnu
-0002bc80: 6d73 3d28 332c 2034 2929 0d0a 6465 6620  ms=(3, 4))..def 
-0002bc90: 5f6d 756c 7469 6e6f 6d69 616c 286b 6579  _multinomial(key
-0002bca0: 2c20 702c 206e 2c20 6e5f 6d61 782c 2073  , p, n, n_max, s
-0002bcb0: 6861 7065 3d28 2929 3a0d 0a20 2069 6620  hape=()):..  if 
-0002bcc0: 6a6e 702e 7368 6170 6528 6e29 2021 3d20  jnp.shape(n) != 
-0002bcd0: 6a6e 702e 7368 6170 6528 7029 5b3a 2d31  jnp.shape(p)[:-1
-0002bce0: 5d3a 0d0a 2020 2020 6272 6f61 6463 6173  ]:..    broadcas
-0002bcf0: 745f 7368 6170 6520 3d20 6c61 782e 6272  t_shape = lax.br
-0002bd00: 6f61 6463 6173 745f 7368 6170 6573 286a  oadcast_shapes(j
-0002bd10: 6e70 2e73 6861 7065 286e 292c 206a 6e70  np.shape(n), jnp
-0002bd20: 2e73 6861 7065 2870 295b 3a2d 315d 290d  .shape(p)[:-1]).
-0002bd30: 0a20 2020 206e 203d 206a 6e70 2e62 726f  .    n = jnp.bro
-0002bd40: 6164 6361 7374 5f74 6f28 6e2c 2062 726f  adcast_to(n, bro
-0002bd50: 6164 6361 7374 5f73 6861 7065 290d 0a20  adcast_shape).. 
-0002bd60: 2020 2070 203d 206a 6e70 2e62 726f 6164     p = jnp.broad
-0002bd70: 6361 7374 5f74 6f28 702c 2062 726f 6164  cast_to(p, broad
-0002bd80: 6361 7374 5f73 6861 7065 202b 206a 6e70  cast_shape + jnp
-0002bd90: 2e73 6861 7065 2870 295b 2d31 3a5d 290d  .shape(p)[-1:]).
-0002bda0: 0a20 2073 6861 7065 203d 2073 6861 7065  .  shape = shape
-0002bdb0: 206f 7220 702e 7368 6170 655b 3a2d 315d   or p.shape[:-1]
-0002bdc0: 0d0a 2020 6966 206e 5f6d 6178 203d 3d20  ..  if n_max == 
-0002bdd0: 303a 0d0a 2020 2020 7265 7475 726e 206a  0:..    return j
-0002bde0: 6e70 2e7a 6572 6f73 2873 6861 7065 202b  np.zeros(shape +
-0002bdf0: 2070 2e73 6861 7065 5b2d 313a 5d2c 2064   p.shape[-1:], d
-0002be00: 7479 7065 3d6a 6e70 2e72 6573 756c 745f  type=jnp.result_
-0002be10: 7479 7065 2869 6e74 2929 0d0a 2020 2320  type(int))..  # 
-0002be20: 6765 7420 696e 6469 6365 7320 6672 6f6d  get indices from
-0002be30: 2063 6174 6567 6f72 6963 616c 2064 6973   categorical dis
-0002be40: 7472 6962 7574 696f 6e20 7468 656e 2067  tribution then g
-0002be50: 6174 6865 7220 7468 6520 7265 7375 6c74  ather the result
-0002be60: 0d0a 2020 696e 6469 6365 7320 3d20 5f63  ..  indices = _c
-0002be70: 6174 6567 6f72 6963 616c 286b 6579 2c20  ategorical(key, 
-0002be80: 702c 2028 6e5f 6d61 782c 2920 2b20 7368  p, (n_max,) + sh
-0002be90: 6170 6529 0d0a 2020 2320 6d61 736b 206f  ape)..  # mask o
-0002bea0: 7574 2076 616c 7565 7320 7768 656e 2063  ut values when c
-0002beb0: 6f75 6e74 7320 6973 2068 6574 6572 6f67  ounts is heterog
-0002bec0: 656e 656f 7573 0d0a 2020 6966 206a 6e70  eneous..  if jnp
-0002bed0: 2e6e 6469 6d28 6e29 203e 2030 3a0d 0a20  .ndim(n) > 0:.. 
-0002bee0: 2020 206d 6173 6b20 3d20 5f70 726f 6d6f     mask = _promo
-0002bef0: 7465 5f73 6861 7065 7328 6a6e 702e 6172  te_shapes(jnp.ar
-0002bf00: 616e 6765 286e 5f6d 6178 2920 3c20 6a6e  ange(n_max) < jn
-0002bf10: 702e 6578 7061 6e64 5f64 696d 7328 6e2c  p.expand_dims(n,
-0002bf20: 202d 3129 2c20 7368 6170 653d 7368 6170   -1), shape=shap
-0002bf30: 6520 2b20 286e 5f6d 6178 2c29 295b 305d  e + (n_max,))[0]
-0002bf40: 0d0a 2020 2020 6d61 736b 203d 206a 6e70  ..    mask = jnp
-0002bf50: 2e6d 6f76 6561 7869 7328 6d61 736b 2c20  .moveaxis(mask, 
-0002bf60: 2d31 2c20 3029 2e61 7374 7970 6528 696e  -1, 0).astype(in
-0002bf70: 6469 6365 732e 6474 7970 6529 0d0a 2020  dices.dtype)..  
-0002bf80: 2020 6578 6365 7373 203d 206a 6e70 2e63    excess = jnp.c
-0002bf90: 6f6e 6361 7465 6e61 7465 285b 6a6e 702e  oncatenate([jnp.
-0002bfa0: 6578 7061 6e64 5f64 696d 7328 6e5f 6d61  expand_dims(n_ma
-0002bfb0: 7820 2d20 6e2c 202d 3129 2c0d 0a20 2020  x - n, -1),..   
-0002bfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bfd0: 2020 2020 2020 2020 2020 206a 6e70 2e7a             jnp.z
-0002bfe0: 6572 6f73 286a 6e70 2e73 6861 7065 286e  eros(jnp.shape(n
-0002bff0: 2920 2b20 2870 2e73 6861 7065 5b2d 315d  ) + (p.shape[-1]
-0002c000: 202d 2031 2c29 295d 2c0d 0a20 2020 2020   - 1,))],..     
-0002c010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c020: 2020 2020 2020 2020 2d31 290d 0a20 2065          -1)..  e
-0002c030: 6c73 653a 0d0a 2020 2020 6d61 736b 203d  lse:..    mask =
-0002c040: 2031 0d0a 2020 2020 6578 6365 7373 203d   1..    excess =
-0002c050: 2030 0d0a 2020 2320 4e42 3a20 7765 2074   0..  # NB: we t
-0002c060: 7261 6e73 706f 7365 2074 6f20 6d6f 7665  ranspose to move
-0002c070: 2062 6174 6368 2073 6861 7065 2074 6f20   batch shape to 
-0002c080: 7468 6520 6672 6f6e 740d 0a20 2069 6e64  the front..  ind
-0002c090: 6963 6573 5f32 4420 3d20 286a 6e70 2e72  ices_2D = (jnp.r
-0002c0a0: 6573 6861 7065 2869 6e64 6963 6573 202a  eshape(indices *
-0002c0b0: 206d 6173 6b2c 2028 6e5f 6d61 782c 202d   mask, (n_max, -
-0002c0c0: 3129 2929 2e54 0d0a 2020 7361 6d70 6c65  1))).T..  sample
-0002c0d0: 735f 3244 203d 2076 6d61 7028 5f73 6361  s_2D = vmap(_sca
-0002c0e0: 7474 6572 5f61 6464 5f6f 6e65 2928 6a6e  tter_add_one)(jn
-0002c0f0: 702e 7a65 726f 7328 2869 6e64 6963 6573  p.zeros((indices
-0002c100: 5f32 442e 7368 6170 655b 305d 2c20 702e  _2D.shape[0], p.
-0002c110: 7368 6170 655b 2d31 5d29 2c20 6474 7970  shape[-1]), dtyp
-0002c120: 653d 696e 6469 6365 732e 6474 7970 6529  e=indices.dtype)
-0002c130: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0002c140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c150: 2020 2020 2020 2020 206a 6e70 2e65 7870           jnp.exp
-0002c160: 616e 645f 6469 6d73 2869 6e64 6963 6573  and_dims(indices
-0002c170: 5f32 442c 2061 7869 733d 2d31 292c 0d0a  _2D, axis=-1),..
-0002c180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c1a0: 2020 2020 2020 6a6e 702e 6f6e 6573 2869        jnp.ones(i
-0002c1b0: 6e64 6963 6573 5f32 442e 7368 6170 652c  ndices_2D.shape,
-0002c1c0: 2064 7479 7065 3d69 6e64 6963 6573 2e64   dtype=indices.d
-0002c1d0: 7479 7065 2929 0d0a 2020 7265 7475 726e  type))..  return
-0002c1e0: 206a 6e70 2e72 6573 6861 7065 2873 616d   jnp.reshape(sam
-0002c1f0: 706c 6573 5f32 442c 2073 6861 7065 202b  ples_2D, shape +
-0002c200: 2070 2e73 6861 7065 5b2d 313a 5d29 202d   p.shape[-1:]) -
-0002c210: 2065 7863 6573 730d 0a0d 0a0d 0a40 7061   excess......@pa
-0002c220: 7274 6961 6c28 6a69 742c 2073 7461 7469  rtial(jit, stati
-0002c230: 635f 6172 676e 756d 733d 2832 2c20 3329  c_argnums=(2, 3)
-0002c240: 2c20 7374 6174 6963 5f61 7267 6e61 6d65  , static_argname
-0002c250: 733d 5b27 7368 6170 6527 2c20 2764 7479  s=['shape', 'dty
-0002c260: 7065 275d 290d 0a64 6566 205f 766f 6e5f  pe'])..def _von_
-0002c270: 6d69 7365 735f 6365 6e74 6572 6564 286b  mises_centered(k
-0002c280: 6579 2c20 636f 6e63 656e 7472 6174 696f  ey, concentratio
-0002c290: 6e2c 2073 6861 7065 2c20 6474 7970 653d  n, shape, dtype=
-0002c2a0: 4e6f 6e65 293a 0d0a 2020 2222 2243 6f6d  None):..  """Com
-0002c2b0: 7075 7465 2063 656e 7465 7265 6420 766f  pute centered vo
-0002c2c0: 6e20 4d69 7365 7320 7361 6d70 6c65 7320  n Mises samples 
-0002c2d0: 7573 696e 6720 7265 6a65 6374 696f 6e20  using rejection 
-0002c2e0: 7361 6d70 6c69 6e67 2066 726f 6d20 5b31  sampling from [1
-0002c2f0: 5d5f 2077 6974 6820 7772 6170 7065 6420  ]_ with wrapped 
-0002c300: 4361 7563 6879 2070 726f 706f 7361 6c2e  Cauchy proposal.
-0002c310: 0d0a 0d0a 2020 5265 7475 726e 730d 0a20  ....  Returns.. 
-0002c320: 202d 2d2d 2d2d 2d2d 0d0a 2020 6f75 743a   -------..  out:
-0002c330: 2061 7272 6179 5f6c 696b 650d 0a20 2020   array_like..   
-0002c340: 2020 6365 6e74 6572 6564 2073 616d 706c    centered sampl
-0002c350: 6573 2066 726f 6d20 766f 6e20 4d69 7365  es from von Mise
-0002c360: 730d 0a0d 0a20 2052 6566 6572 656e 6365  s....  Reference
-0002c370: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
-0002c380: 0a20 202e 2e20 5b31 5d20 4c75 6320 4465  .  .. [1] Luc De
-0002c390: 7672 6f79 6520 224e 6f6e 2d55 6e69 666f  vroye "Non-Unifo
-0002c3a0: 726d 2052 616e 646f 6d20 5661 7269 6174  rm Random Variat
-0002c3b0: 6520 4765 6e65 7261 7469 6f6e 222c 2053  e Generation", S
-0002c3c0: 7072 696e 6765 722d 5665 726c 6167 2c20  pringer-Verlag, 
-0002c3d0: 3139 3836 3b0d 0a20 2020 2020 2020 2020  1986;..         
-0002c3e0: 4368 6170 7465 7220 392c 2070 2e20 3437  Chapter 9, p. 47
-0002c3f0: 332d 3437 362e 2068 7474 703a 2f2f 7777  3-476. http://ww
-0002c400: 772e 6e72 626f 6f6b 2e63 6f6d 2f64 6576  w.nrbook.com/dev
-0002c410: 726f 7965 2f44 6576 726f 7965 5f66 696c  roye/Devroye_fil
-0002c420: 6573 2f63 6861 7074 6572 5f6e 696e 652e  es/chapter_nine.
-0002c430: 7064 660d 0a0d 0a20 2022 2222 0d0a 2020  pdf....  """..  
-0002c440: 7368 6170 6520 3d20 7368 6170 6520 6f72  shape = shape or
-0002c450: 206a 6e70 2e73 6861 7065 2863 6f6e 6365   jnp.shape(conce
-0002c460: 6e74 7261 7469 6f6e 290d 0a20 2064 7479  ntration)..  dty
-0002c470: 7065 203d 2064 7479 7065 206f 7220 656e  pe = dtype or en
-0002c480: 7669 726f 6e2e 6466 7479 7065 2829 0d0a  viron.dftype()..
-0002c490: 2020 636f 6e63 656e 7472 6174 696f 6e20    concentration 
-0002c4a0: 3d20 6c61 782e 636f 6e76 6572 745f 656c  = lax.convert_el
-0002c4b0: 656d 656e 745f 7479 7065 2863 6f6e 6365  ement_type(conce
-0002c4c0: 6e74 7261 7469 6f6e 2c20 6474 7970 6529  ntration, dtype)
-0002c4d0: 0d0a 2020 636f 6e63 656e 7472 6174 696f  ..  concentratio
-0002c4e0: 6e20 3d20 6a6e 702e 6272 6f61 6463 6173  n = jnp.broadcas
-0002c4f0: 745f 746f 2863 6f6e 6365 6e74 7261 7469  t_to(concentrati
-0002c500: 6f6e 2c20 7368 6170 6529 0d0a 0d0a 2020  on, shape)....  
-0002c510: 6966 2064 7479 7065 203d 3d20 6a6e 702e  if dtype == jnp.
-0002c520: 666c 6f61 7431 363a 0d0a 2020 2020 735f  float16:..    s_
-0002c530: 6375 746f 6666 203d 2031 2e38 652d 310d  cutoff = 1.8e-1.
-0002c540: 0a20 2065 6c69 6620 6474 7970 6520 3d3d  .  elif dtype ==
-0002c550: 206a 6e70 2e66 6c6f 6174 3332 3a0d 0a20   jnp.float32:.. 
-0002c560: 2020 2073 5f63 7574 6f66 6620 3d20 3265     s_cutoff = 2e
-0002c570: 2d32 0d0a 2020 656c 6966 2064 7479 7065  -2..  elif dtype
-0002c580: 203d 3d20 6a6e 702e 666c 6f61 7436 343a   == jnp.float64:
-0002c590: 0d0a 2020 2020 735f 6375 746f 6666 203d  ..    s_cutoff =
-0002c5a0: 2031 2e32 652d 340d 0a20 2065 6c73 653a   1.2e-4..  else:
-0002c5b0: 0d0a 2020 2020 7261 6973 6520 5661 6c75  ..    raise Valu
-0002c5c0: 6545 7272 6f72 2866 2255 6e73 7570 706f  eError(f"Unsuppo
-0002c5d0: 7274 6564 2064 7479 7065 3a20 7b64 7479  rted dtype: {dty
-0002c5e0: 7065 7d22 290d 0a0d 0a20 2072 203d 2031  pe}")....  r = 1
-0002c5f0: 2e30 202b 206a 6e70 2e73 7172 7428 312e  .0 + jnp.sqrt(1.
-0002c600: 3020 2b20 342e 3020 2a20 636f 6e63 656e  0 + 4.0 * concen
-0002c610: 7472 6174 696f 6e20 2a2a 2032 290d 0a20  tration ** 2).. 
-0002c620: 2072 686f 203d 2028 7220 2d20 6a6e 702e   rho = (r - jnp.
-0002c630: 7371 7274 2832 2e30 202a 2072 2929 202f  sqrt(2.0 * r)) /
-0002c640: 2028 322e 3020 2a20 636f 6e63 656e 7472   (2.0 * concentr
-0002c650: 6174 696f 6e29 0d0a 2020 735f 6578 6163  ation)..  s_exac
-0002c660: 7420 3d20 2831 2e30 202b 2072 686f 202a  t = (1.0 + rho *
-0002c670: 2a20 3229 202f 2028 322e 3020 2a20 7268  * 2) / (2.0 * rh
-0002c680: 6f29 0d0a 0d0a 2020 735f 6170 7072 6f78  o)....  s_approx
-0002c690: 696d 6174 6520 3d20 312e 3020 2f20 636f  imate = 1.0 / co
-0002c6a0: 6e63 656e 7472 6174 696f 6e0d 0a0d 0a20  ncentration.... 
-0002c6b0: 2073 203d 206a 6e70 2e77 6865 7265 2863   s = jnp.where(c
-0002c6c0: 6f6e 6365 6e74 7261 7469 6f6e 203e 2073  oncentration > s
-0002c6d0: 5f63 7574 6f66 662c 2073 5f65 7861 6374  _cutoff, s_exact
-0002c6e0: 2c20 735f 6170 7072 6f78 696d 6174 6529  , s_approximate)
-0002c6f0: 0d0a 0d0a 2020 6465 6620 636f 6e64 5f66  ....  def cond_f
-0002c700: 6e28 2a61 7267 7329 3a0d 0a20 2020 2022  n(*args):..    "
-0002c710: 2222 6368 6563 6b20 6966 2061 6c6c 2061  ""check if all a
-0002c720: 7265 2064 6f6e 6520 6f72 2072 6561 6368  re done or reach
-0002c730: 6564 206d 6178 206e 756d 6265 7220 6f66  ed max number of
-0002c740: 2069 7465 7261 7469 6f6e 7322 2222 0d0a   iterations"""..
-0002c750: 2020 2020 692c 205f 2c20 646f 6e65 2c20      i, _, done, 
-0002c760: 5f2c 205f 203d 2061 7267 735b 305d 0d0a  _, _ = args[0]..
-0002c770: 2020 2020 7265 7475 726e 206a 6e70 2e62      return jnp.b
-0002c780: 6974 7769 7365 5f61 6e64 2869 203c 2031  itwise_and(i < 1
-0002c790: 3030 2c20 6a6e 702e 6c6f 6769 6361 6c5f  00, jnp.logical_
-0002c7a0: 6e6f 7428 6a6e 702e 616c 6c28 646f 6e65  not(jnp.all(done
-0002c7b0: 2929 290d 0a0d 0a20 2064 6566 2062 6f64  )))....  def bod
-0002c7c0: 795f 666e 282a 6172 6773 293a 0d0a 2020  y_fn(*args):..  
-0002c7d0: 2020 692c 206b 6579 2c20 646f 6e65 2c20    i, key, done, 
-0002c7e0: 5f2c 2077 203d 2061 7267 735b 305d 0d0a  _, w = args[0]..
-0002c7f0: 2020 2020 756e 695f 756b 6579 2c20 756e      uni_ukey, un
-0002c800: 695f 766b 6579 2c20 6b65 7920 3d20 6a72  i_vkey, key = jr
-0002c810: 2e73 706c 6974 286b 6579 2c20 3329 0d0a  .split(key, 3)..
-0002c820: 2020 2020 7520 3d20 6a72 2e75 6e69 666f      u = jr.unifo
-0002c830: 726d 280d 0a20 2020 2020 206b 6579 3d75  rm(..      key=u
-0002c840: 6e69 5f75 6b65 792c 0d0a 2020 2020 2020  ni_ukey,..      
-0002c850: 7368 6170 653d 7368 6170 652c 0d0a 2020  shape=shape,..  
-0002c860: 2020 2020 6474 7970 653d 636f 6e63 656e      dtype=concen
-0002c870: 7472 6174 696f 6e2e 6474 7970 652c 0d0a  tration.dtype,..
-0002c880: 2020 2020 2020 6d69 6e76 616c 3d2d 312e        minval=-1.
-0002c890: 302c 0d0a 2020 2020 2020 6d61 7876 616c  0,..      maxval
-0002c8a0: 3d31 2e30 2c0d 0a20 2020 2029 0d0a 2020  =1.0,..    )..  
-0002c8b0: 2020 7a20 3d20 6a6e 702e 636f 7328 6a6e    z = jnp.cos(jn
-0002c8c0: 702e 7069 202a 2075 290d 0a20 2020 2077  p.pi * u)..    w
-0002c8d0: 203d 206a 6e70 2e77 6865 7265 2864 6f6e   = jnp.where(don
-0002c8e0: 652c 2077 2c20 2831 2e30 202b 2073 202a  e, w, (1.0 + s *
-0002c8f0: 207a 2920 2f20 2873 202b 207a 2929 2020   z) / (s + z))  
-0002c900: 2320 5570 6461 7465 2077 6865 7265 206e  # Update where n
-0002c910: 6f74 2064 6f6e 650d 0a20 2020 2079 203d  ot done..    y =
-0002c920: 2063 6f6e 6365 6e74 7261 7469 6f6e 202a   concentration *
-0002c930: 2028 7320 2d20 7729 0d0a 2020 2020 7620   (s - w)..    v 
-0002c940: 3d20 6a72 2e75 6e69 666f 726d 286b 6579  = jr.uniform(key
-0002c950: 3d75 6e69 5f76 6b65 792c 2073 6861 7065  =uni_vkey, shape
-0002c960: 3d73 6861 7065 2c20 6474 7970 653d 636f  =shape, dtype=co
-0002c970: 6e63 656e 7472 6174 696f 6e2e 6474 7970  ncentration.dtyp
-0002c980: 6529 0d0a 2020 2020 6163 6365 7074 203d  e)..    accept =
-0002c990: 2028 7920 2a20 2832 2e30 202d 2079 2920   (y * (2.0 - y) 
-0002c9a0: 3e3d 2076 2920 7c20 286a 6e70 2e6c 6f67  >= v) | (jnp.log
-0002c9b0: 2879 202f 2076 2920 2b20 312e 3020 3e3d  (y / v) + 1.0 >=
-0002c9c0: 2079 290d 0a20 2020 2072 6574 7572 6e20   y)..    return 
-0002c9d0: 6920 2b20 312c 206b 6579 2c20 6163 6365  i + 1, key, acce
-0002c9e0: 7074 207c 2064 6f6e 652c 2075 2c20 770d  pt | done, u, w.
-0002c9f0: 0a0d 0a20 2069 6e69 745f 646f 6e65 203d  ...  init_done =
-0002ca00: 206a 6e70 2e7a 6572 6f73 2873 6861 7065   jnp.zeros(shape
-0002ca10: 2c20 6474 7970 653d 626f 6f6c 290d 0a20  , dtype=bool).. 
-0002ca20: 2069 6e69 745f 7520 3d20 6a6e 702e 7a65   init_u = jnp.ze
-0002ca30: 726f 7328 7368 6170 6529 0d0a 2020 696e  ros(shape)..  in
-0002ca40: 6974 5f77 203d 206a 6e70 2e7a 6572 6f73  it_w = jnp.zeros
-0002ca50: 2873 6861 7065 290d 0a0d 0a20 205f 2c20  (shape)....  _, 
-0002ca60: 5f2c 2064 6f6e 652c 2075 2c20 7720 3d20  _, done, u, w = 
-0002ca70: 6c61 782e 7768 696c 655f 6c6f 6f70 280d  lax.while_loop(.
-0002ca80: 0a20 2020 2063 6f6e 645f 6675 6e3d 636f  .    cond_fun=co
-0002ca90: 6e64 5f66 6e2c 0d0a 2020 2020 626f 6479  nd_fn,..    body
-0002caa0: 5f66 756e 3d62 6f64 795f 666e 2c0d 0a20  _fun=body_fn,.. 
-0002cab0: 2020 2069 6e69 745f 7661 6c3d 286a 6e70     init_val=(jnp
-0002cac0: 2e61 7272 6179 2830 292c 206b 6579 2c20  .array(0), key, 
-0002cad0: 696e 6974 5f64 6f6e 652c 2069 6e69 745f  init_done, init_
-0002cae0: 752c 2069 6e69 745f 7729 2c0d 0a20 2029  u, init_w),..  )
-0002caf0: 0d0a 0d0a 2020 7265 7475 726e 206a 6e70  ....  return jnp
-0002cb00: 2e73 6967 6e28 7529 202a 206a 6e70 2e61  .sign(u) * jnp.a
-0002cb10: 7263 636f 7328 7729 0d0a 0d0a 0d0a 6465  rccos(w)......de
-0002cb20: 6620 5f6c 6f63 5f73 6361 6c65 286c 6f63  f _loc_scale(loc
-0002cb30: 2c20 7363 616c 652c 2076 616c 7565 293a  , scale, value):
-0002cb40: 0d0a 2020 6966 206c 6f63 2069 7320 4e6f  ..  if loc is No
-0002cb50: 6e65 3a0d 0a20 2020 2069 6620 7363 616c  ne:..    if scal
-0002cb60: 6520 6973 204e 6f6e 653a 0d0a 2020 2020  e is None:..    
-0002cb70: 2020 7265 7475 726e 2076 616c 7565 0d0a    return value..
-0002cb80: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0002cb90: 2072 6574 7572 6e20 7661 6c75 6520 2a20   return value * 
-0002cba0: 7363 616c 650d 0a20 2065 6c73 653a 0d0a  scale..  else:..
-0002cbb0: 2020 2020 6966 2073 6361 6c65 2069 7320      if scale is 
-0002cbc0: 4e6f 6e65 3a0d 0a20 2020 2020 2072 6574  None:..      ret
-0002cbd0: 7572 6e20 7661 6c75 6520 2b20 6c6f 630d  urn value + loc.
-0002cbe0: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
-0002cbf0: 2020 7265 7475 726e 2076 616c 7565 202a    return value *
-0002cc00: 2073 6361 6c65 202b 206c 6f63 0d0a 0d0a   scale + loc....
-0002cc10: 0d0a 6465 6620 5f63 6865 636b 5f70 795f  ..def _check_py_
-0002cc20: 7365 7128 7365 7129 3a0d 0a20 2072 6574  seq(seq):..  ret
-0002cc30: 7572 6e20 6a6e 702e 6173 6172 7261 7928  urn jnp.asarray(
-0002cc40: 7365 7129 2069 6620 6973 696e 7374 616e  seq) if isinstan
-0002cc50: 6365 2873 6571 2c20 2874 7570 6c65 2c20  ce(seq, (tuple, 
-0002cc60: 6c69 7374 2929 2065 6c73 6520 7365 710d  list)) else seq.
-0002cc70: 0a0d 0a0d 0a23 202d 2d2d 2d2d 2d2d 2d2d  .....# ---------
-0002cc80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002cc90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002cca0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002ccb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002ccc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002ccd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002cce0: 2d2d 2d2d 2d2d 0d0a 0d0a 0d0a 666f 7220  ------......for 
-0002ccf0: 5f5f 6b20 696e 2064 6972 2852 616e 646f  __k in dir(Rando
-0002cd00: 6d53 7461 7465 293a 0d0a 2020 5f5f 7420  mState):..  __t 
-0002cd10: 3d20 6765 7461 7474 7228 5261 6e64 6f6d  = getattr(Random
-0002cd20: 5374 6174 652c 205f 5f6b 290d 0a20 2069  State, __k)..  i
-0002cd30: 6620 6e6f 7420 5f5f 6b2e 7374 6172 7473  f not __k.starts
-0002cd40: 7769 7468 2827 5f5f 2729 2061 6e64 2063  with('__') and c
-0002cd50: 616c 6c61 626c 6528 5f5f 7429 2061 6e64  allable(__t) and
-0002cd60: 2028 6e6f 7420 5f5f 742e 5f5f 646f 635f   (not __t.__doc_
-0002cd70: 5f29 3a0d 0a20 2020 205f 5f72 203d 2067  _):..    __r = g
-0002cd80: 6c6f 6261 6c73 2829 2e67 6574 285f 5f6b  lobals().get(__k
-0002cd90: 2c20 4e6f 6e65 290d 0a20 2020 2069 6620  , None)..    if 
-0002cda0: 5f5f 7220 6973 206e 6f74 204e 6f6e 6520  __r is not None 
-0002cdb0: 616e 6420 6361 6c6c 6162 6c65 285f 5f72  and callable(__r
-0002cdc0: 293a 0d0a 2020 2020 2020 5f5f 742e 5f5f  ):..      __t.__
-0002cdd0: 646f 635f 5f20 3d20 5f5f 722e 5f5f 646f  doc__ = __r.__do
-0002cde0: 635f 5f0d 0a                             c__..
+0001b910: 2076 6172 6961 626c 6573 3a0d 0a0d 0a20   variables:.... 
+0001b920: 202e 2e20 6d61 7468 3a3a 2051 203d 205c   .. math:: Q = \
+0001b930: 7375 6d5f 7b69 3d30 7d5e 7b5c 6d61 7468  sum_{i=0}^{\math
+0001b940: 7474 7b64 667d 7d20 585e 325f 690d 0a0d  tt{df}} X^2_i...
+0001b950: 0a20 2069 7320 6368 692d 7371 7561 7265  .  is chi-square
+0001b960: 2064 6973 7472 6962 7574 6564 2c20 6465   distributed, de
+0001b970: 6e6f 7465 640d 0a0d 0a20 202e 2e20 6d61  noted....  .. ma
+0001b980: 7468 3a3a 2051 205c 7369 6d20 5c63 6869  th:: Q \sim \chi
+0001b990: 5e32 5f6b 2e0d 0a0d 0a20 2054 6865 2070  ^2_k.....  The p
+0001b9a0: 726f 6261 6269 6c69 7479 2064 656e 7369  robability densi
+0001b9b0: 7479 2066 756e 6374 696f 6e20 6f66 2074  ty function of t
+0001b9c0: 6865 2063 6869 2d73 7175 6172 6564 2064  he chi-squared d
+0001b9d0: 6973 7472 6962 7574 696f 6e20 6973 0d0a  istribution is..
+0001b9e0: 0d0a 2020 2e2e 206d 6174 683a 3a20 7028  ..  .. math:: p(
+0001b9f0: 7829 203d 205c 6672 6163 7b28 312f 3229  x) = \frac{(1/2)
+0001ba00: 5e7b 6b2f 327d 7d7b 5c47 616d 6d61 286b  ^{k/2}}{\Gamma(k
+0001ba10: 2f32 297d 0d0a 2020 2020 2020 2020 2020  /2)}..          
+0001ba20: 2020 2020 2020 2020 2078 5e7b 6b2f 3220           x^{k/2 
+0001ba30: 2d20 317d 2065 5e7b 2d78 2f32 7d2c 0d0a  - 1} e^{-x/2},..
+0001ba40: 0d0a 2020 7768 6572 6520 3a6d 6174 683a  ..  where :math:
+0001ba50: 605c 4761 6d6d 6160 2069 7320 7468 6520  `\Gamma` is the 
+0001ba60: 6761 6d6d 6120 6675 6e63 7469 6f6e 2c0d  gamma function,.
+0001ba70: 0a0d 0a20 202e 2e20 6d61 7468 3a3a 205c  ...  .. math:: \
+0001ba80: 4761 6d6d 6128 7829 203d 205c 696e 745f  Gamma(x) = \int_
+0001ba90: 305e 7b2d 5c69 6e66 7479 7d20 745e 7b78  0^{-\infty} t^{x
+0001baa0: 202d 2031 7d20 655e 7b2d 747d 2064 742e   - 1} e^{-t} dt.
+0001bab0: 0d0a 0d0a 2020 5265 6665 7265 6e63 6573  ....  References
+0001bac0: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  ..  ----------..
+0001bad0: 2020 2e2e 205b 315d 204e 4953 5420 2245    .. [1] NIST "E
+0001bae0: 6e67 696e 6565 7269 6e67 2053 7461 7469  ngineering Stati
+0001baf0: 7374 6963 7320 4861 6e64 626f 6f6b 220d  stics Handbook".
+0001bb00: 0a20 2020 2020 2020 2020 6874 7470 733a  .         https:
+0001bb10: 2f2f 7777 772e 6974 6c2e 6e69 7374 2e67  //www.itl.nist.g
+0001bb20: 6f76 2f64 6976 3839 382f 6861 6e64 626f  ov/div898/handbo
+0001bb30: 6f6b 2f65 6461 2f73 6563 7469 6f6e 332f  ok/eda/section3/
+0001bb40: 6564 6133 3636 362e 6874 6d0d 0a0d 0a20  eda3666.htm.... 
+0001bb50: 2045 7861 6d70 6c65 730d 0a20 202d 2d2d   Examples..  ---
+0001bb60: 2d2d 2d2d 2d0d 0a20 203e 3e3e 2062 7261  -----..  >>> bra
+0001bb70: 696e 636f 7265 2e72 616e 646f 6d2e 6368  incore.random.ch
+0001bb80: 6973 7175 6172 6528 322c 3429 0d0a 2020  isquare(2,4)..  
+0001bb90: 6172 7261 7928 5b20 312e 3839 3932 3030  array([ 1.899200
+0001bba0: 3134 2c20 2039 2e30 3038 3637 3731 362c  14,  9.00867716,
+0001bbb0: 2020 332e 3133 3731 3035 3333 2c20 2035    3.13710533,  5
+0001bbc0: 2e36 3233 3138 3237 325d 2920 2320 7261  .62318272]) # ra
+0001bbd0: 6e64 6f6d 0d0a 2020 2222 220d 0a20 2072  ndom..  """..  r
+0001bbe0: 6574 7572 6e20 4445 4641 554c 542e 6368  eturn DEFAULT.ch
+0001bbf0: 6973 7175 6172 6528 6466 2c20 7369 7a65  isquare(df, size
+0001bc00: 2c20 6b65 793d 6b65 792c 2064 7479 7065  , key=key, dtype
+0001bc10: 3d64 7479 7065 290d 0a0d 0a0d 0a64 6566  =dtype)......def
+0001bc20: 2064 6972 6963 686c 6574 2861 6c70 6861   dirichlet(alpha
+0001bc30: 2c20 7369 7a65 3a20 4f70 7469 6f6e 616c  , size: Optional
+0001bc40: 5b53 697a 655d 203d 204e 6f6e 652c 206b  [Size] = None, k
+0001bc50: 6579 3a20 4f70 7469 6f6e 616c 5b53 6565  ey: Optional[See
+0001bc60: 644f 724b 6579 5d20 3d20 4e6f 6e65 2c20  dOrKey] = None, 
+0001bc70: 6474 7970 653a 2044 5479 7065 4c69 6b65  dtype: DTypeLike
+0001bc80: 203d 204e 6f6e 6529 3a0d 0a20 2072 2222   = None):..  r""
+0001bc90: 220d 0a20 2044 7261 7720 7361 6d70 6c65  "..  Draw sample
+0001bca0: 7320 6672 6f6d 2074 6865 2044 6972 6963  s from the Diric
+0001bcb0: 686c 6574 2064 6973 7472 6962 7574 696f  hlet distributio
+0001bcc0: 6e2e 0d0a 0d0a 2020 4472 6177 2060 7369  n.....  Draw `si
+0001bcd0: 7a65 6020 7361 6d70 6c65 7320 6f66 2064  ze` samples of d
+0001bce0: 696d 656e 7369 6f6e 206b 2066 726f 6d20  imension k from 
+0001bcf0: 6120 4469 7269 6368 6c65 7420 6469 7374  a Dirichlet dist
+0001bd00: 7269 6275 7469 6f6e 2e20 410d 0a20 2044  ribution. A..  D
+0001bd10: 6972 6963 686c 6574 2d64 6973 7472 6962  irichlet-distrib
+0001bd20: 7574 6564 2072 616e 646f 6d20 7661 7269  uted random vari
+0001bd30: 6162 6c65 2063 616e 2062 6520 7365 656e  able can be seen
+0001bd40: 2061 7320 6120 6d75 6c74 6976 6172 6961   as a multivaria
+0001bd50: 7465 0d0a 2020 6765 6e65 7261 6c69 7a61  te..  generaliza
+0001bd60: 7469 6f6e 206f 6620 6120 4265 7461 2064  tion of a Beta d
+0001bd70: 6973 7472 6962 7574 696f 6e2e 2054 6865  istribution. The
+0001bd80: 2044 6972 6963 686c 6574 2064 6973 7472   Dirichlet distr
+0001bd90: 6962 7574 696f 6e0d 0a20 2069 7320 6120  ibution..  is a 
+0001bda0: 636f 6e6a 7567 6174 6520 7072 696f 7220  conjugate prior 
+0001bdb0: 6f66 2061 206d 756c 7469 6e6f 6d69 616c  of a multinomial
+0001bdc0: 2064 6973 7472 6962 7574 696f 6e20 696e   distribution in
+0001bdd0: 2042 6179 6573 6961 6e0d 0a20 2069 6e66   Bayesian..  inf
+0001bde0: 6572 656e 6365 2e0d 0a0d 0a20 2050 6172  erence.....  Par
+0001bdf0: 616d 6574 6572 730d 0a20 202d 2d2d 2d2d  ameters..  -----
+0001be00: 2d2d 2d2d 2d0d 0a20 2061 6c70 6861 203a  -----..  alpha :
+0001be10: 2073 6571 7565 6e63 6520 6f66 2066 6c6f   sequence of flo
+0001be20: 6174 732c 206c 656e 6774 6820 6b0d 0a20  ats, length k.. 
+0001be30: 2020 2020 2050 6172 616d 6574 6572 206f       Parameter o
+0001be40: 6620 7468 6520 6469 7374 7269 6275 7469  f the distributi
+0001be50: 6f6e 2028 6c65 6e67 7468 2060 606b 6060  on (length ``k``
+0001be60: 2066 6f72 2073 616d 706c 6520 6f66 0d0a   for sample of..
+0001be70: 2020 2020 2020 6c65 6e67 7468 2060 606b        length ``k
+0001be80: 6060 292e 0d0a 2020 7369 7a65 203a 2069  ``)...  size : i
+0001be90: 6e74 206f 7220 7475 706c 6520 6f66 2069  nt or tuple of i
+0001bea0: 6e74 732c 206f 7074 696f 6e61 6c0d 0a20  nts, optional.. 
+0001beb0: 2020 2020 204f 7574 7075 7420 7368 6170       Output shap
+0001bec0: 652e 2020 4966 2074 6865 2067 6976 656e  e.  If the given
+0001bed0: 2073 6861 7065 2069 732c 2065 2e67 2e2c   shape is, e.g.,
+0001bee0: 2060 6028 6d2c 206e 2960 602c 2074 6865   ``(m, n)``, the
+0001bef0: 6e0d 0a20 2020 2020 2060 606d 202a 206e  n..      ``m * n
+0001bf00: 202a 206b 6060 2073 616d 706c 6573 2061   * k`` samples a
+0001bf10: 7265 2064 7261 776e 2e20 2044 6566 6175  re drawn.  Defau
+0001bf20: 6c74 2069 7320 4e6f 6e65 2c20 696e 2077  lt is None, in w
+0001bf30: 6869 6368 2063 6173 6520 610d 0a20 2020  hich case a..   
+0001bf40: 2020 2076 6563 746f 7220 6f66 206c 656e     vector of len
+0001bf50: 6774 6820 6060 6b60 6020 6973 2072 6574  gth ``k`` is ret
+0001bf60: 7572 6e65 642e 0d0a 2020 6b65 7920 3a20  urned...  key : 
+0001bf70: 5052 4e47 4b65 792c 206f 7074 696f 6e61  PRNGKey, optiona
+0001bf80: 6c0d 0a20 2020 2020 2054 6865 206b 6579  l..      The key
+0001bf90: 2066 6f72 2074 6865 2072 616e 646f 6d20   for the random 
+0001bfa0: 6e75 6d62 6572 2067 656e 6572 6174 6f72  number generator
+0001bfb0: 2e20 4966 206e 6f74 2067 6976 656e 2c20  . If not given, 
+0001bfc0: 7468 650d 0a20 2020 2020 2064 6566 6175  the..      defau
+0001bfd0: 6c74 2072 616e 646f 6d20 6e75 6d62 6572  lt random number
+0001bfe0: 2067 656e 6572 6174 6f72 2069 7320 7573   generator is us
+0001bff0: 6564 2e0d 0a0d 0a20 2052 6574 7572 6e73  ed.....  Returns
+0001c000: 0d0a 2020 2d2d 2d2d 2d2d 2d0d 0a20 2073  ..  -------..  s
+0001c010: 616d 706c 6573 203a 206e 6461 7272 6179  amples : ndarray
+0001c020: 2c0d 0a20 2020 2020 2054 6865 2064 7261  ,..      The dra
+0001c030: 776e 2073 616d 706c 6573 2c20 6f66 2073  wn samples, of s
+0001c040: 6861 7065 2060 6028 7369 7a65 2c20 6b29  hape ``(size, k)
+0001c050: 6060 2e0d 0a0d 0a20 2052 6169 7365 730d  ``.....  Raises.
+0001c060: 0a20 202d 2d2d 2d2d 2d0d 0a20 2056 616c  .  ------..  Val
+0001c070: 7565 4572 726f 720d 0a20 2020 2020 2049  ueError..      I
+0001c080: 6620 616e 7920 7661 6c75 6520 696e 2060  f any value in `
+0001c090: 6061 6c70 6861 6060 2069 7320 6c65 7373  `alpha`` is less
+0001c0a0: 2074 6861 6e20 6f72 2065 7175 616c 2074   than or equal t
+0001c0b0: 6f20 7a65 726f 0d0a 0d0a 2020 4e6f 7465  o zero....  Note
+0001c0c0: 730d 0a20 202d 2d2d 2d2d 0d0a 2020 5468  s..  -----..  Th
+0001c0d0: 6520 4469 7269 6368 6c65 7420 6469 7374  e Dirichlet dist
+0001c0e0: 7269 6275 7469 6f6e 2069 7320 6120 6469  ribution is a di
+0001c0f0: 7374 7269 6275 7469 6f6e 206f 7665 7220  stribution over 
+0001c100: 7665 6374 6f72 730d 0a20 203a 6d61 7468  vectors..  :math
+0001c110: 3a60 7860 2074 6861 7420 6675 6c66 696c  :`x` that fulfil
+0001c120: 2074 6865 2063 6f6e 6469 7469 6f6e 7320   the conditions 
+0001c130: 3a6d 6174 683a 6078 5f69 3e30 6020 616e  :math:`x_i>0` an
+0001c140: 640d 0a20 203a 6d61 7468 3a60 5c73 756d  d..  :math:`\sum
+0001c150: 5f7b 693d 317d 5e6b 2078 5f69 203d 2031  _{i=1}^k x_i = 1
+0001c160: 602e 0d0a 0d0a 2020 5468 6520 7072 6f62  `.....  The prob
+0001c170: 6162 696c 6974 7920 6465 6e73 6974 7920  ability density 
+0001c180: 6675 6e63 7469 6f6e 203a 6d61 7468 3a60  function :math:`
+0001c190: 7060 206f 6620 610d 0a20 2044 6972 6963  p` of a..  Diric
+0001c1a0: 686c 6574 2d64 6973 7472 6962 7574 6564  hlet-distributed
+0001c1b0: 2072 616e 646f 6d20 7665 6374 6f72 203a   random vector :
+0001c1c0: 6d61 7468 3a60 5860 2069 730d 0a20 2070  math:`X` is..  p
+0001c1d0: 726f 706f 7274 696f 6e61 6c20 746f 0d0a  roportional to..
+0001c1e0: 0d0a 2020 2e2e 206d 6174 683a 3a20 7028  ..  .. math:: p(
+0001c1f0: 7829 205c 7072 6f70 746f 205c 7072 6f64  x) \propto \prod
+0001c200: 5f7b 693d 317d 5e7b 6b7d 7b78 5e7b 5c61  _{i=1}^{k}{x^{\a
+0001c210: 6c70 6861 5f69 2d31 7d5f 697d 2c0d 0a0d  lpha_i-1}_i},...
+0001c220: 0a20 2077 6865 7265 203a 6d61 7468 3a60  .  where :math:`
+0001c230: 5c61 6c70 6861 6020 6973 2061 2076 6563  \alpha` is a vec
+0001c240: 746f 7220 636f 6e74 6169 6e69 6e67 2074  tor containing t
+0001c250: 6865 2070 6f73 6974 6976 650d 0a20 2063  he positive..  c
+0001c260: 6f6e 6365 6e74 7261 7469 6f6e 2070 6172  oncentration par
+0001c270: 616d 6574 6572 732e 0d0a 0d0a 2020 5468  ameters.....  Th
+0001c280: 6520 6d65 7468 6f64 2075 7365 7320 7468  e method uses th
+0001c290: 6520 666f 6c6c 6f77 696e 6720 7072 6f70  e following prop
+0001c2a0: 6572 7479 2066 6f72 2063 6f6d 7075 7461  erty for computa
+0001c2b0: 7469 6f6e 3a20 6c65 7420 3a6d 6174 683a  tion: let :math:
+0001c2c0: 6059 600d 0a20 2062 6520 6120 7261 6e64  `Y`..  be a rand
+0001c2d0: 6f6d 2076 6563 746f 7220 7768 6963 6820  om vector which 
+0001c2e0: 6861 7320 636f 6d70 6f6e 656e 7473 2074  has components t
+0001c2f0: 6861 7420 666f 6c6c 6f77 2061 2073 7461  hat follow a sta
+0001c300: 6e64 6172 6420 6761 6d6d 610d 0a20 2064  ndard gamma..  d
+0001c310: 6973 7472 6962 7574 696f 6e2c 2074 6865  istribution, the
+0001c320: 6e20 3a6d 6174 683a 6058 203d 205c 6672  n :math:`X = \fr
+0001c330: 6163 7b31 7d7b 5c73 756d 5f7b 693d 317d  ac{1}{\sum_{i=1}
+0001c340: 5e6b 7b59 5f69 7d7d 2059 600d 0a20 2069  ^k{Y_i}} Y`..  i
+0001c350: 7320 4469 7269 6368 6c65 742d 6469 7374  s Dirichlet-dist
+0001c360: 7269 6275 7465 640d 0a0d 0a20 2052 6566  ributed....  Ref
+0001c370: 6572 656e 6365 730d 0a20 202d 2d2d 2d2d  erences..  -----
+0001c380: 2d2d 2d2d 2d0d 0a20 202e 2e20 5b31 5d20  -----..  .. [1] 
+0001c390: 4461 7669 6420 4d63 4b61 792c 2022 496e  David McKay, "In
+0001c3a0: 666f 726d 6174 696f 6e20 5468 656f 7279  formation Theory
+0001c3b0: 2c20 496e 6665 7265 6e63 6520 616e 6420  , Inference and 
+0001c3c0: 4c65 6172 6e69 6e67 0d0a 2020 2020 2020  Learning..      
+0001c3d0: 2020 2041 6c67 6f72 6974 686d 732c 2220     Algorithms," 
+0001c3e0: 6368 6170 7465 7220 3233 2c0d 0a20 2020  chapter 23,..   
+0001c3f0: 2020 2020 2020 6874 7470 3a2f 2f77 7777        http://www
+0001c400: 2e69 6e66 6572 656e 6365 2e6f 7267 2e75  .inference.org.u
+0001c410: 6b2f 6d61 636b 6179 2f69 7469 6c61 2f0d  k/mackay/itila/.
+0001c420: 0a20 202e 2e20 5b32 5d20 5769 6b69 7065  .  .. [2] Wikipe
+0001c430: 6469 612c 2022 4469 7269 6368 6c65 7420  dia, "Dirichlet 
+0001c440: 6469 7374 7269 6275 7469 6f6e 222c 0d0a  distribution",..
+0001c450: 2020 2020 2020 2020 2068 7474 7073 3a2f           https:/
+0001c460: 2f65 6e2e 7769 6b69 7065 6469 612e 6f72  /en.wikipedia.or
+0001c470: 672f 7769 6b69 2f44 6972 6963 686c 6574  g/wiki/Dirichlet
+0001c480: 5f64 6973 7472 6962 7574 696f 6e0d 0a0d  _distribution...
+0001c490: 0a20 2045 7861 6d70 6c65 730d 0a20 202d  .  Examples..  -
+0001c4a0: 2d2d 2d2d 2d2d 2d0d 0a20 2054 616b 696e  -------..  Takin
+0001c4b0: 6720 616e 2065 7861 6d70 6c65 2063 6974  g an example cit
+0001c4c0: 6564 2069 6e20 5769 6b69 7065 6469 612c  ed in Wikipedia,
+0001c4d0: 2074 6869 7320 6469 7374 7269 6275 7469   this distributi
+0001c4e0: 6f6e 2063 616e 2062 6520 7573 6564 2069  on can be used i
+0001c4f0: 660d 0a20 206f 6e65 2077 616e 7465 6420  f..  one wanted 
+0001c500: 746f 2063 7574 2073 7472 696e 6773 2028  to cut strings (
+0001c510: 6561 6368 206f 6620 696e 6974 6961 6c20  each of initial 
+0001c520: 6c65 6e67 7468 2031 2e30 2920 696e 746f  length 1.0) into
+0001c530: 204b 2070 6965 6365 730d 0a20 2077 6974   K pieces..  wit
+0001c540: 6820 6469 6666 6572 656e 7420 6c65 6e67  h different leng
+0001c550: 7468 732c 2077 6865 7265 2065 6163 6820  ths, where each 
+0001c560: 7069 6563 6520 6861 642c 206f 6e20 6176  piece had, on av
+0001c570: 6572 6167 652c 2061 2064 6573 6967 6e61  erage, a designa
+0001c580: 7465 640d 0a20 2061 7665 7261 6765 206c  ted..  average l
+0001c590: 656e 6774 682c 2062 7574 2061 6c6c 6f77  ength, but allow
+0001c5a0: 696e 6720 736f 6d65 2076 6172 6961 7469  ing some variati
+0001c5b0: 6f6e 2069 6e20 7468 6520 7265 6c61 7469  on in the relati
+0001c5c0: 7665 2073 697a 6573 206f 660d 0a20 2074  ve sizes of..  t
+0001c5d0: 6865 2070 6965 6365 732e 0d0a 0d0a 2020  he pieces.....  
+0001c5e0: 3e3e 3e20 7320 3d20 6272 6169 6e63 6f72  >>> s = braincor
+0001c5f0: 652e 7261 6e64 6f6d 2e64 6972 6963 686c  e.random.dirichl
+0001c600: 6574 2828 3130 2c20 352c 2033 292c 2032  et((10, 5, 3), 2
+0001c610: 3029 2e74 7261 6e73 706f 7365 2829 0d0a  0).transpose()..
+0001c620: 0d0a 2020 3e3e 3e20 696d 706f 7274 206d  ..  >>> import m
+0001c630: 6174 706c 6f74 6c69 622e 7079 706c 6f74  atplotlib.pyplot
+0001c640: 2061 7320 706c 7420 2023 206e 6f71 610d   as plt  # noqa.
+0001c650: 0a20 203e 3e3e 2070 6c74 2e62 6172 6828  .  >>> plt.barh(
+0001c660: 7261 6e67 6528 3230 292c 2073 5b30 5d29  range(20), s[0])
+0001c670: 0d0a 2020 3e3e 3e20 706c 742e 6261 7268  ..  >>> plt.barh
+0001c680: 2872 616e 6765 2832 3029 2c20 735b 315d  (range(20), s[1]
+0001c690: 2c20 6c65 6674 3d73 5b30 5d2c 2063 6f6c  , left=s[0], col
+0001c6a0: 6f72 3d27 6727 290d 0a20 203e 3e3e 2070  or='g')..  >>> p
+0001c6b0: 6c74 2e62 6172 6828 7261 6e67 6528 3230  lt.barh(range(20
+0001c6c0: 292c 2073 5b32 5d2c 206c 6566 743d 735b  ), s[2], left=s[
+0001c6d0: 305d 2b73 5b31 5d2c 2063 6f6c 6f72 3d27  0]+s[1], color='
+0001c6e0: 7227 290d 0a20 203e 3e3e 2070 6c74 2e74  r')..  >>> plt.t
+0001c6f0: 6974 6c65 2822 4c65 6e67 7468 7320 6f66  itle("Lengths of
+0001c700: 2053 7472 696e 6773 2229 0d0a 2020 2222   Strings")..  ""
+0001c710: 220d 0a20 2072 6574 7572 6e20 4445 4641  "..  return DEFA
+0001c720: 554c 542e 6469 7269 6368 6c65 7428 616c  ULT.dirichlet(al
+0001c730: 7068 612c 2073 697a 652c 206b 6579 3d6b  pha, size, key=k
+0001c740: 6579 2c20 6474 7970 653d 6474 7970 6529  ey, dtype=dtype)
+0001c750: 0d0a 0d0a 0d0a 6465 6620 6765 6f6d 6574  ......def geomet
+0001c760: 7269 6328 702c 2073 697a 653a 204f 7074  ric(p, size: Opt
+0001c770: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
+0001c780: 6e65 2c20 6b65 793a 204f 7074 696f 6e61  ne, key: Optiona
+0001c790: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
+0001c7a0: 6f6e 652c 2064 7479 7065 3a20 4454 7970  one, dtype: DTyp
+0001c7b0: 654c 696b 6520 3d20 4e6f 6e65 293a 0d0a  eLike = None):..
+0001c7c0: 2020 7222 2222 0d0a 2020 4472 6177 2073    r"""..  Draw s
+0001c7d0: 616d 706c 6573 2066 726f 6d20 7468 6520  amples from the 
+0001c7e0: 6765 6f6d 6574 7269 6320 6469 7374 7269  geometric distri
+0001c7f0: 6275 7469 6f6e 2e0d 0a0d 0a20 2042 6572  bution.....  Ber
+0001c800: 6e6f 756c 6c69 2074 7269 616c 7320 6172  noulli trials ar
+0001c810: 6520 6578 7065 7269 6d65 6e74 7320 7769  e experiments wi
+0001c820: 7468 206f 6e65 206f 6620 7477 6f20 6f75  th one of two ou
+0001c830: 7463 6f6d 6573 3a0d 0a20 2073 7563 6365  tcomes:..  succe
+0001c840: 7373 206f 7220 6661 696c 7572 6520 2861  ss or failure (a
+0001c850: 6e20 6578 616d 706c 6520 6f66 2073 7563  n example of suc
+0001c860: 6820 616e 2065 7870 6572 696d 656e 7420  h an experiment 
+0001c870: 6973 2066 6c69 7070 696e 670d 0a20 2061  is flipping..  a
+0001c880: 2063 6f69 6e29 2e20 2054 6865 2067 656f   coin).  The geo
+0001c890: 6d65 7472 6963 2064 6973 7472 6962 7574  metric distribut
+0001c8a0: 696f 6e20 6d6f 6465 6c73 2074 6865 206e  ion models the n
+0001c8b0: 756d 6265 7220 6f66 2074 7269 616c 730d  umber of trials.
+0001c8c0: 0a20 2074 6861 7420 6d75 7374 2062 6520  .  that must be 
+0001c8d0: 7275 6e20 696e 206f 7264 6572 2074 6f20  run in order to 
+0001c8e0: 6163 6869 6576 6520 7375 6363 6573 732e  achieve success.
+0001c8f0: 2020 4974 2069 7320 7468 6572 6566 6f72    It is therefor
+0001c900: 650d 0a20 2073 7570 706f 7274 6564 206f  e..  supported o
+0001c910: 6e20 7468 6520 706f 7369 7469 7665 2069  n the positive i
+0001c920: 6e74 6567 6572 732c 2060 606b 203d 2031  ntegers, ``k = 1
+0001c930: 2c20 322c 202e 2e2e 6060 2e0d 0a0d 0a20  , 2, ...``..... 
+0001c940: 2054 6865 2070 726f 6261 6269 6c69 7479   The probability
+0001c950: 206d 6173 7320 6675 6e63 7469 6f6e 206f   mass function o
+0001c960: 6620 7468 6520 6765 6f6d 6574 7269 6320  f the geometric 
+0001c970: 6469 7374 7269 6275 7469 6f6e 2069 730d  distribution is.
+0001c980: 0a0d 0a20 202e 2e20 6d61 7468 3a3a 2066  ...  .. math:: f
+0001c990: 286b 2920 3d20 2831 202d 2070 295e 7b6b  (k) = (1 - p)^{k
+0001c9a0: 202d 2031 7d20 700d 0a0d 0a20 2077 6865   - 1} p....  whe
+0001c9b0: 7265 2060 7060 2069 7320 7468 6520 7072  re `p` is the pr
+0001c9c0: 6f62 6162 696c 6974 7920 6f66 2073 7563  obability of suc
+0001c9d0: 6365 7373 206f 6620 616e 2069 6e64 6976  cess of an indiv
+0001c9e0: 6964 7561 6c20 7472 6961 6c2e 0d0a 0d0a  idual trial.....
+0001c9f0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+0001ca00: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 7020  ----------..  p 
+0001ca10: 3a20 666c 6f61 7420 6f72 2061 7272 6179  : float or array
+0001ca20: 5f6c 696b 6520 6f66 2066 6c6f 6174 730d  _like of floats.
+0001ca30: 0a20 2020 2020 2054 6865 2070 726f 6261  .      The proba
+0001ca40: 6269 6c69 7479 206f 6620 7375 6363 6573  bility of succes
+0001ca50: 7320 6f66 2061 6e20 696e 6469 7669 6475  s of an individu
+0001ca60: 616c 2074 7269 616c 2e0d 0a20 2073 697a  al trial...  siz
+0001ca70: 6520 3a20 696e 7420 6f72 2074 7570 6c65  e : int or tuple
+0001ca80: 206f 6620 696e 7473 2c20 6f70 7469 6f6e   of ints, option
+0001ca90: 616c 0d0a 2020 2020 2020 4f75 7470 7574  al..      Output
+0001caa0: 2073 6861 7065 2e20 2049 6620 7468 6520   shape.  If the 
+0001cab0: 6769 7665 6e20 7368 6170 6520 6973 2c20  given shape is, 
+0001cac0: 652e 672e 2c20 6060 286d 2c20 6e2c 206b  e.g., ``(m, n, k
+0001cad0: 2960 602c 2074 6865 6e0d 0a20 2020 2020  )``, then..     
+0001cae0: 2060 606d 202a 206e 202a 206b 6060 2073   ``m * n * k`` s
+0001caf0: 616d 706c 6573 2061 7265 2064 7261 776e  amples are drawn
+0001cb00: 2e20 2049 6620 7369 7a65 2069 7320 6060  .  If size is ``
+0001cb10: 4e6f 6e65 6060 2028 6465 6661 756c 7429  None`` (default)
+0001cb20: 2c0d 0a20 2020 2020 2061 2073 696e 676c  ,..      a singl
+0001cb30: 6520 7661 6c75 6520 6973 2072 6574 7572  e value is retur
+0001cb40: 6e65 6420 6966 2060 6070 6060 2069 7320  ned if ``p`` is 
+0001cb50: 6120 7363 616c 6172 2e20 204f 7468 6572  a scalar.  Other
+0001cb60: 7769 7365 2c0d 0a20 2020 2020 2060 606e  wise,..      ``n
+0001cb70: 702e 6172 7261 7928 7029 2e73 697a 6560  p.array(p).size`
+0001cb80: 6020 7361 6d70 6c65 7320 6172 6520 6472  ` samples are dr
+0001cb90: 6177 6e2e 0d0a 2020 6b65 7920 3a20 5052  awn...  key : PR
+0001cba0: 4e47 4b65 792c 206f 7074 696f 6e61 6c0d  NGKey, optional.
+0001cbb0: 0a20 2020 2020 2054 6865 206b 6579 2066  .      The key f
+0001cbc0: 6f72 2074 6865 2072 616e 646f 6d20 6e75  or the random nu
+0001cbd0: 6d62 6572 2067 656e 6572 6174 6f72 2e20  mber generator. 
+0001cbe0: 4966 206e 6f74 2067 6976 656e 2c20 7468  If not given, th
+0001cbf0: 650d 0a20 2020 2020 2064 6566 6175 6c74  e..      default
+0001cc00: 2072 616e 646f 6d20 6e75 6d62 6572 2067   random number g
+0001cc10: 656e 6572 6174 6f72 2069 7320 7573 6564  enerator is used
+0001cc20: 2e0d 0a0d 0a20 2052 6574 7572 6e73 0d0a  .....  Returns..
+0001cc30: 2020 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574    -------..  out
+0001cc40: 203a 206e 6461 7272 6179 206f 7220 7363   : ndarray or sc
+0001cc50: 616c 6172 0d0a 2020 2020 2020 4472 6177  alar..      Draw
+0001cc60: 6e20 7361 6d70 6c65 7320 6672 6f6d 2074  n samples from t
+0001cc70: 6865 2070 6172 616d 6574 6572 697a 6564  he parameterized
+0001cc80: 2067 656f 6d65 7472 6963 2064 6973 7472   geometric distr
+0001cc90: 6962 7574 696f 6e2e 0d0a 0d0a 2020 4578  ibution.....  Ex
+0001cca0: 616d 706c 6573 0d0a 2020 2d2d 2d2d 2d2d  amples..  ------
+0001ccb0: 2d2d 0d0a 2020 4472 6177 2074 656e 2074  --..  Draw ten t
+0001ccc0: 686f 7573 616e 6420 7661 6c75 6573 2066  housand values f
+0001ccd0: 726f 6d20 7468 6520 6765 6f6d 6574 7269  rom the geometri
+0001cce0: 6320 6469 7374 7269 6275 7469 6f6e 2c0d  c distribution,.
+0001ccf0: 0a20 2077 6974 6820 7468 6520 7072 6f62  .  with the prob
+0001cd00: 6162 696c 6974 7920 6f66 2061 6e20 696e  ability of an in
+0001cd10: 6469 7669 6475 616c 2073 7563 6365 7373  dividual success
+0001cd20: 2065 7175 616c 2074 6f20 302e 3335 3a0d   equal to 0.35:.
+0001cd30: 0a0d 0a20 203e 3e3e 207a 203d 2062 7261  ...  >>> z = bra
+0001cd40: 696e 636f 7265 2e72 616e 646f 6d2e 6765  incore.random.ge
+0001cd50: 6f6d 6574 7269 6328 703d 302e 3335 2c20  ometric(p=0.35, 
+0001cd60: 7369 7a65 3d31 3030 3030 290d 0a0d 0a20  size=10000).... 
+0001cd70: 2048 6f77 206d 616e 7920 7472 6961 6c73   How many trials
+0001cd80: 2073 7563 6365 6564 6564 2061 6674 6572   succeeded after
+0001cd90: 2061 2073 696e 676c 6520 7275 6e3f 0d0a   a single run?..
+0001cda0: 0d0a 2020 3e3e 3e20 287a 203d 3d20 3129  ..  >>> (z == 1)
+0001cdb0: 2e73 756d 2829 202f 2031 3030 3030 2e0d  .sum() / 10000..
+0001cdc0: 0a20 2030 2e33 3438 3839 3939 3939 3939  .  0.34889999999
+0001cdd0: 3939 3939 3939 2023 7261 6e64 6f6d 0d0a  999999 #random..
+0001cde0: 2020 2222 220d 0a20 2072 6574 7572 6e20    """..  return 
+0001cdf0: 4445 4641 554c 542e 6765 6f6d 6574 7269  DEFAULT.geometri
+0001ce00: 6328 702c 2073 697a 652c 206b 6579 3d6b  c(p, size, key=k
+0001ce10: 6579 2c20 6474 7970 653d 6474 7970 6529  ey, dtype=dtype)
+0001ce20: 0d0a 0d0a 0d0a 6465 6620 6628 6466 6e75  ......def f(dfnu
+0001ce30: 6d2c 2064 6664 656e 2c20 7369 7a65 3a20  m, dfden, size: 
+0001ce40: 4f70 7469 6f6e 616c 5b53 697a 655d 203d  Optional[Size] =
+0001ce50: 204e 6f6e 652c 206b 6579 3a20 4f70 7469   None, key: Opti
+0001ce60: 6f6e 616c 5b53 6565 644f 724b 6579 5d20  onal[SeedOrKey] 
+0001ce70: 3d20 4e6f 6e65 2c20 6474 7970 653a 2044  = None, dtype: D
+0001ce80: 5479 7065 4c69 6b65 203d 204e 6f6e 6529  TypeLike = None)
+0001ce90: 3a0d 0a20 2072 2222 220d 0a20 2044 7261  :..  r"""..  Dra
+0001cea0: 7720 7361 6d70 6c65 7320 6672 6f6d 2061  w samples from a
+0001ceb0: 6e20 4620 6469 7374 7269 6275 7469 6f6e  n F distribution
+0001cec0: 2e0d 0a0d 0a20 2053 616d 706c 6573 2061  .....  Samples a
+0001ced0: 7265 2064 7261 776e 2066 726f 6d20 616e  re drawn from an
+0001cee0: 2046 2064 6973 7472 6962 7574 696f 6e20   F distribution 
+0001cef0: 7769 7468 2073 7065 6369 6669 6564 2070  with specified p
+0001cf00: 6172 616d 6574 6572 732c 0d0a 2020 6064  arameters,..  `d
+0001cf10: 666e 756d 6020 2864 6567 7265 6573 206f  fnum` (degrees o
+0001cf20: 6620 6672 6565 646f 6d20 696e 206e 756d  f freedom in num
+0001cf30: 6572 6174 6f72 2920 616e 6420 6064 6664  erator) and `dfd
+0001cf40: 656e 6020 2864 6567 7265 6573 206f 660d  en` (degrees of.
+0001cf50: 0a20 2066 7265 6564 6f6d 2069 6e20 6465  .  freedom in de
+0001cf60: 6e6f 6d69 6e61 746f 7229 2c20 7768 6572  nominator), wher
+0001cf70: 6520 626f 7468 2070 6172 616d 6574 6572  e both parameter
+0001cf80: 7320 6d75 7374 2062 6520 6772 6561 7465  s must be greate
+0001cf90: 7220 7468 616e 0d0a 2020 7a65 726f 2e0d  r than..  zero..
+0001cfa0: 0a0d 0a20 2054 6865 2072 616e 646f 6d20  ...  The random 
+0001cfb0: 7661 7269 6174 6520 6f66 2074 6865 2046  variate of the F
+0001cfc0: 2064 6973 7472 6962 7574 696f 6e20 2861   distribution (a
+0001cfd0: 6c73 6f20 6b6e 6f77 6e20 6173 2074 6865  lso known as the
+0001cfe0: 0d0a 2020 4669 7368 6572 2064 6973 7472  ..  Fisher distr
+0001cff0: 6962 7574 696f 6e29 2069 7320 6120 636f  ibution) is a co
+0001d000: 6e74 696e 756f 7573 2070 726f 6261 6269  ntinuous probabi
+0001d010: 6c69 7479 2064 6973 7472 6962 7574 696f  lity distributio
+0001d020: 6e0d 0a20 2074 6861 7420 6172 6973 6573  n..  that arises
+0001d030: 2069 6e20 414e 4f56 4120 7465 7374 732c   in ANOVA tests,
+0001d040: 2061 6e64 2069 7320 7468 6520 7261 7469   and is the rati
+0001d050: 6f20 6f66 2074 776f 2063 6869 2d73 7175  o of two chi-squ
+0001d060: 6172 650d 0a20 2076 6172 6961 7465 732e  are..  variates.
+0001d070: 0d0a 0d0a 2020 5061 7261 6d65 7465 7273  ....  Parameters
+0001d080: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  ..  ----------..
+0001d090: 2020 6466 6e75 6d20 3a20 666c 6f61 7420    dfnum : float 
+0001d0a0: 6f72 2061 7272 6179 5f6c 696b 6520 6f66  or array_like of
+0001d0b0: 2066 6c6f 6174 730d 0a20 2020 2020 2044   floats..      D
+0001d0c0: 6567 7265 6573 206f 6620 6672 6565 646f  egrees of freedo
+0001d0d0: 6d20 696e 206e 756d 6572 6174 6f72 2c20  m in numerator, 
+0001d0e0: 6d75 7374 2062 6520 3e20 302e 0d0a 2020  must be > 0...  
+0001d0f0: 6466 6465 6e20 3a20 666c 6f61 7420 6f72  dfden : float or
+0001d100: 2061 7272 6179 5f6c 696b 6520 6f66 2066   array_like of f
+0001d110: 6c6f 6174 0d0a 2020 2020 2020 4465 6772  loat..      Degr
+0001d120: 6565 7320 6f66 2066 7265 6564 6f6d 2069  ees of freedom i
+0001d130: 6e20 6465 6e6f 6d69 6e61 746f 722c 206d  n denominator, m
+0001d140: 7573 7420 6265 203e 2030 2e0d 0a20 2073  ust be > 0...  s
+0001d150: 697a 6520 3a20 696e 7420 6f72 2074 7570  ize : int or tup
+0001d160: 6c65 206f 6620 696e 7473 2c20 6f70 7469  le of ints, opti
+0001d170: 6f6e 616c 0d0a 2020 2020 2020 4f75 7470  onal..      Outp
+0001d180: 7574 2073 6861 7065 2e20 2049 6620 7468  ut shape.  If th
+0001d190: 6520 6769 7665 6e20 7368 6170 6520 6973  e given shape is
+0001d1a0: 2c20 652e 672e 2c20 6060 286d 2c20 6e2c  , e.g., ``(m, n,
+0001d1b0: 206b 2960 602c 2074 6865 6e0d 0a20 2020   k)``, then..   
+0001d1c0: 2020 2060 606d 202a 206e 202a 206b 6060     ``m * n * k``
+0001d1d0: 2073 616d 706c 6573 2061 7265 2064 7261   samples are dra
+0001d1e0: 776e 2e20 2049 6620 7369 7a65 2069 7320  wn.  If size is 
+0001d1f0: 6060 4e6f 6e65 6060 2028 6465 6661 756c  ``None`` (defaul
+0001d200: 7429 2c0d 0a20 2020 2020 2061 2073 696e  t),..      a sin
+0001d210: 676c 6520 7661 6c75 6520 6973 2072 6574  gle value is ret
+0001d220: 7572 6e65 6420 6966 2060 6064 666e 756d  urned if ``dfnum
+0001d230: 6060 2061 6e64 2060 6064 6664 656e 6060  `` and ``dfden``
+0001d240: 2061 7265 2062 6f74 6820 7363 616c 6172   are both scalar
+0001d250: 732e 0d0a 2020 2020 2020 4f74 6865 7277  s...      Otherw
+0001d260: 6973 652c 2060 606e 702e 6272 6f61 6463  ise, ``np.broadc
+0001d270: 6173 7428 6466 6e75 6d2c 2064 6664 656e  ast(dfnum, dfden
+0001d280: 292e 7369 7a65 6060 2073 616d 706c 6573  ).size`` samples
+0001d290: 2061 7265 2064 7261 776e 2e0d 0a20 206b   are drawn...  k
+0001d2a0: 6579 203a 2050 524e 474b 6579 2c20 6f70  ey : PRNGKey, op
+0001d2b0: 7469 6f6e 616c 0d0a 2020 2020 2020 5468  tional..      Th
+0001d2c0: 6520 6b65 7920 666f 7220 7468 6520 7261  e key for the ra
+0001d2d0: 6e64 6f6d 206e 756d 6265 7220 6765 6e65  ndom number gene
+0001d2e0: 7261 746f 722e 2049 6620 6e6f 7420 6769  rator. If not gi
+0001d2f0: 7665 6e2c 2074 6865 0d0a 2020 2020 2020  ven, the..      
+0001d300: 6465 6661 756c 7420 7261 6e64 6f6d 206e  default random n
+0001d310: 756d 6265 7220 6765 6e65 7261 746f 7220  umber generator 
+0001d320: 6973 2075 7365 642e 0d0a 0d0a 2020 5265  is used.....  Re
+0001d330: 7475 726e 730d 0a20 202d 2d2d 2d2d 2d2d  turns..  -------
+0001d340: 0d0a 2020 6f75 7420 3a20 6e64 6172 7261  ..  out : ndarra
+0001d350: 7920 6f72 2073 6361 6c61 720d 0a20 2020  y or scalar..   
+0001d360: 2020 2044 7261 776e 2073 616d 706c 6573     Drawn samples
+0001d370: 2066 726f 6d20 7468 6520 7061 7261 6d65   from the parame
+0001d380: 7465 7269 7a65 6420 4669 7368 6572 2064  terized Fisher d
+0001d390: 6973 7472 6962 7574 696f 6e2e 0d0a 0d0a  istribution.....
+0001d3a0: 2020 5365 6520 416c 736f 0d0a 2020 2d2d    See Also..  --
+0001d3b0: 2d2d 2d2d 2d2d 0d0a 2020 7363 6970 792e  ------..  scipy.
+0001d3c0: 7374 6174 732e 6620 3a20 7072 6f62 6162  stats.f : probab
+0001d3d0: 696c 6974 7920 6465 6e73 6974 7920 6675  ility density fu
+0001d3e0: 6e63 7469 6f6e 2c20 6469 7374 7269 6275  nction, distribu
+0001d3f0: 7469 6f6e 206f 720d 0a20 2020 2020 2063  tion or..      c
+0001d400: 756d 756c 6174 6976 6520 6465 6e73 6974  umulative densit
+0001d410: 7920 6675 6e63 7469 6f6e 2c20 6574 632e  y function, etc.
+0001d420: 0d0a 0d0a 2020 4e6f 7465 730d 0a20 202d  ....  Notes..  -
+0001d430: 2d2d 2d2d 0d0a 2020 5468 6520 4620 7374  ----..  The F st
+0001d440: 6174 6973 7469 6320 6973 2075 7365 6420  atistic is used 
+0001d450: 746f 2063 6f6d 7061 7265 2069 6e2d 6772  to compare in-gr
+0001d460: 6f75 7020 7661 7269 616e 6365 7320 746f  oup variances to
+0001d470: 2062 6574 7765 656e 2d67 726f 7570 0d0a   between-group..
+0001d480: 2020 7661 7269 616e 6365 732e 2043 616c    variances. Cal
+0001d490: 6375 6c61 7469 6e67 2074 6865 2064 6973  culating the dis
+0001d4a0: 7472 6962 7574 696f 6e20 6465 7065 6e64  tribution depend
+0001d4b0: 7320 6f6e 2074 6865 2073 616d 706c 696e  s on the samplin
+0001d4c0: 672c 2061 6e64 0d0a 2020 736f 2069 7420  g, and..  so it 
+0001d4d0: 6973 2061 2066 756e 6374 696f 6e20 6f66  is a function of
+0001d4e0: 2074 6865 2072 6573 7065 6374 6976 6520   the respective 
+0001d4f0: 6465 6772 6565 7320 6f66 2066 7265 6564  degrees of freed
+0001d500: 6f6d 2069 6e20 7468 650d 0a20 2070 726f  om in the..  pro
+0001d510: 626c 656d 2e20 2054 6865 2076 6172 6961  blem.  The varia
+0001d520: 626c 6520 6064 666e 756d 6020 6973 2074  ble `dfnum` is t
+0001d530: 6865 206e 756d 6265 7220 6f66 2073 616d  he number of sam
+0001d540: 706c 6573 206d 696e 7573 206f 6e65 2c20  ples minus one, 
+0001d550: 7468 650d 0a20 2062 6574 7765 656e 2d67  the..  between-g
+0001d560: 726f 7570 7320 6465 6772 6565 7320 6f66  roups degrees of
+0001d570: 2066 7265 6564 6f6d 2c20 7768 696c 6520   freedom, while 
+0001d580: 6064 6664 656e 6020 6973 2074 6865 2077  `dfden` is the w
+0001d590: 6974 6869 6e2d 6772 6f75 7073 0d0a 2020  ithin-groups..  
+0001d5a0: 6465 6772 6565 7320 6f66 2066 7265 6564  degrees of freed
+0001d5b0: 6f6d 2c20 7468 6520 7375 6d20 6f66 2074  om, the sum of t
+0001d5c0: 6865 206e 756d 6265 7220 6f66 2073 616d  he number of sam
+0001d5d0: 706c 6573 2069 6e20 6561 6368 2067 726f  ples in each gro
+0001d5e0: 7570 0d0a 2020 6d69 6e75 7320 7468 6520  up..  minus the 
+0001d5f0: 6e75 6d62 6572 206f 6620 6772 6f75 7073  number of groups
+0001d600: 2e0d 0a0d 0a20 2052 6566 6572 656e 6365  .....  Reference
+0001d610: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
+0001d620: 0a20 202e 2e20 5b31 5d20 476c 616e 747a  .  .. [1] Glantz
+0001d630: 2c20 5374 616e 746f 6e20 412e 2022 5072  , Stanton A. "Pr
+0001d640: 696d 6572 206f 6620 4269 6f73 7461 7469  imer of Biostati
+0001d650: 7374 6963 732e 222c 204d 6347 7261 772d  stics.", McGraw-
+0001d660: 4869 6c6c 2c0d 0a20 2020 2020 2020 2020  Hill,..         
+0001d670: 4669 6674 6820 4564 6974 696f 6e2c 2032  Fifth Edition, 2
+0001d680: 3030 322e 0d0a 2020 2e2e 205b 325d 2057  002...  .. [2] W
+0001d690: 696b 6970 6564 6961 2c20 2246 2d64 6973  ikipedia, "F-dis
+0001d6a0: 7472 6962 7574 696f 6e22 2c0d 0a20 2020  tribution",..   
+0001d6b0: 2020 2020 2020 6874 7470 733a 2f2f 656e        https://en
+0001d6c0: 2e77 696b 6970 6564 6961 2e6f 7267 2f77  .wikipedia.org/w
+0001d6d0: 696b 692f 462d 6469 7374 7269 6275 7469  iki/F-distributi
+0001d6e0: 6f6e 0d0a 0d0a 2020 4578 616d 706c 6573  on....  Examples
+0001d6f0: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ..  --------..  
+0001d700: 416e 2065 7861 6d70 6c65 2066 726f 6d20  An example from 
+0001d710: 476c 616e 747a 5b31 5d2c 2070 7020 3437  Glantz[1], pp 47
+0001d720: 2d34 303a 0d0a 0d0a 2020 5477 6f20 6772  -40:....  Two gr
+0001d730: 6f75 7073 2c20 6368 696c 6472 656e 206f  oups, children o
+0001d740: 6620 6469 6162 6574 6963 7320 2832 3520  f diabetics (25 
+0001d750: 7065 6f70 6c65 2920 616e 6420 6368 696c  people) and chil
+0001d760: 6472 656e 2066 726f 6d20 7065 6f70 6c65  dren from people
+0001d770: 0d0a 2020 7769 7468 6f75 7420 6469 6162  ..  without diab
+0001d780: 6574 6573 2028 3235 2063 6f6e 7472 6f6c  etes (25 control
+0001d790: 7329 2e20 4661 7374 696e 6720 626c 6f6f  s). Fasting bloo
+0001d7a0: 6420 676c 7563 6f73 6520 7761 7320 6d65  d glucose was me
+0001d7b0: 6173 7572 6564 2c0d 0a20 2063 6173 6520  asured,..  case 
+0001d7c0: 6772 6f75 7020 6861 6420 6120 6d65 616e  group had a mean
+0001d7d0: 2076 616c 7565 206f 6620 3836 2e31 2c20   value of 86.1, 
+0001d7e0: 636f 6e74 726f 6c73 2068 6164 2061 206d  controls had a m
+0001d7f0: 6561 6e20 7661 6c75 6520 6f66 0d0a 2020  ean value of..  
+0001d800: 3832 2e32 2e20 5374 616e 6461 7264 2064  82.2. Standard d
+0001d810: 6576 6961 7469 6f6e 7320 7765 7265 2032  eviations were 2
+0001d820: 2e30 3920 616e 6420 322e 3439 2072 6573  .09 and 2.49 res
+0001d830: 7065 6374 6976 656c 792e 2041 7265 2074  pectively. Are t
+0001d840: 6865 7365 0d0a 2020 6461 7461 2063 6f6e  hese..  data con
+0001d850: 7369 7374 656e 7420 7769 7468 2074 6865  sistent with the
+0001d860: 206e 756c 6c20 6879 706f 7468 6573 6973   null hypothesis
+0001d870: 2074 6861 7420 7468 6520 7061 7265 6e74   that the parent
+0001d880: 7320 6469 6162 6574 6963 0d0a 2020 7374  s diabetic..  st
+0001d890: 6174 7573 2064 6f65 7320 6e6f 7420 6166  atus does not af
+0001d8a0: 6665 6374 2074 6865 6972 2063 6869 6c64  fect their child
+0001d8b0: 7265 6e27 7320 626c 6f6f 6420 676c 7563  ren's blood gluc
+0001d8c0: 6f73 6520 6c65 7665 6c73 3f0d 0a20 2043  ose levels?..  C
+0001d8d0: 616c 6375 6c61 7469 6e67 2074 6865 2046  alculating the F
+0001d8e0: 2073 7461 7469 7374 6963 2066 726f 6d20   statistic from 
+0001d8f0: 7468 6520 6461 7461 2067 6976 6573 2061  the data gives a
+0001d900: 2076 616c 7565 206f 6620 3336 2e30 312e   value of 36.01.
+0001d910: 0d0a 0d0a 2020 4472 6177 2073 616d 706c  ....  Draw sampl
+0001d920: 6573 2066 726f 6d20 7468 6520 6469 7374  es from the dist
+0001d930: 7269 6275 7469 6f6e 3a0d 0a0d 0a20 203e  ribution:....  >
+0001d940: 3e3e 2064 666e 756d 203d 2031 2e20 2320  >> dfnum = 1. # 
+0001d950: 6265 7477 6565 6e20 6772 6f75 7020 6465  between group de
+0001d960: 6772 6565 7320 6f66 2066 7265 6564 6f6d  grees of freedom
+0001d970: 0d0a 2020 3e3e 3e20 6466 6465 6e20 3d20  ..  >>> dfden = 
+0001d980: 3438 2e20 2320 7769 7468 696e 2067 726f  48. # within gro
+0001d990: 7570 7320 6465 6772 6565 7320 6f66 2066  ups degrees of f
+0001d9a0: 7265 6564 6f6d 0d0a 2020 3e3e 3e20 7320  reedom..  >>> s 
+0001d9b0: 3d20 6272 6169 6e63 6f72 652e 7261 6e64  = braincore.rand
+0001d9c0: 6f6d 2e66 2864 666e 756d 2c20 6466 6465  om.f(dfnum, dfde
+0001d9d0: 6e2c 2031 3030 3029 0d0a 0d0a 2020 5468  n, 1000)....  Th
+0001d9e0: 6520 6c6f 7765 7220 626f 756e 6420 666f  e lower bound fo
+0001d9f0: 7220 7468 6520 746f 7020 3125 206f 6620  r the top 1% of 
+0001da00: 7468 6520 7361 6d70 6c65 7320 6973 203a  the samples is :
+0001da10: 0d0a 0d0a 2020 3e3e 3e20 6e70 2e73 6f72  ....  >>> np.sor
+0001da20: 7428 7329 5b2d 3130 5d0d 0a20 2037 2e36  t(s)[-10]..  7.6
+0001da30: 3139 3838 3132 3039 3835 2023 2072 616e  1988120985 # ran
+0001da40: 646f 6d0d 0a0d 0a20 2053 6f20 7468 6572  dom....  So ther
+0001da50: 6520 6973 2061 626f 7574 2061 2031 2520  e is about a 1% 
+0001da60: 6368 616e 6365 2074 6861 7420 7468 6520  chance that the 
+0001da70: 4620 7374 6174 6973 7469 6320 7769 6c6c  F statistic will
+0001da80: 2065 7863 6565 6420 372e 3632 2c0d 0a20   exceed 7.62,.. 
+0001da90: 2074 6865 206d 6561 7375 7265 6420 7661   the measured va
+0001daa0: 6c75 6520 6973 2033 362c 2073 6f20 7468  lue is 36, so th
+0001dab0: 6520 6e75 6c6c 2068 7970 6f74 6865 7369  e null hypothesi
+0001dac0: 7320 6973 2072 656a 6563 7465 6420 6174  s is rejected at
+0001dad0: 2074 6865 2031 250d 0a20 206c 6576 656c   the 1%..  level
+0001dae0: 2e0d 0a20 2022 2222 0d0a 2020 7265 7475  ...  """..  retu
+0001daf0: 726e 2044 4546 4155 4c54 2e66 2864 666e  rn DEFAULT.f(dfn
+0001db00: 756d 2c20 6466 6465 6e2c 2073 697a 652c  um, dfden, size,
+0001db10: 206b 6579 3d6b 6579 2c20 6474 7970 653d   key=key, dtype=
+0001db20: 6474 7970 6529 0d0a 0d0a 0d0a 6465 6620  dtype)......def 
+0001db30: 6879 7065 7267 656f 6d65 7472 6963 286e  hypergeometric(n
+0001db40: 676f 6f64 2c20 6e62 6164 2c20 6e73 616d  good, nbad, nsam
+0001db50: 706c 652c 2073 697a 653a 204f 7074 696f  ple, size: Optio
+0001db60: 6e61 6c5b 5369 7a65 5d20 3d20 4e6f 6e65  nal[Size] = None
+0001db70: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0001db80: 2020 2020 2020 6b65 793a 204f 7074 696f        key: Optio
+0001db90: 6e61 6c5b 5365 6564 4f72 4b65 795d 203d  nal[SeedOrKey] =
+0001dba0: 204e 6f6e 652c 2064 7479 7065 3a20 4454   None, dtype: DT
+0001dbb0: 7970 654c 696b 6520 3d20 4e6f 6e65 293a  ypeLike = None):
+0001dbc0: 0d0a 2020 7222 2222 0d0a 2020 4472 6177  ..  r"""..  Draw
+0001dbd0: 2073 616d 706c 6573 2066 726f 6d20 6120   samples from a 
+0001dbe0: 4879 7065 7267 656f 6d65 7472 6963 2064  Hypergeometric d
+0001dbf0: 6973 7472 6962 7574 696f 6e2e 0d0a 0d0a  istribution.....
+0001dc00: 2020 5361 6d70 6c65 7320 6172 6520 6472    Samples are dr
+0001dc10: 6177 6e20 6672 6f6d 2061 2068 7970 6572  awn from a hyper
+0001dc20: 6765 6f6d 6574 7269 6320 6469 7374 7269  geometric distri
+0001dc30: 6275 7469 6f6e 2077 6974 6820 7370 6563  bution with spec
+0001dc40: 6966 6965 640d 0a20 2070 6172 616d 6574  ified..  paramet
+0001dc50: 6572 732c 2060 6e67 6f6f 6460 2028 7761  ers, `ngood` (wa
+0001dc60: 7973 2074 6f20 6d61 6b65 2061 2067 6f6f  ys to make a goo
+0001dc70: 6420 7365 6c65 6374 696f 6e29 2c20 606e  d selection), `n
+0001dc80: 6261 6460 2028 7761 7973 2074 6f20 6d61  bad` (ways to ma
+0001dc90: 6b65 0d0a 2020 6120 6261 6420 7365 6c65  ke..  a bad sele
+0001dca0: 6374 696f 6e29 2c20 616e 6420 606e 7361  ction), and `nsa
+0001dcb0: 6d70 6c65 6020 286e 756d 6265 7220 6f66  mple` (number of
+0001dcc0: 2069 7465 6d73 2073 616d 706c 6564 2c20   items sampled, 
+0001dcd0: 7768 6963 6820 6973 206c 6573 730d 0a20  which is less.. 
+0001dce0: 2074 6861 6e20 6f72 2065 7175 616c 2074   than or equal t
+0001dcf0: 6f20 7468 6520 7375 6d20 6060 6e67 6f6f  o the sum ``ngoo
+0001dd00: 6420 2b20 6e62 6164 6060 292e 0d0a 0d0a  d + nbad``).....
+0001dd10: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+0001dd20: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 6e67  ----------..  ng
+0001dd30: 6f6f 6420 3a20 696e 7420 6f72 2061 7272  ood : int or arr
+0001dd40: 6179 5f6c 696b 6520 6f66 2069 6e74 730d  ay_like of ints.
+0001dd50: 0a20 2020 2020 204e 756d 6265 7220 6f66  .      Number of
+0001dd60: 2077 6179 7320 746f 206d 616b 6520 6120   ways to make a 
+0001dd70: 676f 6f64 2073 656c 6563 7469 6f6e 2e20  good selection. 
+0001dd80: 204d 7573 7420 6265 206e 6f6e 6e65 6761   Must be nonnega
+0001dd90: 7469 7665 2e0d 0a20 206e 6261 6420 3a20  tive...  nbad : 
+0001dda0: 696e 7420 6f72 2061 7272 6179 5f6c 696b  int or array_lik
+0001ddb0: 6520 6f66 2069 6e74 730d 0a20 2020 2020  e of ints..     
+0001ddc0: 204e 756d 6265 7220 6f66 2077 6179 7320   Number of ways 
+0001ddd0: 746f 206d 616b 6520 6120 6261 6420 7365  to make a bad se
+0001dde0: 6c65 6374 696f 6e2e 2020 4d75 7374 2062  lection.  Must b
+0001ddf0: 6520 6e6f 6e6e 6567 6174 6976 652e 0d0a  e nonnegative...
+0001de00: 2020 6e73 616d 706c 6520 3a20 696e 7420    nsample : int 
+0001de10: 6f72 2061 7272 6179 5f6c 696b 6520 6f66  or array_like of
+0001de20: 2069 6e74 730d 0a20 2020 2020 204e 756d   ints..      Num
+0001de30: 6265 7220 6f66 2069 7465 6d73 2073 616d  ber of items sam
+0001de40: 706c 6564 2e20 204d 7573 7420 6265 2061  pled.  Must be a
+0001de50: 7420 6c65 6173 7420 3120 616e 6420 6174  t least 1 and at
+0001de60: 206d 6f73 740d 0a20 2020 2020 2060 606e   most..      ``n
+0001de70: 676f 6f64 202b 206e 6261 6460 602e 0d0a  good + nbad``...
+0001de80: 2020 7369 7a65 203a 2069 6e74 206f 7220    size : int or 
+0001de90: 7475 706c 6520 6f66 2069 6e74 732c 206f  tuple of ints, o
+0001dea0: 7074 696f 6e61 6c0d 0a20 2020 2020 204f  ptional..      O
+0001deb0: 7574 7075 7420 7368 6170 652e 2020 4966  utput shape.  If
+0001dec0: 2074 6865 2067 6976 656e 2073 6861 7065   the given shape
+0001ded0: 2069 732c 2065 2e67 2e2c 2060 6028 6d2c   is, e.g., ``(m,
+0001dee0: 206e 2c20 6b29 6060 2c20 7468 656e 0d0a   n, k)``, then..
+0001def0: 2020 2020 2020 6060 6d20 2a20 6e20 2a20        ``m * n * 
+0001df00: 6b60 6020 7361 6d70 6c65 7320 6172 6520  k`` samples are 
+0001df10: 6472 6177 6e2e 2020 4966 2073 697a 6520  drawn.  If size 
+0001df20: 6973 2060 604e 6f6e 6560 6020 2864 6566  is ``None`` (def
+0001df30: 6175 6c74 292c 0d0a 2020 2020 2020 6120  ault),..      a 
+0001df40: 7369 6e67 6c65 2076 616c 7565 2069 7320  single value is 
+0001df50: 7265 7475 726e 6564 2069 6620 606e 676f  returned if `ngo
+0001df60: 6f64 602c 2060 6e62 6164 602c 2061 6e64  od`, `nbad`, and
+0001df70: 2060 6e73 616d 706c 6560 0d0a 2020 2020   `nsample`..    
+0001df80: 2020 6172 6520 616c 6c20 7363 616c 6172    are all scalar
+0001df90: 732e 2020 4f74 6865 7277 6973 652c 2060  s.  Otherwise, `
+0001dfa0: 606e 702e 6272 6f61 6463 6173 7428 6e67  `np.broadcast(ng
+0001dfb0: 6f6f 642c 206e 6261 642c 206e 7361 6d70  ood, nbad, nsamp
+0001dfc0: 6c65 292e 7369 7a65 6060 0d0a 2020 2020  le).size``..    
+0001dfd0: 2020 7361 6d70 6c65 7320 6172 6520 6472    samples are dr
+0001dfe0: 6177 6e2e 0d0a 2020 6b65 7920 3a20 5052  awn...  key : PR
+0001dff0: 4e47 4b65 792c 206f 7074 696f 6e61 6c0d  NGKey, optional.
+0001e000: 0a20 2020 2020 2054 6865 206b 6579 2066  .      The key f
+0001e010: 6f72 2074 6865 2072 616e 646f 6d20 6e75  or the random nu
+0001e020: 6d62 6572 2067 656e 6572 6174 6f72 2e20  mber generator. 
+0001e030: 4966 206e 6f74 2067 6976 656e 2c20 7468  If not given, th
+0001e040: 650d 0a20 2020 2020 2064 6566 6175 6c74  e..      default
+0001e050: 2072 616e 646f 6d20 6e75 6d62 6572 2067   random number g
+0001e060: 656e 6572 6174 6f72 2069 7320 7573 6564  enerator is used
+0001e070: 2e0d 0a0d 0a20 2052 6574 7572 6e73 0d0a  .....  Returns..
+0001e080: 2020 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574    -------..  out
+0001e090: 203a 206e 6461 7272 6179 206f 7220 7363   : ndarray or sc
+0001e0a0: 616c 6172 0d0a 2020 2020 2020 4472 6177  alar..      Draw
+0001e0b0: 6e20 7361 6d70 6c65 7320 6672 6f6d 2074  n samples from t
+0001e0c0: 6865 2070 6172 616d 6574 6572 697a 6564  he parameterized
+0001e0d0: 2068 7970 6572 6765 6f6d 6574 7269 6320   hypergeometric 
+0001e0e0: 6469 7374 7269 6275 7469 6f6e 2e20 4561  distribution. Ea
+0001e0f0: 6368 0d0a 2020 2020 2020 7361 6d70 6c65  ch..      sample
+0001e100: 2069 7320 7468 6520 6e75 6d62 6572 206f   is the number o
+0001e110: 6620 676f 6f64 2069 7465 6d73 2077 6974  f good items wit
+0001e120: 6869 6e20 6120 7261 6e64 6f6d 6c79 2073  hin a randomly s
+0001e130: 656c 6563 7465 6420 7375 6273 6574 206f  elected subset o
+0001e140: 660d 0a20 2020 2020 2073 697a 6520 606e  f..      size `n
+0001e150: 7361 6d70 6c65 6020 7461 6b65 6e20 6672  sample` taken fr
+0001e160: 6f6d 2061 2073 6574 206f 6620 606e 676f  om a set of `ngo
+0001e170: 6f64 6020 676f 6f64 2069 7465 6d73 2061  od` good items a
+0001e180: 6e64 2060 6e62 6164 6020 6261 6420 6974  nd `nbad` bad it
+0001e190: 656d 732e 0d0a 0d0a 2020 5365 6520 416c  ems.....  See Al
+0001e1a0: 736f 0d0a 2020 2d2d 2d2d 2d2d 2d2d 0d0a  so..  --------..
+0001e1b0: 2020 7363 6970 792e 7374 6174 732e 6879    scipy.stats.hy
+0001e1c0: 7065 7267 656f 6d20 3a20 7072 6f62 6162  pergeom : probab
+0001e1d0: 696c 6974 7920 6465 6e73 6974 7920 6675  ility density fu
+0001e1e0: 6e63 7469 6f6e 2c20 6469 7374 7269 6275  nction, distribu
+0001e1f0: 7469 6f6e 206f 720d 0a20 2020 2020 2063  tion or..      c
+0001e200: 756d 756c 6174 6976 6520 6465 6e73 6974  umulative densit
+0001e210: 7920 6675 6e63 7469 6f6e 2c20 6574 632e  y function, etc.
+0001e220: 0d0a 0d0a 2020 4e6f 7465 730d 0a20 202d  ....  Notes..  -
+0001e230: 2d2d 2d2d 0d0a 2020 5468 6520 7072 6f62  ----..  The prob
+0001e240: 6162 696c 6974 7920 6465 6e73 6974 7920  ability density 
+0001e250: 666f 7220 7468 6520 4879 7065 7267 656f  for the Hypergeo
+0001e260: 6d65 7472 6963 2064 6973 7472 6962 7574  metric distribut
+0001e270: 696f 6e20 6973 0d0a 0d0a 2020 2e2e 206d  ion is....  .. m
+0001e280: 6174 683a 3a20 5028 7829 203d 205c 6672  ath:: P(x) = \fr
+0001e290: 6163 7b5c 6269 6e6f 6d7b 677d 7b78 7d5c  ac{\binom{g}{x}\
+0001e2a0: 6269 6e6f 6d7b 627d 7b6e 2d78 7d7d 7b5c  binom{b}{n-x}}{\
+0001e2b0: 6269 6e6f 6d7b 672b 627d 7b6e 7d7d 2c0d  binom{g+b}{n}},.
+0001e2c0: 0a0d 0a20 2077 6865 7265 203a 6d61 7468  ...  where :math
+0001e2d0: 3a60 3020 5c6c 6520 7820 5c6c 6520 6e60  :`0 \le x \le n`
+0001e2e0: 2061 6e64 203a 6d61 7468 3a60 6e2d 6220   and :math:`n-b 
+0001e2f0: 5c6c 6520 7820 5c6c 6520 6760 0d0a 0d0a  \le x \le g`....
+0001e300: 2020 666f 7220 5028 7829 2074 6865 2070    for P(x) the p
+0001e310: 726f 6261 6269 6c69 7479 206f 6620 6060  robability of ``
+0001e320: 7860 6020 676f 6f64 2072 6573 756c 7473  x`` good results
+0001e330: 2069 6e20 7468 6520 6472 6177 6e20 7361   in the drawn sa
+0001e340: 6d70 6c65 2c0d 0a20 2067 203d 2060 6e67  mple,..  g = `ng
+0001e350: 6f6f 6460 2c20 6220 3d20 606e 6261 6460  ood`, b = `nbad`
+0001e360: 2c20 616e 6420 6e20 3d20 606e 7361 6d70  , and n = `nsamp
+0001e370: 6c65 602e 0d0a 0d0a 2020 436f 6e73 6964  le`.....  Consid
+0001e380: 6572 2061 6e20 7572 6e20 7769 7468 2062  er an urn with b
+0001e390: 6c61 636b 2061 6e64 2077 6869 7465 206d  lack and white m
+0001e3a0: 6172 626c 6573 2069 6e20 6974 2c20 606e  arbles in it, `n
+0001e3b0: 676f 6f64 6020 6f66 2074 6865 6d0d 0a20  good` of them.. 
+0001e3c0: 2061 7265 2062 6c61 636b 2061 6e64 2060   are black and `
+0001e3d0: 6e62 6164 6020 6172 6520 7768 6974 652e  nbad` are white.
+0001e3e0: 2049 6620 796f 7520 6472 6177 2060 6e73   If you draw `ns
+0001e3f0: 616d 706c 6560 2062 616c 6c73 2077 6974  ample` balls wit
+0001e400: 686f 7574 0d0a 2020 7265 706c 6163 656d  hout..  replacem
+0001e410: 656e 742c 2074 6865 6e20 7468 6520 6879  ent, then the hy
+0001e420: 7065 7267 656f 6d65 7472 6963 2064 6973  pergeometric dis
+0001e430: 7472 6962 7574 696f 6e20 6465 7363 7269  tribution descri
+0001e440: 6265 7320 7468 650d 0a20 2064 6973 7472  bes the..  distr
+0001e450: 6962 7574 696f 6e20 6f66 2062 6c61 636b  ibution of black
+0001e460: 2062 616c 6c73 2069 6e20 7468 6520 6472   balls in the dr
+0001e470: 6177 6e20 7361 6d70 6c65 2e0d 0a0d 0a20  awn sample..... 
+0001e480: 204e 6f74 6520 7468 6174 2074 6869 7320   Note that this 
+0001e490: 6469 7374 7269 6275 7469 6f6e 2069 7320  distribution is 
+0001e4a0: 7665 7279 2073 696d 696c 6172 2074 6f20  very similar to 
+0001e4b0: 7468 6520 6269 6e6f 6d69 616c 0d0a 2020  the binomial..  
+0001e4c0: 6469 7374 7269 6275 7469 6f6e 2c20 6578  distribution, ex
+0001e4d0: 6365 7074 2074 6861 7420 696e 2074 6869  cept that in thi
+0001e4e0: 7320 6361 7365 2c20 7361 6d70 6c65 7320  s case, samples 
+0001e4f0: 6172 6520 6472 6177 6e20 7769 7468 6f75  are drawn withou
+0001e500: 740d 0a20 2072 6570 6c61 6365 6d65 6e74  t..  replacement
+0001e510: 2c20 7768 6572 6561 7320 696e 2074 6865  , whereas in the
+0001e520: 2042 696e 6f6d 6961 6c20 6361 7365 2073   Binomial case s
+0001e530: 616d 706c 6573 2061 7265 2064 7261 776e  amples are drawn
+0001e540: 2077 6974 680d 0a20 2072 6570 6c61 6365   with..  replace
+0001e550: 6d65 6e74 2028 6f72 2074 6865 2073 616d  ment (or the sam
+0001e560: 706c 6520 7370 6163 6520 6973 2069 6e66  ple space is inf
+0001e570: 696e 6974 6529 2e20 4173 2074 6865 2073  inite). As the s
+0001e580: 616d 706c 6520 7370 6163 650d 0a20 2062  ample space..  b
+0001e590: 6563 6f6d 6573 206c 6172 6765 2c20 7468  ecomes large, th
+0001e5a0: 6973 2064 6973 7472 6962 7574 696f 6e20  is distribution 
+0001e5b0: 6170 7072 6f61 6368 6573 2074 6865 2062  approaches the b
+0001e5c0: 696e 6f6d 6961 6c2e 0d0a 0d0a 2020 5265  inomial.....  Re
+0001e5d0: 6665 7265 6e63 6573 0d0a 2020 2d2d 2d2d  ferences..  ----
+0001e5e0: 2d2d 2d2d 2d2d 0d0a 2020 2e2e 205b 315d  ------..  .. [1]
+0001e5f0: 204c 656e 746e 6572 2c20 4d61 7276 696e   Lentner, Marvin
+0001e600: 2c20 2245 6c65 6d65 6e74 6172 7920 4170  , "Elementary Ap
+0001e610: 706c 6965 6420 5374 6174 6973 7469 6373  plied Statistics
+0001e620: 222c 2042 6f67 6465 6e0d 0a20 2020 2020  ", Bogden..     
+0001e630: 2020 2020 616e 6420 5175 6967 6c65 792c      and Quigley,
+0001e640: 2031 3937 322e 0d0a 2020 2e2e 205b 325d   1972...  .. [2]
+0001e650: 2057 6569 7373 7465 696e 2c20 4572 6963   Weisstein, Eric
+0001e660: 2057 2e20 2248 7970 6572 6765 6f6d 6574   W. "Hypergeomet
+0001e670: 7269 6320 4469 7374 7269 6275 7469 6f6e  ric Distribution
+0001e680: 2e22 2046 726f 6d0d 0a20 2020 2020 2020  ." From..       
+0001e690: 2020 4d61 7468 576f 726c 642d 2d41 2057    MathWorld--A W
+0001e6a0: 6f6c 6672 616d 2057 6562 2052 6573 6f75  olfram Web Resou
+0001e6b0: 7263 652e 0d0a 2020 2020 2020 2020 2068  rce...         h
+0001e6c0: 7474 703a 2f2f 6d61 7468 776f 726c 642e  ttp://mathworld.
+0001e6d0: 776f 6c66 7261 6d2e 636f 6d2f 4879 7065  wolfram.com/Hype
+0001e6e0: 7267 656f 6d65 7472 6963 4469 7374 7269  rgeometricDistri
+0001e6f0: 6275 7469 6f6e 2e68 746d 6c0d 0a20 202e  bution.html..  .
+0001e700: 2e20 5b33 5d20 5769 6b69 7065 6469 612c  . [3] Wikipedia,
+0001e710: 2022 4879 7065 7267 656f 6d65 7472 6963   "Hypergeometric
+0001e720: 2064 6973 7472 6962 7574 696f 6e22 2c0d   distribution",.
+0001e730: 0a20 2020 2020 2020 2020 6874 7470 733a  .         https:
+0001e740: 2f2f 656e 2e77 696b 6970 6564 6961 2e6f  //en.wikipedia.o
+0001e750: 7267 2f77 696b 692f 4879 7065 7267 656f  rg/wiki/Hypergeo
+0001e760: 6d65 7472 6963 5f64 6973 7472 6962 7574  metric_distribut
+0001e770: 696f 6e0d 0a0d 0a20 2045 7861 6d70 6c65  ion....  Example
+0001e780: 730d 0a20 202d 2d2d 2d2d 2d2d 2d0d 0a20  s..  --------.. 
+0001e790: 2044 7261 7720 7361 6d70 6c65 7320 6672   Draw samples fr
+0001e7a0: 6f6d 2074 6865 2064 6973 7472 6962 7574  om the distribut
+0001e7b0: 696f 6e3a 0d0a 0d0a 2020 3e3e 3e20 6e67  ion:....  >>> ng
+0001e7c0: 6f6f 642c 206e 6261 642c 206e 7361 6d70  ood, nbad, nsamp
+0001e7d0: 203d 2031 3030 2c20 322c 2031 300d 0a20   = 100, 2, 10.. 
+0001e7e0: 2023 206e 756d 6265 7220 6f66 2067 6f6f   # number of goo
+0001e7f0: 642c 206e 756d 6265 7220 6f66 2062 6164  d, number of bad
+0001e800: 2c20 616e 6420 6e75 6d62 6572 206f 6620  , and number of 
+0001e810: 7361 6d70 6c65 730d 0a20 203e 3e3e 2073  samples..  >>> s
+0001e820: 203d 2062 7261 696e 636f 7265 2e72 616e   = braincore.ran
+0001e830: 646f 6d2e 6879 7065 7267 656f 6d65 7472  dom.hypergeometr
+0001e840: 6963 286e 676f 6f64 2c20 6e62 6164 2c20  ic(ngood, nbad, 
+0001e850: 6e73 616d 702c 2031 3030 3029 0d0a 2020  nsamp, 1000)..  
+0001e860: 3e3e 3e20 6672 6f6d 206d 6174 706c 6f74  >>> from matplot
+0001e870: 6c69 622e 7079 706c 6f74 2069 6d70 6f72  lib.pyplot impor
+0001e880: 7420 6869 7374 2020 2320 6e6f 7161 0d0a  t hist  # noqa..
+0001e890: 2020 3e3e 3e20 6869 7374 2873 290d 0a20    >>> hist(s).. 
+0001e8a0: 2023 2020 206e 6f74 6520 7468 6174 2069   #   note that i
+0001e8b0: 7420 6973 2076 6572 7920 756e 6c69 6b65  t is very unlike
+0001e8c0: 6c79 2074 6f20 6772 6162 2062 6f74 6820  ly to grab both 
+0001e8d0: 6261 6420 6974 656d 730d 0a0d 0a20 2053  bad items....  S
+0001e8e0: 7570 706f 7365 2079 6f75 2068 6176 6520  uppose you have 
+0001e8f0: 616e 2075 726e 2077 6974 6820 3135 2077  an urn with 15 w
+0001e900: 6869 7465 2061 6e64 2031 3520 626c 6163  hite and 15 blac
+0001e910: 6b20 6d61 7262 6c65 732e 0d0a 2020 4966  k marbles...  If
+0001e920: 2079 6f75 2070 756c 6c20 3135 206d 6172   you pull 15 mar
+0001e930: 626c 6573 2061 7420 7261 6e64 6f6d 2c20  bles at random, 
+0001e940: 686f 7720 6c69 6b65 6c79 2069 7320 6974  how likely is it
+0001e950: 2074 6861 740d 0a20 2031 3220 6f72 206d   that..  12 or m
+0001e960: 6f72 6520 6f66 2074 6865 6d20 6172 6520  ore of them are 
+0001e970: 6f6e 6520 636f 6c6f 723f 0d0a 0d0a 2020  one color?....  
+0001e980: 3e3e 3e20 7320 3d20 6272 6169 6e63 6f72  >>> s = braincor
+0001e990: 652e 7261 6e64 6f6d 2e68 7970 6572 6765  e.random.hyperge
+0001e9a0: 6f6d 6574 7269 6328 3135 2c20 3135 2c20  ometric(15, 15, 
+0001e9b0: 3135 2c20 3130 3030 3030 290d 0a20 203e  15, 100000)..  >
+0001e9c0: 3e3e 2073 756d 2873 3e3d 3132 292f 3130  >> sum(s>=12)/10
+0001e9d0: 3030 3030 2e20 2b20 7375 6d28 733c 3d33  0000. + sum(s<=3
+0001e9e0: 292f 3130 3030 3030 2e0d 0a20 2023 2020  )/100000...  #  
+0001e9f0: 2061 6e73 7765 7220 3d20 302e 3030 3320   answer = 0.003 
+0001ea00: 2e2e 2e20 7072 6574 7479 2075 6e6c 696b  ... pretty unlik
+0001ea10: 656c 7921 0d0a 2020 2222 220d 0a20 2072  ely!..  """..  r
+0001ea20: 6574 7572 6e20 4445 4641 554c 542e 6879  eturn DEFAULT.hy
+0001ea30: 7065 7267 656f 6d65 7472 6963 286e 676f  pergeometric(ngo
+0001ea40: 6f64 2c20 6e62 6164 2c20 6e73 616d 706c  od, nbad, nsampl
+0001ea50: 652c 2073 697a 652c 206b 6579 3d6b 6579  e, size, key=key
+0001ea60: 2c20 6474 7970 653d 6474 7970 6529 0d0a  , dtype=dtype)..
+0001ea70: 0d0a 0d0a 6465 6620 6c6f 6773 6572 6965  ....def logserie
+0001ea80: 7328 702c 2073 697a 653a 204f 7074 696f  s(p, size: Optio
+0001ea90: 6e61 6c5b 5369 7a65 5d20 3d20 4e6f 6e65  nal[Size] = None
+0001eaa0: 2c20 6b65 793a 204f 7074 696f 6e61 6c5b  , key: Optional[
+0001eab0: 5365 6564 4f72 4b65 795d 203d 204e 6f6e  SeedOrKey] = Non
+0001eac0: 652c 2064 7479 7065 3a20 4454 7970 654c  e, dtype: DTypeL
+0001ead0: 696b 6520 3d20 4e6f 6e65 293a 0d0a 2020  ike = None):..  
+0001eae0: 7222 2222 0d0a 2020 4472 6177 2073 616d  r"""..  Draw sam
+0001eaf0: 706c 6573 2066 726f 6d20 6120 6c6f 6761  ples from a loga
+0001eb00: 7269 7468 6d69 6320 7365 7269 6573 2064  rithmic series d
+0001eb10: 6973 7472 6962 7574 696f 6e2e 0d0a 0d0a  istribution.....
+0001eb20: 2020 5361 6d70 6c65 7320 6172 6520 6472    Samples are dr
+0001eb30: 6177 6e20 6672 6f6d 2061 206c 6f67 2073  awn from a log s
+0001eb40: 6572 6965 7320 6469 7374 7269 6275 7469  eries distributi
+0001eb50: 6f6e 2077 6974 6820 7370 6563 6966 6965  on with specifie
+0001eb60: 640d 0a20 2073 6861 7065 2070 6172 616d  d..  shape param
+0001eb70: 6574 6572 2c20 3020 3c3d 2060 6070 6060  eter, 0 <= ``p``
+0001eb80: 203c 2031 2e0d 0a0d 0a20 2050 6172 616d   < 1.....  Param
+0001eb90: 6574 6572 730d 0a20 202d 2d2d 2d2d 2d2d  eters..  -------
+0001eba0: 2d2d 2d0d 0a20 2070 203a 2066 6c6f 6174  ---..  p : float
+0001ebb0: 206f 7220 6172 7261 795f 6c69 6b65 206f   or array_like o
+0001ebc0: 6620 666c 6f61 7473 0d0a 2020 2020 2020  f floats..      
+0001ebd0: 5368 6170 6520 7061 7261 6d65 7465 7220  Shape parameter 
+0001ebe0: 666f 7220 7468 6520 6469 7374 7269 6275  for the distribu
+0001ebf0: 7469 6f6e 2e20 204d 7573 7420 6265 2069  tion.  Must be i
+0001ec00: 6e20 7468 6520 7261 6e67 6520 5b30 2c20  n the range [0, 
+0001ec10: 3129 2e0d 0a20 2073 697a 6520 3a20 696e  1)...  size : in
+0001ec20: 7420 6f72 2074 7570 6c65 206f 6620 696e  t or tuple of in
+0001ec30: 7473 2c20 6f70 7469 6f6e 616c 0d0a 2020  ts, optional..  
+0001ec40: 2020 2020 4f75 7470 7574 2073 6861 7065      Output shape
+0001ec50: 2e20 2049 6620 7468 6520 6769 7665 6e20  .  If the given 
+0001ec60: 7368 6170 6520 6973 2c20 652e 672e 2c20  shape is, e.g., 
+0001ec70: 6060 286d 2c20 6e2c 206b 2960 602c 2074  ``(m, n, k)``, t
+0001ec80: 6865 6e0d 0a20 2020 2020 2060 606d 202a  hen..      ``m *
+0001ec90: 206e 202a 206b 6060 2073 616d 706c 6573   n * k`` samples
+0001eca0: 2061 7265 2064 7261 776e 2e20 2049 6620   are drawn.  If 
+0001ecb0: 7369 7a65 2069 7320 6060 4e6f 6e65 6060  size is ``None``
+0001ecc0: 2028 6465 6661 756c 7429 2c0d 0a20 2020   (default),..   
+0001ecd0: 2020 2061 2073 696e 676c 6520 7661 6c75     a single valu
+0001ece0: 6520 6973 2072 6574 7572 6e65 6420 6966  e is returned if
+0001ecf0: 2060 6070 6060 2069 7320 6120 7363 616c   ``p`` is a scal
+0001ed00: 6172 2e20 204f 7468 6572 7769 7365 2c0d  ar.  Otherwise,.
+0001ed10: 0a20 2020 2020 2060 606e 702e 6172 7261  .      ``np.arra
+0001ed20: 7928 7029 2e73 697a 6560 6020 7361 6d70  y(p).size`` samp
+0001ed30: 6c65 7320 6172 6520 6472 6177 6e2e 0d0a  les are drawn...
+0001ed40: 2020 6b65 7920 3a20 5052 4e47 4b65 792c    key : PRNGKey,
+0001ed50: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
+0001ed60: 2054 6865 206b 6579 2066 6f72 2074 6865   The key for the
+0001ed70: 2072 616e 646f 6d20 6e75 6d62 6572 2067   random number g
+0001ed80: 656e 6572 6174 6f72 2e20 4966 206e 6f74  enerator. If not
+0001ed90: 2067 6976 656e 2c20 7468 650d 0a20 2020   given, the..   
+0001eda0: 2020 2064 6566 6175 6c74 2072 616e 646f     default rando
+0001edb0: 6d20 6e75 6d62 6572 2067 656e 6572 6174  m number generat
+0001edc0: 6f72 2069 7320 7573 6564 2e0d 0a0d 0a20  or is used..... 
+0001edd0: 2052 6574 7572 6e73 0d0a 2020 2d2d 2d2d   Returns..  ----
+0001ede0: 2d2d 2d0d 0a20 206f 7574 203a 206e 6461  ---..  out : nda
+0001edf0: 7272 6179 206f 7220 7363 616c 6172 0d0a  rray or scalar..
+0001ee00: 2020 2020 2020 4472 6177 6e20 7361 6d70        Drawn samp
+0001ee10: 6c65 7320 6672 6f6d 2074 6865 2070 6172  les from the par
+0001ee20: 616d 6574 6572 697a 6564 206c 6f67 6172  ameterized logar
+0001ee30: 6974 686d 6963 2073 6572 6965 7320 6469  ithmic series di
+0001ee40: 7374 7269 6275 7469 6f6e 2e0d 0a0d 0a20  stribution..... 
+0001ee50: 2053 6565 2041 6c73 6f0d 0a20 202d 2d2d   See Also..  ---
+0001ee60: 2d2d 2d2d 2d0d 0a20 2073 6369 7079 2e73  -----..  scipy.s
+0001ee70: 7461 7473 2e6c 6f67 7365 7220 3a20 7072  tats.logser : pr
+0001ee80: 6f62 6162 696c 6974 7920 6465 6e73 6974  obability densit
+0001ee90: 7920 6675 6e63 7469 6f6e 2c20 6469 7374  y function, dist
+0001eea0: 7269 6275 7469 6f6e 206f 720d 0a20 2020  ribution or..   
+0001eeb0: 2020 2063 756d 756c 6174 6976 6520 6465     cumulative de
+0001eec0: 6e73 6974 7920 6675 6e63 7469 6f6e 2c20  nsity function, 
+0001eed0: 6574 632e 0d0a 0d0a 2020 4e6f 7465 730d  etc.....  Notes.
+0001eee0: 0a20 202d 2d2d 2d2d 0d0a 2020 5468 6520  .  -----..  The 
+0001eef0: 7072 6f62 6162 696c 6974 7920 6465 6e73  probability dens
+0001ef00: 6974 7920 666f 7220 7468 6520 4c6f 6720  ity for the Log 
+0001ef10: 5365 7269 6573 2064 6973 7472 6962 7574  Series distribut
+0001ef20: 696f 6e20 6973 0d0a 0d0a 2020 2e2e 206d  ion is....  .. m
+0001ef30: 6174 683a 3a20 5028 6b29 203d 205c 6672  ath:: P(k) = \fr
+0001ef40: 6163 7b2d 705e 6b7d 7b6b 205c 6c6e 2831  ac{-p^k}{k \ln(1
+0001ef50: 2d70 297d 2c0d 0a0d 0a20 2077 6865 7265  -p)},....  where
+0001ef60: 2070 203d 2070 726f 6261 6269 6c69 7479   p = probability
+0001ef70: 2e0d 0a0d 0a20 2054 6865 206c 6f67 2073  .....  The log s
+0001ef80: 6572 6965 7320 6469 7374 7269 6275 7469  eries distributi
+0001ef90: 6f6e 2069 7320 6672 6571 7565 6e74 6c79  on is frequently
+0001efa0: 2075 7365 6420 746f 2072 6570 7265 7365   used to represe
+0001efb0: 6e74 2073 7065 6369 6573 0d0a 2020 7269  nt species..  ri
+0001efc0: 6368 6e65 7373 2061 6e64 206f 6363 7572  chness and occur
+0001efd0: 7265 6e63 652c 2066 6972 7374 2070 726f  rence, first pro
+0001efe0: 706f 7365 6420 6279 2046 6973 6865 722c  posed by Fisher,
+0001eff0: 2043 6f72 6265 742c 2061 6e64 0d0a 2020   Corbet, and..  
+0001f000: 5769 6c6c 6961 6d73 2069 6e20 3139 3433  Williams in 1943
+0001f010: 205b 325d 2e20 2049 7420 6d61 7920 616c   [2].  It may al
+0001f020: 736f 2062 6520 7573 6564 2074 6f20 6d6f  so be used to mo
+0001f030: 6465 6c20 7468 6520 6e75 6d62 6572 7320  del the numbers 
+0001f040: 6f66 0d0a 2020 6f63 6375 7061 6e74 7320  of..  occupants 
+0001f050: 7365 656e 2069 6e20 6361 7273 205b 335d  seen in cars [3]
+0001f060: 2e0d 0a0d 0a20 2052 6566 6572 656e 6365  .....  Reference
+0001f070: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
+0001f080: 0a20 202e 2e20 5b31 5d20 4275 7a61 732c  .  .. [1] Buzas,
+0001f090: 204d 6172 7469 6e20 412e 3b20 4375 6c76   Martin A.; Culv
+0001f0a0: 6572 2c20 5374 6570 6865 6e20 4a2e 2c20  er, Stephen J., 
+0001f0b0: 2055 6e64 6572 7374 616e 6469 6e67 2072   Understanding r
+0001f0c0: 6567 696f 6e61 6c0d 0a20 2020 2020 2020  egional..       
+0001f0d0: 2020 7370 6563 6965 7320 6469 7665 7273    species divers
+0001f0e0: 6974 7920 7468 726f 7567 6820 7468 6520  ity through the 
+0001f0f0: 6c6f 6720 7365 7269 6573 2064 6973 7472  log series distr
+0001f100: 6962 7574 696f 6e20 6f66 0d0a 2020 2020  ibution of..    
+0001f110: 2020 2020 206f 6363 7572 7265 6e63 6573       occurrences
+0001f120: 3a20 4249 4f44 4956 4552 5349 5459 2052  : BIODIVERSITY R
+0001f130: 4553 4541 5243 4820 4469 7665 7273 6974  ESEARCH Diversit
+0001f140: 7920 2620 4469 7374 7269 6275 7469 6f6e  y & Distribution
+0001f150: 732c 0d0a 2020 2020 2020 2020 2056 6f6c  s,..         Vol
+0001f160: 756d 6520 352c 204e 756d 6265 7220 352c  ume 5, Number 5,
+0001f170: 2053 6570 7465 6d62 6572 2031 3939 3920   September 1999 
+0001f180: 2c20 7070 2e20 3138 372d 3139 3528 3929  , pp. 187-195(9)
+0001f190: 2e0d 0a20 202e 2e20 5b32 5d20 4669 7368  ...  .. [2] Fish
+0001f1a0: 6572 2c20 522e 412c 2c20 412e 532e 2043  er, R.A,, A.S. C
+0001f1b0: 6f72 6265 742c 2061 6e64 2043 2e42 2e20  orbet, and C.B. 
+0001f1c0: 5769 6c6c 6961 6d73 2e20 3139 3433 2e20  Williams. 1943. 
+0001f1d0: 5468 650d 0a20 2020 2020 2020 2020 7265  The..         re
+0001f1e0: 6c61 7469 6f6e 2062 6574 7765 656e 2074  lation between t
+0001f1f0: 6865 206e 756d 6265 7220 6f66 2073 7065  he number of spe
+0001f200: 6369 6573 2061 6e64 2074 6865 206e 756d  cies and the num
+0001f210: 6265 7220 6f66 0d0a 2020 2020 2020 2020  ber of..        
+0001f220: 2069 6e64 6976 6964 7561 6c73 2069 6e20   individuals in 
+0001f230: 6120 7261 6e64 6f6d 2073 616d 706c 6520  a random sample 
+0001f240: 6f66 2061 6e20 616e 696d 616c 2070 6f70  of an animal pop
+0001f250: 756c 6174 696f 6e2e 0d0a 2020 2020 2020  ulation...      
+0001f260: 2020 204a 6f75 726e 616c 206f 6620 416e     Journal of An
+0001f270: 696d 616c 2045 636f 6c6f 6779 2c20 3132  imal Ecology, 12
+0001f280: 3a34 322d 3538 2e0d 0a20 202e 2e20 5b33  :42-58...  .. [3
+0001f290: 5d20 442e 204a 2e20 4861 6e64 2c20 462e  ] D. J. Hand, F.
+0001f2a0: 2044 616c 792c 2044 2e20 4c75 6e6e 2c20   Daly, D. Lunn, 
+0001f2b0: 452e 204f 7374 726f 7773 6b69 2c20 4120  E. Ostrowski, A 
+0001f2c0: 4861 6e64 626f 6f6b 206f 6620 536d 616c  Handbook of Smal
+0001f2d0: 6c0d 0a20 2020 2020 2020 2020 4461 7461  l..         Data
+0001f2e0: 2053 6574 732c 2043 5243 2050 7265 7373   Sets, CRC Press
+0001f2f0: 2c20 3139 3934 2e0d 0a20 202e 2e20 5b34  , 1994...  .. [4
+0001f300: 5d20 5769 6b69 7065 6469 612c 2022 4c6f  ] Wikipedia, "Lo
+0001f310: 6761 7269 7468 6d69 6320 6469 7374 7269  garithmic distri
+0001f320: 6275 7469 6f6e 222c 0d0a 2020 2020 2020  bution",..      
+0001f330: 2020 2068 7474 7073 3a2f 2f65 6e2e 7769     https://en.wi
+0001f340: 6b69 7065 6469 612e 6f72 672f 7769 6b69  kipedia.org/wiki
+0001f350: 2f4c 6f67 6172 6974 686d 6963 5f64 6973  /Logarithmic_dis
+0001f360: 7472 6962 7574 696f 6e0d 0a0d 0a20 2045  tribution....  E
+0001f370: 7861 6d70 6c65 730d 0a20 202d 2d2d 2d2d  xamples..  -----
+0001f380: 2d2d 2d0d 0a20 2044 7261 7720 7361 6d70  ---..  Draw samp
+0001f390: 6c65 7320 6672 6f6d 2074 6865 2064 6973  les from the dis
+0001f3a0: 7472 6962 7574 696f 6e3a 0d0a 0d0a 2020  tribution:....  
+0001f3b0: 3e3e 3e20 6120 3d20 2e36 0d0a 2020 3e3e  >>> a = .6..  >>
+0001f3c0: 3e20 7320 3d20 6272 6169 6e63 6f72 652e  > s = braincore.
+0001f3d0: 7261 6e64 6f6d 2e6c 6f67 7365 7269 6573  random.logseries
+0001f3e0: 2861 2c20 3130 3030 3029 0d0a 2020 3e3e  (a, 10000)..  >>
+0001f3f0: 3e20 696d 706f 7274 206d 6174 706c 6f74  > import matplot
+0001f400: 6c69 622e 7079 706c 6f74 2061 7320 706c  lib.pyplot as pl
+0001f410: 7420 2023 206e 6f71 610d 0a20 203e 3e3e  t  # noqa..  >>>
+0001f420: 2063 6f75 6e74 2c20 6269 6e73 2c20 6967   count, bins, ig
+0001f430: 6e6f 7265 6420 3d20 706c 742e 6869 7374  nored = plt.hist
+0001f440: 2873 290d 0a0d 0a20 2023 2020 2070 6c6f  (s)....  #   plo
+0001f450: 7420 6167 6169 6e73 7420 6469 7374 7269  t against distri
+0001f460: 6275 7469 6f6e 0d0a 0d0a 2020 3e3e 3e20  bution....  >>> 
+0001f470: 6465 6620 6c6f 6773 6572 6965 7328 6b2c  def logseries(k,
+0001f480: 2070 293a 0d0a 2020 2e2e 2e20 2020 2020   p):..  ...     
+0001f490: 7265 7475 726e 202d 702a 2a6b 2f28 6b2a  return -p**k/(k*
+0001f4a0: 6e70 2e6c 6f67 2831 2d70 2929 0d0a 2020  np.log(1-p))..  
+0001f4b0: 3e3e 3e20 706c 742e 706c 6f74 2862 696e  >>> plt.plot(bin
+0001f4c0: 732c 206c 6f67 7365 7269 6573 2862 696e  s, logseries(bin
+0001f4d0: 732c 2061 292a 636f 756e 742e 6d61 7828  s, a)*count.max(
+0001f4e0: 292f 0d0a 2020 2e2e 2e20 2020 2020 2020  )/..  ...       
+0001f4f0: 2020 206c 6f67 7365 7269 6573 2862 696e     logseries(bin
+0001f500: 732c 2061 292e 6d61 7828 292c 2027 7227  s, a).max(), 'r'
+0001f510: 290d 0a20 203e 3e3e 2070 6c74 2e73 686f  )..  >>> plt.sho
+0001f520: 7728 290d 0a20 2022 2222 0d0a 2020 7265  w()..  """..  re
+0001f530: 7475 726e 2044 4546 4155 4c54 2e6c 6f67  turn DEFAULT.log
+0001f540: 7365 7269 6573 2870 2c20 7369 7a65 2c20  series(p, size, 
+0001f550: 6b65 793d 6b65 792c 2064 7479 7065 3d64  key=key, dtype=d
+0001f560: 7479 7065 290d 0a0d 0a0d 0a64 6566 206d  type)......def m
+0001f570: 756c 7469 6e6f 6d69 616c 286e 2c0d 0a20  ultinomial(n,.. 
+0001f580: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0001f590: 7661 6c73 2c0d 0a20 2020 2020 2020 2020  vals,..         
+0001f5a0: 2020 2020 2020 2073 697a 653a 204f 7074         size: Opt
+0001f5b0: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
+0001f5c0: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
+0001f5d0: 2020 2020 206b 6579 3a20 4f70 7469 6f6e       key: Option
+0001f5e0: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
+0001f5f0: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+0001f600: 2020 2020 2020 2064 7479 7065 3a20 4454         dtype: DT
+0001f610: 7970 654c 696b 6520 3d20 4e6f 6e65 293a  ypeLike = None):
+0001f620: 0d0a 2020 7222 2222 0d0a 2020 4472 6177  ..  r"""..  Draw
+0001f630: 2073 616d 706c 6573 2066 726f 6d20 6120   samples from a 
+0001f640: 6d75 6c74 696e 6f6d 6961 6c20 6469 7374  multinomial dist
+0001f650: 7269 6275 7469 6f6e 2e0d 0a0d 0a20 2054  ribution.....  T
+0001f660: 6865 206d 756c 7469 6e6f 6d69 616c 2064  he multinomial d
+0001f670: 6973 7472 6962 7574 696f 6e20 6973 2061  istribution is a
+0001f680: 206d 756c 7469 7661 7269 6174 6520 6765   multivariate ge
+0001f690: 6e65 7261 6c69 7a61 7469 6f6e 206f 6620  neralization of 
+0001f6a0: 7468 650d 0a20 2062 696e 6f6d 6961 6c20  the..  binomial 
+0001f6b0: 6469 7374 7269 6275 7469 6f6e 2e20 2054  distribution.  T
+0001f6c0: 616b 6520 616e 2065 7870 6572 696d 656e  ake an experimen
+0001f6d0: 7420 7769 7468 206f 6e65 206f 6620 6060  t with one of ``
+0001f6e0: 7060 600d 0a20 2070 6f73 7369 626c 6520  p``..  possible 
+0001f6f0: 6f75 7463 6f6d 6573 2e20 2041 6e20 6578  outcomes.  An ex
+0001f700: 616d 706c 6520 6f66 2073 7563 6820 616e  ample of such an
+0001f710: 2065 7870 6572 696d 656e 7420 6973 2074   experiment is t
+0001f720: 6872 6f77 696e 6720 6120 6469 6365 2c0d  hrowing a dice,.
+0001f730: 0a20 2077 6865 7265 2074 6865 206f 7574  .  where the out
+0001f740: 636f 6d65 2063 616e 2062 6520 3120 7468  come can be 1 th
+0001f750: 726f 7567 6820 362e 2020 4561 6368 2073  rough 6.  Each s
+0001f760: 616d 706c 6520 6472 6177 6e20 6672 6f6d  ample drawn from
+0001f770: 2074 6865 0d0a 2020 6469 7374 7269 6275   the..  distribu
+0001f780: 7469 6f6e 2072 6570 7265 7365 6e74 7320  tion represents 
+0001f790: 606e 6020 7375 6368 2065 7870 6572 696d  `n` such experim
+0001f7a0: 656e 7473 2e20 2049 7473 2076 616c 7565  ents.  Its value
+0001f7b0: 732c 0d0a 2020 6060 585f 6920 3d20 5b58  s,..  ``X_i = [X
+0001f7c0: 5f30 2c20 585f 312c 202e 2e2e 2c20 585f  _0, X_1, ..., X_
+0001f7d0: 705d 6060 2c20 7265 7072 6573 656e 7420  p]``, represent 
+0001f7e0: 7468 6520 6e75 6d62 6572 206f 6620 7469  the number of ti
+0001f7f0: 6d65 7320 7468 650d 0a20 206f 7574 636f  mes the..  outco
+0001f800: 6d65 2077 6173 2060 6069 6060 2e0d 0a0d  me was ``i``....
+0001f810: 0a20 2050 6172 616d 6574 6572 730d 0a20  .  Parameters.. 
+0001f820: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 206e   ----------..  n
+0001f830: 203a 2069 6e74 0d0a 2020 2020 2020 4e75   : int..      Nu
+0001f840: 6d62 6572 206f 6620 6578 7065 7269 6d65  mber of experime
+0001f850: 6e74 732e 0d0a 2020 7076 616c 7320 3a20  nts...  pvals : 
+0001f860: 7365 7175 656e 6365 206f 6620 666c 6f61  sequence of floa
+0001f870: 7473 2c20 6c65 6e67 7468 2070 0d0a 2020  ts, length p..  
+0001f880: 2020 2020 5072 6f62 6162 696c 6974 6965      Probabilitie
+0001f890: 7320 6f66 2065 6163 6820 6f66 2074 6865  s of each of the
+0001f8a0: 2060 6070 6060 2064 6966 6665 7265 6e74   ``p`` different
+0001f8b0: 206f 7574 636f 6d65 732e 2020 5468 6573   outcomes.  Thes
+0001f8c0: 650d 0a20 2020 2020 206d 7573 7420 7375  e..      must su
+0001f8d0: 6d20 746f 2031 2028 686f 7765 7665 722c  m to 1 (however,
+0001f8e0: 2074 6865 206c 6173 7420 656c 656d 656e   the last elemen
+0001f8f0: 7420 6973 2061 6c77 6179 7320 6173 7375  t is always assu
+0001f900: 6d65 6420 746f 0d0a 2020 2020 2020 6163  med to..      ac
+0001f910: 636f 756e 7420 666f 7220 7468 6520 7265  count for the re
+0001f920: 6d61 696e 696e 6720 7072 6f62 6162 696c  maining probabil
+0001f930: 6974 792c 2061 7320 6c6f 6e67 2061 730d  ity, as long as.
+0001f940: 0a20 2020 2020 2060 6073 756d 2870 7661  .      ``sum(pva
+0001f950: 6c73 5b3a 2d31 5d29 203c 3d20 3129 6060  ls[:-1]) <= 1)``
+0001f960: 2e0d 0a20 2073 697a 6520 3a20 696e 7420  ...  size : int 
+0001f970: 6f72 2074 7570 6c65 206f 6620 696e 7473  or tuple of ints
+0001f980: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+0001f990: 2020 4f75 7470 7574 2073 6861 7065 2e20    Output shape. 
+0001f9a0: 2049 6620 7468 6520 6769 7665 6e20 7368   If the given sh
+0001f9b0: 6170 6520 6973 2c20 652e 672e 2c20 6060  ape is, e.g., ``
+0001f9c0: 286d 2c20 6e2c 206b 2960 602c 2074 6865  (m, n, k)``, the
+0001f9d0: 6e0d 0a20 2020 2020 2060 606d 202a 206e  n..      ``m * n
+0001f9e0: 202a 206b 6060 2073 616d 706c 6573 2061   * k`` samples a
+0001f9f0: 7265 2064 7261 776e 2e20 2044 6566 6175  re drawn.  Defau
+0001fa00: 6c74 2069 7320 4e6f 6e65 2c20 696e 2077  lt is None, in w
+0001fa10: 6869 6368 2063 6173 6520 610d 0a20 2020  hich case a..   
+0001fa20: 2020 2073 696e 676c 6520 7661 6c75 6520     single value 
+0001fa30: 6973 2072 6574 7572 6e65 642e 0d0a 2020  is returned...  
+0001fa40: 6b65 7920 3a20 5052 4e47 4b65 792c 206f  key : PRNGKey, o
+0001fa50: 7074 696f 6e61 6c0d 0a20 2020 2020 2054  ptional..      T
+0001fa60: 6865 206b 6579 2066 6f72 2074 6865 2072  he key for the r
+0001fa70: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
+0001fa80: 6572 6174 6f72 2e20 4966 206e 6f74 2067  erator. If not g
+0001fa90: 6976 656e 2c20 7468 650d 0a20 2020 2020  iven, the..     
+0001faa0: 2064 6566 6175 6c74 2072 616e 646f 6d20   default random 
+0001fab0: 6e75 6d62 6572 2067 656e 6572 6174 6f72  number generator
+0001fac0: 2069 7320 7573 6564 2e0d 0a0d 0a20 2052   is used.....  R
+0001fad0: 6574 7572 6e73 0d0a 2020 2d2d 2d2d 2d2d  eturns..  ------
+0001fae0: 2d0d 0a20 206f 7574 203a 206e 6461 7272  -..  out : ndarr
+0001faf0: 6179 0d0a 2020 2020 2020 5468 6520 6472  ay..      The dr
+0001fb00: 6177 6e20 7361 6d70 6c65 732c 206f 6620  awn samples, of 
+0001fb10: 7368 6170 6520 2a73 697a 652a 2c20 6966  shape *size*, if
+0001fb20: 2074 6861 7420 7761 7320 7072 6f76 6964   that was provid
+0001fb30: 6564 2e20 2049 6620 6e6f 742c 0d0a 2020  ed.  If not,..  
+0001fb40: 2020 2020 7468 6520 7368 6170 6520 6973      the shape is
+0001fb50: 2060 6028 4e2c 2960 602e 0d0a 0d0a 2020   ``(N,)``.....  
+0001fb60: 2020 2020 496e 206f 7468 6572 2077 6f72      In other wor
+0001fb70: 6473 2c20 6561 6368 2065 6e74 7279 2060  ds, each entry `
+0001fb80: 606f 7574 5b69 2c6a 2c2e 2e2e 2c3a 5d60  `out[i,j,...,:]`
+0001fb90: 6020 6973 2061 6e20 4e2d 6469 6d65 6e73  ` is an N-dimens
+0001fba0: 696f 6e61 6c0d 0a20 2020 2020 2076 616c  ional..      val
+0001fbb0: 7565 2064 7261 776e 2066 726f 6d20 7468  ue drawn from th
+0001fbc0: 6520 6469 7374 7269 6275 7469 6f6e 2e0d  e distribution..
+0001fbd0: 0a0d 0a20 2045 7861 6d70 6c65 730d 0a20  ...  Examples.. 
+0001fbe0: 202d 2d2d 2d2d 2d2d 2d0d 0a20 2054 6872   --------..  Thr
+0001fbf0: 6f77 2061 2064 6963 6520 3230 2074 696d  ow a dice 20 tim
+0001fc00: 6573 3a0d 0a0d 0a20 203e 3e3e 2062 7261  es:....  >>> bra
+0001fc10: 696e 636f 7265 2e72 616e 646f 6d2e 6d75  incore.random.mu
+0001fc20: 6c74 696e 6f6d 6961 6c28 3230 2c20 5b31  ltinomial(20, [1
+0001fc30: 2f36 2e5d 2a36 2c20 7369 7a65 3d31 290d  /6.]*6, size=1).
+0001fc40: 0a20 2061 7272 6179 285b 5b34 2c20 312c  .  array([[4, 1,
+0001fc50: 2037 2c20 352c 2032 2c20 315d 5d29 2023   7, 5, 2, 1]]) #
+0001fc60: 2072 616e 646f 6d0d 0a0d 0a20 2049 7420   random....  It 
+0001fc70: 6c61 6e64 6564 2034 2074 696d 6573 206f  landed 4 times o
+0001fc80: 6e20 312c 206f 6e63 6520 6f6e 2032 2c20  n 1, once on 2, 
+0001fc90: 6574 632e 0d0a 0d0a 2020 4e6f 772c 2074  etc.....  Now, t
+0001fca0: 6872 6f77 2074 6865 2064 6963 6520 3230  hrow the dice 20
+0001fcb0: 2074 696d 6573 2c20 616e 6420 3230 2074   times, and 20 t
+0001fcc0: 696d 6573 2061 6761 696e 3a0d 0a0d 0a20  imes again:.... 
+0001fcd0: 203e 3e3e 2062 7261 696e 636f 7265 2e72   >>> braincore.r
+0001fce0: 616e 646f 6d2e 6d75 6c74 696e 6f6d 6961  andom.multinomia
+0001fcf0: 6c28 3230 2c20 5b31 2f36 2e5d 2a36 2c20  l(20, [1/6.]*6, 
+0001fd00: 7369 7a65 3d32 290d 0a20 2061 7272 6179  size=2)..  array
+0001fd10: 285b 5b33 2c20 342c 2033 2c20 332c 2034  ([[3, 4, 3, 3, 4
+0001fd20: 2c20 335d 2c20 2320 7261 6e64 6f6d 0d0a  , 3], # random..
+0001fd30: 2020 2020 2020 2020 205b 322c 2034 2c20           [2, 4, 
+0001fd40: 332c 2034 2c20 302c 2037 5d5d 290d 0a0d  3, 4, 0, 7]])...
+0001fd50: 0a20 2046 6f72 2074 6865 2066 6972 7374  .  For the first
+0001fd60: 2072 756e 2c20 7765 2074 6872 6577 2033   run, we threw 3
+0001fd70: 2074 696d 6573 2031 2c20 3420 7469 6d65   times 1, 4 time
+0001fd80: 7320 322c 2065 7463 2e20 2046 6f72 2074  s 2, etc.  For t
+0001fd90: 6865 2073 6563 6f6e 642c 0d0a 2020 7765  he second,..  we
+0001fda0: 2074 6872 6577 2032 2074 696d 6573 2031   threw 2 times 1
+0001fdb0: 2c20 3420 7469 6d65 7320 322c 2065 7463  , 4 times 2, etc
+0001fdc0: 2e0d 0a0d 0a20 2041 206c 6f61 6465 6420  .....  A loaded 
+0001fdd0: 6469 6520 6973 206d 6f72 6520 6c69 6b65  die is more like
+0001fde0: 6c79 2074 6f20 6c61 6e64 206f 6e20 6e75  ly to land on nu
+0001fdf0: 6d62 6572 2036 3a0d 0a0d 0a20 203e 3e3e  mber 6:....  >>>
+0001fe00: 2062 7261 696e 636f 7265 2e72 616e 646f   braincore.rando
+0001fe10: 6d2e 6d75 6c74 696e 6f6d 6961 6c28 3130  m.multinomial(10
+0001fe20: 302c 205b 312f 372e 5d2a 3520 2b20 5b32  0, [1/7.]*5 + [2
+0001fe30: 2f37 2e5d 290d 0a20 2061 7272 6179 285b  /7.])..  array([
+0001fe40: 3131 2c20 3136 2c20 3134 2c20 3137 2c20  11, 16, 14, 17, 
+0001fe50: 3136 2c20 3236 5d29 2023 2072 616e 646f  16, 26]) # rando
+0001fe60: 6d0d 0a0d 0a20 2054 6865 2070 726f 6261  m....  The proba
+0001fe70: 6269 6c69 7479 2069 6e70 7574 7320 7368  bility inputs sh
+0001fe80: 6f75 6c64 2062 6520 6e6f 726d 616c 697a  ould be normaliz
+0001fe90: 6564 2e20 4173 2061 6e20 696d 706c 656d  ed. As an implem
+0001fea0: 656e 7461 7469 6f6e 0d0a 2020 6465 7461  entation..  deta
+0001feb0: 696c 2c20 7468 6520 7661 6c75 6520 6f66  il, the value of
+0001fec0: 2074 6865 206c 6173 7420 656e 7472 7920   the last entry 
+0001fed0: 6973 2069 676e 6f72 6564 2061 6e64 2061  is ignored and a
+0001fee0: 7373 756d 6564 2074 6f20 7461 6b65 0d0a  ssumed to take..
+0001fef0: 2020 7570 2061 6e79 206c 6566 746f 7665    up any leftove
+0001ff00: 7220 7072 6f62 6162 696c 6974 7920 6d61  r probability ma
+0001ff10: 7373 2c20 6275 7420 7468 6973 2073 686f  ss, but this sho
+0001ff20: 756c 6420 6e6f 7420 6265 2072 656c 6965  uld not be relie
+0001ff30: 6420 6f6e 2e0d 0a20 2041 2062 6961 7365  d on...  A biase
+0001ff40: 6420 636f 696e 2077 6869 6368 2068 6173  d coin which has
+0001ff50: 2074 7769 6365 2061 7320 6d75 6368 2077   twice as much w
+0001ff60: 6569 6768 7420 6f6e 206f 6e65 2073 6964  eight on one sid
+0001ff70: 6520 6173 206f 6e20 7468 650d 0a20 206f  e as on the..  o
+0001ff80: 7468 6572 2073 686f 756c 6420 6265 2073  ther should be s
+0001ff90: 616d 706c 6564 206c 696b 6520 736f 3a0d  ampled like so:.
+0001ffa0: 0a0d 0a20 203e 3e3e 2062 7261 696e 636f  ...  >>> brainco
+0001ffb0: 7265 2e72 616e 646f 6d2e 6d75 6c74 696e  re.random.multin
+0001ffc0: 6f6d 6961 6c28 3130 302c 205b 312e 3020  omial(100, [1.0 
+0001ffd0: 2f20 332c 2032 2e30 202f 2033 5d29 2020  / 3, 2.0 / 3])  
+0001ffe0: 2320 5249 4748 540d 0a20 2061 7272 6179  # RIGHT..  array
+0001fff0: 285b 3338 2c20 3632 5d29 2023 2072 616e  ([38, 62]) # ran
+00020000: 646f 6d0d 0a0d 0a20 206e 6f74 206c 696b  dom....  not lik
+00020010: 653a 0d0a 0d0a 2020 3e3e 3e20 6272 6169  e:....  >>> brai
+00020020: 6e63 6f72 652e 7261 6e64 6f6d 2e6d 756c  ncore.random.mul
+00020030: 7469 6e6f 6d69 616c 2831 3030 2c20 5b31  tinomial(100, [1
+00020040: 2e30 2c20 322e 305d 2920 2023 2057 524f  .0, 2.0])  # WRO
+00020050: 4e47 0d0a 2020 5472 6163 6562 6163 6b20  NG..  Traceback 
+00020060: 286d 6f73 7420 7265 6365 6e74 2063 616c  (most recent cal
+00020070: 6c20 6c61 7374 293a 0d0a 2020 5661 6c75  l last):..  Valu
+00020080: 6545 7272 6f72 3a20 7076 616c 7320 3c20  eError: pvals < 
+00020090: 302c 2070 7661 6c73 203e 2031 206f 7220  0, pvals > 1 or 
+000200a0: 7076 616c 7320 636f 6e74 6169 6e73 204e  pvals contains N
+000200b0: 614e 730d 0a20 2022 2222 0d0a 2020 7265  aNs..  """..  re
+000200c0: 7475 726e 2044 4546 4155 4c54 2e6d 756c  turn DEFAULT.mul
+000200d0: 7469 6e6f 6d69 616c 286e 2c20 7076 616c  tinomial(n, pval
+000200e0: 732c 2073 697a 652c 206b 6579 3d6b 6579  s, size, key=key
+000200f0: 2c20 6474 7970 653d 6474 7970 6529 0d0a  , dtype=dtype)..
+00020100: 0d0a 0d0a 6465 6620 6d75 6c74 6976 6172  ....def multivar
+00020110: 6961 7465 5f6e 6f72 6d61 6c28 6d65 616e  iate_normal(mean
+00020120: 2c20 636f 762c 2073 697a 653a 204f 7074  , cov, size: Opt
+00020130: 696f 6e61 6c5b 5369 7a65 5d20 3d20 4e6f  ional[Size] = No
+00020140: 6e65 2c20 6d65 7468 6f64 3a20 7374 7220  ne, method: str 
+00020150: 3d20 2763 686f 6c65 736b 7927 2c0d 0a20  = 'cholesky',.. 
+00020160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020170: 2020 2020 2020 206b 6579 3a20 4f70 7469         key: Opti
+00020180: 6f6e 616c 5b53 6565 644f 724b 6579 5d20  onal[SeedOrKey] 
+00020190: 3d20 4e6f 6e65 2c20 6474 7970 653a 2044  = None, dtype: D
+000201a0: 5479 7065 4c69 6b65 203d 204e 6f6e 6529  TypeLike = None)
+000201b0: 3a0d 0a20 2072 2222 220d 0a20 2044 7261  :..  r"""..  Dra
+000201c0: 7720 7261 6e64 6f6d 2073 616d 706c 6573  w random samples
+000201d0: 2066 726f 6d20 6120 6d75 6c74 6976 6172   from a multivar
+000201e0: 6961 7465 206e 6f72 6d61 6c20 6469 7374  iate normal dist
+000201f0: 7269 6275 7469 6f6e 2e0d 0a0d 0a20 2054  ribution.....  T
+00020200: 6865 206d 756c 7469 7661 7269 6174 6520  he multivariate 
+00020210: 6e6f 726d 616c 2c20 6d75 6c74 696e 6f72  normal, multinor
+00020220: 6d61 6c20 6f72 2047 6175 7373 6961 6e20  mal or Gaussian 
+00020230: 6469 7374 7269 6275 7469 6f6e 2069 7320  distribution is 
+00020240: 610d 0a20 2067 656e 6572 616c 697a 6174  a..  generalizat
+00020250: 696f 6e20 6f66 2074 6865 206f 6e65 2d64  ion of the one-d
+00020260: 696d 656e 7369 6f6e 616c 206e 6f72 6d61  imensional norma
+00020270: 6c20 6469 7374 7269 6275 7469 6f6e 2074  l distribution t
+00020280: 6f20 6869 6768 6572 0d0a 2020 6469 6d65  o higher..  dime
+00020290: 6e73 696f 6e73 2e20 2053 7563 6820 6120  nsions.  Such a 
+000202a0: 6469 7374 7269 6275 7469 6f6e 2069 7320  distribution is 
+000202b0: 7370 6563 6966 6965 6420 6279 2069 7473  specified by its
+000202c0: 206d 6561 6e20 616e 640d 0a20 2063 6f76   mean and..  cov
+000202d0: 6172 6961 6e63 6520 6d61 7472 6978 2e20  ariance matrix. 
+000202e0: 2054 6865 7365 2070 6172 616d 6574 6572   These parameter
+000202f0: 7320 6172 6520 616e 616c 6f67 6f75 7320  s are analogous 
+00020300: 746f 2074 6865 206d 6561 6e0d 0a20 2028  to the mean..  (
+00020310: 6176 6572 6167 6520 6f72 2022 6365 6e74  average or "cent
+00020320: 6572 2229 2061 6e64 2076 6172 6961 6e63  er") and varianc
+00020330: 6520 2873 7461 6e64 6172 6420 6465 7669  e (standard devi
+00020340: 6174 696f 6e2c 206f 7220 2277 6964 7468  ation, or "width
+00020350: 2c22 0d0a 2020 7371 7561 7265 6429 206f  ,"..  squared) o
+00020360: 6620 7468 6520 6f6e 652d 6469 6d65 6e73  f the one-dimens
+00020370: 696f 6e61 6c20 6e6f 726d 616c 2064 6973  ional normal dis
+00020380: 7472 6962 7574 696f 6e2e 0d0a 0d0a 2020  tribution.....  
+00020390: 5061 7261 6d65 7465 7273 0d0a 2020 2d2d  Parameters..  --
+000203a0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 6d65 616e  --------..  mean
+000203b0: 203a 2031 2d44 2061 7272 6179 5f6c 696b   : 1-D array_lik
+000203c0: 652c 206f 6620 6c65 6e67 7468 204e 0d0a  e, of length N..
+000203d0: 2020 2020 2020 4d65 616e 206f 6620 7468        Mean of th
+000203e0: 6520 4e2d 6469 6d65 6e73 696f 6e61 6c20  e N-dimensional 
+000203f0: 6469 7374 7269 6275 7469 6f6e 2e0d 0a20  distribution... 
+00020400: 2063 6f76 203a 2032 2d44 2061 7272 6179   cov : 2-D array
+00020410: 5f6c 696b 652c 206f 6620 7368 6170 6520  _like, of shape 
+00020420: 284e 2c20 4e29 0d0a 2020 2020 2020 436f  (N, N)..      Co
+00020430: 7661 7269 616e 6365 206d 6174 7269 7820  variance matrix 
+00020440: 6f66 2074 6865 2064 6973 7472 6962 7574  of the distribut
+00020450: 696f 6e2e 2049 7420 6d75 7374 2062 6520  ion. It must be 
+00020460: 7379 6d6d 6574 7269 6320 616e 640d 0a20  symmetric and.. 
+00020470: 2020 2020 2070 6f73 6974 6976 652d 7365       positive-se
+00020480: 6d69 6465 6669 6e69 7465 2066 6f72 2070  midefinite for p
+00020490: 726f 7065 7220 7361 6d70 6c69 6e67 2e0d  roper sampling..
+000204a0: 0a20 2073 697a 6520 3a20 696e 7420 6f72  .  size : int or
+000204b0: 2074 7570 6c65 206f 6620 696e 7473 2c20   tuple of ints, 
+000204c0: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+000204d0: 4769 7665 6e20 6120 7368 6170 6520 6f66  Given a shape of
+000204e0: 2c20 666f 7220 6578 616d 706c 652c 2060  , for example, `
+000204f0: 6028 6d2c 6e2c 6b29 6060 2c20 6060 6d2a  `(m,n,k)``, ``m*
+00020500: 6e2a 6b60 6020 7361 6d70 6c65 7320 6172  n*k`` samples ar
+00020510: 650d 0a20 2020 2020 2067 656e 6572 6174  e..      generat
+00020520: 6564 2c20 616e 6420 7061 636b 6564 2069  ed, and packed i
+00020530: 6e20 616e 2060 6d60 2d62 792d 606e 602d  n an `m`-by-`n`-
+00020540: 6279 2d60 6b60 2061 7272 616e 6765 6d65  by-`k` arrangeme
+00020550: 6e74 2e20 2042 6563 6175 7365 0d0a 2020  nt.  Because..  
+00020560: 2020 2020 6561 6368 2073 616d 706c 6520      each sample 
+00020570: 6973 2060 4e60 2d64 696d 656e 7369 6f6e  is `N`-dimension
+00020580: 616c 2c20 7468 6520 6f75 7470 7574 2073  al, the output s
+00020590: 6861 7065 2069 7320 6060 286d 2c6e 2c6b  hape is ``(m,n,k
+000205a0: 2c4e 2960 602e 0d0a 2020 2020 2020 4966  ,N)``...      If
+000205b0: 206e 6f20 7368 6170 6520 6973 2073 7065   no shape is spe
+000205c0: 6369 6669 6564 2c20 6120 7369 6e67 6c65  cified, a single
+000205d0: 2028 604e 602d 4429 2073 616d 706c 6520   (`N`-D) sample 
+000205e0: 6973 2072 6574 7572 6e65 642e 0d0a 2020  is returned...  
+000205f0: 6d65 7468 6f64 203a 207b 2763 686f 6c65  method : {'chole
+00020600: 736b 7927 2c20 2765 6967 277d 2c20 6f70  sky', 'eig'}, op
+00020610: 7469 6f6e 616c 0d0a 2020 2020 2020 5468  tional..      Th
+00020620: 6520 6d65 7468 6f64 2075 7365 6420 746f  e method used to
+00020630: 2067 656e 6572 6174 6520 7468 6520 7261   generate the ra
+00020640: 6e64 6f6d 2073 616d 706c 6573 2e20 2054  ndom samples.  T
+00020650: 6865 2064 6566 6175 6c74 2069 7320 2763  he default is 'c
+00020660: 686f 6c65 736b 7927 2e0d 0a20 206b 6579  holesky'...  key
+00020670: 203a 2050 524e 474b 6579 2c20 6f70 7469   : PRNGKey, opti
+00020680: 6f6e 616c 0d0a 2020 2020 2020 5468 6520  onal..      The 
+00020690: 6b65 7920 666f 7220 7468 6520 7261 6e64  key for the rand
+000206a0: 6f6d 206e 756d 6265 7220 6765 6e65 7261  om number genera
+000206b0: 746f 722e 2049 6620 6e6f 7420 6769 7665  tor. If not give
+000206c0: 6e2c 2074 6865 0d0a 2020 2020 2020 6465  n, the..      de
+000206d0: 6661 756c 7420 7261 6e64 6f6d 206e 756d  fault random num
+000206e0: 6265 7220 6765 6e65 7261 746f 7220 6973  ber generator is
+000206f0: 2075 7365 642e 0d0a 2020 6474 7970 6520   used...  dtype 
+00020700: 3a20 6461 7461 2d74 7970 652c 206f 7074  : data-type, opt
+00020710: 696f 6e61 6c0d 0a20 2020 2020 2054 6865  ional..      The
+00020720: 2064 6573 6972 6564 2064 6174 612d 7479   desired data-ty
+00020730: 7065 2066 6f72 2074 6865 206f 7574 7075  pe for the outpu
+00020740: 742e 2044 6566 6175 6c74 2069 7320 6066  t. Default is `f
+00020750: 6c6f 6174 3332 602e 0d0a 0d0a 2020 5265  loat32`.....  Re
+00020760: 7475 726e 730d 0a20 202d 2d2d 2d2d 2d2d  turns..  -------
+00020770: 0d0a 2020 6f75 7420 3a20 6e64 6172 7261  ..  out : ndarra
+00020780: 790d 0a20 2020 2020 2054 6865 2064 7261  y..      The dra
+00020790: 776e 2073 616d 706c 6573 2c20 6f66 2073  wn samples, of s
+000207a0: 6861 7065 202a 7369 7a65 2a2c 2069 6620  hape *size*, if 
+000207b0: 7468 6174 2077 6173 2070 726f 7669 6465  that was provide
+000207c0: 642e 2020 4966 206e 6f74 2c0d 0a20 2020  d.  If not,..   
+000207d0: 2020 2074 6865 2073 6861 7065 2069 7320     the shape is 
+000207e0: 6060 284e 2c29 6060 2e0d 0a0d 0a20 2020  ``(N,)``.....   
+000207f0: 2020 2049 6e20 6f74 6865 7220 776f 7264     In other word
+00020800: 732c 2065 6163 6820 656e 7472 7920 6060  s, each entry ``
+00020810: 6f75 745b 692c 6a2c 2e2e 2e2c 3a5d 6060  out[i,j,...,:]``
+00020820: 2069 7320 616e 204e 2d64 696d 656e 7369   is an N-dimensi
+00020830: 6f6e 616c 0d0a 2020 2020 2020 7661 6c75  onal..      valu
+00020840: 6520 6472 6177 6e20 6672 6f6d 2074 6865  e drawn from the
+00020850: 2064 6973 7472 6962 7574 696f 6e2e 0d0a   distribution...
+00020860: 0d0a 2020 4e6f 7465 730d 0a20 202d 2d2d  ..  Notes..  ---
+00020870: 2d2d 0d0a 2020 5468 6520 6d65 616e 2069  --..  The mean i
+00020880: 7320 6120 636f 6f72 6469 6e61 7465 2069  s a coordinate i
+00020890: 6e20 4e2d 6469 6d65 6e73 696f 6e61 6c20  n N-dimensional 
+000208a0: 7370 6163 652c 2077 6869 6368 2072 6570  space, which rep
+000208b0: 7265 7365 6e74 7320 7468 650d 0a20 206c  resents the..  l
+000208c0: 6f63 6174 696f 6e20 7768 6572 6520 7361  ocation where sa
+000208d0: 6d70 6c65 7320 6172 6520 6d6f 7374 206c  mples are most l
+000208e0: 696b 656c 7920 746f 2062 6520 6765 6e65  ikely to be gene
+000208f0: 7261 7465 642e 2020 5468 6973 2069 730d  rated.  This is.
+00020900: 0a20 2061 6e61 6c6f 676f 7573 2074 6f20  .  analogous to 
+00020910: 7468 6520 7065 616b 206f 6620 7468 6520  the peak of the 
+00020920: 6265 6c6c 2063 7572 7665 2066 6f72 2074  bell curve for t
+00020930: 6865 206f 6e65 2d64 696d 656e 7369 6f6e  he one-dimension
+00020940: 616c 206f 720d 0a20 2075 6e69 7661 7269  al or..  univari
+00020950: 6174 6520 6e6f 726d 616c 2064 6973 7472  ate normal distr
+00020960: 6962 7574 696f 6e2e 0d0a 0d0a 2020 436f  ibution.....  Co
+00020970: 7661 7269 616e 6365 2069 6e64 6963 6174  variance indicat
+00020980: 6573 2074 6865 206c 6576 656c 2074 6f20  es the level to 
+00020990: 7768 6963 6820 7477 6f20 7661 7269 6162  which two variab
+000209a0: 6c65 7320 7661 7279 2074 6f67 6574 6865  les vary togethe
+000209b0: 722e 0d0a 2020 4672 6f6d 2074 6865 206d  r...  From the m
+000209c0: 756c 7469 7661 7269 6174 6520 6e6f 726d  ultivariate norm
+000209d0: 616c 2064 6973 7472 6962 7574 696f 6e2c  al distribution,
+000209e0: 2077 6520 6472 6177 204e 2d64 696d 656e   we draw N-dimen
+000209f0: 7369 6f6e 616c 0d0a 2020 7361 6d70 6c65  sional..  sample
+00020a00: 732c 203a 6d61 7468 3a60 5820 3d20 5b78  s, :math:`X = [x
+00020a10: 5f31 2c20 785f 322c 202e 2e2e 2078 5f4e  _1, x_2, ... x_N
+00020a20: 5d60 2e20 2054 6865 2063 6f76 6172 6961  ]`.  The covaria
+00020a30: 6e63 6520 6d61 7472 6978 0d0a 2020 656c  nce matrix..  el
+00020a40: 656d 656e 7420 3a6d 6174 683a 6043 5f7b  ement :math:`C_{
+00020a50: 696a 7d60 2069 7320 7468 6520 636f 7661  ij}` is the cova
+00020a60: 7269 616e 6365 206f 6620 3a6d 6174 683a  riance of :math:
+00020a70: 6078 5f69 6020 616e 6420 3a6d 6174 683a  `x_i` and :math:
+00020a80: 6078 5f6a 602e 0d0a 2020 5468 6520 656c  `x_j`...  The el
+00020a90: 656d 656e 7420 3a6d 6174 683a 6043 5f7b  ement :math:`C_{
+00020aa0: 6969 7d60 2069 7320 7468 6520 7661 7269  ii}` is the vari
+00020ab0: 616e 6365 206f 6620 3a6d 6174 683a 6078  ance of :math:`x
+00020ac0: 5f69 6020 2869 2e65 2e20 6974 730d 0a20  _i` (i.e. its.. 
+00020ad0: 2022 7370 7265 6164 2229 2e0d 0a0d 0a20   "spread")..... 
+00020ae0: 2049 6e73 7465 6164 206f 6620 7370 6563   Instead of spec
+00020af0: 6966 7969 6e67 2074 6865 2066 756c 6c20  ifying the full 
+00020b00: 636f 7661 7269 616e 6365 206d 6174 7269  covariance matri
+00020b10: 782c 2070 6f70 756c 6172 0d0a 2020 6170  x, popular..  ap
+00020b20: 7072 6f78 696d 6174 696f 6e73 2069 6e63  proximations inc
+00020b30: 6c75 6465 3a0d 0a0d 0a20 2020 202d 2053  lude:....    - S
+00020b40: 7068 6572 6963 616c 2063 6f76 6172 6961  pherical covaria
+00020b50: 6e63 6520 2860 636f 7660 2069 7320 6120  nce (`cov` is a 
+00020b60: 6d75 6c74 6970 6c65 206f 6620 7468 6520  multiple of the 
+00020b70: 6964 656e 7469 7479 206d 6174 7269 7829  identity matrix)
+00020b80: 0d0a 2020 2020 2d20 4469 6167 6f6e 616c  ..    - Diagonal
+00020b90: 2063 6f76 6172 6961 6e63 6520 2860 636f   covariance (`co
+00020ba0: 7660 2068 6173 206e 6f6e 2d6e 6567 6174  v` has non-negat
+00020bb0: 6976 6520 656c 656d 656e 7473 2c20 616e  ive elements, an
+00020bc0: 6420 6f6e 6c79 206f 6e0d 0a20 2020 2020  d only on..     
+00020bd0: 2074 6865 2064 6961 676f 6e61 6c29 0d0a   the diagonal)..
+00020be0: 0d0a 2020 5468 6973 2067 656f 6d65 7472  ..  This geometr
+00020bf0: 6963 616c 2070 726f 7065 7274 7920 6361  ical property ca
+00020c00: 6e20 6265 2073 6565 6e20 696e 2074 776f  n be seen in two
+00020c10: 2064 696d 656e 7369 6f6e 7320 6279 2070   dimensions by p
+00020c20: 6c6f 7474 696e 670d 0a20 2067 656e 6572  lotting..  gener
+00020c30: 6174 6564 2064 6174 612d 706f 696e 7473  ated data-points
+00020c40: 3a0d 0a0d 0a20 203e 3e3e 206d 6561 6e20  :....  >>> mean 
+00020c50: 3d20 5b30 2c20 305d 0d0a 2020 3e3e 3e20  = [0, 0]..  >>> 
+00020c60: 636f 7620 3d20 5b5b 312c 2030 5d2c 205b  cov = [[1, 0], [
+00020c70: 302c 2031 3030 5d5d 2020 2320 6469 6167  0, 100]]  # diag
+00020c80: 6f6e 616c 2063 6f76 6172 6961 6e63 650d  onal covariance.
+00020c90: 0a0d 0a20 2044 6961 676f 6e61 6c20 636f  ...  Diagonal co
+00020ca0: 7661 7269 616e 6365 206d 6561 6e73 2074  variance means t
+00020cb0: 6861 7420 706f 696e 7473 2061 7265 206f  hat points are o
+00020cc0: 7269 656e 7465 6420 616c 6f6e 6720 7820  riented along x 
+00020cd0: 6f72 2079 2d61 7869 733a 0d0a 0d0a 2020  or y-axis:....  
+00020ce0: 3e3e 3e20 696d 706f 7274 206d 6174 706c  >>> import matpl
+00020cf0: 6f74 6c69 622e 7079 706c 6f74 2061 7320  otlib.pyplot as 
+00020d00: 706c 7420 2023 206e 6f71 610d 0a20 203e  plt  # noqa..  >
+00020d10: 3e3e 2078 2c20 7920 3d20 6272 6169 6e63  >> x, y = brainc
+00020d20: 6f72 652e 7261 6e64 6f6d 2e6d 756c 7469  ore.random.multi
+00020d30: 7661 7269 6174 655f 6e6f 726d 616c 286d  variate_normal(m
+00020d40: 6561 6e2c 2063 6f76 2c20 3530 3030 292e  ean, cov, 5000).
+00020d50: 540d 0a20 203e 3e3e 2070 6c74 2e70 6c6f  T..  >>> plt.plo
+00020d60: 7428 782c 2079 2c20 2778 2729 0d0a 2020  t(x, y, 'x')..  
+00020d70: 3e3e 3e20 706c 742e 6178 6973 2827 6571  >>> plt.axis('eq
+00020d80: 7561 6c27 290d 0a20 203e 3e3e 2070 6c74  ual')..  >>> plt
+00020d90: 2e73 686f 7728 290d 0a0d 0a20 204e 6f74  .show()....  Not
+00020da0: 6520 7468 6174 2074 6865 2063 6f76 6172  e that the covar
+00020db0: 6961 6e63 6520 6d61 7472 6978 206d 7573  iance matrix mus
+00020dc0: 7420 6265 2070 6f73 6974 6976 6520 7365  t be positive se
+00020dd0: 6d69 6465 6669 6e69 7465 2028 612e 6b2e  midefinite (a.k.
+00020de0: 612e 0d0a 2020 6e6f 6e6e 6567 6174 6976  a...  nonnegativ
+00020df0: 652d 6465 6669 6e69 7465 292e 204f 7468  e-definite). Oth
+00020e00: 6572 7769 7365 2c20 7468 6520 6265 6861  erwise, the beha
+00020e10: 7669 6f72 206f 6620 7468 6973 206d 6574  vior of this met
+00020e20: 686f 6420 6973 0d0a 2020 756e 6465 6669  hod is..  undefi
+00020e30: 6e65 6420 616e 6420 6261 636b 7761 7264  ned and backward
+00020e40: 7320 636f 6d70 6174 6962 696c 6974 7920  s compatibility 
+00020e50: 6973 206e 6f74 2067 7561 7261 6e74 6565  is not guarantee
+00020e60: 642e 0d0a 0d0a 2020 5265 6665 7265 6e63  d.....  Referenc
+00020e70: 6573 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d  es..  ----------
+00020e80: 0d0a 2020 2e2e 205b 315d 2050 6170 6f75  ..  .. [1] Papou
+00020e90: 6c69 732c 2041 2e2c 2022 5072 6f62 6162  lis, A., "Probab
+00020ea0: 696c 6974 792c 2052 616e 646f 6d20 5661  ility, Random Va
+00020eb0: 7269 6162 6c65 732c 2061 6e64 2053 746f  riables, and Sto
+00020ec0: 6368 6173 7469 630d 0a20 2020 2020 2020  chastic..       
+00020ed0: 2020 5072 6f63 6573 7365 732c 2220 3372    Processes," 3r
+00020ee0: 6420 6564 2e2c 204e 6577 2059 6f72 6b3a  d ed., New York:
+00020ef0: 204d 6347 7261 772d 4869 6c6c 2c20 3139   McGraw-Hill, 19
+00020f00: 3931 2e0d 0a20 202e 2e20 5b32 5d20 4475  91...  .. [2] Du
+00020f10: 6461 2c20 522e 204f 2e2c 2048 6172 742c  da, R. O., Hart,
+00020f20: 2050 2e20 452e 2c20 616e 6420 5374 6f72   P. E., and Stor
+00020f30: 6b2c 2044 2e20 472e 2c20 2250 6174 7465  k, D. G., "Patte
+00020f40: 726e 0d0a 2020 2020 2020 2020 2043 6c61  rn..         Cla
+00020f50: 7373 6966 6963 6174 696f 6e2c 2220 326e  ssification," 2n
+00020f60: 6420 6564 2e2c 204e 6577 2059 6f72 6b3a  d ed., New York:
+00020f70: 2057 696c 6579 2c20 3230 3031 2e0d 0a0d   Wiley, 2001....
+00020f80: 0a20 2045 7861 6d70 6c65 730d 0a20 202d  .  Examples..  -
+00020f90: 2d2d 2d2d 2d2d 2d0d 0a20 203e 3e3e 206d  -------..  >>> m
+00020fa0: 6561 6e20 3d20 2831 2c20 3229 0d0a 2020  ean = (1, 2)..  
+00020fb0: 3e3e 3e20 636f 7620 3d20 5b5b 312c 2030  >>> cov = [[1, 0
+00020fc0: 5d2c 205b 302c 2031 5d5d 0d0a 2020 3e3e  ], [0, 1]]..  >>
+00020fd0: 3e20 7820 3d20 6272 6169 6e63 6f72 652e  > x = braincore.
+00020fe0: 7261 6e64 6f6d 2e6d 756c 7469 7661 7269  random.multivari
+00020ff0: 6174 655f 6e6f 726d 616c 286d 6561 6e2c  ate_normal(mean,
+00021000: 2063 6f76 2c20 2833 2c20 3329 290d 0a20   cov, (3, 3)).. 
+00021010: 203e 3e3e 2078 2e73 6861 7065 0d0a 2020   >>> x.shape..  
+00021020: 2833 2c20 332c 2032 290d 0a0d 0a20 2048  (3, 3, 2)....  H
+00021030: 6572 6520 7765 2067 656e 6572 6174 6520  ere we generate 
+00021040: 3830 3020 7361 6d70 6c65 7320 6672 6f6d  800 samples from
+00021050: 2074 6865 2062 6976 6172 6961 7465 206e   the bivariate n
+00021060: 6f72 6d61 6c20 6469 7374 7269 6275 7469  ormal distributi
+00021070: 6f6e 0d0a 2020 7769 7468 206d 6561 6e20  on..  with mean 
+00021080: 5b30 2c20 305d 2061 6e64 2063 6f76 6172  [0, 0] and covar
+00021090: 6961 6e63 6520 6d61 7472 6978 205b 5b36  iance matrix [[6
+000210a0: 2c20 2d33 5d2c 205b 2d33 2c20 332e 355d  , -3], [-3, 3.5]
+000210b0: 5d2e 2020 5468 650d 0a20 2065 7870 6563  ].  The..  expec
+000210c0: 7465 6420 7661 7269 616e 6365 7320 6f66  ted variances of
+000210d0: 2074 6865 2066 6972 7374 2061 6e64 2073   the first and s
+000210e0: 6563 6f6e 6420 636f 6d70 6f6e 656e 7473  econd components
+000210f0: 206f 6620 7468 6520 7361 6d70 6c65 0d0a   of the sample..
+00021100: 2020 6172 6520 3620 616e 6420 332e 352c    are 6 and 3.5,
+00021110: 2072 6573 7065 6374 6976 656c 792c 2061   respectively, a
+00021120: 6e64 2074 6865 2065 7870 6563 7465 6420  nd the expected 
+00021130: 636f 7272 656c 6174 696f 6e0d 0a20 2063  correlation..  c
+00021140: 6f65 6666 6963 6965 6e74 2069 7320 2d33  oefficient is -3
+00021150: 2f73 7172 7428 362a 332e 3529 20e2 8988  /sqrt(6*3.5) ...
+00021160: 202d 302e 3635 3436 352e 0d0a 0d0a 2020   -0.65465.....  
+00021170: 3e3e 3e20 636f 7620 3d20 6e70 2e61 7272  >>> cov = np.arr
+00021180: 6179 285b 5b36 2c20 2d33 5d2c 205b 2d33  ay([[6, -3], [-3
+00021190: 2c20 332e 355d 5d29 0d0a 2020 3e3e 3e20  , 3.5]])..  >>> 
+000211a0: 7074 7320 3d20 6272 6169 6e63 6f72 652e  pts = braincore.
+000211b0: 7261 6e64 6f6d 2e6d 756c 7469 7661 7269  random.multivari
+000211c0: 6174 655f 6e6f 726d 616c 285b 302c 2030  ate_normal([0, 0
+000211d0: 5d2c 2063 6f76 2c20 7369 7a65 3d38 3030  ], cov, size=800
+000211e0: 290d 0a0d 0a20 2043 6865 636b 2074 6861  )....  Check tha
+000211f0: 7420 7468 6520 6d65 616e 2c20 636f 7661  t the mean, cova
+00021200: 7269 616e 6365 2c20 616e 6420 636f 7272  riance, and corr
+00021210: 656c 6174 696f 6e20 636f 6566 6669 6369  elation coeffici
+00021220: 656e 7420 6f66 2074 6865 0d0a 2020 7361  ent of the..  sa
+00021230: 6d70 6c65 2061 7265 2063 6c6f 7365 2074  mple are close t
+00021240: 6f20 7468 6520 6578 7065 6374 6564 2076  o the expected v
+00021250: 616c 7565 733a 0d0a 0d0a 2020 3e3e 3e20  alues:....  >>> 
+00021260: 7074 732e 6d65 616e 2861 7869 733d 3029  pts.mean(axis=0)
+00021270: 0d0a 2020 6172 7261 7928 5b20 302e 3033  ..  array([ 0.03
+00021280: 3236 3931 3120 2c20 2d30 2e30 3132 3830  26911 , -0.01280
+00021290: 3738 325d 2920 2023 206d 6179 2076 6172  782])  # may var
+000212a0: 790d 0a20 203e 3e3e 206e 702e 636f 7628  y..  >>> np.cov(
+000212b0: 7074 732e 5429 0d0a 2020 6172 7261 7928  pts.T)..  array(
+000212c0: 5b5b 2035 2e39 3632 3032 3339 372c 202d  [[ 5.96202397, -
+000212d0: 322e 3835 3630 3232 3837 5d2c 0d0a 2020  2.85602287],..  
+000212e0: 2020 2020 2020 205b 2d32 2e38 3536 3032         [-2.85602
+000212f0: 3238 372c 2020 332e 3437 3631 3339 3439  287,  3.47613949
+00021300: 5d5d 2920 2023 206d 6179 2076 6172 790d  ]])  # may vary.
+00021310: 0a20 203e 3e3e 206e 702e 636f 7272 636f  .  >>> np.corrco
+00021320: 6566 2870 7473 2e54 295b 302c 2031 5d0d  ef(pts.T)[0, 1].
+00021330: 0a20 202d 302e 3632 3733 3539 3133 3134  .  -0.6273591314
+00021340: 3630 3339 3439 2020 2320 6d61 7920 7661  603949  # may va
+00021350: 7279 0d0a 0d0a 2020 5765 2063 616e 2076  ry....  We can v
+00021360: 6973 7561 6c69 7a65 2074 6869 7320 6461  isualize this da
+00021370: 7461 2077 6974 6820 6120 7363 6174 7465  ta with a scatte
+00021380: 7220 706c 6f74 2e20 2054 6865 206f 7269  r plot.  The ori
+00021390: 656e 7461 7469 6f6e 0d0a 2020 6f66 2074  entation..  of t
+000213a0: 6865 2070 6f69 6e74 2063 6c6f 7564 2069  he point cloud i
+000213b0: 6c6c 7573 7472 6174 6573 2074 6865 206e  llustrates the n
+000213c0: 6567 6174 6976 6520 636f 7272 656c 6174  egative correlat
+000213d0: 696f 6e20 6f66 2074 6865 0d0a 2020 636f  ion of the..  co
+000213e0: 6d70 6f6e 656e 7473 206f 6620 7468 6973  mponents of this
+000213f0: 2073 616d 706c 652e 0d0a 0d0a 2020 3e3e   sample.....  >>
+00021400: 3e20 696d 706f 7274 206d 6174 706c 6f74  > import matplot
+00021410: 6c69 622e 7079 706c 6f74 2061 7320 706c  lib.pyplot as pl
+00021420: 7420 2023 206e 6f71 610d 0a20 203e 3e3e  t  # noqa..  >>>
+00021430: 2070 6c74 2e70 6c6f 7428 7074 735b 3a2c   plt.plot(pts[:,
+00021440: 2030 5d2c 2070 7473 5b3a 2c20 315d 2c20   0], pts[:, 1], 
+00021450: 272e 272c 2061 6c70 6861 3d30 2e35 290d  '.', alpha=0.5).
+00021460: 0a20 203e 3e3e 2070 6c74 2e61 7869 7328  .  >>> plt.axis(
+00021470: 2765 7175 616c 2729 0d0a 2020 3e3e 3e20  'equal')..  >>> 
+00021480: 706c 742e 6772 6964 2829 0d0a 2020 3e3e  plt.grid()..  >>
+00021490: 3e20 706c 742e 7368 6f77 2829 0d0a 2020  > plt.show()..  
+000214a0: 2222 220d 0a20 2072 6574 7572 6e20 4445  """..  return DE
+000214b0: 4641 554c 542e 6d75 6c74 6976 6172 6961  FAULT.multivaria
+000214c0: 7465 5f6e 6f72 6d61 6c28 6d65 616e 2c20  te_normal(mean, 
+000214d0: 636f 762c 2073 697a 652c 206d 6574 686f  cov, size, metho
+000214e0: 642c 206b 6579 3d6b 6579 2c20 6474 7970  d, key=key, dtyp
+000214f0: 653d 6474 7970 6529 0d0a 0d0a 0d0a 6465  e=dtype)......de
+00021500: 6620 6e65 6761 7469 7665 5f62 696e 6f6d  f negative_binom
+00021510: 6961 6c28 6e2c 0d0a 2020 2020 2020 2020  ial(n,..        
+00021520: 2020 2020 2020 2020 2020 2020 2020 702c                p,
+00021530: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00021540: 2020 2020 2020 2020 7369 7a65 3a20 4f70          size: Op
+00021550: 7469 6f6e 616c 5b53 697a 655d 203d 204e  tional[Size] = N
+00021560: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+00021570: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
+00021580: 204f 7074 696f 6e61 6c5b 5365 6564 4f72   Optional[SeedOr
+00021590: 4b65 795d 203d 204e 6f6e 652c 0d0a 2020  Key] = None,..  
+000215a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000215b0: 2020 2020 6474 7970 653a 2044 5479 7065      dtype: DType
+000215c0: 4c69 6b65 203d 204e 6f6e 6529 3a0d 0a20  Like = None):.. 
+000215d0: 2072 2222 220d 0a20 2044 7261 7720 7361   r"""..  Draw sa
+000215e0: 6d70 6c65 7320 6672 6f6d 2061 206e 6567  mples from a neg
+000215f0: 6174 6976 6520 6269 6e6f 6d69 616c 2064  ative binomial d
+00021600: 6973 7472 6962 7574 696f 6e2e 0d0a 0d0a  istribution.....
+00021610: 2020 5361 6d70 6c65 7320 6172 6520 6472    Samples are dr
+00021620: 6177 6e20 6672 6f6d 2061 206e 6567 6174  awn from a negat
+00021630: 6976 6520 6269 6e6f 6d69 616c 2064 6973  ive binomial dis
+00021640: 7472 6962 7574 696f 6e20 7769 7468 2073  tribution with s
+00021650: 7065 6369 6669 6564 0d0a 2020 7061 7261  pecified..  para
+00021660: 6d65 7465 7273 2c20 606e 6020 7375 6363  meters, `n` succ
+00021670: 6573 7365 7320 616e 6420 6070 6020 7072  esses and `p` pr
+00021680: 6f62 6162 696c 6974 7920 6f66 2073 7563  obability of suc
+00021690: 6365 7373 2077 6865 7265 2060 6e60 0d0a  cess where `n`..
+000216a0: 2020 6973 203e 2030 2061 6e64 2060 7060    is > 0 and `p`
+000216b0: 2069 7320 696e 2074 6865 2069 6e74 6572   is in the inter
+000216c0: 7661 6c20 5b30 2c20 315d 2e0d 0a0d 0a20  val [0, 1]..... 
+000216d0: 2050 6172 616d 6574 6572 730d 0a20 202d   Parameters..  -
+000216e0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 206e 203a  ---------..  n :
+000216f0: 2066 6c6f 6174 206f 7220 6172 7261 795f   float or array_
+00021700: 6c69 6b65 206f 6620 666c 6f61 7473 0d0a  like of floats..
+00021710: 2020 2020 2020 5061 7261 6d65 7465 7220        Parameter 
+00021720: 6f66 2074 6865 2064 6973 7472 6962 7574  of the distribut
+00021730: 696f 6e2c 203e 2030 2e0d 0a20 2070 203a  ion, > 0...  p :
+00021740: 2066 6c6f 6174 206f 7220 6172 7261 795f   float or array_
+00021750: 6c69 6b65 206f 6620 666c 6f61 7473 0d0a  like of floats..
+00021760: 2020 2020 2020 5061 7261 6d65 7465 7220        Parameter 
+00021770: 6f66 2074 6865 2064 6973 7472 6962 7574  of the distribut
+00021780: 696f 6e2c 203e 3d20 3020 616e 6420 3c3d  ion, >= 0 and <=
+00021790: 312e 0d0a 2020 7369 7a65 203a 2069 6e74  1...  size : int
+000217a0: 206f 7220 7475 706c 6520 6f66 2069 6e74   or tuple of int
+000217b0: 732c 206f 7074 696f 6e61 6c0d 0a20 2020  s, optional..   
+000217c0: 2020 204f 7574 7075 7420 7368 6170 652e     Output shape.
+000217d0: 2020 4966 2074 6865 2067 6976 656e 2073    If the given s
+000217e0: 6861 7065 2069 732c 2065 2e67 2e2c 2060  hape is, e.g., `
+000217f0: 6028 6d2c 206e 2c20 6b29 6060 2c20 7468  `(m, n, k)``, th
+00021800: 656e 0d0a 2020 2020 2020 6060 6d20 2a20  en..      ``m * 
+00021810: 6e20 2a20 6b60 6020 7361 6d70 6c65 7320  n * k`` samples 
+00021820: 6172 6520 6472 6177 6e2e 2020 4966 2073  are drawn.  If s
+00021830: 697a 6520 6973 2060 604e 6f6e 6560 6020  ize is ``None`` 
+00021840: 2864 6566 6175 6c74 292c 0d0a 2020 2020  (default),..    
+00021850: 2020 6120 7369 6e67 6c65 2076 616c 7565    a single value
+00021860: 2069 7320 7265 7475 726e 6564 2069 6620   is returned if 
+00021870: 6060 6e60 6020 616e 6420 6060 7060 6020  ``n`` and ``p`` 
+00021880: 6172 6520 626f 7468 2073 6361 6c61 7273  are both scalars
+00021890: 2e0d 0a20 2020 2020 204f 7468 6572 7769  ...      Otherwi
+000218a0: 7365 2c20 6060 6e70 2e62 726f 6164 6361  se, ``np.broadca
+000218b0: 7374 286e 2c20 7029 2e73 697a 6560 6020  st(n, p).size`` 
+000218c0: 7361 6d70 6c65 7320 6172 6520 6472 6177  samples are draw
+000218d0: 6e2e 0d0a 2020 6b65 7920 3a20 5052 4e47  n...  key : PRNG
+000218e0: 4b65 792c 206f 7074 696f 6e61 6c0d 0a20  Key, optional.. 
+000218f0: 2020 2020 2054 6865 206b 6579 2066 6f72       The key for
+00021900: 2074 6865 2072 616e 646f 6d20 6e75 6d62   the random numb
+00021910: 6572 2067 656e 6572 6174 6f72 2e20 4966  er generator. If
+00021920: 206e 6f74 2067 6976 656e 2c20 7468 650d   not given, the.
+00021930: 0a20 2020 2020 2064 6566 6175 6c74 2072  .      default r
+00021940: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
+00021950: 6572 6174 6f72 2069 7320 7573 6564 2e0d  erator is used..
+00021960: 0a0d 0a20 2052 6574 7572 6e73 0d0a 2020  ...  Returns..  
+00021970: 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574 203a  -------..  out :
+00021980: 206e 6461 7272 6179 206f 7220 7363 616c   ndarray or scal
+00021990: 6172 0d0a 2020 2020 2020 4472 6177 6e20  ar..      Drawn 
+000219a0: 7361 6d70 6c65 7320 6672 6f6d 2074 6865  samples from the
+000219b0: 2070 6172 616d 6574 6572 697a 6564 206e   parameterized n
+000219c0: 6567 6174 6976 6520 6269 6e6f 6d69 616c  egative binomial
+000219d0: 2064 6973 7472 6962 7574 696f 6e2c 0d0a   distribution,..
+000219e0: 2020 2020 2020 7768 6572 6520 6561 6368        where each
+000219f0: 2073 616d 706c 6520 6973 2065 7175 616c   sample is equal
+00021a00: 2074 6f20 4e2c 2074 6865 206e 756d 6265   to N, the numbe
+00021a10: 7220 6f66 2066 6169 6c75 7265 7320 7468  r of failures th
+00021a20: 6174 0d0a 2020 2020 2020 6f63 6375 7272  at..      occurr
+00021a30: 6564 2062 6566 6f72 6520 6120 746f 7461  ed before a tota
+00021a40: 6c20 6f66 206e 2073 7563 6365 7373 6573  l of n successes
+00021a50: 2077 6173 2072 6561 6368 6564 2e0d 0a0d   was reached....
+00021a60: 0a20 204e 6f74 6573 0d0a 2020 2d2d 2d2d  .  Notes..  ----
+00021a70: 2d0d 0a20 2054 6865 2070 726f 6261 6269  -..  The probabi
+00021a80: 6c69 7479 206d 6173 7320 6675 6e63 7469  lity mass functi
+00021a90: 6f6e 206f 6620 7468 6520 6e65 6761 7469  on of the negati
+00021aa0: 7665 2062 696e 6f6d 6961 6c20 6469 7374  ve binomial dist
+00021ab0: 7269 6275 7469 6f6e 2069 730d 0a0d 0a20  ribution is.... 
+00021ac0: 202e 2e20 6d61 7468 3a3a 2050 284e 3b6e   .. math:: P(N;n
+00021ad0: 2c70 2920 3d20 5c66 7261 637b 5c47 616d  ,p) = \frac{\Gam
+00021ae0: 6d61 284e 2b6e 297d 7b4e 215c 4761 6d6d  ma(N+n)}{N!\Gamm
+00021af0: 6128 6e29 7d70 5e7b 6e7d 2831 2d70 295e  a(n)}p^{n}(1-p)^
+00021b00: 7b4e 7d2c 0d0a 0d0a 2020 7768 6572 6520  {N},....  where 
+00021b10: 3a6d 6174 683a 606e 6020 6973 2074 6865  :math:`n` is the
+00021b20: 206e 756d 6265 7220 6f66 2073 7563 6365   number of succe
+00021b30: 7373 6573 2c20 3a6d 6174 683a 6070 6020  sses, :math:`p` 
+00021b40: 6973 2074 6865 0d0a 2020 7072 6f62 6162  is the..  probab
+00021b50: 696c 6974 7920 6f66 2073 7563 6365 7373  ility of success
+00021b60: 2c20 3a6d 6174 683a 604e 2b6e 6020 6973  , :math:`N+n` is
+00021b70: 2074 6865 206e 756d 6265 7220 6f66 2074   the number of t
+00021b80: 7269 616c 732c 2061 6e64 0d0a 2020 3a6d  rials, and..  :m
+00021b90: 6174 683a 605c 4761 6d6d 6160 2069 7320  ath:`\Gamma` is 
+00021ba0: 7468 6520 6761 6d6d 6120 6675 6e63 7469  the gamma functi
+00021bb0: 6f6e 2e20 5768 656e 203a 6d61 7468 3a60  on. When :math:`
+00021bc0: 6e60 2069 7320 616e 2069 6e74 6567 6572  n` is an integer
+00021bd0: 2c0d 0a20 203a 6d61 7468 3a60 5c66 7261  ,..  :math:`\fra
+00021be0: 637b 5c47 616d 6d61 284e 2b6e 297d 7b4e  c{\Gamma(N+n)}{N
+00021bf0: 215c 4761 6d6d 6128 6e29 7d20 3d20 5c62  !\Gamma(n)} = \b
+00021c00: 696e 6f6d 7b4e 2b6e 2d31 7d7b 4e7d 602c  inom{N+n-1}{N}`,
+00021c10: 2077 6869 6368 2069 730d 0a20 2074 6865   which is..  the
+00021c20: 206d 6f72 6520 636f 6d6d 6f6e 2066 6f72   more common for
+00021c30: 6d20 6f66 2074 6869 7320 7465 726d 2069  m of this term i
+00021c40: 6e20 7468 6520 706d 662e 2054 6865 206e  n the pmf. The n
+00021c50: 6567 6174 6976 650d 0a20 2062 696e 6f6d  egative..  binom
+00021c60: 6961 6c20 6469 7374 7269 6275 7469 6f6e  ial distribution
+00021c70: 2067 6976 6573 2074 6865 2070 726f 6261   gives the proba
+00021c80: 6269 6c69 7479 206f 6620 4e20 6661 696c  bility of N fail
+00021c90: 7572 6573 2067 6976 656e 206e 0d0a 2020  ures given n..  
+00021ca0: 7375 6363 6573 7365 732c 2077 6974 6820  successes, with 
+00021cb0: 6120 7375 6363 6573 7320 6f6e 2074 6865  a success on the
+00021cc0: 206c 6173 7420 7472 6961 6c2e 0d0a 0d0a   last trial.....
+00021cd0: 2020 4966 206f 6e65 2074 6872 6f77 7320    If one throws 
+00021ce0: 6120 6469 6520 7265 7065 6174 6564 6c79  a die repeatedly
+00021cf0: 2075 6e74 696c 2074 6865 2074 6869 7264   until the third
+00021d00: 2074 696d 6520 6120 2231 2220 6170 7065   time a "1" appe
+00021d10: 6172 732c 0d0a 2020 7468 656e 2074 6865  ars,..  then the
+00021d20: 2070 726f 6261 6269 6c69 7479 2064 6973   probability dis
+00021d30: 7472 6962 7574 696f 6e20 6f66 2074 6865  tribution of the
+00021d40: 206e 756d 6265 7220 6f66 206e 6f6e 2d22   number of non-"
+00021d50: 3122 7320 7468 6174 0d0a 2020 6170 7065  1"s that..  appe
+00021d60: 6172 2062 6566 6f72 6520 7468 6520 7468  ar before the th
+00021d70: 6972 6420 2231 2220 6973 2061 206e 6567  ird "1" is a neg
+00021d80: 6174 6976 6520 6269 6e6f 6d69 616c 2064  ative binomial d
+00021d90: 6973 7472 6962 7574 696f 6e2e 0d0a 0d0a  istribution.....
+00021da0: 2020 5265 6665 7265 6e63 6573 0d0a 2020    References..  
+00021db0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2e2e  ----------..  ..
+00021dc0: 205b 315d 2057 6569 7373 7465 696e 2c20   [1] Weisstein, 
+00021dd0: 4572 6963 2057 2e20 224e 6567 6174 6976  Eric W. "Negativ
+00021de0: 6520 4269 6e6f 6d69 616c 2044 6973 7472  e Binomial Distr
+00021df0: 6962 7574 696f 6e2e 2220 4672 6f6d 0d0a  ibution." From..
+00021e00: 2020 2020 2020 2020 204d 6174 6857 6f72           MathWor
+00021e10: 6c64 2d2d 4120 576f 6c66 7261 6d20 5765  ld--A Wolfram We
+00021e20: 6220 5265 736f 7572 6365 2e0d 0a20 2020  b Resource...   
+00021e30: 2020 2020 2020 6874 7470 3a2f 2f6d 6174        http://mat
+00021e40: 6877 6f72 6c64 2e77 6f6c 6672 616d 2e63  hworld.wolfram.c
+00021e50: 6f6d 2f4e 6567 6174 6976 6542 696e 6f6d  om/NegativeBinom
+00021e60: 6961 6c44 6973 7472 6962 7574 696f 6e2e  ialDistribution.
+00021e70: 6874 6d6c 0d0a 2020 2e2e 205b 325d 2057  html..  .. [2] W
+00021e80: 696b 6970 6564 6961 2c20 224e 6567 6174  ikipedia, "Negat
+00021e90: 6976 6520 6269 6e6f 6d69 616c 2064 6973  ive binomial dis
+00021ea0: 7472 6962 7574 696f 6e22 2c0d 0a20 2020  tribution",..   
+00021eb0: 2020 2020 2020 6874 7470 733a 2f2f 656e        https://en
+00021ec0: 2e77 696b 6970 6564 6961 2e6f 7267 2f77  .wikipedia.org/w
+00021ed0: 696b 692f 4e65 6761 7469 7665 5f62 696e  iki/Negative_bin
+00021ee0: 6f6d 6961 6c5f 6469 7374 7269 6275 7469  omial_distributi
+00021ef0: 6f6e 0d0a 0d0a 2020 4578 616d 706c 6573  on....  Examples
+00021f00: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ..  --------..  
+00021f10: 4472 6177 2073 616d 706c 6573 2066 726f  Draw samples fro
+00021f20: 6d20 7468 6520 6469 7374 7269 6275 7469  m the distributi
+00021f30: 6f6e 3a0d 0a0d 0a20 2041 2072 6561 6c20  on:....  A real 
+00021f40: 776f 726c 6420 6578 616d 706c 652e 2041  world example. A
+00021f50: 2063 6f6d 7061 6e79 2064 7269 6c6c 7320   company drills 
+00021f60: 7769 6c64 2d63 6174 206f 696c 0d0a 2020  wild-cat oil..  
+00021f70: 6578 706c 6f72 6174 696f 6e20 7765 6c6c  exploration well
+00021f80: 732c 2065 6163 6820 7769 7468 2061 6e20  s, each with an 
+00021f90: 6573 7469 6d61 7465 6420 7072 6f62 6162  estimated probab
+00021fa0: 696c 6974 7920 6f66 0d0a 2020 7375 6363  ility of..  succ
+00021fb0: 6573 7320 6f66 2030 2e31 2e20 2057 6861  ess of 0.1.  Wha
+00021fc0: 7420 6973 2074 6865 2070 726f 6261 6269  t is the probabi
+00021fd0: 6c69 7479 206f 6620 6861 7669 6e67 206f  lity of having o
+00021fe0: 6e65 2073 7563 6365 7373 0d0a 2020 666f  ne success..  fo
+00021ff0: 7220 6561 6368 2073 7563 6365 7373 6976  r each successiv
+00022000: 6520 7765 6c6c 2c20 7468 6174 2069 7320  e well, that is 
+00022010: 7768 6174 2069 7320 7468 6520 7072 6f62  what is the prob
+00022020: 6162 696c 6974 7920 6f66 2061 0d0a 2020  ability of a..  
+00022030: 7369 6e67 6c65 2073 7563 6365 7373 2061  single success a
+00022040: 6674 6572 2064 7269 6c6c 696e 6720 3520  fter drilling 5 
+00022050: 7765 6c6c 732c 2061 6674 6572 2036 2077  wells, after 6 w
+00022060: 656c 6c73 2c20 6574 632e 3f0d 0a0d 0a20  ells, etc.?.... 
+00022070: 203e 3e3e 2073 203d 2062 7261 696e 636f   >>> s = brainco
+00022080: 7265 2e72 616e 646f 6d2e 6e65 6761 7469  re.random.negati
+00022090: 7665 5f62 696e 6f6d 6961 6c28 312c 2030  ve_binomial(1, 0
+000220a0: 2e31 2c20 3130 3030 3030 290d 0a20 203e  .1, 100000)..  >
+000220b0: 3e3e 2066 6f72 2069 2069 6e20 7261 6e67  >> for i in rang
+000220c0: 6528 312c 2031 3129 3a20 2320 646f 6374  e(1, 11): # doct
+000220d0: 6573 743a 202b 534b 4950 0d0a 2020 2e2e  est: +SKIP..  ..
+000220e0: 2e20 2020 2070 726f 6261 6269 6c69 7479  .    probability
+000220f0: 203d 2073 756d 2873 3c69 2920 2f20 3130   = sum(s<i) / 10
+00022100: 3030 3030 2e0d 0a20 202e 2e2e 2020 2020  0000...  ...    
+00022110: 7072 696e 7428 692c 2022 7765 6c6c 7320  print(i, "wells 
+00022120: 6472 696c 6c65 642c 2070 726f 6261 6269  drilled, probabi
+00022130: 6c69 7479 206f 6620 6f6e 6520 7375 6363  lity of one succ
+00022140: 6573 7320 3d22 2c20 7072 6f62 6162 696c  ess =", probabil
+00022150: 6974 7929 0d0a 2020 2222 220d 0a20 2072  ity)..  """..  r
+00022160: 6574 7572 6e20 4445 4641 554c 542e 6e65  eturn DEFAULT.ne
+00022170: 6761 7469 7665 5f62 696e 6f6d 6961 6c28  gative_binomial(
+00022180: 6e2c 2070 2c20 7369 7a65 2c20 6b65 793d  n, p, size, key=
+00022190: 6b65 792c 2064 7479 7065 3d64 7479 7065  key, dtype=dtype
+000221a0: 290d 0a0d 0a0d 0a64 6566 206e 6f6e 6365  )......def nonce
+000221b0: 6e74 7261 6c5f 6368 6973 7175 6172 6528  ntral_chisquare(
+000221c0: 6466 2c20 6e6f 6e63 2c20 7369 7a65 3a20  df, nonc, size: 
+000221d0: 4f70 7469 6f6e 616c 5b53 697a 655d 203d  Optional[Size] =
+000221e0: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
+000221f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022200: 206b 6579 3a20 4f70 7469 6f6e 616c 5b53   key: Optional[S
+00022210: 6565 644f 724b 6579 5d20 3d20 4e6f 6e65  eedOrKey] = None
+00022220: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00022230: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
+00022240: 653a 2044 5479 7065 4c69 6b65 203d 204e  e: DTypeLike = N
+00022250: 6f6e 6529 3a0d 0a20 2072 2222 220d 0a20  one):..  r""".. 
+00022260: 2044 7261 7720 7361 6d70 6c65 7320 6672   Draw samples fr
+00022270: 6f6d 2061 206e 6f6e 6365 6e74 7261 6c20  om a noncentral 
+00022280: 6368 692d 7371 7561 7265 2064 6973 7472  chi-square distr
+00022290: 6962 7574 696f 6e2e 0d0a 0d0a 2020 5468  ibution.....  Th
+000222a0: 6520 6e6f 6e63 656e 7472 616c 203a 6d61  e noncentral :ma
+000222b0: 7468 3a60 5c63 6869 5e32 6020 6469 7374  th:`\chi^2` dist
+000222c0: 7269 6275 7469 6f6e 2069 7320 6120 6765  ribution is a ge
+000222d0: 6e65 7261 6c69 7a61 7469 6f6e 206f 660d  neralization of.
+000222e0: 0a20 2074 6865 203a 6d61 7468 3a60 5c63  .  the :math:`\c
+000222f0: 6869 5e32 6020 6469 7374 7269 6275 7469  hi^2` distributi
+00022300: 6f6e 2e0d 0a0d 0a20 2050 6172 616d 6574  on.....  Paramet
+00022310: 6572 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d  ers..  ---------
+00022320: 2d0d 0a20 2064 6620 3a20 666c 6f61 7420  -..  df : float 
+00022330: 6f72 2061 7272 6179 5f6c 696b 6520 6f66  or array_like of
+00022340: 2066 6c6f 6174 730d 0a20 2020 2020 2044   floats..      D
+00022350: 6567 7265 6573 206f 6620 6672 6565 646f  egrees of freedo
+00022360: 6d2c 206d 7573 7420 6265 203e 2030 2e0d  m, must be > 0..
+00022370: 0a20 206e 6f6e 6320 3a20 666c 6f61 7420  .  nonc : float 
+00022380: 6f72 2061 7272 6179 5f6c 696b 6520 6f66  or array_like of
+00022390: 2066 6c6f 6174 730d 0a20 2020 2020 204e   floats..      N
+000223a0: 6f6e 2d63 656e 7472 616c 6974 792c 206d  on-centrality, m
+000223b0: 7573 7420 6265 206e 6f6e 2d6e 6567 6174  ust be non-negat
+000223c0: 6976 652e 0d0a 2020 7369 7a65 203a 2069  ive...  size : i
+000223d0: 6e74 206f 7220 7475 706c 6520 6f66 2069  nt or tuple of i
+000223e0: 6e74 732c 206f 7074 696f 6e61 6c0d 0a20  nts, optional.. 
+000223f0: 2020 2020 204f 7574 7075 7420 7368 6170       Output shap
+00022400: 652e 2020 4966 2074 6865 2067 6976 656e  e.  If the given
+00022410: 2073 6861 7065 2069 732c 2065 2e67 2e2c   shape is, e.g.,
+00022420: 2060 6028 6d2c 206e 2c20 6b29 6060 2c20   ``(m, n, k)``, 
+00022430: 7468 656e 0d0a 2020 2020 2020 6060 6d20  then..      ``m 
+00022440: 2a20 6e20 2a20 6b60 6020 7361 6d70 6c65  * n * k`` sample
+00022450: 7320 6172 6520 6472 6177 6e2e 2020 4966  s are drawn.  If
+00022460: 2073 697a 6520 6973 2060 604e 6f6e 6560   size is ``None`
+00022470: 6020 2864 6566 6175 6c74 292c 0d0a 2020  ` (default),..  
+00022480: 2020 2020 6120 7369 6e67 6c65 2076 616c      a single val
+00022490: 7565 2069 7320 7265 7475 726e 6564 2069  ue is returned i
+000224a0: 6620 6060 6466 6060 2061 6e64 2060 606e  f ``df`` and ``n
+000224b0: 6f6e 6360 6020 6172 6520 626f 7468 2073  onc`` are both s
+000224c0: 6361 6c61 7273 2e0d 0a20 2020 2020 204f  calars...      O
+000224d0: 7468 6572 7769 7365 2c20 6060 6e70 2e62  therwise, ``np.b
+000224e0: 726f 6164 6361 7374 2864 662c 206e 6f6e  roadcast(df, non
+000224f0: 6329 2e73 697a 6560 6020 7361 6d70 6c65  c).size`` sample
+00022500: 7320 6172 6520 6472 6177 6e2e 0d0a 2020  s are drawn...  
+00022510: 6b65 7920 3a20 5052 4e47 4b65 792c 206f  key : PRNGKey, o
+00022520: 7074 696f 6e61 6c0d 0a20 2020 2020 2054  ptional..      T
+00022530: 6865 206b 6579 2066 6f72 2074 6865 2072  he key for the r
+00022540: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
+00022550: 6572 6174 6f72 2e20 4966 206e 6f74 2067  erator. If not g
+00022560: 6976 656e 2c20 7468 650d 0a20 2020 2020  iven, the..     
+00022570: 2064 6566 6175 6c74 2072 616e 646f 6d20   default random 
+00022580: 6e75 6d62 6572 2067 656e 6572 6174 6f72  number generator
+00022590: 2069 7320 7573 6564 2e0d 0a0d 0a20 2052   is used.....  R
+000225a0: 6574 7572 6e73 0d0a 2020 2d2d 2d2d 2d2d  eturns..  ------
+000225b0: 2d0d 0a20 206f 7574 203a 206e 6461 7272  -..  out : ndarr
+000225c0: 6179 206f 7220 7363 616c 6172 0d0a 2020  ay or scalar..  
+000225d0: 2020 2020 4472 6177 6e20 7361 6d70 6c65      Drawn sample
+000225e0: 7320 6672 6f6d 2074 6865 2070 6172 616d  s from the param
+000225f0: 6574 6572 697a 6564 206e 6f6e 6365 6e74  eterized noncent
+00022600: 7261 6c20 6368 692d 7371 7561 7265 2064  ral chi-square d
+00022610: 6973 7472 6962 7574 696f 6e2e 0d0a 0d0a  istribution.....
+00022620: 2020 4e6f 7465 730d 0a20 202d 2d2d 2d2d    Notes..  -----
+00022630: 0d0a 2020 5468 6520 7072 6f62 6162 696c  ..  The probabil
+00022640: 6974 7920 6465 6e73 6974 7920 6675 6e63  ity density func
+00022650: 7469 6f6e 2066 6f72 2074 6865 206e 6f6e  tion for the non
+00022660: 6365 6e74 7261 6c20 4368 692d 7371 7561  central Chi-squa
+00022670: 7265 0d0a 2020 6469 7374 7269 6275 7469  re..  distributi
+00022680: 6f6e 2069 730d 0a0d 0a20 202e 2e20 6d61  on is....  .. ma
+00022690: 7468 3a3a 2050 2878 3b64 662c 6e6f 6e63  th:: P(x;df,nonc
+000226a0: 2920 3d20 5c73 756d 5e7b 5c69 6e66 7479  ) = \sum^{\infty
+000226b0: 7d5f 7b69 3d30 7d0d 0a20 2020 2020 2020  }_{i=0}..       
+000226c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000226d0: 2020 5c66 7261 637b 655e 7b2d 6e6f 6e63    \frac{e^{-nonc
+000226e0: 2f32 7d28 6e6f 6e63 2f32 295e 7b69 7d7d  /2}(nonc/2)^{i}}
+000226f0: 7b69 217d 0d0a 2020 2020 2020 2020 2020  {i!}..          
+00022700: 2020 2020 2020 2020 2020 2020 2020 2050                 P
+00022710: 5f7b 595f 7b64 662b 3269 7d7d 2878 292c  _{Y_{df+2i}}(x),
+00022720: 0d0a 0d0a 2020 7768 6572 6520 3a6d 6174  ....  where :mat
+00022730: 683a 6059 5f7b 717d 6020 6973 2074 6865  h:`Y_{q}` is the
+00022740: 2043 6869 2d73 7175 6172 6520 7769 7468   Chi-square with
+00022750: 2071 2064 6567 7265 6573 206f 6620 6672   q degrees of fr
+00022760: 6565 646f 6d2e 0d0a 0d0a 2020 5265 6665  eedom.....  Refe
+00022770: 7265 6e63 6573 0d0a 2020 2d2d 2d2d 2d2d  rences..  ------
+00022780: 2d2d 2d2d 0d0a 2020 2e2e 205b 315d 2057  ----..  .. [1] W
+00022790: 696b 6970 6564 6961 2c20 224e 6f6e 6365  ikipedia, "Nonce
+000227a0: 6e74 7261 6c20 6368 692d 7371 7561 7265  ntral chi-square
+000227b0: 6420 6469 7374 7269 6275 7469 6f6e 220d  d distribution".
+000227c0: 0a20 2020 2020 2020 2020 6874 7470 733a  .         https:
+000227d0: 2f2f 656e 2e77 696b 6970 6564 6961 2e6f  //en.wikipedia.o
+000227e0: 7267 2f77 696b 692f 4e6f 6e63 656e 7472  rg/wiki/Noncentr
+000227f0: 616c 5f63 6869 2d73 7175 6172 6564 5f64  al_chi-squared_d
+00022800: 6973 7472 6962 7574 696f 6e0d 0a0d 0a20  istribution.... 
+00022810: 2045 7861 6d70 6c65 730d 0a20 202d 2d2d   Examples..  ---
+00022820: 2d2d 2d2d 2d0d 0a20 2044 7261 7720 7661  -----..  Draw va
+00022830: 6c75 6573 2066 726f 6d20 7468 6520 6469  lues from the di
+00022840: 7374 7269 6275 7469 6f6e 2061 6e64 2070  stribution and p
+00022850: 6c6f 7420 7468 6520 6869 7374 6f67 7261  lot the histogra
+00022860: 6d0d 0a0d 0a20 203e 3e3e 2069 6d70 6f72  m....  >>> impor
+00022870: 7420 6d61 7470 6c6f 746c 6962 2e70 7970  t matplotlib.pyp
+00022880: 6c6f 7420 6173 2070 6c74 2020 2320 6e6f  lot as plt  # no
+00022890: 7161 0d0a 2020 3e3e 3e20 7661 6c75 6573  qa..  >>> values
+000228a0: 203d 2070 6c74 2e68 6973 7428 6272 6169   = plt.hist(brai
+000228b0: 6e63 6f72 652e 7261 6e64 6f6d 2e6e 6f6e  ncore.random.non
+000228c0: 6365 6e74 7261 6c5f 6368 6973 7175 6172  central_chisquar
+000228d0: 6528 332c 2032 302c 2031 3030 3030 3029  e(3, 20, 100000)
+000228e0: 2c0d 0a20 202e 2e2e 2020 2020 2020 2020  ,..  ...        
+000228f0: 2020 2020 2020 2020 2020 2062 696e 733d             bins=
+00022900: 3230 302c 2064 656e 7369 7479 3d54 7275  200, density=Tru
+00022910: 6529 0d0a 2020 3e3e 3e20 706c 742e 7368  e)..  >>> plt.sh
+00022920: 6f77 2829 0d0a 0d0a 2020 4472 6177 2076  ow()....  Draw v
+00022930: 616c 7565 7320 6672 6f6d 2061 206e 6f6e  alues from a non
+00022940: 6365 6e74 7261 6c20 6368 6973 7175 6172  central chisquar
+00022950: 6520 7769 7468 2076 6572 7920 736d 616c  e with very smal
+00022960: 6c20 6e6f 6e63 656e 7472 616c 6974 792c  l noncentrality,
+00022970: 0d0a 2020 616e 6420 636f 6d70 6172 6520  ..  and compare 
+00022980: 746f 2061 2063 6869 7371 7561 7265 2e0d  to a chisquare..
+00022990: 0a0d 0a20 203e 3e3e 2070 6c74 2e66 6967  ...  >>> plt.fig
+000229a0: 7572 6528 290d 0a20 203e 3e3e 2076 616c  ure()..  >>> val
+000229b0: 7565 7320 3d20 706c 742e 6869 7374 2862  ues = plt.hist(b
+000229c0: 7261 696e 636f 7265 2e72 616e 646f 6d2e  raincore.random.
+000229d0: 6e6f 6e63 656e 7472 616c 5f63 6869 7371  noncentral_chisq
+000229e0: 7561 7265 2833 2c20 2e30 3030 3030 3031  uare(3, .0000001
+000229f0: 2c20 3130 3030 3030 292c 0d0a 2020 2e2e  , 100000),..  ..
+00022a00: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
+00022a10: 2020 2020 6269 6e73 3d6e 702e 6172 616e      bins=np.aran
+00022a20: 6765 2830 2e2c 2032 352c 202e 3129 2c20  ge(0., 25, .1), 
+00022a30: 6465 6e73 6974 793d 5472 7565 290d 0a20  density=True).. 
+00022a40: 203e 3e3e 2076 616c 7565 7332 203d 2070   >>> values2 = p
+00022a50: 6c74 2e68 6973 7428 6272 6169 6e63 6f72  lt.hist(braincor
+00022a60: 652e 7261 6e64 6f6d 2e63 6869 7371 7561  e.random.chisqua
+00022a70: 7265 2833 2c20 3130 3030 3030 292c 0d0a  re(3, 100000),..
+00022a80: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
+00022a90: 2020 2020 2020 2020 2062 696e 733d 6e70           bins=np
+00022aa0: 2e61 7261 6e67 6528 302e 2c20 3235 2c20  .arange(0., 25, 
+00022ab0: 2e31 292c 2064 656e 7369 7479 3d54 7275  .1), density=Tru
+00022ac0: 6529 0d0a 2020 3e3e 3e20 706c 742e 706c  e)..  >>> plt.pl
+00022ad0: 6f74 2876 616c 7565 735b 315d 5b30 3a2d  ot(values[1][0:-
+00022ae0: 315d 2c20 7661 6c75 6573 5b30 5d2d 7661  1], values[0]-va
+00022af0: 6c75 6573 325b 305d 2c20 276f 6227 290d  lues2[0], 'ob').
+00022b00: 0a20 203e 3e3e 2070 6c74 2e73 686f 7728  .  >>> plt.show(
+00022b10: 290d 0a0d 0a20 2044 656d 6f6e 7374 7261  )....  Demonstra
+00022b20: 7465 2068 6f77 206c 6172 6765 2076 616c  te how large val
+00022b30: 7565 7320 6f66 206e 6f6e 2d63 656e 7472  ues of non-centr
+00022b40: 616c 6974 7920 6c65 6164 2074 6f20 6120  ality lead to a 
+00022b50: 6d6f 7265 2073 796d 6d65 7472 6963 0d0a  more symmetric..
+00022b60: 2020 6469 7374 7269 6275 7469 6f6e 2e0d    distribution..
+00022b70: 0a0d 0a20 203e 3e3e 2070 6c74 2e66 6967  ...  >>> plt.fig
+00022b80: 7572 6528 290d 0a20 203e 3e3e 2076 616c  ure()..  >>> val
+00022b90: 7565 7320 3d20 706c 742e 6869 7374 2862  ues = plt.hist(b
+00022ba0: 7261 696e 636f 7265 2e72 616e 646f 6d2e  raincore.random.
+00022bb0: 6e6f 6e63 656e 7472 616c 5f63 6869 7371  noncentral_chisq
+00022bc0: 7561 7265 2833 2c20 3230 2c20 3130 3030  uare(3, 20, 1000
+00022bd0: 3030 292c 0d0a 2020 2e2e 2e20 2020 2020  00),..  ...     
+00022be0: 2020 2020 2020 2020 2020 2020 2020 6269                bi
+00022bf0: 6e73 3d32 3030 2c20 6465 6e73 6974 793d  ns=200, density=
+00022c00: 5472 7565 290d 0a20 203e 3e3e 2070 6c74  True)..  >>> plt
+00022c10: 2e73 686f 7728 290d 0a20 2022 2222 0d0a  .show()..  """..
+00022c20: 2020 7265 7475 726e 2044 4546 4155 4c54    return DEFAULT
+00022c30: 2e6e 6f6e 6365 6e74 7261 6c5f 6368 6973  .noncentral_chis
+00022c40: 7175 6172 6528 6466 2c20 6e6f 6e63 2c20  quare(df, nonc, 
+00022c50: 7369 7a65 2c20 6b65 793d 6b65 792c 2064  size, key=key, d
+00022c60: 7479 7065 3d64 7479 7065 290d 0a0d 0a0d  type=dtype).....
+00022c70: 0a64 6566 206e 6f6e 6365 6e74 7261 6c5f  .def noncentral_
+00022c80: 6628 6466 6e75 6d2c 2064 6664 656e 2c20  f(dfnum, dfden, 
+00022c90: 6e6f 6e63 2c20 7369 7a65 3a20 4f70 7469  nonc, size: Opti
+00022ca0: 6f6e 616c 5b53 697a 655d 203d 204e 6f6e  onal[Size] = Non
+00022cb0: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+00022cc0: 2020 2020 206b 6579 3a20 4f70 7469 6f6e       key: Option
+00022cd0: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
+00022ce0: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+00022cf0: 2020 2020 2020 2020 6474 7970 653a 2044          dtype: D
+00022d00: 5479 7065 4c69 6b65 203d 204e 6f6e 6529  TypeLike = None)
+00022d10: 3a0d 0a20 2072 2222 220d 0a20 2044 7261  :..  r"""..  Dra
+00022d20: 7720 7361 6d70 6c65 7320 6672 6f6d 2074  w samples from t
+00022d30: 6865 206e 6f6e 6365 6e74 7261 6c20 4620  he noncentral F 
+00022d40: 6469 7374 7269 6275 7469 6f6e 2e0d 0a0d  distribution....
+00022d50: 0a20 2053 616d 706c 6573 2061 7265 2064  .  Samples are d
+00022d60: 7261 776e 2066 726f 6d20 616e 2046 2064  rawn from an F d
+00022d70: 6973 7472 6962 7574 696f 6e20 7769 7468  istribution with
+00022d80: 2073 7065 6369 6669 6564 2070 6172 616d   specified param
+00022d90: 6574 6572 732c 0d0a 2020 6064 666e 756d  eters,..  `dfnum
+00022da0: 6020 2864 6567 7265 6573 206f 6620 6672  ` (degrees of fr
+00022db0: 6565 646f 6d20 696e 206e 756d 6572 6174  eedom in numerat
+00022dc0: 6f72 2920 616e 6420 6064 6664 656e 6020  or) and `dfden` 
+00022dd0: 2864 6567 7265 6573 206f 660d 0a20 2066  (degrees of..  f
+00022de0: 7265 6564 6f6d 2069 6e20 6465 6e6f 6d69  reedom in denomi
+00022df0: 6e61 746f 7229 2c20 7768 6572 6520 626f  nator), where bo
+00022e00: 7468 2070 6172 616d 6574 6572 7320 3e20  th parameters > 
+00022e10: 312e 0d0a 2020 606e 6f6e 6360 2069 7320  1...  `nonc` is 
+00022e20: 7468 6520 6e6f 6e2d 6365 6e74 7261 6c69  the non-centrali
+00022e30: 7479 2070 6172 616d 6574 6572 2e0d 0a0d  ty parameter....
+00022e40: 0a20 2050 6172 616d 6574 6572 730d 0a20  .  Parameters.. 
+00022e50: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2064   ----------..  d
+00022e60: 666e 756d 203a 2066 6c6f 6174 206f 7220  fnum : float or 
+00022e70: 6172 7261 795f 6c69 6b65 206f 6620 666c  array_like of fl
+00022e80: 6f61 7473 0d0a 2020 2020 2020 4e75 6d65  oats..      Nume
+00022e90: 7261 746f 7220 6465 6772 6565 7320 6f66  rator degrees of
+00022ea0: 2066 7265 6564 6f6d 2c20 6d75 7374 2062   freedom, must b
+00022eb0: 6520 3e20 302e 0d0a 2020 6466 6465 6e20  e > 0...  dfden 
+00022ec0: 3a20 666c 6f61 7420 6f72 2061 7272 6179  : float or array
+00022ed0: 5f6c 696b 6520 6f66 2066 6c6f 6174 730d  _like of floats.
+00022ee0: 0a20 2020 2020 2044 656e 6f6d 696e 6174  .      Denominat
+00022ef0: 6f72 2064 6567 7265 6573 206f 6620 6672  or degrees of fr
+00022f00: 6565 646f 6d2c 206d 7573 7420 6265 203e  eedom, must be >
+00022f10: 2030 2e0d 0a20 206e 6f6e 6320 3a20 666c   0...  nonc : fl
+00022f20: 6f61 7420 6f72 2061 7272 6179 5f6c 696b  oat or array_lik
+00022f30: 6520 6f66 2066 6c6f 6174 730d 0a20 2020  e of floats..   
+00022f40: 2020 204e 6f6e 2d63 656e 7472 616c 6974     Non-centralit
+00022f50: 7920 7061 7261 6d65 7465 722c 2074 6865  y parameter, the
+00022f60: 2073 756d 206f 6620 7468 6520 7371 7561   sum of the squa
+00022f70: 7265 7320 6f66 2074 6865 206e 756d 6572  res of the numer
+00022f80: 6174 6f72 0d0a 2020 2020 2020 6d65 616e  ator..      mean
+00022f90: 732c 206d 7573 7420 6265 203e 3d20 302e  s, must be >= 0.
+00022fa0: 0d0a 2020 7369 7a65 203a 2069 6e74 206f  ..  size : int o
+00022fb0: 7220 7475 706c 6520 6f66 2069 6e74 732c  r tuple of ints,
+00022fc0: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
+00022fd0: 204f 7574 7075 7420 7368 6170 652e 2020   Output shape.  
+00022fe0: 4966 2074 6865 2067 6976 656e 2073 6861  If the given sha
+00022ff0: 7065 2069 732c 2065 2e67 2e2c 2060 6028  pe is, e.g., ``(
+00023000: 6d2c 206e 2c20 6b29 6060 2c20 7468 656e  m, n, k)``, then
+00023010: 0d0a 2020 2020 2020 6060 6d20 2a20 6e20  ..      ``m * n 
+00023020: 2a20 6b60 6020 7361 6d70 6c65 7320 6172  * k`` samples ar
+00023030: 6520 6472 6177 6e2e 2020 4966 2073 697a  e drawn.  If siz
+00023040: 6520 6973 2060 604e 6f6e 6560 6020 2864  e is ``None`` (d
+00023050: 6566 6175 6c74 292c 0d0a 2020 2020 2020  efault),..      
+00023060: 6120 7369 6e67 6c65 2076 616c 7565 2069  a single value i
+00023070: 7320 7265 7475 726e 6564 2069 6620 6060  s returned if ``
+00023080: 6466 6e75 6d60 602c 2060 6064 6664 656e  dfnum``, ``dfden
+00023090: 6060 2c20 616e 6420 6060 6e6f 6e63 6060  ``, and ``nonc``
+000230a0: 0d0a 2020 2020 2020 6172 6520 616c 6c20  ..      are all 
+000230b0: 7363 616c 6172 732e 2020 4f74 6865 7277  scalars.  Otherw
+000230c0: 6973 652c 2060 606e 702e 6272 6f61 6463  ise, ``np.broadc
+000230d0: 6173 7428 6466 6e75 6d2c 2064 6664 656e  ast(dfnum, dfden
+000230e0: 2c20 6e6f 6e63 292e 7369 7a65 6060 0d0a  , nonc).size``..
+000230f0: 2020 2020 2020 7361 6d70 6c65 7320 6172        samples ar
+00023100: 6520 6472 6177 6e2e 0d0a 2020 6b65 7920  e drawn...  key 
+00023110: 3a20 5052 4e47 4b65 792c 206f 7074 696f  : PRNGKey, optio
+00023120: 6e61 6c0d 0a20 2020 2020 2054 6865 206b  nal..      The k
+00023130: 6579 2066 6f72 2074 6865 2072 616e 646f  ey for the rando
+00023140: 6d20 6e75 6d62 6572 2067 656e 6572 6174  m number generat
+00023150: 6f72 2e20 4966 206e 6f74 2067 6976 656e  or. If not given
+00023160: 2c20 7468 650d 0a20 2020 2020 2064 6566  , the..      def
+00023170: 6175 6c74 2072 616e 646f 6d20 6e75 6d62  ault random numb
+00023180: 6572 2067 656e 6572 6174 6f72 2069 7320  er generator is 
+00023190: 7573 6564 2e0d 0a0d 0a20 2052 6574 7572  used.....  Retur
+000231a0: 6e73 0d0a 2020 2d2d 2d2d 2d2d 2d0d 0a20  ns..  -------.. 
+000231b0: 206f 7574 203a 206e 6461 7272 6179 206f   out : ndarray o
+000231c0: 7220 7363 616c 6172 0d0a 2020 2020 2020  r scalar..      
+000231d0: 4472 6177 6e20 7361 6d70 6c65 7320 6672  Drawn samples fr
+000231e0: 6f6d 2074 6865 2070 6172 616d 6574 6572  om the parameter
+000231f0: 697a 6564 206e 6f6e 6365 6e74 7261 6c20  ized noncentral 
+00023200: 4669 7368 6572 2064 6973 7472 6962 7574  Fisher distribut
+00023210: 696f 6e2e 0d0a 0d0a 2020 4e6f 7465 730d  ion.....  Notes.
+00023220: 0a20 202d 2d2d 2d2d 0d0a 2020 5768 656e  .  -----..  When
+00023230: 2063 616c 6375 6c61 7469 6e67 2074 6865   calculating the
+00023240: 2070 6f77 6572 206f 6620 616e 2065 7870   power of an exp
+00023250: 6572 696d 656e 7420 2870 6f77 6572 203d  eriment (power =
+00023260: 2070 726f 6261 6269 6c69 7479 206f 660d   probability of.
+00023270: 0a20 2072 656a 6563 7469 6e67 2074 6865  .  rejecting the
+00023280: 206e 756c 6c20 6879 706f 7468 6573 6973   null hypothesis
+00023290: 2077 6865 6e20 6120 7370 6563 6966 6963   when a specific
+000232a0: 2061 6c74 6572 6e61 7469 7665 2069 7320   alternative is 
+000232b0: 7472 7565 2920 7468 650d 0a20 206e 6f6e  true) the..  non
+000232c0: 2d63 656e 7472 616c 2046 2073 7461 7469  -central F stati
+000232d0: 7374 6963 2062 6563 6f6d 6573 2069 6d70  stic becomes imp
+000232e0: 6f72 7461 6e74 2e20 2057 6865 6e20 7468  ortant.  When th
+000232f0: 6520 6e75 6c6c 2068 7970 6f74 6865 7369  e null hypothesi
+00023300: 7320 6973 0d0a 2020 7472 7565 2c20 7468  s is..  true, th
+00023310: 6520 4620 7374 6174 6973 7469 6320 666f  e F statistic fo
+00023320: 6c6c 6f77 7320 6120 6365 6e74 7261 6c20  llows a central 
+00023330: 4620 6469 7374 7269 6275 7469 6f6e 2e20  F distribution. 
+00023340: 5768 656e 2074 6865 206e 756c 6c0d 0a20  When the null.. 
+00023350: 2068 7970 6f74 6865 7369 7320 6973 206e   hypothesis is n
+00023360: 6f74 2074 7275 652c 2074 6865 6e20 6974  ot true, then it
+00023370: 2066 6f6c 6c6f 7773 2061 206e 6f6e 2d63   follows a non-c
+00023380: 656e 7472 616c 2046 2073 7461 7469 7374  entral F statist
+00023390: 6963 2e0d 0a0d 0a20 2052 6566 6572 656e  ic.....  Referen
+000233a0: 6365 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d  ces..  ---------
+000233b0: 2d0d 0a20 202e 2e20 5b31 5d20 5765 6973  -..  .. [1] Weis
+000233c0: 7374 6569 6e2c 2045 7269 6320 572e 2022  stein, Eric W. "
+000233d0: 4e6f 6e63 656e 7472 616c 2046 2d44 6973  Noncentral F-Dis
+000233e0: 7472 6962 7574 696f 6e2e 220d 0a20 2020  tribution."..   
+000233f0: 2020 2020 2020 4672 6f6d 204d 6174 6857        From MathW
+00023400: 6f72 6c64 2d2d 4120 576f 6c66 7261 6d20  orld--A Wolfram 
+00023410: 5765 6220 5265 736f 7572 6365 2e0d 0a20  Web Resource... 
+00023420: 2020 2020 2020 2020 6874 7470 3a2f 2f6d          http://m
+00023430: 6174 6877 6f72 6c64 2e77 6f6c 6672 616d  athworld.wolfram
+00023440: 2e63 6f6d 2f4e 6f6e 6365 6e74 7261 6c46  .com/NoncentralF
+00023450: 2d44 6973 7472 6962 7574 696f 6e2e 6874  -Distribution.ht
+00023460: 6d6c 0d0a 2020 2e2e 205b 325d 2057 696b  ml..  .. [2] Wik
+00023470: 6970 6564 6961 2c20 224e 6f6e 6365 6e74  ipedia, "Noncent
+00023480: 7261 6c20 462d 6469 7374 7269 6275 7469  ral F-distributi
+00023490: 6f6e 222c 0d0a 2020 2020 2020 2020 2068  on",..         h
+000234a0: 7474 7073 3a2f 2f65 6e2e 7769 6b69 7065  ttps://en.wikipe
+000234b0: 6469 612e 6f72 672f 7769 6b69 2f4e 6f6e  dia.org/wiki/Non
+000234c0: 6365 6e74 7261 6c5f 462d 6469 7374 7269  central_F-distri
+000234d0: 6275 7469 6f6e 0d0a 0d0a 2020 4578 616d  bution....  Exam
+000234e0: 706c 6573 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ples..  --------
+000234f0: 0d0a 2020 496e 2061 2073 7475 6479 2c20  ..  In a study, 
+00023500: 7465 7374 696e 6720 666f 7220 6120 7370  testing for a sp
+00023510: 6563 6966 6963 2061 6c74 6572 6e61 7469  ecific alternati
+00023520: 7665 2074 6f20 7468 6520 6e75 6c6c 2068  ve to the null h
+00023530: 7970 6f74 6865 7369 730d 0a20 2072 6571  ypothesis..  req
+00023540: 7569 7265 7320 7573 6520 6f66 2074 6865  uires use of the
+00023550: 204e 6f6e 6365 6e74 7261 6c20 4620 6469   Noncentral F di
+00023560: 7374 7269 6275 7469 6f6e 2e20 5765 206e  stribution. We n
+00023570: 6565 6420 746f 2063 616c 6375 6c61 7465  eed to calculate
+00023580: 2074 6865 0d0a 2020 6172 6561 2069 6e20   the..  area in 
+00023590: 7468 6520 7461 696c 206f 6620 7468 6520  the tail of the 
+000235a0: 6469 7374 7269 6275 7469 6f6e 2074 6861  distribution tha
+000235b0: 7420 6578 6365 6564 7320 7468 6520 7661  t exceeds the va
+000235c0: 6c75 6520 6f66 2074 6865 2046 0d0a 2020  lue of the F..  
+000235d0: 6469 7374 7269 6275 7469 6f6e 2066 6f72  distribution for
+000235e0: 2074 6865 206e 756c 6c20 6879 706f 7468   the null hypoth
+000235f0: 6573 6973 2e20 2057 6527 6c6c 2070 6c6f  esis.  We'll plo
+00023600: 7420 7468 6520 7477 6f20 7072 6f62 6162  t the two probab
+00023610: 696c 6974 790d 0a20 2064 6973 7472 6962  ility..  distrib
+00023620: 7574 696f 6e73 2066 6f72 2063 6f6d 7061  utions for compa
+00023630: 7269 736f 6e2e 0d0a 0d0a 2020 3e3e 3e20  rison.....  >>> 
+00023640: 6466 6e75 6d20 3d20 3320 2320 6265 7477  dfnum = 3 # betw
+00023650: 6565 6e20 6772 6f75 7020 6465 6720 6f66  een group deg of
+00023660: 2066 7265 6564 6f6d 0d0a 2020 3e3e 3e20   freedom..  >>> 
+00023670: 6466 6465 6e20 3d20 3230 2023 2077 6974  dfden = 20 # wit
+00023680: 6869 6e20 6772 6f75 7073 2064 6567 7265  hin groups degre
+00023690: 6573 206f 6620 6672 6565 646f 6d0d 0a20  es of freedom.. 
+000236a0: 203e 3e3e 206e 6f6e 6320 3d20 332e 300d   >>> nonc = 3.0.
+000236b0: 0a20 203e 3e3e 206e 635f 7661 6c73 203d  .  >>> nc_vals =
+000236c0: 2062 7261 696e 636f 7265 2e72 616e 646f   braincore.rando
+000236d0: 6d2e 6e6f 6e63 656e 7472 616c 5f66 2864  m.noncentral_f(d
+000236e0: 666e 756d 2c20 6466 6465 6e2c 206e 6f6e  fnum, dfden, non
+000236f0: 632c 2031 3030 3030 3030 290d 0a20 203e  c, 1000000)..  >
+00023700: 3e3e 204e 4620 3d20 6e70 2e68 6973 746f  >> NF = np.histo
+00023710: 6772 616d 286e 635f 7661 6c73 2c20 6269  gram(nc_vals, bi
+00023720: 6e73 3d35 302c 2064 656e 7369 7479 3d54  ns=50, density=T
+00023730: 7275 6529 0d0a 2020 3e3e 3e20 635f 7661  rue)..  >>> c_va
+00023740: 6c73 203d 2062 7261 696e 636f 7265 2e72  ls = braincore.r
+00023750: 616e 646f 6d2e 6628 6466 6e75 6d2c 2064  andom.f(dfnum, d
+00023760: 6664 656e 2c20 3130 3030 3030 3029 0d0a  fden, 1000000)..
+00023770: 2020 3e3e 3e20 4620 3d20 6e70 2e68 6973    >>> F = np.his
+00023780: 746f 6772 616d 2863 5f76 616c 732c 2062  togram(c_vals, b
+00023790: 696e 733d 3530 2c20 6465 6e73 6974 793d  ins=50, density=
+000237a0: 5472 7565 290d 0a20 203e 3e3e 2069 6d70  True)..  >>> imp
+000237b0: 6f72 7420 6d61 7470 6c6f 746c 6962 2e70  ort matplotlib.p
+000237c0: 7970 6c6f 7420 6173 2070 6c74 2020 2320  yplot as plt  # 
+000237d0: 6e6f 7161 0d0a 2020 3e3e 3e20 706c 742e  noqa..  >>> plt.
+000237e0: 706c 6f74 2846 5b31 5d5b 313a 5d2c 2046  plot(F[1][1:], F
+000237f0: 5b30 5d29 0d0a 2020 3e3e 3e20 706c 742e  [0])..  >>> plt.
+00023800: 706c 6f74 284e 465b 315d 5b31 3a5d 2c20  plot(NF[1][1:], 
+00023810: 4e46 5b30 5d29 0d0a 2020 3e3e 3e20 706c  NF[0])..  >>> pl
+00023820: 742e 7368 6f77 2829 0d0a 2020 2222 220d  t.show()..  """.
+00023830: 0a20 2072 6574 7572 6e20 4445 4641 554c  .  return DEFAUL
+00023840: 542e 6e6f 6e63 656e 7472 616c 5f66 2864  T.noncentral_f(d
+00023850: 666e 756d 2c20 6466 6465 6e2c 206e 6f6e  fnum, dfden, non
+00023860: 632c 2073 697a 652c 206b 6579 3d6b 6579  c, size, key=key
+00023870: 2c20 6474 7970 653d 6474 7970 6529 0d0a  , dtype=dtype)..
+00023880: 0d0a 0d0a 6465 6620 706f 7765 7228 612c  ....def power(a,
+00023890: 0d0a 2020 2020 2020 2020 2020 7369 7a65  ..          size
+000238a0: 3a20 4f70 7469 6f6e 616c 5b53 697a 655d  : Optional[Size]
+000238b0: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
+000238c0: 2020 2020 6b65 793a 204f 7074 696f 6e61      key: Optiona
+000238d0: 6c5b 5365 6564 4f72 4b65 795d 203d 204e  l[SeedOrKey] = N
+000238e0: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+000238f0: 6474 7970 653a 2044 5479 7065 4c69 6b65  dtype: DTypeLike
+00023900: 203d 204e 6f6e 6529 3a0d 0a20 2072 2222   = None):..  r""
+00023910: 220d 0a20 2044 7261 7773 2073 616d 706c  "..  Draws sampl
+00023920: 6573 2069 6e20 5b30 2c20 315d 2066 726f  es in [0, 1] fro
+00023930: 6d20 6120 706f 7765 7220 6469 7374 7269  m a power distri
+00023940: 6275 7469 6f6e 2077 6974 6820 706f 7369  bution with posi
+00023950: 7469 7665 0d0a 2020 6578 706f 6e65 6e74  tive..  exponent
+00023960: 2061 202d 2031 2e0d 0a0d 0a20 2041 6c73   a - 1.....  Als
+00023970: 6f20 6b6e 6f77 6e20 6173 2074 6865 2070  o known as the p
+00023980: 6f77 6572 2066 756e 6374 696f 6e20 6469  ower function di
+00023990: 7374 7269 6275 7469 6f6e 2e0d 0a0d 0a20  stribution..... 
+000239a0: 2050 6172 616d 6574 6572 730d 0a20 202d   Parameters..  -
+000239b0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2061 203a  ---------..  a :
+000239c0: 2066 6c6f 6174 206f 7220 6172 7261 795f   float or array_
+000239d0: 6c69 6b65 206f 6620 666c 6f61 7473 0d0a  like of floats..
+000239e0: 2020 2020 2020 5061 7261 6d65 7465 7220        Parameter 
+000239f0: 6f66 2074 6865 2064 6973 7472 6962 7574  of the distribut
+00023a00: 696f 6e2e 204d 7573 7420 6265 206e 6f6e  ion. Must be non
+00023a10: 2d6e 6567 6174 6976 652e 0d0a 2020 7369  -negative...  si
+00023a20: 7a65 203a 2069 6e74 206f 7220 7475 706c  ze : int or tupl
+00023a30: 6520 6f66 2069 6e74 732c 206f 7074 696f  e of ints, optio
+00023a40: 6e61 6c0d 0a20 2020 2020 204f 7574 7075  nal..      Outpu
+00023a50: 7420 7368 6170 652e 2020 4966 2074 6865  t shape.  If the
+00023a60: 2067 6976 656e 2073 6861 7065 2069 732c   given shape is,
+00023a70: 2065 2e67 2e2c 2060 6028 6d2c 206e 2c20   e.g., ``(m, n, 
+00023a80: 6b29 6060 2c20 7468 656e 0d0a 2020 2020  k)``, then..    
+00023a90: 2020 6060 6d20 2a20 6e20 2a20 6b60 6020    ``m * n * k`` 
+00023aa0: 7361 6d70 6c65 7320 6172 6520 6472 6177  samples are draw
+00023ab0: 6e2e 2020 4966 2073 697a 6520 6973 2060  n.  If size is `
+00023ac0: 604e 6f6e 6560 6020 2864 6566 6175 6c74  `None`` (default
+00023ad0: 292c 0d0a 2020 2020 2020 6120 7369 6e67  ),..      a sing
+00023ae0: 6c65 2076 616c 7565 2069 7320 7265 7475  le value is retu
+00023af0: 726e 6564 2069 6620 6060 6160 6020 6973  rned if ``a`` is
+00023b00: 2061 2073 6361 6c61 722e 2020 4f74 6865   a scalar.  Othe
+00023b10: 7277 6973 652c 0d0a 2020 2020 2020 6060  rwise,..      ``
+00023b20: 6e70 2e61 7272 6179 2861 292e 7369 7a65  np.array(a).size
+00023b30: 6060 2073 616d 706c 6573 2061 7265 2064  `` samples are d
+00023b40: 7261 776e 2e0d 0a20 206b 6579 203a 2050  rawn...  key : P
+00023b50: 524e 474b 6579 2c20 6f70 7469 6f6e 616c  RNGKey, optional
+00023b60: 0d0a 2020 2020 2020 5468 6520 6b65 7920  ..      The key 
+00023b70: 666f 7220 7468 6520 7261 6e64 6f6d 206e  for the random n
+00023b80: 756d 6265 7220 6765 6e65 7261 746f 722e  umber generator.
+00023b90: 2049 6620 6e6f 7420 6769 7665 6e2c 2074   If not given, t
+00023ba0: 6865 0d0a 2020 2020 2020 6465 6661 756c  he..      defaul
+00023bb0: 7420 7261 6e64 6f6d 206e 756d 6265 7220  t random number 
+00023bc0: 6765 6e65 7261 746f 7220 6973 2075 7365  generator is use
+00023bd0: 642e 0d0a 0d0a 2020 5265 7475 726e 730d  d.....  Returns.
+00023be0: 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020 6f75  .  -------..  ou
+00023bf0: 7420 3a20 6e64 6172 7261 7920 6f72 2073  t : ndarray or s
+00023c00: 6361 6c61 720d 0a20 2020 2020 2044 7261  calar..      Dra
+00023c10: 776e 2073 616d 706c 6573 2066 726f 6d20  wn samples from 
+00023c20: 7468 6520 7061 7261 6d65 7465 7269 7a65  the parameterize
+00023c30: 6420 706f 7765 7220 6469 7374 7269 6275  d power distribu
+00023c40: 7469 6f6e 2e0d 0a0d 0a20 2052 6169 7365  tion.....  Raise
+00023c50: 730d 0a20 202d 2d2d 2d2d 2d0d 0a20 2056  s..  ------..  V
+00023c60: 616c 7565 4572 726f 720d 0a20 2020 2020  alueError..     
+00023c70: 2049 6620 6120 3c3d 2030 2e0d 0a0d 0a20   If a <= 0..... 
+00023c80: 204e 6f74 6573 0d0a 2020 2d2d 2d2d 2d0d   Notes..  -----.
+00023c90: 0a20 2054 6865 2070 726f 6261 6269 6c69  .  The probabili
+00023ca0: 7479 2064 656e 7369 7479 2066 756e 6374  ty density funct
+00023cb0: 696f 6e20 6973 0d0a 0d0a 2020 2e2e 206d  ion is....  .. m
+00023cc0: 6174 683a 3a20 5028 783b 2061 2920 3d20  ath:: P(x; a) = 
+00023cd0: 6178 5e7b 612d 317d 2c20 3020 5c6c 6520  ax^{a-1}, 0 \le 
+00023ce0: 7820 5c6c 6520 312c 2061 3e30 2e0d 0a0d  x \le 1, a>0....
+00023cf0: 0a20 2054 6865 2070 6f77 6572 2066 756e  .  The power fun
+00023d00: 6374 696f 6e20 6469 7374 7269 6275 7469  ction distributi
+00023d10: 6f6e 2069 7320 6a75 7374 2074 6865 2069  on is just the i
+00023d20: 6e76 6572 7365 206f 6620 7468 6520 5061  nverse of the Pa
+00023d30: 7265 746f 0d0a 2020 6469 7374 7269 6275  reto..  distribu
+00023d40: 7469 6f6e 2e20 4974 206d 6179 2061 6c73  tion. It may als
+00023d50: 6f20 6265 2073 6565 6e20 6173 2061 2073  o be seen as a s
+00023d60: 7065 6369 616c 2063 6173 6520 6f66 2074  pecial case of t
+00023d70: 6865 2042 6574 610d 0a20 2064 6973 7472  he Beta..  distr
+00023d80: 6962 7574 696f 6e2e 0d0a 0d0a 2020 4974  ibution.....  It
+00023d90: 2069 7320 7573 6564 2c20 666f 7220 6578   is used, for ex
+00023da0: 616d 706c 652c 2069 6e20 6d6f 6465 6c69  ample, in modeli
+00023db0: 6e67 2074 6865 206f 7665 722d 7265 706f  ng the over-repo
+00023dc0: 7274 696e 6720 6f66 2069 6e73 7572 616e  rting of insuran
+00023dd0: 6365 0d0a 2020 636c 6169 6d73 2e0d 0a0d  ce..  claims....
+00023de0: 0a20 2052 6566 6572 656e 6365 730d 0a20  .  References.. 
+00023df0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 202e   ----------..  .
+00023e00: 2e20 5b31 5d20 4368 7269 7374 6961 6e20  . [1] Christian 
+00023e10: 4b6c 6569 6265 722c 2053 616d 7565 6c20  Kleiber, Samuel 
+00023e20: 4b6f 747a 2c20 2253 7461 7469 7374 6963  Kotz, "Statistic
+00023e30: 616c 2073 697a 6520 6469 7374 7269 6275  al size distribu
+00023e40: 7469 6f6e 730d 0a20 2020 2020 2020 2020  tions..         
+00023e50: 696e 2065 636f 6e6f 6d69 6373 2061 6e64  in economics and
+00023e60: 2061 6374 7561 7269 616c 2073 6369 656e   actuarial scien
+00023e70: 6365 7322 2c20 5769 6c65 792c 2032 3030  ces", Wiley, 200
+00023e80: 332e 0d0a 2020 2e2e 205b 325d 2048 6563  3...  .. [2] Hec
+00023e90: 6b65 7274 2c20 4e2e 2041 2e20 616e 6420  kert, N. A. and 
+00023ea0: 4669 6c6c 6962 656e 2c20 4a61 6d65 7320  Filliben, James 
+00023eb0: 4a2e 2022 4e49 5354 2048 616e 6462 6f6f  J. "NIST Handboo
+00023ec0: 6b20 3134 383a 0d0a 2020 2020 2020 2020  k 148:..        
+00023ed0: 2044 6174 6170 6c6f 7420 5265 6665 7265   Dataplot Refere
+00023ee0: 6e63 6520 4d61 6e75 616c 2c20 566f 6c75  nce Manual, Volu
+00023ef0: 6d65 2032 3a20 4c65 7420 5375 6263 6f6d  me 2: Let Subcom
+00023f00: 6d61 6e64 7320 616e 6420 4c69 6272 6172  mands and Librar
+00023f10: 790d 0a20 2020 2020 2020 2020 4675 6e63  y..         Func
+00023f20: 7469 6f6e 7322 2c20 4e61 7469 6f6e 616c  tions", National
+00023f30: 2049 6e73 7469 7475 7465 206f 6620 5374   Institute of St
+00023f40: 616e 6461 7264 7320 616e 6420 5465 6368  andards and Tech
+00023f50: 6e6f 6c6f 6779 0d0a 2020 2020 2020 2020  nology..        
+00023f60: 2048 616e 6462 6f6f 6b20 5365 7269 6573   Handbook Series
+00023f70: 2c20 4a75 6e65 2032 3030 332e 0d0a 2020  , June 2003...  
+00023f80: 2020 2020 2020 2068 7474 7073 3a2f 2f77         https://w
+00023f90: 7777 2e69 746c 2e6e 6973 742e 676f 762f  ww.itl.nist.gov/
+00023fa0: 6469 7638 3938 2f73 6f66 7477 6172 652f  div898/software/
+00023fb0: 6461 7461 706c 6f74 2f72 6566 6d61 6e32  dataplot/refman2
+00023fc0: 2f61 7578 696c 6c61 722f 706f 7770 6466  /auxillar/powpdf
+00023fd0: 2e70 6466 0d0a 0d0a 2020 4578 616d 706c  .pdf....  Exampl
+00023fe0: 6573 0d0a 2020 2d2d 2d2d 2d2d 2d2d 0d0a  es..  --------..
+00023ff0: 2020 4472 6177 2073 616d 706c 6573 2066    Draw samples f
+00024000: 726f 6d20 7468 6520 6469 7374 7269 6275  rom the distribu
+00024010: 7469 6f6e 3a0d 0a0d 0a20 203e 3e3e 2061  tion:....  >>> a
+00024020: 203d 2035 2e20 2320 7368 6170 650d 0a20   = 5. # shape.. 
+00024030: 203e 3e3e 2073 616d 706c 6573 203d 2031   >>> samples = 1
+00024040: 3030 300d 0a20 203e 3e3e 2073 203d 2062  000..  >>> s = b
+00024050: 7261 696e 636f 7265 2e72 616e 646f 6d2e  raincore.random.
+00024060: 706f 7765 7228 612c 2073 616d 706c 6573  power(a, samples
+00024070: 290d 0a0d 0a20 2044 6973 706c 6179 2074  )....  Display t
+00024080: 6865 2068 6973 746f 6772 616d 206f 6620  he histogram of 
+00024090: 7468 6520 7361 6d70 6c65 732c 2061 6c6f  the samples, alo
+000240a0: 6e67 2077 6974 680d 0a20 2074 6865 2070  ng with..  the p
+000240b0: 726f 6261 6269 6c69 7479 2064 656e 7369  robability densi
+000240c0: 7479 2066 756e 6374 696f 6e3a 0d0a 0d0a  ty function:....
+000240d0: 2020 3e3e 3e20 696d 706f 7274 206d 6174    >>> import mat
+000240e0: 706c 6f74 6c69 622e 7079 706c 6f74 2061  plotlib.pyplot a
+000240f0: 7320 706c 7420 2023 206e 6f71 610d 0a20  s plt  # noqa.. 
+00024100: 203e 3e3e 2063 6f75 6e74 2c20 6269 6e73   >>> count, bins
+00024110: 2c20 6967 6e6f 7265 6420 3d20 706c 742e  , ignored = plt.
+00024120: 6869 7374 2873 2c20 6269 6e73 3d33 3029  hist(s, bins=30)
+00024130: 0d0a 2020 3e3e 3e20 7820 3d20 6e70 2e6c  ..  >>> x = np.l
+00024140: 696e 7370 6163 6528 302c 2031 2c20 3130  inspace(0, 1, 10
+00024150: 3029 0d0a 2020 3e3e 3e20 7920 3d20 612a  0)..  >>> y = a*
+00024160: 782a 2a28 612d 312e 290d 0a20 203e 3e3e  x**(a-1.)..  >>>
+00024170: 206e 6f72 6d65 645f 7920 3d20 7361 6d70   normed_y = samp
+00024180: 6c65 732a 6e70 2e64 6966 6628 6269 6e73  les*np.diff(bins
+00024190: 295b 305d 2a79 0d0a 2020 3e3e 3e20 706c  )[0]*y..  >>> pl
+000241a0: 742e 706c 6f74 2878 2c20 6e6f 726d 6564  t.plot(x, normed
+000241b0: 5f79 290d 0a20 203e 3e3e 2070 6c74 2e73  _y)..  >>> plt.s
+000241c0: 686f 7728 290d 0a0d 0a20 2043 6f6d 7061  how()....  Compa
+000241d0: 7265 2074 6865 2070 6f77 6572 2066 756e  re the power fun
+000241e0: 6374 696f 6e20 6469 7374 7269 6275 7469  ction distributi
+000241f0: 6f6e 2074 6f20 7468 6520 696e 7665 7273  on to the invers
+00024200: 6520 6f66 2074 6865 2050 6172 6574 6f2e  e of the Pareto.
+00024210: 0d0a 0d0a 2020 3e3e 3e20 6672 6f6d 2073  ....  >>> from s
+00024220: 6369 7079 2069 6d70 6f72 7420 7374 6174  cipy import stat
+00024230: 7320 2320 646f 6374 6573 743a 202b 534b  s # doctest: +SK
+00024240: 4950 0d0a 2020 3e3e 3e20 7276 7320 3d20  IP..  >>> rvs = 
+00024250: 6272 6169 6e63 6f72 652e 7261 6e64 6f6d  braincore.random
+00024260: 2e70 6f77 6572 2835 2c20 3130 3030 3030  .power(5, 100000
+00024270: 3029 0d0a 2020 3e3e 3e20 7276 7370 203d  0)..  >>> rvsp =
+00024280: 2062 7261 696e 636f 7265 2e72 616e 646f   braincore.rando
+00024290: 6d2e 7061 7265 746f 2835 2c20 3130 3030  m.pareto(5, 1000
+000242a0: 3030 3029 0d0a 2020 3e3e 3e20 7878 203d  000)..  >>> xx =
+000242b0: 206e 702e 6c69 6e73 7061 6365 2830 2c31   np.linspace(0,1
+000242c0: 2c31 3030 290d 0a20 203e 3e3e 2070 6f77  ,100)..  >>> pow
+000242d0: 7064 6620 3d20 7374 6174 732e 706f 7765  pdf = stats.powe
+000242e0: 726c 6177 2e70 6466 2878 782c 3529 2020  rlaw.pdf(xx,5)  
+000242f0: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
+00024300: 0d0a 0d0a 2020 3e3e 3e20 706c 742e 6669  ....  >>> plt.fi
+00024310: 6775 7265 2829 0d0a 2020 3e3e 3e20 706c  gure()..  >>> pl
+00024320: 742e 6869 7374 2872 7673 2c20 6269 6e73  t.hist(rvs, bins
+00024330: 3d35 302c 2064 656e 7369 7479 3d54 7275  =50, density=Tru
+00024340: 6529 0d0a 2020 3e3e 3e20 706c 742e 706c  e)..  >>> plt.pl
+00024350: 6f74 2878 782c 706f 7770 6466 2c27 722d  ot(xx,powpdf,'r-
+00024360: 2729 2020 2320 646f 6374 6573 743a 202b  ')  # doctest: +
+00024370: 534b 4950 0d0a 2020 3e3e 3e20 706c 742e  SKIP..  >>> plt.
+00024380: 7469 746c 6528 2762 7261 696e 636f 7265  title('braincore
+00024390: 2e72 616e 646f 6d2e 706f 7765 7228 3529  .random.power(5)
+000243a0: 2729 0d0a 0d0a 2020 3e3e 3e20 706c 742e  ')....  >>> plt.
+000243b0: 6669 6775 7265 2829 0d0a 2020 3e3e 3e20  figure()..  >>> 
+000243c0: 706c 742e 6869 7374 2831 2e2f 2831 2e2b  plt.hist(1./(1.+
+000243d0: 7276 7370 292c 2062 696e 733d 3530 2c20  rvsp), bins=50, 
+000243e0: 6465 6e73 6974 793d 5472 7565 290d 0a20  density=True).. 
+000243f0: 203e 3e3e 2070 6c74 2e70 6c6f 7428 7878   >>> plt.plot(xx
+00024400: 2c70 6f77 7064 662c 2772 2d27 2920 2023  ,powpdf,'r-')  #
+00024410: 2064 6f63 7465 7374 3a20 2b53 4b49 500d   doctest: +SKIP.
+00024420: 0a20 203e 3e3e 2070 6c74 2e74 6974 6c65  .  >>> plt.title
+00024430: 2827 696e 7665 7273 6520 6f66 2031 202b  ('inverse of 1 +
+00024440: 2062 7261 696e 636f 7265 2e72 616e 646f   braincore.rando
+00024450: 6d2e 7061 7265 746f 2835 2927 290d 0a0d  m.pareto(5)')...
+00024460: 0a20 203e 3e3e 2070 6c74 2e66 6967 7572  .  >>> plt.figur
+00024470: 6528 290d 0a20 203e 3e3e 2070 6c74 2e68  e()..  >>> plt.h
+00024480: 6973 7428 312e 2f28 312e 2b72 7673 7029  ist(1./(1.+rvsp)
+00024490: 2c20 6269 6e73 3d35 302c 2064 656e 7369  , bins=50, densi
+000244a0: 7479 3d54 7275 6529 0d0a 2020 3e3e 3e20  ty=True)..  >>> 
+000244b0: 706c 742e 706c 6f74 2878 782c 706f 7770  plt.plot(xx,powp
+000244c0: 6466 2c27 722d 2729 2020 2320 646f 6374  df,'r-')  # doct
+000244d0: 6573 743a 202b 534b 4950 0d0a 2020 3e3e  est: +SKIP..  >>
+000244e0: 3e20 706c 742e 7469 746c 6528 2769 6e76  > plt.title('inv
+000244f0: 6572 7365 206f 6620 7374 6174 732e 7061  erse of stats.pa
+00024500: 7265 746f 2835 2927 290d 0a20 2022 2222  reto(5)')..  """
+00024510: 0d0a 2020 7265 7475 726e 2044 4546 4155  ..  return DEFAU
+00024520: 4c54 2e70 6f77 6572 2861 2c20 7369 7a65  LT.power(a, size
+00024530: 2c20 6b65 793d 6b65 792c 2064 7479 7065  , key=key, dtype
+00024540: 3d64 7479 7065 290d 0a0d 0a0d 0a64 6566  =dtype)......def
+00024550: 2072 6179 6c65 6967 6828 7363 616c 653d   rayleigh(scale=
+00024560: 312e 302c 0d0a 2020 2020 2020 2020 2020  1.0,..          
+00024570: 2020 2073 697a 653a 204f 7074 696f 6e61     size: Optiona
+00024580: 6c5b 5369 7a65 5d20 3d20 4e6f 6e65 2c0d  l[Size] = None,.
+00024590: 0a20 2020 2020 2020 2020 2020 2020 6b65  .             ke
+000245a0: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
+000245b0: 4f72 4b65 795d 203d 204e 6f6e 652c 0d0a  OrKey] = None,..
+000245c0: 2020 2020 2020 2020 2020 2020 2064 7479               dty
+000245d0: 7065 3a20 4454 7970 654c 696b 6520 3d20  pe: DTypeLike = 
+000245e0: 4e6f 6e65 293a 0d0a 2020 7222 2222 0d0a  None):..  r"""..
+000245f0: 2020 4472 6177 2073 616d 706c 6573 2066    Draw samples f
+00024600: 726f 6d20 6120 5261 796c 6569 6768 2064  rom a Rayleigh d
+00024610: 6973 7472 6962 7574 696f 6e2e 0d0a 0d0a  istribution.....
+00024620: 2020 5468 6520 3a6d 6174 683a 605c 6368    The :math:`\ch
+00024630: 6960 2061 6e64 2057 6569 6275 6c6c 2064  i` and Weibull d
+00024640: 6973 7472 6962 7574 696f 6e73 2061 7265  istributions are
+00024650: 2067 656e 6572 616c 697a 6174 696f 6e73   generalizations
+00024660: 206f 6620 7468 650d 0a20 2052 6179 6c65   of the..  Rayle
+00024670: 6967 682e 0d0a 0d0a 2020 5061 7261 6d65  igh.....  Parame
+00024680: 7465 7273 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ters..  --------
+00024690: 2d2d 0d0a 2020 7363 616c 6520 3a20 666c  --..  scale : fl
+000246a0: 6f61 7420 6f72 2061 7272 6179 5f6c 696b  oat or array_lik
+000246b0: 6520 6f66 2066 6c6f 6174 732c 206f 7074  e of floats, opt
+000246c0: 696f 6e61 6c0d 0a20 2020 2020 2053 6361  ional..      Sca
+000246d0: 6c65 2c20 616c 736f 2065 7175 616c 7320  le, also equals 
+000246e0: 7468 6520 6d6f 6465 2e20 4d75 7374 2062  the mode. Must b
+000246f0: 6520 6e6f 6e2d 6e65 6761 7469 7665 2e20  e non-negative. 
+00024700: 4465 6661 756c 7420 6973 2031 2e0d 0a20  Default is 1... 
+00024710: 2073 697a 6520 3a20 696e 7420 6f72 2074   size : int or t
+00024720: 7570 6c65 206f 6620 696e 7473 2c20 6f70  uple of ints, op
+00024730: 7469 6f6e 616c 0d0a 2020 2020 2020 4f75  tional..      Ou
+00024740: 7470 7574 2073 6861 7065 2e20 2049 6620  tput shape.  If 
+00024750: 7468 6520 6769 7665 6e20 7368 6170 6520  the given shape 
+00024760: 6973 2c20 652e 672e 2c20 6060 286d 2c20  is, e.g., ``(m, 
+00024770: 6e2c 206b 2960 602c 2074 6865 6e0d 0a20  n, k)``, then.. 
+00024780: 2020 2020 2060 606d 202a 206e 202a 206b       ``m * n * k
+00024790: 6060 2073 616d 706c 6573 2061 7265 2064  `` samples are d
+000247a0: 7261 776e 2e20 2049 6620 7369 7a65 2069  rawn.  If size i
+000247b0: 7320 6060 4e6f 6e65 6060 2028 6465 6661  s ``None`` (defa
+000247c0: 756c 7429 2c0d 0a20 2020 2020 2061 2073  ult),..      a s
+000247d0: 696e 676c 6520 7661 6c75 6520 6973 2072  ingle value is r
+000247e0: 6574 7572 6e65 6420 6966 2060 6073 6361  eturned if ``sca
+000247f0: 6c65 6060 2069 7320 6120 7363 616c 6172  le`` is a scalar
+00024800: 2e20 204f 7468 6572 7769 7365 2c0d 0a20  .  Otherwise,.. 
+00024810: 2020 2020 2060 606e 702e 6172 7261 7928       ``np.array(
+00024820: 7363 616c 6529 2e73 697a 6560 6020 7361  scale).size`` sa
+00024830: 6d70 6c65 7320 6172 6520 6472 6177 6e2e  mples are drawn.
+00024840: 0d0a 2020 6b65 7920 3a20 5052 4e47 4b65  ..  key : PRNGKe
+00024850: 792c 206f 7074 696f 6e61 6c0d 0a20 2020  y, optional..   
+00024860: 2020 2054 6865 206b 6579 2066 6f72 2074     The key for t
+00024870: 6865 2072 616e 646f 6d20 6e75 6d62 6572  he random number
+00024880: 2067 656e 6572 6174 6f72 2e20 4966 206e   generator. If n
+00024890: 6f74 2067 6976 656e 2c20 7468 650d 0a20  ot given, the.. 
+000248a0: 2020 2020 2064 6566 6175 6c74 2072 616e       default ran
+000248b0: 646f 6d20 6e75 6d62 6572 2067 656e 6572  dom number gener
+000248c0: 6174 6f72 2069 7320 7573 6564 2e0d 0a0d  ator is used....
+000248d0: 0a20 2052 6574 7572 6e73 0d0a 2020 2d2d  .  Returns..  --
+000248e0: 2d2d 2d2d 2d0d 0a20 206f 7574 203a 206e  -----..  out : n
+000248f0: 6461 7272 6179 206f 7220 7363 616c 6172  darray or scalar
+00024900: 0d0a 2020 2020 2020 4472 6177 6e20 7361  ..      Drawn sa
+00024910: 6d70 6c65 7320 6672 6f6d 2074 6865 2070  mples from the p
+00024920: 6172 616d 6574 6572 697a 6564 2052 6179  arameterized Ray
+00024930: 6c65 6967 6820 6469 7374 7269 6275 7469  leigh distributi
+00024940: 6f6e 2e0d 0a0d 0a20 204e 6f74 6573 0d0a  on.....  Notes..
+00024950: 2020 2d2d 2d2d 2d0d 0a20 2054 6865 2070    -----..  The p
+00024960: 726f 6261 6269 6c69 7479 2064 656e 7369  robability densi
+00024970: 7479 2066 756e 6374 696f 6e20 666f 7220  ty function for 
+00024980: 7468 6520 5261 796c 6569 6768 2064 6973  the Rayleigh dis
+00024990: 7472 6962 7574 696f 6e20 6973 0d0a 0d0a  tribution is....
+000249a0: 2020 2e2e 206d 6174 683a 3a20 5028 783b    .. math:: P(x;
+000249b0: 7363 616c 6529 203d 205c 6672 6163 7b78  scale) = \frac{x
+000249c0: 7d7b 7363 616c 655e 327d 655e 7b5c 6672  }{scale^2}e^{\fr
+000249d0: 6163 7b2d 785e 327d 7b32 205c 6364 6f74  ac{-x^2}{2 \cdot
+000249e0: 7020 7363 616c 655e 327d 7d0d 0a0d 0a20  p scale^2}}.... 
+000249f0: 2054 6865 2052 6179 6c65 6967 6820 6469   The Rayleigh di
+00024a00: 7374 7269 6275 7469 6f6e 2077 6f75 6c64  stribution would
+00024a10: 2061 7269 7365 2c20 666f 7220 6578 616d   arise, for exam
+00024a20: 706c 652c 2069 6620 7468 6520 4561 7374  ple, if the East
+00024a30: 0d0a 2020 616e 6420 4e6f 7274 6820 636f  ..  and North co
+00024a40: 6d70 6f6e 656e 7473 206f 6620 7468 6520  mponents of the 
+00024a50: 7769 6e64 2076 656c 6f63 6974 7920 6861  wind velocity ha
+00024a60: 6420 6964 656e 7469 6361 6c20 7a65 726f  d identical zero
+00024a70: 2d6d 6561 6e0d 0a20 2047 6175 7373 6961  -mean..  Gaussia
+00024a80: 6e20 6469 7374 7269 6275 7469 6f6e 732e  n distributions.
+00024a90: 2020 5468 656e 2074 6865 2077 696e 6420    Then the wind 
+00024aa0: 7370 6565 6420 776f 756c 6420 6861 7665  speed would have
+00024ab0: 2061 2052 6179 6c65 6967 680d 0a20 2064   a Rayleigh..  d
+00024ac0: 6973 7472 6962 7574 696f 6e2e 0d0a 0d0a  istribution.....
+00024ad0: 2020 5265 6665 7265 6e63 6573 0d0a 2020    References..  
+00024ae0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2e2e  ----------..  ..
+00024af0: 205b 315d 2042 7269 6768 746f 6e20 5765   [1] Brighton We
+00024b00: 6273 204c 7464 2e2c 2022 5261 796c 6569  bs Ltd., "Raylei
+00024b10: 6768 2044 6973 7472 6962 7574 696f 6e2c  gh Distribution,
+00024b20: 220d 0a20 2020 2020 2020 2020 6874 7470  "..         http
+00024b30: 733a 2f2f 7765 622e 6172 6368 6976 652e  s://web.archive.
+00024b40: 6f72 672f 7765 622f 3230 3039 3035 3134  org/web/20090514
+00024b50: 3039 3134 3234 2f68 7474 703a 2f2f 6272  091424/http://br
+00024b60: 6967 6874 6f6e 2d77 6562 732e 636f 2e75  ighton-webs.co.u
+00024b70: 6b3a 3830 2f64 6973 7472 6962 7574 696f  k:80/distributio
+00024b80: 6e73 2f72 6179 6c65 6967 682e 6173 700d  ns/rayleigh.asp.
+00024b90: 0a20 202e 2e20 5b32 5d20 5769 6b69 7065  .  .. [2] Wikipe
+00024ba0: 6469 612c 2022 5261 796c 6569 6768 2064  dia, "Rayleigh d
+00024bb0: 6973 7472 6962 7574 696f 6e22 0d0a 2020  istribution"..  
+00024bc0: 2020 2020 2020 2068 7474 7073 3a2f 2f65         https://e
+00024bd0: 6e2e 7769 6b69 7065 6469 612e 6f72 672f  n.wikipedia.org/
+00024be0: 7769 6b69 2f52 6179 6c65 6967 685f 6469  wiki/Rayleigh_di
+00024bf0: 7374 7269 6275 7469 6f6e 0d0a 0d0a 2020  stribution....  
+00024c00: 4578 616d 706c 6573 0d0a 2020 2d2d 2d2d  Examples..  ----
+00024c10: 2d2d 2d2d 0d0a 2020 4472 6177 2076 616c  ----..  Draw val
+00024c20: 7565 7320 6672 6f6d 2074 6865 2064 6973  ues from the dis
+00024c30: 7472 6962 7574 696f 6e20 616e 6420 706c  tribution and pl
+00024c40: 6f74 2074 6865 2068 6973 746f 6772 616d  ot the histogram
+00024c50: 0d0a 0d0a 2020 3e3e 3e20 6672 6f6d 206d  ....  >>> from m
+00024c60: 6174 706c 6f74 6c69 622e 7079 706c 6f74  atplotlib.pyplot
+00024c70: 2069 6d70 6f72 7420 6869 7374 2020 2320   import hist  # 
+00024c80: 6e6f 7161 0d0a 2020 3e3e 3e20 7661 6c75  noqa..  >>> valu
+00024c90: 6573 203d 2068 6973 7428 6272 6169 6e63  es = hist(brainc
+00024ca0: 6f72 652e 7261 6e64 6f6d 2e72 6179 6c65  ore.random.rayle
+00024cb0: 6967 6828 332c 2031 3030 3030 3029 2c20  igh(3, 100000), 
+00024cc0: 6269 6e73 3d32 3030 2c20 6465 6e73 6974  bins=200, densit
+00024cd0: 793d 5472 7565 290d 0a0d 0a20 2057 6176  y=True)....  Wav
+00024ce0: 6520 6865 6967 6874 7320 7465 6e64 2074  e heights tend t
+00024cf0: 6f20 666f 6c6c 6f77 2061 2052 6179 6c65  o follow a Rayle
+00024d00: 6967 6820 6469 7374 7269 6275 7469 6f6e  igh distribution
+00024d10: 2e20 4966 2074 6865 206d 6561 6e20 7761  . If the mean wa
+00024d20: 7665 0d0a 2020 6865 6967 6874 2069 7320  ve..  height is 
+00024d30: 3120 6d65 7465 722c 2077 6861 7420 6672  1 meter, what fr
+00024d40: 6163 7469 6f6e 206f 6620 7761 7665 7320  action of waves 
+00024d50: 6172 6520 6c69 6b65 6c79 2074 6f20 6265  are likely to be
+00024d60: 206c 6172 6765 7220 7468 616e 2033 0d0a   larger than 3..
+00024d70: 2020 6d65 7465 7273 3f0d 0a0d 0a20 203e    meters?....  >
+00024d80: 3e3e 206d 6561 6e76 616c 7565 203d 2031  >> meanvalue = 1
+00024d90: 0d0a 2020 3e3e 3e20 6d6f 6465 7661 6c75  ..  >>> modevalu
+00024da0: 6520 3d20 6e70 2e73 7172 7428 3220 2f20  e = np.sqrt(2 / 
+00024db0: 6e70 2e70 6929 202a 206d 6561 6e76 616c  np.pi) * meanval
+00024dc0: 7565 0d0a 2020 3e3e 3e20 7320 3d20 6272  ue..  >>> s = br
+00024dd0: 6169 6e63 6f72 652e 7261 6e64 6f6d 2e72  aincore.random.r
+00024de0: 6179 6c65 6967 6828 6d6f 6465 7661 6c75  ayleigh(modevalu
+00024df0: 652c 2031 3030 3030 3030 290d 0a0d 0a20  e, 1000000).... 
+00024e00: 2054 6865 2070 6572 6365 6e74 6167 6520   The percentage 
+00024e10: 6f66 2077 6176 6573 206c 6172 6765 7220  of waves larger 
+00024e20: 7468 616e 2033 206d 6574 6572 7320 6973  than 3 meters is
+00024e30: 3a0d 0a0d 0a20 203e 3e3e 2031 3030 2e2a  :....  >>> 100.*
+00024e40: 7375 6d28 733e 3329 2f31 3030 3030 3030  sum(s>3)/1000000
+00024e50: 2e0d 0a20 2030 2e30 3837 3330 3030 3030  ...  0.087300000
+00024e60: 3030 3030 3030 3030 3320 2320 7261 6e64  000000003 # rand
+00024e70: 6f6d 0d0a 2020 2222 220d 0a20 2072 6574  om..  """..  ret
+00024e80: 7572 6e20 4445 4641 554c 542e 7261 796c  urn DEFAULT.rayl
+00024e90: 6569 6768 2873 6361 6c65 2c20 7369 7a65  eigh(scale, size
+00024ea0: 2c20 6b65 793d 6b65 792c 2064 7479 7065  , key=key, dtype
+00024eb0: 3d64 7479 7065 290d 0a0d 0a0d 0a64 6566  =dtype)......def
+00024ec0: 2074 7269 616e 6775 6c61 7228 7369 7a65   triangular(size
+00024ed0: 3a20 4f70 7469 6f6e 616c 5b53 697a 655d  : Optional[Size]
+00024ee0: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
+00024ef0: 2020 2020 2020 2020 206b 6579 3a20 4f70           key: Op
+00024f00: 7469 6f6e 616c 5b53 6565 644f 724b 6579  tional[SeedOrKey
+00024f10: 5d20 3d20 4e6f 6e65 293a 0d0a 2020 7222  ] = None):..  r"
+00024f20: 2222 0d0a 2020 4472 6177 2073 616d 706c  ""..  Draw sampl
+00024f30: 6573 2066 726f 6d20 7468 6520 7472 6961  es from the tria
+00024f40: 6e67 756c 6172 2064 6973 7472 6962 7574  ngular distribut
+00024f50: 696f 6e20 6f76 6572 2074 6865 0d0a 2020  ion over the..  
+00024f60: 696e 7465 7276 616c 2060 605b 6c65 6674  interval ``[left
+00024f70: 2c20 7269 6768 745d 6060 2e0d 0a0d 0a20  , right]``..... 
+00024f80: 2054 6865 2074 7269 616e 6775 6c61 7220   The triangular 
+00024f90: 6469 7374 7269 6275 7469 6f6e 2069 7320  distribution is 
+00024fa0: 6120 636f 6e74 696e 756f 7573 2070 726f  a continuous pro
+00024fb0: 6261 6269 6c69 7479 0d0a 2020 6469 7374  bability..  dist
+00024fc0: 7269 6275 7469 6f6e 2077 6974 6820 6c6f  ribution with lo
+00024fd0: 7765 7220 6c69 6d69 7420 6c65 6674 2c20  wer limit left, 
+00024fe0: 7065 616b 2061 7420 6d6f 6465 2c20 616e  peak at mode, an
+00024ff0: 6420 7570 7065 720d 0a20 206c 696d 6974  d upper..  limit
+00025000: 2072 6967 6874 2e20 556e 6c69 6b65 2074   right. Unlike t
+00025010: 6865 206f 7468 6572 2064 6973 7472 6962  he other distrib
+00025020: 7574 696f 6e73 2c20 7468 6573 6520 7061  utions, these pa
+00025030: 7261 6d65 7465 7273 0d0a 2020 6469 7265  rameters..  dire
+00025040: 6374 6c79 2064 6566 696e 6520 7468 6520  ctly define the 
+00025050: 7368 6170 6520 6f66 2074 6865 2070 6466  shape of the pdf
+00025060: 2e0d 0a0d 0a20 2050 6172 616d 6574 6572  .....  Parameter
+00025070: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
+00025080: 0a20 2073 697a 6520 3a20 696e 7420 6f72  .  size : int or
+00025090: 2074 7570 6c65 206f 6620 696e 7473 2c20   tuple of ints, 
+000250a0: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+000250b0: 4f75 7470 7574 2073 6861 7065 2e20 2049  Output shape.  I
+000250c0: 6620 7468 6520 6769 7665 6e20 7368 6170  f the given shap
+000250d0: 6520 6973 2c20 652e 672e 2c20 6060 286d  e is, e.g., ``(m
+000250e0: 2c20 6e2c 206b 2960 602c 2074 6865 6e0d  , n, k)``, then.
+000250f0: 0a20 2020 2020 2060 606d 202a 206e 202a  .      ``m * n *
+00025100: 206b 6060 2073 616d 706c 6573 2061 7265   k`` samples are
+00025110: 2064 7261 776e 2e20 2049 6620 7369 7a65   drawn.  If size
+00025120: 2069 7320 6060 4e6f 6e65 6060 2028 6465   is ``None`` (de
+00025130: 6661 756c 7429 2c0d 0a20 2020 2020 2061  fault),..      a
+00025140: 2073 696e 676c 6520 7661 6c75 6520 6973   single value is
+00025150: 2072 6574 7572 6e65 6420 6966 2060 606c   returned if ``l
+00025160: 6566 7460 602c 2060 606d 6f64 6560 602c  eft``, ``mode``,
+00025170: 2061 6e64 2060 6072 6967 6874 6060 0d0a   and ``right``..
+00025180: 2020 2020 2020 6172 6520 616c 6c20 7363        are all sc
+00025190: 616c 6172 732e 2020 4f74 6865 7277 6973  alars.  Otherwis
+000251a0: 652c 2060 606e 702e 6272 6f61 6463 6173  e, ``np.broadcas
+000251b0: 7428 6c65 6674 2c20 6d6f 6465 2c20 7269  t(left, mode, ri
+000251c0: 6768 7429 2e73 697a 6560 600d 0a20 2020  ght).size``..   
+000251d0: 2020 2073 616d 706c 6573 2061 7265 2064     samples are d
+000251e0: 7261 776e 2e0d 0a20 206b 6579 203a 2050  rawn...  key : P
+000251f0: 524e 474b 6579 2c20 6f70 7469 6f6e 616c  RNGKey, optional
+00025200: 0d0a 2020 2020 2020 5468 6520 6b65 7920  ..      The key 
+00025210: 666f 7220 7468 6520 7261 6e64 6f6d 206e  for the random n
+00025220: 756d 6265 7220 6765 6e65 7261 746f 722e  umber generator.
+00025230: 2049 6620 6e6f 7420 6769 7665 6e2c 2074   If not given, t
+00025240: 6865 0d0a 2020 2020 2020 6465 6661 756c  he..      defaul
+00025250: 7420 7261 6e64 6f6d 206e 756d 6265 7220  t random number 
+00025260: 6765 6e65 7261 746f 7220 6973 2075 7365  generator is use
+00025270: 642e 0d0a 0d0a 2020 5265 7475 726e 730d  d.....  Returns.
+00025280: 0a20 202d 2d2d 2d2d 2d2d 0d0a 2020 6f75  .  -------..  ou
+00025290: 7420 3a20 6e64 6172 7261 7920 6f72 2073  t : ndarray or s
+000252a0: 6361 6c61 720d 0a20 2020 2020 2044 7261  calar..      Dra
+000252b0: 776e 2073 616d 706c 6573 2066 726f 6d20  wn samples from 
+000252c0: 7468 6520 7061 7261 6d65 7465 7269 7a65  the parameterize
+000252d0: 6420 7472 6961 6e67 756c 6172 2064 6973  d triangular dis
+000252e0: 7472 6962 7574 696f 6e2e 0d0a 0d0a 2020  tribution.....  
+000252f0: 4e6f 7465 730d 0a20 202d 2d2d 2d2d 0d0a  Notes..  -----..
+00025300: 2020 5468 6520 7072 6f62 6162 696c 6974    The probabilit
+00025310: 7920 6465 6e73 6974 7920 6675 6e63 7469  y density functi
+00025320: 6f6e 2066 6f72 2074 6865 2074 7269 616e  on for the trian
+00025330: 6775 6c61 7220 6469 7374 7269 6275 7469  gular distributi
+00025340: 6f6e 2069 730d 0a0d 0a20 202e 2e20 6d61  on is....  .. ma
+00025350: 7468 3a3a 2050 2878 3b6c 2c20 6d2c 2072  th:: P(x;l, m, r
+00025360: 2920 3d20 5c62 6567 696e 7b63 6173 6573  ) = \begin{cases
+00025370: 7d0d 0a20 2020 2020 2020 2020 2020 205c  }..            \
+00025380: 6672 6163 7b32 2878 2d6c 297d 7b28 722d  frac{2(x-l)}{(r-
+00025390: 6c29 286d 2d6c 297d 2620 5c74 6578 747b  l)(m-l)}& \text{
+000253a0: 666f 7220 246c 205c 6c65 7120 7820 5c6c  for $l \leq x \l
+000253b0: 6571 206d 247d 2c5c 5c0d 0a20 2020 2020  eq m$},\\..     
+000253c0: 2020 2020 2020 205c 6672 6163 7b32 2872         \frac{2(r
+000253d0: 2d78 297d 7b28 722d 6c29 2872 2d6d 297d  -x)}{(r-l)(r-m)}
+000253e0: 2620 5c74 6578 747b 666f 7220 246d 205c  & \text{for $m \
+000253f0: 6c65 7120 7820 5c6c 6571 2072 247d 2c5c  leq x \leq r$},\
+00025400: 5c0d 0a20 2020 2020 2020 2020 2020 2030  \..            0
+00025410: 2620 5c74 6578 747b 6f74 6865 7277 6973  & \text{otherwis
+00025420: 657d 2e0d 0a20 2020 2020 2020 2020 2020  e}...           
+00025430: 205c 656e 647b 6361 7365 737d 0d0a 0d0a   \end{cases}....
+00025440: 2020 5468 6520 7472 6961 6e67 756c 6172    The triangular
+00025450: 2064 6973 7472 6962 7574 696f 6e20 6973   distribution is
+00025460: 206f 6674 656e 2075 7365 6420 696e 2069   often used in i
+00025470: 6c6c 2d64 6566 696e 6564 0d0a 2020 7072  ll-defined..  pr
+00025480: 6f62 6c65 6d73 2077 6865 7265 2074 6865  oblems where the
+00025490: 2075 6e64 6572 6c79 696e 6720 6469 7374   underlying dist
+000254a0: 7269 6275 7469 6f6e 2069 7320 6e6f 7420  ribution is not 
+000254b0: 6b6e 6f77 6e2c 2062 7574 0d0a 2020 736f  known, but..  so
+000254c0: 6d65 206b 6e6f 776c 6564 6765 206f 6620  me knowledge of 
+000254d0: 7468 6520 6c69 6d69 7473 2061 6e64 206d  the limits and m
+000254e0: 6f64 6520 6578 6973 7473 2e20 4f66 7465  ode exists. Ofte
+000254f0: 6e20 6974 2069 7320 7573 6564 0d0a 2020  n it is used..  
+00025500: 696e 2073 696d 756c 6174 696f 6e73 2e0d  in simulations..
+00025510: 0a0d 0a20 2052 6566 6572 656e 6365 730d  ...  References.
+00025520: 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  .  ----------.. 
+00025530: 202e 2e20 5b31 5d20 5769 6b69 7065 6469   .. [1] Wikipedi
+00025540: 612c 2022 5472 6961 6e67 756c 6172 2064  a, "Triangular d
+00025550: 6973 7472 6962 7574 696f 6e22 0d0a 2020  istribution"..  
+00025560: 2020 2020 2020 2068 7474 7073 3a2f 2f65         https://e
+00025570: 6e2e 7769 6b69 7065 6469 612e 6f72 672f  n.wikipedia.org/
+00025580: 7769 6b69 2f54 7269 616e 6775 6c61 725f  wiki/Triangular_
+00025590: 6469 7374 7269 6275 7469 6f6e 0d0a 0d0a  distribution....
+000255a0: 2020 4578 616d 706c 6573 0d0a 2020 2d2d    Examples..  --
+000255b0: 2d2d 2d2d 2d2d 0d0a 2020 4472 6177 2076  ------..  Draw v
+000255c0: 616c 7565 7320 6672 6f6d 2074 6865 2064  alues from the d
+000255d0: 6973 7472 6962 7574 696f 6e20 616e 6420  istribution and 
+000255e0: 706c 6f74 2074 6865 2068 6973 746f 6772  plot the histogr
+000255f0: 616d 3a0d 0a0d 0a20 203e 3e3e 2069 6d70  am:....  >>> imp
+00025600: 6f72 7420 6d61 7470 6c6f 746c 6962 2e70  ort matplotlib.p
+00025610: 7970 6c6f 7420 6173 2070 6c74 2020 2320  yplot as plt  # 
+00025620: 6e6f 7161 0d0a 2020 3e3e 3e20 6820 3d20  noqa..  >>> h = 
+00025630: 706c 742e 6869 7374 2862 7261 696e 636f  plt.hist(brainco
+00025640: 7265 2e72 616e 646f 6d2e 7472 6961 6e67  re.random.triang
+00025650: 756c 6172 282d 332c 2030 2c20 382c 2031  ular(-3, 0, 8, 1
+00025660: 3030 3030 3029 2c20 6269 6e73 3d32 3030  00000), bins=200
+00025670: 2c0d 0a20 202e 2e2e 2020 2020 2020 2020  ,..  ...        
+00025680: 2020 2020 2020 6465 6e73 6974 793d 5472        density=Tr
+00025690: 7565 290d 0a20 203e 3e3e 2070 6c74 2e73  ue)..  >>> plt.s
+000256a0: 686f 7728 290d 0a20 2022 2222 0d0a 2020  how()..  """..  
+000256b0: 7265 7475 726e 2044 4546 4155 4c54 2e74  return DEFAULT.t
+000256c0: 7269 616e 6775 6c61 7228 7369 7a65 2c20  riangular(size, 
+000256d0: 6b65 793d 6b65 7929 0d0a 0d0a 0d0a 6465  key=key)......de
+000256e0: 6620 766f 6e6d 6973 6573 286d 752c 0d0a  f vonmises(mu,..
+000256f0: 2020 2020 2020 2020 2020 2020 206b 6170               kap
+00025700: 7061 2c0d 0a20 2020 2020 2020 2020 2020  pa,..           
+00025710: 2020 7369 7a65 3a20 4f70 7469 6f6e 616c    size: Optional
+00025720: 5b53 697a 655d 203d 204e 6f6e 652c 0d0a  [Size] = None,..
+00025730: 2020 2020 2020 2020 2020 2020 206b 6579               key
+00025740: 3a20 4f70 7469 6f6e 616c 5b53 6565 644f  : Optional[SeedO
+00025750: 724b 6579 5d20 3d20 4e6f 6e65 2c0d 0a20  rKey] = None,.. 
+00025760: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
+00025770: 653a 2044 5479 7065 4c69 6b65 203d 204e  e: DTypeLike = N
+00025780: 6f6e 6529 3a0d 0a20 2072 2222 220d 0a20  one):..  r""".. 
+00025790: 2044 7261 7720 7361 6d70 6c65 7320 6672   Draw samples fr
+000257a0: 6f6d 2061 2076 6f6e 204d 6973 6573 2064  om a von Mises d
+000257b0: 6973 7472 6962 7574 696f 6e2e 0d0a 0d0a  istribution.....
+000257c0: 2020 5361 6d70 6c65 7320 6172 6520 6472    Samples are dr
+000257d0: 6177 6e20 6672 6f6d 2061 2076 6f6e 204d  awn from a von M
+000257e0: 6973 6573 2064 6973 7472 6962 7574 696f  ises distributio
+000257f0: 6e20 7769 7468 2073 7065 6369 6669 6564  n with specified
+00025800: 206d 6f64 650d 0a20 2028 6d75 2920 616e   mode..  (mu) an
+00025810: 6420 6469 7370 6572 7369 6f6e 2028 6b61  d dispersion (ka
+00025820: 7070 6129 2c20 6f6e 2074 6865 2069 6e74  ppa), on the int
+00025830: 6572 7661 6c20 5b2d 7069 2c20 7069 5d2e  erval [-pi, pi].
+00025840: 0d0a 0d0a 2020 5468 6520 766f 6e20 4d69  ....  The von Mi
+00025850: 7365 7320 6469 7374 7269 6275 7469 6f6e  ses distribution
+00025860: 2028 616c 736f 206b 6e6f 776e 2061 7320   (also known as 
+00025870: 7468 6520 6369 7263 756c 6172 206e 6f72  the circular nor
+00025880: 6d61 6c0d 0a20 2064 6973 7472 6962 7574  mal..  distribut
+00025890: 696f 6e29 2069 7320 6120 636f 6e74 696e  ion) is a contin
+000258a0: 756f 7573 2070 726f 6261 6269 6c69 7479  uous probability
+000258b0: 2064 6973 7472 6962 7574 696f 6e20 6f6e   distribution on
+000258c0: 2074 6865 2075 6e69 740d 0a20 2063 6972   the unit..  cir
+000258d0: 636c 652e 2020 4974 206d 6179 2062 6520  cle.  It may be 
+000258e0: 7468 6f75 6768 7420 6f66 2061 7320 7468  thought of as th
+000258f0: 6520 6369 7263 756c 6172 2061 6e61 6c6f  e circular analo
+00025900: 6775 6520 6f66 2074 6865 206e 6f72 6d61  gue of the norma
+00025910: 6c0d 0a20 2064 6973 7472 6962 7574 696f  l..  distributio
+00025920: 6e2e 0d0a 0d0a 2020 5061 7261 6d65 7465  n.....  Paramete
+00025930: 7273 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d  rs..  ----------
+00025940: 0d0a 2020 6d75 203a 2066 6c6f 6174 206f  ..  mu : float o
+00025950: 7220 6172 7261 795f 6c69 6b65 206f 6620  r array_like of 
+00025960: 666c 6f61 7473 0d0a 2020 2020 2020 4d6f  floats..      Mo
+00025970: 6465 2028 2263 656e 7465 7222 2920 6f66  de ("center") of
+00025980: 2074 6865 2064 6973 7472 6962 7574 696f   the distributio
+00025990: 6e2e 0d0a 2020 6b61 7070 6120 3a20 666c  n...  kappa : fl
+000259a0: 6f61 7420 6f72 2061 7272 6179 5f6c 696b  oat or array_lik
+000259b0: 6520 6f66 2066 6c6f 6174 730d 0a20 2020  e of floats..   
+000259c0: 2020 2044 6973 7065 7273 696f 6e20 6f66     Dispersion of
+000259d0: 2074 6865 2064 6973 7472 6962 7574 696f   the distributio
+000259e0: 6e2c 2068 6173 2074 6f20 6265 203e 3d30  n, has to be >=0
+000259f0: 2e0d 0a20 2073 697a 6520 3a20 696e 7420  ...  size : int 
+00025a00: 6f72 2074 7570 6c65 206f 6620 696e 7473  or tuple of ints
+00025a10: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+00025a20: 2020 4f75 7470 7574 2073 6861 7065 2e20    Output shape. 
+00025a30: 2049 6620 7468 6520 6769 7665 6e20 7368   If the given sh
+00025a40: 6170 6520 6973 2c20 652e 672e 2c20 6060  ape is, e.g., ``
+00025a50: 286d 2c20 6e2c 206b 2960 602c 2074 6865  (m, n, k)``, the
+00025a60: 6e0d 0a20 2020 2020 2060 606d 202a 206e  n..      ``m * n
+00025a70: 202a 206b 6060 2073 616d 706c 6573 2061   * k`` samples a
+00025a80: 7265 2064 7261 776e 2e20 2049 6620 7369  re drawn.  If si
+00025a90: 7a65 2069 7320 6060 4e6f 6e65 6060 2028  ze is ``None`` (
+00025aa0: 6465 6661 756c 7429 2c0d 0a20 2020 2020  default),..     
+00025ab0: 2061 2073 696e 676c 6520 7661 6c75 6520   a single value 
+00025ac0: 6973 2072 6574 7572 6e65 6420 6966 2060  is returned if `
+00025ad0: 606d 7560 6020 616e 6420 6060 6b61 7070  `mu`` and ``kapp
+00025ae0: 6160 6020 6172 6520 626f 7468 2073 6361  a`` are both sca
+00025af0: 6c61 7273 2e0d 0a20 2020 2020 204f 7468  lars...      Oth
+00025b00: 6572 7769 7365 2c20 6060 6e70 2e62 726f  erwise, ``np.bro
+00025b10: 6164 6361 7374 286d 752c 206b 6170 7061  adcast(mu, kappa
+00025b20: 292e 7369 7a65 6060 2073 616d 706c 6573  ).size`` samples
+00025b30: 2061 7265 2064 7261 776e 2e0d 0a20 206b   are drawn...  k
+00025b40: 6579 203a 2050 524e 474b 6579 2c20 6f70  ey : PRNGKey, op
+00025b50: 7469 6f6e 616c 0d0a 2020 2020 2020 5468  tional..      Th
+00025b60: 6520 6b65 7920 666f 7220 7468 6520 7261  e key for the ra
+00025b70: 6e64 6f6d 206e 756d 6265 7220 6765 6e65  ndom number gene
+00025b80: 7261 746f 722e 2049 6620 6e6f 7420 6769  rator. If not gi
+00025b90: 7665 6e2c 2074 6865 0d0a 2020 2020 2020  ven, the..      
+00025ba0: 6465 6661 756c 7420 7261 6e64 6f6d 206e  default random n
+00025bb0: 756d 6265 7220 6765 6e65 7261 746f 7220  umber generator 
+00025bc0: 6973 2075 7365 642e 0d0a 0d0a 2020 5265  is used.....  Re
+00025bd0: 7475 726e 730d 0a20 202d 2d2d 2d2d 2d2d  turns..  -------
+00025be0: 0d0a 2020 6f75 7420 3a20 6e64 6172 7261  ..  out : ndarra
+00025bf0: 7920 6f72 2073 6361 6c61 720d 0a20 2020  y or scalar..   
+00025c00: 2020 2044 7261 776e 2073 616d 706c 6573     Drawn samples
+00025c10: 2066 726f 6d20 7468 6520 7061 7261 6d65   from the parame
+00025c20: 7465 7269 7a65 6420 766f 6e20 4d69 7365  terized von Mise
+00025c30: 7320 6469 7374 7269 6275 7469 6f6e 2e0d  s distribution..
+00025c40: 0a0d 0a20 2053 6565 2041 6c73 6f0d 0a20  ...  See Also.. 
+00025c50: 202d 2d2d 2d2d 2d2d 2d0d 0a20 2073 6369   --------..  sci
+00025c60: 7079 2e73 7461 7473 2e76 6f6e 6d69 7365  py.stats.vonmise
+00025c70: 7320 3a20 7072 6f62 6162 696c 6974 7920  s : probability 
+00025c80: 6465 6e73 6974 7920 6675 6e63 7469 6f6e  density function
+00025c90: 2c20 6469 7374 7269 6275 7469 6f6e 2c20  , distribution, 
+00025ca0: 6f72 0d0a 2020 2020 2020 6375 6d75 6c61  or..      cumula
+00025cb0: 7469 7665 2064 656e 7369 7479 2066 756e  tive density fun
+00025cc0: 6374 696f 6e2c 2065 7463 2e0d 0a0d 0a20  ction, etc..... 
+00025cd0: 204e 6f74 6573 0d0a 2020 2d2d 2d2d 2d0d   Notes..  -----.
+00025ce0: 0a20 2054 6865 2070 726f 6261 6269 6c69  .  The probabili
+00025cf0: 7479 2064 656e 7369 7479 2066 6f72 2074  ty density for t
+00025d00: 6865 2076 6f6e 204d 6973 6573 2064 6973  he von Mises dis
+00025d10: 7472 6962 7574 696f 6e20 6973 0d0a 0d0a  tribution is....
+00025d20: 2020 2e2e 206d 6174 683a 3a20 7028 7829    .. math:: p(x)
+00025d30: 203d 205c 6672 6163 7b65 5e7b 5c6b 6170   = \frac{e^{\kap
+00025d40: 7061 2063 6f73 2878 2d5c 6d75 297d 7d7b  pa cos(x-\mu)}}{
+00025d50: 325c 7069 2049 5f30 285c 6b61 7070 6129  2\pi I_0(\kappa)
+00025d60: 7d2c 0d0a 0d0a 2020 7768 6572 6520 3a6d  },....  where :m
+00025d70: 6174 683a 605c 6d75 6020 6973 2074 6865  ath:`\mu` is the
+00025d80: 206d 6f64 6520 616e 6420 3a6d 6174 683a   mode and :math:
+00025d90: 605c 6b61 7070 6160 2074 6865 2064 6973  `\kappa` the dis
+00025da0: 7065 7273 696f 6e2c 0d0a 2020 616e 6420  persion,..  and 
+00025db0: 3a6d 6174 683a 6049 5f30 285c 6b61 7070  :math:`I_0(\kapp
+00025dc0: 6129 6020 6973 2074 6865 206d 6f64 6966  a)` is the modif
+00025dd0: 6965 6420 4265 7373 656c 2066 756e 6374  ied Bessel funct
+00025de0: 696f 6e20 6f66 206f 7264 6572 2030 2e0d  ion of order 0..
+00025df0: 0a0d 0a20 2054 6865 2076 6f6e 204d 6973  ...  The von Mis
+00025e00: 6573 2069 7320 6e61 6d65 6420 666f 7220  es is named for 
+00025e10: 5269 6368 6172 6420 4564 6c65 7220 766f  Richard Edler vo
+00025e20: 6e20 4d69 7365 732c 2077 686f 2077 6173  n Mises, who was
+00025e30: 2062 6f72 6e20 696e 0d0a 2020 4175 7374   born in..  Aust
+00025e40: 7269 612d 4875 6e67 6172 792c 2069 6e20  ria-Hungary, in 
+00025e50: 7768 6174 2069 7320 6e6f 7720 7468 6520  what is now the 
+00025e60: 556b 7261 696e 652e 2020 4865 2066 6c65  Ukraine.  He fle
+00025e70: 6420 746f 2074 6865 2055 6e69 7465 640d  d to the United.
+00025e80: 0a20 2053 7461 7465 7320 696e 2031 3933  .  States in 193
+00025e90: 3920 616e 6420 6265 6361 6d65 2061 2070  9 and became a p
+00025ea0: 726f 6665 7373 6f72 2061 7420 4861 7276  rofessor at Harv
+00025eb0: 6172 642e 2020 4865 2077 6f72 6b65 6420  ard.  He worked 
+00025ec0: 696e 0d0a 2020 7072 6f62 6162 696c 6974  in..  probabilit
+00025ed0: 7920 7468 656f 7279 2c20 6165 726f 6479  y theory, aerody
+00025ee0: 6e61 6d69 6373 2c20 666c 7569 6420 6d65  namics, fluid me
+00025ef0: 6368 616e 6963 732c 2061 6e64 2070 6869  chanics, and phi
+00025f00: 6c6f 736f 7068 7920 6f66 0d0a 2020 7363  losophy of..  sc
+00025f10: 6965 6e63 652e 0d0a 0d0a 2020 5265 6665  ience.....  Refe
+00025f20: 7265 6e63 6573 0d0a 2020 2d2d 2d2d 2d2d  rences..  ------
+00025f30: 2d2d 2d2d 0d0a 2020 2e2e 205b 315d 2041  ----..  .. [1] A
+00025f40: 6272 616d 6f77 6974 7a2c 204d 2e20 616e  bramowitz, M. an
+00025f50: 6420 5374 6567 756e 2c20 492e 2041 2e20  d Stegun, I. A. 
+00025f60: 2845 6473 2e29 2e20 2248 616e 6462 6f6f  (Eds.). "Handboo
+00025f70: 6b20 6f66 0d0a 2020 2020 2020 2020 204d  k of..         M
+00025f80: 6174 6865 6d61 7469 6361 6c20 4675 6e63  athematical Func
+00025f90: 7469 6f6e 7320 7769 7468 2046 6f72 6d75  tions with Formu
+00025fa0: 6c61 732c 2047 7261 7068 732c 2061 6e64  las, Graphs, and
+00025fb0: 204d 6174 6865 6d61 7469 6361 6c0d 0a20   Mathematical.. 
+00025fc0: 2020 2020 2020 2020 5461 626c 6573 2c20          Tables, 
+00025fd0: 3974 6820 7072 696e 7469 6e67 2c22 204e  9th printing," N
+00025fe0: 6577 2059 6f72 6b3a 2044 6f76 6572 2c20  ew York: Dover, 
+00025ff0: 3139 3732 2e0d 0a20 202e 2e20 5b32 5d20  1972...  .. [2] 
+00026000: 766f 6e20 4d69 7365 732c 2052 2e2c 2022  von Mises, R., "
+00026010: 4d61 7468 656d 6174 6963 616c 2054 6865  Mathematical The
+00026020: 6f72 7920 6f66 2050 726f 6261 6269 6c69  ory of Probabili
+00026030: 7479 0d0a 2020 2020 2020 2020 2061 6e64  ty..         and
+00026040: 2053 7461 7469 7374 6963 7322 2c20 4e65   Statistics", Ne
+00026050: 7720 596f 726b 3a20 4163 6164 656d 6963  w York: Academic
+00026060: 2050 7265 7373 2c20 3139 3634 2e0d 0a0d   Press, 1964....
+00026070: 0a20 2045 7861 6d70 6c65 730d 0a20 202d  .  Examples..  -
+00026080: 2d2d 2d2d 2d2d 2d0d 0a20 2044 7261 7720  -------..  Draw 
+00026090: 7361 6d70 6c65 7320 6672 6f6d 2074 6865  samples from the
+000260a0: 2064 6973 7472 6962 7574 696f 6e3a 0d0a   distribution:..
+000260b0: 0d0a 2020 3e3e 3e20 6d75 2c20 6b61 7070  ..  >>> mu, kapp
+000260c0: 6120 3d20 302e 302c 2034 2e30 2023 206d  a = 0.0, 4.0 # m
+000260d0: 6561 6e20 616e 6420 6469 7370 6572 7369  ean and dispersi
+000260e0: 6f6e 0d0a 2020 3e3e 3e20 7320 3d20 6272  on..  >>> s = br
+000260f0: 6169 6e63 6f72 652e 7261 6e64 6f6d 2e76  aincore.random.v
+00026100: 6f6e 6d69 7365 7328 6d75 2c20 6b61 7070  onmises(mu, kapp
+00026110: 612c 2031 3030 3029 0d0a 0d0a 2020 4469  a, 1000)....  Di
+00026120: 7370 6c61 7920 7468 6520 6869 7374 6f67  splay the histog
+00026130: 7261 6d20 6f66 2074 6865 2073 616d 706c  ram of the sampl
+00026140: 6573 2c20 616c 6f6e 6720 7769 7468 0d0a  es, along with..
+00026150: 2020 7468 6520 7072 6f62 6162 696c 6974    the probabilit
+00026160: 7920 6465 6e73 6974 7920 6675 6e63 7469  y density functi
+00026170: 6f6e 3a0d 0a0d 0a20 203e 3e3e 2069 6d70  on:....  >>> imp
+00026180: 6f72 7420 6d61 7470 6c6f 746c 6962 2e70  ort matplotlib.p
+00026190: 7970 6c6f 7420 6173 2070 6c74 2020 2320  yplot as plt  # 
+000261a0: 6e6f 7161 0d0a 2020 3e3e 3e20 6672 6f6d  noqa..  >>> from
+000261b0: 2073 6369 7079 2e73 7065 6369 616c 2069   scipy.special i
+000261c0: 6d70 6f72 7420 6930 2020 2320 646f 6374  mport i0  # doct
+000261d0: 6573 743a 202b 534b 4950 0d0a 2020 3e3e  est: +SKIP..  >>
+000261e0: 3e20 706c 742e 6869 7374 2873 2c20 3530  > plt.hist(s, 50
+000261f0: 2c20 6465 6e73 6974 793d 5472 7565 290d  , density=True).
+00026200: 0a20 203e 3e3e 2078 203d 206e 702e 6c69  .  >>> x = np.li
+00026210: 6e73 7061 6365 282d 6e70 2e70 692c 206e  nspace(-np.pi, n
+00026220: 702e 7069 2c20 6e75 6d3d 3531 290d 0a20  p.pi, num=51).. 
+00026230: 203e 3e3e 2079 203d 206e 702e 6578 7028   >>> y = np.exp(
+00026240: 6b61 7070 612a 6e70 2e63 6f73 2878 2d6d  kappa*np.cos(x-m
+00026250: 7529 292f 2832 2a6e 702e 7069 2a69 3028  u))/(2*np.pi*i0(
+00026260: 6b61 7070 6129 2920 2023 2064 6f63 7465  kappa))  # docte
+00026270: 7374 3a20 2b53 4b49 500d 0a20 203e 3e3e  st: +SKIP..  >>>
+00026280: 2070 6c74 2e70 6c6f 7428 782c 2079 2c20   plt.plot(x, y, 
+00026290: 6c69 6e65 7769 6474 683d 322c 2063 6f6c  linewidth=2, col
+000262a0: 6f72 3d27 7227 2920 2023 2064 6f63 7465  or='r')  # docte
+000262b0: 7374 3a20 2b53 4b49 500d 0a20 203e 3e3e  st: +SKIP..  >>>
+000262c0: 2070 6c74 2e73 686f 7728 290d 0a20 2022   plt.show()..  "
+000262d0: 2222 0d0a 2020 7265 7475 726e 2044 4546  ""..  return DEF
+000262e0: 4155 4c54 2e76 6f6e 6d69 7365 7328 6d75  AULT.vonmises(mu
+000262f0: 2c20 6b61 7070 612c 2073 697a 652c 206b  , kappa, size, k
+00026300: 6579 3d6b 6579 2c20 6474 7970 653d 6474  ey=key, dtype=dt
+00026310: 7970 6529 0d0a 0d0a 0d0a 6465 6620 7761  ype)......def wa
+00026320: 6c64 286d 6561 6e2c 0d0a 2020 2020 2020  ld(mean,..      
+00026330: 2020 2073 6361 6c65 2c0d 0a20 2020 2020     scale,..     
+00026340: 2020 2020 7369 7a65 3a20 4f70 7469 6f6e      size: Option
+00026350: 616c 5b53 697a 655d 203d 204e 6f6e 652c  al[Size] = None,
+00026360: 0d0a 2020 2020 2020 2020 206b 6579 3a20  ..         key: 
+00026370: 4f70 7469 6f6e 616c 5b53 6565 644f 724b  Optional[SeedOrK
+00026380: 6579 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  ey] = None,..   
+00026390: 2020 2020 2020 6474 7970 653a 2044 5479        dtype: DTy
+000263a0: 7065 4c69 6b65 203d 204e 6f6e 6529 3a0d  peLike = None):.
+000263b0: 0a20 2072 2222 220d 0a20 2044 7261 7720  .  r"""..  Draw 
+000263c0: 7361 6d70 6c65 7320 6672 6f6d 2061 2057  samples from a W
+000263d0: 616c 642c 206f 7220 696e 7665 7273 6520  ald, or inverse 
+000263e0: 4761 7573 7369 616e 2c20 6469 7374 7269  Gaussian, distri
+000263f0: 6275 7469 6f6e 2e0d 0a0d 0a20 2041 7320  bution.....  As 
+00026400: 7468 6520 7363 616c 6520 6170 7072 6f61  the scale approa
+00026410: 6368 6573 2069 6e66 696e 6974 792c 2074  ches infinity, t
+00026420: 6865 2064 6973 7472 6962 7574 696f 6e20  he distribution 
+00026430: 6265 636f 6d65 7320 6d6f 7265 206c 696b  becomes more lik
+00026440: 6520 610d 0a20 2047 6175 7373 6961 6e2e  e a..  Gaussian.
+00026450: 2053 6f6d 6520 7265 6665 7265 6e63 6573   Some references
+00026460: 2063 6c61 696d 2074 6861 7420 7468 6520   claim that the 
+00026470: 5761 6c64 2069 7320 616e 2069 6e76 6572  Wald is an inver
+00026480: 7365 2047 6175 7373 6961 6e0d 0a20 2077  se Gaussian..  w
+00026490: 6974 6820 6d65 616e 2065 7175 616c 2074  ith mean equal t
+000264a0: 6f20 312c 2062 7574 2074 6869 7320 6973  o 1, but this is
+000264b0: 2062 7920 6e6f 206d 6561 6e73 2075 6e69   by no means uni
+000264c0: 7665 7273 616c 2e0d 0a0d 0a20 2054 6865  versal.....  The
+000264d0: 2069 6e76 6572 7365 2047 6175 7373 6961   inverse Gaussia
+000264e0: 6e20 6469 7374 7269 6275 7469 6f6e 2077  n distribution w
+000264f0: 6173 2066 6972 7374 2073 7475 6469 6564  as first studied
+00026500: 2069 6e20 7265 6c61 7469 6f6e 7368 6970   in relationship
+00026510: 2074 6f0d 0a20 2042 726f 776e 6961 6e20   to..  Brownian 
+00026520: 6d6f 7469 6f6e 2e20 496e 2031 3935 3620  motion. In 1956 
+00026530: 4d2e 432e 4b2e 2054 7765 6564 6965 2075  M.C.K. Tweedie u
+00026540: 7365 6420 7468 6520 6e61 6d65 2069 6e76  sed the name inv
+00026550: 6572 7365 2047 6175 7373 6961 6e0d 0a20  erse Gaussian.. 
+00026560: 2062 6563 6175 7365 2074 6865 7265 2069   because there i
+00026570: 7320 616e 2069 6e76 6572 7365 2072 656c  s an inverse rel
+00026580: 6174 696f 6e73 6869 7020 6265 7477 6565  ationship betwee
+00026590: 6e20 7468 6520 7469 6d65 2074 6f20 636f  n the time to co
+000265a0: 7665 7220 610d 0a20 2075 6e69 7420 6469  ver a..  unit di
+000265b0: 7374 616e 6365 2061 6e64 2064 6973 7461  stance and dista
+000265c0: 6e63 6520 636f 7665 7265 6420 696e 2075  nce covered in u
+000265d0: 6e69 7420 7469 6d65 2e0d 0a0d 0a20 2050  nit time.....  P
+000265e0: 6172 616d 6574 6572 730d 0a20 202d 2d2d  arameters..  ---
+000265f0: 2d2d 2d2d 2d2d 2d0d 0a20 206d 6561 6e20  -------..  mean 
+00026600: 3a20 666c 6f61 7420 6f72 2061 7272 6179  : float or array
+00026610: 5f6c 696b 6520 6f66 2066 6c6f 6174 730d  _like of floats.
+00026620: 0a20 2020 2020 2044 6973 7472 6962 7574  .      Distribut
+00026630: 696f 6e20 6d65 616e 2c20 6d75 7374 2062  ion mean, must b
+00026640: 6520 3e20 302e 0d0a 2020 7363 616c 6520  e > 0...  scale 
+00026650: 3a20 666c 6f61 7420 6f72 2061 7272 6179  : float or array
+00026660: 5f6c 696b 6520 6f66 2066 6c6f 6174 730d  _like of floats.
+00026670: 0a20 2020 2020 2053 6361 6c65 2070 6172  .      Scale par
+00026680: 616d 6574 6572 2c20 6d75 7374 2062 6520  ameter, must be 
+00026690: 3e20 302e 0d0a 2020 7369 7a65 203a 2069  > 0...  size : i
+000266a0: 6e74 206f 7220 7475 706c 6520 6f66 2069  nt or tuple of i
+000266b0: 6e74 732c 206f 7074 696f 6e61 6c0d 0a20  nts, optional.. 
+000266c0: 2020 2020 204f 7574 7075 7420 7368 6170       Output shap
+000266d0: 652e 2020 4966 2074 6865 2067 6976 656e  e.  If the given
+000266e0: 2073 6861 7065 2069 732c 2065 2e67 2e2c   shape is, e.g.,
+000266f0: 2060 6028 6d2c 206e 2c20 6b29 6060 2c20   ``(m, n, k)``, 
+00026700: 7468 656e 0d0a 2020 2020 2020 6060 6d20  then..      ``m 
+00026710: 2a20 6e20 2a20 6b60 6020 7361 6d70 6c65  * n * k`` sample
+00026720: 7320 6172 6520 6472 6177 6e2e 2020 4966  s are drawn.  If
+00026730: 2073 697a 6520 6973 2060 604e 6f6e 6560   size is ``None`
+00026740: 6020 2864 6566 6175 6c74 292c 0d0a 2020  ` (default),..  
+00026750: 2020 2020 6120 7369 6e67 6c65 2076 616c      a single val
+00026760: 7565 2069 7320 7265 7475 726e 6564 2069  ue is returned i
+00026770: 6620 6060 6d65 616e 6060 2061 6e64 2060  f ``mean`` and `
+00026780: 6073 6361 6c65 6060 2061 7265 2062 6f74  `scale`` are bot
+00026790: 6820 7363 616c 6172 732e 0d0a 2020 2020  h scalars...    
+000267a0: 2020 4f74 6865 7277 6973 652c 2060 606e    Otherwise, ``n
+000267b0: 702e 6272 6f61 6463 6173 7428 6d65 616e  p.broadcast(mean
+000267c0: 2c20 7363 616c 6529 2e73 697a 6560 6020  , scale).size`` 
+000267d0: 7361 6d70 6c65 7320 6172 6520 6472 6177  samples are draw
+000267e0: 6e2e 0d0a 2020 6b65 7920 3a20 5052 4e47  n...  key : PRNG
+000267f0: 4b65 792c 206f 7074 696f 6e61 6c0d 0a20  Key, optional.. 
+00026800: 2020 2020 2054 6865 206b 6579 2066 6f72       The key for
+00026810: 2074 6865 2072 616e 646f 6d20 6e75 6d62   the random numb
+00026820: 6572 2067 656e 6572 6174 6f72 2e20 4966  er generator. If
+00026830: 206e 6f74 2067 6976 656e 2c20 7468 650d   not given, the.
+00026840: 0a20 2020 2020 2064 6566 6175 6c74 2072  .      default r
+00026850: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
+00026860: 6572 6174 6f72 2069 7320 7573 6564 2e0d  erator is used..
+00026870: 0a0d 0a20 2052 6574 7572 6e73 0d0a 2020  ...  Returns..  
+00026880: 2d2d 2d2d 2d2d 2d0d 0a20 206f 7574 203a  -------..  out :
+00026890: 206e 6461 7272 6179 206f 7220 7363 616c   ndarray or scal
+000268a0: 6172 0d0a 2020 2020 2020 4472 6177 6e20  ar..      Drawn 
+000268b0: 7361 6d70 6c65 7320 6672 6f6d 2074 6865  samples from the
+000268c0: 2070 6172 616d 6574 6572 697a 6564 2057   parameterized W
+000268d0: 616c 6420 6469 7374 7269 6275 7469 6f6e  ald distribution
+000268e0: 2e0d 0a0d 0a20 204e 6f74 6573 0d0a 2020  .....  Notes..  
+000268f0: 2d2d 2d2d 2d0d 0a20 2054 6865 2070 726f  -----..  The pro
+00026900: 6261 6269 6c69 7479 2064 656e 7369 7479  bability density
+00026910: 2066 756e 6374 696f 6e20 666f 7220 7468   function for th
+00026920: 6520 5761 6c64 2064 6973 7472 6962 7574  e Wald distribut
+00026930: 696f 6e20 6973 0d0a 0d0a 2020 2e2e 206d  ion is....  .. m
+00026940: 6174 683a 3a20 5028 783b 6d65 616e 2c73  ath:: P(x;mean,s
+00026950: 6361 6c65 2920 3d20 5c73 7172 747b 5c66  cale) = \sqrt{\f
+00026960: 7261 637b 7363 616c 657d 7b32 5c70 6920  rac{scale}{2\pi 
+00026970: 785e 337d 7d65 5e0d 0a20 2020 2020 2020  x^3}}e^..       
+00026980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026990: 2020 2020 2020 205c 6672 6163 7b2d 7363         \frac{-sc
+000269a0: 616c 6528 782d 6d65 616e 295e 327d 7b32  ale(x-mean)^2}{2
+000269b0: 5c63 646f 7470 206d 6561 6e5e 3278 7d0d  \cdotp mean^2x}.
+000269c0: 0a0d 0a20 2041 7320 6e6f 7465 6420 6162  ...  As noted ab
+000269d0: 6f76 6520 7468 6520 696e 7665 7273 6520  ove the inverse 
+000269e0: 4761 7573 7369 616e 2064 6973 7472 6962  Gaussian distrib
+000269f0: 7574 696f 6e20 6669 7273 7420 6172 6973  ution first aris
+00026a00: 650d 0a20 2066 726f 6d20 6174 7465 6d70  e..  from attemp
+00026a10: 7473 2074 6f20 6d6f 6465 6c20 4272 6f77  ts to model Brow
+00026a20: 6e69 616e 206d 6f74 696f 6e2e 2049 7420  nian motion. It 
+00026a30: 6973 2061 6c73 6f20 610d 0a20 2063 6f6d  is also a..  com
+00026a40: 7065 7469 746f 7220 746f 2074 6865 2057  petitor to the W
+00026a50: 6569 6275 6c6c 2066 6f72 2075 7365 2069  eibull for use i
+00026a60: 6e20 7265 6c69 6162 696c 6974 7920 6d6f  n reliability mo
+00026a70: 6465 6c69 6e67 2061 6e64 0d0a 2020 6d6f  deling and..  mo
+00026a80: 6465 6c69 6e67 2073 746f 636b 2072 6574  deling stock ret
+00026a90: 7572 6e73 2061 6e64 2069 6e74 6572 6573  urns and interes
+00026aa0: 7420 7261 7465 2070 726f 6365 7373 6573  t rate processes
+00026ab0: 2e0d 0a0d 0a20 2052 6566 6572 656e 6365  .....  Reference
+00026ac0: 730d 0a20 202d 2d2d 2d2d 2d2d 2d2d 2d0d  s..  ----------.
+00026ad0: 0a20 202e 2e20 5b31 5d20 4272 6967 6874  .  .. [1] Bright
+00026ae0: 6f6e 2057 6562 7320 4c74 642e 2c20 5761  on Webs Ltd., Wa
+00026af0: 6c64 2044 6973 7472 6962 7574 696f 6e2c  ld Distribution,
+00026b00: 0d0a 2020 2020 2020 2020 2068 7474 7073  ..         https
+00026b10: 3a2f 2f77 6562 2e61 7263 6869 7665 2e6f  ://web.archive.o
+00026b20: 7267 2f77 6562 2f32 3030 3930 3432 3330  rg/web/200904230
+00026b30: 3134 3031 302f 6874 7470 3a2f 2f77 7777  14010/http://www
+00026b40: 2e62 7269 6768 746f 6e2d 7765 6273 2e63  .brighton-webs.c
+00026b50: 6f2e 756b 3a38 302f 6469 7374 7269 6275  o.uk:80/distribu
+00026b60: 7469 6f6e 732f 7761 6c64 2e61 7370 0d0a  tions/wald.asp..
+00026b70: 2020 2e2e 205b 325d 2043 6868 696b 6172    .. [2] Chhikar
+00026b80: 612c 2052 616a 2053 2e2c 2061 6e64 2046  a, Raj S., and F
+00026b90: 6f6c 6b73 2c20 4a2e 204c 6572 6f79 2c20  olks, J. Leroy, 
+00026ba0: 2254 6865 2049 6e76 6572 7365 2047 6175  "The Inverse Gau
+00026bb0: 7373 6961 6e0d 0a20 2020 2020 2020 2020  ssian..         
+00026bc0: 4469 7374 7269 6275 7469 6f6e 3a20 5468  Distribution: Th
+00026bd0: 656f 7279 203a 204d 6574 686f 646f 6c6f  eory : Methodolo
+00026be0: 6779 2c20 616e 6420 4170 706c 6963 6174  gy, and Applicat
+00026bf0: 696f 6e73 222c 2043 5243 2050 7265 7373  ions", CRC Press
+00026c00: 2c0d 0a20 2020 2020 2020 2020 3139 3838  ,..         1988
+00026c10: 2e0d 0a20 202e 2e20 5b33 5d20 5769 6b69  ...  .. [3] Wiki
+00026c20: 7065 6469 612c 2022 496e 7665 7273 6520  pedia, "Inverse 
+00026c30: 4761 7573 7369 616e 2064 6973 7472 6962  Gaussian distrib
+00026c40: 7574 696f 6e22 0d0a 2020 2020 2020 2020  ution"..        
+00026c50: 2068 7474 7073 3a2f 2f65 6e2e 7769 6b69   https://en.wiki
+00026c60: 7065 6469 612e 6f72 672f 7769 6b69 2f49  pedia.org/wiki/I
+00026c70: 6e76 6572 7365 5f47 6175 7373 6961 6e5f  nverse_Gaussian_
+00026c80: 6469 7374 7269 6275 7469 6f6e 0d0a 0d0a  distribution....
+00026c90: 2020 4578 616d 706c 6573 0d0a 2020 2d2d    Examples..  --
+00026ca0: 2d2d 2d2d 2d2d 0d0a 2020 4472 6177 2076  ------..  Draw v
+00026cb0: 616c 7565 7320 6672 6f6d 2074 6865 2064  alues from the d
+00026cc0: 6973 7472 6962 7574 696f 6e20 616e 6420  istribution and 
+00026cd0: 706c 6f74 2074 6865 2068 6973 746f 6772  plot the histogr
+00026ce0: 616d 3a0d 0a0d 0a20 203e 3e3e 2069 6d70  am:....  >>> imp
+00026cf0: 6f72 7420 6d61 7470 6c6f 746c 6962 2e70  ort matplotlib.p
+00026d00: 7970 6c6f 7420 6173 2070 6c74 2020 2320  yplot as plt  # 
+00026d10: 6e6f 7161 0d0a 2020 3e3e 3e20 6820 3d20  noqa..  >>> h = 
+00026d20: 706c 742e 6869 7374 2862 7261 696e 636f  plt.hist(brainco
+00026d30: 7265 2e72 616e 646f 6d2e 7761 6c64 2833  re.random.wald(3
+00026d40: 2c20 322c 2031 3030 3030 3029 2c20 6269  , 2, 100000), bi
+00026d50: 6e73 3d32 3030 2c20 6465 6e73 6974 793d  ns=200, density=
+00026d60: 5472 7565 290d 0a20 203e 3e3e 2070 6c74  True)..  >>> plt
+00026d70: 2e73 686f 7728 290d 0a20 2022 2222 0d0a  .show()..  """..
+00026d80: 2020 7265 7475 726e 2044 4546 4155 4c54    return DEFAULT
+00026d90: 2e77 616c 6428 6d65 616e 2c20 7363 616c  .wald(mean, scal
+00026da0: 652c 2073 697a 652c 206b 6579 3d6b 6579  e, size, key=key
+00026db0: 2c20 6474 7970 653d 6474 7970 6529 0d0a  , dtype=dtype)..
+00026dc0: 0d0a 0d0a 6465 6620 7765 6962 756c 6c28  ....def weibull(
+00026dd0: 612c 0d0a 2020 2020 2020 2020 2020 2020  a,..            
+00026de0: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b53  size: Optional[S
+00026df0: 697a 655d 203d 204e 6f6e 652c 0d0a 2020  ize] = None,..  
+00026e00: 2020 2020 2020 2020 2020 6b65 793a 204f            key: O
+00026e10: 7074 696f 6e61 6c5b 5365 6564 4f72 4b65  ptional[SeedOrKe
+00026e20: 795d 203d 204e 6f6e 652c 0d0a 2020 2020  y] = None,..    
+00026e30: 2020 2020 2020 2020 6474 7970 653a 2044          dtype: D
+00026e40: 5479 7065 4c69 6b65 203d 204e 6f6e 6529  TypeLike = None)
+00026e50: 3a0d 0a20 2072 2222 220d 0a20 2044 7261  :..  r"""..  Dra
+00026e60: 7720 7361 6d70 6c65 7320 6672 6f6d 2061  w samples from a
+00026e70: 2057 6569 6275 6c6c 2064 6973 7472 6962   Weibull distrib
+00026e80: 7574 696f 6e2e 0d0a 0d0a 2020 4472 6177  ution.....  Draw
+00026e90: 2073 616d 706c 6573 2066 726f 6d20 6120   samples from a 
+00026ea0: 312d 7061 7261 6d65 7465 7220 5765 6962  1-parameter Weib
+00026eb0: 756c 6c20 6469 7374 7269 6275 7469 6f6e  ull distribution
+00026ec0: 2077 6974 6820 7468 6520 6769 7665 6e0d   with the given.
+00026ed0: 0a20 2073 6861 7065 2070 6172 616d 6574  .  shape paramet
+00026ee0: 6572 2060 6160 2e0d 0a0d 0a20 202e 2e20  er `a`.....  .. 
+00026ef0: 6d61 7468 3a3a 2058 203d 2028 2d6c 6e28  math:: X = (-ln(
+00026f00: 5529 295e 7b31 2f61 7d0d 0a0d 0a20 2048  U))^{1/a}....  H
+00026f10: 6572 652c 2055 2069 7320 6472 6177 6e20  ere, U is drawn 
+00026f20: 6672 6f6d 2074 6865 2075 6e69 666f 726d  from the uniform
+00026f30: 2064 6973 7472 6962 7574 696f 6e20 6f76   distribution ov
+00026f40: 6572 2028 302c 315d 2e0d 0a0d 0a20 2054  er (0,1].....  T
+00026f50: 6865 206d 6f72 6520 636f 6d6d 6f6e 2032  he more common 2
+00026f60: 2d70 6172 616d 6574 6572 2057 6569 6275  -parameter Weibu
+00026f70: 6c6c 2c20 696e 636c 7564 696e 6720 6120  ll, including a 
+00026f80: 7363 616c 6520 7061 7261 6d65 7465 720d  scale parameter.
+00026f90: 0a20 203a 6d61 7468 3a60 5c6c 616d 6264  .  :math:`\lambd
+00026fa0: 6160 2069 7320 6a75 7374 203a 6d61 7468  a` is just :math
+00026fb0: 3a60 5820 3d20 5c6c 616d 6264 6128 2d6c  :`X = \lambda(-l
+00026fc0: 6e28 5529 295e 7b31 2f61 7d60 2e0d 0a0d  n(U))^{1/a}`....
+00026fd0: 0a20 202e 2e20 6e6f 7465 3a3a 0d0a 2020  .  .. note::..  
+00026fe0: 2020 2020 4e65 7720 636f 6465 2073 686f      New code sho
+00026ff0: 756c 6420 7573 6520 7468 6520 6060 7765  uld use the ``we
+00027000: 6962 756c 6c60 6020 6d65 7468 6f64 206f  ibull`` method o
+00027010: 6620 6120 6060 6465 6661 756c 745f 726e  f a ``default_rn
+00027020: 6728 2960 600d 0a20 2020 2020 2069 6e73  g()``..      ins
+00027030: 7461 6e63 6520 696e 7374 6561 643b 2070  tance instead; p
+00027040: 6c65 6173 6520 7365 6520 7468 6520 3a72  lease see the :r
+00027050: 6566 3a60 7261 6e64 6f6d 2d71 7569 636b  ef:`random-quick
+00027060: 2d73 7461 7274 602e 0d0a 0d0a 2020 5061  -start`.....  Pa
+00027070: 7261 6d65 7465 7273 0d0a 2020 2d2d 2d2d  rameters..  ----
+00027080: 2d2d 2d2d 2d2d 0d0a 2020 6120 3a20 666c  ------..  a : fl
+00027090: 6f61 7420 6f72 2061 7272 6179 5f6c 696b  oat or array_lik
+000270a0: 6520 6f66 2066 6c6f 6174 730d 0a20 2020  e of floats..   
+000270b0: 2020 2053 6861 7065 2070 6172 616d 6574     Shape paramet
+000270c0: 6572 206f 6620 7468 6520 6469 7374 7269  er of the distri
+000270d0: 6275 7469 6f6e 2e20 204d 7573 7420 6265  bution.  Must be
+000270e0: 206e 6f6e 6e65 6761 7469 7665 2e0d 0a20   nonnegative... 
+000270f0: 2073 697a 6520 3a20 696e 7420 6f72 2074   size : int or t
+00027100: 7570 6c65 206f 6620 696e 7473 2c20 6f70  uple of ints, op
+00027110: 7469 6f6e 616c 0d0a 2020 2020 2020 4f75  tional..      Ou
+00027120: 7470 7574 2073 6861 7065 2e20 2049 6620  tput shape.  If 
+00027130: 7468 6520 6769 7665 6e20 7368 6170 6520  the given shape 
+00027140: 6973 2c20 652e 672e 2c20 6060 286d 2c20  is, e.g., ``(m, 
+00027150: 6e2c 206b 2960 602c 2074 6865 6e0d 0a20  n, k)``, then.. 
+00027160: 2020 2020 2060 606d 202a 206e 202a 206b       ``m * n * k
+00027170: 6060 2073 616d 706c 6573 2061 7265 2064  `` samples are d
+00027180: 7261 776e 2e20 2049 6620 7369 7a65 2069  rawn.  If size i
+00027190: 7320 6060 4e6f 6e65 6060 2028 6465 6661  s ``None`` (defa
+000271a0: 756c 7429 2c0d 0a20 2020 2020 2061 2073  ult),..      a s
+000271b0: 696e 676c 6520 7661 6c75 6520 6973 2072  ingle value is r
+000271c0: 6574 7572 6e65 6420 6966 2060 6061 6060  eturned if ``a``
+000271d0: 2069 7320 6120 7363 616c 6172 2e20 204f   is a scalar.  O
+000271e0: 7468 6572 7769 7365 2c0d 0a20 2020 2020  therwise,..     
+000271f0: 2060 606e 702e 6172 7261 7928 6129 2e73   ``np.array(a).s
+00027200: 697a 6560 6020 7361 6d70 6c65 7320 6172  ize`` samples ar
+00027210: 6520 6472 6177 6e2e 0d0a 2020 6b65 7920  e drawn...  key 
+00027220: 3a20 5052 4e47 4b65 792c 206f 7074 696f  : PRNGKey, optio
+00027230: 6e61 6c0d 0a20 2020 2020 2054 6865 206b  nal..      The k
+00027240: 6579 2066 6f72 2074 6865 2072 616e 646f  ey for the rando
+00027250: 6d20 6e75 6d62 6572 2067 656e 6572 6174  m number generat
+00027260: 6f72 2e20 4966 206e 6f74 2067 6976 656e  or. If not given
+00027270: 2c20 7468 650d 0a20 2020 2020 2064 6566  , the..      def
+00027280: 6175 6c74 2072 616e 646f 6d20 6e75 6d62  ault random numb
+00027290: 6572 2067 656e 6572 6174 6f72 2069 7320  er generator is 
+000272a0: 7573 6564 2e0d 0a0d 0a20 2052 6574 7572  used.....  Retur
+000272b0: 6e73 0d0a 2020 2d2d 2d2d 2d2d 2d0d 0a20  ns..  -------.. 
+000272c0: 206f 7574 203a 206e 6461 7272 6179 206f   out : ndarray o
+000272d0: 7220 7363 616c 6172 0d0a 2020 2020 2020  r scalar..      
+000272e0: 4472 6177 6e20 7361 6d70 6c65 7320 6672  Drawn samples fr
+000272f0: 6f6d 2074 6865 2070 6172 616d 6574 6572  om the parameter
+00027300: 697a 6564 2057 6569 6275 6c6c 2064 6973  ized Weibull dis
+00027310: 7472 6962 7574 696f 6e2e 0d0a 0d0a 2020  tribution.....  
+00027320: 4e6f 7465 730d 0a20 202d 2d2d 2d2d 0d0a  Notes..  -----..
+00027330: 2020 5468 6520 5765 6962 756c 6c20 286f    The Weibull (o
+00027340: 7220 5479 7065 2049 4949 2061 7379 6d70  r Type III asymp
+00027350: 746f 7469 6320 6578 7472 656d 6520 7661  totic extreme va
+00027360: 6c75 6520 6469 7374 7269 6275 7469 6f6e  lue distribution
+00027370: 0d0a 2020 666f 7220 736d 616c 6c65 7374  ..  for smallest
+00027380: 2076 616c 7565 732c 2053 4556 2054 7970   values, SEV Typ
+00027390: 6520 4949 492c 206f 7220 526f 7369 6e2d  e III, or Rosin-
+000273a0: 5261 6d6d 6c65 720d 0a20 2064 6973 7472  Rammler..  distr
+000273b0: 6962 7574 696f 6e29 2069 7320 6f6e 6520  ibution) is one 
+000273c0: 6f66 2061 2063 6c61 7373 206f 6620 4765  of a class of Ge
+000273d0: 6e65 7261 6c69 7a65 6420 4578 7472 656d  neralized Extrem
+000273e0: 6520 5661 6c75 650d 0a20 2028 4745 5629  e Value..  (GEV)
+000273f0: 2064 6973 7472 6962 7574 696f 6e73 2075   distributions u
+00027400: 7365 6420 696e 206d 6f64 656c 696e 6720  sed in modeling 
+00027410: 6578 7472 656d 6520 7661 6c75 6520 7072  extreme value pr
+00027420: 6f62 6c65 6d73 2e0d 0a20 2054 6869 7320  oblems...  This 
+00027430: 636c 6173 7320 696e 636c 7564 6573 2074  class includes t
+00027440: 6865 2047 756d 6265 6c20 616e 6420 4672  he Gumbel and Fr
+00027450: 6563 6865 7420 6469 7374 7269 6275 7469  echet distributi
+00027460: 6f6e 732e 0d0a 0d0a 2020 5468 6520 7072  ons.....  The pr
+00027470: 6f62 6162 696c 6974 7920 6465 6e73 6974  obability densit
+00027480: 7920 666f 7220 7468 6520 5765 6962 756c  y for the Weibul
+00027490: 6c20 6469 7374 7269 6275 7469 6f6e 2069  l distribution i
+000274a0: 730d 0a0d 0a20 202e 2e20 6d61 7468 3a3a  s....  .. math::
+000274b0: 2070 2878 2920 3d20 5c66 7261 637b 617d   p(x) = \frac{a}
+000274c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000274d0: 2020 2020 207b 5c6c 616d 6264 617d 285c       {\lambda}(\
+000274e0: 6672 6163 7b78 7d7b 5c6c 616d 6264 617d  frac{x}{\lambda}
+000274f0: 295e 7b61 2d31 7d65 5e7b 2d28 782f 5c6c  )^{a-1}e^{-(x/\l
+00027500: 616d 6264 6129 5e61 7d2c 0d0a 0d0a 2020  ambda)^a},....  
+00027510: 7768 6572 6520 3a6d 6174 683a 6061 6020  where :math:`a` 
+00027520: 6973 2074 6865 2073 6861 7065 2061 6e64  is the shape and
+00027530: 203a 6d61 7468 3a60 5c6c 616d 6264 6160   :math:`\lambda`
+00027540: 2074 6865 2073 6361 6c65 2e0d 0a0d 0a20   the scale..... 
+00027550: 2054 6865 2066 756e 6374 696f 6e20 6861   The function ha
+00027560: 7320 6974 7320 7065 616b 2028 7468 6520  s its peak (the 
+00027570: 6d6f 6465 2920 6174 0d0a 2020 3a6d 6174  mode) at..  :mat
+00027580: 683a 605c 6c61 6d62 6461 285c 6672 6163  h:`\lambda(\frac
+00027590: 7b61 2d31 7d7b 617d 295e 7b31 2f61 7d60  {a-1}{a})^{1/a}`
+000275a0: 2e0d 0a0d 0a20 2057 6865 6e20 6060 6120  .....  When ``a 
+000275b0: 3d20 3160 602c 2074 6865 2057 6569 6275  = 1``, the Weibu
+000275c0: 6c6c 2064 6973 7472 6962 7574 696f 6e20  ll distribution 
+000275d0: 7265 6475 6365 7320 746f 2074 6865 2065  reduces to the e
+000275e0: 7870 6f6e 656e 7469 616c 0d0a 2020 6469  xponential..  di
+000275f0: 7374 7269 6275 7469 6f6e 2e0d 0a0d 0a20  stribution..... 
+00027600: 2052 6566 6572 656e 6365 730d 0a20 202d   References..  -
+00027610: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 202e 2e20  ---------..  .. 
+00027620: 5b31 5d20 5761 6c6f 6464 6920 5765 6962  [1] Waloddi Weib
+00027630: 756c 6c2c 2052 6f79 616c 2054 6563 686e  ull, Royal Techn
+00027640: 6963 616c 2055 6e69 7665 7273 6974 792c  ical University,
+00027650: 2053 746f 636b 686f 6c6d 2c0d 0a20 2020   Stockholm,..   
+00027660: 2020 2020 2020 3139 3339 2022 4120 5374        1939 "A St
+00027670: 6174 6973 7469 6361 6c20 5468 656f 7279  atistical Theory
+00027680: 204f 6620 5468 6520 5374 7265 6e67 7468   Of The Strength
+00027690: 204f 6620 4d61 7465 7269 616c 7322 2c0d   Of Materials",.
+000276a0: 0a20 2020 2020 2020 2020 496e 6765 6e69  .         Ingeni
+000276b0: 6f72 7376 6574 656e 736b 6170 7361 6b61  orsvetenskapsaka
+000276c0: 6465 6d69 656e 7320 4861 6e64 6c69 6e67  demiens Handling
+000276d0: 6172 204e 7220 3135 312c 2031 3933 392c  ar Nr 151, 1939,
+000276e0: 0d0a 2020 2020 2020 2020 2047 656e 6572  ..         Gener
+000276f0: 616c 7374 6162 656e 7320 4c69 746f 6772  alstabens Litogr
+00027700: 6166 6973 6b61 2041 6e73 7461 6c74 7320  afiska Anstalts 
+00027710: 466f 726c 6167 2c20 5374 6f63 6b68 6f6c  Forlag, Stockhol
+00027720: 6d2e 0d0a 2020 2e2e 205b 325d 2057 616c  m...  .. [2] Wal
+00027730: 6f64 6469 2057 6569 6275 6c6c 2c20 2241  oddi Weibull, "A
+00027740: 2053 7461 7469 7374 6963 616c 2044 6973   Statistical Dis
+00027750: 7472 6962 7574 696f 6e20 4675 6e63 7469  tribution Functi
+00027760: 6f6e 206f 660d 0a20 2020 2020 2020 2020  on of..         
+00027770: 5769 6465 2041 7070 6c69 6361 6269 6c69  Wide Applicabili
+00027780: 7479 222c 204a 6f75 726e 616c 204f 6620  ty", Journal Of 
+00027790: 4170 706c 6965 6420 4d65 6368 616e 6963  Applied Mechanic
+000277a0: 7320 4153 4d45 2050 6170 6572 0d0a 2020  s ASME Paper..  
+000277b0: 2020 2020 2020 2031 3935 312e 0d0a 2020         1951...  
+000277c0: 2e2e 205b 335d 2057 696b 6970 6564 6961  .. [3] Wikipedia
+000277d0: 2c20 2257 6569 6275 6c6c 2064 6973 7472  , "Weibull distr
+000277e0: 6962 7574 696f 6e22 2c0d 0a20 2020 2020  ibution",..     
+000277f0: 2020 2020 6874 7470 733a 2f2f 656e 2e77      https://en.w
+00027800: 696b 6970 6564 6961 2e6f 7267 2f77 696b  ikipedia.org/wik
+00027810: 692f 5765 6962 756c 6c5f 6469 7374 7269  i/Weibull_distri
+00027820: 6275 7469 6f6e 0d0a 0d0a 2020 4578 616d  bution....  Exam
+00027830: 706c 6573 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ples..  --------
+00027840: 0d0a 2020 4472 6177 2073 616d 706c 6573  ..  Draw samples
+00027850: 2066 726f 6d20 7468 6520 6469 7374 7269   from the distri
+00027860: 6275 7469 6f6e 3a0d 0a0d 0a20 203e 3e3e  bution:....  >>>
+00027870: 2061 203d 2035 2e20 2320 7368 6170 650d   a = 5. # shape.
+00027880: 0a20 203e 3e3e 2073 203d 2062 7261 696e  .  >>> s = brain
+00027890: 636f 7265 2e6d 6174 682e 7261 6e64 6f6d  core.math.random
+000278a0: 2e77 6569 6275 6c6c 2861 2c20 3130 3030  .weibull(a, 1000
+000278b0: 290d 0a0d 0a20 2044 6973 706c 6179 2074  )....  Display t
+000278c0: 6865 2068 6973 746f 6772 616d 206f 6620  he histogram of 
+000278d0: 7468 6520 7361 6d70 6c65 732c 2061 6c6f  the samples, alo
+000278e0: 6e67 2077 6974 680d 0a20 2074 6865 2070  ng with..  the p
+000278f0: 726f 6261 6269 6c69 7479 2064 656e 7369  robability densi
+00027900: 7479 2066 756e 6374 696f 6e3a 0d0a 0d0a  ty function:....
+00027910: 2020 3e3e 3e20 696d 706f 7274 206d 6174    >>> import mat
+00027920: 706c 6f74 6c69 622e 7079 706c 6f74 2061  plotlib.pyplot a
+00027930: 7320 706c 7420 2023 206e 6f71 610d 0a20  s plt  # noqa.. 
+00027940: 203e 3e3e 2078 203d 206e 702e 6172 616e   >>> x = np.aran
+00027950: 6765 2831 2c31 3030 2e29 2f35 302e 0d0a  ge(1,100.)/50...
+00027960: 2020 3e3e 3e20 6465 6620 7765 6962 2878    >>> def weib(x
+00027970: 2c6e 2c61 293a 0d0a 2020 2e2e 2e20 2020  ,n,a):..  ...   
+00027980: 2020 7265 7475 726e 2028 6120 2f20 6e29    return (a / n)
+00027990: 202a 2028 7820 2f20 6e29 2a2a 2861 202d   * (x / n)**(a -
+000279a0: 2031 2920 2a20 6e70 2e65 7870 282d 2878   1) * np.exp(-(x
+000279b0: 202f 206e 292a 2a61 290d 0a0d 0a20 203e   / n)**a)....  >
+000279c0: 3e3e 2063 6f75 6e74 2c20 6269 6e73 2c20  >> count, bins, 
+000279d0: 6967 6e6f 7265 6420 3d20 706c 742e 6869  ignored = plt.hi
+000279e0: 7374 2862 7261 696e 636f 7265 2e6d 6174  st(braincore.mat
+000279f0: 682e 7261 6e64 6f6d 2e77 6569 6275 6c6c  h.random.weibull
+00027a00: 2835 2e2c 3130 3030 2929 0d0a 2020 3e3e  (5.,1000))..  >>
+00027a10: 3e20 7820 3d20 6e70 2e61 7261 6e67 6528  > x = np.arange(
+00027a20: 312c 3130 302e 292f 3530 2e0d 0a20 203e  1,100.)/50...  >
+00027a30: 3e3e 2073 6361 6c65 203d 2063 6f75 6e74  >> scale = count
+00027a40: 2e6d 6178 2829 2f77 6569 6228 782c 2031  .max()/weib(x, 1
+00027a50: 2e2c 2035 2e29 2e6d 6178 2829 0d0a 2020  ., 5.).max()..  
+00027a60: 3e3e 3e20 706c 742e 706c 6f74 2878 2c20  >>> plt.plot(x, 
+00027a70: 7765 6962 2878 2c20 312e 2c20 352e 292a  weib(x, 1., 5.)*
+00027a80: 7363 616c 6529 0d0a 2020 3e3e 3e20 706c  scale)..  >>> pl
+00027a90: 742e 7368 6f77 2829 0d0a 0d0a 2020 2222  t.show()....  ""
+00027aa0: 220d 0a20 2072 6574 7572 6e20 4445 4641  "..  return DEFA
+00027ab0: 554c 542e 7765 6962 756c 6c28 612c 2073  ULT.weibull(a, s
+00027ac0: 697a 652c 206b 6579 3d6b 6579 2c20 6474  ize, key=key, dt
+00027ad0: 7970 653d 6474 7970 6529 0d0a 0d0a 0d0a  ype=dtype)......
+00027ae0: 6465 6620 7765 6962 756c 6c5f 6d69 6e28  def weibull_min(
+00027af0: 612c 0d0a 2020 2020 2020 2020 2020 2020  a,..            
+00027b00: 2020 2020 7363 616c 653d 4e6f 6e65 2c0d      scale=None,.
+00027b10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027b20: 2073 697a 653a 204f 7074 696f 6e61 6c5b   size: Optional[
+00027b30: 5369 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20  Size] = None,.. 
+00027b40: 2020 2020 2020 2020 2020 2020 2020 206b                 k
+00027b50: 6579 3a20 4f70 7469 6f6e 616c 5b53 6565  ey: Optional[See
+00027b60: 644f 724b 6579 5d20 3d20 4e6f 6e65 2c0d  dOrKey] = None,.
+00027b70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027b80: 2064 7479 7065 3a20 4454 7970 654c 696b   dtype: DTypeLik
+00027b90: 6520 3d20 4e6f 6e65 293a 0d0a 2020 2222  e = None):..  ""
+00027ba0: 2253 616d 706c 6520 6672 6f6d 2061 2057  "Sample from a W
+00027bb0: 6569 6275 6c6c 2064 6973 7472 6962 7574  eibull distribut
+00027bc0: 696f 6e2e 0d0a 0d0a 2020 5468 6520 7363  ion.....  The sc
+00027bd0: 6970 7920 636f 756e 7465 7270 6172 7420  ipy counterpart 
+00027be0: 6973 2060 7363 6970 792e 7374 6174 732e  is `scipy.stats.
+00027bf0: 7765 6962 756c 6c5f 6d69 6e60 2e0d 0a0d  weibull_min`....
+00027c00: 0a20 2041 7267 733a 0d0a 2020 2020 7363  .  Args:..    sc
+00027c10: 616c 653a 2054 6865 2073 6361 6c65 2070  ale: The scale p
+00027c20: 6172 616d 6574 6572 206f 6620 7468 6520  arameter of the 
+00027c30: 6469 7374 7269 6275 7469 6f6e 2e0d 0a20  distribution... 
+00027c40: 2020 2063 6f6e 6365 6e74 7261 7469 6f6e     concentration
+00027c50: 3a20 5468 6520 636f 6e63 656e 7472 6174  : The concentrat
+00027c60: 696f 6e20 7061 7261 6d65 7465 7220 6f66  ion parameter of
+00027c70: 2074 6865 2064 6973 7472 6962 7574 696f   the distributio
+00027c80: 6e2e 0d0a 2020 2020 7368 6170 653a 2054  n...    shape: T
+00027c90: 6865 2073 6861 7065 2061 6464 6564 2074  he shape added t
+00027ca0: 6f20 7468 6520 7061 7261 6d65 7465 7273  o the parameters
+00027cb0: 206c 6f63 2061 6e64 2073 6361 6c65 2062   loc and scale b
+00027cc0: 726f 6164 6361 7374 6162 6c65 2073 6861  roadcastable sha
+00027cd0: 7065 2e0d 0a20 2020 2064 7479 7065 3a20  pe...    dtype: 
+00027ce0: 5468 6520 7479 7065 2075 7365 6420 666f  The type used fo
+00027cf0: 7220 7361 6d70 6c65 732e 0d0a 2020 2020  r samples...    
+00027d00: 6b65 793a 2061 2050 524e 4720 6b65 7920  key: a PRNG key 
+00027d10: 6f72 2061 2073 6565 642e 0d0a 0d0a 2020  or a seed.....  
+00027d20: 5265 7475 726e 733a 0d0a 2020 2020 4120  Returns:..    A 
+00027d30: 6a6e 702e 6172 7261 7920 6f66 2073 616d  jnp.array of sam
+00027d40: 706c 6573 2e0d 0a0d 0a20 2022 2222 0d0a  ples.....  """..
+00027d50: 2020 7265 7475 726e 2044 4546 4155 4c54    return DEFAULT
+00027d60: 2e77 6569 6275 6c6c 5f6d 696e 2861 2c20  .weibull_min(a, 
+00027d70: 7363 616c 652c 2073 697a 652c 206b 6579  scale, size, key
+00027d80: 3d6b 6579 2c20 6474 7970 653d 6474 7970  =key, dtype=dtyp
+00027d90: 6529 0d0a 0d0a 0d0a 6465 6620 7a69 7066  e)......def zipf
+00027da0: 2861 2c0d 0a20 2020 2020 2020 2020 7369  (a,..         si
+00027db0: 7a65 3a20 4f70 7469 6f6e 616c 5b53 697a  ze: Optional[Siz
+00027dc0: 655d 203d 204e 6f6e 652c 0d0a 2020 2020  e] = None,..    
+00027dd0: 2020 2020 206b 6579 3a20 4f70 7469 6f6e       key: Option
+00027de0: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
+00027df0: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+00027e00: 6474 7970 653a 2044 5479 7065 4c69 6b65  dtype: DTypeLike
+00027e10: 203d 204e 6f6e 6529 3a0d 0a20 2072 2222   = None):..  r""
+00027e20: 220d 0a20 2044 7261 7720 7361 6d70 6c65  "..  Draw sample
+00027e30: 7320 6672 6f6d 2061 205a 6970 6620 6469  s from a Zipf di
+00027e40: 7374 7269 6275 7469 6f6e 2e0d 0a0d 0a20  stribution..... 
+00027e50: 2053 616d 706c 6573 2061 7265 2064 7261   Samples are dra
+00027e60: 776e 2066 726f 6d20 6120 5a69 7066 2064  wn from a Zipf d
+00027e70: 6973 7472 6962 7574 696f 6e20 7769 7468  istribution with
+00027e80: 2073 7065 6369 6669 6564 2070 6172 616d   specified param
+00027e90: 6574 6572 0d0a 2020 6061 6020 3e20 312e  eter..  `a` > 1.
+00027ea0: 0d0a 0d0a 2020 5468 6520 5a69 7066 2064  ....  The Zipf d
+00027eb0: 6973 7472 6962 7574 696f 6e20 2861 6c73  istribution (als
+00027ec0: 6f20 6b6e 6f77 6e20 6173 2074 6865 207a  o known as the z
+00027ed0: 6574 6120 6469 7374 7269 6275 7469 6f6e  eta distribution
+00027ee0: 2920 6973 2061 0d0a 2020 6469 7363 7265  ) is a..  discre
+00027ef0: 7465 2070 726f 6261 6269 6c69 7479 2064  te probability d
+00027f00: 6973 7472 6962 7574 696f 6e20 7468 6174  istribution that
+00027f10: 2073 6174 6973 6669 6573 205a 6970 6627   satisfies Zipf'
+00027f20: 7320 6c61 773a 2074 6865 0d0a 2020 6672  s law: the..  fr
+00027f30: 6571 7565 6e63 7920 6f66 2061 6e20 6974  equency of an it
+00027f40: 656d 2069 7320 696e 7665 7273 656c 7920  em is inversely 
+00027f50: 7072 6f70 6f72 7469 6f6e 616c 2074 6f20  proportional to 
+00027f60: 6974 7320 7261 6e6b 2069 6e20 610d 0a20  its rank in a.. 
+00027f70: 2066 7265 7175 656e 6379 2074 6162 6c65   frequency table
+00027f80: 2e0d 0a0d 0a20 202e 2e20 6e6f 7465 3a3a  .....  .. note::
+00027f90: 0d0a 2020 2020 2020 4e65 7720 636f 6465  ..      New code
+00027fa0: 2073 686f 756c 6420 7573 6520 7468 6520   should use the 
+00027fb0: 6060 7a69 7066 6060 206d 6574 686f 6420  ``zipf`` method 
+00027fc0: 6f66 2061 2060 6064 6566 6175 6c74 5f72  of a ``default_r
+00027fd0: 6e67 2829 6060 0d0a 2020 2020 2020 696e  ng()``..      in
+00027fe0: 7374 616e 6365 2069 6e73 7465 6164 3b20  stance instead; 
+00027ff0: 706c 6561 7365 2073 6565 2074 6865 203a  please see the :
+00028000: 7265 663a 6072 616e 646f 6d2d 7175 6963  ref:`random-quic
+00028010: 6b2d 7374 6172 7460 2e0d 0a0d 0a20 2050  k-start`.....  P
+00028020: 6172 616d 6574 6572 730d 0a20 202d 2d2d  arameters..  ---
+00028030: 2d2d 2d2d 2d2d 2d0d 0a20 2061 203a 2066  -------..  a : f
+00028040: 6c6f 6174 206f 7220 6172 7261 795f 6c69  loat or array_li
+00028050: 6b65 206f 6620 666c 6f61 7473 0d0a 2020  ke of floats..  
+00028060: 2020 2020 4469 7374 7269 6275 7469 6f6e      Distribution
+00028070: 2070 6172 616d 6574 6572 2e20 4d75 7374   parameter. Must
+00028080: 2062 6520 6772 6561 7465 7220 7468 616e   be greater than
+00028090: 2031 2e0d 0a20 2073 697a 6520 3a20 696e   1...  size : in
+000280a0: 7420 6f72 2074 7570 6c65 206f 6620 696e  t or tuple of in
+000280b0: 7473 2c20 6f70 7469 6f6e 616c 0d0a 2020  ts, optional..  
+000280c0: 2020 2020 4f75 7470 7574 2073 6861 7065      Output shape
+000280d0: 2e20 2049 6620 7468 6520 6769 7665 6e20  .  If the given 
+000280e0: 7368 6170 6520 6973 2c20 652e 672e 2c20  shape is, e.g., 
+000280f0: 6060 286d 2c20 6e2c 206b 2960 602c 2074  ``(m, n, k)``, t
+00028100: 6865 6e0d 0a20 2020 2020 2060 606d 202a  hen..      ``m *
+00028110: 206e 202a 206b 6060 2073 616d 706c 6573   n * k`` samples
+00028120: 2061 7265 2064 7261 776e 2e20 2049 6620   are drawn.  If 
+00028130: 7369 7a65 2069 7320 6060 4e6f 6e65 6060  size is ``None``
+00028140: 2028 6465 6661 756c 7429 2c0d 0a20 2020   (default),..   
+00028150: 2020 2061 2073 696e 676c 6520 7661 6c75     a single valu
+00028160: 6520 6973 2072 6574 7572 6e65 6420 6966  e is returned if
+00028170: 2060 6061 6060 2069 7320 6120 7363 616c   ``a`` is a scal
+00028180: 6172 2e20 4f74 6865 7277 6973 652c 0d0a  ar. Otherwise,..
+00028190: 2020 2020 2020 6060 6e70 2e61 7272 6179        ``np.array
+000281a0: 2861 292e 7369 7a65 6060 2073 616d 706c  (a).size`` sampl
+000281b0: 6573 2061 7265 2064 7261 776e 2e0d 0a20  es are drawn... 
+000281c0: 206b 6579 203a 2050 524e 474b 6579 2c20   key : PRNGKey, 
+000281d0: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+000281e0: 5468 6520 6b65 7920 666f 7220 7468 6520  The key for the 
+000281f0: 7261 6e64 6f6d 206e 756d 6265 7220 6765  random number ge
+00028200: 6e65 7261 746f 722e 2049 6620 6e6f 7420  nerator. If not 
+00028210: 6769 7665 6e2c 2074 6865 0d0a 2020 2020  given, the..    
+00028220: 2020 6465 6661 756c 7420 7261 6e64 6f6d    default random
+00028230: 206e 756d 6265 7220 6765 6e65 7261 746f   number generato
+00028240: 7220 6973 2075 7365 642e 0d0a 0d0a 2020  r is used.....  
+00028250: 5265 7475 726e 730d 0a20 202d 2d2d 2d2d  Returns..  -----
+00028260: 2d2d 0d0a 2020 6f75 7420 3a20 6e64 6172  --..  out : ndar
+00028270: 7261 7920 6f72 2073 6361 6c61 720d 0a20  ray or scalar.. 
+00028280: 2020 2020 2044 7261 776e 2073 616d 706c       Drawn sampl
+00028290: 6573 2066 726f 6d20 7468 6520 7061 7261  es from the para
+000282a0: 6d65 7465 7269 7a65 6420 5a69 7066 2064  meterized Zipf d
+000282b0: 6973 7472 6962 7574 696f 6e2e 0d0a 0d0a  istribution.....
+000282c0: 2020 5365 6520 416c 736f 0d0a 2020 2d2d    See Also..  --
+000282d0: 2d2d 2d2d 2d2d 0d0a 2020 7363 6970 792e  ------..  scipy.
+000282e0: 7374 6174 732e 7a69 7066 203a 2070 726f  stats.zipf : pro
+000282f0: 6261 6269 6c69 7479 2064 656e 7369 7479  bability density
+00028300: 2066 756e 6374 696f 6e2c 2064 6973 7472   function, distr
+00028310: 6962 7574 696f 6e2c 206f 720d 0a20 2020  ibution, or..   
+00028320: 2020 2063 756d 756c 6174 6976 6520 6465     cumulative de
+00028330: 6e73 6974 7920 6675 6e63 7469 6f6e 2c20  nsity function, 
+00028340: 6574 632e 0d0a 0d0a 2020 4e6f 7465 730d  etc.....  Notes.
+00028350: 0a20 202d 2d2d 2d2d 0d0a 2020 5468 6520  .  -----..  The 
+00028360: 7072 6f62 6162 696c 6974 7920 6465 6e73  probability dens
+00028370: 6974 7920 666f 7220 7468 6520 5a69 7066  ity for the Zipf
+00028380: 2064 6973 7472 6962 7574 696f 6e20 6973   distribution is
+00028390: 0d0a 0d0a 2020 2e2e 206d 6174 683a 3a20  ....  .. math:: 
+000283a0: 7028 6b29 203d 205c 6672 6163 7b6b 5e7b  p(k) = \frac{k^{
+000283b0: 2d61 7d7d 7b5c 7a65 7461 2861 297d 2c0d  -a}}{\zeta(a)},.
+000283c0: 0a0d 0a20 2066 6f72 2069 6e74 6567 6572  ...  for integer
+000283d0: 7320 3a6d 6174 683a 606b 205c 6765 7120  s :math:`k \geq 
+000283e0: 3160 2c20 7768 6572 6520 3a6d 6174 683a  1`, where :math:
+000283f0: 605c 7a65 7461 6020 6973 2074 6865 2052  `\zeta` is the R
+00028400: 6965 6d61 6e6e 205a 6574 610d 0a20 2066  iemann Zeta..  f
+00028410: 756e 6374 696f 6e2e 0d0a 0d0a 2020 4974  unction.....  It
+00028420: 2069 7320 6e61 6d65 6420 666f 7220 7468   is named for th
+00028430: 6520 416d 6572 6963 616e 206c 696e 6775  e American lingu
+00028440: 6973 7420 4765 6f72 6765 204b 696e 6773  ist George Kings
+00028450: 6c65 7920 5a69 7066 2c20 7768 6f20 6e6f  ley Zipf, who no
+00028460: 7465 640d 0a20 2074 6861 7420 7468 6520  ted..  that the 
+00028470: 6672 6571 7565 6e63 7920 6f66 2061 6e79  frequency of any
+00028480: 2077 6f72 6420 696e 2061 2073 616d 706c   word in a sampl
+00028490: 6520 6f66 2061 206c 616e 6775 6167 6520  e of a language 
+000284a0: 6973 2069 6e76 6572 7365 6c79 0d0a 2020  is inversely..  
+000284b0: 7072 6f70 6f72 7469 6f6e 616c 2074 6f20  proportional to 
+000284c0: 6974 7320 7261 6e6b 2069 6e20 7468 6520  its rank in the 
+000284d0: 6672 6571 7565 6e63 7920 7461 626c 652e  frequency table.
+000284e0: 0d0a 0d0a 2020 5265 6665 7265 6e63 6573  ....  References
+000284f0: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  ..  ----------..
+00028500: 2020 2e2e 205b 315d 205a 6970 662c 2047    .. [1] Zipf, G
+00028510: 2e20 4b2e 2c20 2253 656c 6563 7465 6420  . K., "Selected 
+00028520: 5374 7564 6965 7320 6f66 2074 6865 2050  Studies of the P
+00028530: 7269 6e63 6970 6c65 206f 6620 5265 6c61  rinciple of Rela
+00028540: 7469 7665 0d0a 2020 2020 2020 2020 2046  tive..         F
+00028550: 7265 7175 656e 6379 2069 6e20 4c61 6e67  requency in Lang
+00028560: 7561 6765 2c22 2043 616d 6272 6964 6765  uage," Cambridge
+00028570: 2c20 4d41 3a20 4861 7276 6172 6420 556e  , MA: Harvard Un
+00028580: 6976 2e20 5072 6573 732c 0d0a 2020 2020  iv. Press,..    
+00028590: 2020 2020 2031 3933 322e 0d0a 0d0a 2020       1932.....  
+000285a0: 4578 616d 706c 6573 0d0a 2020 2d2d 2d2d  Examples..  ----
+000285b0: 2d2d 2d2d 0d0a 2020 4472 6177 2073 616d  ----..  Draw sam
+000285c0: 706c 6573 2066 726f 6d20 7468 6520 6469  ples from the di
+000285d0: 7374 7269 6275 7469 6f6e 3a0d 0a0d 0a20  stribution:.... 
+000285e0: 203e 3e3e 2061 203d 2034 2e30 0d0a 2020   >>> a = 4.0..  
+000285f0: 3e3e 3e20 6e20 3d20 3230 3030 300d 0a20  >>> n = 20000.. 
+00028600: 203e 3e3e 2073 203d 2062 7261 696e 636f   >>> s = brainco
+00028610: 7265 2e6d 6174 682e 7261 6e64 6f6d 2e7a  re.math.random.z
+00028620: 6970 6628 612c 206e 290d 0a0d 0a20 2044  ipf(a, n)....  D
+00028630: 6973 706c 6179 2074 6865 2068 6973 746f  isplay the histo
+00028640: 6772 616d 206f 6620 7468 6520 7361 6d70  gram of the samp
+00028650: 6c65 732c 2061 6c6f 6e67 2077 6974 680d  les, along with.
+00028660: 0a20 2074 6865 2065 7870 6563 7465 6420  .  the expected 
+00028670: 6869 7374 6f67 7261 6d20 6261 7365 6420  histogram based 
+00028680: 6f6e 2074 6865 2070 726f 6261 6269 6c69  on the probabili
+00028690: 7479 0d0a 2020 6465 6e73 6974 7920 6675  ty..  density fu
+000286a0: 6e63 7469 6f6e 3a0d 0a0d 0a20 203e 3e3e  nction:....  >>>
+000286b0: 2069 6d70 6f72 7420 6d61 7470 6c6f 746c   import matplotl
+000286c0: 6962 2e70 7970 6c6f 7420 6173 2070 6c74  ib.pyplot as plt
+000286d0: 2020 2320 6e6f 7161 0d0a 2020 3e3e 3e20    # noqa..  >>> 
+000286e0: 6672 6f6d 2073 6369 7079 2e73 7065 6369  from scipy.speci
+000286f0: 616c 2069 6d70 6f72 7420 7a65 7461 2020  al import zeta  
+00028700: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
+00028710: 0d0a 0d0a 2020 6062 696e 636f 756e 7460  ....  `bincount`
+00028720: 2070 726f 7669 6465 7320 6120 6661 7374   provides a fast
+00028730: 2068 6973 746f 6772 616d 2066 6f72 2073   histogram for s
+00028740: 6d61 6c6c 2069 6e74 6567 6572 732e 0d0a  mall integers...
+00028750: 0d0a 2020 3e3e 3e20 636f 756e 7420 3d20  ..  >>> count = 
+00028760: 6e70 2e62 696e 636f 756e 7428 7329 0d0a  np.bincount(s)..
+00028770: 2020 3e3e 3e20 6b20 3d20 6e70 2e61 7261    >>> k = np.ara
+00028780: 6e67 6528 312c 2073 2e6d 6178 2829 202b  nge(1, s.max() +
+00028790: 2031 290d 0a0d 0a20 203e 3e3e 2070 6c74   1)....  >>> plt
+000287a0: 2e62 6172 286b 2c20 636f 756e 745b 313a  .bar(k, count[1:
+000287b0: 5d2c 2061 6c70 6861 3d30 2e35 2c20 6c61  ], alpha=0.5, la
+000287c0: 6265 6c3d 2773 616d 706c 6520 636f 756e  bel='sample coun
+000287d0: 7427 290d 0a20 203e 3e3e 2070 6c74 2e70  t')..  >>> plt.p
+000287e0: 6c6f 7428 6b2c 206e 2a28 6b2a 2a2d 6129  lot(k, n*(k**-a)
+000287f0: 2f7a 6574 6128 6129 2c20 276b 2e2d 272c  /zeta(a), 'k.-',
+00028800: 2061 6c70 6861 3d30 2e35 2c0d 0a20 202e   alpha=0.5,..  .
+00028810: 2e2e 2020 2020 2020 2020 2020 6c61 6265  ..          labe
+00028820: 6c3d 2765 7870 6563 7465 6420 636f 756e  l='expected coun
+00028830: 7427 2920 2020 2320 646f 6374 6573 743a  t')   # doctest:
+00028840: 202b 534b 4950 0d0a 2020 3e3e 3e20 706c   +SKIP..  >>> pl
+00028850: 742e 7365 6d69 6c6f 6779 2829 0d0a 2020  t.semilogy()..  
+00028860: 3e3e 3e20 706c 742e 6772 6964 2861 6c70  >>> plt.grid(alp
+00028870: 6861 3d30 2e34 290d 0a20 203e 3e3e 2070  ha=0.4)..  >>> p
+00028880: 6c74 2e6c 6567 656e 6428 290d 0a20 203e  lt.legend()..  >
+00028890: 3e3e 2070 6c74 2e74 6974 6c65 2866 275a  >> plt.title(f'Z
+000288a0: 6970 6620 7361 6d70 6c65 2c20 613d 7b61  ipf sample, a={a
+000288b0: 7d2c 2073 697a 653d 7b6e 7d27 290d 0a20  }, size={n}').. 
+000288c0: 203e 3e3e 2070 6c74 2e73 686f 7728 290d   >>> plt.show().
+000288d0: 0a20 2022 2222 0d0a 2020 7265 7475 726e  .  """..  return
+000288e0: 2044 4546 4155 4c54 2e7a 6970 6628 612c   DEFAULT.zipf(a,
+000288f0: 2073 697a 652c 206b 6579 3d6b 6579 2c20   size, key=key, 
+00028900: 6474 7970 653d 6474 7970 6529 0d0a 0d0a  dtype=dtype)....
+00028910: 0d0a 6465 6620 6d61 7877 656c 6c28 7369  ..def maxwell(si
+00028920: 7a65 3a20 4f70 7469 6f6e 616c 5b53 697a  ze: Optional[Siz
+00028930: 655d 203d 204e 6f6e 652c 0d0a 2020 2020  e] = None,..    
+00028940: 2020 2020 2020 2020 6b65 793a 204f 7074          key: Opt
+00028950: 696f 6e61 6c5b 5365 6564 4f72 4b65 795d  ional[SeedOrKey]
+00028960: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
+00028970: 2020 2020 2020 6474 7970 653a 2044 5479        dtype: DTy
+00028980: 7065 4c69 6b65 203d 204e 6f6e 6529 3a0d  peLike = None):.
+00028990: 0a20 2022 2222 5361 6d70 6c65 2066 726f  .  """Sample fro
+000289a0: 6d20 6120 6f6e 6520 7369 6465 6420 4d61  m a one sided Ma
+000289b0: 7877 656c 6c20 6469 7374 7269 6275 7469  xwell distributi
+000289c0: 6f6e 2e0d 0a0d 0a20 2054 6865 2073 6369  on.....  The sci
+000289d0: 7079 2063 6f75 6e74 6572 7061 7274 2069  py counterpart i
+000289e0: 7320 6073 6369 7079 2e73 7461 7473 2e6d  s `scipy.stats.m
+000289f0: 6178 7765 6c6c 602e 0d0a 0d0a 2020 4172  axwell`.....  Ar
+00028a00: 6773 3a0d 0a20 2020 206b 6579 3a20 6120  gs:..    key: a 
+00028a10: 5052 4e47 206b 6579 2e0d 0a20 2020 2073  PRNG key...    s
+00028a20: 697a 653a 2054 6865 2073 6861 7065 206f  ize: The shape o
+00028a30: 6620 7468 6520 7265 7475 726e 6564 2073  f the returned s
+00028a40: 616d 706c 6573 2e0d 0a20 2020 2064 7479  amples...    dty
+00028a50: 7065 3a20 5468 6520 7479 7065 2075 7365  pe: The type use
+00028a60: 6420 666f 7220 7361 6d70 6c65 732e 0d0a  d for samples...
+00028a70: 2020 2020 6b65 793a 2061 2050 524e 4720      key: a PRNG 
+00028a80: 6b65 7920 6f72 2061 2073 6565 642e 0d0a  key or a seed...
+00028a90: 0d0a 2020 5265 7475 726e 733a 0d0a 2020  ..  Returns:..  
+00028aa0: 2020 4120 6a6e 702e 6172 7261 7920 6f66    A jnp.array of
+00028ab0: 2073 616d 706c 6573 2c20 6f66 2073 6861   samples, of sha
+00028ac0: 7065 2060 7368 6170 6560 2e0d 0a0d 0a20  pe `shape`..... 
+00028ad0: 2022 2222 0d0a 2020 7265 7475 726e 2044   """..  return D
+00028ae0: 4546 4155 4c54 2e6d 6178 7765 6c6c 2873  EFAULT.maxwell(s
+00028af0: 697a 652c 206b 6579 3d6b 6579 2c20 6474  ize, key=key, dt
+00028b00: 7970 653d 6474 7970 6529 0d0a 0d0a 0d0a  ype=dtype)......
+00028b10: 6465 6620 7428 6466 2c0d 0a20 2020 2020  def t(df,..     
+00028b20: 2073 697a 653a 204f 7074 696f 6e61 6c5b   size: Optional[
+00028b30: 5369 7a65 5d20 3d20 4e6f 6e65 2c0d 0a20  Size] = None,.. 
+00028b40: 2020 2020 206b 6579 3a20 4f70 7469 6f6e       key: Option
+00028b50: 616c 5b53 6565 644f 724b 6579 5d20 3d20  al[SeedOrKey] = 
+00028b60: 4e6f 6e65 2c0d 0a20 2020 2020 2064 7479  None,..      dty
+00028b70: 7065 3a20 4454 7970 654c 696b 6520 3d20  pe: DTypeLike = 
+00028b80: 4e6f 6e65 293a 0d0a 2020 2222 2253 616d  None):..  """Sam
+00028b90: 706c 6520 5374 7564 656e 74e2 8099 7320  ple Student...s 
+00028ba0: 7420 7261 6e64 6f6d 2076 616c 7565 732e  t random values.
+00028bb0: 0d0a 0d0a 2020 5061 7261 6d65 7465 7273  ....  Parameters
+00028bc0: 0d0a 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  ..  ----------..
+00028bd0: 2020 6466 3a20 666c 6f61 742c 2061 7272    df: float, arr
+00028be0: 6179 5f6c 696b 650d 0a20 2020 2041 2066  ay_like..    A f
+00028bf0: 6c6f 6174 206f 7220 6172 7261 7920 6f66  loat or array of
+00028c00: 2066 6c6f 6174 7320 6272 6f61 6463 6173   floats broadcas
+00028c10: 742d 636f 6d70 6174 6962 6c65 2077 6974  t-compatible wit
+00028c20: 6820 7368 6170 6520 7265 7072 6573 656e  h shape represen
+00028c30: 7469 6e67 2074 6865 2070 6172 616d 6574  ting the paramet
+00028c40: 6572 206f 6620 7468 6520 6469 7374 7269  er of the distri
+00028c50: 6275 7469 6f6e 2e0d 0a20 2073 697a 653a  bution...  size:
+00028c60: 206f 7074 696f 6e61 6c2c 2069 6e74 2c20   optional, int, 
+00028c70: 7475 706c 6520 6f66 2069 6e74 0d0a 2020  tuple of int..  
+00028c80: 2020 4120 7475 706c 6520 6f66 206e 6f6e    A tuple of non
+00028c90: 2d6e 6567 6174 6976 6520 696e 7465 6765  -negative intege
+00028ca0: 7273 2073 7065 6369 6679 696e 6720 7468  rs specifying th
+00028cb0: 6520 7265 7375 6c74 2073 6861 7065 2e0d  e result shape..
+00028cc0: 0a20 2020 204d 7573 7420 6265 2062 726f  .    Must be bro
+00028cd0: 6164 6361 7374 2d63 6f6d 7061 7469 626c  adcast-compatibl
+00028ce0: 6520 7769 7468 2060 6466 602e 2054 6865  e with `df`. The
+00028cf0: 2064 6566 6175 6c74 2028 4e6f 6e65 2920   default (None) 
+00028d00: 7072 6f64 7563 6573 2061 2072 6573 756c  produces a resul
+00028d10: 7420 7368 6170 6520 6571 7561 6c20 746f  t shape equal to
+00028d20: 2060 6466 2e73 6861 7065 602e 0d0a 2020   `df.shape`...  
+00028d30: 6b65 7920 3a20 5052 4e47 4b65 792c 206f  key : PRNGKey, o
+00028d40: 7074 696f 6e61 6c0d 0a20 2020 2020 2054  ptional..      T
+00028d50: 6865 206b 6579 2066 6f72 2074 6865 2072  he key for the r
+00028d60: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
+00028d70: 6572 6174 6f72 2e20 4966 206e 6f74 2067  erator. If not g
+00028d80: 6976 656e 2c20 7468 650d 0a20 2020 2020  iven, the..     
+00028d90: 2064 6566 6175 6c74 2072 616e 646f 6d20   default random 
+00028da0: 6e75 6d62 6572 2067 656e 6572 6174 6f72  number generator
+00028db0: 2069 7320 7573 6564 2e0d 0a0d 0a20 2052   is used.....  R
+00028dc0: 6574 7572 6e73 0d0a 2020 2d2d 2d2d 2d2d  eturns..  ------
+00028dd0: 2d0d 0a20 206f 7574 3a20 6172 7261 795f  -..  out: array_
+00028de0: 6c69 6b65 0d0a 2020 2020 5468 6520 7361  like..    The sa
+00028df0: 6d70 6c65 6420 7661 6c75 652e 0d0a 2020  mpled value...  
+00028e00: 2222 220d 0a20 2072 6574 7572 6e20 4445  """..  return DE
+00028e10: 4641 554c 542e 7428 6466 2c20 7369 7a65  FAULT.t(df, size
+00028e20: 2c20 6b65 793d 6b65 792c 2064 7479 7065  , key=key, dtype
+00028e30: 3d64 7479 7065 290d 0a0d 0a0d 0a64 6566  =dtype)......def
+00028e40: 206f 7274 686f 676f 6e61 6c28 6e3a 2069   orthogonal(n: i
+00028e50: 6e74 2c0d 0a20 2020 2020 2020 2020 2020  nt,..           
+00028e60: 2020 2020 7369 7a65 3a20 4f70 7469 6f6e      size: Option
+00028e70: 616c 5b53 697a 655d 203d 204e 6f6e 652c  al[Size] = None,
+00028e80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00028e90: 206b 6579 3a20 4f70 7469 6f6e 616c 5b53   key: Optional[S
+00028ea0: 6565 644f 724b 6579 5d20 3d20 4e6f 6e65  eedOrKey] = None
+00028eb0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00028ec0: 2020 6474 7970 653a 2044 5479 7065 4c69    dtype: DTypeLi
+00028ed0: 6b65 203d 204e 6f6e 6529 3a0d 0a20 2022  ke = None):..  "
+00028ee0: 2222 5361 6d70 6c65 2075 6e69 666f 726d  ""Sample uniform
+00028ef0: 6c79 2066 726f 6d20 7468 6520 6f72 7468  ly from the orth
+00028f00: 6f67 6f6e 616c 2067 726f 7570 2060 4f28  ogonal group `O(
+00028f10: 6e29 602e 0d0a 0d0a 2020 5061 7261 6d65  n)`.....  Parame
+00028f20: 7465 7273 0d0a 2020 2d2d 2d2d 2d2d 2d2d  ters..  --------
+00028f30: 2d2d 0d0a 2020 6e3a 2069 6e74 0d0a 2020  --..  n: int..  
+00028f40: 2020 2041 6e20 696e 7465 6765 7220 696e     An integer in
+00028f50: 6469 6361 7469 6e67 2074 6865 2072 6573  dicating the res
+00028f60: 756c 7469 6e67 2064 696d 656e 7369 6f6e  ulting dimension
+00028f70: 2e0d 0a20 2073 697a 653a 206f 7074 696f  ...  size: optio
+00028f80: 6e61 6c2c 2069 6e74 2c20 7475 706c 6520  nal, int, tuple 
+00028f90: 6f66 2069 6e74 0d0a 2020 2020 5468 6520  of int..    The 
+00028fa0: 6261 7463 6820 6469 6d65 6e73 696f 6e73  batch dimensions
+00028fb0: 206f 6620 7468 6520 7265 7375 6c74 2e0d   of the result..
+00028fc0: 0a20 206b 6579 203a 2050 524e 474b 6579  .  key : PRNGKey
+00028fd0: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+00028fe0: 2020 5468 6520 6b65 7920 666f 7220 7468    The key for th
+00028ff0: 6520 7261 6e64 6f6d 206e 756d 6265 7220  e random number 
+00029000: 6765 6e65 7261 746f 722e 2049 6620 6e6f  generator. If no
+00029010: 7420 6769 7665 6e2c 2074 6865 0d0a 2020  t given, the..  
+00029020: 2020 2020 6465 6661 756c 7420 7261 6e64      default rand
+00029030: 6f6d 206e 756d 6265 7220 6765 6e65 7261  om number genera
+00029040: 746f 7220 6973 2075 7365 642e 0d0a 0d0a  tor is used.....
+00029050: 2020 5265 7475 726e 730d 0a20 202d 2d2d    Returns..  ---
+00029060: 2d2d 2d2d 0d0a 2020 6f75 743a 2041 7272  ----..  out: Arr
+00029070: 6179 0d0a 2020 2020 5468 6520 7361 6d70  ay..    The samp
+00029080: 6c65 6420 7265 7375 6c74 732e 0d0a 2020  led results...  
+00029090: 2222 220d 0a20 2072 6574 7572 6e20 4445  """..  return DE
+000290a0: 4641 554c 542e 6f72 7468 6f67 6f6e 616c  FAULT.orthogonal
+000290b0: 286e 2c20 7369 7a65 2c20 6b65 793d 6b65  (n, size, key=ke
+000290c0: 792c 2064 7479 7065 3d64 7479 7065 290d  y, dtype=dtype).
+000290d0: 0a0d 0a0d 0a64 6566 206c 6f67 6761 6d6d  .....def loggamm
+000290e0: 6128 612c 0d0a 2020 2020 2020 2020 2020  a(a,..          
+000290f0: 2020 2073 697a 653a 204f 7074 696f 6e61     size: Optiona
+00029100: 6c5b 5369 7a65 5d20 3d20 4e6f 6e65 2c0d  l[Size] = None,.
+00029110: 0a20 2020 2020 2020 2020 2020 2020 6b65  .             ke
+00029120: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
+00029130: 4f72 4b65 795d 203d 204e 6f6e 652c 0d0a  OrKey] = None,..
+00029140: 2020 2020 2020 2020 2020 2020 2064 7479               dty
+00029150: 7065 3a20 4454 7970 654c 696b 6520 3d20  pe: DTypeLike = 
+00029160: 4e6f 6e65 293a 0d0a 2020 2222 2253 616d  None):..  """Sam
+00029170: 706c 6520 6c6f 672d 6761 6d6d 6120 7261  ple log-gamma ra
+00029180: 6e64 6f6d 2076 616c 7565 732e 0d0a 0d0a  ndom values.....
+00029190: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+000291a0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 613a  ----------..  a:
+000291b0: 2066 6c6f 6174 2c20 6172 7261 795f 6c69   float, array_li
+000291c0: 6b65 0d0a 2020 2020 4120 666c 6f61 7420  ke..    A float 
+000291d0: 6f72 2061 7272 6179 206f 6620 666c 6f61  or array of floa
+000291e0: 7473 2062 726f 6164 6361 7374 2d63 6f6d  ts broadcast-com
+000291f0: 7061 7469 626c 6520 7769 7468 2073 6861  patible with sha
+00029200: 7065 2072 6570 7265 7365 6e74 696e 6720  pe representing 
+00029210: 7468 6520 7061 7261 6d65 7465 7220 6f66  the parameter of
+00029220: 2074 6865 2064 6973 7472 6962 7574 696f   the distributio
+00029230: 6e2e 0d0a 2020 7369 7a65 3a20 6f70 7469  n...  size: opti
+00029240: 6f6e 616c 2c20 696e 742c 2074 7570 6c65  onal, int, tuple
+00029250: 206f 6620 696e 740d 0a20 2020 2041 2074   of int..    A t
+00029260: 7570 6c65 206f 6620 6e6f 6e6e 6567 6174  uple of nonnegat
+00029270: 6976 6520 696e 7465 6765 7273 2073 7065  ive integers spe
+00029280: 6369 6679 696e 6720 7468 6520 7265 7375  cifying the resu
+00029290: 6c74 2073 6861 7065 2e0d 0a20 2020 204d  lt shape...    M
+000292a0: 7573 7420 6265 2062 726f 6164 6361 7374  ust be broadcast
+000292b0: 2d63 6f6d 7061 7469 626c 6520 7769 7468  -compatible with
+000292c0: 2060 6160 2e20 5468 6520 6465 6661 756c   `a`. The defaul
+000292d0: 7420 284e 6f6e 6529 2070 726f 6475 6365  t (None) produce
+000292e0: 7320 6120 7265 7375 6c74 2073 6861 7065  s a result shape
+000292f0: 2065 7175 616c 2074 6f20 6061 2e73 6861   equal to `a.sha
+00029300: 7065 602e 0d0a 2020 6b65 7920 3a20 5052  pe`...  key : PR
+00029310: 4e47 4b65 792c 206f 7074 696f 6e61 6c0d  NGKey, optional.
+00029320: 0a20 2020 2020 2054 6865 206b 6579 2066  .      The key f
+00029330: 6f72 2074 6865 2072 616e 646f 6d20 6e75  or the random nu
+00029340: 6d62 6572 2067 656e 6572 6174 6f72 2e20  mber generator. 
+00029350: 4966 206e 6f74 2067 6976 656e 2c20 7468  If not given, th
+00029360: 650d 0a20 2020 2020 2064 6566 6175 6c74  e..      default
+00029370: 2072 616e 646f 6d20 6e75 6d62 6572 2067   random number g
+00029380: 656e 6572 6174 6f72 2069 7320 7573 6564  enerator is used
+00029390: 2e0d 0a20 206b 6579 203a 2050 524e 474b  ...  key : PRNGK
+000293a0: 6579 2c20 6f70 7469 6f6e 616c 0d0a 2020  ey, optional..  
+000293b0: 2020 2020 5468 6520 6b65 7920 666f 7220      The key for 
+000293c0: 7468 6520 7261 6e64 6f6d 206e 756d 6265  the random numbe
+000293d0: 7220 6765 6e65 7261 746f 722e 2049 6620  r generator. If 
+000293e0: 6e6f 7420 6769 7665 6e2c 2074 6865 0d0a  not given, the..
+000293f0: 2020 2020 2020 6465 6661 756c 7420 7261        default ra
+00029400: 6e64 6f6d 206e 756d 6265 7220 6765 6e65  ndom number gene
+00029410: 7261 746f 7220 6973 2075 7365 642e 0d0a  rator is used...
+00029420: 0d0a 2020 5265 7475 726e 730d 0a20 202d  ..  Returns..  -
+00029430: 2d2d 2d2d 2d2d 0d0a 2020 6f75 743a 2061  ------..  out: a
+00029440: 7272 6179 5f6c 696b 650d 0a20 2020 2054  rray_like..    T
+00029450: 6865 2073 616d 706c 6564 2072 6573 756c  he sampled resul
+00029460: 7473 2e0d 0a20 2022 2222 0d0a 2020 7265  ts...  """..  re
+00029470: 7475 726e 2044 4546 4155 4c54 2e6c 6f67  turn DEFAULT.log
+00029480: 6761 6d6d 6128 612c 2073 697a 652c 206b  gamma(a, size, k
+00029490: 6579 3d6b 6579 2c20 6474 7970 653d 6474  ey=key, dtype=dt
+000294a0: 7970 6529 0d0a 0d0a 0d0a 6465 6620 6361  ype)......def ca
+000294b0: 7465 676f 7269 6361 6c28 6c6f 6769 7473  tegorical(logits
+000294c0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000294d0: 2020 2061 7869 733a 2069 6e74 203d 202d     axis: int = -
+000294e0: 312c 0d0a 2020 2020 2020 2020 2020 2020  1,..            
+000294f0: 2020 2020 7369 7a65 3a20 4f70 7469 6f6e      size: Option
+00029500: 616c 5b53 697a 655d 203d 204e 6f6e 652c  al[Size] = None,
+00029510: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00029520: 2020 6b65 793a 204f 7074 696f 6e61 6c5b    key: Optional[
+00029530: 5365 6564 4f72 4b65 795d 203d 204e 6f6e  SeedOrKey] = Non
+00029540: 6529 3a0d 0a20 2022 2222 5361 6d70 6c65  e):..  """Sample
+00029550: 2072 616e 646f 6d20 7661 6c75 6573 2066   random values f
+00029560: 726f 6d20 6361 7465 676f 7269 6361 6c20  rom categorical 
+00029570: 6469 7374 7269 6275 7469 6f6e 732e 0d0a  distributions...
+00029580: 0d0a 2020 4172 6773 3a0d 0a20 2020 206c  ..  Args:..    l
+00029590: 6f67 6974 733a 2055 6e6e 6f72 6d61 6c69  ogits: Unnormali
+000295a0: 7a65 6420 6c6f 6720 7072 6f62 6162 696c  zed log probabil
+000295b0: 6974 6965 7320 6f66 2074 6865 2063 6174  ities of the cat
+000295c0: 6567 6f72 6963 616c 2064 6973 7472 6962  egorical distrib
+000295d0: 7574 696f 6e28 7329 2074 6f20 7361 6d70  ution(s) to samp
+000295e0: 6c65 2066 726f 6d2c 0d0a 2020 2020 2020  le from,..      
+000295f0: 736f 2074 6861 7420 6073 6f66 746d 6178  so that `softmax
+00029600: 286c 6f67 6974 732c 2061 7869 7329 6020  (logits, axis)` 
+00029610: 6769 7665 7320 7468 6520 636f 7272 6573  gives the corres
+00029620: 706f 6e64 696e 6720 7072 6f62 6162 696c  ponding probabil
+00029630: 6974 6965 732e 0d0a 2020 2020 6178 6973  ities...    axis
+00029640: 3a20 4178 6973 2061 6c6f 6e67 2077 6869  : Axis along whi
+00029650: 6368 206c 6f67 6974 7320 6265 6c6f 6e67  ch logits belong
+00029660: 2074 6f20 7468 6520 7361 6d65 2063 6174   to the same cat
+00029670: 6567 6f72 6963 616c 2064 6973 7472 6962  egorical distrib
+00029680: 7574 696f 6e2e 0d0a 2020 2020 7368 6170  ution...    shap
+00029690: 653a 204f 7074 696f 6e61 6c2c 2061 2074  e: Optional, a t
+000296a0: 7570 6c65 206f 6620 6e6f 6e6e 6567 6174  uple of nonnegat
+000296b0: 6976 6520 696e 7465 6765 7273 2072 6570  ive integers rep
+000296c0: 7265 7365 6e74 696e 6720 7468 6520 7265  resenting the re
+000296d0: 7375 6c74 2073 6861 7065 2e0d 0a20 2020  sult shape...   
+000296e0: 2020 204d 7573 7420 6265 2062 726f 6164     Must be broad
+000296f0: 6361 7374 2d63 6f6d 7061 7469 626c 6520  cast-compatible 
+00029700: 7769 7468 2060 606e 702e 6465 6c65 7465  with ``np.delete
+00029710: 286c 6f67 6974 732e 7368 6170 652c 2061  (logits.shape, a
+00029720: 7869 7329 6060 2e0d 0a20 2020 2020 2054  xis)``...      T
+00029730: 6865 2064 6566 6175 6c74 2028 4e6f 6e65  he default (None
+00029740: 2920 7072 6f64 7563 6573 2061 2072 6573  ) produces a res
+00029750: 756c 7420 7368 6170 6520 6571 7561 6c20  ult shape equal 
+00029760: 746f 2060 606e 702e 6465 6c65 7465 286c  to ``np.delete(l
+00029770: 6f67 6974 732e 7368 6170 652c 2061 7869  ogits.shape, axi
+00029780: 7329 6060 2e0d 0a20 2020 206b 6579 3a20  s)``...    key: 
+00029790: 6120 5052 4e47 206b 6579 2075 7365 6420  a PRNG key used 
+000297a0: 6173 2074 6865 2072 616e 646f 6d20 6b65  as the random ke
+000297b0: 792e 0d0a 0d0a 2020 5265 7475 726e 733a  y.....  Returns:
+000297c0: 0d0a 2020 2020 4120 7261 6e64 6f6d 2061  ..    A random a
+000297d0: 7272 6179 2077 6974 6820 696e 7420 6474  rray with int dt
+000297e0: 7970 6520 616e 6420 7368 6170 6520 6769  ype and shape gi
+000297f0: 7665 6e20 6279 2060 6073 6861 7065 6060  ven by ``shape``
+00029800: 2069 6620 6060 7368 6170 6560 600d 0a20   if ``shape``.. 
+00029810: 2020 2069 7320 6e6f 7420 4e6f 6e65 2c20     is not None, 
+00029820: 6f72 2065 6c73 6520 6060 6e70 2e64 656c  or else ``np.del
+00029830: 6574 6528 6c6f 6769 7473 2e73 6861 7065  ete(logits.shape
+00029840: 2c20 6178 6973 2960 602e 0d0a 2020 2222  , axis)``...  ""
+00029850: 220d 0a20 2072 6574 7572 6e20 4445 4641  "..  return DEFA
+00029860: 554c 542e 6361 7465 676f 7269 6361 6c28  ULT.categorical(
+00029870: 6c6f 6769 7473 2c20 6178 6973 2c20 7369  logits, axis, si
+00029880: 7a65 2c20 6b65 793d 6b65 7929 0d0a 0d0a  ze, key=key)....
+00029890: 0d0a 6465 6620 7261 6e64 5f6c 696b 6528  ..def rand_like(
+000298a0: 696e 7075 742c 202a 2c20 6474 7970 653d  input, *, dtype=
+000298b0: 4e6f 6e65 2c20 6b65 793a 204f 7074 696f  None, key: Optio
+000298c0: 6e61 6c5b 5365 6564 4f72 4b65 795d 203d  nal[SeedOrKey] =
+000298d0: 204e 6f6e 6529 3a0d 0a20 2022 2222 5369   None):..  """Si
+000298e0: 6d69 6c61 7220 746f 2060 6072 616e 645f  milar to ``rand_
+000298f0: 6c69 6b65 6060 2069 6e20 746f 7263 682e  like`` in torch.
+00029900: 0d0a 0d0a 2020 5265 7475 726e 7320 6120  ....  Returns a 
+00029910: 7465 6e73 6f72 2077 6974 6820 7468 6520  tensor with the 
+00029920: 7361 6d65 2073 697a 6520 6173 2069 6e70  same size as inp
+00029930: 7574 2074 6861 7420 6973 2066 696c 6c65  ut that is fille
+00029940: 6420 7769 7468 2072 616e 646f 6d0d 0a20  d with random.. 
+00029950: 206e 756d 6265 7273 2066 726f 6d20 6120   numbers from a 
+00029960: 756e 6966 6f72 6d20 6469 7374 7269 6275  uniform distribu
+00029970: 7469 6f6e 206f 6e20 7468 6520 696e 7465  tion on the inte
+00029980: 7276 616c 2060 605b 302c 2031 2960 602e  rval ``[0, 1)``.
+00029990: 0d0a 0d0a 2020 4172 6773 3a0d 0a20 2020  ....  Args:..   
+000299a0: 2069 6e70 7574 3a20 2074 6865 2060 6073   input:  the ``s
+000299b0: 697a 6560 6020 6f66 2069 6e70 7574 2077  ize`` of input w
+000299c0: 696c 6c20 6465 7465 726d 696e 6520 7369  ill determine si
+000299d0: 7a65 206f 6620 7468 6520 6f75 7470 7574  ze of the output
+000299e0: 2074 656e 736f 722e 0d0a 2020 2020 6474   tensor...    dt
+000299f0: 7970 653a 2020 7468 6520 6465 7369 7265  ype:  the desire
+00029a00: 6420 6461 7461 2074 7970 6520 6f66 2072  d data type of r
+00029a10: 6574 7572 6e65 6420 5465 6e73 6f72 2e20  eturned Tensor. 
+00029a20: 4465 6661 756c 743a 2069 6620 6060 4e6f  Default: if ``No
+00029a30: 6e65 6060 2c20 6465 6661 756c 7473 2074  ne``, defaults t
+00029a40: 6f20 7468 6520 6474 7970 6520 6f66 2069  o the dtype of i
+00029a50: 6e70 7574 2e0d 0a20 2020 206b 6579 3a20  nput...    key: 
+00029a60: 7468 6520 7365 6564 206f 7220 6b65 7920  the seed or key 
+00029a70: 666f 7220 7468 6520 7261 6e64 6f6d 2e0d  for the random..
+00029a80: 0a0d 0a20 2052 6574 7572 6e73 3a0d 0a20  ...  Returns:.. 
+00029a90: 2020 2054 6865 2072 616e 646f 6d20 6461     The random da
+00029aa0: 7461 2e0d 0a20 2022 2222 0d0a 2020 7265  ta...  """..  re
+00029ab0: 7475 726e 2044 4546 4155 4c54 2e72 616e  turn DEFAULT.ran
+00029ac0: 645f 6c69 6b65 2869 6e70 7574 2c20 6474  d_like(input, dt
+00029ad0: 7970 653d 6474 7970 652c 206b 6579 3d6b  ype=dtype, key=k
+00029ae0: 6579 290d 0a0d 0a0d 0a64 6566 2072 616e  ey)......def ran
+00029af0: 646e 5f6c 696b 6528 696e 7075 742c 202a  dn_like(input, *
+00029b00: 2c20 6474 7970 653d 4e6f 6e65 2c20 6b65  , dtype=None, ke
+00029b10: 793a 204f 7074 696f 6e61 6c5b 5365 6564  y: Optional[Seed
+00029b20: 4f72 4b65 795d 203d 204e 6f6e 6529 3a0d  OrKey] = None):.
+00029b30: 0a20 2022 2222 5369 6d69 6c61 7220 746f  .  """Similar to
+00029b40: 2060 6072 616e 646e 5f6c 696b 6560 6020   ``randn_like`` 
+00029b50: 696e 2074 6f72 6368 2e0d 0a0d 0a20 2052  in torch.....  R
+00029b60: 6574 7572 6e73 2061 2074 656e 736f 7220  eturns a tensor 
+00029b70: 7769 7468 2074 6865 2073 616d 6520 7369  with the same si
+00029b80: 7a65 2061 7320 6060 696e 7075 7460 6020  ze as ``input`` 
+00029b90: 7468 6174 2069 7320 6669 6c6c 6564 2077  that is filled w
+00029ba0: 6974 680d 0a20 2072 616e 646f 6d20 6e75  ith..  random nu
+00029bb0: 6d62 6572 7320 6672 6f6d 2061 206e 6f72  mbers from a nor
+00029bc0: 6d61 6c20 6469 7374 7269 6275 7469 6f6e  mal distribution
+00029bd0: 2077 6974 6820 6d65 616e 2030 2061 6e64   with mean 0 and
+00029be0: 2076 6172 6961 6e63 6520 312e 0d0a 0d0a   variance 1.....
+00029bf0: 2020 4172 6773 3a0d 0a20 2020 2069 6e70    Args:..    inp
+00029c00: 7574 3a20 2074 6865 2060 6073 697a 6560  ut:  the ``size`
+00029c10: 6020 6f66 2069 6e70 7574 2077 696c 6c20  ` of input will 
+00029c20: 6465 7465 726d 696e 6520 7369 7a65 206f  determine size o
+00029c30: 6620 7468 6520 6f75 7470 7574 2074 656e  f the output ten
+00029c40: 736f 722e 0d0a 2020 2020 6474 7970 653a  sor...    dtype:
+00029c50: 2020 7468 6520 6465 7369 7265 6420 6461    the desired da
+00029c60: 7461 2074 7970 6520 6f66 2072 6574 7572  ta type of retur
+00029c70: 6e65 6420 5465 6e73 6f72 2e20 4465 6661  ned Tensor. Defa
+00029c80: 756c 743a 2069 6620 6060 4e6f 6e65 6060  ult: if ``None``
+00029c90: 2c20 6465 6661 756c 7473 2074 6f20 7468  , defaults to th
+00029ca0: 6520 6474 7970 6520 6f66 2069 6e70 7574  e dtype of input
+00029cb0: 2e0d 0a20 2020 206b 6579 3a20 7468 6520  ...    key: the 
+00029cc0: 7365 6564 206f 7220 6b65 7920 666f 7220  seed or key for 
+00029cd0: 7468 6520 7261 6e64 6f6d 2e0d 0a0d 0a20  the random..... 
+00029ce0: 2052 6574 7572 6e73 3a0d 0a20 2020 2054   Returns:..    T
+00029cf0: 6865 2072 616e 646f 6d20 6461 7461 2e0d  he random data..
+00029d00: 0a20 2022 2222 0d0a 2020 7265 7475 726e  .  """..  return
+00029d10: 2044 4546 4155 4c54 2e72 616e 646e 5f6c   DEFAULT.randn_l
+00029d20: 696b 6528 696e 7075 742c 2064 7479 7065  ike(input, dtype
+00029d30: 3d64 7479 7065 2c20 6b65 793d 6b65 7929  =dtype, key=key)
+00029d40: 0d0a 0d0a 0d0a 6465 6620 7261 6e64 696e  ......def randin
+00029d50: 745f 6c69 6b65 2869 6e70 7574 2c20 6c6f  t_like(input, lo
+00029d60: 773d 302c 2068 6967 683d 4e6f 6e65 2c20  w=0, high=None, 
+00029d70: 2a2c 2064 7479 7065 3d4e 6f6e 652c 206b  *, dtype=None, k
+00029d80: 6579 3a20 4f70 7469 6f6e 616c 5b53 6565  ey: Optional[See
+00029d90: 644f 724b 6579 5d20 3d20 4e6f 6e65 293a  dOrKey] = None):
+00029da0: 0d0a 2020 2222 2253 696d 696c 6172 2074  ..  """Similar t
+00029db0: 6f20 6060 7261 6e64 696e 745f 6c69 6b65  o ``randint_like
+00029dc0: 6060 2069 6e20 746f 7263 682e 0d0a 0d0a  `` in torch.....
+00029dd0: 2020 5265 7475 726e 7320 6120 7465 6e73    Returns a tens
+00029de0: 6f72 2077 6974 6820 7468 6520 7361 6d65  or with the same
+00029df0: 2073 6861 7065 2061 7320 5465 6e73 6f72   shape as Tensor
+00029e00: 2060 6069 6e70 7574 6060 2066 696c 6c65   ``input`` fille
+00029e10: 6420 7769 7468 0d0a 2020 7261 6e64 6f6d  d with..  random
+00029e20: 2069 6e74 6567 6572 7320 6765 6e65 7261   integers genera
+00029e30: 7465 6420 756e 6966 6f72 6d6c 7920 6265  ted uniformly be
+00029e40: 7477 6565 6e20 6060 6c6f 7760 6020 2869  tween ``low`` (i
+00029e50: 6e63 6c75 7369 7665 2920 616e 6420 6060  nclusive) and ``
+00029e60: 6869 6768 6060 2028 6578 636c 7573 6976  high`` (exclusiv
+00029e70: 6529 2e0d 0a0d 0a20 2041 7267 733a 0d0a  e).....  Args:..
+00029e80: 2020 2020 696e 7075 743a 2020 7468 6520      input:  the 
+00029e90: 6060 7369 7a65 6060 206f 6620 696e 7075  ``size`` of inpu
+00029ea0: 7420 7769 6c6c 2064 6574 6572 6d69 6e65  t will determine
+00029eb0: 2073 697a 6520 6f66 2074 6865 206f 7574   size of the out
+00029ec0: 7075 7420 7465 6e73 6f72 2e0d 0a20 2020  put tensor...   
+00029ed0: 206c 6f77 3a20 4c6f 7765 7374 2069 6e74   low: Lowest int
+00029ee0: 6567 6572 2074 6f20 6265 2064 7261 776e  eger to be drawn
+00029ef0: 2066 726f 6d20 7468 6520 6469 7374 7269   from the distri
+00029f00: 6275 7469 6f6e 2e20 4465 6661 756c 743a  bution. Default:
+00029f10: 2030 2e0d 0a20 2020 2068 6967 683a 204f   0...    high: O
+00029f20: 6e65 2061 626f 7665 2074 6865 2068 6967  ne above the hig
+00029f30: 6865 7374 2069 6e74 6567 6572 2074 6f20  hest integer to 
+00029f40: 6265 2064 7261 776e 2066 726f 6d20 7468  be drawn from th
+00029f50: 6520 6469 7374 7269 6275 7469 6f6e 2e0d  e distribution..
+00029f60: 0a20 2020 2064 7479 7065 3a20 7468 6520  .    dtype: the 
+00029f70: 6465 7369 7265 6420 6461 7461 2074 7970  desired data typ
+00029f80: 6520 6f66 2072 6574 7572 6e65 6420 5465  e of returned Te
+00029f90: 6e73 6f72 2e20 4465 6661 756c 743a 2069  nsor. Default: i
+00029fa0: 6620 6060 4e6f 6e65 6060 2c20 6465 6661  f ``None``, defa
+00029fb0: 756c 7473 2074 6f20 7468 6520 6474 7970  ults to the dtyp
+00029fc0: 6520 6f66 2069 6e70 7574 2e0d 0a20 2020  e of input...   
+00029fd0: 206b 6579 3a20 7468 6520 7365 6564 206f   key: the seed o
+00029fe0: 7220 6b65 7920 666f 7220 7468 6520 7261  r key for the ra
+00029ff0: 6e64 6f6d 2e0d 0a0d 0a20 2052 6574 7572  ndom.....  Retur
+0002a000: 6e73 3a0d 0a20 2020 2054 6865 2072 616e  ns:..    The ran
+0002a010: 646f 6d20 6461 7461 2e0d 0a20 2022 2222  dom data...  """
+0002a020: 0d0a 2020 7265 7475 726e 2044 4546 4155  ..  return DEFAU
+0002a030: 4c54 2e72 616e 6469 6e74 5f6c 696b 6528  LT.randint_like(
+0002a040: 696e 7075 743d 696e 7075 742c 206c 6f77  input=input, low
+0002a050: 3d6c 6f77 2c20 6869 6768 3d68 6967 682c  =low, high=high,
+0002a060: 2064 7479 7065 3d64 7479 7065 2c20 6b65   dtype=dtype, ke
+0002a070: 793d 6b65 7929 0d0a 0d0a 0d0a 2320 2d2d  y=key)......# --
+0002a080: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002a090: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002a0a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002a0b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002a0c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002a0d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002a0e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d  -------------...
+0002a0f0: 0a0d 0a64 6566 205f 666f 726d 616c 697a  ...def _formaliz
+0002a100: 655f 6b65 7928 6b65 7929 3a0d 0a20 2069  e_key(key):..  i
+0002a110: 6620 6973 696e 7374 616e 6365 286b 6579  f isinstance(key
+0002a120: 2c20 696e 7429 3a0d 0a20 2020 2072 6574  , int):..    ret
+0002a130: 7572 6e20 6a72 2e50 524e 474b 6579 286b  urn jr.PRNGKey(k
+0002a140: 6579 290d 0a20 2065 6c69 6620 6973 696e  ey)..  elif isin
+0002a150: 7374 616e 6365 286b 6579 2c20 286a 6178  stance(key, (jax
+0002a160: 2e41 7272 6179 2c20 6e70 2e6e 6461 7272  .Array, np.ndarr
+0002a170: 6179 2929 3a0d 0a20 2020 2069 6620 6b65  ay)):..    if ke
+0002a180: 792e 6474 7970 6520 213d 206a 6e70 2e75  y.dtype != jnp.u
+0002a190: 696e 7433 323a 0d0a 2020 2020 2020 7261  int32:..      ra
+0002a1a0: 6973 6520 5479 7065 4572 726f 7228 276b  ise TypeError('k
+0002a1b0: 6579 206d 7573 7420 6265 2061 2069 6e74  ey must be a int
+0002a1c0: 206f 7220 616e 2061 7272 6179 2077 6974   or an array wit
+0002a1d0: 6820 7477 6f20 7569 6e74 3332 2e27 290d  h two uint32.').
+0002a1e0: 0a20 2020 2069 6620 6b65 792e 7369 7a65  .    if key.size
+0002a1f0: 2021 3d20 323a 0d0a 2020 2020 2020 7261   != 2:..      ra
+0002a200: 6973 6520 5479 7065 4572 726f 7228 276b  ise TypeError('k
+0002a210: 6579 206d 7573 7420 6265 2061 2069 6e74  ey must be a int
+0002a220: 206f 7220 616e 2061 7272 6179 2077 6974   or an array wit
+0002a230: 6820 7477 6f20 7569 6e74 3332 2e27 290d  h two uint32.').
+0002a240: 0a20 2020 2072 6574 7572 6e20 6a6e 702e  .    return jnp.
+0002a250: 6173 6172 7261 7928 6b65 792c 2064 7479  asarray(key, dty
+0002a260: 7065 3d6a 6e70 2e75 696e 7433 3229 0d0a  pe=jnp.uint32)..
+0002a270: 2020 656c 7365 3a0d 0a20 2020 2072 6169    else:..    rai
+0002a280: 7365 2054 7970 6545 7272 6f72 2827 6b65  se TypeError('ke
+0002a290: 7920 6d75 7374 2062 6520 6120 696e 7420  y must be a int 
+0002a2a0: 6f72 2061 6e20 6172 7261 7920 7769 7468  or an array with
+0002a2b0: 2074 776f 2075 696e 7433 322e 2729 0d0a   two uint32.')..
+0002a2c0: 0d0a 0d0a 6465 6620 5f73 697a 6532 7368  ....def _size2sh
+0002a2d0: 6170 6528 7369 7a65 293a 0d0a 2020 6966  ape(size):..  if
+0002a2e0: 2073 697a 6520 6973 204e 6f6e 653a 0d0a   size is None:..
+0002a2f0: 2020 2020 7265 7475 726e 2028 290d 0a20      return ().. 
+0002a300: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+0002a310: 2873 697a 652c 2028 7475 706c 652c 206c  (size, (tuple, l
+0002a320: 6973 7429 293a 0d0a 2020 2020 7265 7475  ist)):..    retu
+0002a330: 726e 2074 7570 6c65 2873 697a 6529 0d0a  rn tuple(size)..
+0002a340: 2020 656c 7365 3a0d 0a20 2020 2072 6574    else:..    ret
+0002a350: 7572 6e20 2873 697a 652c 290d 0a0d 0a0d  urn (size,).....
+0002a360: 0a64 6566 205f 6368 6563 6b5f 7368 6170  .def _check_shap
+0002a370: 6528 6e61 6d65 2c20 7368 6170 652c 202a  e(name, shape, *
+0002a380: 7061 7261 6d5f 7368 6170 6573 293a 0d0a  param_shapes):..
+0002a390: 2020 7368 6170 6520 3d20 636f 7265 2e61    shape = core.a
+0002a3a0: 735f 6e61 6d65 645f 7368 6170 6528 7368  s_named_shape(sh
+0002a3b0: 6170 6529 0d0a 2020 6966 2070 6172 616d  ape)..  if param
+0002a3c0: 5f73 6861 7065 733a 0d0a 2020 2020 7368  _shapes:..    sh
+0002a3d0: 6170 655f 203d 206c 6178 2e62 726f 6164  ape_ = lax.broad
+0002a3e0: 6361 7374 5f73 6861 7065 7328 7368 6170  cast_shapes(shap
+0002a3f0: 652e 706f 7369 7469 6f6e 616c 2c20 2a70  e.positional, *p
+0002a400: 6172 616d 5f73 6861 7065 7329 0d0a 2020  aram_shapes)..  
+0002a410: 2020 6966 2073 6861 7065 2e70 6f73 6974    if shape.posit
+0002a420: 696f 6e61 6c20 213d 2073 6861 7065 5f3a  ional != shape_:
+0002a430: 0d0a 2020 2020 2020 6d73 6720 3d20 2822  ..      msg = ("
+0002a440: 7b7d 2070 6172 616d 6574 6572 2073 6861  {} parameter sha
+0002a450: 7065 7320 6d75 7374 2062 6520 6272 6f61  pes must be broa
+0002a460: 6463 6173 742d 636f 6d70 6174 6962 6c65  dcast-compatible
+0002a470: 2077 6974 6820 7368 6170 6520 220d 0a20   with shape ".. 
+0002a480: 2020 2020 2020 2020 2020 2020 2261 7267              "arg
+0002a490: 756d 656e 742c 2061 6e64 2074 6865 2072  ument, and the r
+0002a4a0: 6573 756c 7420 6f66 2062 726f 6164 6361  esult of broadca
+0002a4b0: 7374 696e 6720 7468 6520 7368 6170 6573  sting the shapes
+0002a4c0: 206d 7573 7420 6571 7561 6c20 220d 0a20   must equal ".. 
+0002a4d0: 2020 2020 2020 2020 2020 2020 2274 6865              "the
+0002a4e0: 2073 6861 7065 2061 7267 756d 656e 742c   shape argument,
+0002a4f0: 2062 7574 2067 6f74 2072 6573 756c 7420   but got result 
+0002a500: 7b7d 2066 6f72 2073 6861 7065 2061 7267  {} for shape arg
+0002a510: 756d 656e 7420 7b7d 2e22 290d 0a20 2020  ument {}.")..   
+0002a520: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0002a530: 726f 7228 6d73 672e 666f 726d 6174 286e  ror(msg.format(n
+0002a540: 616d 652c 2073 6861 7065 5f2c 2073 6861  ame, shape_, sha
+0002a550: 7065 2929 0d0a 0d0a 0d0a 6465 6620 5f69  pe))......def _i
+0002a560: 735f 7079 7468 6f6e 5f73 6361 6c61 7228  s_python_scalar(
+0002a570: 7829 3a0d 0a20 2069 6620 6861 7361 7474  x):..  if hasatt
+0002a580: 7228 782c 2027 6176 616c 2729 3a0d 0a20  r(x, 'aval'):.. 
+0002a590: 2020 2072 6574 7572 6e20 782e 6176 616c     return x.aval
+0002a5a0: 2e77 6561 6b5f 7479 7065 0d0a 2020 656c  .weak_type..  el
+0002a5b0: 6966 206e 702e 6e64 696d 2878 2920 3d3d  if np.ndim(x) ==
+0002a5c0: 2030 3a0d 0a20 2020 2072 6574 7572 6e20   0:..    return 
+0002a5d0: 5472 7565 0d0a 2020 656c 6966 2069 7369  True..  elif isi
+0002a5e0: 6e73 7461 6e63 6528 782c 2028 626f 6f6c  nstance(x, (bool
+0002a5f0: 2c20 696e 742c 2066 6c6f 6174 2c20 636f  , int, float, co
+0002a600: 6d70 6c65 7829 293a 0d0a 2020 2020 7265  mplex)):..    re
+0002a610: 7475 726e 2054 7275 650d 0a20 2065 6c73  turn True..  els
+0002a620: 653a 0d0a 2020 2020 7265 7475 726e 2046  e:..    return F
+0002a630: 616c 7365 0d0a 0d0a 0d0a 7079 7468 6f6e  alse......python
+0002a640: 5f73 6361 6c61 725f 6474 7970 6573 203d  _scalar_dtypes =
+0002a650: 207b 0d0a 2020 626f 6f6c 3a20 6e70 2e64   {..  bool: np.d
+0002a660: 7479 7065 2827 626f 6f6c 2729 2c0d 0a20  type('bool'),.. 
+0002a670: 2069 6e74 3a20 6e70 2e64 7479 7065 2827   int: np.dtype('
+0002a680: 696e 7436 3427 292c 0d0a 2020 666c 6f61  int64'),..  floa
+0002a690: 743a 206e 702e 6474 7970 6528 2766 6c6f  t: np.dtype('flo
+0002a6a0: 6174 3634 2729 2c0d 0a20 2063 6f6d 706c  at64'),..  compl
+0002a6b0: 6578 3a20 6e70 2e64 7479 7065 2827 636f  ex: np.dtype('co
+0002a6c0: 6d70 6c65 7831 3238 2729 2c0d 0a7d 0d0a  mplex128'),..}..
+0002a6d0: 0d0a 0d0a 6465 6620 5f64 7479 7065 2878  ....def _dtype(x
+0002a6e0: 2c20 2a2c 2063 616e 6f6e 6963 616c 697a  , *, canonicaliz
+0002a6f0: 653a 2062 6f6f 6c20 3d20 4661 6c73 6529  e: bool = False)
+0002a700: 3a0d 0a20 2022 2222 5265 7475 726e 2074  :..  """Return t
+0002a710: 6865 2064 7479 7065 206f 626a 6563 7420  he dtype object 
+0002a720: 666f 7220 6120 7661 6c75 6520 6f72 2074  for a value or t
+0002a730: 7970 652c 206f 7074 696f 6e61 6c6c 7920  ype, optionally 
+0002a740: 6361 6e6f 6e69 6361 6c69 7a65 6420 6261  canonicalized ba
+0002a750: 7365 6420 6f6e 2058 3634 206d 6f64 652e  sed on X64 mode.
+0002a760: 2222 220d 0a20 2069 6620 7820 6973 204e  """..  if x is N
+0002a770: 6f6e 653a 0d0a 2020 2020 7261 6973 6520  one:..    raise 
+0002a780: 5661 6c75 6545 7272 6f72 2866 2249 6e76  ValueError(f"Inv
+0002a790: 616c 6964 2061 7267 756d 656e 7420 746f  alid argument to
+0002a7a0: 2064 7479 7065 3a20 7b78 7d2e 2229 0d0a   dtype: {x}.")..
+0002a7b0: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+0002a7c0: 6528 782c 2074 7970 6529 2061 6e64 2078  e(x, type) and x
+0002a7d0: 2069 6e20 7079 7468 6f6e 5f73 6361 6c61   in python_scala
+0002a7e0: 725f 6474 7970 6573 3a0d 0a20 2020 2064  r_dtypes:..    d
+0002a7f0: 7420 3d20 7079 7468 6f6e 5f73 6361 6c61  t = python_scala
+0002a800: 725f 6474 7970 6573 5b78 5d0d 0a20 2065  r_dtypes[x]..  e
+0002a810: 6c69 6620 7479 7065 2878 2920 696e 2070  lif type(x) in p
+0002a820: 7974 686f 6e5f 7363 616c 6172 5f64 7479  ython_scalar_dty
+0002a830: 7065 733a 0d0a 2020 2020 6474 203d 2070  pes:..    dt = p
+0002a840: 7974 686f 6e5f 7363 616c 6172 5f64 7479  ython_scalar_dty
+0002a850: 7065 735b 7479 7065 2878 295d 0d0a 2020  pes[type(x)]..  
+0002a860: 656c 6966 2068 6173 6174 7472 2878 2c20  elif hasattr(x, 
+0002a870: 2764 7479 7065 2729 3a0d 0a20 2020 2064  'dtype'):..    d
+0002a880: 7420 3d20 782e 6474 7970 650d 0a20 2065  t = x.dtype..  e
+0002a890: 6c73 653a 0d0a 2020 2020 6474 203d 206e  lse:..    dt = n
+0002a8a0: 702e 7265 7375 6c74 5f74 7970 6528 7829  p.result_type(x)
+0002a8b0: 0d0a 2020 7265 7475 726e 2064 7479 7065  ..  return dtype
+0002a8c0: 732e 6361 6e6f 6e69 6361 6c69 7a65 5f64  s.canonicalize_d
+0002a8d0: 7479 7065 2864 7429 2069 6620 6361 6e6f  type(dt) if cano
+0002a8e0: 6e69 6361 6c69 7a65 2065 6c73 6520 6474  nicalize else dt
+0002a8f0: 0d0a 0d0a 0d0a 6465 6620 5f63 6f6e 7374  ......def _const
+0002a900: 2865 7861 6d70 6c65 2c20 7661 6c29 3a0d  (example, val):.
+0002a910: 0a20 2069 6620 5f69 735f 7079 7468 6f6e  .  if _is_python
+0002a920: 5f73 6361 6c61 7228 6578 616d 706c 6529  _scalar(example)
+0002a930: 3a0d 0a20 2020 2064 7479 7065 203d 2064  :..    dtype = d
+0002a940: 7479 7065 732e 6361 6e6f 6e69 6361 6c69  types.canonicali
+0002a950: 7a65 5f64 7479 7065 2874 7970 6528 6578  ze_dtype(type(ex
+0002a960: 616d 706c 6529 290d 0a20 2020 2076 616c  ample))..    val
+0002a970: 203d 2064 7479 7065 732e 7363 616c 6172   = dtypes.scalar
+0002a980: 5f74 7970 655f 6f66 2865 7861 6d70 6c65  _type_of(example
+0002a990: 2928 7661 6c29 0d0a 2020 2020 7265 7475  )(val)..    retu
+0002a9a0: 726e 2076 616c 2069 6620 6474 7970 6520  rn val if dtype 
+0002a9b0: 3d3d 205f 6474 7970 6528 7661 6c2c 2063  == _dtype(val, c
+0002a9c0: 616e 6f6e 6963 616c 697a 653d 5472 7565  anonicalize=True
+0002a9d0: 2920 656c 7365 206e 702e 6172 7261 7928  ) else np.array(
+0002a9e0: 7661 6c2c 2064 7479 7065 290d 0a20 2065  val, dtype)..  e
+0002a9f0: 6c73 653a 0d0a 2020 2020 6474 7970 6520  lse:..    dtype 
+0002aa00: 3d20 6474 7970 6573 2e63 616e 6f6e 6963  = dtypes.canonic
+0002aa10: 616c 697a 655f 6474 7970 6528 6578 616d  alize_dtype(exam
+0002aa20: 706c 652e 6474 7970 6529 0d0a 2020 7265  ple.dtype)..  re
+0002aa30: 7475 726e 206e 702e 6172 7261 7928 7661  turn np.array(va
+0002aa40: 6c2c 2064 7479 7065 290d 0a0d 0a0d 0a5f  l, dtype)......_
+0002aa50: 7472 5f70 6172 616d 7320 3d20 6e61 6d65  tr_params = name
+0002aa60: 6474 7570 6c65 280d 0a20 2022 7472 5f70  dtuple(..  "tr_p
+0002aa70: 6172 616d 7322 2c20 5b22 6322 2c20 2262  arams", ["c", "b
+0002aa80: 222c 2022 6122 2c20 2261 6c70 6861 222c  ", "a", "alpha",
+0002aa90: 2022 755f 7222 2c20 2276 5f72 222c 2022   "u_r", "v_r", "
+0002aaa0: 6d22 2c20 226c 6f67 5f70 222c 2022 6c6f  m", "log_p", "lo
+0002aab0: 6731 5f70 222c 2022 6c6f 675f 6822 5d0d  g1_p", "log_h"].
+0002aac0: 0a29 0d0a 0d0a 0d0a 6465 6620 5f67 6574  .)......def _get
+0002aad0: 5f74 725f 7061 7261 6d73 286e 2c20 7029  _tr_params(n, p)
+0002aae0: 3a0d 0a20 2023 2053 6565 2054 6162 6c65  :..  # See Table
+0002aaf0: 2031 2e20 4164 6469 7469 6f6e 616c 6c79   1. Additionally
+0002ab00: 2c20 7765 2070 7265 2d63 6f6d 7075 7465  , we pre-compute
+0002ab10: 206c 6f67 2870 292c 206c 6f67 3128 2d70   log(p), log1(-p
+0002ab20: 2920 616e 6420 7468 650d 0a20 2023 2063  ) and the..  # c
+0002ab30: 6f6e 7374 616e 7420 7465 726d 732c 2074  onstant terms, t
+0002ab40: 6861 7420 6465 7065 6e64 206f 6e6c 7920  hat depend only 
+0002ab50: 6f6e 2028 6e2c 2070 2c20 6d29 2069 6e20  on (n, p, m) in 
+0002ab60: 6c6f 6728 6628 6b29 2920 2862 6f74 746f  log(f(k)) (botto
+0002ab70: 6d20 6f66 2070 6167 6520 3529 2e0d 0a20  m of page 5)... 
+0002ab80: 206d 7520 3d20 6e20 2a20 700d 0a20 2073   mu = n * p..  s
+0002ab90: 7071 203d 206a 6e70 2e73 7172 7428 6d75  pq = jnp.sqrt(mu
+0002aba0: 202a 2028 3120 2d20 7029 290d 0a20 2063   * (1 - p))..  c
+0002abb0: 203d 206d 7520 2b20 302e 350d 0a20 2062   = mu + 0.5..  b
+0002abc0: 203d 2031 2e31 3520 2b20 322e 3533 202a   = 1.15 + 2.53 *
+0002abd0: 2073 7071 0d0a 2020 6120 3d20 2d30 2e30   spq..  a = -0.0
+0002abe0: 3837 3320 2b20 302e 3032 3438 202a 2062  873 + 0.0248 * b
+0002abf0: 202b 2030 2e30 3120 2a20 700d 0a20 2061   + 0.01 * p..  a
+0002ac00: 6c70 6861 203d 2028 322e 3833 202b 2035  lpha = (2.83 + 5
+0002ac10: 2e31 202f 2062 2920 2a20 7370 710d 0a20  .1 / b) * spq.. 
+0002ac20: 2075 5f72 203d 2030 2e34 330d 0a20 2076   u_r = 0.43..  v
+0002ac30: 5f72 203d 2030 2e39 3220 2d20 342e 3220  _r = 0.92 - 4.2 
+0002ac40: 2f20 620d 0a20 206d 203d 206a 6e70 2e66  / b..  m = jnp.f
+0002ac50: 6c6f 6f72 2828 6e20 2b20 3129 202a 2070  loor((n + 1) * p
+0002ac60: 292e 6173 7479 7065 286e 2e64 7479 7065  ).astype(n.dtype
+0002ac70: 290d 0a20 206c 6f67 5f70 203d 206a 6e70  )..  log_p = jnp
+0002ac80: 2e6c 6f67 2870 290d 0a20 206c 6f67 315f  .log(p)..  log1_
+0002ac90: 7020 3d20 6a6e 702e 6c6f 6731 7028 2d70  p = jnp.log1p(-p
+0002aca0: 290d 0a20 206c 6f67 5f68 203d 2028 286d  )..  log_h = ((m
+0002acb0: 202b 2030 2e35 2920 2a20 286a 6e70 2e6c   + 0.5) * (jnp.l
+0002acc0: 6f67 2828 6d20 2b20 312e 3029 202f 2028  og((m + 1.0) / (
+0002acd0: 6e20 2d20 6d20 2b20 312e 3029 2920 2b20  n - m + 1.0)) + 
+0002ace0: 6c6f 6731 5f70 202d 206c 6f67 5f70 2920  log1_p - log_p) 
+0002acf0: 2b0d 0a20 2020 2020 2020 2020 2020 5f73  +..           _s
+0002ad00: 7469 726c 696e 675f 6170 7072 6f78 5f74  tirling_approx_t
+0002ad10: 6169 6c28 6d29 202b 205f 7374 6972 6c69  ail(m) + _stirli
+0002ad20: 6e67 5f61 7070 726f 785f 7461 696c 286e  ng_approx_tail(n
+0002ad30: 202d 206d 2929 0d0a 2020 7265 7475 726e   - m))..  return
+0002ad40: 205f 7472 5f70 6172 616d 7328 632c 2062   _tr_params(c, b
+0002ad50: 2c20 612c 2061 6c70 6861 2c20 755f 722c  , a, alpha, u_r,
+0002ad60: 2076 5f72 2c20 6d2c 206c 6f67 5f70 2c20   v_r, m, log_p, 
+0002ad70: 6c6f 6731 5f70 2c20 6c6f 675f 6829 0d0a  log1_p, log_h)..
+0002ad80: 0d0a 0d0a 6465 6620 5f73 7469 726c 696e  ....def _stirlin
+0002ad90: 675f 6170 7072 6f78 5f74 6169 6c28 6b29  g_approx_tail(k)
+0002ada0: 3a0d 0a20 2070 7265 636f 6d70 7574 6564  :..  precomputed
+0002adb0: 203d 206a 6e70 2e61 7272 6179 285b 302e   = jnp.array([0.
+0002adc0: 3038 3130 3631 3436 3637 3935 3332 3732  0810614667953272
+0002add0: 362c 0d0a 2020 2020 2020 2020 2020 2020  6,..            
+0002ade0: 2020 2020 2020 2020 2020 2020 2020 2030                 0
+0002adf0: 2e30 3431 3334 3036 3935 3935 3534 3039  .041340695955409
+0002ae00: 3239 2c0d 0a20 2020 2020 2020 2020 2020  29,..           
+0002ae10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ae20: 302e 3032 3736 3737 3932 3536 3834 3939  0.02767792568499
+0002ae30: 3833 342c 0d0a 2020 2020 2020 2020 2020  834,..          
+0002ae40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ae50: 2030 2e30 3230 3739 3036 3732 3130 3337   0.0207906721037
+0002ae60: 3635 3039 2c0d 0a20 2020 2020 2020 2020  6509,..         
+0002ae70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ae80: 2020 302e 3031 3636 3434 3639 3131 3839    0.016644691189
+0002ae90: 3832 3131 392c 0d0a 2020 2020 2020 2020  82119,..        
+0002aea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aeb0: 2020 2030 2e30 3133 3837 3631 3238 3832     0.01387612882
+0002aec0: 3330 3730 3735 2c0d 0a20 2020 2020 2020  307075,..       
+0002aed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aee0: 2020 2020 302e 3031 3138 3936 3730 3939      0.0118967099
+0002aef0: 3435 3839 3137 372c 0d0a 2020 2020 2020  4589177,..      
+0002af00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002af10: 2020 2020 2030 2e30 3130 3431 3132 3635       0.010411265
+0002af20: 3236 3139 3732 3039 2c0d 0a20 2020 2020  26197209,..     
+0002af30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002af40: 2020 2020 2020 302e 3030 3932 3535 3436        0.00925546
+0002af50: 3231 3832 3731 3237 3333 2c0d 0a20 2020  2182712733,..   
+0002af60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002af70: 2020 2020 2020 2020 302e 3030 3833 3330          0.008330
+0002af80: 3536 3334 3333 3336 3238 3731 5d2c 0d0a  563433362871],..
+0002af90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002afa0: 2020 2020 2020 2020 2020 6474 7970 653d            dtype=
+0002afb0: 656e 7669 726f 6e2e 6466 7479 7065 2829  environ.dftype()
+0002afc0: 290d 0a20 206b 7031 203d 206b 202b 2031  )..  kp1 = k + 1
+0002afd0: 0d0a 2020 6b70 3173 7120 3d20 286b 202b  ..  kp1sq = (k +
+0002afe0: 2031 2920 2a2a 2032 0d0a 2020 7265 7475   1) ** 2..  retu
+0002aff0: 726e 206a 6e70 2e77 6865 7265 286b 203c  rn jnp.where(k <
+0002b000: 2031 302c 0d0a 2020 2020 2020 2020 2020   10,..          
+0002b010: 2020 2020 2020 2020 2070 7265 636f 6d70           precomp
+0002b020: 7574 6564 5b6b 5d2c 0d0a 2020 2020 2020  uted[k],..      
+0002b030: 2020 2020 2020 2020 2020 2020 2028 312e               (1.
+0002b040: 3020 2f20 3132 202d 2028 312e 3020 2f20  0 / 12 - (1.0 / 
+0002b050: 3336 3020 2d20 2831 2e30 202f 2031 3236  360 - (1.0 / 126
+0002b060: 3029 202f 206b 7031 7371 2920 2f20 6b70  0) / kp1sq) / kp
+0002b070: 3173 7129 202f 206b 7031 290d 0a0d 0a0d  1sq) / kp1).....
+0002b080: 0a64 6566 205f 6269 6e6f 6d69 616c 5f62  .def _binomial_b
+0002b090: 7472 7328 6b65 792c 2070 2c20 6e29 3a0d  trs(key, p, n):.
+0002b0a0: 0a20 2022 2222 0d0a 2020 4261 7365 6420  .  """..  Based 
+0002b0b0: 6f6e 2074 6865 2074 7261 6e73 666f 726d  on the transform
+0002b0c0: 6564 2072 656a 6563 7469 6f6e 2073 616d  ed rejection sam
+0002b0d0: 706c 696e 6720 616c 676f 7269 7468 6d20  pling algorithm 
+0002b0e0: 2842 5452 5329 2066 726f 6d20 7468 650d  (BTRS) from the.
+0002b0f0: 0a20 2066 6f6c 6c6f 7769 6e67 2072 6566  .  following ref
+0002b100: 6572 656e 6365 3a0d 0a0d 0a20 2048 6f72  erence:....  Hor
+0002b110: 6d61 6e6e 2c20 2254 6865 2047 656e 6572  mann, "The Gener
+0002b120: 6174 696f 6e20 6f66 2042 696e 6f6e 6d69  ation of Binonmi
+0002b130: 616c 2052 616e 646f 6d20 5661 7269 6174  al Random Variat
+0002b140: 6573 220d 0a20 2028 6874 7470 733a 2f2f  es"..  (https://
+0002b150: 636f 7265 2e61 632e 756b 2f64 6f77 6e6c  core.ac.uk/downl
+0002b160: 6f61 642f 7064 662f 3131 3030 3732 3534  oad/pdf/11007254
+0002b170: 2e70 6466 290d 0a20 2022 2222 0d0a 0d0a  .pdf)..  """....
+0002b180: 2020 6465 6620 5f62 7472 735f 626f 6479    def _btrs_body
+0002b190: 5f66 6e28 7661 6c29 3a0d 0a20 2020 205f  _fn(val):..    _
+0002b1a0: 2c20 6b65 792c 205f 2c20 5f20 3d20 7661  , key, _, _ = va
+0002b1b0: 6c0d 0a20 2020 206b 6579 2c20 6b65 795f  l..    key, key_
+0002b1c0: 752c 206b 6579 5f76 203d 206a 722e 7370  u, key_v = jr.sp
+0002b1d0: 6c69 7428 6b65 792c 2033 290d 0a20 2020  lit(key, 3)..   
+0002b1e0: 2075 203d 206a 722e 756e 6966 6f72 6d28   u = jr.uniform(
+0002b1f0: 6b65 795f 7529 0d0a 2020 2020 7620 3d20  key_u)..    v = 
+0002b200: 6a72 2e75 6e69 666f 726d 286b 6579 5f76  jr.uniform(key_v
+0002b210: 290d 0a20 2020 2075 203d 2075 202d 2030  )..    u = u - 0
+0002b220: 2e35 0d0a 2020 2020 6b20 3d20 6a6e 702e  .5..    k = jnp.
+0002b230: 666c 6f6f 7228 0d0a 2020 2020 2020 2832  floor(..      (2
+0002b240: 202a 2074 725f 7061 7261 6d73 2e61 202f   * tr_params.a /
+0002b250: 2028 302e 3520 2d20 6a6e 702e 6162 7328   (0.5 - jnp.abs(
+0002b260: 7529 2920 2b20 7472 5f70 6172 616d 732e  u)) + tr_params.
+0002b270: 6229 202a 2075 202b 2074 725f 7061 7261  b) * u + tr_para
+0002b280: 6d73 2e63 0d0a 2020 2020 292e 6173 7479  ms.c..    ).asty
+0002b290: 7065 286e 2e64 7479 7065 290d 0a20 2020  pe(n.dtype)..   
+0002b2a0: 2072 6574 7572 6e20 6b2c 206b 6579 2c20   return k, key, 
+0002b2b0: 752c 2076 0d0a 0d0a 2020 6465 6620 5f62  u, v....  def _b
+0002b2c0: 7472 735f 636f 6e64 5f66 6e28 7661 6c29  trs_cond_fn(val)
+0002b2d0: 3a0d 0a20 2020 2064 6566 2061 6363 6570  :..    def accep
+0002b2e0: 745f 666e 286b 2c20 752c 2076 293a 0d0a  t_fn(k, u, v):..
+0002b2f0: 2020 2020 2020 2320 5365 6520 6163 6365        # See acce
+0002b300: 7074 616e 6365 2063 6f6e 6469 7469 6f6e  ptance condition
+0002b310: 2069 6e20 5374 6570 2033 2e20 2850 6167   in Step 3. (Pag
+0002b320: 6520 3329 206f 6620 5452 5320 616c 676f  e 3) of TRS algo
+0002b330: 7269 7468 6d0d 0a20 2020 2020 2023 2076  rithm..      # v
+0002b340: 203c 3d20 6628 6b29 202a 2067 5f67 7261   <= f(k) * g_gra
+0002b350: 6428 7529 202f 2061 6c70 6861 0d0a 0d0a  d(u) / alpha....
+0002b360: 2020 2020 2020 6d20 3d20 7472 5f70 6172        m = tr_par
+0002b370: 616d 732e 6d0d 0a20 2020 2020 206c 6f67  ams.m..      log
+0002b380: 5f70 203d 2074 725f 7061 7261 6d73 2e6c  _p = tr_params.l
+0002b390: 6f67 5f70 0d0a 2020 2020 2020 6c6f 6731  og_p..      log1
+0002b3a0: 5f70 203d 2074 725f 7061 7261 6d73 2e6c  _p = tr_params.l
+0002b3b0: 6f67 315f 700d 0a20 2020 2020 2023 2053  og1_p..      # S
+0002b3c0: 6565 3a20 666f 726d 756c 6120 666f 7220  ee: formula for 
+0002b3d0: 6c6f 6728 6628 6b29 2920 6174 2062 6f74  log(f(k)) at bot
+0002b3e0: 746f 6d20 6f66 2050 6167 6520 352e 0d0a  tom of Page 5...
+0002b3f0: 2020 2020 2020 6c6f 675f 6620 3d20 280d        log_f = (.
+0002b400: 0a20 2020 2020 2020 2020 2028 6e20 2b20  .          (n + 
+0002b410: 312e 3029 202a 206a 6e70 2e6c 6f67 2828  1.0) * jnp.log((
+0002b420: 6e20 2d20 6d20 2b20 312e 3029 202f 2028  n - m + 1.0) / (
+0002b430: 6e20 2d20 6b20 2b20 312e 3029 290d 0a20  n - k + 1.0)).. 
+0002b440: 2020 2020 2020 2020 202b 2028 6b20 2b20           + (k + 
+0002b450: 302e 3529 202a 2028 6a6e 702e 6c6f 6728  0.5) * (jnp.log(
+0002b460: 286e 202d 206b 202b 2031 2e30 2920 2f20  (n - k + 1.0) / 
+0002b470: 286b 202b 2031 2e30 2929 202b 206c 6f67  (k + 1.0)) + log
+0002b480: 5f70 202d 206c 6f67 315f 7029 0d0a 2020  _p - log1_p)..  
+0002b490: 2020 2020 2020 2020 2b20 285f 7374 6972          + (_stir
+0002b4a0: 6c69 6e67 5f61 7070 726f 785f 7461 696c  ling_approx_tail
+0002b4b0: 286b 2920 2d20 5f73 7469 726c 696e 675f  (k) - _stirling_
+0002b4c0: 6170 7072 6f78 5f74 6169 6c28 6e20 2d20  approx_tail(n - 
+0002b4d0: 6b29 290d 0a20 2020 2020 2020 2020 202b  k))..          +
+0002b4e0: 2074 725f 7061 7261 6d73 2e6c 6f67 5f68   tr_params.log_h
+0002b4f0: 0d0a 2020 2020 2020 290d 0a20 2020 2020  ..      )..     
+0002b500: 2067 203d 2028 7472 5f70 6172 616d 732e   g = (tr_params.
+0002b510: 6120 2f20 2830 2e35 202d 206a 6e70 2e61  a / (0.5 - jnp.a
+0002b520: 6273 2875 2929 202a 2a20 3229 202b 2074  bs(u)) ** 2) + t
+0002b530: 725f 7061 7261 6d73 2e62 0d0a 2020 2020  r_params.b..    
+0002b540: 2020 7265 7475 726e 206a 6e70 2e6c 6f67    return jnp.log
+0002b550: 2828 7620 2a20 7472 5f70 6172 616d 732e  ((v * tr_params.
+0002b560: 616c 7068 6129 202f 2067 2920 3c3d 206c  alpha) / g) <= l
+0002b570: 6f67 5f66 0d0a 0d0a 2020 2020 6b2c 206b  og_f....    k, k
+0002b580: 6579 2c20 752c 2076 203d 2076 616c 0d0a  ey, u, v = val..
+0002b590: 2020 2020 6561 726c 795f 6163 6365 7074      early_accept
+0002b5a0: 203d 2028 6a6e 702e 6162 7328 7529 203c   = (jnp.abs(u) <
+0002b5b0: 3d20 7472 5f70 6172 616d 732e 755f 7229  = tr_params.u_r)
+0002b5c0: 2026 2028 7620 3c3d 2074 725f 7061 7261   & (v <= tr_para
+0002b5d0: 6d73 2e76 5f72 290d 0a20 2020 2065 6172  ms.v_r)..    ear
+0002b5e0: 6c79 5f72 656a 6563 7420 3d20 286b 203c  ly_reject = (k <
+0002b5f0: 2030 2920 7c20 286b 203e 206e 290d 0a20   0) | (k > n).. 
+0002b600: 2020 2072 6574 7572 6e20 6c61 782e 636f     return lax.co
+0002b610: 6e64 280d 0a20 2020 2020 2065 6172 6c79  nd(..      early
+0002b620: 5f61 6363 6570 7420 7c20 6561 726c 795f  _accept | early_
+0002b630: 7265 6a65 6374 2c0d 0a20 2020 2020 2028  reject,..      (
+0002b640: 292c 0d0a 2020 2020 2020 6c61 6d62 6461  ),..      lambda
+0002b650: 205f 3a20 7e65 6172 6c79 5f61 6363 6570   _: ~early_accep
+0002b660: 742c 0d0a 2020 2020 2020 286b 2c20 752c  t,..      (k, u,
+0002b670: 2076 292c 0d0a 2020 2020 2020 6c61 6d62   v),..      lamb
+0002b680: 6461 2078 3a20 7e61 6363 6570 745f 666e  da x: ~accept_fn
+0002b690: 282a 7829 2c0d 0a20 2020 2029 0d0a 0d0a  (*x),..    )....
+0002b6a0: 2020 7472 5f70 6172 616d 7320 3d20 5f67    tr_params = _g
+0002b6b0: 6574 5f74 725f 7061 7261 6d73 286e 2c20  et_tr_params(n, 
+0002b6c0: 7029 0d0a 2020 7265 7420 3d20 6c61 782e  p)..  ret = lax.
+0002b6d0: 7768 696c 655f 6c6f 6f70 280d 0a20 2020  while_loop(..   
+0002b6e0: 205f 6274 7273 5f63 6f6e 645f 666e 2c20   _btrs_cond_fn, 
+0002b6f0: 5f62 7472 735f 626f 6479 5f66 6e2c 2028  _btrs_body_fn, (
+0002b700: 2d31 2c20 6b65 792c 2031 2e30 2c20 312e  -1, key, 1.0, 1.
+0002b710: 3029 0d0a 2020 2920 2023 2075 7365 206b  0)..  )  # use k
+0002b720: 3d2d 3120 696e 6974 6961 6c6c 7920 736f  =-1 initially so
+0002b730: 2074 6861 7420 636f 6e64 5f66 6e20 7265   that cond_fn re
+0002b740: 7475 726e 7320 5472 7565 0d0a 2020 7265  turns True..  re
+0002b750: 7475 726e 2072 6574 5b30 5d0d 0a0d 0a0d  turn ret[0].....
+0002b760: 0a64 6566 205f 6269 6e6f 6d69 616c 5f69  .def _binomial_i
+0002b770: 6e76 6572 7369 6f6e 286b 6579 2c20 702c  nversion(key, p,
+0002b780: 206e 293a 0d0a 2020 6465 6620 5f62 696e   n):..  def _bin
+0002b790: 6f6d 5f69 6e76 5f62 6f64 795f 666e 2876  om_inv_body_fn(v
+0002b7a0: 616c 293a 0d0a 2020 2020 692c 206b 6579  al):..    i, key
+0002b7b0: 2c20 6765 6f6d 5f61 6363 203d 2076 616c  , geom_acc = val
+0002b7c0: 0d0a 2020 2020 6b65 792c 206b 6579 5f75  ..    key, key_u
+0002b7d0: 203d 206a 722e 7370 6c69 7428 6b65 7929   = jr.split(key)
+0002b7e0: 0d0a 2020 2020 7520 3d20 6a72 2e75 6e69  ..    u = jr.uni
+0002b7f0: 666f 726d 286b 6579 5f75 290d 0a20 2020  form(key_u)..   
+0002b800: 2067 656f 6d20 3d20 6a6e 702e 666c 6f6f   geom = jnp.floo
+0002b810: 7228 6a6e 702e 6c6f 6731 7028 2d75 2920  r(jnp.log1p(-u) 
+0002b820: 2f20 6c6f 6731 5f70 2920 2b20 310d 0a20  / log1_p) + 1.. 
+0002b830: 2020 2067 656f 6d5f 6163 6320 3d20 6765     geom_acc = ge
+0002b840: 6f6d 5f61 6363 202b 2067 656f 6d0d 0a20  om_acc + geom.. 
+0002b850: 2020 2072 6574 7572 6e20 6920 2b20 312c     return i + 1,
+0002b860: 206b 6579 2c20 6765 6f6d 5f61 6363 0d0a   key, geom_acc..
+0002b870: 0d0a 2020 6465 6620 5f62 696e 6f6d 5f69  ..  def _binom_i
+0002b880: 6e76 5f63 6f6e 645f 666e 2876 616c 293a  nv_cond_fn(val):
+0002b890: 0d0a 2020 2020 692c 205f 2c20 6765 6f6d  ..    i, _, geom
+0002b8a0: 5f61 6363 203d 2076 616c 0d0a 2020 2020  _acc = val..    
+0002b8b0: 7265 7475 726e 2067 656f 6d5f 6163 6320  return geom_acc 
+0002b8c0: 3c3d 206e 0d0a 0d0a 2020 6c6f 6731 5f70  <= n....  log1_p
+0002b8d0: 203d 206a 6e70 2e6c 6f67 3170 282d 7029   = jnp.log1p(-p)
+0002b8e0: 0d0a 2020 7265 7420 3d20 6c61 782e 7768  ..  ret = lax.wh
+0002b8f0: 696c 655f 6c6f 6f70 285f 6269 6e6f 6d5f  ile_loop(_binom_
+0002b900: 696e 765f 636f 6e64 5f66 6e2c 205f 6269  inv_cond_fn, _bi
+0002b910: 6e6f 6d5f 696e 765f 626f 6479 5f66 6e2c  nom_inv_body_fn,
+0002b920: 2028 2d31 2c20 6b65 792c 2030 2e30 2929   (-1, key, 0.0))
+0002b930: 0d0a 2020 7265 7475 726e 2072 6574 5b30  ..  return ret[0
+0002b940: 5d0d 0a0d 0a0d 0a64 6566 205f 6269 6e6f  ]......def _bino
+0002b950: 6d69 616c 5f64 6973 7061 7463 6828 6b65  mial_dispatch(ke
+0002b960: 792c 2070 2c20 6e29 3a0d 0a20 2064 6566  y, p, n):..  def
+0002b970: 2064 6973 7061 7463 6828 6b65 792c 2070   dispatch(key, p
+0002b980: 2c20 6e29 3a0d 0a20 2020 2069 735f 6c65  , n):..    is_le
+0002b990: 5f6d 6964 203d 2070 203c 3d20 302e 350d  _mid = p <= 0.5.
+0002b9a0: 0a20 2020 2070 7120 3d20 6a6e 702e 7768  .    pq = jnp.wh
+0002b9b0: 6572 6528 6973 5f6c 655f 6d69 642c 2070  ere(is_le_mid, p
+0002b9c0: 2c20 3120 2d20 7029 0d0a 2020 2020 6d75  , 1 - p)..    mu
+0002b9d0: 203d 206e 202a 2070 710d 0a20 2020 206b   = n * pq..    k
+0002b9e0: 203d 206c 6178 2e63 6f6e 6428 0d0a 2020   = lax.cond(..  
+0002b9f0: 2020 2020 6d75 203c 2031 302c 0d0a 2020      mu < 10,..  
+0002ba00: 2020 2020 286b 6579 2c20 7071 2c20 6e29      (key, pq, n)
+0002ba10: 2c0d 0a20 2020 2020 206c 616d 6264 6120  ,..      lambda 
+0002ba20: 783a 205f 6269 6e6f 6d69 616c 5f69 6e76  x: _binomial_inv
+0002ba30: 6572 7369 6f6e 282a 7829 2c0d 0a20 2020  ersion(*x),..   
+0002ba40: 2020 2028 6b65 792c 2070 712c 206e 292c     (key, pq, n),
+0002ba50: 0d0a 2020 2020 2020 6c61 6d62 6461 2078  ..      lambda x
+0002ba60: 3a20 5f62 696e 6f6d 6961 6c5f 6274 7273  : _binomial_btrs
+0002ba70: 282a 7829 2c0d 0a20 2020 2029 0d0a 2020  (*x),..    )..  
+0002ba80: 2020 7265 7475 726e 206a 6e70 2e77 6865    return jnp.whe
+0002ba90: 7265 2869 735f 6c65 5f6d 6964 2c20 6b2c  re(is_le_mid, k,
+0002baa0: 206e 202d 206b 290d 0a0d 0a20 2023 2052   n - k)....  # R
+0002bab0: 6574 7572 6e20 3020 666f 7220 6e61 6e20  eturn 0 for nan 
+0002bac0: 6070 6020 6f72 206e 6567 6174 6976 6520  `p` or negative 
+0002bad0: 606e 602c 2073 696e 6365 206e 616e 2076  `n`, since nan v
+0002bae0: 616c 7565 7320 6172 6520 6e6f 7420 616c  alues are not al
+0002baf0: 6c6f 7765 6420 666f 7220 696e 7465 6765  lowed for intege
+0002bb00: 7220 7479 7065 730d 0a20 2063 6f6e 6430  r types..  cond0
+0002bb10: 203d 206a 6e70 2e69 7366 696e 6974 6528   = jnp.isfinite(
+0002bb20: 7029 2026 2028 6e20 3e20 3029 2026 2028  p) & (n > 0) & (
+0002bb30: 7020 3e20 3029 0d0a 2020 7265 7475 726e  p > 0)..  return
+0002bb40: 206c 6178 2e63 6f6e 6428 0d0a 2020 2020   lax.cond(..    
+0002bb50: 636f 6e64 3020 2620 2870 203c 2031 292c  cond0 & (p < 1),
+0002bb60: 0d0a 2020 2020 286b 6579 2c20 702c 206e  ..    (key, p, n
+0002bb70: 292c 0d0a 2020 2020 6c61 6d62 6461 2078  ),..    lambda x
+0002bb80: 3a20 6469 7370 6174 6368 282a 7829 2c0d  : dispatch(*x),.
+0002bb90: 0a20 2020 2028 292c 0d0a 2020 2020 6c61  .    (),..    la
+0002bba0: 6d62 6461 205f 3a20 6a6e 702e 7768 6572  mbda _: jnp.wher
+0002bbb0: 6528 636f 6e64 302c 206e 2c20 3029 2c0d  e(cond0, n, 0),.
+0002bbc0: 0a20 2029 0d0a 0d0a 0d0a 4070 6172 7469  .  )......@parti
+0002bbd0: 616c 286a 6974 2c20 7374 6174 6963 5f61  al(jit, static_a
+0002bbe0: 7267 6e75 6d73 3d28 332c 2929 0d0a 6465  rgnums=(3,))..de
+0002bbf0: 6620 5f62 696e 6f6d 6961 6c28 6b65 792c  f _binomial(key,
+0002bc00: 2070 2c20 6e2c 2073 6861 7065 293a 0d0a   p, n, shape):..
+0002bc10: 2020 7368 6170 6520 3d20 7368 6170 6520    shape = shape 
+0002bc20: 6f72 206c 6178 2e62 726f 6164 6361 7374  or lax.broadcast
+0002bc30: 5f73 6861 7065 7328 6a6e 702e 7368 6170  _shapes(jnp.shap
+0002bc40: 6528 7029 2c20 6a6e 702e 7368 6170 6528  e(p), jnp.shape(
+0002bc50: 6e29 290d 0a20 2023 2072 6573 6861 7065  n))..  # reshape
+0002bc60: 2074 6f20 6d61 7020 6f76 6572 2061 7869   to map over axi
+0002bc70: 7320 300d 0a20 2070 203d 206a 6e70 2e72  s 0..  p = jnp.r
+0002bc80: 6573 6861 7065 286a 6e70 2e62 726f 6164  eshape(jnp.broad
+0002bc90: 6361 7374 5f74 6f28 702c 2073 6861 7065  cast_to(p, shape
+0002bca0: 292c 202d 3129 0d0a 2020 6e20 3d20 6a6e  ), -1)..  n = jn
+0002bcb0: 702e 7265 7368 6170 6528 6a6e 702e 6272  p.reshape(jnp.br
+0002bcc0: 6f61 6463 6173 745f 746f 286e 2c20 7368  oadcast_to(n, sh
+0002bcd0: 6170 6529 2c20 2d31 290d 0a20 206b 6579  ape), -1)..  key
+0002bce0: 203d 206a 722e 7370 6c69 7428 6b65 792c   = jr.split(key,
+0002bcf0: 206a 6e70 2e73 697a 6528 7029 290d 0a20   jnp.size(p)).. 
+0002bd00: 2069 6620 6a61 782e 6465 6661 756c 745f   if jax.default_
+0002bd10: 6261 636b 656e 6428 2920 3d3d 2022 6370  backend() == "cp
+0002bd20: 7522 3a0d 0a20 2020 2072 6574 203d 206c  u":..    ret = l
+0002bd30: 6178 2e6d 6170 286c 616d 6264 6120 783a  ax.map(lambda x:
+0002bd40: 205f 6269 6e6f 6d69 616c 5f64 6973 7061   _binomial_dispa
+0002bd50: 7463 6828 2a78 292c 2028 6b65 792c 2070  tch(*x), (key, p
+0002bd60: 2c20 6e29 290d 0a20 2065 6c73 653a 0d0a  , n))..  else:..
+0002bd70: 2020 2020 7265 7420 3d20 766d 6170 286c      ret = vmap(l
+0002bd80: 616d 6264 6120 2a78 3a20 5f62 696e 6f6d  ambda *x: _binom
+0002bd90: 6961 6c5f 6469 7370 6174 6368 282a 7829  ial_dispatch(*x)
+0002bda0: 2928 6b65 792c 2070 2c20 6e29 0d0a 2020  )(key, p, n)..  
+0002bdb0: 7265 7475 726e 206a 6e70 2e72 6573 6861  return jnp.resha
+0002bdc0: 7065 2872 6574 2c20 7368 6170 6529 0d0a  pe(ret, shape)..
+0002bdd0: 0d0a 0d0a 4070 6172 7469 616c 286a 6974  ....@partial(jit
+0002bde0: 2c20 7374 6174 6963 5f61 7267 6e75 6d73  , static_argnums
+0002bdf0: 3d28 322c 2929 0d0a 6465 6620 5f63 6174  =(2,))..def _cat
+0002be00: 6567 6f72 6963 616c 286b 6579 2c20 702c  egorical(key, p,
+0002be10: 2073 6861 7065 293a 0d0a 2020 2320 7468   shape):..  # th
+0002be20: 6973 2069 6d70 6c65 6d65 6e74 6174 696f  is implementatio
+0002be30: 6e20 6973 2066 6173 7420 7768 656e 2065  n is fast when e
+0002be40: 7665 6e74 2073 6861 7065 2069 7320 736d  vent shape is sm
+0002be50: 616c 6c2c 2061 6e64 2073 6c6f 7720 6f74  all, and slow ot
+0002be60: 6865 7277 6973 650d 0a20 2023 2052 6566  herwise..  # Ref
+0002be70: 3a20 6874 7470 733a 2f2f 7374 6163 6b6f  : https://stacko
+0002be80: 7665 7266 6c6f 772e 636f 6d2f 612f 3334  verflow.com/a/34
+0002be90: 3139 3030 3335 0d0a 2020 7368 6170 6520  190035..  shape 
+0002bea0: 3d20 7368 6170 6520 6f72 2070 2e73 6861  = shape or p.sha
+0002beb0: 7065 5b3a 2d31 5d0d 0a20 2073 203d 206a  pe[:-1]..  s = j
+0002bec0: 6e70 2e63 756d 7375 6d28 702c 2061 7869  np.cumsum(p, axi
+0002bed0: 733d 2d31 290d 0a20 2072 203d 206a 722e  s=-1)..  r = jr.
+0002bee0: 756e 6966 6f72 6d28 6b65 792c 2073 6861  uniform(key, sha
+0002bef0: 7065 3d73 6861 7065 202b 2028 312c 2929  pe=shape + (1,))
+0002bf00: 0d0a 2020 7265 7475 726e 206a 6e70 2e73  ..  return jnp.s
+0002bf10: 756d 2873 203c 2072 2c20 6178 6973 3d2d  um(s < r, axis=-
+0002bf20: 3129 0d0a 0d0a 0d0a 6465 6620 5f73 6361  1)......def _sca
+0002bf30: 7474 6572 5f61 6464 5f6f 6e65 286f 7065  tter_add_one(ope
+0002bf40: 7261 6e64 2c20 696e 6469 6365 732c 2075  rand, indices, u
+0002bf50: 7064 6174 6573 293a 0d0a 2020 7265 7475  pdates):..  retu
+0002bf60: 726e 206c 6178 2e73 6361 7474 6572 5f61  rn lax.scatter_a
+0002bf70: 6464 280d 0a20 2020 206f 7065 7261 6e64  dd(..    operand
+0002bf80: 2c0d 0a20 2020 2069 6e64 6963 6573 2c0d  ,..    indices,.
+0002bf90: 0a20 2020 2075 7064 6174 6573 2c0d 0a20  .    updates,.. 
+0002bfa0: 2020 206c 6178 2e53 6361 7474 6572 4469     lax.ScatterDi
+0002bfb0: 6d65 6e73 696f 6e4e 756d 6265 7273 280d  mensionNumbers(.
+0002bfc0: 0a20 2020 2020 2075 7064 6174 655f 7769  .      update_wi
+0002bfd0: 6e64 6f77 5f64 696d 733d 2829 2c0d 0a20  ndow_dims=(),.. 
+0002bfe0: 2020 2020 2069 6e73 6572 7465 645f 7769       inserted_wi
+0002bff0: 6e64 6f77 5f64 696d 733d 2830 2c29 2c0d  ndow_dims=(0,),.
+0002c000: 0a20 2020 2020 2073 6361 7474 6572 5f64  .      scatter_d
+0002c010: 696d 735f 746f 5f6f 7065 7261 6e64 5f64  ims_to_operand_d
+0002c020: 696d 733d 2830 2c29 2c0d 0a20 2020 2029  ims=(0,),..    )
+0002c030: 2c0d 0a20 2029 0d0a 0d0a 0d0a 6465 6620  ,..  )......def 
+0002c040: 5f72 6573 6861 7065 2878 2c20 7368 6170  _reshape(x, shap
+0002c050: 6529 3a0d 0a20 2069 6620 6973 696e 7374  e):..  if isinst
+0002c060: 616e 6365 2878 2c20 2869 6e74 2c20 666c  ance(x, (int, fl
+0002c070: 6f61 742c 206e 702e 6e64 6172 7261 792c  oat, np.ndarray,
+0002c080: 206e 702e 6765 6e65 7269 6329 293a 0d0a   np.generic)):..
+0002c090: 2020 2020 7265 7475 726e 206e 702e 7265      return np.re
+0002c0a0: 7368 6170 6528 782c 2073 6861 7065 290d  shape(x, shape).
+0002c0b0: 0a20 2065 6c73 653a 0d0a 2020 2020 7265  .  else:..    re
+0002c0c0: 7475 726e 206a 6e70 2e72 6573 6861 7065  turn jnp.reshape
+0002c0d0: 2878 2c20 7368 6170 6529 0d0a 0d0a 0d0a  (x, shape)......
+0002c0e0: 6465 6620 5f70 726f 6d6f 7465 5f73 6861  def _promote_sha
+0002c0f0: 7065 7328 2a61 7267 732c 2073 6861 7065  pes(*args, shape
+0002c100: 3d28 2929 3a0d 0a20 2023 2061 6461 7074  =()):..  # adapt
+0002c110: 6564 2066 726f 6d20 6c61 782e 6c61 785f  ed from lax.lax_
+0002c120: 6e75 6d70 790d 0a20 2069 6620 6c65 6e28  numpy..  if len(
+0002c130: 6172 6773 2920 3c20 3220 616e 6420 6e6f  args) < 2 and no
+0002c140: 7420 7368 6170 653a 0d0a 2020 2020 7265  t shape:..    re
+0002c150: 7475 726e 2061 7267 730d 0a20 2065 6c73  turn args..  els
+0002c160: 653a 0d0a 2020 2020 7368 6170 6573 203d  e:..    shapes =
+0002c170: 205b 6a6e 702e 7368 6170 6528 6172 6729   [jnp.shape(arg)
+0002c180: 2066 6f72 2061 7267 2069 6e20 6172 6773   for arg in args
+0002c190: 5d0d 0a20 2020 206e 756d 5f64 696d 7320  ]..    num_dims 
+0002c1a0: 3d20 6c65 6e28 6c61 782e 6272 6f61 6463  = len(lax.broadc
+0002c1b0: 6173 745f 7368 6170 6573 2873 6861 7065  ast_shapes(shape
+0002c1c0: 2c20 2a73 6861 7065 7329 290d 0a20 2020  , *shapes))..   
+0002c1d0: 2072 6574 7572 6e20 5b0d 0a20 2020 2020   return [..     
+0002c1e0: 205f 7265 7368 6170 6528 6172 672c 2028   _reshape(arg, (
+0002c1f0: 312c 2920 2a20 286e 756d 5f64 696d 7320  1,) * (num_dims 
+0002c200: 2d20 6c65 6e28 7329 2920 2b20 7329 2069  - len(s)) + s) i
+0002c210: 6620 6c65 6e28 7329 203c 206e 756d 5f64  f len(s) < num_d
+0002c220: 696d 7320 656c 7365 2061 7267 0d0a 2020  ims else arg..  
+0002c230: 2020 2020 666f 7220 6172 672c 2073 2069      for arg, s i
+0002c240: 6e20 7a69 7028 6172 6773 2c20 7368 6170  n zip(args, shap
+0002c250: 6573 290d 0a20 2020 205d 0d0a 0d0a 0d0a  es)..    ]......
+0002c260: 4070 6172 7469 616c 286a 6974 2c20 7374  @partial(jit, st
+0002c270: 6174 6963 5f61 7267 6e75 6d73 3d28 332c  atic_argnums=(3,
+0002c280: 2034 2929 0d0a 6465 6620 5f6d 756c 7469   4))..def _multi
+0002c290: 6e6f 6d69 616c 286b 6579 2c20 702c 206e  nomial(key, p, n
+0002c2a0: 2c20 6e5f 6d61 782c 2073 6861 7065 3d28  , n_max, shape=(
+0002c2b0: 2929 3a0d 0a20 2069 6620 6a6e 702e 7368  )):..  if jnp.sh
+0002c2c0: 6170 6528 6e29 2021 3d20 6a6e 702e 7368  ape(n) != jnp.sh
+0002c2d0: 6170 6528 7029 5b3a 2d31 5d3a 0d0a 2020  ape(p)[:-1]:..  
+0002c2e0: 2020 6272 6f61 6463 6173 745f 7368 6170    broadcast_shap
+0002c2f0: 6520 3d20 6c61 782e 6272 6f61 6463 6173  e = lax.broadcas
+0002c300: 745f 7368 6170 6573 286a 6e70 2e73 6861  t_shapes(jnp.sha
+0002c310: 7065 286e 292c 206a 6e70 2e73 6861 7065  pe(n), jnp.shape
+0002c320: 2870 295b 3a2d 315d 290d 0a20 2020 206e  (p)[:-1])..    n
+0002c330: 203d 206a 6e70 2e62 726f 6164 6361 7374   = jnp.broadcast
+0002c340: 5f74 6f28 6e2c 2062 726f 6164 6361 7374  _to(n, broadcast
+0002c350: 5f73 6861 7065 290d 0a20 2020 2070 203d  _shape)..    p =
+0002c360: 206a 6e70 2e62 726f 6164 6361 7374 5f74   jnp.broadcast_t
+0002c370: 6f28 702c 2062 726f 6164 6361 7374 5f73  o(p, broadcast_s
+0002c380: 6861 7065 202b 206a 6e70 2e73 6861 7065  hape + jnp.shape
+0002c390: 2870 295b 2d31 3a5d 290d 0a20 2073 6861  (p)[-1:])..  sha
+0002c3a0: 7065 203d 2073 6861 7065 206f 7220 702e  pe = shape or p.
+0002c3b0: 7368 6170 655b 3a2d 315d 0d0a 2020 6966  shape[:-1]..  if
+0002c3c0: 206e 5f6d 6178 203d 3d20 303a 0d0a 2020   n_max == 0:..  
+0002c3d0: 2020 7265 7475 726e 206a 6e70 2e7a 6572    return jnp.zer
+0002c3e0: 6f73 2873 6861 7065 202b 2070 2e73 6861  os(shape + p.sha
+0002c3f0: 7065 5b2d 313a 5d2c 2064 7479 7065 3d6a  pe[-1:], dtype=j
+0002c400: 6e70 2e72 6573 756c 745f 7479 7065 2869  np.result_type(i
+0002c410: 6e74 2929 0d0a 2020 2320 6765 7420 696e  nt))..  # get in
+0002c420: 6469 6365 7320 6672 6f6d 2063 6174 6567  dices from categ
+0002c430: 6f72 6963 616c 2064 6973 7472 6962 7574  orical distribut
+0002c440: 696f 6e20 7468 656e 2067 6174 6865 7220  ion then gather 
+0002c450: 7468 6520 7265 7375 6c74 0d0a 2020 696e  the result..  in
+0002c460: 6469 6365 7320 3d20 5f63 6174 6567 6f72  dices = _categor
+0002c470: 6963 616c 286b 6579 2c20 702c 2028 6e5f  ical(key, p, (n_
+0002c480: 6d61 782c 2920 2b20 7368 6170 6529 0d0a  max,) + shape)..
+0002c490: 2020 2320 6d61 736b 206f 7574 2076 616c    # mask out val
+0002c4a0: 7565 7320 7768 656e 2063 6f75 6e74 7320  ues when counts 
+0002c4b0: 6973 2068 6574 6572 6f67 656e 656f 7573  is heterogeneous
+0002c4c0: 0d0a 2020 6966 206a 6e70 2e6e 6469 6d28  ..  if jnp.ndim(
+0002c4d0: 6e29 203e 2030 3a0d 0a20 2020 206d 6173  n) > 0:..    mas
+0002c4e0: 6b20 3d20 5f70 726f 6d6f 7465 5f73 6861  k = _promote_sha
+0002c4f0: 7065 7328 6a6e 702e 6172 616e 6765 286e  pes(jnp.arange(n
+0002c500: 5f6d 6178 2920 3c20 6a6e 702e 6578 7061  _max) < jnp.expa
+0002c510: 6e64 5f64 696d 7328 6e2c 202d 3129 2c20  nd_dims(n, -1), 
+0002c520: 7368 6170 653d 7368 6170 6520 2b20 286e  shape=shape + (n
+0002c530: 5f6d 6178 2c29 295b 305d 0d0a 2020 2020  _max,))[0]..    
+0002c540: 6d61 736b 203d 206a 6e70 2e6d 6f76 6561  mask = jnp.movea
+0002c550: 7869 7328 6d61 736b 2c20 2d31 2c20 3029  xis(mask, -1, 0)
+0002c560: 2e61 7374 7970 6528 696e 6469 6365 732e  .astype(indices.
+0002c570: 6474 7970 6529 0d0a 2020 2020 6578 6365  dtype)..    exce
+0002c580: 7373 203d 206a 6e70 2e63 6f6e 6361 7465  ss = jnp.concate
+0002c590: 6e61 7465 285b 6a6e 702e 6578 7061 6e64  nate([jnp.expand
+0002c5a0: 5f64 696d 7328 6e5f 6d61 7820 2d20 6e2c  _dims(n_max - n,
+0002c5b0: 202d 3129 2c0d 0a20 2020 2020 2020 2020   -1),..         
+0002c5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c5d0: 2020 2020 206a 6e70 2e7a 6572 6f73 286a       jnp.zeros(j
+0002c5e0: 6e70 2e73 6861 7065 286e 2920 2b20 2870  np.shape(n) + (p
+0002c5f0: 2e73 6861 7065 5b2d 315d 202d 2031 2c29  .shape[-1] - 1,)
+0002c600: 295d 2c0d 0a20 2020 2020 2020 2020 2020  )],..           
+0002c610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c620: 2020 2d31 290d 0a20 2065 6c73 653a 0d0a    -1)..  else:..
+0002c630: 2020 2020 6d61 736b 203d 2031 0d0a 2020      mask = 1..  
+0002c640: 2020 6578 6365 7373 203d 2030 0d0a 2020    excess = 0..  
+0002c650: 2320 4e42 3a20 7765 2074 7261 6e73 706f  # NB: we transpo
+0002c660: 7365 2074 6f20 6d6f 7665 2062 6174 6368  se to move batch
+0002c670: 2073 6861 7065 2074 6f20 7468 6520 6672   shape to the fr
+0002c680: 6f6e 740d 0a20 2069 6e64 6963 6573 5f32  ont..  indices_2
+0002c690: 4420 3d20 286a 6e70 2e72 6573 6861 7065  D = (jnp.reshape
+0002c6a0: 2869 6e64 6963 6573 202a 206d 6173 6b2c  (indices * mask,
+0002c6b0: 2028 6e5f 6d61 782c 202d 3129 2929 2e54   (n_max, -1))).T
+0002c6c0: 0d0a 2020 7361 6d70 6c65 735f 3244 203d  ..  samples_2D =
+0002c6d0: 2076 6d61 7028 5f73 6361 7474 6572 5f61   vmap(_scatter_a
+0002c6e0: 6464 5f6f 6e65 2928 6a6e 702e 7a65 726f  dd_one)(jnp.zero
+0002c6f0: 7328 2869 6e64 6963 6573 5f32 442e 7368  s((indices_2D.sh
+0002c700: 6170 655b 305d 2c20 702e 7368 6170 655b  ape[0], p.shape[
+0002c710: 2d31 5d29 2c20 6474 7970 653d 696e 6469  -1]), dtype=indi
+0002c720: 6365 732e 6474 7970 6529 2c0d 0a20 2020  ces.dtype),..   
+0002c730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c750: 2020 206a 6e70 2e65 7870 616e 645f 6469     jnp.expand_di
+0002c760: 6d73 2869 6e64 6963 6573 5f32 442c 2061  ms(indices_2D, a
+0002c770: 7869 733d 2d31 292c 0d0a 2020 2020 2020  xis=-1),..      
+0002c780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c7a0: 6a6e 702e 6f6e 6573 2869 6e64 6963 6573  jnp.ones(indices
+0002c7b0: 5f32 442e 7368 6170 652c 2064 7479 7065  _2D.shape, dtype
+0002c7c0: 3d69 6e64 6963 6573 2e64 7479 7065 2929  =indices.dtype))
+0002c7d0: 0d0a 2020 7265 7475 726e 206a 6e70 2e72  ..  return jnp.r
+0002c7e0: 6573 6861 7065 2873 616d 706c 6573 5f32  eshape(samples_2
+0002c7f0: 442c 2073 6861 7065 202b 2070 2e73 6861  D, shape + p.sha
+0002c800: 7065 5b2d 313a 5d29 202d 2065 7863 6573  pe[-1:]) - exces
+0002c810: 730d 0a0d 0a0d 0a40 7061 7274 6961 6c28  s......@partial(
+0002c820: 6a69 742c 2073 7461 7469 635f 6172 676e  jit, static_argn
+0002c830: 756d 733d 2832 2c20 3329 2c20 7374 6174  ums=(2, 3), stat
+0002c840: 6963 5f61 7267 6e61 6d65 733d 5b27 7368  ic_argnames=['sh
+0002c850: 6170 6527 2c20 2764 7479 7065 275d 290d  ape', 'dtype']).
+0002c860: 0a64 6566 205f 766f 6e5f 6d69 7365 735f  .def _von_mises_
+0002c870: 6365 6e74 6572 6564 286b 6579 2c20 636f  centered(key, co
+0002c880: 6e63 656e 7472 6174 696f 6e2c 2073 6861  ncentration, sha
+0002c890: 7065 2c20 6474 7970 653d 4e6f 6e65 293a  pe, dtype=None):
+0002c8a0: 0d0a 2020 2222 2243 6f6d 7075 7465 2063  ..  """Compute c
+0002c8b0: 656e 7465 7265 6420 766f 6e20 4d69 7365  entered von Mise
+0002c8c0: 7320 7361 6d70 6c65 7320 7573 696e 6720  s samples using 
+0002c8d0: 7265 6a65 6374 696f 6e20 7361 6d70 6c69  rejection sampli
+0002c8e0: 6e67 2066 726f 6d20 5b31 5d5f 2077 6974  ng from [1]_ wit
+0002c8f0: 6820 7772 6170 7065 6420 4361 7563 6879  h wrapped Cauchy
+0002c900: 2070 726f 706f 7361 6c2e 0d0a 0d0a 2020   proposal.....  
+0002c910: 5265 7475 726e 730d 0a20 202d 2d2d 2d2d  Returns..  -----
+0002c920: 2d2d 0d0a 2020 6f75 743a 2061 7272 6179  --..  out: array
+0002c930: 5f6c 696b 650d 0a20 2020 2020 6365 6e74  _like..     cent
+0002c940: 6572 6564 2073 616d 706c 6573 2066 726f  ered samples fro
+0002c950: 6d20 766f 6e20 4d69 7365 730d 0a0d 0a20  m von Mises.... 
+0002c960: 2052 6566 6572 656e 6365 730d 0a20 202d   References..  -
+0002c970: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 202e 2e20  ---------..  .. 
+0002c980: 5b31 5d20 4c75 6320 4465 7672 6f79 6520  [1] Luc Devroye 
+0002c990: 224e 6f6e 2d55 6e69 666f 726d 2052 616e  "Non-Uniform Ran
+0002c9a0: 646f 6d20 5661 7269 6174 6520 4765 6e65  dom Variate Gene
+0002c9b0: 7261 7469 6f6e 222c 2053 7072 696e 6765  ration", Springe
+0002c9c0: 722d 5665 726c 6167 2c20 3139 3836 3b0d  r-Verlag, 1986;.
+0002c9d0: 0a20 2020 2020 2020 2020 4368 6170 7465  .         Chapte
+0002c9e0: 7220 392c 2070 2e20 3437 332d 3437 362e  r 9, p. 473-476.
+0002c9f0: 2068 7474 703a 2f2f 7777 772e 6e72 626f   http://www.nrbo
+0002ca00: 6f6b 2e63 6f6d 2f64 6576 726f 7965 2f44  ok.com/devroye/D
+0002ca10: 6576 726f 7965 5f66 696c 6573 2f63 6861  evroye_files/cha
+0002ca20: 7074 6572 5f6e 696e 652e 7064 660d 0a0d  pter_nine.pdf...
+0002ca30: 0a20 2022 2222 0d0a 2020 7368 6170 6520  .  """..  shape 
+0002ca40: 3d20 7368 6170 6520 6f72 206a 6e70 2e73  = shape or jnp.s
+0002ca50: 6861 7065 2863 6f6e 6365 6e74 7261 7469  hape(concentrati
+0002ca60: 6f6e 290d 0a20 2064 7479 7065 203d 2064  on)..  dtype = d
+0002ca70: 7479 7065 206f 7220 656e 7669 726f 6e2e  type or environ.
+0002ca80: 6466 7479 7065 2829 0d0a 2020 636f 6e63  dftype()..  conc
+0002ca90: 656e 7472 6174 696f 6e20 3d20 6c61 782e  entration = lax.
+0002caa0: 636f 6e76 6572 745f 656c 656d 656e 745f  convert_element_
+0002cab0: 7479 7065 2863 6f6e 6365 6e74 7261 7469  type(concentrati
+0002cac0: 6f6e 2c20 6474 7970 6529 0d0a 2020 636f  on, dtype)..  co
+0002cad0: 6e63 656e 7472 6174 696f 6e20 3d20 6a6e  ncentration = jn
+0002cae0: 702e 6272 6f61 6463 6173 745f 746f 2863  p.broadcast_to(c
+0002caf0: 6f6e 6365 6e74 7261 7469 6f6e 2c20 7368  oncentration, sh
+0002cb00: 6170 6529 0d0a 0d0a 2020 6966 2064 7479  ape)....  if dty
+0002cb10: 7065 203d 3d20 6a6e 702e 666c 6f61 7431  pe == jnp.float1
+0002cb20: 363a 0d0a 2020 2020 735f 6375 746f 6666  6:..    s_cutoff
+0002cb30: 203d 2031 2e38 652d 310d 0a20 2065 6c69   = 1.8e-1..  eli
+0002cb40: 6620 6474 7970 6520 3d3d 206a 6e70 2e66  f dtype == jnp.f
+0002cb50: 6c6f 6174 3332 3a0d 0a20 2020 2073 5f63  loat32:..    s_c
+0002cb60: 7574 6f66 6620 3d20 3265 2d32 0d0a 2020  utoff = 2e-2..  
+0002cb70: 656c 6966 2064 7479 7065 203d 3d20 6a6e  elif dtype == jn
+0002cb80: 702e 666c 6f61 7436 343a 0d0a 2020 2020  p.float64:..    
+0002cb90: 735f 6375 746f 6666 203d 2031 2e32 652d  s_cutoff = 1.2e-
+0002cba0: 340d 0a20 2065 6c73 653a 0d0a 2020 2020  4..  else:..    
+0002cbb0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0002cbc0: 2866 2255 6e73 7570 706f 7274 6564 2064  (f"Unsupported d
+0002cbd0: 7479 7065 3a20 7b64 7479 7065 7d22 290d  type: {dtype}").
+0002cbe0: 0a0d 0a20 2072 203d 2031 2e30 202b 206a  ...  r = 1.0 + j
+0002cbf0: 6e70 2e73 7172 7428 312e 3020 2b20 342e  np.sqrt(1.0 + 4.
+0002cc00: 3020 2a20 636f 6e63 656e 7472 6174 696f  0 * concentratio
+0002cc10: 6e20 2a2a 2032 290d 0a20 2072 686f 203d  n ** 2)..  rho =
+0002cc20: 2028 7220 2d20 6a6e 702e 7371 7274 2832   (r - jnp.sqrt(2
+0002cc30: 2e30 202a 2072 2929 202f 2028 322e 3020  .0 * r)) / (2.0 
+0002cc40: 2a20 636f 6e63 656e 7472 6174 696f 6e29  * concentration)
+0002cc50: 0d0a 2020 735f 6578 6163 7420 3d20 2831  ..  s_exact = (1
+0002cc60: 2e30 202b 2072 686f 202a 2a20 3229 202f  .0 + rho ** 2) /
+0002cc70: 2028 322e 3020 2a20 7268 6f29 0d0a 0d0a   (2.0 * rho)....
+0002cc80: 2020 735f 6170 7072 6f78 696d 6174 6520    s_approximate 
+0002cc90: 3d20 312e 3020 2f20 636f 6e63 656e 7472  = 1.0 / concentr
+0002cca0: 6174 696f 6e0d 0a0d 0a20 2073 203d 206a  ation....  s = j
+0002ccb0: 6e70 2e77 6865 7265 2863 6f6e 6365 6e74  np.where(concent
+0002ccc0: 7261 7469 6f6e 203e 2073 5f63 7574 6f66  ration > s_cutof
+0002ccd0: 662c 2073 5f65 7861 6374 2c20 735f 6170  f, s_exact, s_ap
+0002cce0: 7072 6f78 696d 6174 6529 0d0a 0d0a 2020  proximate)....  
+0002ccf0: 6465 6620 636f 6e64 5f66 6e28 2a61 7267  def cond_fn(*arg
+0002cd00: 7329 3a0d 0a20 2020 2022 2222 6368 6563  s):..    """chec
+0002cd10: 6b20 6966 2061 6c6c 2061 7265 2064 6f6e  k if all are don
+0002cd20: 6520 6f72 2072 6561 6368 6564 206d 6178  e or reached max
+0002cd30: 206e 756d 6265 7220 6f66 2069 7465 7261   number of itera
+0002cd40: 7469 6f6e 7322 2222 0d0a 2020 2020 692c  tions"""..    i,
+0002cd50: 205f 2c20 646f 6e65 2c20 5f2c 205f 203d   _, done, _, _ =
+0002cd60: 2061 7267 735b 305d 0d0a 2020 2020 7265   args[0]..    re
+0002cd70: 7475 726e 206a 6e70 2e62 6974 7769 7365  turn jnp.bitwise
+0002cd80: 5f61 6e64 2869 203c 2031 3030 2c20 6a6e  _and(i < 100, jn
+0002cd90: 702e 6c6f 6769 6361 6c5f 6e6f 7428 6a6e  p.logical_not(jn
+0002cda0: 702e 616c 6c28 646f 6e65 2929 290d 0a0d  p.all(done)))...
+0002cdb0: 0a20 2064 6566 2062 6f64 795f 666e 282a  .  def body_fn(*
+0002cdc0: 6172 6773 293a 0d0a 2020 2020 692c 206b  args):..    i, k
+0002cdd0: 6579 2c20 646f 6e65 2c20 5f2c 2077 203d  ey, done, _, w =
+0002cde0: 2061 7267 735b 305d 0d0a 2020 2020 756e   args[0]..    un
+0002cdf0: 695f 756b 6579 2c20 756e 695f 766b 6579  i_ukey, uni_vkey
+0002ce00: 2c20 6b65 7920 3d20 6a72 2e73 706c 6974  , key = jr.split
+0002ce10: 286b 6579 2c20 3329 0d0a 2020 2020 7520  (key, 3)..    u 
+0002ce20: 3d20 6a72 2e75 6e69 666f 726d 280d 0a20  = jr.uniform(.. 
+0002ce30: 2020 2020 206b 6579 3d75 6e69 5f75 6b65       key=uni_uke
+0002ce40: 792c 0d0a 2020 2020 2020 7368 6170 653d  y,..      shape=
+0002ce50: 7368 6170 652c 0d0a 2020 2020 2020 6474  shape,..      dt
+0002ce60: 7970 653d 636f 6e63 656e 7472 6174 696f  ype=concentratio
+0002ce70: 6e2e 6474 7970 652c 0d0a 2020 2020 2020  n.dtype,..      
+0002ce80: 6d69 6e76 616c 3d2d 312e 302c 0d0a 2020  minval=-1.0,..  
+0002ce90: 2020 2020 6d61 7876 616c 3d31 2e30 2c0d      maxval=1.0,.
+0002cea0: 0a20 2020 2029 0d0a 2020 2020 7a20 3d20  .    )..    z = 
+0002ceb0: 6a6e 702e 636f 7328 6a6e 702e 7069 202a  jnp.cos(jnp.pi *
+0002cec0: 2075 290d 0a20 2020 2077 203d 206a 6e70   u)..    w = jnp
+0002ced0: 2e77 6865 7265 2864 6f6e 652c 2077 2c20  .where(done, w, 
+0002cee0: 2831 2e30 202b 2073 202a 207a 2920 2f20  (1.0 + s * z) / 
+0002cef0: 2873 202b 207a 2929 2020 2320 5570 6461  (s + z))  # Upda
+0002cf00: 7465 2077 6865 7265 206e 6f74 2064 6f6e  te where not don
+0002cf10: 650d 0a20 2020 2079 203d 2063 6f6e 6365  e..    y = conce
+0002cf20: 6e74 7261 7469 6f6e 202a 2028 7320 2d20  ntration * (s - 
+0002cf30: 7729 0d0a 2020 2020 7620 3d20 6a72 2e75  w)..    v = jr.u
+0002cf40: 6e69 666f 726d 286b 6579 3d75 6e69 5f76  niform(key=uni_v
+0002cf50: 6b65 792c 2073 6861 7065 3d73 6861 7065  key, shape=shape
+0002cf60: 2c20 6474 7970 653d 636f 6e63 656e 7472  , dtype=concentr
+0002cf70: 6174 696f 6e2e 6474 7970 6529 0d0a 2020  ation.dtype)..  
+0002cf80: 2020 6163 6365 7074 203d 2028 7920 2a20    accept = (y * 
+0002cf90: 2832 2e30 202d 2079 2920 3e3d 2076 2920  (2.0 - y) >= v) 
+0002cfa0: 7c20 286a 6e70 2e6c 6f67 2879 202f 2076  | (jnp.log(y / v
+0002cfb0: 2920 2b20 312e 3020 3e3d 2079 290d 0a20  ) + 1.0 >= y).. 
+0002cfc0: 2020 2072 6574 7572 6e20 6920 2b20 312c     return i + 1,
+0002cfd0: 206b 6579 2c20 6163 6365 7074 207c 2064   key, accept | d
+0002cfe0: 6f6e 652c 2075 2c20 770d 0a0d 0a20 2069  one, u, w....  i
+0002cff0: 6e69 745f 646f 6e65 203d 206a 6e70 2e7a  nit_done = jnp.z
+0002d000: 6572 6f73 2873 6861 7065 2c20 6474 7970  eros(shape, dtyp
+0002d010: 653d 626f 6f6c 290d 0a20 2069 6e69 745f  e=bool)..  init_
+0002d020: 7520 3d20 6a6e 702e 7a65 726f 7328 7368  u = jnp.zeros(sh
+0002d030: 6170 6529 0d0a 2020 696e 6974 5f77 203d  ape)..  init_w =
+0002d040: 206a 6e70 2e7a 6572 6f73 2873 6861 7065   jnp.zeros(shape
+0002d050: 290d 0a0d 0a20 205f 2c20 5f2c 2064 6f6e  )....  _, _, don
+0002d060: 652c 2075 2c20 7720 3d20 6c61 782e 7768  e, u, w = lax.wh
+0002d070: 696c 655f 6c6f 6f70 280d 0a20 2020 2063  ile_loop(..    c
+0002d080: 6f6e 645f 6675 6e3d 636f 6e64 5f66 6e2c  ond_fun=cond_fn,
+0002d090: 0d0a 2020 2020 626f 6479 5f66 756e 3d62  ..    body_fun=b
+0002d0a0: 6f64 795f 666e 2c0d 0a20 2020 2069 6e69  ody_fn,..    ini
+0002d0b0: 745f 7661 6c3d 286a 6e70 2e61 7272 6179  t_val=(jnp.array
+0002d0c0: 2830 292c 206b 6579 2c20 696e 6974 5f64  (0), key, init_d
+0002d0d0: 6f6e 652c 2069 6e69 745f 752c 2069 6e69  one, init_u, ini
+0002d0e0: 745f 7729 2c0d 0a20 2029 0d0a 0d0a 2020  t_w),..  )....  
+0002d0f0: 7265 7475 726e 206a 6e70 2e73 6967 6e28  return jnp.sign(
+0002d100: 7529 202a 206a 6e70 2e61 7263 636f 7328  u) * jnp.arccos(
+0002d110: 7729 0d0a 0d0a 0d0a 6465 6620 5f6c 6f63  w)......def _loc
+0002d120: 5f73 6361 6c65 286c 6f63 2c20 7363 616c  _scale(loc, scal
+0002d130: 652c 2076 616c 7565 293a 0d0a 2020 6966  e, value):..  if
+0002d140: 206c 6f63 2069 7320 4e6f 6e65 3a0d 0a20   loc is None:.. 
+0002d150: 2020 2069 6620 7363 616c 6520 6973 204e     if scale is N
+0002d160: 6f6e 653a 0d0a 2020 2020 2020 7265 7475  one:..      retu
+0002d170: 726e 2076 616c 7565 0d0a 2020 2020 656c  rn value..    el
+0002d180: 7365 3a0d 0a20 2020 2020 2072 6574 7572  se:..      retur
+0002d190: 6e20 7661 6c75 6520 2a20 7363 616c 650d  n value * scale.
+0002d1a0: 0a20 2065 6c73 653a 0d0a 2020 2020 6966  .  else:..    if
+0002d1b0: 2073 6361 6c65 2069 7320 4e6f 6e65 3a0d   scale is None:.
+0002d1c0: 0a20 2020 2020 2072 6574 7572 6e20 7661  .      return va
+0002d1d0: 6c75 6520 2b20 6c6f 630d 0a20 2020 2065  lue + loc..    e
+0002d1e0: 6c73 653a 0d0a 2020 2020 2020 7265 7475  lse:..      retu
+0002d1f0: 726e 2076 616c 7565 202a 2073 6361 6c65  rn value * scale
+0002d200: 202b 206c 6f63 0d0a 0d0a 0d0a 6465 6620   + loc......def 
+0002d210: 5f63 6865 636b 5f70 795f 7365 7128 7365  _check_py_seq(se
+0002d220: 7129 3a0d 0a20 2072 6574 7572 6e20 6a6e  q):..  return jn
+0002d230: 702e 6173 6172 7261 7928 7365 7129 2069  p.asarray(seq) i
+0002d240: 6620 6973 696e 7374 616e 6365 2873 6571  f isinstance(seq
+0002d250: 2c20 2874 7570 6c65 2c20 6c69 7374 2929  , (tuple, list))
+0002d260: 2065 6c73 6520 7365 710d 0a0d 0a0d 0a23   else seq......#
+0002d270: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+0002d280: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002d290: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002d2a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002d2b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002d2c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002d2d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002d2e0: 0d0a 0d0a 0d0a 666f 7220 5f5f 6b20 696e  ......for __k in
+0002d2f0: 2064 6972 2852 616e 646f 6d53 7461 7465   dir(RandomState
+0002d300: 293a 0d0a 2020 5f5f 7420 3d20 6765 7461  ):..  __t = geta
+0002d310: 7474 7228 5261 6e64 6f6d 5374 6174 652c  ttr(RandomState,
+0002d320: 205f 5f6b 290d 0a20 2069 6620 6e6f 7420   __k)..  if not 
+0002d330: 5f5f 6b2e 7374 6172 7473 7769 7468 2827  __k.startswith('
+0002d340: 5f5f 2729 2061 6e64 2063 616c 6c61 626c  __') and callabl
+0002d350: 6528 5f5f 7429 2061 6e64 2028 6e6f 7420  e(__t) and (not 
+0002d360: 5f5f 742e 5f5f 646f 635f 5f29 3a0d 0a20  __t.__doc__):.. 
+0002d370: 2020 205f 5f72 203d 2067 6c6f 6261 6c73     __r = globals
+0002d380: 2829 2e67 6574 285f 5f6b 2c20 4e6f 6e65  ().get(__k, None
+0002d390: 290d 0a20 2020 2069 6620 5f5f 7220 6973  )..    if __r is
+0002d3a0: 206e 6f74 204e 6f6e 6520 616e 6420 6361   not None and ca
+0002d3b0: 6c6c 6162 6c65 285f 5f72 293a 0d0a 2020  llable(__r):..  
+0002d3c0: 2020 2020 5f5f 742e 5f5f 646f 635f 5f20      __t.__doc__ 
+0002d3d0: 3d20 5f5f 722e 5f5f 646f 635f 5f0d 0a    = __r.__doc__..
```

## braincore/share.py

```diff
@@ -1,7 +1,22 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
 # -*- coding: utf-8 -*-
 
 
 import contextlib
 from typing import Any
 
 __all__ = [
@@ -44,17 +59,19 @@
       The default value if the key is not found.
     desc: str
       The description of the key.
   """
   if key not in _context:
     if default is _NOT_PROVIDE:
       if desc is not None:
-        raise KeyError(f"Key {key} not found in the context. You can set it by `share.set({key}=value)`. {desc}")
+        raise KeyError(f"Key '{key}' not found in the context. You can set it "
+                       f"by `braincore.share.set({key}=value)`. {desc}")
       else:
-        raise KeyError(f"Key {key} not found in the context. You can set it by `share.set({key}=value)`.")
+        raise KeyError(f"Key '{key}' not found in the context. You can set it "
+                       f"by `braincore.share.set({key}=value)`.")
     return default
   return _context[key]
 
 
 @contextlib.contextmanager
 def context(**kwargs):
   """
```

## braincore/surrogate.py

```diff
@@ -1,7 +1,22 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
 # -*- coding: utf-8 -*-
 
 import jax
 import jax.numpy as jnp
 import jax.scipy as sci
 from jax.core import Primitive
 from jax.interpreters import batching, ad, mlir
@@ -81,15 +96,15 @@
 
   To customize a surrogate gradient function, you can inherit this class and
   implement the `surrogate_fun` and `surrogate_grad` methods.
 
   Examples
   --------
 
-  >>> import braincore.core as bc
+  >>> import braincore as bc
   >>> import jax.numpy as jnp
 
   >>> class MySurrogate(bc.surrogate.Surrogate):
   ...   def __init__(self, alpha=1.):
   ...     super().__init__()
   ...     self.alpha = alpha
   ...
@@ -168,15 +183,15 @@
   .. math::
 
      g'(x) = \alpha * (1 - \mathrm{sigmoid} (\alpha x)) \mathrm{sigmoid} (\alpha x)
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-2, 2, 1000)
      >>> for alpha in [1., 2., 4.]:
      >>>   grads = bc.vector_grad(bc.surrogate.sigmoid)(xs, alpha)
      >>>   plt.plot(xs, grads, label=r'$\alpha$=' + str(alpha))
      >>> plt.legend()
      >>> plt.show()
@@ -261,15 +276,15 @@
         0, & |x| > \frac{1}{\alpha} \\
         -\alpha^2|x|+\alpha, & |x| \leq \frac{1}{\alpha}
         \end{cases}
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-3, 3, 1000)
      >>> for alpha in [0.5, 1., 2., 4.]:
      >>>   grads = bc.vector_grad(bc.surrogate.piecewise_quadratic)(xs, alpha)
      >>>   plt.plot(xs, grads, label=r'$\alpha$=' + str(alpha))
      >>> plt.legend()
      >>> plt.show()
@@ -351,15 +366,15 @@
   .. math::
 
      g'(x) = \frac{\alpha}{2}e^{-\alpha |x|}
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-3, 3, 1000)
      >>> for alpha in [0.5, 1., 2., 4.]:
      >>>   grads = bc.vector_grad(bc.surrogate.piecewise_exp)(xs, alpha)
      >>>   plt.plot(xs, grads, label=r'$\alpha$=' + str(alpha))
      >>> plt.legend()
      >>> plt.show()
@@ -435,15 +450,15 @@
   .. math::
 
      g'(x) = \frac{\alpha}{2(1 + |\alpha x|)^{2}} = \frac{1}{2\alpha(\frac{1}{\alpha} + |x|)^{2}}
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-3, 3, 1000)
      >>> for alpha in [0.5, 1., 2., 4.]:
      >>>   grads = bc.vector_grad(bc.surrogate.soft_sign)(xs, alpha)
      >>>   plt.plot(xs, grads, label=r'$\alpha$=' + str(alpha))
      >>> plt.legend()
      >>> plt.show()
@@ -515,15 +530,15 @@
   .. math::
 
      g'(x) = \frac{\alpha}{2(1 + (\frac{\pi}{2}\alpha x)^2)}
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-3, 3, 1000)
      >>> for alpha in [0.5, 1., 2., 4.]:
      >>>   grads = bc.vector_grad(bc.surrogate.arctan)(xs, alpha)
      >>>   plt.plot(xs, grads, label=r'$\alpha$=' + str(alpha))
      >>> plt.legend()
      >>> plt.show()
@@ -608,15 +623,15 @@
 
   This surrogate function has the advantage of low computation cost during the backward.
 
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-3, 3, 1000)
      >>> for alpha in [0.5, 1., 2., 4.]:
      >>>   grads = bc.vector_grad(bc.surrogate.nonzero_sign_log)(xs, alpha)
      >>>   plt.plot(xs, grads, label=r'$\alpha$=' + str(alpha))
      >>> plt.legend()
      >>> plt.show()
@@ -692,15 +707,15 @@
   .. math::
 
      g'(x) = \frac{\alpha}{\sqrt{\pi}}e^{-\alpha^2x^2}
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-3, 3, 1000)
      >>> for alpha in [0.5, 1., 2., 4.]:
      >>>   grads = bc.vector_grad(bc.surrogate.nonzero_sign_log)(xs, alpha)
      >>>   plt.plot(xs, grads, label=r'$\alpha$=' + str(alpha))
      >>> plt.legend()
      >>> plt.show()
@@ -794,15 +809,15 @@
       \frac{1}{w}, & |x| \leq w \\
       c, & |x| > w
       \end{cases}\end{split}
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-3, 3, 1000)
      >>> for c in [0.01, 0.05, 0.1]:
      >>>   for w in [1., 2.]:
      >>>     grads1 = bc.vector_grad(bc.surrogate.piecewise_leaky_relu)(xs, c=c, w=w)
      >>>     plt.plot(xs, grads1, label=f'x={c}, w={w}')
      >>> plt.legend()
@@ -902,15 +917,15 @@
   .. math::
 
      g'(x) = \sum_{i=1}^n\frac{4\cos\left((2 * i - 1.) * 2\pi * x / T\right)}{T}
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-3, 3, 1000)
      >>> for n in [2, 4, 8]:
      >>>   f = bc.surrogate.SquarewaveFourierSeries(n=n)
      >>>   grads1 = bc.vector_grad(f)(xs)
      >>>   plt.plot(xs, grads1, label=f'n={n}')
      >>> plt.legend()
@@ -998,15 +1013,15 @@
         \alpha * (1 - \mathrm{sigmoid} (\alpha x)) \mathrm{sigmoid} (\alpha x), x < 0 \\
         \frac{\beta}{(x + 1)}, x \ge 0
     \end{cases}\end{split}
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-3, 3, 1000)
      >>> grads = bc.vector_grad(bc.surrogate.s2nn)(xs, 4., 1.)
      >>> plt.plot(xs, grads, label=r'$\alpha=4, \beta=1$')
      >>> grads = bc.vector_grad(bc.surrogate.s2nn)(xs, 8., 2.)
      >>> plt.plot(xs, grads, label=r'$\alpha=8, \beta=2$')
      >>> plt.legend()
@@ -1094,15 +1109,15 @@
   .. math::
 
      g'(x) = (1+\frac{2|x|}{\alpha-1})^{-\alpha}
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-3, 3, 1000)
      >>> for alpha in [0.5, 1., 2., 4.]:
      >>>   grads = bc.vector_grad(bc.surrogate.q_pseudo_spike)(xs, alpha)
      >>>   plt.plot(xs, grads, label=r'$\alpha=$' + str(alpha))
      >>> plt.legend()
      >>> plt.show()
@@ -1187,15 +1202,15 @@
       \beta, & x \geq 0 \\
       \alpha, & x < 0 \\
       \end{cases}\end{split}
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-3, 3, 1000)
      >>> grads = bc.vector_grad(bc.surrogate.leaky_relu)(xs, 0., 1.)
      >>> plt.plot(xs, grads, label=r'$\alpha=0., \beta=1.$')
      >>> plt.legend()
      >>> plt.show()
 
@@ -1286,15 +1301,15 @@
       1, & 0 < x \leq 0 \\
       \frac{1}{x}, x > 1 \\
       \end{cases}\end{split}
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-3, 3, 1000)
      >>> grads = bc.vector_grad(bc.surrogate.leaky_relu)(xs, 0., 1.)
      >>> plt.plot(xs, grads, label=r'$\alpha=0., \beta=1.$')
      >>> plt.legend()
      >>> plt.show()
 
@@ -1360,15 +1375,15 @@
   .. math::
 
      g'(x) = \text{ReLU}(\alpha * (\mathrm{width}-|x|))
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-3, 3, 1000)
      >>> for s in [0.5, 1.]:
      >>>   for w in [1, 2.]:
      >>>     grads = bc.vector_grad(bc.surrogate.relu_grad)(xs, s, w)
      >>>     plt.plot(xs, grads, label=r'$\alpha=$' + f'{s}, width={w}')
      >>> plt.legend()
@@ -1437,15 +1452,15 @@
   .. math::
 
      g'(x) = \alpha * \text{gaussian}(x, 0., \sigma)
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-3, 3, 1000)
      >>> for s in [0.5, 1., 2.]:
      >>>   grads = bc.vector_grad(bc.surrogate.gaussian_grad)(xs, s, 0.5)
      >>>   plt.plot(xs, grads, label=r'$\alpha=0.5, \sigma=$' + str(s))
      >>> plt.legend()
      >>> plt.show()
@@ -1527,15 +1542,15 @@
      h{{{\mathcal{N}}}}(x, -\sigma ,{(s\sigma )}^{2})
      \end{array}
 
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-3, 3, 1000)
      >>> grads = bc.vector_grad(bc.surrogate.multi_gaussian_grad)(xs)
      >>> plt.plot(xs, grads)
      >>> plt.show()
 
   Parameters
@@ -1604,15 +1619,15 @@
 
      g'(x) = \frac{1}{(\alpha * |x| + 1.) ^ 2}
 
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-1, 1, 1000)
      >>> for alpha in [1., 10., 100.]:
      >>>   grads = bc.vector_grad(bc.surrogate.inv_square_grad)(xs, alpha)
      >>>   plt.plot(xs, grads, label=r'$\alpha$=' + str(alpha))
      >>> plt.legend()
      >>> plt.show()
@@ -1673,15 +1688,15 @@
 
      g'(x) = \exp(-\alpha |x|)
 
 
   .. plot::
      :include-source: True
 
-     >>> import braincore.core as bc
+     >>> import braincore as bc
      >>> import matplotlib.pyplot as plt
      >>> xs = jax.numpy.linspace(-3, 3, 1000)
      >>> for alpha in [0.5, 1., 2., 4.]:
      >>>   grads = bc.vector_grad(bc.surrogate.slayer_grad)(xs, alpha)
      >>>   plt.plot(xs, grads, label=r'$\alpha$=' + str(alpha))
      >>> plt.legend()
      >>> plt.show()
```

## braincore/_projection/__init__.py

```diff
@@ -1,17 +1,32 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
 """
 
 This module defines the basic classes for synaptic projections.
 
 """
 
-from .align_post import *
-from .align_post import __all__ as align_post_all
-from .align_pre import *
-from .align_pre import __all__ as align_pre_all
-from .delta import *
-from .delta import __all__ as delta_all
-from .vanilla import *
-from .vanilla import __all__ as vanilla_all
+from ._align_post import *
+from ._align_post import __all__ as align_post_all
+from ._align_pre import *
+from ._align_pre import __all__ as align_pre_all
+from ._delta import *
+from ._delta import __all__ as delta_all
+from ._vanilla import *
+from ._vanilla import __all__ as vanilla_all
 
 __all__ = align_post_all + align_pre_all + delta_all + vanilla_all
 del align_post_all, align_pre_all, delta_all, vanilla_all
```

## braincore/_projection/_utils.py

```diff
@@ -1,2 +1,17 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
 def is_instance(x, cls):
   assert isinstance(x, cls), 'The input should be an instance of {}!'.format(cls)
```

## braincore/math/__init__.py

```diff
@@ -1,6 +1,21 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
 from ._einops import *
 from ._einops import __all__ as _einops_all
 from ._misc import *
 from ._misc import __all__ as _misc_all
 
 __all__ = _misc_all + _einops_all
```

## braincore/math/_einops.py

```diff
@@ -1,16 +1,33 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
+from __future__ import annotations
 import functools
 import itertools
 from collections import OrderedDict
 from typing import Set, Tuple, List, Dict, Union, Callable, Optional, cast
 
 import jax
 import jax.numpy as jnp
 import numpy as np
 
+from braincore._common import set_module_as
 from ._einops_parsing import ParsedExpression, _ellipsis, AnonymousAxis, EinopsError
 
 __all__ = [
   'ein_reduce', 'ein_rearrange', 'ein_repeat', 'ein_shape',
 ]
 
 ReductionCallable = Callable[[jax.typing.ArrayLike, Tuple[int, ...]], jax.typing.ArrayLike]
@@ -494,16 +511,21 @@
   left = ParsedExpression(left_str)
   dims = [len(left.composition)]
   if left.has_ellipsis:
     dims = [len(left.composition) - 1 + ellipsis_dims for ellipsis_dims in range(8)]
   return {ndim: _prepare_transformation_recipe(pattern, operation, axes_names, ndim=ndim) for ndim in dims}
 
 
-def ein_reduce(tensor: Union[jax.typing.ArrayLike, List[jax.typing.ArrayLike]],
-               pattern: str, reduction: Reduction, **axes_lengths: int) -> jax.typing.ArrayLike:
+@set_module_as('braincore.math')
+def ein_reduce(
+    tensor: Union[jax.typing.ArrayLike, List[jax.typing.ArrayLike]],
+    pattern: str,
+    reduction: Reduction,
+    **axes_lengths: int
+) -> jax.typing.ArrayLike:
   """
   ``ein_reduce`` provides combination of reordering and reduction using reader-friendly notation.
 
   Examples for reduce operation:
 
   ```python
   >>> x = np.random.randn(100, 32, 64)
@@ -565,16 +587,20 @@
       message += "\n Input tensor shape: {}. ".format(shape)
     else:
       message += "\n Input is list. "
     message += "Additional info: {}.".format(axes_lengths)
     raise EinopsError(message + "\n {}".format(e))
 
 
-def ein_rearrange(tensor: Union[jax.typing.ArrayLike, List[jax.typing.ArrayLike]],
-                  pattern: str, **axes_lengths) -> jax.typing.ArrayLike:
+@set_module_as('braincore.math')
+def ein_rearrange(
+    tensor: Union[jax.typing.ArrayLike, List[jax.typing.ArrayLike]],
+    pattern: str,
+    **axes_lengths
+) -> jax.typing.ArrayLike:
   """
   ``ein_rearrange`` is a reader-friendly smart element reordering for multidimensional tensors.
   This operation includes functionality of transpose (axes permutation), reshape (view), squeeze, unsqueeze,
   stack, concatenate and other operations.
 
   Examples for rearrange operation:
 
@@ -624,14 +650,15 @@
   Returns:
       tensor of the same type as input. If possible, a view to the original tensor is returned.
 
   """
   return ein_reduce(tensor, pattern, reduction="rearrange", **axes_lengths)
 
 
+@set_module_as('braincore.math')
 def ein_repeat(
     tensor: Union[jax.typing.ArrayLike, List[jax.typing.ArrayLike]],
     pattern: str, **axes_lengths
 ) -> jax.typing.ArrayLike:
   """
   ``ein_repeat`` allows reordering elements and repeating them in arbitrary combinations.
   This operation includes functionality of repeat, tile, broadcast functions.
@@ -677,14 +704,15 @@
   Returns:
       Tensor of the same type as input. If possible, a view to the original tensor is returned.
 
   """
   return ein_reduce(tensor, pattern, reduction="repeat", **axes_lengths)
 
 
+@set_module_as('braincore.math')
 def ein_shape(x, pattern: str) -> dict:
   """
   Parse a tensor shape to dictionary mapping axes names to their lengths.
 
   ```python
   # Use underscore to skip the dimension in parsing.
   >>> x = np.zeros([2, 3, 5, 7])
```

## braincore/math/_einops_parsing.py

```diff
@@ -1,7 +1,23 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
+from __future__ import annotations
 import keyword
 import warnings
 from typing import List, Optional, Set, Tuple, Union
 
 _ellipsis: str = '…'  # NB, this is a single unicode symbol. String is used as it is not a list, but can be iterated
```

## braincore/math/_misc.py

```diff
@@ -1,27 +1,50 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
+from __future__ import annotations
 from typing import Optional, Sequence
 
 import jax
 import jax.numpy as jnp
 import numpy as np
 
 from braincore import environ
+from braincore._common import set_module_as
+
 
 __all__ = [
   'get_dtype',
+  'is_float',
+  'is_int',
   'exprel',
   'flatten',
   'unflatten',
   'remove_diag',
   'clip_by_norm',
   'from_numpy',
   'as_numpy',
+  'tree_zeros_like',
+  'tree_ones_like',
 ]
 
 
+@set_module_as('braincore.math')
 def get_dtype(a):
   """
   Get the dtype of a.
   """
   if hasattr(a, 'dtype'):
     return a.dtype
   else:
@@ -33,14 +56,43 @@
       return environ.dftype()
     elif isinstance(a, complex):
       return environ.dctype()
     else:
       raise ValueError(f'Can not get dtype of {a}.')
 
 
+@set_module_as('braincore.math')
+def is_float(array):
+  """
+  Check if the array is a floating point array.
+
+  Args:
+    array: The input array.
+
+  Returns:
+    A boolean value indicating if the array is a floating point array.
+  """
+  return jnp.issubdtype(get_dtype(array), jnp.floating)
+
+
+@set_module_as('braincore.math')
+def is_int(array):
+  """
+  Check if the array is an integer array.
+
+  Args:
+    array: The input array.
+
+  Returns:
+    A boolean value indicating if the array is an integer array.
+  """
+  return jnp.issubdtype(get_dtype(array), jnp.integer)
+
+
+@set_module_as('braincore.math')
 def exprel(x):
   """
   Relative error exponential, ``(exp(x) - 1)/x``.
 
   When ``x`` is near zero, ``exp(x)`` is near 1, so the numerical calculation of ``exp(x) - 1`` can
   suffer from catastrophic loss of precision. ``exprel(x)`` is implemented to avoid the loss of
   precision that occurs when ``x`` is near zero.
@@ -74,14 +126,15 @@
   big = x > big_threshold
   origin = jnp.expm1(x) / x
   return jnp.where(small,
                    jnp.asarray(1.0, origin.dtype),
                    jnp.where(big, jnp.inf, origin))
 
 
+@set_module_as('braincore.math')
 def remove_diag(arr):
   """Remove the diagonal of the matrix.
 
   Parameters
   ----------
   arr: ArrayType
     The matrix with the shape of `(M, N)`.
@@ -93,20 +146,35 @@
   """
   if arr.ndim != 2:
     raise ValueError(f'Only support 2D matrix, while we got a {arr.ndim}D array.')
   eyes = jnp.fill_diagonal(jnp.ones(arr.shape, dtype=bool), False)
   return jnp.reshape(arr[eyes], (arr.shape[0], arr.shape[1] - 1))
 
 
+@set_module_as('braincore.math')
 def clip_by_norm(t, clip_norm, axis=None):
-  return jax.tree.map(lambda l: l * clip_norm / jnp.maximum(jnp.sqrt(jnp.sum(l * l, axis=axis, keepdims=True)),
-                                                            clip_norm),
-                      t)
+  """
+  Clip the tensor by the norm of the tensor.
 
+  Args:
+    t: The tensor to be clipped.
+    clip_norm: The maximum norm value.
+    axis: The axis to calculate the norm. If None, the norm is calculated over the whole tensor.
 
+  Returns:
+    The clipped tensor.
+
+  """
+  return jax.tree.map(
+    lambda l: l * clip_norm / jnp.maximum(jnp.sqrt(jnp.sum(l * l, axis=axis, keepdims=True)), clip_norm),
+    t
+  )
+
+
+@set_module_as('braincore.math')
 def flatten(
     input: jax.typing.ArrayLike,
     start_dim: Optional[int] = None,
     end_dim: Optional[int] = None
 ) -> jax.Array:
   """Flattens input by reshaping it into a one-dimensional tensor.
   If ``start_dim`` or ``end_dim`` are passed, only dimensions starting
@@ -146,14 +214,15 @@
     raise ValueError(f'start_dim {start_dim} is out of size.')
   if end_dim < 0 or end_dim > ndim:
     raise ValueError(f'end_dim {end_dim} is out of size.')
   new_shape = shape[:start_dim] + (np.prod(shape[start_dim: end_dim], dtype=int),) + shape[end_dim:]
   return jnp.reshape(input, new_shape)
 
 
+@set_module_as('braincore.math')
 def unflatten(x: jax.typing.ArrayLike, dim: int, sizes: Sequence[int]) -> jax.Array:
   """
   Expands a dimension of the input tensor over multiple dimensions.
 
   Args:
     x: input tensor.
     dim: Dimension to be unflattened, specified as an index into ``x.shape``.
@@ -169,13 +238,62 @@
   assert x.ndim > dim, ('The dimension to be unflattened should be less than the tensor dimension. '
                         f'Got {dim} and {x.ndim}.')
   shape = x.shape
   new_shape = shape[:dim] + tuple(sizes) + shape[dim + 1:]
   return jnp.reshape(x, new_shape)
 
 
+@set_module_as('braincore.math')
 def from_numpy(x):
+  """
+  Convert the numpy array to jax array.
+
+  Args:
+    x: The numpy array.
+
+  Returns:
+    The jax array.
+  """
   return jnp.array(x)
 
 
+@set_module_as('braincore.math')
 def as_numpy(x):
+  """
+  Convert the array to numpy array.
+
+  Args:
+    x: The array.
+
+  Returns:
+    The numpy array.
+  """
   return np.array(x)
+
+
+@set_module_as('braincore.math')
+def tree_zeros_like(tree):
+  """
+  Create a tree with the same structure as the input tree, but with zeros in each leaf.
+
+  Args:
+    tree: The input tree.
+
+  Returns:
+    The tree with zeros in each leaf.
+  """
+  return jax.tree_map(jnp.zeros_like, tree)
+
+
+@set_module_as('braincore.math')
+def tree_ones_like(tree):
+  """
+  Create a tree with the same structure as the input tree, but with ones in each leaf.
+
+  Args:
+    tree: The input tree.
+
+  Returns:
+    The tree with ones in each leaf.
+
+  """
+  return jax.tree_map(jnp.ones_like, tree)
```

## Comparing `braincore/_utils.py` & `braincore/util.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,34 +1,52 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
 import copy
+import functools
 import gc
+import types
 import warnings
-from functools import wraps, partial
+from collections.abc import Iterable
 from typing import Any, Callable, Tuple, Union, Sequence
 
 import jax
-from jax import numpy as jnp
-from jax.core import Primitive, ShapedArray
-from jax.experimental.host_callback import id_tap
-from jax.interpreters import batching, mlir, xla
-from jax.lax import cond
 from jax.lib import xla_bridge
 
+from ._common import set_module_as
+
+
 __all__ = [
   'unique_name',
-  'jit_error',
   'clear_buffer_memory',
-  'Stack',
+  'not_instance_eval',
+  'is_instance_eval',
+  'DictManager',
   'MemScaling',
   'IdMemScaling',
+  'DotDict',
 ]
 
 _name2id = dict()
 _typed_names = {}
 
 
+@set_module_as('braincore.util')
 def check_name_uniqueness(name, obj):
   """Check the uniqueness of the name for the object type."""
   if not name.isidentifier():
     raise ValueError(
       f'"{name}" isn\'t a valid identifier '
       f'according to Python language definition. '
       f'Please choose another name.'
@@ -51,14 +69,15 @@
   if type_ not in _typed_names:
     _typed_names[type_] = 0
   name = f'{type_}{_typed_names[type_]}'
   _typed_names[type_] += 1
   return name
 
 
+@set_module_as('braincore.util')
 def unique_name(name=None, self=None):
   """Get the unique name for this object.
 
   Parameters
   ----------
   name : str, optional
     The expected name. If None, the default unique name will be returned.
@@ -75,180 +94,68 @@
     assert self is not None, 'If name is None, self should be provided.'
     return get_unique_name(type_=self.__class__.__name__)
   else:
     check_name_uniqueness(name=name, obj=self)
     return name
 
 
+@set_module_as('braincore.util')
 def clear_name_cache(ignore_warn: bool = True):
   """Clear the cached names."""
   _name2id.clear()
   _typed_names.clear()
   if not ignore_warn:
     warnings.warn(f'All named models and their ids are cleared.', UserWarning)
 
 
-def remove_vmap(x, op='any'):
-  if op == 'any':
-    return _any_without_vmap(x)
-  elif op == 'all':
-    return _all_without_vmap(x)
-  else:
-    raise ValueError(f'Do not support type: {op}')
-
-
-_any_no_vmap_prim = Primitive('any_no_vmap')
-
-
-def _any_without_vmap(x):
-  return _any_no_vmap_prim.bind(x)
-
-
-def _any_without_vmap_imp(x):
-  return jnp.any(x)
-
-
-def _any_without_vmap_abs(x):
-  return ShapedArray(shape=(), dtype=jnp.bool_)
-
-
-def _any_without_vmap_batch(x, batch_axes):
-  (x,) = x
-  return _any_without_vmap(x), batching.not_mapped
-
-
-_any_no_vmap_prim.def_impl(_any_without_vmap_imp)
-_any_no_vmap_prim.def_abstract_eval(_any_without_vmap_abs)
-batching.primitive_batchers[_any_no_vmap_prim] = _any_without_vmap_batch
-if hasattr(xla, "lower_fun"):
-  xla.register_translation(_any_no_vmap_prim,
-                           xla.lower_fun(_any_without_vmap_imp, multiple_results=False, new_style=True))
-mlir.register_lowering(_any_no_vmap_prim, mlir.lower_fun(_any_without_vmap_imp, multiple_results=False))
-
-_all_no_vmap_prim = Primitive('all_no_vmap')
-
-
-def _all_without_vmap(x):
-  return _all_no_vmap_prim.bind(x)
-
-
-def _all_without_vmap_imp(x):
-  return jnp.all(x)
-
-
-def _all_without_vmap_abs(x):
-  return ShapedArray(shape=(), dtype=jnp.bool_)
-
-
-def _all_without_vmap_batch(x, batch_axes):
-  (x,) = x
-  return _all_without_vmap(x), batching.not_mapped
-
-
-_all_no_vmap_prim.def_impl(_all_without_vmap_imp)
-_all_no_vmap_prim.def_abstract_eval(_all_without_vmap_abs)
-batching.primitive_batchers[_all_no_vmap_prim] = _all_without_vmap_batch
-if hasattr(xla, "lower_fun"):
-  xla.register_translation(_all_no_vmap_prim,
-                           xla.lower_fun(_all_without_vmap_imp, multiple_results=False, new_style=True))
-mlir.register_lowering(_all_no_vmap_prim, mlir.lower_fun(_all_without_vmap_imp, multiple_results=False))
-
-
-def _err_jit_true_branch(err_fun, x):
-  id_tap(err_fun, x)
-  return
-
-
-def _err_jit_false_branch(x):
-  return
-
-
-def _cond(err_fun, pred, err_arg):
-  @wraps(err_fun)
-  def true_err_fun(arg, transforms):
-    err_fun(arg)
-
-  cond(pred,
-       partial(_err_jit_true_branch, true_err_fun),
-       _err_jit_false_branch,
-       err_arg)
-
-
-def _error_msg(msg):
-  raise ValueError(msg)
-
-
-def jit_error(pred, err_fun: Union[Callable, str], err_arg=None, scope: str = 'any'):
-  """Check errors in a jit function.
-
-  >>> def error(arg):
-  >>>    raise ValueError(f'error {arg}')
-  >>> x = jax.random.uniform(jax.random.PRNGKey(0), (10,))
-  >>> jit_error(x.sum() < 5., error, err_arg=x)
-
-  Parameters
-  ----------
-  pred: bool, Array
-    The boolean prediction.
-  err_fun: callable
-    The error function, which raise errors.
-  err_arg: any
-    The arguments which passed into `err_f`.
-  scope: str
-    The scope of the error message. Can be None, 'all' or 'any'.
-  """
-  if isinstance(err_fun, str):
-    err_fun = partial(_error_msg, err_fun)
-    assert err_arg is None, "err_arg should be None when err_fun is a string."
-  if scope is None:
-    pred = pred
-  elif scope == 'all':
-    pred = remove_vmap(pred, 'all')
-  elif scope == 'any':
-    pred = remove_vmap(pred, 'any')
-  else:
-    raise ValueError(f"Unknown scope: {scope}")
-  _cond(err_fun, pred, err_arg)
-
-
 @jax.tree_util.register_pytree_node_class
-class Stack(dict):
+class DictManager(dict):
   """
-  Stack, for collecting all pytree used in the program.
+  DictManager, for collecting all pytree used in the program.
 
-  :py:class:`~.Stack` supports all features of python dict.
+  :py:class:`~.DictManager` supports all features of python dict.
   """
+  __module__ = 'braincore.util'
 
-  def subset(self, sep: Union[type, Callable]) -> 'Stack':
+  def subset(self, sep: Union[type, Tuple[type, ...], Callable]) -> 'DictManager':
     """
     Get a new stack with the subset of keys.
     """
     gather = type(self)()
-    if callable(sep):
+    if isinstance(sep, types.FunctionType):
       for k, v in self.items():
         if sep(v):
           gather[k] = v
       return gather
     else:
       for k, v in self.items():
         if isinstance(v, sep):
           gather[k] = v
     return gather
 
-  def add_elem(self, var: Any):
+  def not_subset(self, sep: Union[type, Tuple[type, ...]]) -> 'DictManager':
+    """
+    Get a new stack with the subset of keys.
+    """
+    gather = type(self)()
+    for k, v in self.items():
+      if not isinstance(v, sep):
+        gather[k] = v
+    return gather
+
+  def add_unique_elem(self, key: Any, var: Any):
     """Add a new element."""
     self._check_elem(var)
-    id_ = id(var)
-    if id_ not in self:
-      self[id_] = var
+    if key in self:
+      if id(var) != id(self[key]):
+        raise ValueError(f'{key} has been registered by {self[key]}, the new value is different from it.')
     else:
-      if id(self[id_]) != id_:
-        raise ValueError(f'{id_} has been registered by {self[id_]}')
+      self[key] = var
 
-  def unique(self) -> 'Stack':
+  def unique(self) -> 'DictManager':
     """
     Get a new type of collections with unique values.
 
     If one value is assigned to two or more keys,
     then only one pair of (key, value) will be returned.
     """
     gather = type(self)()
@@ -264,37 +171,111 @@
     Assign the value for each element according to the given ``data``.
     """
     for arg in args:
       assert isinstance(arg, dict), 'Must be an instance of dict.'
       for k, v in arg.items():
         self[k] = v
 
-  def split(self, first: type, *others: type) -> Tuple['Stack', ...]:
+  def split(self, first: type, *others: type) -> Tuple['DictManager', ...]:
     """
     Split the stack into subsets of stack by the given types.
     """
     filters = (first, *others)
     results = tuple(type(self)() for _ in range(len(filters) + 1))
     for k, v in self.items():
       for i, filt in enumerate(filters):
         if isinstance(v, filt):
           results[i][k] = v
           break
       else:
         results[-1][k] = v
     return results
 
-  def pop_by_value_ids(self, *ids, error_when_absent: bool = False):
-    """Remove or pop variables in the stack by the given ids."""
-    if error_when_absent:
-      for id_ in ids:
-        self.pop(id_)
+  def pop_by_keys(self, keys: Iterable):
+    """
+    Pop the elements by the keys.
+    """
+    for k in tuple(self.keys()):
+      if k in keys:
+        self.pop(k)
+
+  def pop_by_values(self, values: Iterable, by: str = 'id'):
+    """
+    Pop the elements by the values.
+
+    Args:
+      values: The value ids.
+      by: str. The discard method, can be ``id`` or ``value``. Default is 'id'.
+    """
+    if by == 'id':
+      value_ids = {id(v) for v in values}
+      for k in tuple(self.keys()):
+        if id(self[k]) in value_ids:
+          self.pop(k)
+    elif by == 'value':
+      for k in tuple(self.keys()):
+        if self[k] in values:
+          self.pop(k)
     else:
-      for id_ in ids:
-        self.pop(id_, None)
+      raise ValueError(f'Unsupported method: {by}')
+
+  def difference_by_keys(self, keys: Iterable):
+    """
+    Get the difference of the stack by the keys.
+    """
+    return type(self)({k: v for k, v in self.items() if k not in keys})
+
+  def difference_by_values(self, values: Iterable, by: str = 'id'):
+    """
+    Get the difference of the stack by the values.
+
+    Args:
+      values: The value ids.
+      by: str. The discard method, can be ``id`` or ``value``. Default is 'id'.
+    """
+    if by == 'id':
+      value_ids = {id(v) for v in values}
+      return type(self)({k: v for k, v in self.items() if id(v) not in value_ids})
+    elif by == 'value':
+      return type(self)({k: v for k, v in self.items() if v not in values})
+    else:
+      raise ValueError(f'Unsupported method: {by}')
+
+  def intersection_by_keys(self, keys: Iterable):
+    """
+    Get the intersection of the stack by the keys.
+    """
+    return type(self)({k: v for k, v in self.items() if k in keys})
+
+  def intersection_by_values(self, values: Iterable, by: str = 'id'):
+    """
+    Get the intersection of the stack by the values.
+
+    Args:
+      values: The value ids.
+      by: str. The discard method, can be ``id`` or ``value``. Default is 'id'.
+    """
+    if by == 'id':
+      value_ids = {id(v) for v in values}
+      return type(self)({k: v for k, v in self.items() if id(v) in value_ids})
+    elif by == 'value':
+      return type(self)({k: v for k, v in self.items() if v in values})
+    else:
+      raise ValueError(f'Unsupported method: {by}')
+
+  def union_by_value_ids(self, other: dict):
+    """
+    Union the stack by the value ids.
+
+    Args:
+      other:
+
+    Returns:
+
+    """
 
   def __add__(self, other: dict):
     """
     Compose other instance of dict.
     """
     new_dict = type(self)(self)
     new_dict.update(other)
@@ -306,19 +287,33 @@
   @classmethod
   def tree_unflatten(cls, keys, values):
     return cls(jax.util.safe_zip(keys, values))
 
   def _check_elem(self, elem: Any):
     raise NotImplementedError
 
+  def to_dict(self):
+    """
+    Convert the stack to a dict.
+
+    Returns
+    -------
+    dict
+      The dict object.
+    """
+    return dict(self)
+
+  def __copy__(self):
+    return type(self)(self)
+
 
+@set_module_as('braincore.util')
 def clear_buffer_memory(
     platform: str = None,
     array: bool = True,
-    backend: bool = False,
     compilation: bool = False,
 ):
   """Clear all on-device buffers.
 
   This function will be very useful when you call models in a Python loop,
   because it can clear all cached arrays, and clear device memory.
 
@@ -331,38 +326,35 @@
   ----------
   platform: str
     The device to clear its memory.
   array: bool
     Clear all buffer array. Default is True.
   compilation: bool
     Clear compilation cache. Default is False.
-  backend: bool
-    Clear backend cache. Default is False.
 
   """
   if array:
     for buf in xla_bridge.get_backend(platform).live_buffers():
       buf.delete()
   if compilation:
     jax.clear_caches()
-  if backend:
-    jax.clear_backends()
   gc.collect()
 
 
 class MemScaling(object):
   """
   The scaling object for membrane potential.
 
   The scaling object is used to transform the membrane potential range to a
   standard range. The scaling object can be used to transform the membrane
   potential to a standard range, and transform the standard range to the
   membrane potential.
 
   """
+  __module__ = 'braincore.util'
 
   def __init__(self, scale, bias):
     self._scale = scale
     self._bias = bias
 
   @classmethod
   def transform(
@@ -530,14 +522,15 @@
   The identity scaling object.
 
   The identity scaling object is used to transform the membrane potential to
   the standard range, and reversely transform the standard range to the
   membrane potential.
 
   """
+  __module__ = 'braincore.util'
 
   def __init__(self):
     super().__init__(scale=1., bias=0.)
 
   def scale_offset(self, x, bias=None, scale=None):
     """
     Transform the membrane potential to the standard range.
@@ -580,31 +573,34 @@
   def clone(self):
     """
     Clone the scaling object.
     """
     return IdMemScaling()
 
 
-class ContextAsDict(dict):
+@jax.tree_util.register_pytree_node_class
+class DotDict(dict):
   """Python dictionaries with advanced dot notation access.
 
   For example:
 
-  >>> d = ContextAsDict({'a': 10, 'b': 20})
+  >>> d = DotDict({'a': 10, 'b': 20})
   >>> d.a
   10
   >>> d['a']
   10
   >>> d.c  # this will raise a KeyError
   KeyError: 'c'
   >>> d.c = 30  # but you can assign a value to a non-existing item
   >>> d.c
   30
   """
 
+  __module__ = 'braincore.util'
+
   def __init__(self, *args, **kwargs):
     object.__setattr__(self, '__parent', kwargs.pop('__parent', None))
     object.__setattr__(self, '__key', kwargs.pop('__key', None))
     for arg in args:
       if not arg:
         continue
       elif isinstance(arg, dict):
@@ -622,15 +618,15 @@
   def __setattr__(self, name, value):
     if hasattr(self.__class__, name):
       raise AttributeError(f"Attribute '{name}' is read-only in '{type(self)}' object.")
     else:
       self[name] = value
 
   def __setitem__(self, name, value):
-    super(ContextAsDict, self).__setitem__(name, value)
+    super(DotDict, self).__setitem__(name, value)
     try:
       p = object.__getattribute__(self, '__parent')
       key = object.__getattribute__(self, '__key')
     except AttributeError:
       p = None
       key = None
     if p is not None:
@@ -701,7 +697,51 @@
 
   def setdefault(self, key, default=None):
     if key in self:
       return self[key]
     else:
       self[key] = default
       return default
+
+  def tree_flatten(self):
+    return tuple(self.values()), tuple(self.keys())
+
+  @classmethod
+  def tree_unflatten(cls, keys, values):
+    return cls(jax.util.safe_zip(keys, values))
+
+
+def _is_not_instance(x, cls):
+  return not isinstance(x, cls)
+
+
+def _is_instance(x, cls):
+  return isinstance(x, cls)
+
+
+@set_module_as('braincore.util')
+def not_instance_eval(*cls):
+  """
+  Create a partial function to evaluate if the input is not an instance of the given class.
+
+  Args:
+    *cls: The classes to check.
+
+  Returns:
+    The partial function.
+
+  """
+  return functools.partial(_is_not_instance, cls=cls)
+
+
+@set_module_as('braincore.util')
+def is_instance_eval(*cls):
+  """
+  Create a partial function to evaluate if the input is an instance of the given class.
+
+  Args:
+    *cls: The classes to check.
+
+  Returns:
+    The partial function.
+  """
+  return functools.partial(_is_instance, cls=cls)
```

## Comparing `braincore/_projection/align_post.py` & `braincore/_projection/_align_post.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,9 +1,25 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
 from typing import Optional, Union
 
+from braincore._common import set_module_as
 from braincore._module import (register_delay_of_target, Projection, Module, Dynamics,
                                ReceiveInputProj, ExtendedUpdateWithBA)
 from braincore.mixin import (Mode, AllOfTypes, ParamDescriber, BindCondData, AlignPost, UpdateReturn)
 from ._utils import is_instance
 
 __all__ = [
   'HalfProjAlignPostMg', 'FullProjAlignPostMg',
@@ -46,14 +62,15 @@
     self.syn = syn
     self.out = out
 
   def update(self, *args, **kwargs):
     self.out.bind_cond(self.syn(*args, **kwargs))
 
 
+@set_module_as('braincore')
 class HalfProjAlignPostMg(Projection):
   r"""
   Defining the half part of synaptic projection with the align-post reduction and the automatic synapse merging.
 
   The ``half-part`` means that the model only needs to provide half information needed for a projection,
   including ``comm`` -> ``syn`` -> ``out`` -> ``post``. Therefore, the model's ``update`` function needs
   the manual providing of the spiking input.
@@ -142,14 +159,15 @@
 
   def update(self, x):
     current = self.comm(x)
     self.syn.align_post_input_add(current)  # synapse post current
     return current
 
 
+@set_module_as('braincore')
 class FullProjAlignPostMg(Projection):
   """Full-chain synaptic projection with the align-post reduction and the automatic synapse merging.
 
   The ``full-chain`` means that the model needs to provide all information needed for a projection,
   including ``pre`` -> ``delay`` -> ``comm`` -> ``syn`` -> ``out`` -> ``post``.
 
   The ``align-post`` means that the synaptic variables have the same dimension as the post-synaptic neuron group.
@@ -280,14 +298,15 @@
     else:
       x = self.pre.update_return()
     current = self.comm(x)
     self.syn.align_post_input_add(current)  # synapse post current
     return current
 
 
+@set_module_as('braincore')
 class HalfProjAlignPost(Projection):
   """Defining the half-part of synaptic projection with the align-post reduction.
 
   The ``half-part`` means that the model only needs to provide half information needed for a projection,
   including ``comm`` -> ``syn`` -> ``out`` -> ``post``. Therefore, the model's ``update`` function needs
   the manual providing of the spiking input.
 
@@ -369,14 +388,15 @@
   def update(self, x):
     current = self.comm(x)
     g = self.syn(current)
     self.out.bind_cond(g)  # synapse post current
     return current
 
 
+@set_module_as('braincore')
 class FullProjAlignPost(Projection):
   """Full-chain synaptic projection with the align-post reduction.
 
   The ``full-chain`` means that the model needs to provide all information needed for a projection,
   including ``pre`` -> ``delay`` -> ``comm`` -> ``syn`` -> ``out`` -> ``post``.
 
   The ``align-post`` means that the synaptic variables have the same dimension as the post-synaptic neuron group.
```

## Comparing `braincore/_projection/align_pre.py` & `braincore/_projection/_align_pre.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,9 +1,26 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
+
 from typing import Optional, Union
 
+from braincore._common import set_module_as
 from braincore._module import (Module, DelayAccess, Projection,
                                ExtendedUpdateWithBA, ReceiveInputProj,
                                register_delay_of_target)
 from braincore.mixin import (ParamDescriber, BindCondData, UpdateReturn, Mode, AllOfTypes)
 from ._utils import is_instance
 
 __all__ = [
@@ -36,14 +53,15 @@
     self.access = access
     self.syn = syn
 
   def update(self, *args, **kwargs):
     return self.syn(self.access())
 
 
+@set_module_as('braincore')
 class FullProjAlignPreSDMg(Projection):
   """Full-chain synaptic projection with the align-pre reduction and synapse+delay updating and merging.
 
   The ``full-chain`` means that the model needs to provide all information needed for a projection,
   including ``pre`` -> ``syn`` -> ``delay`` -> ``comm`` -> ``out`` -> ``post``.
 
   The ``align-pre`` means that the synaptic variables have the same dimension as the pre-synaptic neuron group.
@@ -175,14 +193,15 @@
       else:
         x = self.syn.update_return()
     current = self.comm(x)
     self.out.bind_cond(current)
     return current
 
 
+@set_module_as('braincore')
 class FullProjAlignPreDSMg(Projection):
   """Full-chain synaptic projection with the align-pre reduction and delay+synapse updating and merging.
 
   The ``full-chain`` means that the model needs to provide all information needed for a projection,
   including ``pre`` -> ``delay`` -> ``syn`` -> ``comm`` -> ``out`` -> ``post``.
   Note here, compared to ``FullProjAlignPreSDMg``, the ``delay`` and ``syn`` are exchanged.
 
@@ -311,14 +330,15 @@
   def update(self):
     x = self.syn.update_return()
     current = self.comm(x)
     self.out.bind_cond(current)
     return current
 
 
+@set_module_as('braincore')
 class FullProjAlignPreSD(Projection):
   """Full-chain synaptic projection with the align-pre reduction and synapse+delay updating.
 
   The ``full-chain`` means that the model needs to provide all information needed for a projection,
   including ``pre`` -> ``syn`` -> ``delay`` -> ``comm`` -> ``out`` -> ``post``.
 
   The ``align-pre`` means that the synaptic variables have the same dimension as the pre-synaptic neuron group.
@@ -442,14 +462,15 @@
     else:
       x = self.syn(self.pre.update_return())
     current = self.comm(x)
     self.out.bind_cond(current)
     return current
 
 
+@set_module_as('braincore')
 class FullProjAlignPreDS(Projection):
   """Full-chain synaptic projection with the align-pre reduction and delay+synapse updating.
 
   The ``full-chain`` means that the model needs to provide all information needed for a projection,
   including ``pre`` -> ``syn`` -> ``delay`` -> ``comm`` -> ``out`` -> ``post``.
   Note here, compared to ``FullProjAlignPreSD``, the ``delay`` and ``syn`` are exchanged.
```

## Comparing `braincore/_projection/delta.py` & `braincore/_projection/_delta.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,9 +1,25 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
 from typing import Optional, Union
 
+from braincore._common import set_module_as
 from braincore._module import (Module, Dynamics, Projection, ReceiveInputProj,
                                UpdateReturn, register_delay_of_target)
 from braincore.mixin import (Mode, BindCondData)
 from ._utils import is_instance
 
 __all__ = [
   'HalfProjDelta', 'FullProjDelta',
@@ -18,14 +34,15 @@
     self._cond = cond
 
   def __call__(self, *args, **kwargs):
     r = self._cond
     return r
 
 
+@set_module_as('braincore')
 class HalfProjDelta(Projection):
   """Defining the half-part of the synaptic projection for the Delta synapse model.
 
   The synaptic projection requires the input is the spiking data, otherwise
   the synapse is not the Delta synapse model.
 
   The ``half-part`` means that the model only includes ``comm`` -> ``syn`` -> ``out`` -> ``post``.
@@ -106,14 +123,15 @@
     current = self.comm(x)
     # bind the output
     self.out.bind_cond(current)
     # return the current, if needed
     return current
 
 
+@set_module_as('braincore')
 class FullProjDelta(Projection):
   """Full-chain of the synaptic projection for the Delta synapse model.
 
   The synaptic projection requires the input is the spiking data, otherwise
   the synapse is not the Delta synapse model.
 
   The ``full-chain`` means that the model needs to provide all information needed for a projection,
```

## Comparing `braincore/_projection/vanilla.py` & `braincore/_projection/_vanilla.py`

 * *Files 23% similar despite different names*

```diff
@@ -1,18 +1,35 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
 from typing import Optional
 
+from braincore._common import set_module_as
 from braincore._module import (Module, Projection, Dynamics, ReceiveInputProj)
 from braincore.mixin import (BindCondData, Mode)
 from ._utils import is_instance
 
 __all__ = [
   'VanillaProj',
 ]
 
 
+@set_module_as('braincore')
 class VanillaProj(Projection):
   """Synaptic projection which defines the synaptic computation with the dimension of pre-synaptic neuron group.
 
   **Code Examples**
 
   To simulate an E/I balanced network model:
```

## Comparing `braincore/math/tests/test_einops.py` & `braincore/math/_einops_test.py`

 * *Files 7% similar despite different names*

```diff
@@ -1,7 +1,22 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
 import numpy as np
 import pytest
 
 import braincore.math as bcm
 from braincore.math._einops import ein_rearrange, ein_reduce, ein_repeat, _enumerate_directions
 from braincore.math._einops_parsing import EinopsError
```

## Comparing `braincore/math/tests/test_einops_parsing.py` & `braincore/math/_einops_parsing_test.py`

 * *Files 20% similar despite different names*

```diff
@@ -1,7 +1,22 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
 import pytest
 
 from braincore.math._einops_parsing import EinopsError, ParsedExpression, AnonymousAxis, _ellipsis
 
 
 class AnonymousAxisPlaceholder:
   def __init__(self, value: int):
```

## Comparing `braincore/tests/test_random.py` & `braincore/random_test.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,7 +1,23 @@
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+# ==============================================================================
+
+
 import platform
 import unittest
 
 import jax.numpy as jnp
 import jax.random as jr
 import numpy as np
 import pytest
@@ -551,10 +567,10 @@
     a = bc.random.t([1., 2.], size=None)
     self.assertTupleEqual(a.shape, (2,))
 
 
 class TestRandomKey(unittest.TestCase):
   def test_clear_memory(self):
     bc.random.split_key()
-    bc.clear_buffer_memory()
+    bc.util.clear_buffer_memory()
     print(bc.random.DEFAULT.value)
     self.assertTrue(isinstance(bc.random.DEFAULT.value, np.ndarray))
```

